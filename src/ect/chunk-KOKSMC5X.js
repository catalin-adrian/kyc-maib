import{a as aa,b as MNt,c as dbt,d as M9,e as qu,f as Xe,g as Ns,h as hg,i as Qa,j as vd}from"./chunk-XDPHE624.js";import{a as yd,b as cbt,c as ce,d as GW,e as hbt,f as OM,g as NNt,h as ll,i as He,j as HW,k as ps}from"./chunk-YNZYIWO7.js";var hh=class{static init(v){this.callingModule=v}static flowEvent(v,k){let N=`ect-${v.toString()}-${k.toString()}-event`;this.callingModule.dispatchEvent(new CustomEvent(N,{detail:{},bubbles:!0,cancelable:!0,composed:!0}))}static flowStarted(){this.callingModule.dispatchEvent(new CustomEvent("ect-started",{detail:{},bubbles:!0,cancelable:!0,composed:!0}))}static flowAborted(){this.callingModule.dispatchEvent(new CustomEvent("ect-aborted",{detail:{},bubbles:!0,cancelable:!0,composed:!0}))}static flowCompleted(){this.callingModule.dispatchEvent(new CustomEvent("ect-completed",{detail:{},bubbles:!0,cancelable:!0,composed:!0}))}static flowError(v){this.callingModule.dispatchEvent(new CustomEvent("ect-error",{detail:{error:v},bubbles:!0,cancelable:!0,composed:!0}))}static tokenExpired(){this.callingModule.dispatchEvent(new CustomEvent("ect-session-expired",{detail:{},bubbles:!0,cancelable:!0,composed:!0}))}},dl=class{static logStep(v,k){return ce(this,null,function*(){hh.flowEvent(v,k);try{yield Qa.instance.AddStep(v,k)}catch{}})}static initialize(v){return ce(this,null,function*(){hh.flowEvent(v,hg.Initialized);try{yield Qa.instance.AddStep(v,hg.Initialized)}catch{}})}static finalize(v){return ce(this,null,function*(){hh.flowEvent(v,hg.Finalized);try{yield Qa.instance.AddStep(v,hg.Finalized)}catch{}})}},Cd="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNTYuMzkiIGhlaWdodD0iMTEuNDA1IiB2aWV3Qm94PSIwIDAgNTYuMzkgMTEuNDA1Ij4NCiAgPGRlZnM+DQogICAgPGNsaXBQYXRoIGlkPSJjbGlwLXBhdGgiPg0KICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZV8xIiBkYXRhLW5hbWU9IlJlY3RhbmdsZSAxIiB3aWR0aD0iNTYuMzkiIGhlaWdodD0iMTEuNDA1IiBmaWxsPSJub25lIi8+DQogICAgPC9jbGlwUGF0aD4NCiAgPC9kZWZzPg0KICA8ZyBpZD0iR3JvdXBfMiIgZGF0YS1uYW1lPSJHcm91cCAyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDApIj4NCiAgICA8ZyBpZD0iR3JvdXBfMSIgZGF0YS1uYW1lPSJHcm91cCAxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDApIiBjbGlwLXBhdGg9InVybCgjY2xpcC1wYXRoKSI+DQogICAgICA8cGF0aCBpZD0iUGF0aF8xIiBkYXRhLW5hbWU9IlBhdGggMSIgZD0iTTI3LjM2Myw4Ljg0MVYxMy4ySDI1LjVWOS4yNjlhMy41NTYsMy41NTYsMCwwLDAtLjE4OC0xLjI5MiwxLjQ0NiwxLjQ0NiwwLDAsMC0uNTU5LS43LDEuNjEzLDEuNjEzLDAsMCwwLS44MzUtLjIxMmgtLjA0OEExLjYsMS42LDAsMCwwLDIyLjYsNy42YTIuMzU4LDIuMzU4LDAsMCwwLS40NiwxLjU3NVYxMy4ySDIwLjI3M1Y1LjUyMmgxLjc0M2wuMDg4Ljk2NC4wMjguMzMyLjE4LS4yOGEyLjUzOSwyLjUzOSwwLDAsMSwyLjIyNi0xLjIsMy4wOTQsMy4wOTQsMCwwLDEsMS41MzkuMzY0LDIuMzI1LDIuMzI1LDAsMCwxLC45NjcsMS4xMjQsNC45NjQsNC45NjQsMCwwLDEsLjMyLDIuMDE5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNy41NzIgLTEuOTkxKSIgZmlsbD0iIzExMDkyYiIvPg0KICAgICAgPHBhdGggaWQ9IlBhdGhfMiIgZGF0YS1uYW1lPSJQYXRoIDIiIGQ9Ik0zOC4zMzYsMTEuNDY1YTMuNDQsMy40NCwwLDAsMS0uNzQ3LjQsMi40MjQsMi40MjQsMCwwLDEtLjg3OS4xNzYsMi42NTksMi42NTksMCwwLDEtMS45MDYtLjYyLDIuMzUxLDIuMzUxLDAsMCwxLS42MzUtMS43NjhWNS43MTVIMzIuODg1VjQuMTY3aDEuMjgzVjEuN2gxLjg1OFY0LjE2N0gzOFY1LjcxNUgzNi4wMjZWOS4xOTRhMS4yNzIsMS4yNzIsMCwwLDAsLjI0Ny44NDQuOTMzLjkzMywwLDAsMCwuNzM2LjMsMS4xMjIsMS4xMjIsMCwwLDAsLjM4OC0uMDc2LDIuMTg0LDIuMTg0LDAsMCwwLC4zLS4xNTJaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTIuMjgzIC0wLjYzNikiIGZpbGw9IiMxMTA5MmIiLz4NCiAgICAgIDxwYXRoIGlkPSJQYXRoXzMiIGRhdGEtbmFtZT0iUGF0aCAzIiBkPSJNNDguMTM3LDUuNTl2MS44YTUuMTgsNS4xOCwwLDAsMC0xLjI4My4xOCwyLjM4MSwyLjM4MSwwLDAsMC0xLjA4My42LDEuNDY1LDEuNDY1LDAsMCwwLS40MzIsMS4wOTFWMTMuM0g0My40ODFWNS42MThINDUuMzR2MS43bC4yMDctLjMwOGEzLjAxNiwzLjAxNiwwLDAsMSwxLjExOS0xLjAyNywzLjQsMy40LDAsMCwxLDEuNDcxLS40IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTYuMjQgLTIuMDg2KSIgZmlsbD0iIzExMDkyYiIvPg0KICAgICAgPHBhdGggaWQ9IlBhdGhfNCIgZGF0YS1uYW1lPSJQYXRoIDQiIGQ9Ik01OC4zMzIsNy4wMThhMi43NTgsMi43NTgsMCwwLDAtMS4xMzktMS4yNCwzLjg1NywzLjg1NywwLDAsMC0xLjk0Mi0uNDQ0LDQsNCwwLDAsMC0xLjYzOS4zLDMuMDUxLDMuMDUxLDAsMCwwLTEuMDc1Ljc2MywzLjY4MSwzLjY4MSwwLDAsMC0uNTc1Ljg0NGwxLjYzLjU2NGExLjkwOCwxLjkwOCwwLDAsMSwxLjY1OS0uODgsMS40MDksMS40MDksMCwwLDEsLjk1MS4zLDEuNzA2LDEuNzA2LDAsMCwxLC41MDcuODM2LDMuODA4LDMuODA4LDAsMCwxLC4xLjQ2bC4wMi4xMzJoLTEuOTlhMy43ODgsMy43ODgsMCwwLDAtMi4zMS42MTYsMi4xMzksMi4xMzksMCwwLDAtLjgsMS44MTUsMi4wNDIsMi4wNDIsMCwwLDAsLjczOSwxLjdBMy4zNDgsMy4zNDgsMCwwLDAsNTQuNiwxMy40YTIuMTc5LDIuMTc5LDAsMCwwLDEuOTUtLjg1NmMuMDQ4LS4wNjQuMDg0LS4xMzIuMTI4LS4ybC4yLS4zNC4wMTYuMzkyLjAzMi44MTVoMS43MThsLjA0OC00LjI3YTQuMzQ1LDQuMzQ1LDAsMCwwLS4zNi0xLjkxNW0tMS40NjcsMy4wNzFhMS42NDIsMS42NDIsMCwwLDEtLjI1Ni44NiwyLjAxMiwyLjAxMiwwLDAsMS0uNjc1LjY3MSwxLjg4OSwxLjg4OSwwLDAsMS0uOTg0LjI2QTEuNzU4LDEuNzU4LDAsMCwxLDU0LDExLjY2M2EuNzE5LjcxOSwwLDAsMS0uMzY3LS42MzkuODcyLjg3MiwwLDAsMSwuNDUxLS43ODQsMi45NTEsMi45NTEsMCwwLDEsMS40NzktLjI2NGgxLjNaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTkuMzIxIC0xLjk5MSkiIGZpbGw9IiMxMTA5MmIiLz4NCiAgICAgIDxwYXRoIGlkPSJQYXRoXzUiIGRhdGEtbmFtZT0iUGF0aCA1IiBkPSJNNzIuMTEyLDExLjIxNmEzLjQ3MiwzLjQ3MiwwLDAsMS0xLjMzOSwxLjU3NSwzLjg1NCwzLjg1NCwwLDAsMS0yLjExLjYsNC4zNjEsNC4zNjEsMCwwLDEtMi4xNDItLjUxNiwzLjY3OSwzLjY3OSwwLDAsMS0xLjQ1OS0xLjQyNyw0LjEyNCw0LjEyNCwwLDAsMS0uNTI0LTIuMDgzLDQuMTI3LDQuMTI3LDAsMCwxLC41MjQtMi4wOTVBMy43NTcsMy43NTcsMCwwLDEsNjYuNSw1Ljg1YTQuMjg2LDQuMjg2LDAsMCwxLDIuMTI2LS41MTYsNC4wNjYsNC4wNjYsMCwwLDEsMi4xMDYuNTY4LDMuMjcxLDMuMjcxLDAsMCwxLDEuMzMxLDEuNTI4bC0xLjc1NS42MjRhMS44MzMsMS44MzMsMCwwLDAtLjY4Ny0uNjkxLDIuMDcxLDIuMDcxLDAsMCwwLTEuMDkxLS4yOTIsMi4wMDcsMi4wMDcsMCwwLDAtMS4wODcuMjkyLDIuMDMsMi4wMywwLDAsMC0uNzM2LjgxMSwyLjU2OCwyLjU2OCwwLDAsMC0uMjY4LDEuMTkyLDIuNTE0LDIuNTE0LDAsMCwwLC4yNjgsMS4xOCwyLjA1MywyLjA1MywwLDAsMCwxLjg1NCwxLjExNiwxLjk4NCwxLjk4NCwwLDAsMCwxLjEtLjMyLDEuOTI3LDEuOTI3LDAsMCwwLC42ODMtLjc0NFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yNC4xMDUgLTEuOTkxKSIgZmlsbD0iIzExMDkyYiIvPg0KICAgICAgPHBhdGggaWQ9IlBhdGhfNiIgZGF0YS1uYW1lPSJQYXRoIDYiIGQ9Ik05LjExLDQuNzA4aDAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zLjM3OSAtMS43NTcpIiBmaWxsPSIjODg0YmVmIi8+DQogICAgICA8cGF0aCBpZD0iUGF0aF83IiBkYXRhLW5hbWU9IlBhdGggNyIgZD0iTTUuNjcxLDBhNS42NzQsNS42NzQsMCwxLDAsNS42NzEsNS42NzRBNS42NzksNS42NzksMCwwLDAsNS42NzEsMG0wLDkuNTUyQTMuODgzLDMuODgzLDAsMSwxLDkuNTQ4LDUuNjc0LDMuODg1LDMuODg1LDAsMCwxLDUuNjcxLDkuNTUyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDApIiBmaWxsPSIjMTEwOTJiIi8+DQogICAgICA8cGF0aCBpZD0iUGF0aF84IiBkYXRhLW5hbWU9IlBhdGggOCIgZD0iTTgyLjkxNCwxMS40NmEyLjAwOSwyLjAwOSwwLDAsMS0xLjEyLjI5MSwyLjMzMywyLjMzMywwLDAsMS0xLjA0Ny0uMjQsMi4wMDUsMi4wMDUsMCwwLDEtLjgtLjcsMS44NzYsMS44NzYsMCwwLDEtLjMtLjg3OWwtLjAxMi0uMTI0aDUuNzc5QTUuNDQyLDUuNDQyLDAsMCwwLDg0LjksNy40MjlhMy43NzgsMy43NzgsMCwwLDAtMS4zNTktMS41NDcsMy40NjEsMy40NjEsMCwwLDAtMS44NTQtLjUyOCw0LjA3Miw0LjA3MiwwLDAsMC0yLjA2Mi41MTUsMy43LDMuNywwLDAsMC0xLjQwNywxLjQxMkE0LjE4OSw0LjE4OSwwLDAsMCw3Ny43LDkuMzY4YTQuMjYxLDQuMjYxLDAsMCwwLC41LDIuMDg3LDMuNywzLjcsMCwwLDAsMS4zNjYsMS40MiwzLjkxMSwzLjkxMSwwLDAsMCwyLjAwNy41MTEsNC45NDIsNC45NDIsMCwwLDAsMS42MTgtLjI0OCwzLjQsMy40LDAsMCwwLDEuMjExLS43MTIsMy43NzQsMy43NzQsMCwwLDAsLjc3Ni0xbC0xLjY0Ny0uNjQ0YTEuOTkzLDEuOTkzLDAsMCwxLS42MTkuNjcyTTc5LjY5Miw4LjQxN2wuMDA4LS4wNTZhMS4zODgsMS4zODgsMCwwLDEsLjMyMy0uODEyQTEuOTA2LDEuOTA2LDAsMCwxLDgwLjc5MSw3YTIuMzE0LDIuMzE0LDAsMCwxLC44MzEtLjE2OEEyLjIwNywyLjIwNywwLDAsMSw4Mi40MzQsN2ExLjc4NiwxLjc4NiwwLDAsMSwuNzI0LjU0OCwxLjQ2LDEuNDYsMCwwLDEsLjMuODA4bDAsLjA2NC4wMDguMTJINzkuNjcyWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI5LjAyMiAtMS45OTgpIiBmaWxsPSIjMTEwOTJiIi8+DQogICAgICA8cGF0aCBpZD0iUGF0aF85IiBkYXRhLW5hbWU9IlBhdGggOSIgZD0iTTcuNDUxLDQuNzU0YTIuNjg3LDIuNjg3LDAsMCwwLTEuOSw0LjU4N0w2LjcyLDguMTc0YTEuMDM2LDEuMDM2LDAsMSwxLDEuNDYzLDBMOS4zNSw5LjM0MWEyLjY4NywyLjY4NywwLDAsMC0xLjktNC41ODdaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMS43OCAtMS43NzQpIiBmaWxsPSIjODg0YmVmIi8+DQogICAgPC9nPg0KICA8L2c+DQo8L3N2Zz4NCg==",tte="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MSIgaGVpZ2h0PSI2MSIgdmlld0JveD0iMCAwIDYxIDYxIj4NCiAgPGcgaWQ9ImZpbGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yNDEgLTQ5KSI+DQogICAgPGcgaWQ9Ikljb24iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI0MSA0OSkiPg0KICAgICAgPHBhdGggaWQ9IlBhdGhfNDc3MyIgZGF0YS1uYW1lPSJQYXRoIDQ3NzMiIGQ9Ik0yNzkuNTg3LDczYTE0LjU4NywxNC41ODcsMCwxLDAsMTQuNTg3LDE0LjU4N0ExNC41OTQsMTQuNTk0LDAsMCwwLDI3OS41ODcsNzNabTAsMi42NTJhMTEuOTM1LDExLjkzNSwwLDEsMS0xMS45MzUsMTEuOTM1QTExLjk0MSwxMS45NDEsMCwwLDEsMjc5LjU4Nyw3NS42NTJaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjMzLjE3NCAtNDEuMTc0KSIgZmlsbD0iIzI1MmM4MiIgZmlsbC1ydWxlPSJldmVub2RkIi8+DQogICAgICA8cGF0aCBpZD0iUGF0aF80Nzc0IiBkYXRhLW5hbWU9IlBhdGggNDc3NCIgZD0iTTI4Ny40MTMsNDlIMjU2LjY4NWEzLjk3OCwzLjk3OCwwLDAsMC0yLjgxMywxLjE2NkwyNDIuMTY2LDYxLjg3MkEzLjk3OCwzLjk3OCwwLDAsMCwyNDEsNjQuNjg1djQxLjMzN0EzLjk3OCwzLjk3OCwwLDAsMCwyNDQuOTc4LDExMGgyOS40NDdhMS4zMjYsMS4zMjYsMCwwLDAsMC0yLjY1MkgyNDQuOTc4YTEuMzI3LDEuMzI3LDAsMCwxLTEuMzI2LTEuMzI2VjY2LjIzOWExLjMyNywxLjMyNywwLDAsMSwxLjMyNi0xLjMyNmg3Ljk1N2EzLjk4LDMuOTgsMCwwLDAsMy45NzgtMy45NzhWNTIuOTc4YTEuMzI3LDEuMzI3LDAsMCwxLDEuMzI2LTEuMzI2aDI5LjE3NGExLjMyNywxLjMyNywwLDAsMSwxLjMyNiwxLjMyNlY3Ny4wMzZhMS4zMjYsMS4zMjYsMCwxLDAsMi42NTIsMFY1Mi45NzhBMy45NzgsMy45NzgsMCwwLDAsMjg3LjQxMyw0OVptLTMzLjE1Miw0LjUyNy04LjczNCw4LjczNGg3LjQwOGExLjMyNywxLjMyNywwLDAsMCwxLjMyNi0xLjMyNloiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yNDEgLTQ5KSIgZmlsbD0iIzI1MmM4MiIgZmlsbC1ydWxlPSJldmVub2RkIi8+DQogICAgICA8ZyBpZD0iR3JvdXBfNDYyNSIgZGF0YS1uYW1lPSJHcm91cCA0NjI1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzOC44NjIgNDYuNDQpIHJvdGF0ZSgtNDUpIj4NCiAgICAgICAgPHBhdGggaWQ9IlBhdGhfNDc3NSIgZGF0YS1uYW1lPSJQYXRoIDQ3NzUiIGQ9Ik0wLDEuMzI2djUuM0ExLjMyNywxLjMyNywwLDAsMCwxLjMyNiw3Ljk1N0gxMS45MzVhMS4zMjYsMS4zMjYsMCwwLDAsMC0yLjY1MkgyLjY1MlYxLjMyNkExLjMyNiwxLjMyNiwwLDAsMCwwLDEuMzI2WiIgZmlsbD0iIzdiYjQwZSIgZmlsbC1ydWxlPSJldmVub2RkIi8+DQogICAgICA8L2c+DQogICAgICA8ZyBpZD0iR3JvdXBfNDYyNiIgZGF0YS1uYW1lPSJHcm91cCA0NjI2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMC42MDkgMjMuODcpIj4NCiAgICAgICAgPHBhdGggaWQ9IlBhdGhfNDc3NiIgZGF0YS1uYW1lPSJQYXRoIDQ3NzYiIGQ9Ik0yNTAuMzI2LDcxLjY1MmgyNi41MjJhMS4zMjYsMS4zMjYsMCwwLDAsMC0yLjY1MkgyNTAuMzI2YTEuMzI2LDEuMzI2LDAsMSwwLDAsMi42NTJaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjQ5IC02OSkiIGZpbGw9IiMyNTJjODIiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPg0KICAgICAgPC9nPg0KICAgICAgPGcgaWQ9Ikdyb3VwXzQ2MjciIGRhdGEtbmFtZT0iR3JvdXAgNDYyNyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAuNjA5IDMxLjgyNikiPg0KICAgICAgICA8cGF0aCBpZD0iUGF0aF80Nzc3IiBkYXRhLW5hbWU9IlBhdGggNDc3NyIgZD0iTTI1MC4zMjYsNzEuNjUyaDIxLjIxN2ExLjMyNiwxLjMyNiwwLDAsMCwwLTIuNjUySDI1MC4zMjZhMS4zMjYsMS4zMjYsMCwxLDAsMCwyLjY1MloiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yNDkgLTY5KSIgZmlsbD0iIzI1MmM4MiIgZmlsbC1ydWxlPSJldmVub2RkIi8+DQogICAgICA8L2c+DQogICAgICA8ZyBpZD0iR3JvdXBfNDYyOCIgZGF0YS1uYW1lPSJHcm91cCA0NjI4IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMC42MDkgMzkuNzgzKSI+DQogICAgICAgIDxwYXRoIGlkPSJQYXRoXzQ3NzgiIGRhdGEtbmFtZT0iUGF0aCA0Nzc4IiBkPSJNMjUwLjMyNiw3MS42NTJoMTUuOTEzYTEuMzI2LDEuMzI2LDAsMSwwLDAtMi42NTJIMjUwLjMyNmExLjMyNiwxLjMyNiwwLDEsMCwwLDIuNjUyWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI0OSAtNjkpIiBmaWxsPSIjMjUyYzgyIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz4NCiAgICAgIDwvZz4NCiAgICAgIDxnIGlkPSJHcm91cF80NjI5IiBkYXRhLW5hbWU9Ikdyb3VwIDQ2MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwLjYwOSA0Ny43MzkpIj4NCiAgICAgICAgPHBhdGggaWQ9IlBhdGhfNDc3OSIgZGF0YS1uYW1lPSJQYXRoIDQ3NzkiIGQ9Ik0yNTAuMzI2LDcxLjY1MmgxNS45MTNhMS4zMjYsMS4zMjYsMCwxLDAsMC0yLjY1MkgyNTAuMzI2YTEuMzI2LDEuMzI2LDAsMSwwLDAsMi42NTJaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjQ5IC02OSkiIGZpbGw9IiMyNTJjODIiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPg0KICAgICAgPC9nPg0KICAgIDwvZz4NCiAgPC9nPg0KPC9zdmc+DQo=",ete="",Vhe=(()=>{let p=class{constructor(v){ll(this,v),this.apiErrorEvent=ps(this,"apiError")}componentDidLoad(){return ce(this,null,function*(){yield dl.initialize(Ns.Agreements)})}componentWillLoad(){return ce(this,null,function*(){this.translations=yield vd.getValues(),this.buttonDisabled=!0})}disconnectedCallback(){return ce(this,null,function*(){yield dl.finalize(Ns.Agreements)})}buttonClick(){return ce(this,null,function*(){try{Qa.instance.GenerateAgreement("both"),Xe.flowStatus=yield Qa.instance.GetNextFlowState()}catch(v){this.apiErrorEvent.emit(v)}})}atBottomEmitted(v){this.buttonDisabled=!v.detail}leaveFlow(){return ce(this,null,function*(){try{let v=yield Qa.instance.AbortRequest();Xe.flowStatus=aa[v.state],yield qu.ectdata.delete(Xe.requestId),hh.flowAborted()}catch(v){hh.flowAborted(),this.apiErrorEvent.emit(v)}})}render(){return He("div",{key:"70ec76c5c5f1c6f0ebf01e9b6fe6c982b93b0a26",class:"container flex center"},He("div",{key:"27bcf7f70fd9bfccf9895a7f0d1b5ef9ea05aecf",class:"px-1"},He("div",{key:"3c618bb7021bb18f20f1221066797c0aa92fce86",class:"mb-1 text-center"},He("img",{key:"b00c2728098aa439d40c0b9fbd83c290471a91c1",src:tte})),He("h1",{key:"06b392b3f83970aa66b78fd619d8de5e750f8873",class:"text-center",innerHTML:this.translations.AgreementInfoValues.Title}),He("div",{key:"146c409e78a9522cc9a31e54625a8339e12eaa29",style:{height:"47vh"}},He("agreement-view",{key:"54cbe1a682da070035bd113d69c1dddaa85b1ffe",agreementType:"both"})),He("div",{key:"95c18fddbf9f9171cc3a00565ef5a2386b26d962",class:"button flex mb-1 mx-3"},He("button",{key:"8dcc6992ef8658acad14f43bf4b506f344226223",class:"main-button",disabled:this.buttonDisabled,onClick:()=>this.buttonClick()},this.translations.AgreementCheckValues.ButtonYes)),He("div",{key:"05fefc9dacb4fc173389e37b7536772939a10afd"},He("p",{key:"a01c635523bf1be316b4251d4b3649067f210dd0",class:"main-text link-text text-center",onClick:()=>this.leaveFlow()},this.translations.AgreementCheckValues.ButtonNo)),He("div",{key:"ef55eaa4365bd6a6ff8429ffd4ec762c9d1109ef",class:"footer text-center"},He("img",{key:"e67cc4344f2f1979267efb0d7dd4e3ac14fe9f3c",src:Cd}))))}};return p.style=ete,p})(),nte="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTAiIGhlaWdodD0iMTciIHZpZXdCb3g9IjAgMCAxMCAxNyI+DQogIDxkZWZzPg0KICAgIDxjbGlwUGF0aCBpZD0iY2xpcC1wYXRoIj4NCiAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGVfMTMwOSIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgMTMwOSIgd2lkdGg9IjgiIGhlaWdodD0iMTAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0wLjM1IDAuNDk0KSIgZmlsbD0iIzI1MmM4MiIvPg0KICAgIDwvY2xpcFBhdGg+DQogICAgPGNsaXBQYXRoIGlkPSJjbGlwLXBhdGgtMiI+DQogICAgICA8cmVjdCBpZD0iUmVjdGFuZ2xlXzEzMDktMiIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgMTMwOSIgd2lkdGg9IjgiIGhlaWdodD0iMTAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0wLjMzNyAwLjQ5NCkiIGZpbGw9IiMyNTJjODIiLz4NCiAgICA8L2NsaXBQYXRoPg0KICA8L2RlZnM+DQogIDxnIGlkPSJhcnJvd3NfZG93biIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTUuNDk0IC0xMzYuNjUpIHJvdGF0ZSg5MCkiPg0KICAgIDxnIGlkPSJHcm91cF80NTkxIiBkYXRhLW5hbWU9Ikdyb3VwIDQ1OTEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNyA4NSkiPg0KICAgICAgPGcgaWQ9Ikdyb3VwXzQ1OTAiIGRhdGEtbmFtZT0iR3JvdXAgNDU5MCIgY2xpcC1wYXRoPSJ1cmwoI2NsaXAtcGF0aCkiPg0KICAgICAgICA8cGF0aCBpZD0iUGF0aF80NzQ1IiBkYXRhLW5hbWU9IlBhdGggNDc0NSIgZD0iTTcuMSw1Ljk2My45NzYsMTAuODU1QS42LjYsMCwwLDEsMCwxMC4zODdWLjZBLjYuNiwwLDAsMSwuOTc2LjEzM0w3LjEsNS4wMjZhLjYuNiwwLDAsMSwwLC45MzYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgMCkiIGZpbGw9IiMyNTJjODIiLz4NCiAgICAgIDwvZz4NCiAgICA8L2c+DQogICAgPGcgaWQ9Ikdyb3VwXzQ1OTIiIGRhdGEtbmFtZT0iR3JvdXAgNDU5MiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTQ1Ljk4NyA4NSkiPg0KICAgICAgPGcgaWQ9Ikdyb3VwXzQ1OTAtMiIgZGF0YS1uYW1lPSJHcm91cCA0NTkwIiBjbGlwLXBhdGg9InVybCgjY2xpcC1wYXRoLTIpIj4NCiAgICAgICAgPHBhdGggaWQ9IlBhdGhfNDc0NS0yIiBkYXRhLW5hbWU9IlBhdGggNDc0NSIgZD0iTTcuMSw1Ljk2My45NzYsMTAuODU1QS42LjYsMCwwLDEsMCwxMC4zODdWLjZBLjYuNiwwLDAsMSwuOTc2LjEzM0w3LjEsNS4wMjZhLjYuNiwwLDAsMSwwLC45MzYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgMCkiIGZpbGw9IiMyNTJjODIiLz4NCiAgICAgIDwvZz4NCiAgICA8L2c+DQogIDwvZz4NCjwvc3ZnPg0K",Ghe=class{constructor(p){ll(this,p),this.apiErrorEvent=ps(this,"apiError"),this.atBottomEvent=ps(this,"atBottom"),this.atBottom=!1,this.scrollingToBottom=!1,this.scrollClass="scroll",this.handleScroll=v=>{if(this.scrollingToBottom)return;let k=v.target,N=5;this.atBottom=k.scrollHeight-k.scrollTop-k.clientHeight<N,this.atBottom&&this.atBottomEvent.emit(!0)},this.scrollToBottom=()=>{this.scrollingToBottom=!0,this.atBottom=!0,this.atBottomEvent.emit(!0),this.scrollContainer&&this.scrollContainer.scrollTo({top:this.scrollContainer.scrollHeight,behavior:"smooth"}),setTimeout(()=>{this.scrollingToBottom=!1},200)}}componentDidLoad(){return ce(this,null,function*(){try{this.htmlContent=yield Qa.instance.GetAgreement(this.agreementType)}catch(p){this.apiErrorEvent.emit(p)}})}render(){return He("div",{key:"cd56c70a5a3881b46bb546f69f23ebef4faf5eaa",class:"document-view"},He("div",{key:"7584d49c9577b96937e7732a171f2e9128ad4187",ref:p=>this.scrollContainer=p,class:this.scrollClass,style:{height:"calc(100% - 60px)"},onScroll:this.handleScroll,innerHTML:this.htmlContent}),He("div",{key:"968c63096b18be3fc3edd2c7330d3039f1810dd6",class:"flex center text-center",onClick:this.scrollToBottom,style:{height:"60px"}},He("img",{key:"b9b91752debd3ffc951cfb9e87eb16a3aeaf84eb",src:nte})))}},uw=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{};function DFt(){throw new Error("setTimeout has not been defined")}function RFt(){throw new Error("clearTimeout has not been defined")}var zk=DFt,Pk=RFt;typeof uw.setTimeout=="function"&&(zk=setTimeout);typeof uw.clearTimeout=="function"&&(Pk=clearTimeout);function FFt(p){if(zk===setTimeout)return setTimeout(p,0);if((zk===DFt||!zk)&&setTimeout)return zk=setTimeout,setTimeout(p,0);try{return zk(p,0)}catch{try{return zk.call(null,p,0)}catch{return zk.call(this,p,0)}}}function rte(p){if(Pk===clearTimeout)return clearTimeout(p);if((Pk===RFt||!Pk)&&clearTimeout)return Pk=clearTimeout,clearTimeout(p);try{return Pk(p)}catch{try{return Pk.call(null,p)}catch{return Pk.call(this,p)}}}var Z3=[],pD=!1,Z9,xst=-1;function ite(){!pD||!Z9||(pD=!1,Z9.length?Z3=Z9.concat(Z3):xst=-1,Z3.length&&OFt())}function OFt(){if(!pD){var p=FFt(ite);pD=!0;for(var v=Z3.length;v;){for(Z9=Z3,Z3=[];++xst<v;)Z9&&Z9[xst].run();xst=-1,v=Z3.length}Z9=null,pD=!1,rte(p)}}function um(p){var v=new Array(arguments.length-1);if(arguments.length>1)for(var k=1;k<arguments.length;k++)v[k-1]=arguments[k];Z3.push(new LFt(p,v)),Z3.length===1&&!pD&&FFt(OFt)}function LFt(p,v){this.fun=p,this.array=v}LFt.prototype.run=function(){this.fun.apply(null,this.array)};var ate="browser",ote="browser",ste=!0,ute={},lte=[],cte="",hte={},dte={},fte={};function N8(){}var pte=N8,mte=N8,gte=N8,yte=N8,vte=N8,bte=N8,wte=N8;function xte(p){throw new Error("process.binding is not supported")}function kte(){return"/"}function Ste(p){throw new Error("process.chdir is not supported")}function _te(){return 0}var QM=uw.performance||{},Cte=QM.now||QM.mozNow||QM.msNow||QM.oNow||QM.webkitNow||function(){return new Date().getTime()};function Ete(p){var v=Cte.call(QM)*.001,k=Math.floor(v),N=Math.floor(v%1*1e9);return p&&(k=k-p[0],N=N-p[1],N<0&&(k--,N+=1e9)),[k,N]}var Tte=new Date;function Ate(){var p=new Date,v=p-Tte;return v/1e3}var Iu={nextTick:um,title:ate,browser:ste,env:ute,argv:lte,version:cte,versions:hte,on:pte,addListener:mte,once:gte,off:yte,removeListener:vte,removeAllListeners:bte,emit:wte,binding:xte,cwd:kte,chdir:Ste,umask:_te,hrtime:Ete,platform:ote,release:dte,config:fte,uptime:Ate},ev=[],fg=[],Ite=typeof Uint8Array<"u"?Uint8Array:Array,g4t=!1;function $Ft(){g4t=!0;for(var p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v=0,k=p.length;v<k;++v)ev[v]=p[v],fg[p.charCodeAt(v)]=v;fg[45]=62,fg[95]=63}function Nte(p){g4t||$Ft();var v,k,N,F,W,L,O=p.length;if(O%4>0)throw new Error("Invalid string. Length must be a multiple of 4");W=p[O-2]==="="?2:p[O-1]==="="?1:0,L=new Ite(O*3/4-W),N=W>0?O-4:O;var S=0;for(v=0,k=0;v<N;v+=4,k+=3)F=fg[p.charCodeAt(v)]<<18|fg[p.charCodeAt(v+1)]<<12|fg[p.charCodeAt(v+2)]<<6|fg[p.charCodeAt(v+3)],L[S++]=F>>16&255,L[S++]=F>>8&255,L[S++]=F&255;return W===2?(F=fg[p.charCodeAt(v)]<<2|fg[p.charCodeAt(v+1)]>>4,L[S++]=F&255):W===1&&(F=fg[p.charCodeAt(v)]<<10|fg[p.charCodeAt(v+1)]<<4|fg[p.charCodeAt(v+2)]>>2,L[S++]=F>>8&255,L[S++]=F&255),L}function Mte(p){return ev[p>>18&63]+ev[p>>12&63]+ev[p>>6&63]+ev[p&63]}function Dte(p,v,k){for(var N,F=[],W=v;W<k;W+=3)N=(p[W]<<16)+(p[W+1]<<8)+p[W+2],F.push(Mte(N));return F.join("")}function DNt(p){g4t||$Ft();for(var v,k=p.length,N=k%3,F="",W=[],L=16383,O=0,S=k-N;O<S;O+=L)W.push(Dte(p,O,O+L>S?S:O+L));return N===1?(v=p[k-1],F+=ev[v>>2],F+=ev[v<<4&63],F+="=="):N===2&&(v=(p[k-2]<<8)+p[k-1],F+=ev[v>>10],F+=ev[v>>4&63],F+=ev[v<<2&63],F+="="),W.push(F),W.join("")}function Hut(p,v,k,N,F){var W,L,O=F*8-N-1,S=(1<<O)-1,B=S>>1,j=-7,K=k?F-1:0,Z=k?-1:1,Y=p[v+K];for(K+=Z,W=Y&(1<<-j)-1,Y>>=-j,j+=O;j>0;W=W*256+p[v+K],K+=Z,j-=8);for(L=W&(1<<-j)-1,W>>=-j,j+=N;j>0;L=L*256+p[v+K],K+=Z,j-=8);if(W===0)W=1-B;else{if(W===S)return L?NaN:(Y?-1:1)*(1/0);L=L+Math.pow(2,N),W=W-B}return(Y?-1:1)*L*Math.pow(2,W-N)}function zFt(p,v,k,N,F,W){var L,O,S,B=W*8-F-1,j=(1<<B)-1,K=j>>1,Z=F===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=N?0:W-1,X=N?1:-1,J=v<0||v===0&&1/v<0?1:0;for(v=Math.abs(v),isNaN(v)||v===1/0?(O=isNaN(v)?1:0,L=j):(L=Math.floor(Math.log(v)/Math.LN2),v*(S=Math.pow(2,-L))<1&&(L--,S*=2),L+K>=1?v+=Z/S:v+=Z*Math.pow(2,1-K),v*S>=2&&(L++,S/=2),L+K>=j?(O=0,L=j):L+K>=1?(O=(v*S-1)*Math.pow(2,F),L=L+K):(O=v*Math.pow(2,K-1)*Math.pow(2,F),L=0));F>=8;p[k+Y]=O&255,Y+=X,O/=256,F-=8);for(L=L<<F|O,B+=F;B>0;p[k+Y]=L&255,Y+=X,L/=256,B-=8);p[k+Y-X]|=J*128}var Rte={}.toString,PFt=Array.isArray||function(p){return Rte.call(p)=="[object Array]"};var BFt=50;Un.TYPED_ARRAY_SUPPORT=uw.TYPED_ARRAY_SUPPORT!==void 0?uw.TYPED_ARRAY_SUPPORT:!0;var Fte=Wst();function Wst(){return Un.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Q3(p,v){if(Wst()<v)throw new RangeError("Invalid typed array length");return Un.TYPED_ARRAY_SUPPORT?(p=new Uint8Array(v),p.__proto__=Un.prototype):(p===null&&(p=new Un(v)),p.length=v),p}function Un(p,v,k){if(!Un.TYPED_ARRAY_SUPPORT&&!(this instanceof Un))return new Un(p,v,k);if(typeof p=="number"){if(typeof v=="string")throw new Error("If encoding is specified then the first argument must be a string");return y4t(this,p)}return jFt(this,p,v,k)}Un.poolSize=8192;Un._augment=function(p){return p.__proto__=Un.prototype,p};function jFt(p,v,k,N){if(typeof v=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&v instanceof ArrayBuffer?$te(p,v,k,N):typeof v=="string"?Lte(p,v,k):zte(p,v)}Un.from=function(p,v,k){return jFt(null,p,v,k)};Un.TYPED_ARRAY_SUPPORT&&(Un.prototype.__proto__=Uint8Array.prototype,Un.__proto__=Uint8Array);function UFt(p){if(typeof p!="number")throw new TypeError('"size" argument must be a number');if(p<0)throw new RangeError('"size" argument must not be negative')}function Ote(p,v,k,N){return UFt(v),v<=0?Q3(p,v):k!==void 0?typeof N=="string"?Q3(p,v).fill(k,N):Q3(p,v).fill(k):Q3(p,v)}Un.alloc=function(p,v,k){return Ote(null,p,v,k)};function y4t(p,v){if(UFt(v),p=Q3(p,v<0?0:v4t(v)|0),!Un.TYPED_ARRAY_SUPPORT)for(var k=0;k<v;++k)p[k]=0;return p}Un.allocUnsafe=function(p){return y4t(null,p)};Un.allocUnsafeSlow=function(p){return y4t(null,p)};function Lte(p,v,k){if((typeof k!="string"||k==="")&&(k="utf8"),!Un.isEncoding(k))throw new TypeError('"encoding" must be a valid string encoding');var N=WFt(v,k)|0;p=Q3(p,N);var F=p.write(v,k);return F!==N&&(p=p.slice(0,F)),p}function Jwt(p,v){var k=v.length<0?0:v4t(v.length)|0;p=Q3(p,k);for(var N=0;N<k;N+=1)p[N]=v[N]&255;return p}function $te(p,v,k,N){if(k<0||v.byteLength<k)throw new RangeError("'offset' is out of bounds");if(v.byteLength<k+(N||0))throw new RangeError("'length' is out of bounds");return k===void 0&&N===void 0?v=new Uint8Array(v):N===void 0?v=new Uint8Array(v,k):v=new Uint8Array(v,k,N),Un.TYPED_ARRAY_SUPPORT?(p=v,p.__proto__=Un.prototype):p=Jwt(p,v),p}function zte(p,v){if(hv(v)){var k=v4t(v.length)|0;return p=Q3(p,k),p.length===0||v.copy(p,0,0,k),p}if(v){if(typeof ArrayBuffer<"u"&&v.buffer instanceof ArrayBuffer||"length"in v)return typeof v.length!="number"||iee(v.length)?Q3(p,0):Jwt(p,v);if(v.type==="Buffer"&&PFt(v.data))return Jwt(p,v.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function v4t(p){if(p>=Wst())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Wst().toString(16)+" bytes");return p|0}function Pte(p){return+p!=p&&(p=0),Un.alloc(+p)}Un.isBuffer=J9;function hv(p){return!!(p!=null&&p._isBuffer)}Un.compare=function(v,k){if(!hv(v)||!hv(k))throw new TypeError("Arguments must be Buffers");if(v===k)return 0;for(var N=v.length,F=k.length,W=0,L=Math.min(N,F);W<L;++W)if(v[W]!==k[W]){N=v[W],F=k[W];break}return N<F?-1:F<N?1:0};Un.isEncoding=function(v){switch(String(v).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};Un.concat=function(v,k){if(!PFt(v))throw new TypeError('"list" argument must be an Array of Buffers');if(v.length===0)return Un.alloc(0);var N;if(k===void 0)for(k=0,N=0;N<v.length;++N)k+=v[N].length;var F=Un.allocUnsafe(k),W=0;for(N=0;N<v.length;++N){var L=v[N];if(!hv(L))throw new TypeError('"list" argument must be an Array of Buffers');L.copy(F,W),W+=L.length}return F};function WFt(p,v){if(hv(p))return p.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(p)||p instanceof ArrayBuffer))return p.byteLength;typeof p!="string"&&(p=""+p);var k=p.length;if(k===0)return 0;for(var N=!1;;)switch(v){case"ascii":case"latin1":case"binary":return k;case"utf8":case"utf-8":case void 0:return Vst(p).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k*2;case"hex":return k>>>1;case"base64":return KFt(p).length;default:if(N)return Vst(p).length;v=(""+v).toLowerCase(),N=!0}}Un.byteLength=WFt;function Bte(p,v,k){var N=!1;if((v===void 0||v<0)&&(v=0),v>this.length||((k===void 0||k>this.length)&&(k=this.length),k<=0)||(k>>>=0,v>>>=0,k<=v))return"";for(p||(p="utf8");;)switch(p){case"hex":return Kte(this,v,k);case"utf8":case"utf-8":return HFt(this,v,k);case"ascii":return qte(this,v,k);case"latin1":case"binary":return Xte(this,v,k);case"base64":return Hte(this,v,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Zte(this,v,k);default:if(N)throw new TypeError("Unknown encoding: "+p);p=(p+"").toLowerCase(),N=!0}}Un.prototype._isBuffer=!0;function Q9(p,v,k){var N=p[v];p[v]=p[k],p[k]=N}Un.prototype.swap16=function(){var v=this.length;if(v%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var k=0;k<v;k+=2)Q9(this,k,k+1);return this};Un.prototype.swap32=function(){var v=this.length;if(v%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var k=0;k<v;k+=4)Q9(this,k,k+3),Q9(this,k+1,k+2);return this};Un.prototype.swap64=function(){var v=this.length;if(v%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var k=0;k<v;k+=8)Q9(this,k,k+7),Q9(this,k+1,k+6),Q9(this,k+2,k+5),Q9(this,k+3,k+4);return this};Un.prototype.toString=function(){var v=this.length|0;return v===0?"":arguments.length===0?HFt(this,0,v):Bte.apply(this,arguments)};Un.prototype.equals=function(v){if(!hv(v))throw new TypeError("Argument must be a Buffer");return this===v?!0:Un.compare(this,v)===0};Un.prototype.inspect=function(){var v="",k=BFt;return this.length>0&&(v=this.toString("hex",0,k).match(/.{2}/g).join(" "),this.length>k&&(v+=" ... ")),"<Buffer "+v+">"};Un.prototype.compare=function(v,k,N,F,W){if(!hv(v))throw new TypeError("Argument must be a Buffer");if(k===void 0&&(k=0),N===void 0&&(N=v?v.length:0),F===void 0&&(F=0),W===void 0&&(W=this.length),k<0||N>v.length||F<0||W>this.length)throw new RangeError("out of range index");if(F>=W&&k>=N)return 0;if(F>=W)return-1;if(k>=N)return 1;if(k>>>=0,N>>>=0,F>>>=0,W>>>=0,this===v)return 0;for(var L=W-F,O=N-k,S=Math.min(L,O),B=this.slice(F,W),j=v.slice(k,N),K=0;K<S;++K)if(B[K]!==j[K]){L=B[K],O=j[K];break}return L<O?-1:O<L?1:0};function VFt(p,v,k,N,F){if(p.length===0)return-1;if(typeof k=="string"?(N=k,k=0):k>2147483647?k=2147483647:k<-2147483648&&(k=-2147483648),k=+k,isNaN(k)&&(k=F?0:p.length-1),k<0&&(k=p.length+k),k>=p.length){if(F)return-1;k=p.length-1}else if(k<0)if(F)k=0;else return-1;if(typeof v=="string"&&(v=Un.from(v,N)),hv(v))return v.length===0?-1:RNt(p,v,k,N,F);if(typeof v=="number")return v=v&255,Un.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?F?Uint8Array.prototype.indexOf.call(p,v,k):Uint8Array.prototype.lastIndexOf.call(p,v,k):RNt(p,[v],k,N,F);throw new TypeError("val must be string, number or Buffer")}function RNt(p,v,k,N,F){var W=1,L=p.length,O=v.length;if(N!==void 0&&(N=String(N).toLowerCase(),N==="ucs2"||N==="ucs-2"||N==="utf16le"||N==="utf-16le")){if(p.length<2||v.length<2)return-1;W=2,L/=2,O/=2,k/=2}function S(Y,X){return W===1?Y[X]:Y.readUInt16BE(X*W)}var B;if(F){var j=-1;for(B=k;B<L;B++)if(S(p,B)===S(v,j===-1?0:B-j)){if(j===-1&&(j=B),B-j+1===O)return j*W}else j!==-1&&(B-=B-j),j=-1}else for(k+O>L&&(k=L-O),B=k;B>=0;B--){for(var K=!0,Z=0;Z<O;Z++)if(S(p,B+Z)!==S(v,Z)){K=!1;break}if(K)return B}return-1}Un.prototype.includes=function(v,k,N){return this.indexOf(v,k,N)!==-1};Un.prototype.indexOf=function(v,k,N){return VFt(this,v,k,N,!0)};Un.prototype.lastIndexOf=function(v,k,N){return VFt(this,v,k,N,!1)};function jte(p,v,k,N){k=Number(k)||0;var F=p.length-k;N?(N=Number(N),N>F&&(N=F)):N=F;var W=v.length;if(W%2!==0)throw new TypeError("Invalid hex string");N>W/2&&(N=W/2);for(var L=0;L<N;++L){var O=parseInt(v.substr(L*2,2),16);if(isNaN(O))return L;p[k+L]=O}return L}function Ute(p,v,k,N){return Xut(Vst(v,p.length-k),p,k,N)}function GFt(p,v,k,N){return Xut(nee(v),p,k,N)}function Wte(p,v,k,N){return GFt(p,v,k,N)}function Vte(p,v,k,N){return Xut(KFt(v),p,k,N)}function Gte(p,v,k,N){return Xut(ree(v,p.length-k),p,k,N)}Un.prototype.write=function(v,k,N,F){if(k===void 0)F="utf8",N=this.length,k=0;else if(N===void 0&&typeof k=="string")F=k,N=this.length,k=0;else if(isFinite(k))k=k|0,isFinite(N)?(N=N|0,F===void 0&&(F="utf8")):(F=N,N=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var W=this.length-k;if((N===void 0||N>W)&&(N=W),v.length>0&&(N<0||k<0)||k>this.length)throw new RangeError("Attempt to write outside buffer bounds");F||(F="utf8");for(var L=!1;;)switch(F){case"hex":return jte(this,v,k,N);case"utf8":case"utf-8":return Ute(this,v,k,N);case"ascii":return GFt(this,v,k,N);case"latin1":case"binary":return Wte(this,v,k,N);case"base64":return Vte(this,v,k,N);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Gte(this,v,k,N);default:if(L)throw new TypeError("Unknown encoding: "+F);F=(""+F).toLowerCase(),L=!0}};Un.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Hte(p,v,k){return v===0&&k===p.length?DNt(p):DNt(p.slice(v,k))}function HFt(p,v,k){k=Math.min(p.length,k);for(var N=[],F=v;F<k;){var W=p[F],L=null,O=W>239?4:W>223?3:W>191?2:1;if(F+O<=k){var S,B,j,K;switch(O){case 1:W<128&&(L=W);break;case 2:S=p[F+1],(S&192)===128&&(K=(W&31)<<6|S&63,K>127&&(L=K));break;case 3:S=p[F+1],B=p[F+2],(S&192)===128&&(B&192)===128&&(K=(W&15)<<12|(S&63)<<6|B&63,K>2047&&(K<55296||K>57343)&&(L=K));break;case 4:S=p[F+1],B=p[F+2],j=p[F+3],(S&192)===128&&(B&192)===128&&(j&192)===128&&(K=(W&15)<<18|(S&63)<<12|(B&63)<<6|j&63,K>65535&&K<1114112&&(L=K))}}L===null?(L=65533,O=1):L>65535&&(L-=65536,N.push(L>>>10&1023|55296),L=56320|L&1023),N.push(L),F+=O}return Yte(N)}var FNt=4096;function Yte(p){var v=p.length;if(v<=FNt)return String.fromCharCode.apply(String,p);for(var k="",N=0;N<v;)k+=String.fromCharCode.apply(String,p.slice(N,N+=FNt));return k}function qte(p,v,k){var N="";k=Math.min(p.length,k);for(var F=v;F<k;++F)N+=String.fromCharCode(p[F]&127);return N}function Xte(p,v,k){var N="";k=Math.min(p.length,k);for(var F=v;F<k;++F)N+=String.fromCharCode(p[F]);return N}function Kte(p,v,k){var N=p.length;(!v||v<0)&&(v=0),(!k||k<0||k>N)&&(k=N);for(var F="",W=v;W<k;++W)F+=eee(p[W]);return F}function Zte(p,v,k){for(var N=p.slice(v,k),F="",W=0;W<N.length;W+=2)F+=String.fromCharCode(N[W]+N[W+1]*256);return F}Un.prototype.slice=function(v,k){var N=this.length;v=~~v,k=k===void 0?N:~~k,v<0?(v+=N,v<0&&(v=0)):v>N&&(v=N),k<0?(k+=N,k<0&&(k=0)):k>N&&(k=N),k<v&&(k=v);var F;if(Un.TYPED_ARRAY_SUPPORT)F=this.subarray(v,k),F.__proto__=Un.prototype;else{var W=k-v;F=new Un(W,void 0);for(var L=0;L<W;++L)F[L]=this[L+v]}return F};function Hh(p,v,k){if(p%1!==0||p<0)throw new RangeError("offset is not uint");if(p+v>k)throw new RangeError("Trying to access beyond buffer length")}Un.prototype.readUIntLE=function(v,k,N){v=v|0,k=k|0,N||Hh(v,k,this.length);for(var F=this[v],W=1,L=0;++L<k&&(W*=256);)F+=this[v+L]*W;return F};Un.prototype.readUIntBE=function(v,k,N){v=v|0,k=k|0,N||Hh(v,k,this.length);for(var F=this[v+--k],W=1;k>0&&(W*=256);)F+=this[v+--k]*W;return F};Un.prototype.readUInt8=function(v,k){return k||Hh(v,1,this.length),this[v]};Un.prototype.readUInt16LE=function(v,k){return k||Hh(v,2,this.length),this[v]|this[v+1]<<8};Un.prototype.readUInt16BE=function(v,k){return k||Hh(v,2,this.length),this[v]<<8|this[v+1]};Un.prototype.readUInt32LE=function(v,k){return k||Hh(v,4,this.length),(this[v]|this[v+1]<<8|this[v+2]<<16)+this[v+3]*16777216};Un.prototype.readUInt32BE=function(v,k){return k||Hh(v,4,this.length),this[v]*16777216+(this[v+1]<<16|this[v+2]<<8|this[v+3])};Un.prototype.readIntLE=function(v,k,N){v=v|0,k=k|0,N||Hh(v,k,this.length);for(var F=this[v],W=1,L=0;++L<k&&(W*=256);)F+=this[v+L]*W;return W*=128,F>=W&&(F-=Math.pow(2,8*k)),F};Un.prototype.readIntBE=function(v,k,N){v=v|0,k=k|0,N||Hh(v,k,this.length);for(var F=k,W=1,L=this[v+--F];F>0&&(W*=256);)L+=this[v+--F]*W;return W*=128,L>=W&&(L-=Math.pow(2,8*k)),L};Un.prototype.readInt8=function(v,k){return k||Hh(v,1,this.length),this[v]&128?(255-this[v]+1)*-1:this[v]};Un.prototype.readInt16LE=function(v,k){k||Hh(v,2,this.length);var N=this[v]|this[v+1]<<8;return N&32768?N|4294901760:N};Un.prototype.readInt16BE=function(v,k){k||Hh(v,2,this.length);var N=this[v+1]|this[v]<<8;return N&32768?N|4294901760:N};Un.prototype.readInt32LE=function(v,k){return k||Hh(v,4,this.length),this[v]|this[v+1]<<8|this[v+2]<<16|this[v+3]<<24};Un.prototype.readInt32BE=function(v,k){return k||Hh(v,4,this.length),this[v]<<24|this[v+1]<<16|this[v+2]<<8|this[v+3]};Un.prototype.readFloatLE=function(v,k){return k||Hh(v,4,this.length),Hut(this,v,!0,23,4)};Un.prototype.readFloatBE=function(v,k){return k||Hh(v,4,this.length),Hut(this,v,!1,23,4)};Un.prototype.readDoubleLE=function(v,k){return k||Hh(v,8,this.length),Hut(this,v,!0,52,8)};Un.prototype.readDoubleBE=function(v,k){return k||Hh(v,8,this.length),Hut(this,v,!1,52,8)};function e0(p,v,k,N,F,W){if(!hv(p))throw new TypeError('"buffer" argument must be a Buffer instance');if(v>F||v<W)throw new RangeError('"value" argument is out of bounds');if(k+N>p.length)throw new RangeError("Index out of range")}Un.prototype.writeUIntLE=function(v,k,N,F){if(v=+v,k=k|0,N=N|0,!F){var W=Math.pow(2,8*N)-1;e0(this,v,k,N,W,0)}var L=1,O=0;for(this[k]=v&255;++O<N&&(L*=256);)this[k+O]=v/L&255;return k+N};Un.prototype.writeUIntBE=function(v,k,N,F){if(v=+v,k=k|0,N=N|0,!F){var W=Math.pow(2,8*N)-1;e0(this,v,k,N,W,0)}var L=N-1,O=1;for(this[k+L]=v&255;--L>=0&&(O*=256);)this[k+L]=v/O&255;return k+N};Un.prototype.writeUInt8=function(v,k,N){return v=+v,k=k|0,N||e0(this,v,k,1,255,0),Un.TYPED_ARRAY_SUPPORT||(v=Math.floor(v)),this[k]=v&255,k+1};function Yut(p,v,k,N){v<0&&(v=65535+v+1);for(var F=0,W=Math.min(p.length-k,2);F<W;++F)p[k+F]=(v&255<<8*(N?F:1-F))>>>(N?F:1-F)*8}Un.prototype.writeUInt16LE=function(v,k,N){return v=+v,k=k|0,N||e0(this,v,k,2,65535,0),Un.TYPED_ARRAY_SUPPORT?(this[k]=v&255,this[k+1]=v>>>8):Yut(this,v,k,!0),k+2};Un.prototype.writeUInt16BE=function(v,k,N){return v=+v,k=k|0,N||e0(this,v,k,2,65535,0),Un.TYPED_ARRAY_SUPPORT?(this[k]=v>>>8,this[k+1]=v&255):Yut(this,v,k,!1),k+2};function qut(p,v,k,N){v<0&&(v=4294967295+v+1);for(var F=0,W=Math.min(p.length-k,4);F<W;++F)p[k+F]=v>>>(N?F:3-F)*8&255}Un.prototype.writeUInt32LE=function(v,k,N){return v=+v,k=k|0,N||e0(this,v,k,4,4294967295,0),Un.TYPED_ARRAY_SUPPORT?(this[k+3]=v>>>24,this[k+2]=v>>>16,this[k+1]=v>>>8,this[k]=v&255):qut(this,v,k,!0),k+4};Un.prototype.writeUInt32BE=function(v,k,N){return v=+v,k=k|0,N||e0(this,v,k,4,4294967295,0),Un.TYPED_ARRAY_SUPPORT?(this[k]=v>>>24,this[k+1]=v>>>16,this[k+2]=v>>>8,this[k+3]=v&255):qut(this,v,k,!1),k+4};Un.prototype.writeIntLE=function(v,k,N,F){if(v=+v,k=k|0,!F){var W=Math.pow(2,8*N-1);e0(this,v,k,N,W-1,-W)}var L=0,O=1,S=0;for(this[k]=v&255;++L<N&&(O*=256);)v<0&&S===0&&this[k+L-1]!==0&&(S=1),this[k+L]=(v/O>>0)-S&255;return k+N};Un.prototype.writeIntBE=function(v,k,N,F){if(v=+v,k=k|0,!F){var W=Math.pow(2,8*N-1);e0(this,v,k,N,W-1,-W)}var L=N-1,O=1,S=0;for(this[k+L]=v&255;--L>=0&&(O*=256);)v<0&&S===0&&this[k+L+1]!==0&&(S=1),this[k+L]=(v/O>>0)-S&255;return k+N};Un.prototype.writeInt8=function(v,k,N){return v=+v,k=k|0,N||e0(this,v,k,1,127,-128),Un.TYPED_ARRAY_SUPPORT||(v=Math.floor(v)),v<0&&(v=255+v+1),this[k]=v&255,k+1};Un.prototype.writeInt16LE=function(v,k,N){return v=+v,k=k|0,N||e0(this,v,k,2,32767,-32768),Un.TYPED_ARRAY_SUPPORT?(this[k]=v&255,this[k+1]=v>>>8):Yut(this,v,k,!0),k+2};Un.prototype.writeInt16BE=function(v,k,N){return v=+v,k=k|0,N||e0(this,v,k,2,32767,-32768),Un.TYPED_ARRAY_SUPPORT?(this[k]=v>>>8,this[k+1]=v&255):Yut(this,v,k,!1),k+2};Un.prototype.writeInt32LE=function(v,k,N){return v=+v,k=k|0,N||e0(this,v,k,4,2147483647,-2147483648),Un.TYPED_ARRAY_SUPPORT?(this[k]=v&255,this[k+1]=v>>>8,this[k+2]=v>>>16,this[k+3]=v>>>24):qut(this,v,k,!0),k+4};Un.prototype.writeInt32BE=function(v,k,N){return v=+v,k=k|0,N||e0(this,v,k,4,2147483647,-2147483648),v<0&&(v=4294967295+v+1),Un.TYPED_ARRAY_SUPPORT?(this[k]=v>>>24,this[k+1]=v>>>16,this[k+2]=v>>>8,this[k+3]=v&255):qut(this,v,k,!1),k+4};function YFt(p,v,k,N,F,W){if(k+N>p.length)throw new RangeError("Index out of range");if(k<0)throw new RangeError("Index out of range")}function qFt(p,v,k,N,F){return F||YFt(p,v,k,4),zFt(p,v,k,N,23,4),k+4}Un.prototype.writeFloatLE=function(v,k,N){return qFt(this,v,k,!0,N)};Un.prototype.writeFloatBE=function(v,k,N){return qFt(this,v,k,!1,N)};function XFt(p,v,k,N,F){return F||YFt(p,v,k,8),zFt(p,v,k,N,52,8),k+8}Un.prototype.writeDoubleLE=function(v,k,N){return XFt(this,v,k,!0,N)};Un.prototype.writeDoubleBE=function(v,k,N){return XFt(this,v,k,!1,N)};Un.prototype.copy=function(v,k,N,F){if(N||(N=0),!F&&F!==0&&(F=this.length),k>=v.length&&(k=v.length),k||(k=0),F>0&&F<N&&(F=N),F===N||v.length===0||this.length===0)return 0;if(k<0)throw new RangeError("targetStart out of bounds");if(N<0||N>=this.length)throw new RangeError("sourceStart out of bounds");if(F<0)throw new RangeError("sourceEnd out of bounds");F>this.length&&(F=this.length),v.length-k<F-N&&(F=v.length-k+N);var W=F-N,L;if(this===v&&N<k&&k<F)for(L=W-1;L>=0;--L)v[L+k]=this[L+N];else if(W<1e3||!Un.TYPED_ARRAY_SUPPORT)for(L=0;L<W;++L)v[L+k]=this[L+N];else Uint8Array.prototype.set.call(v,this.subarray(N,N+W),k);return W};Un.prototype.fill=function(v,k,N,F){if(typeof v=="string"){if(typeof k=="string"?(F=k,k=0,N=this.length):typeof N=="string"&&(F=N,N=this.length),v.length===1){var W=v.charCodeAt(0);W<256&&(v=W)}if(F!==void 0&&typeof F!="string")throw new TypeError("encoding must be a string");if(typeof F=="string"&&!Un.isEncoding(F))throw new TypeError("Unknown encoding: "+F)}else typeof v=="number"&&(v=v&255);if(k<0||this.length<k||this.length<N)throw new RangeError("Out of range index");if(N<=k)return this;k=k>>>0,N=N===void 0?this.length:N>>>0,v||(v=0);var L;if(typeof v=="number")for(L=k;L<N;++L)this[L]=v;else{var O=hv(v)?v:Vst(new Un(v,F).toString()),S=O.length;for(L=0;L<N-k;++L)this[L+k]=O[L%S]}return this};var Qte=/[^+\/0-9A-Za-z-_]/g;function Jte(p){if(p=tee(p).replace(Qte,""),p.length<2)return"";for(;p.length%4!==0;)p=p+"=";return p}function tee(p){return p.trim?p.trim():p.replace(/^\s+|\s+$/g,"")}function eee(p){return p<16?"0"+p.toString(16):p.toString(16)}function Vst(p,v){v=v||1/0;for(var k,N=p.length,F=null,W=[],L=0;L<N;++L){if(k=p.charCodeAt(L),k>55295&&k<57344){if(!F){if(k>56319){(v-=3)>-1&&W.push(239,191,189);continue}else if(L+1===N){(v-=3)>-1&&W.push(239,191,189);continue}F=k;continue}if(k<56320){(v-=3)>-1&&W.push(239,191,189),F=k;continue}k=(F-55296<<10|k-56320)+65536}else F&&(v-=3)>-1&&W.push(239,191,189);if(F=null,k<128){if((v-=1)<0)break;W.push(k)}else if(k<2048){if((v-=2)<0)break;W.push(k>>6|192,k&63|128)}else if(k<65536){if((v-=3)<0)break;W.push(k>>12|224,k>>6&63|128,k&63|128)}else if(k<1114112){if((v-=4)<0)break;W.push(k>>18|240,k>>12&63|128,k>>6&63|128,k&63|128)}else throw new Error("Invalid code point")}return W}function nee(p){for(var v=[],k=0;k<p.length;++k)v.push(p.charCodeAt(k)&255);return v}function ree(p,v){for(var k,N,F,W=[],L=0;L<p.length&&!((v-=2)<0);++L)k=p.charCodeAt(L),N=k>>8,F=k%256,W.push(F),W.push(N);return W}function KFt(p){return Nte(Jte(p))}function Xut(p,v,k,N){for(var F=0;F<N&&!(F+k>=v.length||F>=p.length);++F)v[F+k]=p[F];return F}function iee(p){return p!==p}function J9(p){return p!=null&&(!!p._isBuffer||ZFt(p)||aee(p))}function ZFt(p){return!!p.constructor&&typeof p.constructor.isBuffer=="function"&&p.constructor.isBuffer(p)}function aee(p){return typeof p.readFloatLE=="function"&&typeof p.slice=="function"&&ZFt(p.slice(0,0))}var oee=Object.freeze({__proto__:null,Buffer:Un,INSPECT_MAX_BYTES:BFt,SlowBuffer:Pte,isBuffer:J9,kMaxLength:Fte}),fbt={exports:{}},ONt;function see(){return ONt||(ONt=1,function(p,v){(function(k,N){p.exports=N()})(self,()=>(()=>{var k={2726:function(L,O,S){(function(){var B;function j(Dt){var Zt=0;return function(){return Zt<Dt.length?{done:!1,value:Dt[Zt++]}:{done:!0}}}var K=typeof Object.defineProperties=="function"?Object.defineProperty:function(Dt,Zt,Ce){return Dt==Array.prototype||Dt==Object.prototype||(Dt[Zt]=Ce.value),Dt},Z=function(Dt){Dt=[typeof globalThis=="object"&&globalThis,Dt,typeof window=="object"&&window,typeof self=="object"&&self,typeof S.g=="object"&&S.g];for(var Zt=0;Zt<Dt.length;++Zt){var Ce=Dt[Zt];if(Ce&&Ce.Math==Math)return Ce}throw Error("Cannot find global object")}(this);function Y(Dt,Zt){if(Zt)t:{var Ce=Z;Dt=Dt.split(".");for(var le=0;le<Dt.length-1;le++){var Pe=Dt[le];if(!(Pe in Ce))break t;Ce=Ce[Pe]}(Zt=Zt(le=Ce[Dt=Dt[Dt.length-1]]))!=le&&Zt!=null&&K(Ce,Dt,{configurable:!0,writable:!0,value:Zt})}}function X(Dt){return(Dt={next:Dt})[Symbol.iterator]=function(){return this},Dt}function J(Dt){var Zt=typeof Symbol<"u"&&Symbol.iterator&&Dt[Symbol.iterator];return Zt?Zt.call(Dt):{next:j(Dt)}}function q(Dt){if(!(Dt instanceof Array)){Dt=J(Dt);for(var Zt,Ce=[];!(Zt=Dt.next()).done;)Ce.push(Zt.value);Dt=Ce}return Dt}Y("Symbol",function(Dt){function Zt(Pe,rn){this.g=Pe,K(this,"description",{configurable:!0,writable:!0,value:rn})}if(Dt)return Dt;Zt.prototype.toString=function(){return this.g};var Ce="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",le=0;return function Pe(rn){if(this instanceof Pe)throw new TypeError("Symbol is not a constructor");return new Zt(Ce+(rn||"")+"_"+le++,rn)}}),Y("Symbol.iterator",function(Dt){if(Dt)return Dt;Dt=Symbol("Symbol.iterator");for(var Zt="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Ce=0;Ce<Zt.length;Ce++){var le=Z[Zt[Ce]];typeof le=="function"&&typeof le.prototype[Dt]!="function"&&K(le.prototype,Dt,{configurable:!0,writable:!0,value:function(){return X(j(this))}})}return Dt});var H,tt=typeof Object.create=="function"?Object.create:function(Dt){function Zt(){}return Zt.prototype=Dt,new Zt};if(typeof Object.setPrototypeOf=="function")H=Object.setPrototypeOf;else{var st;t:{var lt={};try{lt.__proto__={a:!0},st=lt.a;break t}catch{}st=!1}H=st?function(Dt,Zt){if(Dt.__proto__=Zt,Dt.__proto__!==Zt)throw new TypeError(Dt+" is not extensible");return Dt}:null}var ft=H;function gt(Dt,Zt){if(Dt.prototype=tt(Zt.prototype),Dt.prototype.constructor=Dt,ft)ft(Dt,Zt);else for(var Ce in Zt)if(Ce!="prototype")if(Object.defineProperties){var le=Object.getOwnPropertyDescriptor(Zt,Ce);le&&Object.defineProperty(Dt,Ce,le)}else Dt[Ce]=Zt[Ce];Dt.ea=Zt.prototype}function xt(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function wt(Dt){if(Dt.l)throw new TypeError("Generator is already running");Dt.l=!0}function _t(Dt,Zt){Dt.j={U:Zt,V:!0},Dt.g=Dt.m||Dt.s}function bt(Dt,Zt,Ce){return Dt.g=Ce,{value:Zt}}function Tt(Dt){this.g=new xt,this.h=Dt}function qt(Dt,Zt,Ce,le){try{var Pe=Zt.call(Dt.g.i,Ce);if(!(Pe instanceof Object))throw new TypeError("Iterator result "+Pe+" is not an object");if(!Pe.done)return Dt.g.l=!1,Pe;var rn=Pe.value}catch(Cn){return Dt.g.i=null,_t(Dt.g,Cn),It(Dt)}return Dt.g.i=null,le.call(Dt.g,rn),It(Dt)}function It(Dt){for(;Dt.g.g;)try{var Zt=Dt.h(Dt.g);if(Zt)return Dt.g.l=!1,{value:Zt.value,done:!1}}catch(Ce){Dt.g.h=void 0,_t(Dt.g,Ce)}if(Dt.g.l=!1,Dt.g.j){if(Zt=Dt.g.j,Dt.g.j=null,Zt.V)throw Zt.U;return{value:Zt.return,done:!0}}return{value:void 0,done:!0}}function St(Dt){this.next=function(Zt){return wt(Dt.g),Dt.g.i?Zt=qt(Dt,Dt.g.i.next,Zt,Dt.g.o):(Dt.g.o(Zt),Zt=It(Dt)),Zt},this.throw=function(Zt){return wt(Dt.g),Dt.g.i?Zt=qt(Dt,Dt.g.i.throw,Zt,Dt.g.o):(_t(Dt.g,Zt),Zt=It(Dt)),Zt},this.return=function(Zt){return function(Ce,le){wt(Ce.g);var Pe=Ce.g.i;return Pe?qt(Ce,"return"in Pe?Pe.return:function(rn){return{value:rn,done:!0}},le,Ce.g.return):(Ce.g.return(le),It(Ce))}(Dt,Zt)},this[Symbol.iterator]=function(){return this}}function vt(Dt,Zt){return Zt=new St(new Tt(Zt)),ft&&Dt.prototype&&ft(Zt,Dt.prototype),Zt}xt.prototype.o=function(Dt){this.h=Dt},xt.prototype.return=function(Dt){this.j={return:Dt},this.g=this.s};var Ft=typeof Object.assign=="function"?Object.assign:function(Dt,Zt){for(var Ce=1;Ce<arguments.length;Ce++){var le=arguments[Ce];if(le)for(var Pe in le)Object.prototype.hasOwnProperty.call(le,Pe)&&(Dt[Pe]=le[Pe])}return Dt};Y("Object.assign",function(Dt){return Dt||Ft}),Y("Promise",function(Dt){function Zt(Cn){this.h=0,this.i=void 0,this.g=[],this.o=!1;var Vn=this.j();try{Cn(Vn.resolve,Vn.reject)}catch(hr){Vn.reject(hr)}}function Ce(){this.g=null}function le(Cn){return Cn instanceof Zt?Cn:new Zt(function(Vn){Vn(Cn)})}if(Dt)return Dt;Ce.prototype.h=function(Cn){if(this.g==null){this.g=[];var Vn=this;this.i(function(){Vn.l()})}this.g.push(Cn)};var Pe=Z.setTimeout;Ce.prototype.i=function(Cn){Pe(Cn,0)},Ce.prototype.l=function(){for(;this.g&&this.g.length;){var Cn=this.g;this.g=[];for(var Vn=0;Vn<Cn.length;++Vn){var hr=Cn[Vn];Cn[Vn]=null;try{hr()}catch(Kr){this.j(Kr)}}}this.g=null},Ce.prototype.j=function(Cn){this.i(function(){throw Cn})},Zt.prototype.j=function(){function Cn(Kr){return function($i){hr||(hr=!0,Kr.call(Vn,$i))}}var Vn=this,hr=!1;return{resolve:Cn(this.C),reject:Cn(this.l)}},Zt.prototype.C=function(Cn){if(Cn===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(Cn instanceof Zt)this.F(Cn);else{t:switch(typeof Cn){case"object":var Vn=Cn!=null;break t;case"function":Vn=!0;break t;default:Vn=!1}Vn?this.u(Cn):this.m(Cn)}},Zt.prototype.u=function(Cn){var Vn=void 0;try{Vn=Cn.then}catch(hr){return void this.l(hr)}typeof Vn=="function"?this.G(Vn,Cn):this.m(Cn)},Zt.prototype.l=function(Cn){this.s(2,Cn)},Zt.prototype.m=function(Cn){this.s(1,Cn)},Zt.prototype.s=function(Cn,Vn){if(this.h!=0)throw Error("Cannot settle("+Cn+", "+Vn+"): Promise already settled in state"+this.h);this.h=Cn,this.i=Vn,this.h===2&&this.D(),this.A()},Zt.prototype.D=function(){var Cn=this;Pe(function(){if(Cn.B()){var Vn=Z.console;Vn!==void 0&&Vn.error(Cn.i)}},1)},Zt.prototype.B=function(){if(this.o)return!1;var Cn=Z.CustomEvent,Vn=Z.Event,hr=Z.dispatchEvent;return hr===void 0||(typeof Cn=="function"?Cn=new Cn("unhandledrejection",{cancelable:!0}):typeof Vn=="function"?Cn=new Vn("unhandledrejection",{cancelable:!0}):(Cn=Z.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,Cn),Cn.promise=this,Cn.reason=this.i,hr(Cn))},Zt.prototype.A=function(){if(this.g!=null){for(var Cn=0;Cn<this.g.length;++Cn)rn.h(this.g[Cn]);this.g=null}};var rn=new Ce;return Zt.prototype.F=function(Cn){var Vn=this.j();Cn.J(Vn.resolve,Vn.reject)},Zt.prototype.G=function(Cn,Vn){var hr=this.j();try{Cn.call(Vn,hr.resolve,hr.reject)}catch(Kr){hr.reject(Kr)}},Zt.prototype.then=function(Cn,Vn){function hr(Rr,Jr){return typeof Rr=="function"?function(di){try{Kr(Rr(di))}catch(bi){$i(bi)}}:Jr}var Kr,$i,Ai=new Zt(function(Rr,Jr){Kr=Rr,$i=Jr});return this.J(hr(Cn,Kr),hr(Vn,$i)),Ai},Zt.prototype.catch=function(Cn){return this.then(void 0,Cn)},Zt.prototype.J=function(Cn,Vn){function hr(){switch(Kr.h){case 1:Cn(Kr.i);break;case 2:Vn(Kr.i);break;default:throw Error("Unexpected state: "+Kr.h)}}var Kr=this;this.g==null?rn.h(hr):this.g.push(hr),this.o=!0},Zt.resolve=le,Zt.reject=function(Cn){return new Zt(function(Vn,hr){hr(Cn)})},Zt.race=function(Cn){return new Zt(function(Vn,hr){for(var Kr=J(Cn),$i=Kr.next();!$i.done;$i=Kr.next())le($i.value).J(Vn,hr)})},Zt.all=function(Cn){var Vn=J(Cn),hr=Vn.next();return hr.done?le([]):new Zt(function(Kr,$i){function Ai(di){return function(bi){Rr[di]=bi,--Jr==0&&Kr(Rr)}}var Rr=[],Jr=0;do Rr.push(void 0),Jr++,le(hr.value).J(Ai(Rr.length-1),$i),hr=Vn.next();while(!hr.done)})},Zt}),Y("Object.is",function(Dt){return Dt||function(Zt,Ce){return Zt===Ce?Zt!==0||1/Zt==1/Ce:Zt!=Zt&&Ce!=Ce}}),Y("Array.prototype.includes",function(Dt){return Dt||function(Zt,Ce){var le=this;le instanceof String&&(le=String(le));var Pe=le.length;for(0>(Ce=Ce||0)&&(Ce=Math.max(Ce+Pe,0));Ce<Pe;Ce++){var rn=le[Ce];if(rn===Zt||Object.is(rn,Zt))return!0}return!1}}),Y("String.prototype.includes",function(Dt){return Dt||function(Zt,Ce){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(Zt instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(Zt,Ce||0)!==-1}}),Y("Array.prototype.keys",function(Dt){return Dt||function(){return function(Zt,Ce){Zt instanceof String&&(Zt+="");var le=0,Pe=!1,rn={next:function(){if(!Pe&&le<Zt.length){var Cn=le++;return{value:Ce(Cn,Zt[Cn]),done:!1}}return Pe=!0,{done:!0,value:void 0}}};return rn[Symbol.iterator]=function(){return rn},rn}(this,function(Zt){return Zt})}});var Qt=this||self;function Gt(Dt,Zt){Dt=Dt.split(".");var Ce,le=Qt;for((Dt[0]in le)||le.execScript===void 0||le.execScript("var "+Dt[0]);Dt.length&&(Ce=Dt.shift());)Dt.length||Zt===void 0?le=le[Ce]&&le[Ce]!==Object.prototype[Ce]?le[Ce]:le[Ce]={}:le[Ce]=Zt}function ge(Dt,Zt){return Zt=String.fromCharCode.apply(null,Zt),Dt==null?Zt:Dt+Zt}var ee,Ee,Bt=typeof TextDecoder<"u",Xt=typeof TextEncoder<"u";function we(Dt){if(Xt)Dt=(Ee||(Ee=new TextEncoder)).encode(Dt);else{var Zt=void 0;Zt=Zt!==void 0&&Zt;for(var Ce=0,le=new Uint8Array(3*Dt.length),Pe=0;Pe<Dt.length;Pe++){var rn=Dt.charCodeAt(Pe);if(128>rn)le[Ce++]=rn;else{if(2048>rn)le[Ce++]=rn>>6|192;else{if(55296<=rn&&57343>=rn){if(56319>=rn&&Pe<Dt.length){var Cn=Dt.charCodeAt(++Pe);if(56320<=Cn&&57343>=Cn){rn=1024*(rn-55296)+Cn-56320+65536,le[Ce++]=rn>>18|240,le[Ce++]=rn>>12&63|128,le[Ce++]=rn>>6&63|128,le[Ce++]=63&rn|128;continue}Pe--}if(Zt)throw Error("Found an unpaired surrogate");rn=65533}le[Ce++]=rn>>12|224,le[Ce++]=rn>>6&63|128}le[Ce++]=63&rn|128}}Dt=le.subarray(0,Ce)}return Dt}var ie={},m=null;function ye(Dt,Zt){Zt===void 0&&(Zt=0),te(),Zt=ie[Zt];for(var Ce=Array(Math.floor(Dt.length/3)),le=Zt[64]||"",Pe=0,rn=0;Pe<Dt.length-2;Pe+=3){var Cn=Dt[Pe],Vn=Dt[Pe+1],hr=Dt[Pe+2],Kr=Zt[Cn>>2];Cn=Zt[(3&Cn)<<4|Vn>>4],Vn=Zt[(15&Vn)<<2|hr>>6],hr=Zt[63&hr],Ce[rn++]=Kr+Cn+Vn+hr}switch(Kr=0,hr=le,Dt.length-Pe){case 2:hr=Zt[(15&(Kr=Dt[Pe+1]))<<2]||le;case 1:Dt=Dt[Pe],Ce[rn]=Zt[Dt>>2]+Zt[(3&Dt)<<4|Kr>>4]+hr+le}return Ce.join("")}function Ge(Dt){var Zt=Dt.length,Ce=3*Zt/4;Ce%3?Ce=Math.floor(Ce):"=.".indexOf(Dt[Zt-1])!=-1&&(Ce="=.".indexOf(Dt[Zt-2])!=-1?Ce-2:Ce-1);var le=new Uint8Array(Ce),Pe=0;return function(rn,Cn){function Vn(Jr){for(;hr<rn.length;){var di=rn.charAt(hr++),bi=m[di];if(bi!=null)return bi;if(!/^[\s\xa0]*$/.test(di))throw Error("Unknown base64 encoding at char: "+di)}return Jr}te();for(var hr=0;;){var Kr=Vn(-1),$i=Vn(0),Ai=Vn(64),Rr=Vn(64);if(Rr===64&&Kr===-1)break;Cn(Kr<<2|$i>>4),Ai!=64&&(Cn($i<<4&240|Ai>>2),Rr!=64&&Cn(Ai<<6&192|Rr))}}(Dt,function(rn){le[Pe++]=rn}),le.subarray(0,Pe)}function te(){if(!m){m={};for(var Dt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),Zt=["+/=","+/","-_=","-_.","-_"],Ce=0;5>Ce;Ce++){var le=Dt.concat(Zt[Ce].split(""));ie[Ce]=le;for(var Pe=0;Pe<le.length;Pe++){var rn=le[Pe];m[rn]===void 0&&(m[rn]=Pe)}}}}var Me,Ye=typeof Uint8Array.prototype.slice=="function";function Ue(Dt,Zt,Ce){return Zt===Ce?Me||(Me=new Uint8Array(0)):Ye?Dt.slice(Zt,Ce):new Uint8Array(Dt.subarray(Zt,Ce))}var kn=0;function mn(Dt,Zt){Zt=(Zt=Zt===void 0?{}:Zt).v!==void 0&&Zt.v,this.h=null,this.g=this.j=this.l=0,this.m=!1,this.v=Zt,Dt&&Kn(this,Dt)}function Kn(Dt,Zt){Zt=Zt.constructor===Uint8Array?Zt:Zt.constructor===ArrayBuffer||Zt.constructor===Array?new Uint8Array(Zt):Zt.constructor===String?Ge(Zt):Zt instanceof Uint8Array?new Uint8Array(Zt.buffer,Zt.byteOffset,Zt.byteLength):new Uint8Array(0),Dt.h=Zt,Dt.l=0,Dt.j=Dt.h.length,Dt.g=Dt.l}function Sn(Dt){for(var Zt=128,Ce=0,le=0,Pe=0;4>Pe&&128<=Zt;Pe++)Ce|=(127&(Zt=Dt.h[Dt.g++]))<<7*Pe;if(128<=Zt&&(Ce|=(127&(Zt=Dt.h[Dt.g++]))<<28,le|=(127&Zt)>>4),128<=Zt)for(Pe=0;5>Pe&&128<=Zt;Pe++)le|=(127&(Zt=Dt.h[Dt.g++]))<<7*Pe+3;if(128>Zt)return Dt=Ce>>>0,(le=2147483648&(Zt=le>>>0))&&(Zt=~Zt>>>0,(Dt=1+~Dt>>>0)==0&&(Zt=Zt+1>>>0)),Dt=4294967296*Zt+(Dt>>>0),le?-Dt:Dt;Dt.m=!0}mn.prototype.reset=function(){this.g=this.l},mn.prototype.i=function(){var Dt=this.h,Zt=Dt[this.g],Ce=127&Zt;return 128>Zt?(this.g+=1,Ce):(Ce|=(127&(Zt=Dt[this.g+1]))<<7,128>Zt?(this.g+=2,Ce):(Ce|=(127&(Zt=Dt[this.g+2]))<<14,128>Zt?(this.g+=3,Ce):(Ce|=(127&(Zt=Dt[this.g+3]))<<21,128>Zt?(this.g+=4,Ce):(Ce|=(15&(Zt=Dt[this.g+4]))<<28,128>Zt?(this.g+=5,Ce>>>0):(this.g+=5,128<=Dt[this.g++]&&128<=Dt[this.g++]&&128<=Dt[this.g++]&&128<=Dt[this.g++]&&this.g++,Ce)))))},mn.prototype.o=function(){var Dt=this.h[this.g],Zt=this.h[this.g+1],Ce=this.h[this.g+2],le=this.h[this.g+3];return this.g+=4,Dt=2*((Ce=(Dt|Zt<<8|Ce<<16|le<<24)>>>0)>>31)+1,Zt=Ce>>>23&255,Ce&=8388607,Zt==255?Ce?NaN:1/0*Dt:Zt==0?Dt*Math.pow(2,-149)*Ce:Dt*Math.pow(2,Zt-150)*(Ce+Math.pow(2,23))};var Wn=[];function Ze(){this.g=new Uint8Array(64),this.h=0}function de(Dt,Zt){for(;127<Zt;)Dt.push(127&Zt|128),Zt>>>=7;Dt.push(Zt)}function Re(Dt){var Zt={},Ce=Zt.N!==void 0&&Zt.N;this.o={v:Zt.v!==void 0&&Zt.v},this.N=Ce,Zt=this.o,Wn.length?(Ce=Wn.pop(),Zt&&(Ce.v=Zt.v),Dt&&Kn(Ce,Dt),Dt=Ce):Dt=new mn(Dt,Zt),this.g=Dt,this.m=this.g.g,this.h=this.i=this.l=-1,this.j=!1}function Kt(Dt){var Zt=Dt.g;if((Zt=Zt.g==Zt.j)||(Zt=Dt.j)||(Zt=(Zt=Dt.g).m||0>Zt.g||Zt.g>Zt.j),Zt)return!1;Dt.m=Dt.g.g;var Ce=7&(Zt=Dt.g.i());return Ce!=0&&Ce!=5&&Ce!=1&&Ce!=2&&Ce!=3&&Ce!=4?(Dt.j=!0,!1):(Dt.i=Zt,Dt.l=Zt>>>3,Dt.h=Ce,!0)}function Jt(Dt){switch(Dt.h){case 0:if(Dt.h!=0)Jt(Dt);else{for(Dt=Dt.g;128&Dt.h[Dt.g];)Dt.g++;Dt.g++}break;case 1:Dt.h!=1?Jt(Dt):(Dt=Dt.g).g+=8;break;case 2:if(Dt.h!=2)Jt(Dt);else{var Zt=Dt.g.i();(Dt=Dt.g).g+=Zt}break;case 5:Dt.h!=5?Jt(Dt):(Dt=Dt.g).g+=4;break;case 3:for(Zt=Dt.l;;){if(!Kt(Dt)){Dt.j=!0;break}if(Dt.h==4){Dt.l!=Zt&&(Dt.j=!0);break}Jt(Dt)}break;default:Dt.j=!0}}function Ae(Dt,Zt,Ce){var le=Dt.g.j,Pe=Dt.g.i(),rn=Dt.g.g+Pe;if(Dt.g.j=rn,Ce(Zt,Dt),(Ce=rn-Dt.g.g)!==0)throw Error("Message parsing ended unexpectedly. Expected to read "+Pe+" bytes, instead read "+(Pe-Ce)+" bytes, either the data ended unexpectedly or the message misreported its own length");return Dt.g.g=rn,Dt.g.j=le,Zt}function $e(Dt){return Dt.g.o()}function tn(Dt){var Zt,Ce=Dt.g.i(),le=(Dt=Dt.g).g;if(Dt.g+=Ce,Dt=Dt.h,Bt)(Zt=ee)||(Zt=ee=new TextDecoder("utf-8",{fatal:!1})),Zt=Zt.decode(Dt.subarray(le,le+Ce));else{Ce=le+Ce;for(var Pe,rn,Cn,Vn=[],hr=null;le<Ce;)128>(Pe=Dt[le++])?Vn.push(Pe):224>Pe?le>=Ce?Vn.push(65533):(rn=Dt[le++],194>Pe||(192&rn)!=128?(le--,Vn.push(65533)):Vn.push((31&Pe)<<6|63&rn)):240>Pe?le>=Ce-1?Vn.push(65533):(192&(rn=Dt[le++]))!=128||Pe===224&&160>rn||Pe===237&&160<=rn||(192&(Zt=Dt[le++]))!=128?(le--,Vn.push(65533)):Vn.push((15&Pe)<<12|(63&rn)<<6|63&Zt):244>=Pe?le>=Ce-2?Vn.push(65533):(192&(rn=Dt[le++]))!=128||rn-144+(Pe<<28)>>30||(192&(Zt=Dt[le++]))!=128||(192&(Cn=Dt[le++]))!=128?(le--,Vn.push(65533)):(Pe=(7&Pe)<<18|(63&rn)<<12|(63&Zt)<<6|63&Cn,Pe-=65536,Vn.push(55296+(Pe>>10&1023),56320+(1023&Pe))):Vn.push(65533),8192<=Vn.length&&(hr=ge(hr,Vn),Vn.length=0);Zt=ge(hr,Vn)}return Zt}function wn(Dt,Zt,Ce){var le=Dt.g.i();for(le=Dt.g.g+le;Dt.g.g<le;)Ce.push(Zt.call(Dt.g))}function Mn(Dt,Zt){Dt.h==2?wn(Dt,mn.prototype.o,Zt):Zt.push($e(Dt))}function Hn(){this.h=[],this.i=0,this.g=new Ze}function Zn(Dt,Zt){Zt.length!==0&&(Dt.h.push(Zt),Dt.i+=Zt.length)}function _r(Dt){var Zt=Dt.i+Dt.g.length();if(Zt===0)return new Uint8Array(0);Zt=new Uint8Array(Zt);for(var Ce=Dt.h,le=Ce.length,Pe=0,rn=0;rn<le;rn++){var Cn=Ce[rn];Cn.length!==0&&(Zt.set(Cn,Pe),Pe+=Cn.length)}return(le=(Ce=Dt.g).h)!==0&&(Zt.set(Ce.g.subarray(0,le),Pe),Ce.h=0),Dt.h=[Zt],Zt}function Sr(Dt,Zt,Ce){if(Ce!=null){de(Dt.g,8*Zt+5),Dt=Dt.g;var le=Ce;(le=(Ce=0>le?1:0)?-le:le)===0?0<1/le?kn=0:kn=2147483648:isNaN(le)?kn=2147483647:34028234663852886e22<le?kn=(Ce<<31|2139095040)>>>0:11754943508222875e-54>le?(le=Math.round(le/Math.pow(2,-149)),kn=(Ce<<31|le)>>>0):(Zt=Math.floor(Math.log(le)/Math.LN2),le*=Math.pow(2,-Zt),16777216<=(le=Math.round(8388608*le))&&++Zt,kn=(Ce<<31|Zt+127<<23|8388607&le)>>>0),Ce=kn,Dt.push(Ce>>>0&255),Dt.push(Ce>>>8&255),Dt.push(Ce>>>16&255),Dt.push(Ce>>>24&255)}}Ze.prototype.push=function(Dt){if(!(this.h+1<this.g.length)){var Zt=this.g;this.g=new Uint8Array(Math.ceil(1+2*this.g.length)),this.g.set(Zt)}this.g[this.h++]=Dt},Ze.prototype.length=function(){return this.h},Ze.prototype.end=function(){var Dt=this.g,Zt=this.h;return this.h=0,Ue(Dt,0,Zt)},Re.prototype.reset=function(){this.g.reset(),this.h=this.l=-1};var Mr=typeof Uint8Array=="function";function ai(Dt,Zt,Ce){if(Dt!=null)return typeof Dt=="object"?Mr&&Dt instanceof Uint8Array?Ce(Dt):ea(Dt,Zt,Ce):Zt(Dt)}function ea(Dt,Zt,Ce){if(Array.isArray(Dt)){for(var le=Array(Dt.length),Pe=0;Pe<Dt.length;Pe++)le[Pe]=ai(Dt[Pe],Zt,Ce);return Array.isArray(Dt)&&Dt.W&&Be(le),le}for(Pe in le={},Dt)le[Pe]=ai(Dt[Pe],Zt,Ce);return le}function Pi(Dt){return typeof Dt=="number"?isFinite(Dt)?Dt:String(Dt):Dt}var Cr,Ti={W:{value:!0,configurable:!0}};function Be(Dt){return Array.isArray(Dt)&&!Object.isFrozen(Dt)&&Object.defineProperties(Dt,Ti),Dt}function En(Dt,Zt,Ce){var le=Cr;if(Cr=null,Dt||(Dt=le),le=this.constructor.ca,Dt||(Dt=le?[le]:[]),this.j=le?0:-1,this.m=this.g=null,this.h=Dt,Dt=(le=this.h.length)-1,!le||(le=this.h[Dt])===null||typeof le!="object"||Array.isArray(le)||Mr&&le instanceof Uint8Array?Zt!==void 0&&-1<Zt?(this.l=Math.max(Zt,Dt+1-this.j),this.i=null):this.l=Number.MAX_VALUE:(this.l=Dt-this.j,this.i=le),Ce)for(Zt=0;Zt<Ce.length;Zt++)(Dt=Ce[Zt])<this.l?(Dt+=this.j,(le=this.h[Dt])?Be(le):this.h[Dt]=lr):(qn(this),(le=this.i[Dt])?Be(le):this.i[Dt]=lr)}var lr=Object.freeze(Be([]));function qn(Dt){var Zt=Dt.l+Dt.j;Dt.h[Zt]||(Dt.i=Dt.h[Zt]={})}function fr(Dt,Zt,Ce){return Zt===-1?null:Ce!==void 0&&Ce||Zt>=Dt.l?Dt.i?Dt.i[Zt]:void 0:Dt.h[Zt+Dt.j]}function Er(Dt,Zt){var Ce=Ce!==void 0&&Ce,le=fr(Dt,Zt,Ce);return le==null&&(le=lr),le===lr&&br(Dt,Zt,le=Be([]),Ce),le}function Qr(Dt){var Zt=Er(Dt,3);if(Dt.m||(Dt.m={}),!Dt.m[3]){for(var Ce=0;Ce<Zt.length;Ce++)Zt[Ce]=+Zt[Ce];Dt.m[3]=!0}return Zt}function vi(Dt,Zt,Ce){return(Dt=fr(Dt,Zt))==null?Ce:Dt}function ua(Dt,Zt,Ce){return(Dt=(Dt=fr(Dt,Zt))==null?Dt:+Dt)==null?Ce===void 0?0:Ce:Dt}function br(Dt,Zt,Ce,le){le!==void 0&&le||Zt>=Dt.l?(qn(Dt),Dt.i[Zt]=Ce):Dt.h[Zt+Dt.j]=Ce}function eo(Dt,Zt,Ce){if(Ce===-1)return null;if(Dt.g||(Dt.g={}),!Dt.g[Ce]){var le=fr(Dt,Ce,!1);le&&(Dt.g[Ce]=new Zt(le))}return Dt.g[Ce]}function Fo(Dt,Zt){Dt.g||(Dt.g={});var Ce=Dt.g[1];if(!Ce){var le=Er(Dt,1);Ce=[];for(var Pe=0;Pe<le.length;Pe++)Ce[Pe]=new Zt(le[Pe]);Dt.g[1]=Ce}return Ce}function Wa(Dt,Zt,Ce){var le=le!==void 0&&le;Dt.g||(Dt.g={});var Pe=Ce&&bn(Ce);Dt.g[Zt]=Ce,br(Dt,Zt,Pe,le)}function Le(Dt,Zt,Ce,le){var Pe=Fo(Dt,Ce);Zt=Zt||new Ce,Dt=Er(Dt,1),le!=null?(Pe.splice(le,0,Zt),Dt.splice(le,0,bn(Zt))):(Pe.push(Zt),Dt.push(bn(Zt)))}function bn(Dt,Zt){return Dt.h}function jn(Dt,Zt){if(Dt=Dt.o){Zn(Zt,Zt.g.end());for(var Ce=0;Ce<Dt.length;Ce++)Zn(Zt,Dt[Ce])}}function Jn(Dt,Zt){if(Zt.h==4)return!1;var Ce=Zt.m;return Jt(Zt),Zt.N||(Zt=Ue(Zt.g.h,Ce,Zt.g.g),(Ce=Dt.o)?Ce.push(Zt):Dt.o=[Zt]),!0}function dr(Dt){En.call(this,Dt,-1,or)}function Ur(Dt,Zt){for(;Kt(Zt);)switch(Zt.i){case 8:var Ce=Zt.g.i();br(Dt,1,Ce);break;case 16:br(Dt,2,Ce=Zt.g.i());break;case 29:case 26:Mn(Zt,Dt.getPackedDataList());break;case 32:br(Dt,4,Ce=Sn(Zt.g));break;default:if(!Jn(Dt,Zt))return Dt}return Dt}En.prototype.toJSON=function(){return ea(bn(this),Pi,ye)},En.prototype.toString=function(){return bn(this).toString()},gt(dr,En),dr.prototype.getRows=function(){return fr(this,1)},dr.prototype.getCols=function(){return fr(this,2)},dr.prototype.getPackedDataList=function(){return Qr(this)},dr.prototype.getLayout=function(){return vi(this,4,0)};var or=[3];function Yn(Dt,Zt){var Ce=void 0;return new(Ce||(Ce=Promise))(function(le,Pe){function rn(hr){try{Vn(Zt.next(hr))}catch(Kr){Pe(Kr)}}function Cn(hr){try{Vn(Zt.throw(hr))}catch(Kr){Pe(Kr)}}function Vn(hr){hr.done?le(hr.value):new Ce(function(Kr){Kr(hr.value)}).then(rn,Cn)}Vn((Zt=Zt.apply(Dt,void 0)).next())})}function li(Dt){En.call(this,Dt)}function Ki(Dt,Zt){for(;Kt(Zt);)switch(Zt.i){case 8:var Ce=Zt.g.i();br(Dt,1,Ce);break;case 21:br(Dt,2,Ce=$e(Zt));break;case 26:br(Dt,3,Ce=tn(Zt));break;case 34:br(Dt,4,Ce=tn(Zt));break;default:if(!Jn(Dt,Zt))return Dt}return Dt}function Si(Dt){En.call(this,Dt,-1,Da)}gt(li,En),gt(Si,En),Si.prototype.addClassification=function(Dt,Zt){return Le(this,Dt,li,Zt),this};var Da=[1];function _i(Dt){En.call(this,Dt)}function la(Dt,Zt){for(;Kt(Zt);)switch(Zt.i){case 13:var Ce=$e(Zt);br(Dt,1,Ce);break;case 21:br(Dt,2,Ce=$e(Zt));break;case 29:br(Dt,3,Ce=$e(Zt));break;case 37:br(Dt,4,Ce=$e(Zt));break;case 45:br(Dt,5,Ce=$e(Zt));break;default:if(!Jn(Dt,Zt))return Dt}return Dt}function so(Dt){En.call(this,Dt,-1,vs)}function ys(Dt){t:{var Zt=new so;for(Dt=new Re(Dt);Kt(Dt);)if(Dt.i===10)Le(Zt,Ae(Dt,new _i,la),_i,void 0);else if(!Jn(Zt,Dt))break t}return Zt}gt(_i,En),gt(so,En);var vs=[1];function qo(Dt){En.call(this,Dt)}function bs(Dt){En.call(this,Dt,-1,va)}function na(Dt,Zt){for(;Kt(Zt);)switch(Zt.i){case 8:var Ce=Sn(Zt.g);br(Dt,1,Ce);break;case 16:br(Dt,2,Ce=Sn(Zt.g));break;case 29:case 26:Mn(Zt,Dt.getVertexBufferList());break;case 32:case 34:Ce=Zt;var le=Dt.getIndexBufferList();Ce.h==2?wn(Ce,mn.prototype.i,le):le.push(Ce.g.i());break;default:if(!Jn(Dt,Zt))return Dt}return Dt}gt(qo,En),gt(bs,En),bs.prototype.getVertexType=function(){return vi(this,1,0)},bs.prototype.getPrimitiveType=function(){return vi(this,2,0)},bs.prototype.getVertexBufferList=function(){return Qr(this)},bs.prototype.getIndexBufferList=function(){return Er(this,4)};var va=[3,4];function Ya(Dt){En.call(this,Dt)}function Xo(Dt,Zt,Ce){if(Ce=Dt.createShader(Ce===0?Dt.VERTEX_SHADER:Dt.FRAGMENT_SHADER),Dt.shaderSource(Ce,Zt),Dt.compileShader(Ce),!Dt.getShaderParameter(Ce,Dt.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+Dt.getShaderInfoLog(Ce));return Ce}function Du(Dt){return Fo(Dt,li).map(function(Zt){return{index:vi(Zt,1,0),Y:ua(Zt,2),label:fr(Zt,3)!=null?vi(Zt,3,""):void 0,displayName:fr(Zt,4)!=null?vi(Zt,4,""):void 0}})}function uu(Dt){return{x:ua(Dt,1),y:ua(Dt,2),z:ua(Dt,3),visibility:fr(Dt,4)!=null?ua(Dt,4):void 0}}function ws(Dt,Zt){this.h=Dt,this.g=Zt,this.l=0}function Ra(Dt,Zt,Ce){return function(le,Pe){var rn=le.g;if(le.m===void 0){var Cn=Xo(rn,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),Vn=Xo(rn,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),hr=rn.createProgram();if(rn.attachShader(hr,Cn),rn.attachShader(hr,Vn),rn.linkProgram(hr),!rn.getProgramParameter(hr,rn.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+rn.getProgramInfoLog(hr));Cn=le.m=hr,rn.useProgram(Cn),Vn=rn.getUniformLocation(Cn,"sampler0"),le.j={I:rn.getAttribLocation(Cn,"aVertex"),H:rn.getAttribLocation(Cn,"aTex"),da:Vn},le.s=rn.createBuffer(),rn.bindBuffer(rn.ARRAY_BUFFER,le.s),rn.enableVertexAttribArray(le.j.I),rn.vertexAttribPointer(le.j.I,2,rn.FLOAT,!1,0,0),rn.bufferData(rn.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),rn.STATIC_DRAW),rn.bindBuffer(rn.ARRAY_BUFFER,null),le.o=rn.createBuffer(),rn.bindBuffer(rn.ARRAY_BUFFER,le.o),rn.enableVertexAttribArray(le.j.H),rn.vertexAttribPointer(le.j.H,2,rn.FLOAT,!1,0,0),rn.bufferData(rn.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),rn.STATIC_DRAW),rn.bindBuffer(rn.ARRAY_BUFFER,null),rn.uniform1i(Vn,0)}Cn=le.j,rn.useProgram(le.m),rn.canvas.width=Pe.width,rn.canvas.height=Pe.height,rn.viewport(0,0,Pe.width,Pe.height),rn.activeTexture(rn.TEXTURE0),le.h.bindTexture2d(Pe.glName),rn.enableVertexAttribArray(Cn.I),rn.bindBuffer(rn.ARRAY_BUFFER,le.s),rn.vertexAttribPointer(Cn.I,2,rn.FLOAT,!1,0,0),rn.enableVertexAttribArray(Cn.H),rn.bindBuffer(rn.ARRAY_BUFFER,le.o),rn.vertexAttribPointer(Cn.H,2,rn.FLOAT,!1,0,0),rn.bindFramebuffer(rn.DRAW_FRAMEBUFFER?rn.DRAW_FRAMEBUFFER:rn.FRAMEBUFFER,null),rn.clearColor(0,0,0,0),rn.clear(rn.COLOR_BUFFER_BIT),rn.colorMask(!0,!0,!0,!0),rn.drawArrays(rn.TRIANGLE_FAN,0,4),rn.disableVertexAttribArray(Cn.I),rn.disableVertexAttribArray(Cn.H),rn.bindBuffer(rn.ARRAY_BUFFER,null),le.h.bindTexture2d(0)}(Dt,Zt),typeof Dt.g.canvas.transferToImageBitmap=="function"?Promise.resolve(Dt.g.canvas.transferToImageBitmap()):Ce?Promise.resolve(Dt.g.canvas):typeof createImageBitmap=="function"?createImageBitmap(Dt.g.canvas):(Dt.i===void 0&&(Dt.i=document.createElement("canvas")),new Promise(function(le){Dt.i.height=Dt.g.canvas.height,Dt.i.width=Dt.g.canvas.width,Dt.i.getContext("2d",{}).drawImage(Dt.g.canvas,0,0,Dt.g.canvas.width,Dt.g.canvas.height),le(Dt.i)}))}function Ru(Dt){this.g=Dt}gt(Ya,En),Ya.prototype.getMesh=function(){return eo(this,bs,1)},Ya.prototype.getPoseTransformMatrix=function(){return eo(this,dr,2)};var Ko=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Ga(Dt,Zt){return Zt+Dt}function Fu(Dt,Zt){window[Dt]=Zt}function Zs(Dt){if(this.g=Dt,this.listeners={},this.j={},this.F={},this.m={},this.s={},this.G=this.o=this.R=!0,this.C=Promise.resolve(),this.P="",this.B={},this.locateFile=Dt&&Dt.locateFile||Ga,typeof window=="object")var Zt=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(typeof location>"u")throw Error("solutions can only be loaded on a web page or in a web worker");Zt=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.S=Zt,Dt.options)for(var Ce=(Zt=J(Object.keys(Dt.options))).next();!Ce.done;Ce=Zt.next()){Ce=Ce.value;var le=Dt.options[Ce].default;le!==void 0&&(this.j[Ce]=typeof le=="function"?le():le)}}function Rc(Dt){return Yn(Dt,function Zt(){var Ce,le,Pe,rn,Cn,Vn,hr,Kr,$i,Ai,Rr,Jr=this;return vt(Zt,function(di){switch(di.g){case 1:return Ce=Jr,Jr.R?(le=function(bi,Ci){return bi.g.files===void 0?[]:typeof bi.g.files=="function"?bi.g.files(Ci):bi.g.files}(Jr,Jr.j),bt(di,function(){return Yn(this,function bi(){return vt(bi,function(Ci){switch(Ci.g){case 1:return Ci.m=2,bt(Ci,WebAssembly.instantiate(Ko),4);case 4:Ci.g=3,Ci.m=0;break;case 2:return Ci.m=0,Ci.j=null,Ci.return(!1);case 3:return Ci.return(!0)}})})}(),2)):di.return();case 2:if(Pe=di.h,typeof window=="object")return Fu("createMediapipeSolutionsWasm",{locateFile:Jr.locateFile}),Fu("createMediapipeSolutionsPackedAssets",{locateFile:Jr.locateFile}),Vn=le.filter(function(bi){return bi.data!==void 0}),hr=le.filter(function(bi){return bi.data===void 0}),Kr=Promise.all(Vn.map(function(bi){var Ci=bu(Ce,bi.url);if(bi.path!==void 0){var ra=bi.path;Ci=Ci.then(function(oa){return Ce.overrideFile(ra,oa),Promise.resolve(oa)})}return Ci})),$i=Promise.all(hr.map(function(bi){return bi.simd===void 0||bi.simd&&Pe||!bi.simd&&!Pe?function(Ci){var ra=document.createElement("script");return ra.setAttribute("src",Ci),ra.setAttribute("crossorigin","anonymous"),new Promise(function(oa){ra.addEventListener("load",function(){oa()},!1),ra.addEventListener("error",function(){oa()},!1),document.body.appendChild(ra)})}(Ce.locateFile(bi.url,Ce.S)):Promise.resolve()})).then(function(){return Yn(Ce,function bi(){var Ci,ra,oa=this;return vt(bi,function(Wr){if(Wr.g==1)return Ci=window.createMediapipeSolutionsWasm,ra=window.createMediapipeSolutionsPackedAssets,bt(Wr,Ci(ra),2);oa.h=Wr.h,Wr.g=0})})}),Ai=Yn(Ce,function bi(){var Ci=this;return vt(bi,function(ra){return Ci.g.graph&&Ci.g.graph.url?ra=bt(ra,bu(Ci,Ci.g.graph.url),0):(ra.g=0,ra=void 0),ra})}),bt(di,Promise.all([$i,Kr,Ai]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return rn=le.filter(function(bi){return bi.simd===void 0||bi.simd&&Pe||!bi.simd&&!Pe}).map(function(bi){return Ce.locateFile(bi.url,Ce.S)}),importScripts.apply(null,q(rn)),bt(di,createMediapipeSolutionsWasm(Module),6);case 6:Jr.h=di.h,Jr.l=new OffscreenCanvas(1,1),Jr.h.canvas=Jr.l,Cn=Jr.h.GL.createContext(Jr.l,{antialias:!1,alpha:!1,ba:typeof WebGL2RenderingContext<"u"?2:1}),Jr.h.GL.makeContextCurrent(Cn),di.g=4;break;case 7:if(Jr.l=document.createElement("canvas"),!(Rr=Jr.l.getContext("webgl2",{}))&&!(Rr=Jr.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),di.return();Jr.D=Rr,Jr.h.canvas=Jr.l,Jr.h.createContext(Jr.l,!0,!0,{});case 4:Jr.i=new Jr.h.SolutionWasm,Jr.R=!1,di.g=0}})})}function bu(Dt,Zt){return Yn(Dt,function Ce(){var le,Pe,rn=this;return vt(Ce,function(Cn){return Zt in rn.F?Cn.return(rn.F[Zt]):(le=rn.locateFile(Zt,""),Pe=fetch(le).then(function(Vn){return Vn.arrayBuffer()}),rn.F[Zt]=Pe,Cn.return(Pe))})})}function Qs(Dt,Zt,Ce){return Yn(Dt,function le(){var Pe,rn,Cn,Vn,hr,Kr,$i,Ai,Rr,Jr,di,bi,Ci,ra,oa=this;return vt(le,function(Wr){switch(Wr.g){case 1:if(!Ce)return Wr.return(Zt);for(Pe={},rn=0,Cn=J(Object.keys(Ce)),Vn=Cn.next();!Vn.done;Vn=Cn.next())hr=Vn.value,typeof(Kr=Ce[hr])!="string"&&Kr.type==="texture"&&Zt[Kr.stream]!==void 0&&++rn;1<rn&&(oa.G=!1),$i=J(Object.keys(Ce)),Vn=$i.next();case 2:if(Vn.done){Wr.g=4;break}if(Ai=Vn.value,typeof(Rr=Ce[Ai])=="string")return Ci=Pe,ra=Ai,bt(Wr,function(Po,ku,io){return Yn(Po,function an(){var Ms,lu=this;return vt(an,function(Ul){return typeof io=="number"||io instanceof Uint8Array||io instanceof lu.h.Uint8BlobList?Ul.return(io):io instanceof lu.h.Texture2dDataOut?((Ms=lu.s[ku])||(Ms=new ws(lu.h,lu.D),lu.s[ku]=Ms),Ul.return(Ra(Ms,io,lu.G))):Ul.return(void 0)})})}(oa,Ai,Zt[Rr]),14);if(Jr=Zt[Rr.stream],Rr.type==="detection_list"){if(Jr){for(var _a=Jr.getRectList(),Ca=Jr.getLandmarksList(),Gi=Jr.getClassificationsList(),Ea=[],Ta=0;Ta<_a.size();++Ta){var Dn=_a.get(Ta);t:{var Ui=new qo;for(Dn=new Re(Dn);Kt(Dn);)switch(Dn.i){case 13:var sa=$e(Dn);br(Ui,1,sa);break;case 21:br(Ui,2,sa=$e(Dn));break;case 29:br(Ui,3,sa=$e(Dn));break;case 37:br(Ui,4,sa=$e(Dn));break;case 45:br(Ui,5,sa=$e(Dn));break;case 48:br(Ui,6,sa=Sn(Dn.g));break;default:if(!Jn(Ui,Dn))break t}}Ui={Z:ua(Ui,1),$:ua(Ui,2),height:ua(Ui,3),width:ua(Ui,4),rotation:ua(Ui,5,0),X:vi(Ui,6,0)},Dn=Fo(ys(Ca.get(Ta)),_i).map(uu);var ks=Gi.get(Ta);t:for(sa=new Si,ks=new Re(ks);Kt(ks);)if(ks.i===10)sa.addClassification(Ae(ks,new li,Ki));else if(!Jn(sa,ks))break t;Ui={T:Ui,O:Dn,M:Du(sa)},Ea.push(Ui)}_a=Ea}else _a=[];Pe[Ai]=_a,Wr.g=7;break}if(Rr.type==="proto_list"){if(Jr){for(_a=Array(Jr.size()),Ca=0;Ca<Jr.size();Ca++)_a[Ca]=Jr.get(Ca);Jr.delete()}else _a=[];Pe[Ai]=_a,Wr.g=7;break}if(Jr===void 0){Wr.g=3;break}if(Rr.type==="float_list"){Pe[Ai]=Jr,Wr.g=7;break}if(Rr.type==="proto"){Pe[Ai]=Jr,Wr.g=7;break}if(Rr.type!=="texture")throw Error("Unknown output config type: '"+Rr.type+"'");return(di=oa.s[Ai])||(di=new ws(oa.h,oa.D),oa.s[Ai]=di),bt(Wr,Ra(di,Jr,oa.G),13);case 13:bi=Wr.h,Pe[Ai]=bi;case 7:Rr.transform&&Pe[Ai]&&(Pe[Ai]=Rr.transform(Pe[Ai])),Wr.g=3;break;case 14:Ci[ra]=Wr.h;case 3:Vn=$i.next(),Wr.g=2;break;case 4:return Wr.return(Pe)}})})}function wu(Dt,Zt){for(var Ce=Zt.name||"$",le=[].concat(q(Zt.wants)),Pe=new Dt.h.StringList,rn=J(Zt.wants),Cn=rn.next();!Cn.done;Cn=rn.next())Pe.push_back(Cn.value);rn=Dt.h.PacketListener.implement({onResults:function(Vn){for(var hr={},Kr=0;Kr<Zt.wants.length;++Kr)hr[le[Kr]]=Vn.get(Kr);var $i=Dt.listeners[Ce];$i&&(Dt.C=Qs(Dt,hr,Zt.outs).then(function(Ai){Ai=$i(Ai);for(var Rr=0;Rr<Zt.wants.length;++Rr){var Jr=hr[le[Rr]];typeof Jr=="object"&&Jr.hasOwnProperty&&Jr.hasOwnProperty("delete")&&Jr.delete()}Ai&&(Dt.C=Ai)}))}}),Dt.i.attachMultiListener(Pe,rn),Pe.delete()}function Tl(Dt){Dt=function(Pe){t:{var rn=new Ya;for(Pe=new Re(Pe);Kt(Pe);)switch(Pe.i){case 10:var Cn=Ae(Pe,new bs,na);Wa(rn,1,Cn);break;case 18:Wa(rn,2,Cn=Ae(Pe,new dr,Ur));break;default:if(!Jn(rn,Pe))break t}}return rn}(Dt);var Zt=Dt.getMesh();if(!Zt)return Dt;var Ce=new Float32Array(Zt.getVertexBufferList());Zt.getVertexBufferList=function(){return Ce};var le=new Uint32Array(Zt.getIndexBufferList());return Zt.getIndexBufferList=function(){return le},Dt}(B=Zs.prototype).close=function(){return this.i&&this.i.delete(),Promise.resolve()},B.reset=function(){return Yn(this,function Dt(){var Zt=this;return vt(Dt,function(Ce){Zt.i&&(Zt.i.reset(),Zt.m={},Zt.s={}),Ce.g=0})})},B.setOptions=function(Dt,Zt){var Ce=this;if(Zt=Zt||this.g.options){for(var le=[],Pe=[],rn={},Cn=J(Object.keys(Dt)),Vn=Cn.next();!Vn.done;rn={K:rn.K,L:rn.L},Vn=Cn.next()){var hr=Vn.value;hr in this.j&&this.j[hr]===Dt[hr]||(this.j[hr]=Dt[hr],(Vn=Zt[hr])!==void 0&&(Vn.onChange&&(rn.K=Vn.onChange,rn.L=Dt[hr],le.push(function(Kr){return function(){return Yn(Ce,function $i(){var Ai=this;return vt($i,function(Rr){if(Rr.g==1)return bt(Rr,Kr.K(Kr.L),2);Rr.h===!0&&(Ai.o=!0),Rr.g=0})})}}(rn))),Vn.graphOptionXref&&(hr={valueNumber:Vn.type===1?Dt[hr]:0,valueBoolean:Vn.type===0&&Dt[hr],valueString:Vn.type===2?Dt[hr]:""},Vn=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),Vn.graphOptionXref),hr),Pe.push(Vn))))}le.length===0&&Pe.length===0||(this.o=!0,this.A=(this.A===void 0?[]:this.A).concat(Pe),this.u=(this.u===void 0?[]:this.u).concat(le))}},B.initialize=function(){return Yn(this,function Dt(){var Zt=this;return vt(Dt,function(Ce){return Ce.g==1?bt(Ce,Rc(Zt),2):Ce.g!=3?bt(Ce,Yn(Zt,function le(){var Pe,rn,Cn,Vn,hr,Kr,$i,Ai,Rr=this;return vt(le,function(Jr){if(Jr.g==1)return Rr.g.graph&&Rr.g.graph.url&&Rr.P===Rr.g.graph.url?Jr.return():(Rr.o=!0,Rr.g.graph&&Rr.g.graph.url?(Rr.P=Rr.g.graph.url,bt(Jr,bu(Rr,Rr.g.graph.url),3)):void(Jr.g=2));for(Jr.g!=2&&(Pe=Jr.h,Rr.i.loadGraph(Pe)),rn=J(Object.keys(Rr.B)),Cn=rn.next();!Cn.done;Cn=rn.next())Vn=Cn.value,Rr.i.overrideFile(Vn,Rr.B[Vn]);if(Rr.B={},Rr.g.listeners)for(hr=J(Rr.g.listeners),Kr=hr.next();!Kr.done;Kr=hr.next())$i=Kr.value,wu(Rr,$i);Ai=Rr.j,Rr.j={},Rr.setOptions(Ai),Jr.g=0})}),3):bt(Ce,function(le){return Yn(le,function Pe(){var rn,Cn,Vn,hr,Kr,$i,Ai=this;return vt(Pe,function(Rr){switch(Rr.g){case 1:if(!Ai.o)return Rr.return();if(!Ai.u){Rr.g=2;break}rn=J(Ai.u),Cn=rn.next();case 3:if(Cn.done){Rr.g=5;break}return bt(Rr,(0,Cn.value)(),4);case 4:Cn=rn.next(),Rr.g=3;break;case 5:Ai.u=void 0;case 2:if(Ai.A){for(Vn=new Ai.h.GraphOptionChangeRequestList,hr=J(Ai.A),Kr=hr.next();!Kr.done;Kr=hr.next())$i=Kr.value,Vn.push_back($i);Ai.i.changeOptions(Vn),Vn.delete(),Ai.A=void 0}Ai.o=!1,Rr.g=0}})})}(Zt),0)})})},B.overrideFile=function(Dt,Zt){this.i?this.i.overrideFile(Dt,Zt):this.B[Dt]=Zt},B.clearOverriddenFiles=function(){this.B={},this.i&&this.i.clearOverriddenFiles()},B.send=function(Dt,Zt){return Yn(this,function Ce(){var le,Pe,rn,Cn,Vn,hr,Kr,$i,Ai,Rr=this;return vt(Ce,function(Jr){switch(Jr.g){case 1:return Rr.g.inputs?(le=1e3*(Zt??performance.now()),bt(Jr,Rr.C,2)):Jr.return();case 2:return bt(Jr,Rr.initialize(),3);case 3:for(Pe=new Rr.h.PacketDataList,rn=J(Object.keys(Dt)),Cn=rn.next();!Cn.done;Cn=rn.next())if(Vn=Cn.value,hr=Rr.g.inputs[Vn]){t:{var di=Rr,bi=Dt[Vn];switch(hr.type){case"video":var Ci=di.m[hr.stream];if(Ci||(Ci=new ws(di.h,di.D),di.m[hr.stream]=Ci),(di=Ci).l===0&&(di.l=di.h.createTexture()),typeof HTMLVideoElement<"u"&&bi instanceof HTMLVideoElement){var ra=bi.videoWidth;Ci=bi.videoHeight}else typeof HTMLImageElement<"u"&&bi instanceof HTMLImageElement?(ra=bi.naturalWidth,Ci=bi.naturalHeight):(ra=bi.width,Ci=bi.height);Ci={glName:di.l,width:ra,height:Ci},(ra=di.g).canvas.width=Ci.width,ra.canvas.height=Ci.height,ra.activeTexture(ra.TEXTURE0),di.h.bindTexture2d(di.l),ra.texImage2D(ra.TEXTURE_2D,0,ra.RGBA,ra.RGBA,ra.UNSIGNED_BYTE,bi),di.h.bindTexture2d(0),di=Ci;break t;case"detections":for((Ci=di.m[hr.stream])||(Ci=new Ru(di.h),di.m[hr.stream]=Ci),(di=Ci).data||(di.data=new di.g.DetectionListData),di.data.reset(bi.length),Ci=0;Ci<bi.length;++Ci){ra=bi[Ci];var oa=di.data,Wr=oa.setBoundingBox,_a=Ci,Ca=ra.T,Gi=new qo;br(Gi,1,Ca.Z),br(Gi,2,Ca.$),br(Gi,3,Ca.height),br(Gi,4,Ca.width),br(Gi,5,Ca.rotation),br(Gi,6,Ca.X);var Ea=Ca=new Hn;Sr(Ea,1,fr(Gi,1)),Sr(Ea,2,fr(Gi,2)),Sr(Ea,3,fr(Gi,3)),Sr(Ea,4,fr(Gi,4)),Sr(Ea,5,fr(Gi,5));var Ta=fr(Gi,6);if(Ta!=null&&Ta!=null){de(Ea.g,48);var Dn=Ea.g,Ui=Ta;Ta=0>Ui;var sa=(Ui=Math.abs(Ui))>>>0;for(Ui=Math.floor((Ui-sa)/4294967296),Ui>>>=0,Ta&&(Ui=~Ui>>>0,4294967295<(sa=1+(~sa>>>0))&&(sa=0,4294967295<++Ui&&(Ui=0))),Ta=kn=sa,sa=Ui;0<sa||127<Ta;)Dn.push(127&Ta|128),Ta=(Ta>>>7|sa<<25)>>>0,sa>>>=7;Dn.push(Ta)}if(jn(Gi,Ea),Ca=_r(Ca),Wr.call(oa,_a,Ca),ra.O)for(oa=0;oa<ra.O.length;++oa)Ea=!!(Gi=ra.O[oa]).visibility,_a=(Wr=di.data).addNormalizedLandmark,Ca=Ci,Gi=Object.assign(Object.assign({},Gi),{visibility:Ea?Gi.visibility:0}),br(Ea=new _i,1,Gi.x),br(Ea,2,Gi.y),br(Ea,3,Gi.z),Gi.visibility&&br(Ea,4,Gi.visibility),Sr(Dn=Gi=new Hn,1,fr(Ea,1)),Sr(Dn,2,fr(Ea,2)),Sr(Dn,3,fr(Ea,3)),Sr(Dn,4,fr(Ea,4)),Sr(Dn,5,fr(Ea,5)),jn(Ea,Dn),Gi=_r(Gi),_a.call(Wr,Ca,Gi);if(ra.M)for(oa=0;oa<ra.M.length;++oa){if(_a=(Wr=di.data).addClassification,Ca=Ci,Gi=ra.M[oa],br(Ea=new li,2,Gi.Y),Gi.index&&br(Ea,1,Gi.index),Gi.label&&br(Ea,3,Gi.label),Gi.displayName&&br(Ea,4,Gi.displayName),Dn=Gi=new Hn,(sa=fr(Ea,1))!=null&&sa!=null)if(de(Dn.g,8),Ta=Dn.g,0<=sa)de(Ta,sa);else{for(Ui=0;9>Ui;Ui++)Ta.push(127&sa|128),sa>>=7;Ta.push(1)}Sr(Dn,2,fr(Ea,2)),(Ta=fr(Ea,3))!=null&&(Ta=we(Ta),de(Dn.g,26),de(Dn.g,Ta.length),Zn(Dn,Dn.g.end()),Zn(Dn,Ta)),(Ta=fr(Ea,4))!=null&&(Ta=we(Ta),de(Dn.g,34),de(Dn.g,Ta.length),Zn(Dn,Dn.g.end()),Zn(Dn,Ta)),jn(Ea,Dn),Gi=_r(Gi),_a.call(Wr,Ca,Gi)}}di=di.data;break t;default:di={}}}switch(Kr=di,$i=hr.stream,hr.type){case"video":Pe.pushTexture2d(Object.assign(Object.assign({},Kr),{stream:$i,timestamp:le}));break;case"detections":(Ai=Kr).stream=$i,Ai.timestamp=le,Pe.pushDetectionList(Ai);break;default:throw Error("Unknown input config type: '"+hr.type+"'")}}return Rr.i.send(Pe),bt(Jr,Rr.C,4);case 4:Pe.delete(),Jr.g=0}})})},B.onResults=function(Dt,Zt){this.listeners[Zt||"$"]=Dt},Gt("Solution",Zs),Gt("OptionType",{BOOL:0,NUMBER:1,aa:2,0:"BOOL",1:"NUMBER",2:"STRING"});var Zo={files:[{url:"face_mesh_solution_packed_assets_loader.js"},{simd:!0,url:"face_mesh_solution_simd_wasm_bin.js"},{simd:!1,url:"face_mesh_solution_wasm_bin.js"}],graph:{url:"face_mesh.binarypb"},listeners:[{wants:["multi_face_geometry","image_transformed","multi_face_landmarks"],outs:{image:"image_transformed",multiFaceGeometry:{type:"proto_list",stream:"multi_face_geometry",transform:function(Dt){return Dt.map(Tl)}},multiFaceLandmarks:{type:"proto_list",stream:"multi_face_landmarks",transform:function(Dt){return Dt.map(function(Zt){return Fo(ys(Zt),_i).map(uu)})}}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},enableFaceGeometry:{type:0,graphOptionXref:{calculatorName:"EnableFaceGeometryConstant",calculatorType:"ConstantSidePacketCalculator",fieldName:"bool_value"}},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumFaces:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorNumFaces",fieldName:"int_value"}},refineLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorRefineLandmarks",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facelandmarkfrontgpu__facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"facelandmarkfrontgpu__facelandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}},cameraNear:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"near"}},cameraFar:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"far"}},cameraVerticalFovDegrees:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"vertical_fov_degrees"}}}},ji=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],Ku=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],Zu=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],xs=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],xu=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],pa=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],_n=[].concat(q(ji),q(Ku),q(Zu),q(xs),q(xu),q(pa));function ls(Dt){Dt=Dt||{},Dt=Object.assign(Object.assign({},Zo),Dt),this.g=new Zs(Dt)}(B=ls.prototype).close=function(){return this.g.close(),Promise.resolve()},B.onResults=function(Dt){this.g.onResults(Dt)},B.initialize=function(){return Yn(this,function Dt(){var Zt=this;return vt(Dt,function(Ce){return bt(Ce,Zt.g.initialize(),0)})})},B.reset=function(){this.g.reset()},B.send=function(Dt){return Yn(this,function Zt(){var Ce=this;return vt(Zt,function(le){return bt(le,Ce.g.send(Dt),0)})})},B.setOptions=function(Dt){this.g.setOptions(Dt)},Gt("FACE_GEOMETRY",{Layout:{COLUMN_MAJOR:0,ROW_MAJOR:1,0:"COLUMN_MAJOR",1:"ROW_MAJOR"},PrimitiveType:{TRIANGLE:0,0:"TRIANGLE"},VertexType:{VERTEX_PT:0,0:"VERTEX_PT"},DEFAULT_CAMERA_PARAMS:{verticalFovDegrees:63,near:1,far:1e4}}),Gt("FaceMesh",ls),Gt("FACEMESH_LIPS",ji),Gt("FACEMESH_LEFT_EYE",Ku),Gt("FACEMESH_LEFT_EYEBROW",Zu),Gt("FACEMESH_LEFT_IRIS",[[474,475],[475,476],[476,477],[477,474]]),Gt("FACEMESH_RIGHT_EYE",xs),Gt("FACEMESH_RIGHT_EYEBROW",xu),Gt("FACEMESH_RIGHT_IRIS",[[469,470],[470,471],[471,472],[472,469]]),Gt("FACEMESH_FACE_OVAL",pa),Gt("FACEMESH_CONTOURS",_n),Gt("FACEMESH_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),Gt("matrixDataToMatrix",function(Dt){for(var Zt=Dt.getCols(),Ce=Dt.getRows(),le=Dt.getPackedDataList(),Pe=[],rn=0;rn<Ce;rn++)Pe.push(Array(Zt));for(rn=0;rn<Ce;rn++)for(var Cn=0;Cn<Zt;Cn++){var Vn=Dt.getLayout()===1?rn*Zt+Cn:Cn*Ce+rn;Pe[rn][Cn]=le[Vn]}return Pe}),Gt("VERSION","0.4.1633559619")}).call(this)},8554:function(L,O,S){(function(){var B;function j(D){var U=0;return function(){return U<D.length?{done:!1,value:D[U++]}:{done:!0}}}var K=typeof Object.defineProperties=="function"?Object.defineProperty:function(D,U,et){return D==Array.prototype||D==Object.prototype||(D[U]=et.value),D},Z=function(D){D=[typeof globalThis=="object"&&globalThis,D,typeof window=="object"&&window,typeof self=="object"&&self,typeof S.g=="object"&&S.g];for(var U=0;U<D.length;++U){var et=D[U];if(et&&et.Math==Math)return et}throw Error("Cannot find global object")}(this);function Y(D,U){if(U)t:{var et=Z;D=D.split(".");for(var ut=0;ut<D.length-1;ut++){var pt=D[ut];if(!(pt in et))break t;et=et[pt]}(U=U(ut=et[D=D[D.length-1]]))!=ut&&U!=null&&K(et,D,{configurable:!0,writable:!0,value:U})}}function X(D){return(D={next:D})[Symbol.iterator]=function(){return this},D}function J(D){var U=typeof Symbol<"u"&&Symbol.iterator&&D[Symbol.iterator];return U?U.call(D):{next:j(D)}}function q(D){if(!(D instanceof Array)){D=J(D);for(var U,et=[];!(U=D.next()).done;)et.push(U.value);D=et}return D}Y("Symbol",function(D){function U(pt,mt){this.h=pt,K(this,"description",{configurable:!0,writable:!0,value:mt})}if(D)return D;U.prototype.toString=function(){return this.h};var et="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",ut=0;return function pt(mt){if(this instanceof pt)throw new TypeError("Symbol is not a constructor");return new U(et+(mt||"")+"_"+ut++,mt)}}),Y("Symbol.iterator",function(D){if(D)return D;D=Symbol("Symbol.iterator");for(var U="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),et=0;et<U.length;et++){var ut=Z[U[et]];typeof ut=="function"&&typeof ut.prototype[D]!="function"&&K(ut.prototype,D,{configurable:!0,writable:!0,value:function(){return X(j(this))}})}return D});var H=typeof Object.assign=="function"?Object.assign:function(D,U){for(var et=1;et<arguments.length;et++){var ut=arguments[et];if(ut)for(var pt in ut)Object.prototype.hasOwnProperty.call(ut,pt)&&(D[pt]=ut[pt])}return D};Y("Object.assign",function(D){return D||H});var tt,st=typeof Object.create=="function"?Object.create:function(D){function U(){}return U.prototype=D,new U};if(typeof Object.setPrototypeOf=="function")tt=Object.setPrototypeOf;else{var lt;t:{var ft={};try{ft.__proto__={a:!0},lt=ft.a;break t}catch{}lt=!1}tt=lt?function(D,U){if(D.__proto__=U,D.__proto__!==U)throw new TypeError(D+" is not extensible");return D}:null}var gt=tt;function xt(D,U){if(D.prototype=st(U.prototype),D.prototype.constructor=D,gt)gt(D,U);else for(var et in U)if(et!="prototype")if(Object.defineProperties){var ut=Object.getOwnPropertyDescriptor(U,et);ut&&Object.defineProperty(D,et,ut)}else D[et]=U[et];D.ya=U.prototype}function wt(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function _t(D){if(D.m)throw new TypeError("Generator is already running");D.m=!0}function bt(D,U){D.l={ma:U,na:!0},D.h=D.s||D.v}function Tt(D,U,et){return D.h=et,{value:U}}function qt(D){this.h=new wt,this.i=D}function It(D,U,et,ut){try{var pt=U.call(D.h.j,et);if(!(pt instanceof Object))throw new TypeError("Iterator result "+pt+" is not an object");if(!pt.done)return D.h.m=!1,pt;var mt=pt.value}catch(At){return D.h.j=null,bt(D.h,At),St(D)}return D.h.j=null,ut.call(D.h,mt),St(D)}function St(D){for(;D.h.h;)try{var U=D.i(D.h);if(U)return D.h.m=!1,{value:U.value,done:!1}}catch(et){D.h.i=void 0,bt(D.h,et)}if(D.h.m=!1,D.h.l){if(U=D.h.l,D.h.l=null,U.na)throw U.ma;return{value:U.return,done:!0}}return{value:void 0,done:!0}}function vt(D){this.next=function(U){return _t(D.h),D.h.j?U=It(D,D.h.j.next,U,D.h.u):(D.h.u(U),U=St(D)),U},this.throw=function(U){return _t(D.h),D.h.j?U=It(D,D.h.j.throw,U,D.h.u):(bt(D.h,U),U=St(D)),U},this.return=function(U){return function(et,ut){_t(et.h);var pt=et.h.j;return pt?It(et,"return"in pt?pt.return:function(mt){return{value:mt,done:!0}},ut,et.h.return):(et.h.return(ut),St(et))}(D,U)},this[Symbol.iterator]=function(){return this}}function Ft(D){return function(U){function et(pt){return U.next(pt)}function ut(pt){return U.throw(pt)}return new Promise(function(pt,mt){(function At(zt){zt.done?pt(zt.value):Promise.resolve(zt.value).then(et,ut).then(At,mt)})(U.next())})}(new vt(new qt(D)))}function Qt(D){return D||Array.prototype.fill}wt.prototype.u=function(D){this.i=D},wt.prototype.return=function(D){this.l={return:D},this.h=this.v},Y("Promise",function(D){function U(At){this.i=0,this.j=void 0,this.h=[],this.u=!1;var zt=this.l();try{At(zt.resolve,zt.reject)}catch(pe){zt.reject(pe)}}function et(){this.h=null}function ut(At){return At instanceof U?At:new U(function(zt){zt(At)})}if(D)return D;et.prototype.i=function(At){if(this.h==null){this.h=[];var zt=this;this.j(function(){zt.m()})}this.h.push(At)};var pt=Z.setTimeout;et.prototype.j=function(At){pt(At,0)},et.prototype.m=function(){for(;this.h&&this.h.length;){var At=this.h;this.h=[];for(var zt=0;zt<At.length;++zt){var pe=At[zt];At[zt]=null;try{pe()}catch(We){this.l(We)}}}this.h=null},et.prototype.l=function(At){this.j(function(){throw At})},U.prototype.l=function(){function At(We){return function(Ke){pe||(pe=!0,We.call(zt,Ke))}}var zt=this,pe=!1;return{resolve:At(this.I),reject:At(this.m)}},U.prototype.I=function(At){if(At===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(At instanceof U)this.L(At);else{t:switch(typeof At){case"object":var zt=At!=null;break t;case"function":zt=!0;break t;default:zt=!1}zt?this.F(At):this.s(At)}},U.prototype.F=function(At){var zt=void 0;try{zt=At.then}catch(pe){return void this.m(pe)}typeof zt=="function"?this.M(zt,At):this.s(At)},U.prototype.m=function(At){this.v(2,At)},U.prototype.s=function(At){this.v(1,At)},U.prototype.v=function(At,zt){if(this.i!=0)throw Error("Cannot settle("+At+", "+zt+"): Promise already settled in state"+this.i);this.i=At,this.j=zt,this.i===2&&this.K(),this.H()},U.prototype.K=function(){var At=this;pt(function(){if(At.D()){var zt=Z.console;zt!==void 0&&zt.error(At.j)}},1)},U.prototype.D=function(){if(this.u)return!1;var At=Z.CustomEvent,zt=Z.Event,pe=Z.dispatchEvent;return pe===void 0||(typeof At=="function"?At=new At("unhandledrejection",{cancelable:!0}):typeof zt=="function"?At=new zt("unhandledrejection",{cancelable:!0}):(At=Z.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,At),At.promise=this,At.reason=this.j,pe(At))},U.prototype.H=function(){if(this.h!=null){for(var At=0;At<this.h.length;++At)mt.i(this.h[At]);this.h=null}};var mt=new et;return U.prototype.L=function(At){var zt=this.l();At.T(zt.resolve,zt.reject)},U.prototype.M=function(At,zt){var pe=this.l();try{At.call(zt,pe.resolve,pe.reject)}catch(We){pe.reject(We)}},U.prototype.then=function(At,zt){function pe(nn,un){return typeof nn=="function"?function(zn){try{We(nn(zn))}catch(In){Ke(In)}}:un}var We,Ke,Tn=new U(function(nn,un){We=nn,Ke=un});return this.T(pe(At,We),pe(zt,Ke)),Tn},U.prototype.catch=function(At){return this.then(void 0,At)},U.prototype.T=function(At,zt){function pe(){switch(We.i){case 1:At(We.j);break;case 2:zt(We.j);break;default:throw Error("Unexpected state: "+We.i)}}var We=this;this.h==null?mt.i(pe):this.h.push(pe),this.u=!0},U.resolve=ut,U.reject=function(At){return new U(function(zt,pe){pe(At)})},U.race=function(At){return new U(function(zt,pe){for(var We=J(At),Ke=We.next();!Ke.done;Ke=We.next())ut(Ke.value).T(zt,pe)})},U.all=function(At){var zt=J(At),pe=zt.next();return pe.done?ut([]):new U(function(We,Ke){function Tn(zn){return function(In){nn[zn]=In,--un==0&&We(nn)}}var nn=[],un=0;do nn.push(void 0),un++,ut(pe.value).T(Tn(nn.length-1),Ke),pe=zt.next();while(!pe.done)})},U}),Y("Array.prototype.keys",function(D){return D||function(){return function(U,et){U instanceof String&&(U+="");var ut=0,pt=!1,mt={next:function(){if(!pt&&ut<U.length){var At=ut++;return{value:et(At,U[At]),done:!1}}return pt=!0,{done:!0,value:void 0}}};return mt[Symbol.iterator]=function(){return mt},mt}(this,function(U){return U})}}),Y("Array.prototype.fill",function(D){return D||function(U,et,ut){var pt=this.length||0;for(0>et&&(et=Math.max(0,pt+et)),(ut==null||ut>pt)&&(ut=pt),0>(ut=Number(ut))&&(ut=Math.max(0,pt+ut)),et=Number(et||0);et<ut;et++)this[et]=U;return this}}),Y("Int8Array.prototype.fill",Qt),Y("Uint8Array.prototype.fill",Qt),Y("Uint8ClampedArray.prototype.fill",Qt),Y("Int16Array.prototype.fill",Qt),Y("Uint16Array.prototype.fill",Qt),Y("Int32Array.prototype.fill",Qt),Y("Uint32Array.prototype.fill",Qt),Y("Float32Array.prototype.fill",Qt),Y("Float64Array.prototype.fill",Qt),Y("Object.is",function(D){return D||function(U,et){return U===et?U!==0||1/U==1/et:U!=U&&et!=et}}),Y("Array.prototype.includes",function(D){return D||function(U,et){var ut=this;ut instanceof String&&(ut=String(ut));var pt=ut.length;for(0>(et=et||0)&&(et=Math.max(et+pt,0));et<pt;et++){var mt=ut[et];if(mt===U||Object.is(mt,U))return!0}return!1}}),Y("String.prototype.includes",function(D){return D||function(U,et){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(U instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(U,et||0)!==-1}});var Gt=this||self;function ge(D,U){D=D.split(".");var et,ut=Gt;for((D[0]in ut)||ut.execScript===void 0||ut.execScript("var "+D[0]);D.length&&(et=D.shift());)D.length||U===void 0?ut=ut[et]&&ut[et]!==Object.prototype[et]?ut[et]:ut[et]={}:ut[et]=U}function ee(D){var U;return(U=Gt.navigator)&&(U=U.userAgent)||(U=""),U.indexOf(D)!=-1}var Ee=Array.prototype.map?function(D,U){return Array.prototype.map.call(D,U,void 0)}:function(D,U){for(var et=D.length,ut=Array(et),pt=typeof D=="string"?D.split(""):D,mt=0;mt<et;mt++)mt in pt&&(ut[mt]=U.call(void 0,pt[mt],mt,D));return ut},Bt={},Xt=null;function we(D){var U=D.length,et=3*U/4;et%3?et=Math.floor(et):"=.".indexOf(D[U-1])!=-1&&(et="=.".indexOf(D[U-2])!=-1?et-2:et-1);var ut=new Uint8Array(et),pt=0;return function(mt,At){function zt(un){for(;pe<mt.length;){var zn=mt.charAt(pe++),In=Xt[zn];if(In!=null)return In;if(!/^[\s\xa0]*$/.test(zn))throw Error("Unknown base64 encoding at char: "+zn)}return un}ie();for(var pe=0;;){var We=zt(-1),Ke=zt(0),Tn=zt(64),nn=zt(64);if(nn===64&&We===-1)break;At(We<<2|Ke>>4),Tn!=64&&(At(Ke<<4&240|Tn>>2),nn!=64&&At(Tn<<6&192|nn))}}(D,function(mt){ut[pt++]=mt}),pt!==et?ut.subarray(0,pt):ut}function ie(){if(!Xt){Xt={};for(var D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),U=["+/=","+/","-_=","-_.","-_"],et=0;5>et;et++){var ut=D.concat(U[et].split(""));Bt[et]=ut;for(var pt=0;pt<ut.length;pt++){var mt=ut[pt];Xt[mt]===void 0&&(Xt[mt]=pt)}}}}var m=typeof Uint8Array<"u",ye=!(ee("Trident")||ee("MSIE"))&&typeof Gt.btoa=="function";function Ge(D){if(!ye){var U;U===void 0&&(U=0),ie(),U=Bt[U];for(var et=Array(Math.floor(D.length/3)),ut=U[64]||"",pt=0,mt=0;pt<D.length-2;pt+=3){var At=D[pt],zt=D[pt+1],pe=D[pt+2],We=U[At>>2];At=U[(3&At)<<4|zt>>4],zt=U[(15&zt)<<2|pe>>6],pe=U[63&pe],et[mt++]=We+At+zt+pe}switch(We=0,pe=ut,D.length-pt){case 2:pe=U[(15&(We=D[pt+1]))<<2]||ut;case 1:D=D[pt],et[mt]=U[D>>2]+U[(3&D)<<4|We>>4]+pe+ut}return et.join("")}for(U="";10240<D.length;)U+=String.fromCharCode.apply(null,D.subarray(0,10240)),D=D.subarray(10240);return U+=String.fromCharCode.apply(null,D),btoa(U)}var te,Me=RegExp("[-_.]","g");function Ye(D){switch(D){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function Ue(D){if(!ye)return we(D);Me.test(D)&&(D=D.replace(Me,Ye)),D=atob(D);for(var U=new Uint8Array(D.length),et=0;et<D.length;et++)U[et]=D.charCodeAt(et);return U}function kn(){return te||(te=new Uint8Array(0))}var mn={},Kn=typeof Uint8Array.prototype.slice=="function",Sn=0,Wn=0;function Ze(D){var U=0>D,et=(D=Math.abs(D))>>>0;D=Math.floor((D-et)/4294967296),U&&(U=(et=J(Kt(et,D))).next().value,D=et.next().value,et=U),Sn=et>>>0,Wn=D>>>0}var de,Re=typeof BigInt=="function";function Kt(D,U){return U=~U,D?D=1+~D:U+=1,[D,U]}function Jt(D,U){this.i=D>>>0,this.h=U>>>0}function Ae(D){if(!D)return de||(de=new Jt(0,0));if(!/^-?\d+$/.test(D))return null;if(16>D.length)Ze(Number(D));else if(Re)D=BigInt(D),Sn=Number(D&BigInt(4294967295))>>>0,Wn=Number(D>>BigInt(32)&BigInt(4294967295));else{var U=+(D[0]==="-");Wn=Sn=0;for(var et=D.length,ut=U,pt=(et-U)%6+U;pt<=et;ut=pt,pt+=6)ut=Number(D.slice(ut,pt)),Wn*=1e6,4294967296<=(Sn=1e6*Sn+ut)&&(Wn+=Sn/4294967296|0,Sn%=4294967296);U&&(D=(U=J(Kt(Sn,Wn))).next().value,U=U.next().value,Sn=D,Wn=U)}return new Jt(Sn,Wn)}function $e(D,U){return Error("Invalid wire type: "+D+" (at position "+U+")")}function tn(){return Error("Failed to read varint, encoding is invalid.")}function wn(D,U){return Error("Tried to read past the end of the data "+U+" > "+D)}function Mn(){throw Error("Invalid UTF8")}function Hn(D,U){return U=String.fromCharCode.apply(null,U),D==null?U:D+U}var Zn,_r,Sr,Mr=void 0,ai=typeof TextDecoder<"u",ea=typeof TextEncoder<"u";function Pi(D){if(D!==mn)throw Error("illegal external caller")}function Cr(D,U){if(Pi(U),this.V=D,D!=null&&D.length===0)throw Error("ByteString should be constructed with non-empty values")}function Ti(){return Sr||(Sr=new Cr(null,mn))}function Be(D){Pi(mn);var U=D.V;return(U=U==null||m&&U!=null&&U instanceof Uint8Array?U:typeof U=="string"?Ue(U):null)==null?U:D.V=U}function En(D,U){this.i=null,this.m=!1,this.h=this.j=this.l=0,lr(this,D,U)}function lr(D,U,et){et=et===void 0?{}:et,D.S=et.S!==void 0&&et.S,U&&(U=function(ut){if(typeof ut=="string")return{buffer:Ue(ut),C:!1};if(Array.isArray(ut))return{buffer:new Uint8Array(ut),C:!1};if(ut.constructor===Uint8Array)return{buffer:ut,C:!1};if(ut.constructor===ArrayBuffer)return{buffer:new Uint8Array(ut),C:!1};if(ut.constructor===Cr)return{buffer:Be(ut)||kn(),C:!0};if(ut instanceof Uint8Array)return{buffer:new Uint8Array(ut.buffer,ut.byteOffset,ut.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}(U),D.i=U.buffer,D.m=U.C,D.l=0,D.j=D.i.length,D.h=D.l)}function qn(D,U){if(D.h=U,U>D.j)throw wn(D.j,U)}function fr(D){var U=D.i,et=D.h,ut=U[et++],pt=127&ut;if(128&ut&&(pt|=(127&(ut=U[et++]))<<7,128&ut&&(pt|=(127&(ut=U[et++]))<<14,128&ut&&(pt|=(127&(ut=U[et++]))<<21,128&ut&&(pt|=(ut=U[et++])<<28,128&ut&&128&U[et++]&&128&U[et++]&&128&U[et++]&&128&U[et++]&&128&U[et++])))))throw tn();return qn(D,et),pt}function Er(D,U){if(0>U)throw Error("Tried to read a negative byte length: "+U);var et=D.h,ut=et+U;if(ut>D.j)throw wn(U,D.j-et);return D.h=ut,et}En.prototype.reset=function(){this.h=this.l};var Qr=[];function vi(){this.h=[]}function ua(D,U,et){for(;0<et||127<U;)D.h.push(127&U|128),U=(U>>>7|et<<25)>>>0,et>>>=7;D.h.push(U)}function br(D,U){for(;127<U;)D.h.push(127&U|128),U>>>=7;D.h.push(U)}function eo(D,U){if(Qr.length){var et=Qr.pop();lr(et,D,U),D=et}else D=new En(D,U);this.h=D,this.j=this.h.h,this.i=this.l=-1,this.setOptions(U)}function Fo(D){var U=D.h;if(U.h==U.j)return!1;D.j=D.h.h;var et=fr(D.h)>>>0;if(U=et>>>3,!(0<=(et&=7)&&5>=et))throw $e(et,D.j);if(1>U)throw Error("Invalid field number: "+U+" (at position "+D.j+")");return D.l=U,D.i=et,!0}function Wa(D){switch(D.i){case 0:if(D.i!=0)Wa(D);else t:{for(var U=(D=D.h).h,et=U+10,ut=D.i;U<et;)if(!(128&ut[U++])){qn(D,U);break t}throw tn()}break;case 1:qn(D=D.h,D.h+8);break;case 2:D.i!=2?Wa(D):(U=fr(D.h)>>>0,qn(D=D.h,D.h+U));break;case 5:qn(D=D.h,D.h+4);break;case 3:for(U=D.l;;){if(!Fo(D))throw Error("Unmatched start-group tag: stream EOF");if(D.i==4){if(D.l!=U)throw Error("Unmatched end-group tag");break}Wa(D)}break;default:throw $e(D.i,D.j)}}vi.prototype.length=function(){return this.h.length},vi.prototype.end=function(){var D=this.h;return this.h=[],D},eo.prototype.setOptions=function(D){D=D===void 0?{}:D,this.ca=D.ca!==void 0&&D.ca},eo.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};var Le=[];function bn(){this.j=[],this.i=0,this.h=new vi}function jn(D,U){U.length!==0&&(D.j.push(U),D.i+=U.length)}var Jn=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function dr(D,U){return Jn?D[Jn]|=U:D.A!==void 0?D.A|=U:(Object.defineProperties(D,{A:{value:U,configurable:!0,writable:!0,enumerable:!1}}),U)}function Ur(D,U){Jn?D[Jn]&&(D[Jn]&=~U):D.A!==void 0&&(D.A&=~U)}function or(D){var U;return(U=Jn?D[Jn]:D.A)==null?0:U}function Yn(D,U){Jn?D[Jn]=U:D.A!==void 0?D.A=U:Object.defineProperties(D,{A:{value:U,configurable:!0,writable:!0,enumerable:!1}})}function li(D){return dr(D,1),D}function Ki(D,U){Yn(U,-51&D)}function Si(D,U){Yn(U,-41&D|18)}var Da={};function _i(D){return D!==null&&typeof D=="object"&&!Array.isArray(D)&&D.constructor===Object}var la,so,ys=[];function vs(D){if(2&or(D.o))throw Error("Cannot mutate an immutable Message")}function qo(D){var U=D.length;(U=U?D[U-1]:void 0)&&_i(U)?U.g=1:(U={},D.push((U.g=1,U)))}function bs(D){var U=D.i+D.G;return D.B||(D.B=D.o[U]={})}function na(D,U){return U===-1?null:U>=D.i?D.B?D.B[U]:void 0:D.o[U+D.G]}function va(D,U,et,ut){vs(D),Ya(D,U,et,ut)}function Ya(D,U,et,ut){D.j&&(D.j=void 0),U>=D.i||ut?bs(D)[U]=et:(D.o[U+D.G]=et,(D=D.B)&&U in D&&delete D[U])}function Xo(D,U,et,ut){var pt=na(D,U);Array.isArray(pt)||(pt=la);var mt=or(pt);if(1&mt||li(pt),ut)2&mt||dr(pt,2),1&et||Object.freeze(pt);else{ut=!(2&et);var At=2&mt;1&et||!At?ut&&16&mt&&!At&&Ur(pt,16):Ya(D,U,pt=li(Array.prototype.slice.call(pt)))}return pt}function Du(D,U){var et=na(D,U),ut=et==null?et:typeof et=="number"||et==="NaN"||et==="Infinity"||et==="-Infinity"?Number(et):void 0;return ut!=null&&ut!==et&&Ya(D,U,ut),ut}function uu(D,U,et,ut,pt){D.h||(D.h={});var mt=D.h[et],At=Xo(D,et,3,pt);if(!mt){var zt=At;mt=[];var pe=!!(16&or(D.o));At=!!(2&or(zt));var We=zt;!pt&&At&&(zt=Array.prototype.slice.call(zt));for(var Ke=At,Tn=0;Tn<zt.length;Tn++){var nn=zt[Tn],un=U,zn=!1;if(zn=zn!==void 0&&zn,(nn=Array.isArray(nn)?new un(nn):zn?new un:void 0)!==void 0){var In=zn=or(un=nn.o);At&&(In|=2),pe&&(In|=16),In!=zn&&Yn(un,In),un=In,Ke=Ke||!!(2&un),mt.push(nn)}}return D.h[et]=mt,U=33|(pe=or(zt)),pe!=(U=Ke?-9&U:8|U)&&(Ke=zt,Object.isFrozen(Ke)&&(Ke=Array.prototype.slice.call(Ke)),Yn(Ke,U),zt=Ke),We!==zt&&Ya(D,et,zt),(pt||ut&&At)&&dr(mt,2),ut&&Object.freeze(mt),mt}return pt||(pt=Object.isFrozen(mt),ut&&!pt?Object.freeze(mt):!ut&&pt&&(mt=Array.prototype.slice.call(mt),D.h[et]=mt)),mt}function ws(D,U,et){var ut=!!(2&or(D.o));if(U=uu(D,U,et,ut,ut),D=Xo(D,et,3,ut),!(ut||8&or(D))){for(ut=0;ut<U.length;ut++){if(2&or((et=U[ut]).o)){var pt=Zo(et,!1);pt.j=et}else pt=et;et!==pt&&(U[ut]=pt,D[ut]=pt.o)}dr(D,8)}return U}function Ra(D,U,et){if(et!=null&&typeof et!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof et+": "+et);va(D,U,et)}function Ru(D,U,et,ut,pt){vs(D);var mt=uu(D,et,U,!1,!1);return et=ut??new et,D=Xo(D,U,2,!1),pt!=null?(mt.splice(pt,0,et),D.splice(pt,0,et.o)):(mt.push(et),D.push(et.o)),et.C()&&Ur(D,8),et}function Ko(D,U){return D??U}function Ga(D,U,et){return et=et===void 0?0:et,Ko(Du(D,U),et)}function Fu(D,U,et,ut){if(D!=null){if(Array.isArray(D))D=Zs(D,U,et,ut!==void 0);else if(_i(D)){var pt,mt={};for(pt in D)mt[pt]=Fu(D[pt],U,et,ut);D=mt}else D=U(D,ut);return D}}function Zs(D,U,et,ut){var pt=or(D);ut=ut?!!(16&pt):void 0,D=Array.prototype.slice.call(D);for(var mt=0;mt<D.length;mt++)D[mt]=Fu(D[mt],U,et,ut);return et(pt,D),D}function Rc(D){return D.ja===Da?D.toJSON():function(U){switch(typeof U){case"number":return isFinite(U)?U:String(U);case"object":if(U)if(Array.isArray(U)){if(128&or(U))return qo(U=Array.prototype.slice.call(U)),U}else{if(m&&U!=null&&U instanceof Uint8Array)return Ge(U);if(U instanceof Cr){var et=U.V;return et==null?"":typeof et=="string"?et:U.V=Ge(et)}}}return U}(D)}function bu(D,U){128&D&&qo(U)}function Qs(D,U,et){if(et=et===void 0?Si:et,D!=null){if(m&&D instanceof Uint8Array)return D.length?new Cr(new Uint8Array(D),mn):Ti();if(Array.isArray(D)){var ut=or(D);return 2&ut?D:!U||32&ut||!(16&ut||ut===0)?(4&(U=or(D=Zs(D,Qs,4&ut?Si:et,!0)))&&2&U&&Object.freeze(D),D):(Yn(D,2|ut),D)}return D.ja===Da?Tl(D):D}}function wu(D,U,et,ut,pt,mt,At){if(D=D.h&&D.h[et]){if(2&(ut=or(D))?ut=D:(Si(ut,mt=Ee(D,Tl)),Object.freeze(mt),ut=mt),vs(U),At=ut==null?la:li([]),ut!=null){for(mt=!!ut.length,D=0;D<ut.length;D++){var zt=ut[D];mt=mt&&!(2&or(zt.o)),At[D]=zt.o}mt=1|(mt?8:0),((D=or(At))&mt)!==mt&&(Object.isFrozen(At)&&(At=Array.prototype.slice.call(At)),Yn(At,D|mt)),U.h||(U.h={}),U.h[et]=ut}else U.h&&(U.h[et]=void 0);Ya(U,et,At,pt)}else va(U,et,Qs(ut,mt,At),pt)}function Tl(D){return 2&or(D.o)||dr((D=Zo(D,!0)).o,2),D}function Zo(D,U){var et=D.o,ut=[];dr(ut,16);var pt=D.constructor.h;if(pt&&ut.push(pt),pt=D.B){ut.length=et.length,ut.fill(void 0,ut.length,et.length);var mt={};ut[ut.length-1]=mt}128&or(et)&&qo(ut),U=U||D.C()?Si:Ki,mt=D.constructor,so=ut,ut=new mt(ut),so=void 0,D.R&&(ut.R=D.R.slice()),mt=!!(16&or(et));for(var At=pt?et.length-1:et.length,zt=0;zt<At;zt++)wu(D,ut,zt-D.G,et[zt],!1,mt,U);if(pt)for(var pe in pt)wu(D,ut,+pe,pt[pe],!0,mt,U);return ut}function ji(D,U,et){D==null&&(D=so),so=void 0;var ut,pt=this.constructor.i||0,mt=0<pt,At=this.constructor.h,zt=!1;if(D==null){var pe=48,We=!0;mt&&(pt=0,pe|=128),Yn(D=At?[At]:[],pe)}else{if(!Array.isArray(D)||At&&At!==D[0])throw Error();var Ke=pe=dr(D,0);if((We=!!(16&Ke))&&((zt=!!(32&Ke))||(Ke|=32)),mt){if(128&Ke)pt=0;else if(0<D.length){var Tn=D[D.length-1];if(_i(Tn)&&"g"in Tn){pt=0,Ke|=128,delete Tn.g;var nn,un=!0;for(nn in Tn){un=!1;break}un&&D.pop()}}}else if(128&Ke)throw Error();pe!==Ke&&Yn(D,Ke)}if(this.G=(At?0:-1)-pt,this.h=void 0,this.o=D,pt=(At=this.o.length)-1,At&&_i(At=this.o[pt])?(this.B=At,this.i=pt-this.G):U!==void 0&&-1<U?(this.i=Math.max(U,pt+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE,!mt&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(et)for(U=We&&!zt&&!0,mt=this.i,We=0;We<et.length;We++)(zt=et[We])<mt?(pt=D[zt+=this.G])?Ku(pt,U):D[zt]=la:(ut||(ut=bs(this)),(pt=ut[zt])?Ku(pt,U):ut[zt]=la)}function Ku(D,U){if(Array.isArray(D)){var et=or(D),ut=1;!U||2&et||(ut|=16),(et&ut)!==ut&&Yn(D,et|ut)}}function Zu(D,U,et){if(et){var ut,pt={};for(ut in et){var mt=et[ut],At=mt.qa;At||(pt.J=mt.wa||mt.oa.W,mt.ia?(pt.aa=Ce(mt.ia),At=function(zt){return function(pe,We,Ke){return zt.J(pe,We,Ke,zt.aa)}}(pt)):mt.ka?(pt.Z=le(mt.da.P,mt.ka),At=function(zt){return function(pe,We,Ke){return zt.J(pe,We,Ke,zt.Z)}}(pt)):At=pt.J,mt.qa=At),At(U,D,mt.da),pt={J:pt.J,aa:pt.aa,Z:pt.Z}}}(function(zt,pe){if(pe=pe.R){jn(zt,zt.h.end());for(var We=0;We<pe.length;We++)jn(zt,Be(pe[We])||kn())}})(U,D)}Yn(ys,23),la=Object.freeze(ys),ji.prototype.toJSON=function(){return Zs(this.o,Rc,bu)},ji.prototype.C=function(){return!!(2&or(this.o))},ji.prototype.ja=Da,ji.prototype.toString=function(){return this.o.toString()};var xs=Symbol();function xu(D,U,et){return D[xs]||(D[xs]=function(ut,pt){return U(ut,pt,et)})}function pa(D){var U=D[xs];if(!U){var et=bi(D);U=function(ut,pt){return Ci(ut,pt,et)},D[xs]=U}return U}function _n(D){var U=function(pt){var mt=pt.ia;return mt?pa(mt):(mt=pt.va)?xu(pt.da.P,mt,pt.ka):void 0}(D),et=D.da,ut=D.oa.U;return U?function(pt,mt){return ut(pt,mt,et,U)}:function(pt,mt){return ut(pt,mt,et)}}function ls(D,U){var et=D[U];return typeof et=="function"&&et.length===0&&(et=et(),D[U]=et),Array.isArray(et)&&($i in et||Pe in et||0<et.length&&typeof et[0]=="function")?et:void 0}function Dt(D,U,et,ut,pt,mt){U.P=D[0];var At=1;if(D.length>At&&typeof D[At]!="number"){var zt=D[At++];et(U,zt)}for(;At<D.length;){et=D[At++];for(var pe=At+1;pe<D.length&&typeof D[pe]!="number";)pe++;switch(zt=D[At++],pe-=At){case 0:ut(U,et,zt);break;case 1:(pe=ls(D,At))?(At++,pt(U,et,zt,pe)):ut(U,et,zt,D[At++]);break;case 2:pt(U,et,zt,pe=ls(D,pe=At++),D[At++]);break;case 3:mt(U,et,zt,D[At++],D[At++],D[At++]);break;case 4:mt(U,et,zt,D[At++],D[At++],D[At++],D[At++]);break;default:throw Error("unexpected number of binary field arguments: "+pe)}}return U}var Zt=Symbol();function Ce(D){var U=D[Zt];if(!U){var et=Kr(D);U=function(ut,pt){return ra(ut,pt,et)},D[Zt]=U}return U}function le(D,U){var et=D[Zt];return et||(et=function(ut,pt){return Zu(ut,pt,U)},D[Zt]=et),et}var Pe=Symbol();function rn(D,U){D.push(U)}function Cn(D,U,et){D.push(U,et.W)}function Vn(D,U,et,ut){var pt=Ce(ut),mt=Kr(ut).P,At=et.W;D.push(U,function(zt,pe,We){return At(zt,pe,We,mt,pt)})}function hr(D,U,et,ut,pt,mt){var At=le(ut,mt),zt=et.W;D.push(U,function(pe,We,Ke){return zt(pe,We,Ke,ut,At)})}function Kr(D){var U=D[Pe];return U||(U=Dt(D,D[Pe]=[],rn,Cn,Vn,hr),$i in D&&Pe in D&&(D.length=0),U)}var $i=Symbol();function Ai(D,U){D[0]=U}function Rr(D,U,et,ut){var pt=et.U;D[U]=ut?function(mt,At,zt){return pt(mt,At,zt,ut)}:pt}function Jr(D,U,et,ut,pt){var mt=et.U,At=pa(ut),zt=bi(ut).P;D[U]=function(pe,We,Ke){return mt(pe,We,Ke,zt,At,pt)}}function di(D,U,et,ut,pt,mt,At){var zt=et.U,pe=xu(ut,pt,mt);D[U]=function(We,Ke,Tn){return zt(We,Ke,Tn,ut,pe,At)}}function bi(D){var U=D[$i];return U||(U=Dt(D,D[$i]={},Ai,Rr,Jr,di),$i in D&&Pe in D&&(D.length=0),U)}function Ci(D,U,et){for(;Fo(U)&&U.i!=4;){var ut=U.l,pt=et[ut];if(!pt){var mt=et[0];mt&&(mt=mt[ut])&&(pt=et[ut]=_n(mt))}if(!pt||!pt(U,D,ut)){ut=D,mt=(pt=U).j,Wa(pt);var At=pt;if(!At.ca){if(pt=At.h.h-mt,At.h.h=mt,At=At.h,pt==0)pt=Ti();else{if(mt=Er(At,pt),At.S&&At.m)pt=At.i.subarray(mt,mt+pt);else{At=At.i;var zt=mt;pt=zt===(pt=mt+pt)?kn():Kn?At.slice(zt,pt):new Uint8Array(At.subarray(zt,pt))}pt=pt.length==0?Ti():new Cr(pt,mn)}(mt=ut.R)?mt.push(pt):ut.R=[pt]}}}return D}function ra(D,U,et){for(var ut=et.length,pt=ut%2==1,mt=pt?1:0;mt<ut;mt+=2)(0,et[mt+1])(U,D,et[mt]);Zu(D,U,pt?et[0]:void 0)}function oa(D,U){return{U:D,W:U}}var Wr=oa(function(D,U,et){if(D.i!==5)return!1;var ut=(D=D.h).i,pt=D.h,mt=ut[pt],At=ut[pt+1],zt=ut[pt+2];return ut=ut[pt+3],qn(D,D.h+4),D=2*((At=(mt|At<<8|zt<<16|ut<<24)>>>0)>>31)+1,mt=At>>>23&255,At&=8388607,va(U,et,mt==255?At?NaN:1/0*D:mt==0?D*Math.pow(2,-149)*At:D*Math.pow(2,mt-150)*(At+Math.pow(2,23))),!0},function(D,U,et){if((U=Du(U,et))!=null){br(D.h,8*et+5),D=D.h;var ut=+U;ut===0?0<1/ut?Sn=Wn=0:(Wn=0,Sn=2147483648):isNaN(ut)?(Wn=0,Sn=2147483647):34028234663852886e22<(ut=(et=0>ut?-2147483648:0)?-ut:ut)?(Wn=0,Sn=(2139095040|et)>>>0):11754943508222875e-54>ut?(ut=Math.round(ut/Math.pow(2,-149)),Wn=0,Sn=(et|ut)>>>0):(U=Math.floor(Math.log(ut)/Math.LN2),ut*=Math.pow(2,-U),16777216<=(ut=Math.round(8388608*ut))&&++U,Wn=0,Sn=(et|U+127<<23|8388607&ut)>>>0),et=Sn,D.h.push(et>>>0&255),D.h.push(et>>>8&255),D.h.push(et>>>16&255),D.h.push(et>>>24&255)}}),_a=oa(function(D,U,et){if(D.i!==0)return!1;var ut=D.h,pt=0,mt=D=0,At=ut.i,zt=ut.h;do{var pe=At[zt++];pt|=(127&pe)<<mt,mt+=7}while(32>mt&&128&pe);for(32<mt&&(D|=(127&pe)>>4),mt=3;32>mt&&128&pe;mt+=7)D|=(127&(pe=At[zt++]))<<mt;if(qn(ut,zt),!(128>pe))throw tn();return ut=pt>>>0,(D=2147483648&(pe=D>>>0))&&(pe=~pe>>>0,(ut=1+~ut>>>0)==0&&(pe=pe+1>>>0)),ut=4294967296*pe+(ut>>>0),va(U,et,D?-ut:ut),!0},function(D,U,et){(U=na(U,et))!=null&&(typeof U=="string"&&Ae(U),U!=null&&(br(D.h,8*et),typeof U=="number"?(D=D.h,Ze(U),ua(D,Sn,Wn)):(et=Ae(U),ua(D.h,et.i,et.h))))}),Ca=oa(function(D,U,et){return D.i===0&&(va(U,et,fr(D.h)),!0)},function(D,U,et){if((U=na(U,et))!=null&&U!=null)if(br(D.h,8*et),D=D.h,0<=(et=U))br(D,et);else{for(U=0;9>U;U++)D.h.push(127&et|128),et>>=7;D.h.push(1)}}),Gi=oa(function(D,U,et){if(D.i!==2)return!1;var ut=fr(D.h)>>>0,pt=Er(D=D.h,ut);if(D=D.i,ai){var mt,At=D;(mt=Zn)||(mt=Zn=new TextDecoder("utf-8",{fatal:!0})),D=pt+ut,At=pt===0&&D===At.length?At:At.subarray(pt,D);try{var zt=mt.decode(At)}catch(Tn){if(Mr===void 0){try{mt.decode(new Uint8Array([128]))}catch{}try{mt.decode(new Uint8Array([97])),Mr=!0}catch{Mr=!1}}throw!Mr&&(Zn=void 0),Tn}}else{ut=(zt=pt)+ut,pt=[];for(var pe,We,Ke=null;zt<ut;)128>(pe=D[zt++])?pt.push(pe):224>pe?zt>=ut?Mn():(We=D[zt++],194>pe||(192&We)!=128?(zt--,Mn()):pt.push((31&pe)<<6|63&We)):240>pe?zt>=ut-1?Mn():(192&(We=D[zt++]))!=128||pe===224&&160>We||pe===237&&160<=We||(192&(At=D[zt++]))!=128?(zt--,Mn()):pt.push((15&pe)<<12|(63&We)<<6|63&At):244>=pe?zt>=ut-2?Mn():(192&(We=D[zt++]))!=128||We-144+(pe<<28)>>30||(192&(At=D[zt++]))!=128||(192&(mt=D[zt++]))!=128?(zt--,Mn()):(pe=(7&pe)<<18|(63&We)<<12|(63&At)<<6|63&mt,pe-=65536,pt.push(55296+(pe>>10&1023),56320+(1023&pe))):Mn(),8192<=pt.length&&(Ke=Hn(Ke,pt),pt.length=0);zt=Hn(Ke,pt)}return va(U,et,zt),!0},function(D,U,et){if((U=na(U,et))!=null){var ut=!1;if(ut=ut!==void 0&&ut,ea){if(ut&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(U))throw Error("Found an unpaired surrogate");U=(_r||(_r=new TextEncoder)).encode(U)}else{for(var pt=0,mt=new Uint8Array(3*U.length),At=0;At<U.length;At++){var zt=U.charCodeAt(At);if(128>zt)mt[pt++]=zt;else{if(2048>zt)mt[pt++]=zt>>6|192;else{if(55296<=zt&&57343>=zt){if(56319>=zt&&At<U.length){var pe=U.charCodeAt(++At);if(56320<=pe&&57343>=pe){zt=1024*(zt-55296)+pe-56320+65536,mt[pt++]=zt>>18|240,mt[pt++]=zt>>12&63|128,mt[pt++]=zt>>6&63|128,mt[pt++]=63&zt|128;continue}At--}if(ut)throw Error("Found an unpaired surrogate");zt=65533}mt[pt++]=zt>>12|224,mt[pt++]=zt>>6&63|128}mt[pt++]=63&zt|128}}U=pt===mt.length?mt:mt.subarray(0,pt)}br(D.h,8*et+2),br(D.h,U.length),jn(D,D.h.end()),jn(D,U)}}),Ea=oa(function(D,U,et,ut,pt){if(D.i!==2)return!1;U=Ru(U,et,ut),et=D.h.j,ut=fr(D.h)>>>0;var mt=D.h.h+ut,At=mt-et;if(0>=At&&(D.h.j=mt,pt(U,D,void 0,void 0,void 0),At=mt-D.h.h),At)throw Error("Message parsing ended unexpectedly. Expected to read "+ut+" bytes, instead read "+(ut-At)+" bytes, either the data ended unexpectedly or the message misreported its own length");return D.h.h=mt,D.h.j=et,!0},function(D,U,et,ut,pt){if((U=ws(U,ut,et))!=null)for(ut=0;ut<U.length;ut++){var mt=D;br(mt.h,8*et+2);var At=mt.h.end();jn(mt,At),At.push(mt.i),mt=At,pt(U[ut],D),At=D;var zt=mt.pop();for(zt=At.i+At.h.length()-zt;127<zt;)mt.push(127&zt|128),zt>>>=7,At.i++;mt.push(zt),At.i++}});function Ta(D){return function(U,et){t:{if(Le.length){var ut=Le.pop();ut.setOptions(et),lr(ut.h,U,et),U=ut}else U=new eo(U,et);try{var pt=bi(D),mt=Ci(new pt.P,U,pt);break t}finally{(pt=U.h).i=null,pt.m=!1,pt.l=0,pt.j=0,pt.h=0,pt.S=!1,U.l=-1,U.i=-1,100>Le.length&&Le.push(U)}mt=void 0}return mt}}function Dn(D){return function(){var U=new bn;ra(this,U,Kr(D)),jn(U,U.h.end());for(var et=new Uint8Array(U.i),ut=U.j,pt=ut.length,mt=0,At=0;At<pt;At++){var zt=ut[At];et.set(zt,mt),mt+=zt.length}return U.j=[et],et}}function Ui(D){ji.call(this,D)}xt(Ui,ji);var sa=[Ui,1,Ca,2,Wr,3,Gi,4,Gi];function ks(D){ji.call(this,D,-1,Po)}Ui.prototype.l=Dn(sa),xt(ks,ji),ks.prototype.addClassification=function(D,U){return Ru(this,1,Ui,D,U),this};var Po=[1],ku=Ta([ks,1,Ea,sa]);function io(D){ji.call(this,D)}xt(io,ji);var an=[io,1,Wr,2,Wr,3,Wr,4,Wr,5,Wr];function Ms(D){ji.call(this,D,-1,lu)}io.prototype.l=Dn(an),xt(Ms,ji);var lu=[1],Ul=Ta([Ms,1,Ea,an]);function Ou(D){ji.call(this,D)}xt(Ou,ji);var Lu=[Ou,1,Wr,2,Wr,3,Wr,4,Wr,5,Wr,6,_a],Ed=Ta(Lu);function Fc(D,U,et){if(et=D.createShader(et===0?D.VERTEX_SHADER:D.FRAGMENT_SHADER),D.shaderSource(et,U),D.compileShader(et),!D.getShaderParameter(et,D.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+D.getShaderInfoLog(et));return et}function ni(D){return ws(D,Ui,1).map(function(U){var et=na(U,1);return{index:et??0,score:Ga(U,2),label:na(U,3)!=null?Ko(na(U,3),""):void 0,displayName:na(U,4)!=null?Ko(na(U,4),""):void 0}})}function Zr(D){return{x:Ga(D,1),y:Ga(D,2),z:Ga(D,3),visibility:Du(D,4)!=null?Ga(D,4):void 0}}function Qu(D){return D.map(function(U){return ws(Ul(U),io,1).map(Zr)})}function Wl(D,U){this.i=D,this.h=U,this.m=0}function Yh(D,U,et){return function(ut,pt){var mt=ut.h;if(ut.s===void 0){var At=Fc(mt,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),zt=Fc(mt,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),pe=mt.createProgram();if(mt.attachShader(pe,At),mt.attachShader(pe,zt),mt.linkProgram(pe),!mt.getProgramParameter(pe,mt.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+mt.getProgramInfoLog(pe));At=ut.s=pe,mt.useProgram(At),zt=mt.getUniformLocation(At,"sampler0"),ut.l={O:mt.getAttribLocation(At,"aVertex"),N:mt.getAttribLocation(At,"aTex"),xa:zt},ut.v=mt.createBuffer(),mt.bindBuffer(mt.ARRAY_BUFFER,ut.v),mt.enableVertexAttribArray(ut.l.O),mt.vertexAttribPointer(ut.l.O,2,mt.FLOAT,!1,0,0),mt.bufferData(mt.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),mt.STATIC_DRAW),mt.bindBuffer(mt.ARRAY_BUFFER,null),ut.u=mt.createBuffer(),mt.bindBuffer(mt.ARRAY_BUFFER,ut.u),mt.enableVertexAttribArray(ut.l.N),mt.vertexAttribPointer(ut.l.N,2,mt.FLOAT,!1,0,0),mt.bufferData(mt.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),mt.STATIC_DRAW),mt.bindBuffer(mt.ARRAY_BUFFER,null),mt.uniform1i(zt,0)}At=ut.l,mt.useProgram(ut.s),mt.canvas.width=pt.width,mt.canvas.height=pt.height,mt.viewport(0,0,pt.width,pt.height),mt.activeTexture(mt.TEXTURE0),ut.i.bindTexture2d(pt.glName),mt.enableVertexAttribArray(At.O),mt.bindBuffer(mt.ARRAY_BUFFER,ut.v),mt.vertexAttribPointer(At.O,2,mt.FLOAT,!1,0,0),mt.enableVertexAttribArray(At.N),mt.bindBuffer(mt.ARRAY_BUFFER,ut.u),mt.vertexAttribPointer(At.N,2,mt.FLOAT,!1,0,0),mt.bindFramebuffer(mt.DRAW_FRAMEBUFFER?mt.DRAW_FRAMEBUFFER:mt.FRAMEBUFFER,null),mt.clearColor(0,0,0,0),mt.clear(mt.COLOR_BUFFER_BIT),mt.colorMask(!0,!0,!0,!0),mt.drawArrays(mt.TRIANGLE_FAN,0,4),mt.disableVertexAttribArray(At.O),mt.disableVertexAttribArray(At.N),mt.bindBuffer(mt.ARRAY_BUFFER,null),ut.i.bindTexture2d(0)}(D,U),typeof D.h.canvas.transferToImageBitmap=="function"?Promise.resolve(D.h.canvas.transferToImageBitmap()):et?Promise.resolve(D.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(D.h.canvas):(D.j===void 0&&(D.j=document.createElement("canvas")),new Promise(function(ut){D.j.height=D.h.canvas.height,D.j.width=D.h.canvas.width,D.j.getContext("2d",{}).drawImage(D.h.canvas,0,0,D.h.canvas.width,D.h.canvas.height),ut(D.j)}))}function Ba(D){this.h=D}Ou.prototype.l=Dn(Lu);var $s=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Oc(D,U){return U+D}function oc(D,U){window[D]=U}function sc(D){if(this.h=D,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=D&&D.locateFile||Oc,typeof window=="object")var U=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(typeof location>"u")throw Error("solutions can only be loaded on a web page or in a web worker");U=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.ha=U,D.options)for(var et=(U=J(Object.keys(D.options))).next();!et.done;et=U.next()){et=et.value;var ut=D.options[et].default;ut!==void 0&&(this.l[et]=typeof ut=="function"?ut():ut)}}function Lc(D){var U,et,ut,pt,mt,At,zt,pe,We,Ke,Tn;return Ft(function(nn){switch(nn.h){case 1:return D.ga?(U=D.h.files===void 0?[]:typeof D.h.files=="function"?D.h.files(D.l):D.h.files,Tt(nn,Ft(function(un){switch(un.h){case 1:return un.s=2,Tt(un,WebAssembly.instantiate($s),4);case 4:un.h=3,un.s=0;break;case 2:return un.s=0,un.l=null,un.return(!1);case 3:return un.return(!0)}}),2)):nn.return();case 2:if(et=nn.i,typeof window=="object")return oc("createMediapipeSolutionsWasm",{locateFile:D.locateFile}),oc("createMediapipeSolutionsPackedAssets",{locateFile:D.locateFile}),At=U.filter(function(un){return un.data!==void 0}),zt=U.filter(function(un){return un.data===void 0}),pe=Promise.all(At.map(function(un){var zn=Ju(D,un.url);if(un.path!==void 0){var In=un.path;zn=zn.then(function(Or){return D.overrideFile(In,Or),Promise.resolve(Or)})}return zn})),We=Promise.all(zt.map(function(un){return un.simd===void 0||un.simd&&et||!un.simd&&!et?function(zn){var In=document.createElement("script");return In.setAttribute("src",zn),In.setAttribute("crossorigin","anonymous"),new Promise(function(Or){In.addEventListener("load",function(){Or()},!1),In.addEventListener("error",function(){Or()},!1),document.body.appendChild(In)})}(D.locateFile(un.url,D.ha)):Promise.resolve()})).then(function(){var un,zn,In;return Ft(function(Or){if(Or.h==1)return un=window.createMediapipeSolutionsWasm,zn=window.createMediapipeSolutionsPackedAssets,In=D,Tt(Or,un(zn),2);In.i=Or.i,Or.h=0})}),Ke=Ft(function(un){return D.h.graph&&D.h.graph.url?un=Tt(un,Ju(D,D.h.graph.url),0):(un.h=0,un=void 0),un}),Tt(nn,Promise.all([We,pe,Ke]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return ut=U.filter(function(un){return un.simd===void 0||un.simd&&et||!un.simd&&!et}).map(function(un){return D.locateFile(un.url,D.ha)}),importScripts.apply(null,q(ut)),pt=D,Tt(nn,createMediapipeSolutionsWasm(Module),6);case 6:pt.i=nn.i,D.m=new OffscreenCanvas(1,1),D.i.canvas=D.m,mt=D.i.GL.createContext(D.m,{antialias:!1,alpha:!1,ua:typeof WebGL2RenderingContext<"u"?2:1}),D.i.GL.makeContextCurrent(mt),nn.h=4;break;case 7:if(D.m=document.createElement("canvas"),!(Tn=D.m.getContext("webgl2",{}))&&!(Tn=D.m.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),nn.return();D.K=Tn,D.i.canvas=D.m,D.i.createContext(D.m,!0,!0,{});case 4:D.j=new D.i.SolutionWasm,D.ga=!1,nn.h=0}})}function Ju(D,U){var et,ut;return Ft(function(pt){return U in D.L?pt.return(D.L[U]):(et=D.locateFile(U,""),ut=fetch(et).then(function(mt){return mt.arrayBuffer()}),D.L[U]=ut,pt.return(ut))})}function ph(D,U,et){var ut,pt,mt,At,zt,pe,We,Ke,Tn,nn,un,zn,In,Or;return Ft(function(oi){switch(oi.h){case 1:if(!et)return oi.return(U);for(ut={},pt=0,mt=J(Object.keys(et)),At=mt.next();!At.done;At=mt.next())zt=At.value,typeof(pe=et[zt])!="string"&&pe.type==="texture"&&U[pe.stream]!==void 0&&++pt;1<pt&&(D.M=!1),We=J(Object.keys(et)),At=We.next();case 2:if(At.done){oi.h=4;break}if(Ke=At.value,typeof(Tn=et[Ke])=="string")return In=ut,Or=Ke,Tt(oi,function(zs,pi,cu){var Vl;return Ft(function(Al){return typeof cu=="number"||cu instanceof Uint8Array||cu instanceof zs.i.Uint8BlobList?Al.return(cu):cu instanceof zs.i.Texture2dDataOut?((Vl=zs.v[pi])||(Vl=new Wl(zs.i,zs.K),zs.v[pi]=Vl),Al.return(Yh(Vl,cu,zs.M))):Al.return(void 0)})}(D,Ke,U[Tn]),14);if(nn=U[Tn.stream],Tn.type==="detection_list"){if(nn){for(var ur=nn.getRectList(),Na=nn.getLandmarksList(),fi=nn.getClassificationsList(),Lr=[],wi=0;wi<ur.size();++wi){var cs=Ed(ur.get(wi)),Js=void 0;Js=Js===void 0?0:Js,cs={la:{ra:Ga(cs,1),sa:Ga(cs,2),height:Ga(cs,3),width:Ga(cs,4),rotation:Ga(cs,5,0),pa:Ko(na(cs,6),Js)},ea:ws(Ul(Na.get(wi)),io,1).map(Zr),ba:ni(ku(fi.get(wi)))},Lr.push(cs)}ur=Lr}else ur=[];ut[Ke]=ur,oi.h=7;break}if(Tn.type==="proto_list"){if(nn){for(ur=Array(nn.size()),Na=0;Na<nn.size();Na++)ur[Na]=nn.get(Na);nn.delete()}else ur=[];ut[Ke]=ur,oi.h=7;break}if(nn===void 0){oi.h=3;break}if(Tn.type==="float_list"){ut[Ke]=nn,oi.h=7;break}if(Tn.type==="proto"){ut[Ke]=nn,oi.h=7;break}if(Tn.type!=="texture")throw Error("Unknown output config type: '"+Tn.type+"'");return(un=D.v[Ke])||(un=new Wl(D.i,D.K),D.v[Ke]=un),Tt(oi,Yh(un,nn,D.M),13);case 13:zn=oi.i,ut[Ke]=zn;case 7:Tn.transform&&ut[Ke]&&(ut[Ke]=Tn.transform(ut[Ke])),oi.h=3;break;case 14:In[Or]=oi.i;case 3:At=We.next(),oi.h=2;break;case 4:return oi.return(ut)}})}function $c(D,U){for(var et=U.name||"$",ut=[].concat(q(U.wants)),pt=new D.i.StringList,mt=J(U.wants),At=mt.next();!At.done;At=mt.next())pt.push_back(At.value);mt=D.i.PacketListener.implement({onResults:function(zt){for(var pe={},We=0;We<U.wants.length;++We)pe[ut[We]]=zt.get(We);var Ke=D.listeners[et];Ke&&(D.I=ph(D,pe,U.outs).then(function(Tn){Tn=Ke(Tn);for(var nn=0;nn<U.wants.length;++nn){var un=pe[ut[nn]];typeof un=="object"&&un.hasOwnProperty&&un.hasOwnProperty("delete")&&un.delete()}Tn&&(D.I=Tn)}))}}),D.j.attachMultiListener(pt,mt),pt.delete()}function uc(D){return D===void 0&&(D=0),D===1?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function yt(D){var U=this;D=D||{},this.h=new sc({locateFile:D.locateFile,files:function(et){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:uc(et.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:Qu},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:Qu},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(et){return et.map(function(ut){return ni(ku(ut))[0]})}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window=="object"&&window.navigator!==void 0&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(et){var ut,pt,mt;return Ft(function(At){return At.h==1?(ut=uc(et),pt="third_party/mediapipe/modules/hand_landmark/"+ut,Tt(At,Ju(U.h,ut),2)):(mt=At.i,U.h.overrideFile(pt,mt),At.return(!0))})}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}(B=sc.prototype).close=function(){return this.j&&this.j.delete(),Promise.resolve()},B.reset=function(){var D=this;return Ft(function(U){D.j&&(D.j.reset(),D.s={},D.v={}),U.h=0})},B.setOptions=function(D,U){var et=this;if(U=U||this.h.options){for(var ut=[],pt=[],mt={},At=J(Object.keys(D)),zt=At.next();!zt.done;mt={X:mt.X,Y:mt.Y},zt=At.next())if(!((zt=zt.value)in this.l)||this.l[zt]!==D[zt]){this.l[zt]=D[zt];var pe=U[zt];pe!==void 0&&(pe.onChange&&(mt.X=pe.onChange,mt.Y=D[zt],ut.push(function(We){return function(){return Ft(function(Ke){if(Ke.h==1)return Tt(Ke,We.X(We.Y),2);Ke.i===!0&&(et.u=!0),Ke.h=0})}}(mt))),pe.graphOptionXref&&(zt=Object.assign({},{calculatorName:"",calculatorIndex:0},pe.graphOptionXref,{valueNumber:pe.type===1?D[zt]:0,valueBoolean:pe.type===0&&D[zt],valueString:pe.type===2?D[zt]:""}),pt.push(zt)))}ut.length===0&&pt.length===0||(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(pt),this.F=(this.F===void 0?[]:this.F).concat(ut))}},B.initialize=function(){var D=this;return Ft(function(U){return U.h==1?Tt(U,Lc(D),2):U.h!=3?Tt(U,function(et){var ut,pt,mt,At,zt,pe,We,Ke;return Ft(function(Tn){if(Tn.h==1)return et.h.graph&&et.h.graph.url&&et.fa===et.h.graph.url?Tn.return():(et.u=!0,et.h.graph&&et.h.graph.url?(et.fa=et.h.graph.url,Tt(Tn,Ju(et,et.h.graph.url),3)):void(Tn.h=2));for(Tn.h!=2&&(ut=Tn.i,et.j.loadGraph(ut)),pt=J(Object.keys(et.D)),mt=pt.next();!mt.done;mt=pt.next())At=mt.value,et.j.overrideFile(At,et.D[At]);if(et.D={},et.h.listeners)for(zt=J(et.h.listeners),pe=zt.next();!pe.done;pe=zt.next())We=pe.value,$c(et,We);Ke=et.l,et.l={},et.setOptions(Ke),Tn.h=0})}(D),3):Tt(U,function(et){var ut,pt,mt,At,zt,pe;return Ft(function(We){switch(We.h){case 1:if(!et.u)return We.return();if(!et.F){We.h=2;break}ut=J(et.F),pt=ut.next();case 3:if(pt.done){We.h=5;break}return Tt(We,(0,pt.value)(),4);case 4:pt=ut.next(),We.h=3;break;case 5:et.F=void 0;case 2:if(et.H){for(mt=new et.i.GraphOptionChangeRequestList,At=J(et.H),zt=At.next();!zt.done;zt=At.next())pe=zt.value,mt.push_back(pe);et.j.changeOptions(mt),mt.delete(),et.H=void 0}et.u=!1,We.h=0}})}(D),0)})},B.overrideFile=function(D,U){this.j?this.j.overrideFile(D,U):this.D[D]=U},B.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},B.send=function(D,U){var et,ut,pt,mt,At,zt,pe,We,Ke,Tn=this;return Ft(function(nn){switch(nn.h){case 1:return Tn.h.inputs?(et=1e3*(U??performance.now()),Tt(nn,Tn.I,2)):nn.return();case 2:return Tt(nn,Tn.initialize(),3);case 3:for(ut=new Tn.i.PacketDataList,pt=J(Object.keys(D)),mt=pt.next();!mt.done;mt=pt.next())if(At=mt.value,zt=Tn.h.inputs[At]){t:{var un=D[At];switch(zt.type){case"video":var zn=Tn.s[zt.stream];if(zn||(zn=new Wl(Tn.i,Tn.K),Tn.s[zt.stream]=zn),zn.m===0&&(zn.m=zn.i.createTexture()),typeof HTMLVideoElement<"u"&&un instanceof HTMLVideoElement)var In=un.videoWidth,Or=un.videoHeight;else typeof HTMLImageElement<"u"&&un instanceof HTMLImageElement?(In=un.naturalWidth,Or=un.naturalHeight):(In=un.width,Or=un.height);Or={glName:zn.m,width:In,height:Or},(In=zn.h).canvas.width=Or.width,In.canvas.height=Or.height,In.activeTexture(In.TEXTURE0),zn.i.bindTexture2d(zn.m),In.texImage2D(In.TEXTURE_2D,0,In.RGBA,In.RGBA,In.UNSIGNED_BYTE,un),zn.i.bindTexture2d(0),zn=Or;break t;case"detections":for((zn=Tn.s[zt.stream])||(zn=new Ba(Tn.i),Tn.s[zt.stream]=zn),zn.data||(zn.data=new zn.h.DetectionListData),zn.data.reset(un.length),Or=0;Or<un.length;++Or){In=un[Or];var oi=zn.data,ur=oi.setBoundingBox,Na=Or,fi=In.la,Lr=new Ou;if(Ra(Lr,1,fi.ra),Ra(Lr,2,fi.sa),Ra(Lr,3,fi.height),Ra(Lr,4,fi.width),Ra(Lr,5,fi.rotation),va(Lr,6,fi.pa),fi=Lr.l(),ur.call(oi,Na,fi),In.ea)for(oi=0;oi<In.ea.length;++oi){Lr=In.ea[oi],Na=(ur=zn.data).addNormalizedLandmark,fi=Or,Lr=Object.assign({},Lr,{visibility:Lr.visibility?Lr.visibility:0});var wi=new io;Ra(wi,1,Lr.x),Ra(wi,2,Lr.y),Ra(wi,3,Lr.z),Lr.visibility&&Ra(wi,4,Lr.visibility),Lr=wi.l(),Na.call(ur,fi,Lr)}if(In.ba)for(oi=0;oi<In.ba.length;++oi)Na=(ur=zn.data).addClassification,fi=Or,Lr=In.ba[oi],Ra(wi=new Ui,2,Lr.score),Lr.index&&va(wi,1,Lr.index),Lr.label&&va(wi,3,Lr.label),Lr.displayName&&va(wi,4,Lr.displayName),Lr=wi.l(),Na.call(ur,fi,Lr)}zn=zn.data;break t;default:zn={}}}switch(pe=zn,We=zt.stream,zt.type){case"video":ut.pushTexture2d(Object.assign({},pe,{stream:We,timestamp:et}));break;case"detections":(Ke=pe).stream=We,Ke.timestamp=et,ut.pushDetectionList(Ke);break;default:throw Error("Unknown input config type: '"+zt.type+"'")}}return Tn.j.send(ut),Tt(nn,Tn.I,4);case 4:ut.delete(),nn.h=0}})},B.onResults=function(D,U){this.listeners[U||"$"]=D},ge("Solution",sc),ge("OptionType",{BOOL:0,NUMBER:1,ta:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(B=yt.prototype).close=function(){return this.h.close(),Promise.resolve()},B.onResults=function(D){this.h.onResults(D)},B.initialize=function(){var D=this;return Ft(function(U){return Tt(U,D.h.initialize(),0)})},B.reset=function(){this.h.reset()},B.send=function(D){var U=this;return Ft(function(et){return Tt(et,U.h.send(D),0)})},B.setOptions=function(D){this.h.setOptions(D)},ge("Hands",yt),ge("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),ge("VERSION","0.4.1675469240")}).call(this)},3242:function(L,O,S){(function(){var B;function j(D){var U=0;return function(){return U<D.length?{done:!1,value:D[U++]}:{done:!0}}}var K=typeof Object.defineProperties=="function"?Object.defineProperty:function(D,U,et){return D==Array.prototype||D==Object.prototype||(D[U]=et.value),D},Z=function(D){D=[typeof globalThis=="object"&&globalThis,D,typeof window=="object"&&window,typeof self=="object"&&self,typeof S.g=="object"&&S.g];for(var U=0;U<D.length;++U){var et=D[U];if(et&&et.Math==Math)return et}throw Error("Cannot find global object")}(this);function Y(D,U){if(U)t:{var et=Z;D=D.split(".");for(var ut=0;ut<D.length-1;ut++){var pt=D[ut];if(!(pt in et))break t;et=et[pt]}(U=U(ut=et[D=D[D.length-1]]))!=ut&&U!=null&&K(et,D,{configurable:!0,writable:!0,value:U})}}function X(D){return(D={next:D})[Symbol.iterator]=function(){return this},D}function J(D){var U=typeof Symbol<"u"&&Symbol.iterator&&D[Symbol.iterator];return U?U.call(D):{next:j(D)}}function q(D){if(!(D instanceof Array)){D=J(D);for(var U,et=[];!(U=D.next()).done;)et.push(U.value);D=et}return D}Y("Symbol",function(D){function U(pt,mt){this.h=pt,K(this,"description",{configurable:!0,writable:!0,value:mt})}if(D)return D;U.prototype.toString=function(){return this.h};var et="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",ut=0;return function pt(mt){if(this instanceof pt)throw new TypeError("Symbol is not a constructor");return new U(et+(mt||"")+"_"+ut++,mt)}}),Y("Symbol.iterator",function(D){if(D)return D;D=Symbol("Symbol.iterator");for(var U="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),et=0;et<U.length;et++){var ut=Z[U[et]];typeof ut=="function"&&typeof ut.prototype[D]!="function"&&K(ut.prototype,D,{configurable:!0,writable:!0,value:function(){return X(j(this))}})}return D});var H=typeof Object.assign=="function"?Object.assign:function(D,U){for(var et=1;et<arguments.length;et++){var ut=arguments[et];if(ut)for(var pt in ut)Object.prototype.hasOwnProperty.call(ut,pt)&&(D[pt]=ut[pt])}return D};Y("Object.assign",function(D){return D||H});var tt,st=typeof Object.create=="function"?Object.create:function(D){function U(){}return U.prototype=D,new U};if(typeof Object.setPrototypeOf=="function")tt=Object.setPrototypeOf;else{var lt;t:{var ft={};try{ft.__proto__={a:!0},lt=ft.a;break t}catch{}lt=!1}tt=lt?function(D,U){if(D.__proto__=U,D.__proto__!==U)throw new TypeError(D+" is not extensible");return D}:null}var gt=tt;function xt(D,U){if(D.prototype=st(U.prototype),D.prototype.constructor=D,gt)gt(D,U);else for(var et in U)if(et!="prototype")if(Object.defineProperties){var ut=Object.getOwnPropertyDescriptor(U,et);ut&&Object.defineProperty(D,et,ut)}else D[et]=U[et];D.za=U.prototype}function wt(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function _t(D){if(D.m)throw new TypeError("Generator is already running");D.m=!0}function bt(D,U){D.l={ma:U,na:!0},D.h=D.s||D.v}function Tt(D,U,et){return D.h=et,{value:U}}function qt(D){this.h=new wt,this.i=D}function It(D,U,et,ut){try{var pt=U.call(D.h.j,et);if(!(pt instanceof Object))throw new TypeError("Iterator result "+pt+" is not an object");if(!pt.done)return D.h.m=!1,pt;var mt=pt.value}catch(At){return D.h.j=null,bt(D.h,At),St(D)}return D.h.j=null,ut.call(D.h,mt),St(D)}function St(D){for(;D.h.h;)try{var U=D.i(D.h);if(U)return D.h.m=!1,{value:U.value,done:!1}}catch(et){D.h.i=void 0,bt(D.h,et)}if(D.h.m=!1,D.h.l){if(U=D.h.l,D.h.l=null,U.na)throw U.ma;return{value:U.return,done:!0}}return{value:void 0,done:!0}}function vt(D){this.next=function(U){return _t(D.h),D.h.j?U=It(D,D.h.j.next,U,D.h.u):(D.h.u(U),U=St(D)),U},this.throw=function(U){return _t(D.h),D.h.j?U=It(D,D.h.j.throw,U,D.h.u):(bt(D.h,U),U=St(D)),U},this.return=function(U){return function(et,ut){_t(et.h);var pt=et.h.j;return pt?It(et,"return"in pt?pt.return:function(mt){return{value:mt,done:!0}},ut,et.h.return):(et.h.return(ut),St(et))}(D,U)},this[Symbol.iterator]=function(){return this}}function Ft(D){return function(U){function et(pt){return U.next(pt)}function ut(pt){return U.throw(pt)}return new Promise(function(pt,mt){(function At(zt){zt.done?pt(zt.value):Promise.resolve(zt.value).then(et,ut).then(At,mt)})(U.next())})}(new vt(new qt(D)))}function Qt(D){return D||Array.prototype.fill}wt.prototype.u=function(D){this.i=D},wt.prototype.return=function(D){this.l={return:D},this.h=this.v},Y("Promise",function(D){function U(At){this.i=0,this.j=void 0,this.h=[],this.u=!1;var zt=this.l();try{At(zt.resolve,zt.reject)}catch(pe){zt.reject(pe)}}function et(){this.h=null}function ut(At){return At instanceof U?At:new U(function(zt){zt(At)})}if(D)return D;et.prototype.i=function(At){if(this.h==null){this.h=[];var zt=this;this.j(function(){zt.m()})}this.h.push(At)};var pt=Z.setTimeout;et.prototype.j=function(At){pt(At,0)},et.prototype.m=function(){for(;this.h&&this.h.length;){var At=this.h;this.h=[];for(var zt=0;zt<At.length;++zt){var pe=At[zt];At[zt]=null;try{pe()}catch(We){this.l(We)}}}this.h=null},et.prototype.l=function(At){this.j(function(){throw At})},U.prototype.l=function(){function At(We){return function(Ke){pe||(pe=!0,We.call(zt,Ke))}}var zt=this,pe=!1;return{resolve:At(this.I),reject:At(this.m)}},U.prototype.I=function(At){if(At===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(At instanceof U)this.L(At);else{t:switch(typeof At){case"object":var zt=At!=null;break t;case"function":zt=!0;break t;default:zt=!1}zt?this.F(At):this.s(At)}},U.prototype.F=function(At){var zt=void 0;try{zt=At.then}catch(pe){return void this.m(pe)}typeof zt=="function"?this.M(zt,At):this.s(At)},U.prototype.m=function(At){this.v(2,At)},U.prototype.s=function(At){this.v(1,At)},U.prototype.v=function(At,zt){if(this.i!=0)throw Error("Cannot settle("+At+", "+zt+"): Promise already settled in state"+this.i);this.i=At,this.j=zt,this.i===2&&this.K(),this.H()},U.prototype.K=function(){var At=this;pt(function(){if(At.D()){var zt=Z.console;zt!==void 0&&zt.error(At.j)}},1)},U.prototype.D=function(){if(this.u)return!1;var At=Z.CustomEvent,zt=Z.Event,pe=Z.dispatchEvent;return pe===void 0||(typeof At=="function"?At=new At("unhandledrejection",{cancelable:!0}):typeof zt=="function"?At=new zt("unhandledrejection",{cancelable:!0}):(At=Z.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,At),At.promise=this,At.reason=this.j,pe(At))},U.prototype.H=function(){if(this.h!=null){for(var At=0;At<this.h.length;++At)mt.i(this.h[At]);this.h=null}};var mt=new et;return U.prototype.L=function(At){var zt=this.l();At.T(zt.resolve,zt.reject)},U.prototype.M=function(At,zt){var pe=this.l();try{At.call(zt,pe.resolve,pe.reject)}catch(We){pe.reject(We)}},U.prototype.then=function(At,zt){function pe(nn,un){return typeof nn=="function"?function(zn){try{We(nn(zn))}catch(In){Ke(In)}}:un}var We,Ke,Tn=new U(function(nn,un){We=nn,Ke=un});return this.T(pe(At,We),pe(zt,Ke)),Tn},U.prototype.catch=function(At){return this.then(void 0,At)},U.prototype.T=function(At,zt){function pe(){switch(We.i){case 1:At(We.j);break;case 2:zt(We.j);break;default:throw Error("Unexpected state: "+We.i)}}var We=this;this.h==null?mt.i(pe):this.h.push(pe),this.u=!0},U.resolve=ut,U.reject=function(At){return new U(function(zt,pe){pe(At)})},U.race=function(At){return new U(function(zt,pe){for(var We=J(At),Ke=We.next();!Ke.done;Ke=We.next())ut(Ke.value).T(zt,pe)})},U.all=function(At){var zt=J(At),pe=zt.next();return pe.done?ut([]):new U(function(We,Ke){function Tn(zn){return function(In){nn[zn]=In,--un==0&&We(nn)}}var nn=[],un=0;do nn.push(void 0),un++,ut(pe.value).T(Tn(nn.length-1),Ke),pe=zt.next();while(!pe.done)})},U}),Y("Array.prototype.keys",function(D){return D||function(){return function(U,et){U instanceof String&&(U+="");var ut=0,pt=!1,mt={next:function(){if(!pt&&ut<U.length){var At=ut++;return{value:et(At,U[At]),done:!1}}return pt=!0,{done:!0,value:void 0}}};return mt[Symbol.iterator]=function(){return mt},mt}(this,function(U){return U})}}),Y("Array.prototype.fill",function(D){return D||function(U,et,ut){var pt=this.length||0;for(0>et&&(et=Math.max(0,pt+et)),(ut==null||ut>pt)&&(ut=pt),0>(ut=Number(ut))&&(ut=Math.max(0,pt+ut)),et=Number(et||0);et<ut;et++)this[et]=U;return this}}),Y("Int8Array.prototype.fill",Qt),Y("Uint8Array.prototype.fill",Qt),Y("Uint8ClampedArray.prototype.fill",Qt),Y("Int16Array.prototype.fill",Qt),Y("Uint16Array.prototype.fill",Qt),Y("Int32Array.prototype.fill",Qt),Y("Uint32Array.prototype.fill",Qt),Y("Float32Array.prototype.fill",Qt),Y("Float64Array.prototype.fill",Qt),Y("Object.is",function(D){return D||function(U,et){return U===et?U!==0||1/U==1/et:U!=U&&et!=et}}),Y("Array.prototype.includes",function(D){return D||function(U,et){var ut=this;ut instanceof String&&(ut=String(ut));var pt=ut.length;for(0>(et=et||0)&&(et=Math.max(et+pt,0));et<pt;et++){var mt=ut[et];if(mt===U||Object.is(mt,U))return!0}return!1}}),Y("String.prototype.includes",function(D){return D||function(U,et){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(U instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(U,et||0)!==-1}});var Gt=this||self;function ge(D,U){D=D.split(".");var et,ut=Gt;for((D[0]in ut)||ut.execScript===void 0||ut.execScript("var "+D[0]);D.length&&(et=D.shift());)D.length||U===void 0?ut=ut[et]&&ut[et]!==Object.prototype[et]?ut[et]:ut[et]={}:ut[et]=U}function ee(D){var U;return(U=Gt.navigator)&&(U=U.userAgent)||(U=""),U.indexOf(D)!=-1}var Ee=Array.prototype.map?function(D,U){return Array.prototype.map.call(D,U,void 0)}:function(D,U){for(var et=D.length,ut=Array(et),pt=typeof D=="string"?D.split(""):D,mt=0;mt<et;mt++)mt in pt&&(ut[mt]=U.call(void 0,pt[mt],mt,D));return ut},Bt={},Xt=null;function we(D){var U=D.length,et=3*U/4;et%3?et=Math.floor(et):"=.".indexOf(D[U-1])!=-1&&(et="=.".indexOf(D[U-2])!=-1?et-2:et-1);var ut=new Uint8Array(et),pt=0;return function(mt,At){function zt(un){for(;pe<mt.length;){var zn=mt.charAt(pe++),In=Xt[zn];if(In!=null)return In;if(!/^[\s\xa0]*$/.test(zn))throw Error("Unknown base64 encoding at char: "+zn)}return un}ie();for(var pe=0;;){var We=zt(-1),Ke=zt(0),Tn=zt(64),nn=zt(64);if(nn===64&&We===-1)break;At(We<<2|Ke>>4),Tn!=64&&(At(Ke<<4&240|Tn>>2),nn!=64&&At(Tn<<6&192|nn))}}(D,function(mt){ut[pt++]=mt}),pt!==et?ut.subarray(0,pt):ut}function ie(){if(!Xt){Xt={};for(var D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),U=["+/=","+/","-_=","-_.","-_"],et=0;5>et;et++){var ut=D.concat(U[et].split(""));Bt[et]=ut;for(var pt=0;pt<ut.length;pt++){var mt=ut[pt];Xt[mt]===void 0&&(Xt[mt]=pt)}}}}var m=typeof Uint8Array<"u",ye=!(ee("Trident")||ee("MSIE"))&&typeof Gt.btoa=="function";function Ge(D){if(!ye){var U;U===void 0&&(U=0),ie(),U=Bt[U];for(var et=Array(Math.floor(D.length/3)),ut=U[64]||"",pt=0,mt=0;pt<D.length-2;pt+=3){var At=D[pt],zt=D[pt+1],pe=D[pt+2],We=U[At>>2];At=U[(3&At)<<4|zt>>4],zt=U[(15&zt)<<2|pe>>6],pe=U[63&pe],et[mt++]=We+At+zt+pe}switch(We=0,pe=ut,D.length-pt){case 2:pe=U[(15&(We=D[pt+1]))<<2]||ut;case 1:D=D[pt],et[mt]=U[D>>2]+U[(3&D)<<4|We>>4]+pe+ut}return et.join("")}for(U="";10240<D.length;)U+=String.fromCharCode.apply(null,D.subarray(0,10240)),D=D.subarray(10240);return U+=String.fromCharCode.apply(null,D),btoa(U)}var te,Me=RegExp("[-_.]","g");function Ye(D){switch(D){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function Ue(D){if(!ye)return we(D);Me.test(D)&&(D=D.replace(Me,Ye)),D=atob(D);for(var U=new Uint8Array(D.length),et=0;et<D.length;et++)U[et]=D.charCodeAt(et);return U}function kn(){return te||(te=new Uint8Array(0))}var mn={},Kn=typeof Uint8Array.prototype.slice=="function",Sn=0,Wn=0;function Ze(D){var U=0>D,et=(D=Math.abs(D))>>>0;D=Math.floor((D-et)/4294967296),U&&(U=(et=J(Kt(et,D))).next().value,D=et.next().value,et=U),Sn=et>>>0,Wn=D>>>0}var de,Re=typeof BigInt=="function";function Kt(D,U){return U=~U,D?D=1+~D:U+=1,[D,U]}function Jt(D,U){this.i=D>>>0,this.h=U>>>0}function Ae(D){if(!D)return de||(de=new Jt(0,0));if(!/^-?\d+$/.test(D))return null;if(16>D.length)Ze(Number(D));else if(Re)D=BigInt(D),Sn=Number(D&BigInt(4294967295))>>>0,Wn=Number(D>>BigInt(32)&BigInt(4294967295));else{var U=+(D[0]==="-");Wn=Sn=0;for(var et=D.length,ut=U,pt=(et-U)%6+U;pt<=et;ut=pt,pt+=6)ut=Number(D.slice(ut,pt)),Wn*=1e6,4294967296<=(Sn=1e6*Sn+ut)&&(Wn+=Sn/4294967296|0,Sn%=4294967296);U&&(D=(U=J(Kt(Sn,Wn))).next().value,U=U.next().value,Sn=D,Wn=U)}return new Jt(Sn,Wn)}function $e(D,U){return Error("Invalid wire type: "+D+" (at position "+U+")")}function tn(){return Error("Failed to read varint, encoding is invalid.")}function wn(D,U){return Error("Tried to read past the end of the data "+U+" > "+D)}function Mn(){throw Error("Invalid UTF8")}function Hn(D,U){return U=String.fromCharCode.apply(null,U),D==null?U:D+U}var Zn,_r,Sr,Mr=void 0,ai=typeof TextDecoder<"u",ea=typeof TextEncoder<"u";function Pi(D){if(D!==mn)throw Error("illegal external caller")}function Cr(D,U){if(Pi(U),this.V=D,D!=null&&D.length===0)throw Error("ByteString should be constructed with non-empty values")}function Ti(){return Sr||(Sr=new Cr(null,mn))}function Be(D){Pi(mn);var U=D.V;return(U=U==null||m&&U!=null&&U instanceof Uint8Array?U:typeof U=="string"?Ue(U):null)==null?U:D.V=U}function En(D,U){this.i=null,this.m=!1,this.h=this.j=this.l=0,lr(this,D,U)}function lr(D,U,et){et=et===void 0?{}:et,D.S=et.S!==void 0&&et.S,U&&(U=function(ut){if(typeof ut=="string")return{buffer:Ue(ut),C:!1};if(Array.isArray(ut))return{buffer:new Uint8Array(ut),C:!1};if(ut.constructor===Uint8Array)return{buffer:ut,C:!1};if(ut.constructor===ArrayBuffer)return{buffer:new Uint8Array(ut),C:!1};if(ut.constructor===Cr)return{buffer:Be(ut)||kn(),C:!0};if(ut instanceof Uint8Array)return{buffer:new Uint8Array(ut.buffer,ut.byteOffset,ut.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}(U),D.i=U.buffer,D.m=U.C,D.l=0,D.j=D.i.length,D.h=D.l)}function qn(D,U){if(D.h=U,U>D.j)throw wn(D.j,U)}function fr(D){var U=D.i,et=D.h,ut=U[et++],pt=127&ut;if(128&ut&&(pt|=(127&(ut=U[et++]))<<7,128&ut&&(pt|=(127&(ut=U[et++]))<<14,128&ut&&(pt|=(127&(ut=U[et++]))<<21,128&ut&&(pt|=(ut=U[et++])<<28,128&ut&&128&U[et++]&&128&U[et++]&&128&U[et++]&&128&U[et++]&&128&U[et++])))))throw tn();return qn(D,et),pt}function Er(D,U){if(0>U)throw Error("Tried to read a negative byte length: "+U);var et=D.h,ut=et+U;if(ut>D.j)throw wn(U,D.j-et);return D.h=ut,et}En.prototype.reset=function(){this.h=this.l};var Qr=[];function vi(){this.h=[]}function ua(D,U,et){for(;0<et||127<U;)D.h.push(127&U|128),U=(U>>>7|et<<25)>>>0,et>>>=7;D.h.push(U)}function br(D,U){for(;127<U;)D.h.push(127&U|128),U>>>=7;D.h.push(U)}function eo(D,U){if(Qr.length){var et=Qr.pop();lr(et,D,U),D=et}else D=new En(D,U);this.h=D,this.j=this.h.h,this.i=this.l=-1,this.setOptions(U)}function Fo(D){var U=D.h;if(U.h==U.j)return!1;D.j=D.h.h;var et=fr(D.h)>>>0;if(U=et>>>3,!(0<=(et&=7)&&5>=et))throw $e(et,D.j);if(1>U)throw Error("Invalid field number: "+U+" (at position "+D.j+")");return D.l=U,D.i=et,!0}function Wa(D){switch(D.i){case 0:if(D.i!=0)Wa(D);else t:{for(var U=(D=D.h).h,et=U+10,ut=D.i;U<et;)if(!(128&ut[U++])){qn(D,U);break t}throw tn()}break;case 1:qn(D=D.h,D.h+8);break;case 2:D.i!=2?Wa(D):(U=fr(D.h)>>>0,qn(D=D.h,D.h+U));break;case 5:qn(D=D.h,D.h+4);break;case 3:for(U=D.l;;){if(!Fo(D))throw Error("Unmatched start-group tag: stream EOF");if(D.i==4){if(D.l!=U)throw Error("Unmatched end-group tag");break}Wa(D)}break;default:throw $e(D.i,D.j)}}vi.prototype.length=function(){return this.h.length},vi.prototype.end=function(){var D=this.h;return this.h=[],D},eo.prototype.setOptions=function(D){D=D===void 0?{}:D,this.ca=D.ca!==void 0&&D.ca},eo.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};var Le=[];function bn(){this.j=[],this.i=0,this.h=new vi}function jn(D,U){U.length!==0&&(D.j.push(U),D.i+=U.length)}var Jn=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function dr(D,U){return Jn?D[Jn]|=U:D.A!==void 0?D.A|=U:(Object.defineProperties(D,{A:{value:U,configurable:!0,writable:!0,enumerable:!1}}),U)}function Ur(D,U){Jn?D[Jn]&&(D[Jn]&=~U):D.A!==void 0&&(D.A&=~U)}function or(D){var U;return(U=Jn?D[Jn]:D.A)==null?0:U}function Yn(D,U){Jn?D[Jn]=U:D.A!==void 0?D.A=U:Object.defineProperties(D,{A:{value:U,configurable:!0,writable:!0,enumerable:!1}})}function li(D){return dr(D,1),D}function Ki(D,U){Yn(U,-51&D)}function Si(D,U){Yn(U,-41&D|18)}var Da={};function _i(D){return D!==null&&typeof D=="object"&&!Array.isArray(D)&&D.constructor===Object}var la,so,ys=[];function vs(D){if(2&or(D.o))throw Error("Cannot mutate an immutable Message")}function qo(D){var U=D.length;(U=U?D[U-1]:void 0)&&_i(U)?U.g=1:(U={},D.push((U.g=1,U)))}function bs(D){var U=D.i+D.G;return D.B||(D.B=D.o[U]={})}function na(D,U){return U===-1?null:U>=D.i?D.B?D.B[U]:void 0:D.o[U+D.G]}function va(D,U,et,ut){vs(D),Ya(D,U,et,ut)}function Ya(D,U,et,ut){D.j&&(D.j=void 0),U>=D.i||ut?bs(D)[U]=et:(D.o[U+D.G]=et,(D=D.B)&&U in D&&delete D[U])}function Xo(D,U,et,ut){var pt=na(D,U);Array.isArray(pt)||(pt=la);var mt=or(pt);if(1&mt||li(pt),ut)2&mt||dr(pt,2),1&et||Object.freeze(pt);else{ut=!(2&et);var At=2&mt;1&et||!At?ut&&16&mt&&!At&&Ur(pt,16):Ya(D,U,pt=li(Array.prototype.slice.call(pt)))}return pt}function Du(D,U){var et=na(D,U),ut=et==null?et:typeof et=="number"||et==="NaN"||et==="Infinity"||et==="-Infinity"?Number(et):void 0;return ut!=null&&ut!==et&&Ya(D,U,ut),ut}function uu(D,U,et,ut,pt){D.h||(D.h={});var mt=D.h[et],At=Xo(D,et,3,pt);if(!mt){var zt=At;mt=[];var pe=!!(16&or(D.o));At=!!(2&or(zt));var We=zt;!pt&&At&&(zt=Array.prototype.slice.call(zt));for(var Ke=At,Tn=0;Tn<zt.length;Tn++){var nn=zt[Tn],un=U,zn=!1;if(zn=zn!==void 0&&zn,(nn=Array.isArray(nn)?new un(nn):zn?new un:void 0)!==void 0){var In=zn=or(un=nn.o);At&&(In|=2),pe&&(In|=16),In!=zn&&Yn(un,In),un=In,Ke=Ke||!!(2&un),mt.push(nn)}}return D.h[et]=mt,U=33|(pe=or(zt)),pe!=(U=Ke?-9&U:8|U)&&(Ke=zt,Object.isFrozen(Ke)&&(Ke=Array.prototype.slice.call(Ke)),Yn(Ke,U),zt=Ke),We!==zt&&Ya(D,et,zt),(pt||ut&&At)&&dr(mt,2),ut&&Object.freeze(mt),mt}return pt||(pt=Object.isFrozen(mt),ut&&!pt?Object.freeze(mt):!ut&&pt&&(mt=Array.prototype.slice.call(mt),D.h[et]=mt)),mt}function ws(D,U,et){var ut=!!(2&or(D.o));if(U=uu(D,U,et,ut,ut),D=Xo(D,et,3,ut),!(ut||8&or(D))){for(ut=0;ut<U.length;ut++){if(2&or((et=U[ut]).o)){var pt=Zo(et,!1);pt.j=et}else pt=et;et!==pt&&(U[ut]=pt,D[ut]=pt.o)}dr(D,8)}return U}function Ra(D,U,et){if(et!=null&&typeof et!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof et+": "+et);va(D,U,et)}function Ru(D,U,et,ut,pt){vs(D);var mt=uu(D,et,U,!1,!1);return et=ut??new et,D=Xo(D,U,2,!1),pt!=null?(mt.splice(pt,0,et),D.splice(pt,0,et.o)):(mt.push(et),D.push(et.o)),et.C()&&Ur(D,8),et}function Ko(D,U){return D??U}function Ga(D,U,et){return et=et===void 0?0:et,Ko(Du(D,U),et)}function Fu(D,U,et,ut){if(D!=null){if(Array.isArray(D))D=Zs(D,U,et,ut!==void 0);else if(_i(D)){var pt,mt={};for(pt in D)mt[pt]=Fu(D[pt],U,et,ut);D=mt}else D=U(D,ut);return D}}function Zs(D,U,et,ut){var pt=or(D);ut=ut?!!(16&pt):void 0,D=Array.prototype.slice.call(D);for(var mt=0;mt<D.length;mt++)D[mt]=Fu(D[mt],U,et,ut);return et(pt,D),D}function Rc(D){return D.ja===Da?D.toJSON():function(U){switch(typeof U){case"number":return isFinite(U)?U:String(U);case"object":if(U)if(Array.isArray(U)){if(128&or(U))return qo(U=Array.prototype.slice.call(U)),U}else{if(m&&U!=null&&U instanceof Uint8Array)return Ge(U);if(U instanceof Cr){var et=U.V;return et==null?"":typeof et=="string"?et:U.V=Ge(et)}}}return U}(D)}function bu(D,U){128&D&&qo(U)}function Qs(D,U,et){if(et=et===void 0?Si:et,D!=null){if(m&&D instanceof Uint8Array)return D.length?new Cr(new Uint8Array(D),mn):Ti();if(Array.isArray(D)){var ut=or(D);return 2&ut?D:!U||32&ut||!(16&ut||ut===0)?(4&(U=or(D=Zs(D,Qs,4&ut?Si:et,!0)))&&2&U&&Object.freeze(D),D):(Yn(D,2|ut),D)}return D.ja===Da?Tl(D):D}}function wu(D,U,et,ut,pt,mt,At){if(D=D.h&&D.h[et]){if(2&(ut=or(D))?ut=D:(Si(ut,mt=Ee(D,Tl)),Object.freeze(mt),ut=mt),vs(U),At=ut==null?la:li([]),ut!=null){for(mt=!!ut.length,D=0;D<ut.length;D++){var zt=ut[D];mt=mt&&!(2&or(zt.o)),At[D]=zt.o}mt=1|(mt?8:0),((D=or(At))&mt)!==mt&&(Object.isFrozen(At)&&(At=Array.prototype.slice.call(At)),Yn(At,D|mt)),U.h||(U.h={}),U.h[et]=ut}else U.h&&(U.h[et]=void 0);Ya(U,et,At,pt)}else va(U,et,Qs(ut,mt,At),pt)}function Tl(D){return 2&or(D.o)||dr((D=Zo(D,!0)).o,2),D}function Zo(D,U){var et=D.o,ut=[];dr(ut,16);var pt=D.constructor.h;if(pt&&ut.push(pt),pt=D.B){ut.length=et.length,ut.fill(void 0,ut.length,et.length);var mt={};ut[ut.length-1]=mt}128&or(et)&&qo(ut),U=U||D.C()?Si:Ki,mt=D.constructor,so=ut,ut=new mt(ut),so=void 0,D.R&&(ut.R=D.R.slice()),mt=!!(16&or(et));for(var At=pt?et.length-1:et.length,zt=0;zt<At;zt++)wu(D,ut,zt-D.G,et[zt],!1,mt,U);if(pt)for(var pe in pt)wu(D,ut,+pe,pt[pe],!0,mt,U);return ut}function ji(D,U,et){D==null&&(D=so),so=void 0;var ut,pt=this.constructor.i||0,mt=0<pt,At=this.constructor.h,zt=!1;if(D==null){var pe=48,We=!0;mt&&(pt=0,pe|=128),Yn(D=At?[At]:[],pe)}else{if(!Array.isArray(D)||At&&At!==D[0])throw Error();var Ke=pe=dr(D,0);if((We=!!(16&Ke))&&((zt=!!(32&Ke))||(Ke|=32)),mt){if(128&Ke)pt=0;else if(0<D.length){var Tn=D[D.length-1];if(_i(Tn)&&"g"in Tn){pt=0,Ke|=128,delete Tn.g;var nn,un=!0;for(nn in Tn){un=!1;break}un&&D.pop()}}}else if(128&Ke)throw Error();pe!==Ke&&Yn(D,Ke)}if(this.G=(At?0:-1)-pt,this.h=void 0,this.o=D,pt=(At=this.o.length)-1,At&&_i(At=this.o[pt])?(this.B=At,this.i=pt-this.G):U!==void 0&&-1<U?(this.i=Math.max(U,pt+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE,!mt&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(et)for(U=We&&!zt&&!0,mt=this.i,We=0;We<et.length;We++)(zt=et[We])<mt?(pt=D[zt+=this.G])?Ku(pt,U):D[zt]=la:(ut||(ut=bs(this)),(pt=ut[zt])?Ku(pt,U):ut[zt]=la)}function Ku(D,U){if(Array.isArray(D)){var et=or(D),ut=1;!U||2&et||(ut|=16),(et&ut)!==ut&&Yn(D,et|ut)}}function Zu(D,U,et){if(et){var ut,pt={};for(ut in et){var mt=et[ut],At=mt.ra;At||(pt.J=mt.xa||mt.oa.W,mt.ia?(pt.aa=Ce(mt.ia),At=function(zt){return function(pe,We,Ke){return zt.J(pe,We,Ke,zt.aa)}}(pt)):mt.ka?(pt.Z=le(mt.da.P,mt.ka),At=function(zt){return function(pe,We,Ke){return zt.J(pe,We,Ke,zt.Z)}}(pt)):At=pt.J,mt.ra=At),At(U,D,mt.da),pt={J:pt.J,aa:pt.aa,Z:pt.Z}}}(function(zt,pe){if(pe=pe.R){jn(zt,zt.h.end());for(var We=0;We<pe.length;We++)jn(zt,Be(pe[We])||kn())}})(U,D)}Yn(ys,23),la=Object.freeze(ys),ji.prototype.toJSON=function(){return Zs(this.o,Rc,bu)},ji.prototype.C=function(){return!!(2&or(this.o))},ji.prototype.ja=Da,ji.prototype.toString=function(){return this.o.toString()};var xs=Symbol();function xu(D,U,et){return D[xs]||(D[xs]=function(ut,pt){return U(ut,pt,et)})}function pa(D){var U=D[xs];if(!U){var et=bi(D);U=function(ut,pt){return Ci(ut,pt,et)},D[xs]=U}return U}function _n(D){var U=function(pt){var mt=pt.ia;return mt?pa(mt):(mt=pt.wa)?xu(pt.da.P,mt,pt.ka):void 0}(D),et=D.da,ut=D.oa.U;return U?function(pt,mt){return ut(pt,mt,et,U)}:function(pt,mt){return ut(pt,mt,et)}}function ls(D,U){var et=D[U];return typeof et=="function"&&et.length===0&&(et=et(),D[U]=et),Array.isArray(et)&&($i in et||Pe in et||0<et.length&&typeof et[0]=="function")?et:void 0}function Dt(D,U,et,ut,pt,mt){U.P=D[0];var At=1;if(D.length>At&&typeof D[At]!="number"){var zt=D[At++];et(U,zt)}for(;At<D.length;){et=D[At++];for(var pe=At+1;pe<D.length&&typeof D[pe]!="number";)pe++;switch(zt=D[At++],pe-=At){case 0:ut(U,et,zt);break;case 1:(pe=ls(D,At))?(At++,pt(U,et,zt,pe)):ut(U,et,zt,D[At++]);break;case 2:pt(U,et,zt,pe=ls(D,pe=At++),D[At++]);break;case 3:mt(U,et,zt,D[At++],D[At++],D[At++]);break;case 4:mt(U,et,zt,D[At++],D[At++],D[At++],D[At++]);break;default:throw Error("unexpected number of binary field arguments: "+pe)}}return U}var Zt=Symbol();function Ce(D){var U=D[Zt];if(!U){var et=Kr(D);U=function(ut,pt){return ra(ut,pt,et)},D[Zt]=U}return U}function le(D,U){var et=D[Zt];return et||(et=function(ut,pt){return Zu(ut,pt,U)},D[Zt]=et),et}var Pe=Symbol();function rn(D,U){D.push(U)}function Cn(D,U,et){D.push(U,et.W)}function Vn(D,U,et,ut){var pt=Ce(ut),mt=Kr(ut).P,At=et.W;D.push(U,function(zt,pe,We){return At(zt,pe,We,mt,pt)})}function hr(D,U,et,ut,pt,mt){var At=le(ut,mt),zt=et.W;D.push(U,function(pe,We,Ke){return zt(pe,We,Ke,ut,At)})}function Kr(D){var U=D[Pe];return U||(U=Dt(D,D[Pe]=[],rn,Cn,Vn,hr),$i in D&&Pe in D&&(D.length=0),U)}var $i=Symbol();function Ai(D,U){D[0]=U}function Rr(D,U,et,ut){var pt=et.U;D[U]=ut?function(mt,At,zt){return pt(mt,At,zt,ut)}:pt}function Jr(D,U,et,ut,pt){var mt=et.U,At=pa(ut),zt=bi(ut).P;D[U]=function(pe,We,Ke){return mt(pe,We,Ke,zt,At,pt)}}function di(D,U,et,ut,pt,mt,At){var zt=et.U,pe=xu(ut,pt,mt);D[U]=function(We,Ke,Tn){return zt(We,Ke,Tn,ut,pe,At)}}function bi(D){var U=D[$i];return U||(U=Dt(D,D[$i]={},Ai,Rr,Jr,di),$i in D&&Pe in D&&(D.length=0),U)}function Ci(D,U,et){for(;Fo(U)&&U.i!=4;){var ut=U.l,pt=et[ut];if(!pt){var mt=et[0];mt&&(mt=mt[ut])&&(pt=et[ut]=_n(mt))}if(!pt||!pt(U,D,ut)){ut=D,mt=(pt=U).j,Wa(pt);var At=pt;if(!At.ca){if(pt=At.h.h-mt,At.h.h=mt,At=At.h,pt==0)pt=Ti();else{if(mt=Er(At,pt),At.S&&At.m)pt=At.i.subarray(mt,mt+pt);else{At=At.i;var zt=mt;pt=zt===(pt=mt+pt)?kn():Kn?At.slice(zt,pt):new Uint8Array(At.subarray(zt,pt))}pt=pt.length==0?Ti():new Cr(pt,mn)}(mt=ut.R)?mt.push(pt):ut.R=[pt]}}}return D}function ra(D,U,et){for(var ut=et.length,pt=ut%2==1,mt=pt?1:0;mt<ut;mt+=2)(0,et[mt+1])(U,D,et[mt]);Zu(D,U,pt?et[0]:void 0)}function oa(D,U){return{U:D,W:U}}var Wr=oa(function(D,U,et){if(D.i!==5)return!1;var ut=(D=D.h).i,pt=D.h,mt=ut[pt],At=ut[pt+1],zt=ut[pt+2];return ut=ut[pt+3],qn(D,D.h+4),D=2*((At=(mt|At<<8|zt<<16|ut<<24)>>>0)>>31)+1,mt=At>>>23&255,At&=8388607,va(U,et,mt==255?At?NaN:1/0*D:mt==0?D*Math.pow(2,-149)*At:D*Math.pow(2,mt-150)*(At+Math.pow(2,23))),!0},function(D,U,et){if((U=Du(U,et))!=null){br(D.h,8*et+5),D=D.h;var ut=+U;ut===0?0<1/ut?Sn=Wn=0:(Wn=0,Sn=2147483648):isNaN(ut)?(Wn=0,Sn=2147483647):34028234663852886e22<(ut=(et=0>ut?-2147483648:0)?-ut:ut)?(Wn=0,Sn=(2139095040|et)>>>0):11754943508222875e-54>ut?(ut=Math.round(ut/Math.pow(2,-149)),Wn=0,Sn=(et|ut)>>>0):(U=Math.floor(Math.log(ut)/Math.LN2),ut*=Math.pow(2,-U),16777216<=(ut=Math.round(8388608*ut))&&++U,Wn=0,Sn=(et|U+127<<23|8388607&ut)>>>0),et=Sn,D.h.push(et>>>0&255),D.h.push(et>>>8&255),D.h.push(et>>>16&255),D.h.push(et>>>24&255)}}),_a=oa(function(D,U,et){if(D.i!==0)return!1;var ut=D.h,pt=0,mt=D=0,At=ut.i,zt=ut.h;do{var pe=At[zt++];pt|=(127&pe)<<mt,mt+=7}while(32>mt&&128&pe);for(32<mt&&(D|=(127&pe)>>4),mt=3;32>mt&&128&pe;mt+=7)D|=(127&(pe=At[zt++]))<<mt;if(qn(ut,zt),!(128>pe))throw tn();return ut=pt>>>0,(D=2147483648&(pe=D>>>0))&&(pe=~pe>>>0,(ut=1+~ut>>>0)==0&&(pe=pe+1>>>0)),ut=4294967296*pe+(ut>>>0),va(U,et,D?-ut:ut),!0},function(D,U,et){(U=na(U,et))!=null&&(typeof U=="string"&&Ae(U),U!=null&&(br(D.h,8*et),typeof U=="number"?(D=D.h,Ze(U),ua(D,Sn,Wn)):(et=Ae(U),ua(D.h,et.i,et.h))))}),Ca=oa(function(D,U,et){return D.i===0&&(va(U,et,fr(D.h)),!0)},function(D,U,et){if((U=na(U,et))!=null&&U!=null)if(br(D.h,8*et),D=D.h,0<=(et=U))br(D,et);else{for(U=0;9>U;U++)D.h.push(127&et|128),et>>=7;D.h.push(1)}}),Gi=oa(function(D,U,et){if(D.i!==2)return!1;var ut=fr(D.h)>>>0,pt=Er(D=D.h,ut);if(D=D.i,ai){var mt,At=D;(mt=Zn)||(mt=Zn=new TextDecoder("utf-8",{fatal:!0})),D=pt+ut,At=pt===0&&D===At.length?At:At.subarray(pt,D);try{var zt=mt.decode(At)}catch(Tn){if(Mr===void 0){try{mt.decode(new Uint8Array([128]))}catch{}try{mt.decode(new Uint8Array([97])),Mr=!0}catch{Mr=!1}}throw!Mr&&(Zn=void 0),Tn}}else{ut=(zt=pt)+ut,pt=[];for(var pe,We,Ke=null;zt<ut;)128>(pe=D[zt++])?pt.push(pe):224>pe?zt>=ut?Mn():(We=D[zt++],194>pe||(192&We)!=128?(zt--,Mn()):pt.push((31&pe)<<6|63&We)):240>pe?zt>=ut-1?Mn():(192&(We=D[zt++]))!=128||pe===224&&160>We||pe===237&&160<=We||(192&(At=D[zt++]))!=128?(zt--,Mn()):pt.push((15&pe)<<12|(63&We)<<6|63&At):244>=pe?zt>=ut-2?Mn():(192&(We=D[zt++]))!=128||We-144+(pe<<28)>>30||(192&(At=D[zt++]))!=128||(192&(mt=D[zt++]))!=128?(zt--,Mn()):(pe=(7&pe)<<18|(63&We)<<12|(63&At)<<6|63&mt,pe-=65536,pt.push(55296+(pe>>10&1023),56320+(1023&pe))):Mn(),8192<=pt.length&&(Ke=Hn(Ke,pt),pt.length=0);zt=Hn(Ke,pt)}return va(U,et,zt),!0},function(D,U,et){if((U=na(U,et))!=null){var ut=!1;if(ut=ut!==void 0&&ut,ea){if(ut&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(U))throw Error("Found an unpaired surrogate");U=(_r||(_r=new TextEncoder)).encode(U)}else{for(var pt=0,mt=new Uint8Array(3*U.length),At=0;At<U.length;At++){var zt=U.charCodeAt(At);if(128>zt)mt[pt++]=zt;else{if(2048>zt)mt[pt++]=zt>>6|192;else{if(55296<=zt&&57343>=zt){if(56319>=zt&&At<U.length){var pe=U.charCodeAt(++At);if(56320<=pe&&57343>=pe){zt=1024*(zt-55296)+pe-56320+65536,mt[pt++]=zt>>18|240,mt[pt++]=zt>>12&63|128,mt[pt++]=zt>>6&63|128,mt[pt++]=63&zt|128;continue}At--}if(ut)throw Error("Found an unpaired surrogate");zt=65533}mt[pt++]=zt>>12|224,mt[pt++]=zt>>6&63|128}mt[pt++]=63&zt|128}}U=pt===mt.length?mt:mt.subarray(0,pt)}br(D.h,8*et+2),br(D.h,U.length),jn(D,D.h.end()),jn(D,U)}}),Ea=oa(function(D,U,et,ut,pt){if(D.i!==2)return!1;U=Ru(U,et,ut),et=D.h.j,ut=fr(D.h)>>>0;var mt=D.h.h+ut,At=mt-et;if(0>=At&&(D.h.j=mt,pt(U,D,void 0,void 0,void 0),At=mt-D.h.h),At)throw Error("Message parsing ended unexpectedly. Expected to read "+ut+" bytes, instead read "+(ut-At)+" bytes, either the data ended unexpectedly or the message misreported its own length");return D.h.h=mt,D.h.j=et,!0},function(D,U,et,ut,pt){if((U=ws(U,ut,et))!=null)for(ut=0;ut<U.length;ut++){var mt=D;br(mt.h,8*et+2);var At=mt.h.end();jn(mt,At),At.push(mt.i),mt=At,pt(U[ut],D),At=D;var zt=mt.pop();for(zt=At.i+At.h.length()-zt;127<zt;)mt.push(127&zt|128),zt>>>=7,At.i++;mt.push(zt),At.i++}});function Ta(D){return function(U,et){t:{if(Le.length){var ut=Le.pop();ut.setOptions(et),lr(ut.h,U,et),U=ut}else U=new eo(U,et);try{var pt=bi(D),mt=Ci(new pt.P,U,pt);break t}finally{(pt=U.h).i=null,pt.m=!1,pt.l=0,pt.j=0,pt.h=0,pt.S=!1,U.l=-1,U.i=-1,100>Le.length&&Le.push(U)}mt=void 0}return mt}}function Dn(D){return function(){var U=new bn;ra(this,U,Kr(D)),jn(U,U.h.end());for(var et=new Uint8Array(U.i),ut=U.j,pt=ut.length,mt=0,At=0;At<pt;At++){var zt=ut[At];et.set(zt,mt),mt+=zt.length}return U.j=[et],et}}function Ui(D){ji.call(this,D)}xt(Ui,ji);var sa=[Ui,1,Ca,2,Wr,3,Gi,4,Gi];function ks(D){ji.call(this,D,-1,Po)}Ui.prototype.l=Dn(sa),xt(ks,ji),ks.prototype.addClassification=function(D,U){return Ru(this,1,Ui,D,U),this};var Po=[1],ku=Ta([ks,1,Ea,sa]);function io(D){ji.call(this,D)}xt(io,ji);var an=[io,1,Wr,2,Wr,3,Wr,4,Wr,5,Wr];function Ms(D){ji.call(this,D,-1,lu)}io.prototype.l=Dn(an),xt(Ms,ji);var lu=[1],Ul=Ta([Ms,1,Ea,an]);function Ou(D){ji.call(this,D)}xt(Ou,ji);var Lu=[Ou,1,Wr,2,Wr,3,Wr,4,Wr,5,Wr,6,_a],Ed=Ta(Lu);function Fc(D,U,et){if(et=D.createShader(et===0?D.VERTEX_SHADER:D.FRAGMENT_SHADER),D.shaderSource(et,U),D.compileShader(et),!D.getShaderParameter(et,D.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+D.getShaderInfoLog(et));return et}function ni(D){return ws(D,Ui,1).map(function(U){var et=na(U,1);return{index:et??0,qa:Ga(U,2),label:na(U,3)!=null?Ko(na(U,3),""):void 0,displayName:na(U,4)!=null?Ko(na(U,4),""):void 0}})}function Zr(D){return{x:Ga(D,1),y:Ga(D,2),z:Ga(D,3),visibility:Du(D,4)!=null?Ga(D,4):void 0}}function Qu(D){return ws(Ul(D),io,1).map(Zr)}function Wl(D,U){this.i=D,this.h=U,this.m=0}function Yh(D,U,et){return function(ut,pt){var mt=ut.h;if(ut.s===void 0){var At=Fc(mt,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),zt=Fc(mt,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),pe=mt.createProgram();if(mt.attachShader(pe,At),mt.attachShader(pe,zt),mt.linkProgram(pe),!mt.getProgramParameter(pe,mt.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+mt.getProgramInfoLog(pe));At=ut.s=pe,mt.useProgram(At),zt=mt.getUniformLocation(At,"sampler0"),ut.l={O:mt.getAttribLocation(At,"aVertex"),N:mt.getAttribLocation(At,"aTex"),ya:zt},ut.v=mt.createBuffer(),mt.bindBuffer(mt.ARRAY_BUFFER,ut.v),mt.enableVertexAttribArray(ut.l.O),mt.vertexAttribPointer(ut.l.O,2,mt.FLOAT,!1,0,0),mt.bufferData(mt.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),mt.STATIC_DRAW),mt.bindBuffer(mt.ARRAY_BUFFER,null),ut.u=mt.createBuffer(),mt.bindBuffer(mt.ARRAY_BUFFER,ut.u),mt.enableVertexAttribArray(ut.l.N),mt.vertexAttribPointer(ut.l.N,2,mt.FLOAT,!1,0,0),mt.bufferData(mt.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),mt.STATIC_DRAW),mt.bindBuffer(mt.ARRAY_BUFFER,null),mt.uniform1i(zt,0)}At=ut.l,mt.useProgram(ut.s),mt.canvas.width=pt.width,mt.canvas.height=pt.height,mt.viewport(0,0,pt.width,pt.height),mt.activeTexture(mt.TEXTURE0),ut.i.bindTexture2d(pt.glName),mt.enableVertexAttribArray(At.O),mt.bindBuffer(mt.ARRAY_BUFFER,ut.v),mt.vertexAttribPointer(At.O,2,mt.FLOAT,!1,0,0),mt.enableVertexAttribArray(At.N),mt.bindBuffer(mt.ARRAY_BUFFER,ut.u),mt.vertexAttribPointer(At.N,2,mt.FLOAT,!1,0,0),mt.bindFramebuffer(mt.DRAW_FRAMEBUFFER?mt.DRAW_FRAMEBUFFER:mt.FRAMEBUFFER,null),mt.clearColor(0,0,0,0),mt.clear(mt.COLOR_BUFFER_BIT),mt.colorMask(!0,!0,!0,!0),mt.drawArrays(mt.TRIANGLE_FAN,0,4),mt.disableVertexAttribArray(At.O),mt.disableVertexAttribArray(At.N),mt.bindBuffer(mt.ARRAY_BUFFER,null),ut.i.bindTexture2d(0)}(D,U),typeof D.h.canvas.transferToImageBitmap=="function"?Promise.resolve(D.h.canvas.transferToImageBitmap()):et?Promise.resolve(D.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(D.h.canvas):(D.j===void 0&&(D.j=document.createElement("canvas")),new Promise(function(ut){D.j.height=D.h.canvas.height,D.j.width=D.h.canvas.width,D.j.getContext("2d",{}).drawImage(D.h.canvas,0,0,D.h.canvas.width,D.h.canvas.height),ut(D.j)}))}function Ba(D){this.h=D}Ou.prototype.l=Dn(Lu);var $s=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Oc(D,U){return U+D}function oc(D,U){window[D]=U}function sc(D){if(this.h=D,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=D&&D.locateFile||Oc,typeof window=="object")var U=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(typeof location>"u")throw Error("solutions can only be loaded on a web page or in a web worker");U=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.ha=U,D.options)for(var et=(U=J(Object.keys(D.options))).next();!et.done;et=U.next()){et=et.value;var ut=D.options[et].default;ut!==void 0&&(this.l[et]=typeof ut=="function"?ut():ut)}}function Lc(D){var U,et,ut,pt,mt,At,zt,pe,We,Ke,Tn;return Ft(function(nn){switch(nn.h){case 1:return D.ga?(U=D.h.files===void 0?[]:typeof D.h.files=="function"?D.h.files(D.l):D.h.files,Tt(nn,Ft(function(un){switch(un.h){case 1:return un.s=2,Tt(un,WebAssembly.instantiate($s),4);case 4:un.h=3,un.s=0;break;case 2:return un.s=0,un.l=null,un.return(!1);case 3:return un.return(!0)}}),2)):nn.return();case 2:if(et=nn.i,typeof window=="object")return oc("createMediapipeSolutionsWasm",{locateFile:D.locateFile}),oc("createMediapipeSolutionsPackedAssets",{locateFile:D.locateFile}),At=U.filter(function(un){return un.data!==void 0}),zt=U.filter(function(un){return un.data===void 0}),pe=Promise.all(At.map(function(un){var zn=Ju(D,un.url);if(un.path!==void 0){var In=un.path;zn=zn.then(function(Or){return D.overrideFile(In,Or),Promise.resolve(Or)})}return zn})),We=Promise.all(zt.map(function(un){return un.simd===void 0||un.simd&&et||!un.simd&&!et?function(zn){var In=document.createElement("script");return In.setAttribute("src",zn),In.setAttribute("crossorigin","anonymous"),new Promise(function(Or){In.addEventListener("load",function(){Or()},!1),In.addEventListener("error",function(){Or()},!1),document.body.appendChild(In)})}(D.locateFile(un.url,D.ha)):Promise.resolve()})).then(function(){var un,zn,In;return Ft(function(Or){if(Or.h==1)return un=window.createMediapipeSolutionsWasm,zn=window.createMediapipeSolutionsPackedAssets,In=D,Tt(Or,un(zn),2);In.i=Or.i,Or.h=0})}),Ke=Ft(function(un){return D.h.graph&&D.h.graph.url?un=Tt(un,Ju(D,D.h.graph.url),0):(un.h=0,un=void 0),un}),Tt(nn,Promise.all([We,pe,Ke]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return ut=U.filter(function(un){return un.simd===void 0||un.simd&&et||!un.simd&&!et}).map(function(un){return D.locateFile(un.url,D.ha)}),importScripts.apply(null,q(ut)),pt=D,Tt(nn,createMediapipeSolutionsWasm(Module),6);case 6:pt.i=nn.i,D.m=new OffscreenCanvas(1,1),D.i.canvas=D.m,mt=D.i.GL.createContext(D.m,{antialias:!1,alpha:!1,va:typeof WebGL2RenderingContext<"u"?2:1}),D.i.GL.makeContextCurrent(mt),nn.h=4;break;case 7:if(D.m=document.createElement("canvas"),!(Tn=D.m.getContext("webgl2",{}))&&!(Tn=D.m.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),nn.return();D.K=Tn,D.i.canvas=D.m,D.i.createContext(D.m,!0,!0,{});case 4:D.j=new D.i.SolutionWasm,D.ga=!1,nn.h=0}})}function Ju(D,U){var et,ut;return Ft(function(pt){return U in D.L?pt.return(D.L[U]):(et=D.locateFile(U,""),ut=fetch(et).then(function(mt){return mt.arrayBuffer()}),D.L[U]=ut,pt.return(ut))})}function ph(D,U,et){var ut,pt,mt,At,zt,pe,We,Ke,Tn,nn,un,zn,In,Or;return Ft(function(oi){switch(oi.h){case 1:if(!et)return oi.return(U);for(ut={},pt=0,mt=J(Object.keys(et)),At=mt.next();!At.done;At=mt.next())zt=At.value,typeof(pe=et[zt])!="string"&&pe.type==="texture"&&U[pe.stream]!==void 0&&++pt;1<pt&&(D.M=!1),We=J(Object.keys(et)),At=We.next();case 2:if(At.done){oi.h=4;break}if(Ke=At.value,typeof(Tn=et[Ke])=="string")return In=ut,Or=Ke,Tt(oi,function(zs,pi,cu){var Vl;return Ft(function(Al){return typeof cu=="number"||cu instanceof Uint8Array||cu instanceof zs.i.Uint8BlobList?Al.return(cu):cu instanceof zs.i.Texture2dDataOut?((Vl=zs.v[pi])||(Vl=new Wl(zs.i,zs.K),zs.v[pi]=Vl),Al.return(Yh(Vl,cu,zs.M))):Al.return(void 0)})}(D,Ke,U[Tn]),14);if(nn=U[Tn.stream],Tn.type==="detection_list"){if(nn){for(var ur=nn.getRectList(),Na=nn.getLandmarksList(),fi=nn.getClassificationsList(),Lr=[],wi=0;wi<ur.size();++wi){var cs=Ed(ur.get(wi)),Js=void 0;Js=Js===void 0?0:Js,cs={la:{sa:Ga(cs,1),ta:Ga(cs,2),height:Ga(cs,3),width:Ga(cs,4),rotation:Ga(cs,5,0),pa:Ko(na(cs,6),Js)},ea:Qu(Na.get(wi)),ba:ni(ku(fi.get(wi)))},Lr.push(cs)}ur=Lr}else ur=[];ut[Ke]=ur,oi.h=7;break}if(Tn.type==="proto_list"){if(nn){for(ur=Array(nn.size()),Na=0;Na<nn.size();Na++)ur[Na]=nn.get(Na);nn.delete()}else ur=[];ut[Ke]=ur,oi.h=7;break}if(nn===void 0){oi.h=3;break}if(Tn.type==="float_list"){ut[Ke]=nn,oi.h=7;break}if(Tn.type==="proto"){ut[Ke]=nn,oi.h=7;break}if(Tn.type!=="texture")throw Error("Unknown output config type: '"+Tn.type+"'");return(un=D.v[Ke])||(un=new Wl(D.i,D.K),D.v[Ke]=un),Tt(oi,Yh(un,nn,D.M),13);case 13:zn=oi.i,ut[Ke]=zn;case 7:Tn.transform&&ut[Ke]&&(ut[Ke]=Tn.transform(ut[Ke])),oi.h=3;break;case 14:In[Or]=oi.i;case 3:At=We.next(),oi.h=2;break;case 4:return oi.return(ut)}})}function $c(D,U){for(var et=U.name||"$",ut=[].concat(q(U.wants)),pt=new D.i.StringList,mt=J(U.wants),At=mt.next();!At.done;At=mt.next())pt.push_back(At.value);mt=D.i.PacketListener.implement({onResults:function(zt){for(var pe={},We=0;We<U.wants.length;++We)pe[ut[We]]=zt.get(We);var Ke=D.listeners[et];Ke&&(D.I=ph(D,pe,U.outs).then(function(Tn){Tn=Ke(Tn);for(var nn=0;nn<U.wants.length;++nn){var un=pe[ut[nn]];typeof un=="object"&&un.hasOwnProperty&&un.hasOwnProperty("delete")&&un.delete()}Tn&&(D.I=Tn)}))}}),D.j.attachMultiListener(pt,mt),pt.delete()}function uc(D){switch(D===void 0&&(D=0),D){case 1:return"pose_landmark_full.tflite";case 2:return"pose_landmark_heavy.tflite";default:return"pose_landmark_lite.tflite"}}function yt(D){var U=this;D=D||{},this.h=new sc({locateFile:D.locateFile,files:function(et){return[{url:"pose_solution_packed_assets_loader.js"},{simd:!1,url:"pose_solution_wasm_bin.js"},{simd:!0,url:"pose_solution_simd_wasm_bin.js"},{data:!0,url:uc(et.modelComplexity)}]},graph:{url:"pose_web.binarypb"},listeners:[{wants:["pose_landmarks","world_landmarks","segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:Qu},poseWorldLandmarks:{type:"proto",stream:"world_landmarks",transform:Qu},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window=="object"&&window.navigator!==void 0&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(et){var ut,pt,mt;return Ft(function(At){return At.h==1?(ut=uc(et),pt="third_party/mediapipe/modules/pose_landmark/"+ut,Tt(At,Ju(U.h,ut),2)):(mt=At.i,U.h.overrideFile(pt,mt),At.return(!0))})}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}}}})}(B=sc.prototype).close=function(){return this.j&&this.j.delete(),Promise.resolve()},B.reset=function(){var D=this;return Ft(function(U){D.j&&(D.j.reset(),D.s={},D.v={}),U.h=0})},B.setOptions=function(D,U){var et=this;if(U=U||this.h.options){for(var ut=[],pt=[],mt={},At=J(Object.keys(D)),zt=At.next();!zt.done;mt={X:mt.X,Y:mt.Y},zt=At.next())if(!((zt=zt.value)in this.l)||this.l[zt]!==D[zt]){this.l[zt]=D[zt];var pe=U[zt];pe!==void 0&&(pe.onChange&&(mt.X=pe.onChange,mt.Y=D[zt],ut.push(function(We){return function(){return Ft(function(Ke){if(Ke.h==1)return Tt(Ke,We.X(We.Y),2);Ke.i===!0&&(et.u=!0),Ke.h=0})}}(mt))),pe.graphOptionXref&&(zt=Object.assign({},{calculatorName:"",calculatorIndex:0},pe.graphOptionXref,{valueNumber:pe.type===1?D[zt]:0,valueBoolean:pe.type===0&&D[zt],valueString:pe.type===2?D[zt]:""}),pt.push(zt)))}ut.length===0&&pt.length===0||(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(pt),this.F=(this.F===void 0?[]:this.F).concat(ut))}},B.initialize=function(){var D=this;return Ft(function(U){return U.h==1?Tt(U,Lc(D),2):U.h!=3?Tt(U,function(et){var ut,pt,mt,At,zt,pe,We,Ke;return Ft(function(Tn){if(Tn.h==1)return et.h.graph&&et.h.graph.url&&et.fa===et.h.graph.url?Tn.return():(et.u=!0,et.h.graph&&et.h.graph.url?(et.fa=et.h.graph.url,Tt(Tn,Ju(et,et.h.graph.url),3)):void(Tn.h=2));for(Tn.h!=2&&(ut=Tn.i,et.j.loadGraph(ut)),pt=J(Object.keys(et.D)),mt=pt.next();!mt.done;mt=pt.next())At=mt.value,et.j.overrideFile(At,et.D[At]);if(et.D={},et.h.listeners)for(zt=J(et.h.listeners),pe=zt.next();!pe.done;pe=zt.next())We=pe.value,$c(et,We);Ke=et.l,et.l={},et.setOptions(Ke),Tn.h=0})}(D),3):Tt(U,function(et){var ut,pt,mt,At,zt,pe;return Ft(function(We){switch(We.h){case 1:if(!et.u)return We.return();if(!et.F){We.h=2;break}ut=J(et.F),pt=ut.next();case 3:if(pt.done){We.h=5;break}return Tt(We,(0,pt.value)(),4);case 4:pt=ut.next(),We.h=3;break;case 5:et.F=void 0;case 2:if(et.H){for(mt=new et.i.GraphOptionChangeRequestList,At=J(et.H),zt=At.next();!zt.done;zt=At.next())pe=zt.value,mt.push_back(pe);et.j.changeOptions(mt),mt.delete(),et.H=void 0}et.u=!1,We.h=0}})}(D),0)})},B.overrideFile=function(D,U){this.j?this.j.overrideFile(D,U):this.D[D]=U},B.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},B.send=function(D,U){var et,ut,pt,mt,At,zt,pe,We,Ke,Tn=this;return Ft(function(nn){switch(nn.h){case 1:return Tn.h.inputs?(et=1e3*(U??performance.now()),Tt(nn,Tn.I,2)):nn.return();case 2:return Tt(nn,Tn.initialize(),3);case 3:for(ut=new Tn.i.PacketDataList,pt=J(Object.keys(D)),mt=pt.next();!mt.done;mt=pt.next())if(At=mt.value,zt=Tn.h.inputs[At]){t:{var un=D[At];switch(zt.type){case"video":var zn=Tn.s[zt.stream];if(zn||(zn=new Wl(Tn.i,Tn.K),Tn.s[zt.stream]=zn),zn.m===0&&(zn.m=zn.i.createTexture()),typeof HTMLVideoElement<"u"&&un instanceof HTMLVideoElement)var In=un.videoWidth,Or=un.videoHeight;else typeof HTMLImageElement<"u"&&un instanceof HTMLImageElement?(In=un.naturalWidth,Or=un.naturalHeight):(In=un.width,Or=un.height);Or={glName:zn.m,width:In,height:Or},(In=zn.h).canvas.width=Or.width,In.canvas.height=Or.height,In.activeTexture(In.TEXTURE0),zn.i.bindTexture2d(zn.m),In.texImage2D(In.TEXTURE_2D,0,In.RGBA,In.RGBA,In.UNSIGNED_BYTE,un),zn.i.bindTexture2d(0),zn=Or;break t;case"detections":for((zn=Tn.s[zt.stream])||(zn=new Ba(Tn.i),Tn.s[zt.stream]=zn),zn.data||(zn.data=new zn.h.DetectionListData),zn.data.reset(un.length),Or=0;Or<un.length;++Or){In=un[Or];var oi=zn.data,ur=oi.setBoundingBox,Na=Or,fi=In.la,Lr=new Ou;if(Ra(Lr,1,fi.sa),Ra(Lr,2,fi.ta),Ra(Lr,3,fi.height),Ra(Lr,4,fi.width),Ra(Lr,5,fi.rotation),va(Lr,6,fi.pa),fi=Lr.l(),ur.call(oi,Na,fi),In.ea)for(oi=0;oi<In.ea.length;++oi){Lr=In.ea[oi],Na=(ur=zn.data).addNormalizedLandmark,fi=Or,Lr=Object.assign({},Lr,{visibility:Lr.visibility?Lr.visibility:0});var wi=new io;Ra(wi,1,Lr.x),Ra(wi,2,Lr.y),Ra(wi,3,Lr.z),Lr.visibility&&Ra(wi,4,Lr.visibility),Lr=wi.l(),Na.call(ur,fi,Lr)}if(In.ba)for(oi=0;oi<In.ba.length;++oi)Na=(ur=zn.data).addClassification,fi=Or,Lr=In.ba[oi],Ra(wi=new Ui,2,Lr.qa),Lr.index&&va(wi,1,Lr.index),Lr.label&&va(wi,3,Lr.label),Lr.displayName&&va(wi,4,Lr.displayName),Lr=wi.l(),Na.call(ur,fi,Lr)}zn=zn.data;break t;default:zn={}}}switch(pe=zn,We=zt.stream,zt.type){case"video":ut.pushTexture2d(Object.assign({},pe,{stream:We,timestamp:et}));break;case"detections":(Ke=pe).stream=We,Ke.timestamp=et,ut.pushDetectionList(Ke);break;default:throw Error("Unknown input config type: '"+zt.type+"'")}}return Tn.j.send(ut),Tt(nn,Tn.I,4);case 4:ut.delete(),nn.h=0}})},B.onResults=function(D,U){this.listeners[U||"$"]=D},ge("Solution",sc),ge("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(B=yt.prototype).reset=function(){this.h.reset()},B.close=function(){return this.h.close(),Promise.resolve()},B.onResults=function(D){this.h.onResults(D)},B.initialize=function(){var D=this;return Ft(function(U){return Tt(U,D.h.initialize(),0)})},B.send=function(D,U){var et=this;return Ft(function(ut){return Tt(ut,et.h.send(D,U),0)})},B.setOptions=function(D){this.h.setOptions(D)},ge("Pose",yt),ge("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),ge("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),ge("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),ge("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),ge("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),ge("VERSION","0.5.1675469404")}).call(this)},9958:function(L,O,S){(function(){var B;function j(yt){var D=0;return function(){return D<yt.length?{done:!1,value:yt[D++]}:{done:!0}}}var K=typeof Object.defineProperties=="function"?Object.defineProperty:function(yt,D,U){return yt==Array.prototype||yt==Object.prototype||(yt[D]=U.value),yt},Z=function(yt){yt=[typeof globalThis=="object"&&globalThis,yt,typeof window=="object"&&window,typeof self=="object"&&self,typeof S.g=="object"&&S.g];for(var D=0;D<yt.length;++D){var U=yt[D];if(U&&U.Math==Math)return U}throw Error("Cannot find global object")}(this);function Y(yt,D){if(D)t:{var U=Z;yt=yt.split(".");for(var et=0;et<yt.length-1;et++){var ut=yt[et];if(!(ut in U))break t;U=U[ut]}(D=D(et=U[yt=yt[yt.length-1]]))!=et&&D!=null&&K(U,yt,{configurable:!0,writable:!0,value:D})}}function X(yt){return(yt={next:yt})[Symbol.iterator]=function(){return this},yt}function J(yt){var D=typeof Symbol<"u"&&Symbol.iterator&&yt[Symbol.iterator];return D?D.call(yt):{next:j(yt)}}function q(yt){if(!(yt instanceof Array)){yt=J(yt);for(var D,U=[];!(D=yt.next()).done;)U.push(D.value);yt=U}return yt}Y("Symbol",function(yt){function D(ut,pt){this.h=ut,K(this,"description",{configurable:!0,writable:!0,value:pt})}if(yt)return yt;D.prototype.toString=function(){return this.h};var U="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",et=0;return function ut(pt){if(this instanceof ut)throw new TypeError("Symbol is not a constructor");return new D(U+(pt||"")+"_"+et++,pt)}}),Y("Symbol.iterator",function(yt){if(yt)return yt;yt=Symbol("Symbol.iterator");for(var D="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),U=0;U<D.length;U++){var et=Z[D[U]];typeof et=="function"&&typeof et.prototype[yt]!="function"&&K(et.prototype,yt,{configurable:!0,writable:!0,value:function(){return X(j(this))}})}return yt});var H=typeof Object.assign=="function"?Object.assign:function(yt,D){for(var U=1;U<arguments.length;U++){var et=arguments[U];if(et)for(var ut in et)Object.prototype.hasOwnProperty.call(et,ut)&&(yt[ut]=et[ut])}return yt};Y("Object.assign",function(yt){return yt||H});var tt,st=typeof Object.create=="function"?Object.create:function(yt){function D(){}return D.prototype=yt,new D};if(typeof Object.setPrototypeOf=="function")tt=Object.setPrototypeOf;else{var lt;t:{var ft={};try{ft.__proto__={a:!0},lt=ft.a;break t}catch{}lt=!1}tt=lt?function(yt,D){if(yt.__proto__=D,yt.__proto__!==D)throw new TypeError(yt+" is not extensible");return yt}:null}var gt=tt;function xt(yt,D){if(yt.prototype=st(D.prototype),yt.prototype.constructor=yt,gt)gt(yt,D);else for(var U in D)if(U!="prototype")if(Object.defineProperties){var et=Object.getOwnPropertyDescriptor(D,U);et&&Object.defineProperty(yt,U,et)}else yt[U]=D[U];yt.za=D.prototype}function wt(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function _t(yt){if(yt.m)throw new TypeError("Generator is already running");yt.m=!0}function bt(yt,D){yt.l={ma:D,na:!0},yt.h=yt.s||yt.v}function Tt(yt,D,U){return yt.h=U,{value:D}}function qt(yt){this.h=new wt,this.i=yt}function It(yt,D,U,et){try{var ut=D.call(yt.h.j,U);if(!(ut instanceof Object))throw new TypeError("Iterator result "+ut+" is not an object");if(!ut.done)return yt.h.m=!1,ut;var pt=ut.value}catch(mt){return yt.h.j=null,bt(yt.h,mt),St(yt)}return yt.h.j=null,et.call(yt.h,pt),St(yt)}function St(yt){for(;yt.h.h;)try{var D=yt.i(yt.h);if(D)return yt.h.m=!1,{value:D.value,done:!1}}catch(U){yt.h.i=void 0,bt(yt.h,U)}if(yt.h.m=!1,yt.h.l){if(D=yt.h.l,yt.h.l=null,D.na)throw D.ma;return{value:D.return,done:!0}}return{value:void 0,done:!0}}function vt(yt){this.next=function(D){return _t(yt.h),yt.h.j?D=It(yt,yt.h.j.next,D,yt.h.u):(yt.h.u(D),D=St(yt)),D},this.throw=function(D){return _t(yt.h),yt.h.j?D=It(yt,yt.h.j.throw,D,yt.h.u):(bt(yt.h,D),D=St(yt)),D},this.return=function(D){return function(U,et){_t(U.h);var ut=U.h.j;return ut?It(U,"return"in ut?ut.return:function(pt){return{value:pt,done:!0}},et,U.h.return):(U.h.return(et),St(U))}(yt,D)},this[Symbol.iterator]=function(){return this}}function Ft(yt){return function(D){function U(ut){return D.next(ut)}function et(ut){return D.throw(ut)}return new Promise(function(ut,pt){(function mt(At){At.done?ut(At.value):Promise.resolve(At.value).then(U,et).then(mt,pt)})(D.next())})}(new vt(new qt(yt)))}function Qt(yt){return yt||Array.prototype.fill}wt.prototype.u=function(yt){this.i=yt},wt.prototype.return=function(yt){this.l={return:yt},this.h=this.v},Y("Promise",function(yt){function D(mt){this.i=0,this.j=void 0,this.h=[],this.u=!1;var At=this.l();try{mt(At.resolve,At.reject)}catch(zt){At.reject(zt)}}function U(){this.h=null}function et(mt){return mt instanceof D?mt:new D(function(At){At(mt)})}if(yt)return yt;U.prototype.i=function(mt){if(this.h==null){this.h=[];var At=this;this.j(function(){At.m()})}this.h.push(mt)};var ut=Z.setTimeout;U.prototype.j=function(mt){ut(mt,0)},U.prototype.m=function(){for(;this.h&&this.h.length;){var mt=this.h;this.h=[];for(var At=0;At<mt.length;++At){var zt=mt[At];mt[At]=null;try{zt()}catch(pe){this.l(pe)}}}this.h=null},U.prototype.l=function(mt){this.j(function(){throw mt})},D.prototype.l=function(){function mt(pe){return function(We){zt||(zt=!0,pe.call(At,We))}}var At=this,zt=!1;return{resolve:mt(this.I),reject:mt(this.m)}},D.prototype.I=function(mt){if(mt===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(mt instanceof D)this.L(mt);else{t:switch(typeof mt){case"object":var At=mt!=null;break t;case"function":At=!0;break t;default:At=!1}At?this.F(mt):this.s(mt)}},D.prototype.F=function(mt){var At=void 0;try{At=mt.then}catch(zt){return void this.m(zt)}typeof At=="function"?this.M(At,mt):this.s(mt)},D.prototype.m=function(mt){this.v(2,mt)},D.prototype.s=function(mt){this.v(1,mt)},D.prototype.v=function(mt,At){if(this.i!=0)throw Error("Cannot settle("+mt+", "+At+"): Promise already settled in state"+this.i);this.i=mt,this.j=At,this.i===2&&this.K(),this.H()},D.prototype.K=function(){var mt=this;ut(function(){if(mt.D()){var At=Z.console;At!==void 0&&At.error(mt.j)}},1)},D.prototype.D=function(){if(this.u)return!1;var mt=Z.CustomEvent,At=Z.Event,zt=Z.dispatchEvent;return zt===void 0||(typeof mt=="function"?mt=new mt("unhandledrejection",{cancelable:!0}):typeof At=="function"?mt=new At("unhandledrejection",{cancelable:!0}):(mt=Z.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,mt),mt.promise=this,mt.reason=this.j,zt(mt))},D.prototype.H=function(){if(this.h!=null){for(var mt=0;mt<this.h.length;++mt)pt.i(this.h[mt]);this.h=null}};var pt=new U;return D.prototype.L=function(mt){var At=this.l();mt.T(At.resolve,At.reject)},D.prototype.M=function(mt,At){var zt=this.l();try{mt.call(At,zt.resolve,zt.reject)}catch(pe){zt.reject(pe)}},D.prototype.then=function(mt,At){function zt(Tn,nn){return typeof Tn=="function"?function(un){try{pe(Tn(un))}catch(zn){We(zn)}}:nn}var pe,We,Ke=new D(function(Tn,nn){pe=Tn,We=nn});return this.T(zt(mt,pe),zt(At,We)),Ke},D.prototype.catch=function(mt){return this.then(void 0,mt)},D.prototype.T=function(mt,At){function zt(){switch(pe.i){case 1:mt(pe.j);break;case 2:At(pe.j);break;default:throw Error("Unexpected state: "+pe.i)}}var pe=this;this.h==null?pt.i(zt):this.h.push(zt),this.u=!0},D.resolve=et,D.reject=function(mt){return new D(function(At,zt){zt(mt)})},D.race=function(mt){return new D(function(At,zt){for(var pe=J(mt),We=pe.next();!We.done;We=pe.next())et(We.value).T(At,zt)})},D.all=function(mt){var At=J(mt),zt=At.next();return zt.done?et([]):new D(function(pe,We){function Ke(un){return function(zn){Tn[un]=zn,--nn==0&&pe(Tn)}}var Tn=[],nn=0;do Tn.push(void 0),nn++,et(zt.value).T(Ke(Tn.length-1),We),zt=At.next();while(!zt.done)})},D}),Y("Array.prototype.keys",function(yt){return yt||function(){return function(D,U){D instanceof String&&(D+="");var et=0,ut=!1,pt={next:function(){if(!ut&&et<D.length){var mt=et++;return{value:U(mt,D[mt]),done:!1}}return ut=!0,{done:!0,value:void 0}}};return pt[Symbol.iterator]=function(){return pt},pt}(this,function(D){return D})}}),Y("Array.prototype.fill",function(yt){return yt||function(D,U,et){var ut=this.length||0;for(0>U&&(U=Math.max(0,ut+U)),(et==null||et>ut)&&(et=ut),0>(et=Number(et))&&(et=Math.max(0,ut+et)),U=Number(U||0);U<et;U++)this[U]=D;return this}}),Y("Int8Array.prototype.fill",Qt),Y("Uint8Array.prototype.fill",Qt),Y("Uint8ClampedArray.prototype.fill",Qt),Y("Int16Array.prototype.fill",Qt),Y("Uint16Array.prototype.fill",Qt),Y("Int32Array.prototype.fill",Qt),Y("Uint32Array.prototype.fill",Qt),Y("Float32Array.prototype.fill",Qt),Y("Float64Array.prototype.fill",Qt),Y("Object.is",function(yt){return yt||function(D,U){return D===U?D!==0||1/D==1/U:D!=D&&U!=U}}),Y("Array.prototype.includes",function(yt){return yt||function(D,U){var et=this;et instanceof String&&(et=String(et));var ut=et.length;for(0>(U=U||0)&&(U=Math.max(U+ut,0));U<ut;U++){var pt=et[U];if(pt===D||Object.is(pt,D))return!0}return!1}}),Y("String.prototype.includes",function(yt){return yt||function(D,U){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(D instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(D,U||0)!==-1}});var Gt=this||self;function ge(yt,D){yt=yt.split(".");var U,et=Gt;for((yt[0]in et)||et.execScript===void 0||et.execScript("var "+yt[0]);yt.length&&(U=yt.shift());)yt.length||D===void 0?et=et[U]&&et[U]!==Object.prototype[U]?et[U]:et[U]={}:et[U]=D}function ee(yt){var D;return(D=Gt.navigator)&&(D=D.userAgent)||(D=""),D.indexOf(yt)!=-1}var Ee=Array.prototype.map?function(yt,D){return Array.prototype.map.call(yt,D,void 0)}:function(yt,D){for(var U=yt.length,et=Array(U),ut=typeof yt=="string"?yt.split(""):yt,pt=0;pt<U;pt++)pt in ut&&(et[pt]=D.call(void 0,ut[pt],pt,yt));return et},Bt={},Xt=null;function we(yt){var D=yt.length,U=3*D/4;U%3?U=Math.floor(U):"=.".indexOf(yt[D-1])!=-1&&(U="=.".indexOf(yt[D-2])!=-1?U-2:U-1);var et=new Uint8Array(U),ut=0;return function(pt,mt){function At(nn){for(;zt<pt.length;){var un=pt.charAt(zt++),zn=Xt[un];if(zn!=null)return zn;if(!/^[\s\xa0]*$/.test(un))throw Error("Unknown base64 encoding at char: "+un)}return nn}ie();for(var zt=0;;){var pe=At(-1),We=At(0),Ke=At(64),Tn=At(64);if(Tn===64&&pe===-1)break;mt(pe<<2|We>>4),Ke!=64&&(mt(We<<4&240|Ke>>2),Tn!=64&&mt(Ke<<6&192|Tn))}}(yt,function(pt){et[ut++]=pt}),ut!==U?et.subarray(0,ut):et}function ie(){if(!Xt){Xt={};for(var yt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),D=["+/=","+/","-_=","-_.","-_"],U=0;5>U;U++){var et=yt.concat(D[U].split(""));Bt[U]=et;for(var ut=0;ut<et.length;ut++){var pt=et[ut];Xt[pt]===void 0&&(Xt[pt]=ut)}}}}var m=typeof Uint8Array<"u",ye=!(ee("Trident")||ee("MSIE"))&&typeof Gt.btoa=="function";function Ge(yt){if(!ye){var D;D===void 0&&(D=0),ie(),D=Bt[D];for(var U=Array(Math.floor(yt.length/3)),et=D[64]||"",ut=0,pt=0;ut<yt.length-2;ut+=3){var mt=yt[ut],At=yt[ut+1],zt=yt[ut+2],pe=D[mt>>2];mt=D[(3&mt)<<4|At>>4],At=D[(15&At)<<2|zt>>6],zt=D[63&zt],U[pt++]=pe+mt+At+zt}switch(pe=0,zt=et,yt.length-ut){case 2:zt=D[(15&(pe=yt[ut+1]))<<2]||et;case 1:yt=yt[ut],U[pt]=D[yt>>2]+D[(3&yt)<<4|pe>>4]+zt+et}return U.join("")}for(D="";10240<yt.length;)D+=String.fromCharCode.apply(null,yt.subarray(0,10240)),yt=yt.subarray(10240);return D+=String.fromCharCode.apply(null,yt),btoa(D)}var te,Me=RegExp("[-_.]","g");function Ye(yt){switch(yt){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function Ue(yt){if(!ye)return we(yt);Me.test(yt)&&(yt=yt.replace(Me,Ye)),yt=atob(yt);for(var D=new Uint8Array(yt.length),U=0;U<yt.length;U++)D[U]=yt.charCodeAt(U);return D}function kn(){return te||(te=new Uint8Array(0))}var mn={},Kn=typeof Uint8Array.prototype.slice=="function",Sn=0,Wn=0;function Ze(yt){var D=0>yt,U=(yt=Math.abs(yt))>>>0;yt=Math.floor((yt-U)/4294967296),D&&(D=(U=J(Kt(U,yt))).next().value,yt=U.next().value,U=D),Sn=U>>>0,Wn=yt>>>0}var de,Re=typeof BigInt=="function";function Kt(yt,D){return D=~D,yt?yt=1+~yt:D+=1,[yt,D]}function Jt(yt,D){this.i=yt>>>0,this.h=D>>>0}function Ae(yt){if(!yt)return de||(de=new Jt(0,0));if(!/^-?\d+$/.test(yt))return null;if(16>yt.length)Ze(Number(yt));else if(Re)yt=BigInt(yt),Sn=Number(yt&BigInt(4294967295))>>>0,Wn=Number(yt>>BigInt(32)&BigInt(4294967295));else{var D=+(yt[0]==="-");Wn=Sn=0;for(var U=yt.length,et=D,ut=(U-D)%6+D;ut<=U;et=ut,ut+=6)et=Number(yt.slice(et,ut)),Wn*=1e6,4294967296<=(Sn=1e6*Sn+et)&&(Wn+=Sn/4294967296|0,Sn%=4294967296);D&&(yt=(D=J(Kt(Sn,Wn))).next().value,D=D.next().value,Sn=yt,Wn=D)}return new Jt(Sn,Wn)}function $e(yt,D){return Error("Invalid wire type: "+yt+" (at position "+D+")")}function tn(){return Error("Failed to read varint, encoding is invalid.")}function wn(yt,D){return Error("Tried to read past the end of the data "+D+" > "+yt)}function Mn(){throw Error("Invalid UTF8")}function Hn(yt,D){return D=String.fromCharCode.apply(null,D),yt==null?D:yt+D}var Zn,_r,Sr,Mr=void 0,ai=typeof TextDecoder<"u",ea=typeof TextEncoder<"u";function Pi(yt){if(yt!==mn)throw Error("illegal external caller")}function Cr(yt,D){if(Pi(D),this.V=yt,yt!=null&&yt.length===0)throw Error("ByteString should be constructed with non-empty values")}function Ti(){return Sr||(Sr=new Cr(null,mn))}function Be(yt){Pi(mn);var D=yt.V;return(D=D==null||m&&D!=null&&D instanceof Uint8Array?D:typeof D=="string"?Ue(D):null)==null?D:yt.V=D}function En(yt,D){this.i=null,this.m=!1,this.h=this.j=this.l=0,lr(this,yt,D)}function lr(yt,D,U){U=U===void 0?{}:U,yt.S=U.S!==void 0&&U.S,D&&(D=function(et){if(typeof et=="string")return{buffer:Ue(et),C:!1};if(Array.isArray(et))return{buffer:new Uint8Array(et),C:!1};if(et.constructor===Uint8Array)return{buffer:et,C:!1};if(et.constructor===ArrayBuffer)return{buffer:new Uint8Array(et),C:!1};if(et.constructor===Cr)return{buffer:Be(et)||kn(),C:!0};if(et instanceof Uint8Array)return{buffer:new Uint8Array(et.buffer,et.byteOffset,et.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}(D),yt.i=D.buffer,yt.m=D.C,yt.l=0,yt.j=yt.i.length,yt.h=yt.l)}function qn(yt,D){if(yt.h=D,D>yt.j)throw wn(yt.j,D)}function fr(yt){var D=yt.i,U=yt.h,et=D[U++],ut=127&et;if(128&et&&(ut|=(127&(et=D[U++]))<<7,128&et&&(ut|=(127&(et=D[U++]))<<14,128&et&&(ut|=(127&(et=D[U++]))<<21,128&et&&(ut|=(et=D[U++])<<28,128&et&&128&D[U++]&&128&D[U++]&&128&D[U++]&&128&D[U++]&&128&D[U++])))))throw tn();return qn(yt,U),ut}function Er(yt,D){if(0>D)throw Error("Tried to read a negative byte length: "+D);var U=yt.h,et=U+D;if(et>yt.j)throw wn(D,yt.j-U);return yt.h=et,U}En.prototype.reset=function(){this.h=this.l};var Qr=[];function vi(){this.h=[]}function ua(yt,D,U){for(;0<U||127<D;)yt.h.push(127&D|128),D=(D>>>7|U<<25)>>>0,U>>>=7;yt.h.push(D)}function br(yt,D){for(;127<D;)yt.h.push(127&D|128),D>>>=7;yt.h.push(D)}function eo(yt,D){if(Qr.length){var U=Qr.pop();lr(U,yt,D),yt=U}else yt=new En(yt,D);this.h=yt,this.j=this.h.h,this.i=this.l=-1,this.setOptions(D)}function Fo(yt){var D=yt.h;if(D.h==D.j)return!1;yt.j=yt.h.h;var U=fr(yt.h)>>>0;if(D=U>>>3,!(0<=(U&=7)&&5>=U))throw $e(U,yt.j);if(1>D)throw Error("Invalid field number: "+D+" (at position "+yt.j+")");return yt.l=D,yt.i=U,!0}function Wa(yt){switch(yt.i){case 0:if(yt.i!=0)Wa(yt);else t:{for(var D=(yt=yt.h).h,U=D+10,et=yt.i;D<U;)if(!(128&et[D++])){qn(yt,D);break t}throw tn()}break;case 1:qn(yt=yt.h,yt.h+8);break;case 2:yt.i!=2?Wa(yt):(D=fr(yt.h)>>>0,qn(yt=yt.h,yt.h+D));break;case 5:qn(yt=yt.h,yt.h+4);break;case 3:for(D=yt.l;;){if(!Fo(yt))throw Error("Unmatched start-group tag: stream EOF");if(yt.i==4){if(yt.l!=D)throw Error("Unmatched end-group tag");break}Wa(yt)}break;default:throw $e(yt.i,yt.j)}}vi.prototype.length=function(){return this.h.length},vi.prototype.end=function(){var yt=this.h;return this.h=[],yt},eo.prototype.setOptions=function(yt){yt=yt===void 0?{}:yt,this.ca=yt.ca!==void 0&&yt.ca},eo.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};var Le=[];function bn(){this.j=[],this.i=0,this.h=new vi}function jn(yt,D){D.length!==0&&(yt.j.push(D),yt.i+=D.length)}var Jn=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function dr(yt,D){return Jn?yt[Jn]|=D:yt.A!==void 0?yt.A|=D:(Object.defineProperties(yt,{A:{value:D,configurable:!0,writable:!0,enumerable:!1}}),D)}function Ur(yt,D){Jn?yt[Jn]&&(yt[Jn]&=~D):yt.A!==void 0&&(yt.A&=~D)}function or(yt){var D;return(D=Jn?yt[Jn]:yt.A)==null?0:D}function Yn(yt,D){Jn?yt[Jn]=D:yt.A!==void 0?yt.A=D:Object.defineProperties(yt,{A:{value:D,configurable:!0,writable:!0,enumerable:!1}})}function li(yt){return dr(yt,1),yt}function Ki(yt,D){Yn(D,-51&yt)}function Si(yt,D){Yn(D,-41&yt|18)}var Da={};function _i(yt){return yt!==null&&typeof yt=="object"&&!Array.isArray(yt)&&yt.constructor===Object}var la,so,ys=[];function vs(yt){if(2&or(yt.o))throw Error("Cannot mutate an immutable Message")}function qo(yt){var D=yt.length;(D=D?yt[D-1]:void 0)&&_i(D)?D.g=1:(D={},yt.push((D.g=1,D)))}function bs(yt){var D=yt.i+yt.G;return yt.B||(yt.B=yt.o[D]={})}function na(yt,D){return D===-1?null:D>=yt.i?yt.B?yt.B[D]:void 0:yt.o[D+yt.G]}function va(yt,D,U,et){vs(yt),Ya(yt,D,U,et)}function Ya(yt,D,U,et){yt.j&&(yt.j=void 0),D>=yt.i||et?bs(yt)[D]=U:(yt.o[D+yt.G]=U,(yt=yt.B)&&D in yt&&delete yt[D])}function Xo(yt,D,U,et){var ut=na(yt,D);Array.isArray(ut)||(ut=la);var pt=or(ut);if(1&pt||li(ut),et)2&pt||dr(ut,2),1&U||Object.freeze(ut);else{et=!(2&U);var mt=2&pt;1&U||!mt?et&&16&pt&&!mt&&Ur(ut,16):Ya(yt,D,ut=li(Array.prototype.slice.call(ut)))}return ut}function Du(yt,D){var U=na(yt,D),et=U==null?U:typeof U=="number"||U==="NaN"||U==="Infinity"||U==="-Infinity"?Number(U):void 0;return et!=null&&et!==U&&Ya(yt,D,et),et}function uu(yt,D,U,et,ut){yt.h||(yt.h={});var pt=yt.h[U],mt=Xo(yt,U,3,ut);if(!pt){var At=mt;pt=[];var zt=!!(16&or(yt.o));mt=!!(2&or(At));var pe=At;!ut&&mt&&(At=Array.prototype.slice.call(At));for(var We=mt,Ke=0;Ke<At.length;Ke++){var Tn=At[Ke],nn=D,un=!1;if(un=un!==void 0&&un,(Tn=Array.isArray(Tn)?new nn(Tn):un?new nn:void 0)!==void 0){var zn=un=or(nn=Tn.o);mt&&(zn|=2),zt&&(zn|=16),zn!=un&&Yn(nn,zn),nn=zn,We=We||!!(2&nn),pt.push(Tn)}}return yt.h[U]=pt,D=33|(zt=or(At)),zt!=(D=We?-9&D:8|D)&&(We=At,Object.isFrozen(We)&&(We=Array.prototype.slice.call(We)),Yn(We,D),At=We),pe!==At&&Ya(yt,U,At),(ut||et&&mt)&&dr(pt,2),et&&Object.freeze(pt),pt}return ut||(ut=Object.isFrozen(pt),et&&!ut?Object.freeze(pt):!et&&ut&&(pt=Array.prototype.slice.call(pt),yt.h[U]=pt)),pt}function ws(yt,D,U){var et=!!(2&or(yt.o));if(D=uu(yt,D,U,et,et),yt=Xo(yt,U,3,et),!(et||8&or(yt))){for(et=0;et<D.length;et++){if(2&or((U=D[et]).o)){var ut=Zo(U,!1);ut.j=U}else ut=U;U!==ut&&(D[et]=ut,yt[et]=ut.o)}dr(yt,8)}return D}function Ra(yt,D,U){if(U!=null&&typeof U!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof U+": "+U);va(yt,D,U)}function Ru(yt,D,U,et,ut){vs(yt);var pt=uu(yt,U,D,!1,!1);return U=et??new U,yt=Xo(yt,D,2,!1),ut!=null?(pt.splice(ut,0,U),yt.splice(ut,0,U.o)):(pt.push(U),yt.push(U.o)),U.C()&&Ur(yt,8),U}function Ko(yt,D){return yt??D}function Ga(yt,D,U){return U=U===void 0?0:U,Ko(Du(yt,D),U)}function Fu(yt,D,U,et){if(yt!=null){if(Array.isArray(yt))yt=Zs(yt,D,U,et!==void 0);else if(_i(yt)){var ut,pt={};for(ut in yt)pt[ut]=Fu(yt[ut],D,U,et);yt=pt}else yt=D(yt,et);return yt}}function Zs(yt,D,U,et){var ut=or(yt);et=et?!!(16&ut):void 0,yt=Array.prototype.slice.call(yt);for(var pt=0;pt<yt.length;pt++)yt[pt]=Fu(yt[pt],D,U,et);return U(ut,yt),yt}function Rc(yt){return yt.ja===Da?yt.toJSON():function(D){switch(typeof D){case"number":return isFinite(D)?D:String(D);case"object":if(D)if(Array.isArray(D)){if(128&or(D))return qo(D=Array.prototype.slice.call(D)),D}else{if(m&&D!=null&&D instanceof Uint8Array)return Ge(D);if(D instanceof Cr){var U=D.V;return U==null?"":typeof U=="string"?U:D.V=Ge(U)}}}return D}(yt)}function bu(yt,D){128&yt&&qo(D)}function Qs(yt,D,U){if(U=U===void 0?Si:U,yt!=null){if(m&&yt instanceof Uint8Array)return yt.length?new Cr(new Uint8Array(yt),mn):Ti();if(Array.isArray(yt)){var et=or(yt);return 2&et?yt:!D||32&et||!(16&et||et===0)?(4&(D=or(yt=Zs(yt,Qs,4&et?Si:U,!0)))&&2&D&&Object.freeze(yt),yt):(Yn(yt,2|et),yt)}return yt.ja===Da?Tl(yt):yt}}function wu(yt,D,U,et,ut,pt,mt){if(yt=yt.h&&yt.h[U]){if(2&(et=or(yt))?et=yt:(Si(et,pt=Ee(yt,Tl)),Object.freeze(pt),et=pt),vs(D),mt=et==null?la:li([]),et!=null){for(pt=!!et.length,yt=0;yt<et.length;yt++){var At=et[yt];pt=pt&&!(2&or(At.o)),mt[yt]=At.o}pt=1|(pt?8:0),((yt=or(mt))&pt)!==pt&&(Object.isFrozen(mt)&&(mt=Array.prototype.slice.call(mt)),Yn(mt,yt|pt)),D.h||(D.h={}),D.h[U]=et}else D.h&&(D.h[U]=void 0);Ya(D,U,mt,ut)}else va(D,U,Qs(et,pt,mt),ut)}function Tl(yt){return 2&or(yt.o)||dr((yt=Zo(yt,!0)).o,2),yt}function Zo(yt,D){var U=yt.o,et=[];dr(et,16);var ut=yt.constructor.h;if(ut&&et.push(ut),ut=yt.B){et.length=U.length,et.fill(void 0,et.length,U.length);var pt={};et[et.length-1]=pt}128&or(U)&&qo(et),D=D||yt.C()?Si:Ki,pt=yt.constructor,so=et,et=new pt(et),so=void 0,yt.R&&(et.R=yt.R.slice()),pt=!!(16&or(U));for(var mt=ut?U.length-1:U.length,At=0;At<mt;At++)wu(yt,et,At-yt.G,U[At],!1,pt,D);if(ut)for(var zt in ut)wu(yt,et,+zt,ut[zt],!0,pt,D);return et}function ji(yt,D,U){yt==null&&(yt=so),so=void 0;var et,ut=this.constructor.i||0,pt=0<ut,mt=this.constructor.h,At=!1;if(yt==null){var zt=48,pe=!0;pt&&(ut=0,zt|=128),Yn(yt=mt?[mt]:[],zt)}else{if(!Array.isArray(yt)||mt&&mt!==yt[0])throw Error();var We=zt=dr(yt,0);if((pe=!!(16&We))&&((At=!!(32&We))||(We|=32)),pt){if(128&We)ut=0;else if(0<yt.length){var Ke=yt[yt.length-1];if(_i(Ke)&&"g"in Ke){ut=0,We|=128,delete Ke.g;var Tn,nn=!0;for(Tn in Ke){nn=!1;break}nn&&yt.pop()}}}else if(128&We)throw Error();zt!==We&&Yn(yt,We)}if(this.G=(mt?0:-1)-ut,this.h=void 0,this.o=yt,ut=(mt=this.o.length)-1,mt&&_i(mt=this.o[ut])?(this.B=mt,this.i=ut-this.G):D!==void 0&&-1<D?(this.i=Math.max(D,ut+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE,!pt&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(U)for(D=pe&&!At&&!0,pt=this.i,pe=0;pe<U.length;pe++)(At=U[pe])<pt?(ut=yt[At+=this.G])?Ku(ut,D):yt[At]=la:(et||(et=bs(this)),(ut=et[At])?Ku(ut,D):et[At]=la)}function Ku(yt,D){if(Array.isArray(yt)){var U=or(yt),et=1;!D||2&U||(et|=16),(U&et)!==et&&Yn(yt,U|et)}}function Zu(yt,D,U){if(U){var et,ut={};for(et in U){var pt=U[et],mt=pt.ra;mt||(ut.J=pt.xa||pt.oa.W,pt.ia?(ut.aa=Ce(pt.ia),mt=function(At){return function(zt,pe,We){return At.J(zt,pe,We,At.aa)}}(ut)):pt.ka?(ut.Z=le(pt.da.P,pt.ka),mt=function(At){return function(zt,pe,We){return At.J(zt,pe,We,At.Z)}}(ut)):mt=ut.J,pt.ra=mt),mt(D,yt,pt.da),ut={J:ut.J,aa:ut.aa,Z:ut.Z}}}(function(At,zt){if(zt=zt.R){jn(At,At.h.end());for(var pe=0;pe<zt.length;pe++)jn(At,Be(zt[pe])||kn())}})(D,yt)}Yn(ys,23),la=Object.freeze(ys),ji.prototype.toJSON=function(){return Zs(this.o,Rc,bu)},ji.prototype.C=function(){return!!(2&or(this.o))},ji.prototype.ja=Da,ji.prototype.toString=function(){return this.o.toString()};var xs=Symbol();function xu(yt,D,U){return yt[xs]||(yt[xs]=function(et,ut){return D(et,ut,U)})}function pa(yt){var D=yt[xs];if(!D){var U=bi(yt);D=function(et,ut){return Ci(et,ut,U)},yt[xs]=D}return D}function _n(yt){var D=function(ut){var pt=ut.ia;return pt?pa(pt):(pt=ut.wa)?xu(ut.da.P,pt,ut.ka):void 0}(yt),U=yt.da,et=yt.oa.U;return D?function(ut,pt){return et(ut,pt,U,D)}:function(ut,pt){return et(ut,pt,U)}}function ls(yt,D){var U=yt[D];return typeof U=="function"&&U.length===0&&(U=U(),yt[D]=U),Array.isArray(U)&&($i in U||Pe in U||0<U.length&&typeof U[0]=="function")?U:void 0}function Dt(yt,D,U,et,ut,pt){D.P=yt[0];var mt=1;if(yt.length>mt&&typeof yt[mt]!="number"){var At=yt[mt++];U(D,At)}for(;mt<yt.length;){U=yt[mt++];for(var zt=mt+1;zt<yt.length&&typeof yt[zt]!="number";)zt++;switch(At=yt[mt++],zt-=mt){case 0:et(D,U,At);break;case 1:(zt=ls(yt,mt))?(mt++,ut(D,U,At,zt)):et(D,U,At,yt[mt++]);break;case 2:ut(D,U,At,zt=ls(yt,zt=mt++),yt[mt++]);break;case 3:pt(D,U,At,yt[mt++],yt[mt++],yt[mt++]);break;case 4:pt(D,U,At,yt[mt++],yt[mt++],yt[mt++],yt[mt++]);break;default:throw Error("unexpected number of binary field arguments: "+zt)}}return D}var Zt=Symbol();function Ce(yt){var D=yt[Zt];if(!D){var U=Kr(yt);D=function(et,ut){return ra(et,ut,U)},yt[Zt]=D}return D}function le(yt,D){var U=yt[Zt];return U||(U=function(et,ut){return Zu(et,ut,D)},yt[Zt]=U),U}var Pe=Symbol();function rn(yt,D){yt.push(D)}function Cn(yt,D,U){yt.push(D,U.W)}function Vn(yt,D,U,et){var ut=Ce(et),pt=Kr(et).P,mt=U.W;yt.push(D,function(At,zt,pe){return mt(At,zt,pe,pt,ut)})}function hr(yt,D,U,et,ut,pt){var mt=le(et,pt),At=U.W;yt.push(D,function(zt,pe,We){return At(zt,pe,We,et,mt)})}function Kr(yt){var D=yt[Pe];return D||(D=Dt(yt,yt[Pe]=[],rn,Cn,Vn,hr),$i in yt&&Pe in yt&&(yt.length=0),D)}var $i=Symbol();function Ai(yt,D){yt[0]=D}function Rr(yt,D,U,et){var ut=U.U;yt[D]=et?function(pt,mt,At){return ut(pt,mt,At,et)}:ut}function Jr(yt,D,U,et,ut){var pt=U.U,mt=pa(et),At=bi(et).P;yt[D]=function(zt,pe,We){return pt(zt,pe,We,At,mt,ut)}}function di(yt,D,U,et,ut,pt,mt){var At=U.U,zt=xu(et,ut,pt);yt[D]=function(pe,We,Ke){return At(pe,We,Ke,et,zt,mt)}}function bi(yt){var D=yt[$i];return D||(D=Dt(yt,yt[$i]={},Ai,Rr,Jr,di),$i in yt&&Pe in yt&&(yt.length=0),D)}function Ci(yt,D,U){for(;Fo(D)&&D.i!=4;){var et=D.l,ut=U[et];if(!ut){var pt=U[0];pt&&(pt=pt[et])&&(ut=U[et]=_n(pt))}if(!ut||!ut(D,yt,et)){et=yt,pt=(ut=D).j,Wa(ut);var mt=ut;if(!mt.ca){if(ut=mt.h.h-pt,mt.h.h=pt,mt=mt.h,ut==0)ut=Ti();else{if(pt=Er(mt,ut),mt.S&&mt.m)ut=mt.i.subarray(pt,pt+ut);else{mt=mt.i;var At=pt;ut=At===(ut=pt+ut)?kn():Kn?mt.slice(At,ut):new Uint8Array(mt.subarray(At,ut))}ut=ut.length==0?Ti():new Cr(ut,mn)}(pt=et.R)?pt.push(ut):et.R=[ut]}}}return yt}function ra(yt,D,U){for(var et=U.length,ut=et%2==1,pt=ut?1:0;pt<et;pt+=2)(0,U[pt+1])(D,yt,U[pt]);Zu(yt,D,ut?U[0]:void 0)}function oa(yt,D){return{U:yt,W:D}}var Wr=oa(function(yt,D,U){if(yt.i!==5)return!1;var et=(yt=yt.h).i,ut=yt.h,pt=et[ut],mt=et[ut+1],At=et[ut+2];return et=et[ut+3],qn(yt,yt.h+4),yt=2*((mt=(pt|mt<<8|At<<16|et<<24)>>>0)>>31)+1,pt=mt>>>23&255,mt&=8388607,va(D,U,pt==255?mt?NaN:1/0*yt:pt==0?yt*Math.pow(2,-149)*mt:yt*Math.pow(2,pt-150)*(mt+Math.pow(2,23))),!0},function(yt,D,U){if((D=Du(D,U))!=null){br(yt.h,8*U+5),yt=yt.h;var et=+D;et===0?0<1/et?Sn=Wn=0:(Wn=0,Sn=2147483648):isNaN(et)?(Wn=0,Sn=2147483647):34028234663852886e22<(et=(U=0>et?-2147483648:0)?-et:et)?(Wn=0,Sn=(2139095040|U)>>>0):11754943508222875e-54>et?(et=Math.round(et/Math.pow(2,-149)),Wn=0,Sn=(U|et)>>>0):(D=Math.floor(Math.log(et)/Math.LN2),et*=Math.pow(2,-D),16777216<=(et=Math.round(8388608*et))&&++D,Wn=0,Sn=(U|D+127<<23|8388607&et)>>>0),U=Sn,yt.h.push(U>>>0&255),yt.h.push(U>>>8&255),yt.h.push(U>>>16&255),yt.h.push(U>>>24&255)}}),_a=oa(function(yt,D,U){if(yt.i!==0)return!1;var et=yt.h,ut=0,pt=yt=0,mt=et.i,At=et.h;do{var zt=mt[At++];ut|=(127&zt)<<pt,pt+=7}while(32>pt&&128&zt);for(32<pt&&(yt|=(127&zt)>>4),pt=3;32>pt&&128&zt;pt+=7)yt|=(127&(zt=mt[At++]))<<pt;if(qn(et,At),!(128>zt))throw tn();return et=ut>>>0,(yt=2147483648&(zt=yt>>>0))&&(zt=~zt>>>0,(et=1+~et>>>0)==0&&(zt=zt+1>>>0)),et=4294967296*zt+(et>>>0),va(D,U,yt?-et:et),!0},function(yt,D,U){(D=na(D,U))!=null&&(typeof D=="string"&&Ae(D),D!=null&&(br(yt.h,8*U),typeof D=="number"?(yt=yt.h,Ze(D),ua(yt,Sn,Wn)):(U=Ae(D),ua(yt.h,U.i,U.h))))}),Ca=oa(function(yt,D,U){return yt.i===0&&(va(D,U,fr(yt.h)),!0)},function(yt,D,U){if((D=na(D,U))!=null&&D!=null)if(br(yt.h,8*U),yt=yt.h,0<=(U=D))br(yt,U);else{for(D=0;9>D;D++)yt.h.push(127&U|128),U>>=7;yt.h.push(1)}}),Gi=oa(function(yt,D,U){if(yt.i!==2)return!1;var et=fr(yt.h)>>>0,ut=Er(yt=yt.h,et);if(yt=yt.i,ai){var pt,mt=yt;(pt=Zn)||(pt=Zn=new TextDecoder("utf-8",{fatal:!0})),yt=ut+et,mt=ut===0&&yt===mt.length?mt:mt.subarray(ut,yt);try{var At=pt.decode(mt)}catch(Ke){if(Mr===void 0){try{pt.decode(new Uint8Array([128]))}catch{}try{pt.decode(new Uint8Array([97])),Mr=!0}catch{Mr=!1}}throw!Mr&&(Zn=void 0),Ke}}else{et=(At=ut)+et,ut=[];for(var zt,pe,We=null;At<et;)128>(zt=yt[At++])?ut.push(zt):224>zt?At>=et?Mn():(pe=yt[At++],194>zt||(192&pe)!=128?(At--,Mn()):ut.push((31&zt)<<6|63&pe)):240>zt?At>=et-1?Mn():(192&(pe=yt[At++]))!=128||zt===224&&160>pe||zt===237&&160<=pe||(192&(mt=yt[At++]))!=128?(At--,Mn()):ut.push((15&zt)<<12|(63&pe)<<6|63&mt):244>=zt?At>=et-2?Mn():(192&(pe=yt[At++]))!=128||pe-144+(zt<<28)>>30||(192&(mt=yt[At++]))!=128||(192&(pt=yt[At++]))!=128?(At--,Mn()):(zt=(7&zt)<<18|(63&pe)<<12|(63&mt)<<6|63&pt,zt-=65536,ut.push(55296+(zt>>10&1023),56320+(1023&zt))):Mn(),8192<=ut.length&&(We=Hn(We,ut),ut.length=0);At=Hn(We,ut)}return va(D,U,At),!0},function(yt,D,U){if((D=na(D,U))!=null){var et=!1;if(et=et!==void 0&&et,ea){if(et&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(D))throw Error("Found an unpaired surrogate");D=(_r||(_r=new TextEncoder)).encode(D)}else{for(var ut=0,pt=new Uint8Array(3*D.length),mt=0;mt<D.length;mt++){var At=D.charCodeAt(mt);if(128>At)pt[ut++]=At;else{if(2048>At)pt[ut++]=At>>6|192;else{if(55296<=At&&57343>=At){if(56319>=At&&mt<D.length){var zt=D.charCodeAt(++mt);if(56320<=zt&&57343>=zt){At=1024*(At-55296)+zt-56320+65536,pt[ut++]=At>>18|240,pt[ut++]=At>>12&63|128,pt[ut++]=At>>6&63|128,pt[ut++]=63&At|128;continue}mt--}if(et)throw Error("Found an unpaired surrogate");At=65533}pt[ut++]=At>>12|224,pt[ut++]=At>>6&63|128}pt[ut++]=63&At|128}}D=ut===pt.length?pt:pt.subarray(0,ut)}br(yt.h,8*U+2),br(yt.h,D.length),jn(yt,yt.h.end()),jn(yt,D)}}),Ea=oa(function(yt,D,U,et,ut){if(yt.i!==2)return!1;D=Ru(D,U,et),U=yt.h.j,et=fr(yt.h)>>>0;var pt=yt.h.h+et,mt=pt-U;if(0>=mt&&(yt.h.j=pt,ut(D,yt,void 0,void 0,void 0),mt=pt-yt.h.h),mt)throw Error("Message parsing ended unexpectedly. Expected to read "+et+" bytes, instead read "+(et-mt)+" bytes, either the data ended unexpectedly or the message misreported its own length");return yt.h.h=pt,yt.h.j=U,!0},function(yt,D,U,et,ut){if((D=ws(D,et,U))!=null)for(et=0;et<D.length;et++){var pt=yt;br(pt.h,8*U+2);var mt=pt.h.end();jn(pt,mt),mt.push(pt.i),pt=mt,ut(D[et],yt),mt=yt;var At=pt.pop();for(At=mt.i+mt.h.length()-At;127<At;)pt.push(127&At|128),At>>>=7,mt.i++;pt.push(At),mt.i++}});function Ta(yt){return function(D,U){t:{if(Le.length){var et=Le.pop();et.setOptions(U),lr(et.h,D,U),D=et}else D=new eo(D,U);try{var ut=bi(yt),pt=Ci(new ut.P,D,ut);break t}finally{(ut=D.h).i=null,ut.m=!1,ut.l=0,ut.j=0,ut.h=0,ut.S=!1,D.l=-1,D.i=-1,100>Le.length&&Le.push(D)}pt=void 0}return pt}}function Dn(yt){return function(){var D=new bn;ra(this,D,Kr(yt)),jn(D,D.h.end());for(var U=new Uint8Array(D.i),et=D.j,ut=et.length,pt=0,mt=0;mt<ut;mt++){var At=et[mt];U.set(At,pt),pt+=At.length}return D.j=[U],U}}function Ui(yt){ji.call(this,yt)}xt(Ui,ji);var sa=[Ui,1,Ca,2,Wr,3,Gi,4,Gi];function ks(yt){ji.call(this,yt,-1,Po)}Ui.prototype.l=Dn(sa),xt(ks,ji),ks.prototype.addClassification=function(yt,D){return Ru(this,1,Ui,yt,D),this};var Po=[1],ku=Ta([ks,1,Ea,sa]);function io(yt){ji.call(this,yt)}xt(io,ji);var an=[io,1,Wr,2,Wr,3,Wr,4,Wr,5,Wr];function Ms(yt){ji.call(this,yt,-1,lu)}io.prototype.l=Dn(an),xt(Ms,ji);var lu=[1],Ul=Ta([Ms,1,Ea,an]);function Ou(yt){ji.call(this,yt)}xt(Ou,ji);var Lu=[Ou,1,Wr,2,Wr,3,Wr,4,Wr,5,Wr,6,_a],Ed=Ta(Lu);function Fc(yt,D,U){if(U=yt.createShader(U===0?yt.VERTEX_SHADER:yt.FRAGMENT_SHADER),yt.shaderSource(U,D),yt.compileShader(U),!yt.getShaderParameter(U,yt.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+yt.getShaderInfoLog(U));return U}function ni(yt){return ws(yt,Ui,1).map(function(D){var U=na(D,1);return{index:U??0,qa:Ga(D,2),label:na(D,3)!=null?Ko(na(D,3),""):void 0,displayName:na(D,4)!=null?Ko(na(D,4),""):void 0}})}function Zr(yt){return{x:Ga(yt,1),y:Ga(yt,2),z:Ga(yt,3),visibility:Du(yt,4)!=null?Ga(yt,4):void 0}}function Qu(yt,D){this.i=yt,this.h=D,this.m=0}function Wl(yt,D,U){return function(et,ut){var pt=et.h;if(et.s===void 0){var mt=Fc(pt,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),At=Fc(pt,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),zt=pt.createProgram();if(pt.attachShader(zt,mt),pt.attachShader(zt,At),pt.linkProgram(zt),!pt.getProgramParameter(zt,pt.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+pt.getProgramInfoLog(zt));mt=et.s=zt,pt.useProgram(mt),At=pt.getUniformLocation(mt,"sampler0"),et.l={O:pt.getAttribLocation(mt,"aVertex"),N:pt.getAttribLocation(mt,"aTex"),ya:At},et.v=pt.createBuffer(),pt.bindBuffer(pt.ARRAY_BUFFER,et.v),pt.enableVertexAttribArray(et.l.O),pt.vertexAttribPointer(et.l.O,2,pt.FLOAT,!1,0,0),pt.bufferData(pt.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),pt.STATIC_DRAW),pt.bindBuffer(pt.ARRAY_BUFFER,null),et.u=pt.createBuffer(),pt.bindBuffer(pt.ARRAY_BUFFER,et.u),pt.enableVertexAttribArray(et.l.N),pt.vertexAttribPointer(et.l.N,2,pt.FLOAT,!1,0,0),pt.bufferData(pt.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),pt.STATIC_DRAW),pt.bindBuffer(pt.ARRAY_BUFFER,null),pt.uniform1i(At,0)}mt=et.l,pt.useProgram(et.s),pt.canvas.width=ut.width,pt.canvas.height=ut.height,pt.viewport(0,0,ut.width,ut.height),pt.activeTexture(pt.TEXTURE0),et.i.bindTexture2d(ut.glName),pt.enableVertexAttribArray(mt.O),pt.bindBuffer(pt.ARRAY_BUFFER,et.v),pt.vertexAttribPointer(mt.O,2,pt.FLOAT,!1,0,0),pt.enableVertexAttribArray(mt.N),pt.bindBuffer(pt.ARRAY_BUFFER,et.u),pt.vertexAttribPointer(mt.N,2,pt.FLOAT,!1,0,0),pt.bindFramebuffer(pt.DRAW_FRAMEBUFFER?pt.DRAW_FRAMEBUFFER:pt.FRAMEBUFFER,null),pt.clearColor(0,0,0,0),pt.clear(pt.COLOR_BUFFER_BIT),pt.colorMask(!0,!0,!0,!0),pt.drawArrays(pt.TRIANGLE_FAN,0,4),pt.disableVertexAttribArray(mt.O),pt.disableVertexAttribArray(mt.N),pt.bindBuffer(pt.ARRAY_BUFFER,null),et.i.bindTexture2d(0)}(yt,D),typeof yt.h.canvas.transferToImageBitmap=="function"?Promise.resolve(yt.h.canvas.transferToImageBitmap()):U?Promise.resolve(yt.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(yt.h.canvas):(yt.j===void 0&&(yt.j=document.createElement("canvas")),new Promise(function(et){yt.j.height=yt.h.canvas.height,yt.j.width=yt.h.canvas.width,yt.j.getContext("2d",{}).drawImage(yt.h.canvas,0,0,yt.h.canvas.width,yt.h.canvas.height),et(yt.j)}))}function Yh(yt){this.h=yt}Ou.prototype.l=Dn(Lu);var Ba=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function $s(yt,D){return D+yt}function Oc(yt,D){window[yt]=D}function oc(yt){if(this.h=yt,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=yt&&yt.locateFile||$s,typeof window=="object")var D=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(typeof location>"u")throw Error("solutions can only be loaded on a web page or in a web worker");D=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.ha=D,yt.options)for(var U=(D=J(Object.keys(yt.options))).next();!U.done;U=D.next()){U=U.value;var et=yt.options[U].default;et!==void 0&&(this.l[U]=typeof et=="function"?et():et)}}function sc(yt){var D,U,et,ut,pt,mt,At,zt,pe,We,Ke;return Ft(function(Tn){switch(Tn.h){case 1:return yt.ga?(D=yt.h.files===void 0?[]:typeof yt.h.files=="function"?yt.h.files(yt.l):yt.h.files,Tt(Tn,Ft(function(nn){switch(nn.h){case 1:return nn.s=2,Tt(nn,WebAssembly.instantiate(Ba),4);case 4:nn.h=3,nn.s=0;break;case 2:return nn.s=0,nn.l=null,nn.return(!1);case 3:return nn.return(!0)}}),2)):Tn.return();case 2:if(U=Tn.i,typeof window=="object")return Oc("createMediapipeSolutionsWasm",{locateFile:yt.locateFile}),Oc("createMediapipeSolutionsPackedAssets",{locateFile:yt.locateFile}),mt=D.filter(function(nn){return nn.data!==void 0}),At=D.filter(function(nn){return nn.data===void 0}),zt=Promise.all(mt.map(function(nn){var un=Lc(yt,nn.url);if(nn.path!==void 0){var zn=nn.path;un=un.then(function(In){return yt.overrideFile(zn,In),Promise.resolve(In)})}return un})),pe=Promise.all(At.map(function(nn){return nn.simd===void 0||nn.simd&&U||!nn.simd&&!U?function(un){var zn=document.createElement("script");return zn.setAttribute("src",un),zn.setAttribute("crossorigin","anonymous"),new Promise(function(In){zn.addEventListener("load",function(){In()},!1),zn.addEventListener("error",function(){In()},!1),document.body.appendChild(zn)})}(yt.locateFile(nn.url,yt.ha)):Promise.resolve()})).then(function(){var nn,un,zn;return Ft(function(In){if(In.h==1)return nn=window.createMediapipeSolutionsWasm,un=window.createMediapipeSolutionsPackedAssets,zn=yt,Tt(In,nn(un),2);zn.i=In.i,In.h=0})}),We=Ft(function(nn){return yt.h.graph&&yt.h.graph.url?nn=Tt(nn,Lc(yt,yt.h.graph.url),0):(nn.h=0,nn=void 0),nn}),Tt(Tn,Promise.all([pe,zt,We]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return et=D.filter(function(nn){return nn.simd===void 0||nn.simd&&U||!nn.simd&&!U}).map(function(nn){return yt.locateFile(nn.url,yt.ha)}),importScripts.apply(null,q(et)),ut=yt,Tt(Tn,createMediapipeSolutionsWasm(Module),6);case 6:ut.i=Tn.i,yt.m=new OffscreenCanvas(1,1),yt.i.canvas=yt.m,pt=yt.i.GL.createContext(yt.m,{antialias:!1,alpha:!1,va:typeof WebGL2RenderingContext<"u"?2:1}),yt.i.GL.makeContextCurrent(pt),Tn.h=4;break;case 7:if(yt.m=document.createElement("canvas"),!(Ke=yt.m.getContext("webgl2",{}))&&!(Ke=yt.m.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),Tn.return();yt.K=Ke,yt.i.canvas=yt.m,yt.i.createContext(yt.m,!0,!0,{});case 4:yt.j=new yt.i.SolutionWasm,yt.ga=!1,Tn.h=0}})}function Lc(yt,D){var U,et;return Ft(function(ut){return D in yt.L?ut.return(yt.L[D]):(U=yt.locateFile(D,""),et=fetch(U).then(function(pt){return pt.arrayBuffer()}),yt.L[D]=et,ut.return(et))})}function Ju(yt,D,U){var et,ut,pt,mt,At,zt,pe,We,Ke,Tn,nn,un,zn,In;return Ft(function(Or){switch(Or.h){case 1:if(!U)return Or.return(D);for(et={},ut=0,pt=J(Object.keys(U)),mt=pt.next();!mt.done;mt=pt.next())At=mt.value,typeof(zt=U[At])!="string"&&zt.type==="texture"&&D[zt.stream]!==void 0&&++ut;1<ut&&(yt.M=!1),pe=J(Object.keys(U)),mt=pe.next();case 2:if(mt.done){Or.h=4;break}if(We=mt.value,typeof(Ke=U[We])=="string")return zn=et,In=We,Tt(Or,function(Js,zs,pi){var cu;return Ft(function(Vl){return typeof pi=="number"||pi instanceof Uint8Array||pi instanceof Js.i.Uint8BlobList?Vl.return(pi):pi instanceof Js.i.Texture2dDataOut?((cu=Js.v[zs])||(cu=new Qu(Js.i,Js.K),Js.v[zs]=cu),Vl.return(Wl(cu,pi,Js.M))):Vl.return(void 0)})}(yt,We,D[Ke]),14);if(Tn=D[Ke.stream],Ke.type==="detection_list"){if(Tn){for(var oi=Tn.getRectList(),ur=Tn.getLandmarksList(),Na=Tn.getClassificationsList(),fi=[],Lr=0;Lr<oi.size();++Lr){var wi=Ed(oi.get(Lr)),cs=void 0;cs=cs===void 0?0:cs,wi={la:{sa:Ga(wi,1),ta:Ga(wi,2),height:Ga(wi,3),width:Ga(wi,4),rotation:Ga(wi,5,0),pa:Ko(na(wi,6),cs)},ea:ws(Ul(ur.get(Lr)),io,1).map(Zr),ba:ni(ku(Na.get(Lr)))},fi.push(wi)}oi=fi}else oi=[];et[We]=oi,Or.h=7;break}if(Ke.type==="proto_list"){if(Tn){for(oi=Array(Tn.size()),ur=0;ur<Tn.size();ur++)oi[ur]=Tn.get(ur);Tn.delete()}else oi=[];et[We]=oi,Or.h=7;break}if(Tn===void 0){Or.h=3;break}if(Ke.type==="float_list"){et[We]=Tn,Or.h=7;break}if(Ke.type==="proto"){et[We]=Tn,Or.h=7;break}if(Ke.type!=="texture")throw Error("Unknown output config type: '"+Ke.type+"'");return(nn=yt.v[We])||(nn=new Qu(yt.i,yt.K),yt.v[We]=nn),Tt(Or,Wl(nn,Tn,yt.M),13);case 13:un=Or.i,et[We]=un;case 7:Ke.transform&&et[We]&&(et[We]=Ke.transform(et[We])),Or.h=3;break;case 14:zn[In]=Or.i;case 3:mt=pe.next(),Or.h=2;break;case 4:return Or.return(et)}})}function ph(yt,D){for(var U=D.name||"$",et=[].concat(q(D.wants)),ut=new yt.i.StringList,pt=J(D.wants),mt=pt.next();!mt.done;mt=pt.next())ut.push_back(mt.value);pt=yt.i.PacketListener.implement({onResults:function(At){for(var zt={},pe=0;pe<D.wants.length;++pe)zt[et[pe]]=At.get(pe);var We=yt.listeners[U];We&&(yt.I=Ju(yt,zt,D.outs).then(function(Ke){Ke=We(Ke);for(var Tn=0;Tn<D.wants.length;++Tn){var nn=zt[et[Tn]];typeof nn=="object"&&nn.hasOwnProperty&&nn.hasOwnProperty("delete")&&nn.delete()}Ke&&(yt.I=Ke)}))}}),yt.j.attachMultiListener(ut,pt),ut.delete()}function $c(yt){return yt===void 0&&(yt=0),yt===1?"selfie_segmentation_landscape.tflite":"selfie_segmentation.tflite"}function uc(yt){var D=this;yt=yt||{},this.h=new oc({locateFile:yt.locateFile,files:function(U){return[{simd:!0,url:"selfie_segmentation_solution_simd_wasm_bin.js"},{simd:!1,url:"selfie_segmentation_solution_wasm_bin.js"},{data:!0,url:$c(U.modelSelection)}]},graph:{url:"selfie_segmentation.binarypb"},listeners:[{wants:["segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window=="object"&&window.navigator!==void 0&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelSelection:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelSelection",fieldName:"int_value"},onChange:function(U){var et,ut,pt;return Ft(function(mt){return mt.h==1?(et=$c(U),ut="third_party/mediapipe/modules/selfie_segmentation/"+et,Tt(mt,Lc(D.h,et),2)):(pt=mt.i,D.h.overrideFile(ut,pt),mt.return(!0))})}}}})}(B=oc.prototype).close=function(){return this.j&&this.j.delete(),Promise.resolve()},B.reset=function(){var yt=this;return Ft(function(D){yt.j&&(yt.j.reset(),yt.s={},yt.v={}),D.h=0})},B.setOptions=function(yt,D){var U=this;if(D=D||this.h.options){for(var et=[],ut=[],pt={},mt=J(Object.keys(yt)),At=mt.next();!At.done;pt={X:pt.X,Y:pt.Y},At=mt.next())if(!((At=At.value)in this.l)||this.l[At]!==yt[At]){this.l[At]=yt[At];var zt=D[At];zt!==void 0&&(zt.onChange&&(pt.X=zt.onChange,pt.Y=yt[At],et.push(function(pe){return function(){return Ft(function(We){if(We.h==1)return Tt(We,pe.X(pe.Y),2);We.i===!0&&(U.u=!0),We.h=0})}}(pt))),zt.graphOptionXref&&(At=Object.assign({},{calculatorName:"",calculatorIndex:0},zt.graphOptionXref,{valueNumber:zt.type===1?yt[At]:0,valueBoolean:zt.type===0&&yt[At],valueString:zt.type===2?yt[At]:""}),ut.push(At)))}et.length===0&&ut.length===0||(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(ut),this.F=(this.F===void 0?[]:this.F).concat(et))}},B.initialize=function(){var yt=this;return Ft(function(D){return D.h==1?Tt(D,sc(yt),2):D.h!=3?Tt(D,function(U){var et,ut,pt,mt,At,zt,pe,We;return Ft(function(Ke){if(Ke.h==1)return U.h.graph&&U.h.graph.url&&U.fa===U.h.graph.url?Ke.return():(U.u=!0,U.h.graph&&U.h.graph.url?(U.fa=U.h.graph.url,Tt(Ke,Lc(U,U.h.graph.url),3)):void(Ke.h=2));for(Ke.h!=2&&(et=Ke.i,U.j.loadGraph(et)),ut=J(Object.keys(U.D)),pt=ut.next();!pt.done;pt=ut.next())mt=pt.value,U.j.overrideFile(mt,U.D[mt]);if(U.D={},U.h.listeners)for(At=J(U.h.listeners),zt=At.next();!zt.done;zt=At.next())pe=zt.value,ph(U,pe);We=U.l,U.l={},U.setOptions(We),Ke.h=0})}(yt),3):Tt(D,function(U){var et,ut,pt,mt,At,zt;return Ft(function(pe){switch(pe.h){case 1:if(!U.u)return pe.return();if(!U.F){pe.h=2;break}et=J(U.F),ut=et.next();case 3:if(ut.done){pe.h=5;break}return Tt(pe,(0,ut.value)(),4);case 4:ut=et.next(),pe.h=3;break;case 5:U.F=void 0;case 2:if(U.H){for(pt=new U.i.GraphOptionChangeRequestList,mt=J(U.H),At=mt.next();!At.done;At=mt.next())zt=At.value,pt.push_back(zt);U.j.changeOptions(pt),pt.delete(),U.H=void 0}U.u=!1,pe.h=0}})}(yt),0)})},B.overrideFile=function(yt,D){this.j?this.j.overrideFile(yt,D):this.D[yt]=D},B.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},B.send=function(yt,D){var U,et,ut,pt,mt,At,zt,pe,We,Ke=this;return Ft(function(Tn){switch(Tn.h){case 1:return Ke.h.inputs?(U=1e3*(D??performance.now()),Tt(Tn,Ke.I,2)):Tn.return();case 2:return Tt(Tn,Ke.initialize(),3);case 3:for(et=new Ke.i.PacketDataList,ut=J(Object.keys(yt)),pt=ut.next();!pt.done;pt=ut.next())if(mt=pt.value,At=Ke.h.inputs[mt]){t:{var nn=yt[mt];switch(At.type){case"video":var un=Ke.s[At.stream];if(un||(un=new Qu(Ke.i,Ke.K),Ke.s[At.stream]=un),un.m===0&&(un.m=un.i.createTexture()),typeof HTMLVideoElement<"u"&&nn instanceof HTMLVideoElement)var zn=nn.videoWidth,In=nn.videoHeight;else typeof HTMLImageElement<"u"&&nn instanceof HTMLImageElement?(zn=nn.naturalWidth,In=nn.naturalHeight):(zn=nn.width,In=nn.height);In={glName:un.m,width:zn,height:In},(zn=un.h).canvas.width=In.width,zn.canvas.height=In.height,zn.activeTexture(zn.TEXTURE0),un.i.bindTexture2d(un.m),zn.texImage2D(zn.TEXTURE_2D,0,zn.RGBA,zn.RGBA,zn.UNSIGNED_BYTE,nn),un.i.bindTexture2d(0),un=In;break t;case"detections":for((un=Ke.s[At.stream])||(un=new Yh(Ke.i),Ke.s[At.stream]=un),un.data||(un.data=new un.h.DetectionListData),un.data.reset(nn.length),In=0;In<nn.length;++In){zn=nn[In];var Or=un.data,oi=Or.setBoundingBox,ur=In,Na=zn.la,fi=new Ou;if(Ra(fi,1,Na.sa),Ra(fi,2,Na.ta),Ra(fi,3,Na.height),Ra(fi,4,Na.width),Ra(fi,5,Na.rotation),va(fi,6,Na.pa),Na=fi.l(),oi.call(Or,ur,Na),zn.ea)for(Or=0;Or<zn.ea.length;++Or){fi=zn.ea[Or],ur=(oi=un.data).addNormalizedLandmark,Na=In,fi=Object.assign({},fi,{visibility:fi.visibility?fi.visibility:0});var Lr=new io;Ra(Lr,1,fi.x),Ra(Lr,2,fi.y),Ra(Lr,3,fi.z),fi.visibility&&Ra(Lr,4,fi.visibility),fi=Lr.l(),ur.call(oi,Na,fi)}if(zn.ba)for(Or=0;Or<zn.ba.length;++Or)ur=(oi=un.data).addClassification,Na=In,fi=zn.ba[Or],Ra(Lr=new Ui,2,fi.qa),fi.index&&va(Lr,1,fi.index),fi.label&&va(Lr,3,fi.label),fi.displayName&&va(Lr,4,fi.displayName),fi=Lr.l(),ur.call(oi,Na,fi)}un=un.data;break t;default:un={}}}switch(zt=un,pe=At.stream,At.type){case"video":et.pushTexture2d(Object.assign({},zt,{stream:pe,timestamp:U}));break;case"detections":(We=zt).stream=pe,We.timestamp=U,et.pushDetectionList(We);break;default:throw Error("Unknown input config type: '"+At.type+"'")}}return Ke.j.send(et),Tt(Tn,Ke.I,4);case 4:et.delete(),Tn.h=0}})},B.onResults=function(yt,D){this.listeners[D||"$"]=yt},ge("Solution",oc),ge("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(B=uc.prototype).close=function(){return this.h.close(),Promise.resolve()},B.onResults=function(yt){this.h.onResults(yt)},B.initialize=function(){var yt=this;return Ft(function(D){return Tt(D,yt.h.initialize(),0)})},B.reset=function(){this.h.reset()},B.send=function(yt){var D=this;return Ft(function(U){return Tt(U,D.h.send(yt),0)})},B.setOptions=function(yt){this.h.setOptions(yt)},ge("SelfieSegmentation",uc),ge("VERSION","0.1.1675465747")}).call(this)},3185:(L,O)=>{O.c6=void 0,O.c6=[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[0,9],[9,10],[10,11],[11,12],[0,13],[13,14],[14,15],[15,16],[0,17],[17,18],[18,19],[19,20]]},5149:(L,O,S)=>{S.d(O,{GJ:()=>B,uI:()=>j});class B{constructor(Y,X){this.backend=Y,this.dataMover=X,this.data=new WeakMap,this.dataIdsCount=0}get(Y){return this.data.has(Y)||this.dataMover.moveData(this.backend,Y),this.data.get(Y)}set(Y,X){this.dataIdsCount++,this.data.set(Y,X)}has(Y){return this.data.has(Y)}delete(Y){return this.dataIdsCount--,this.data.delete(Y)}numDataIds(){return this.dataIdsCount}}class j{refCount(Y){return K("refCount")}incRef(Y){return K("incRef")}timerAvailable(){return!0}time(Y){return K("time")}read(Y){return K("read")}readSync(Y){return K("readSync")}readToGPU(Y,X){return K("readToGPU")}numDataIds(){return K("numDataIds")}disposeData(Y,X){return K("disposeData")}write(Y,X,J){return K("write")}move(Y,X,J,q,H){return K("move")}createTensorFromGPUData(Y,X,J){return K("createTensorFromGPUData")}memory(){return K("memory")}floatPrecision(){return K("floatPrecision")}epsilon(){return this.floatPrecision()===32?1e-7:1e-4}dispose(){return K("dispose")}}function K(Z){throw new Error(`'${Z}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}},8360:(L,O,S)=>{function B(tt,st,lt){let ft=function(xt,wt,_t){return function(bt,Tt,qt){let It=0,St=bt.length,vt=0,Ft=!1;for(;It<St;){vt=It+(St-It>>>1);let Qt=qt(Tt,bt[vt]);Qt>0?It=vt+1:(St=vt,Ft=!Qt)}return Ft?It:-It-1}(xt,wt,_t||j)}(tt,st,lt),gt=ft<0?-(ft+1):ft;tt.splice(gt,0,st)}function j(tt,st){return tt>st?1:tt<st?-1:0}function K(tt,st,lt,ft,gt){return X(tt,st,lt,ft,gt,0)}function Z(tt,st,lt,ft,gt,xt){return X(tt,st,lt,ft,gt,0,!1,xt,!0)}function Y(tt,st,lt,ft,gt,xt){return X(tt,st,lt,ft,gt,xt,!0)}function X(tt,st,lt,ft,gt,xt,wt=!1,_t=!1,bt=!1){let Tt=[];for(let Gt=0;Gt<st.length;Gt++)st[Gt]>gt&&Tt.push({score:st[Gt],boxIndex:Gt,suppressBeginIndex:0});Tt.sort(H);let qt=xt>0?-.5/xt:0,It=[],St=[];for(;It.length<lt&&Tt.length>0;){let Gt=Tt.pop(),{score:ge,boxIndex:ee,suppressBeginIndex:Ee}=Gt;if(ge<gt)break;let Bt=!1;for(let Xt=It.length-1;Xt>=Ee;--Xt){let we=J(tt,ee,It[Xt]);if(we>=ft){Bt=!0;break}if(Gt.score=Gt.score*q(ft,qt,we),Gt.score<=gt)break}Gt.suppressBeginIndex=It.length,Bt||(Gt.score===ge?(It.push(ee),St.push(Gt.score)):Gt.score>gt&&B(Tt,Gt,H))}let vt=It.length,Ft=lt-vt;_t&&Ft>0&&(It.push(...new Array(Ft).fill(0)),St.push(...new Array(Ft).fill(0)));let Qt={selectedIndices:It};return wt&&(Qt.selectedScores=St),bt&&(Qt.validOutputs=vt),Qt}function J(tt,st,lt){let ft=tt.subarray(4*st,4*st+4),gt=tt.subarray(4*lt,4*lt+4),xt=Math.min(ft[0],ft[2]),wt=Math.min(ft[1],ft[3]),_t=Math.max(ft[0],ft[2]),bt=Math.max(ft[1],ft[3]),Tt=Math.min(gt[0],gt[2]),qt=Math.min(gt[1],gt[3]),It=Math.max(gt[0],gt[2]),St=Math.max(gt[1],gt[3]),vt=(_t-xt)*(bt-wt),Ft=(It-Tt)*(St-qt);if(vt<=0||Ft<=0)return 0;let Qt=Math.max(xt,Tt),Gt=Math.max(wt,qt),ge=Math.min(_t,It),ee=Math.min(bt,St),Ee=Math.max(ge-Qt,0)*Math.max(ee-Gt,0);return Ee/(vt+Ft-Ee)}function q(tt,st,lt){let ft=Math.exp(st*lt*lt);return lt<=tt?ft:0}function H(tt,st){return tt.score-st.score||tt.score===st.score&&st.boxIndex-tt.boxIndex}S.d(O,{c7:()=>K,ZS:()=>Z,ut:()=>Y})},4411:(L,O,S)=>{S.d(O,{Y:()=>j});var B=S(448);function j(K,Z){let Y=[];for(let q=0;q<Z.length;q++)Z[q]&&Y.push(q);let X=(0,B.r)(K,"int32"),J=(0,B.r)([Y.length,K.length],"int32");for(let q=0;q<Y.length;q++){let H=X.indexToLoc(Y[q]),tt=q*K.length;J.values.set(H,tt)}return J.toTensor()}},1585:(L,O,S)=>{S.d(O,{T2:()=>bt,Ye:()=>_t});var B=S(5149),j=S(6574),K=S(1743),Z=S(5441),Y=S(7074),X=S(3673),J=S(3879),q=S(5119);class H{constructor(It,St){this.backendTimer=It,this.logger=St,St==null&&(this.logger=new st)}profileKernel(It,St,vt){let Ft,Qt=()=>{Ft=vt()},Gt,ge=J.now();if(this.backendTimer.timerAvailable())Gt=this.backendTimer.time(Qt);else{Qt();for(let ee of Ft)ee.dataSync();Gt=Promise.resolve({kernelMs:J.now()-ge})}if((0,j._K)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let ee=0;ee<Ft.length;ee++){let Ee=Ft[ee];Ee.data().then(Bt=>{tt(Bt,Ee.dtype,It)})}return{kernelName:It,outputs:Ft,inputs:St,timeMs:Gt.then(ee=>ee.kernelMs),extraInfo:Gt.then(ee=>ee.getExtraProfileInfo!=null?ee.getExtraProfileInfo():"")}}logKernelProfile(It){let{kernelName:St,outputs:vt,timeMs:Ft,inputs:Qt,extraInfo:Gt}=It;vt.forEach(ge=>{Promise.all([ge.data(),Ft,Gt]).then(ee=>{this.logger.logKernelProfile(St,ge,ee[0],ee[1],Qt,ee[2])})})}}function tt(qt,It,St){if(It!=="float32")return!1;for(let vt=0;vt<qt.length;vt++){let Ft=qt[vt];if(isNaN(Ft)||!isFinite(Ft))return console.warn(`Found ${Ft} in the result of '${St}'`),!0}return!1}class st{logKernelProfile(It,St,vt,Ft,Qt,Gt){let ge=typeof Ft=="number"?q.av(`${Ft}ms`,9):Ft.error,ee=q.av(It,25),Ee=St.rank,Bt=St.size,Xt=q.av(St.shape.toString(),14),we="";for(let ie in Qt){let m=Qt[ie];if(m!=null){let ye=m.shape||St.shape,Ge=ye.length;we+=`${ie}: ${Ge}D ${Ge>0?ye:""} `}}console.log(`%c${ee}	%c${ge}	%c${Ee}D ${Xt}	%c${Bt}	%c${we}	%c${Gt}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}var lt=S(259),ft=S(565);function gt(qt){return qt.kernelName!=null}class xt{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(It=>It.name)))}}}dispose(){for(let It in this.registeredVariables)this.registeredVariables[It].dispose()}}class wt{constructor(It){this.ENV=It,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new xt}ready(){return ce(this,null,function*(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;let It=this.getSortedBackends();for(let St=0;St<It.length;St++){let vt=It[St];if(yield this.initializeBackend(vt).success)return void(yield this.setBackend(vt))}throw new Error("Could not initialize any backends, all backend initializations failed.")})}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){let{name:It,asyncInit:St}=this.initializeBackendsAndReturnBest();if(St)throw new Error(`The highest priority backend '${It}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(It)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(It){if(!(It in this.registry)){if(!(It in this.registryFactory))return null;{let{asyncInit:St}=this.initializeBackend(It);if(St)return null}}return this.registry[It]}findBackendFactory(It){return It in this.registryFactory?this.registryFactory[It].factory:null}registerBackend(It,St,vt=1){return It in this.registryFactory?(X.i(`${It} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[It]={factory:St,priority:vt},!0)}setBackend(It){return ce(this,null,function*(){if(this.registryFactory[It]==null)throw new Error(`Backend name '${It}' not found in registry`);if(this.backendName=It,this.registry[It]==null){this.backendInstance=null;let{success:St,asyncInit:vt}=this.initializeBackend(It);if(!(vt?yield St:St))return!1}return this.backendInstance=this.registry[It],this.setupRegisteredKernels(),this.profiler=new H(this.backendInstance),!0})}setupRegisteredKernels(){(0,Y.Op)(this.backendName).forEach(It=>{It.setupFunc!=null&&It.setupFunc(this.backendInstance)})}disposeRegisteredKernels(It){(0,Y.Op)(It).forEach(St=>{St.disposeFunc!=null&&St.disposeFunc(this.registry[It])})}initializeBackend(It){let St=this.registryFactory[It];if(St==null)throw new Error(`Cannot initialize backend ${It}, no registration found.`);try{let vt=St.factory();if(!vt||vt instanceof B.uI||typeof vt.then!="function")return this.registry[It]=vt,{success:!0,asyncInit:!1};{let Ft=++this.pendingBackendInitId,Qt=vt.then(Gt=>!(Ft<this.pendingBackendInitId)&&(this.registry[It]=Gt,this.pendingBackendInit=null,!0)).catch(Gt=>(Ft<this.pendingBackendInitId||(this.pendingBackendInit=null,X.i(`Initialization of backend ${It} failed`),X.i(Gt.stack||Gt.message)),!1));return this.pendingBackendInit=Qt,{success:Qt,asyncInit:!0}}}catch(vt){return X.i(`Initialization of backend ${It} failed`),X.i(vt.stack||vt.message),{success:!1,asyncInit:!1}}}removeBackend(It){if(!(It in this.registryFactory))throw new Error(`${It} backend not found in registry`);this.backendName===It&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,It in this.registry&&(this.disposeRegisteredKernels(It),this.registry[It].dispose(),delete this.registry[It]),delete this.registryFactory[It],this.backendName===It&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((It,St)=>this.registryFactory[St].priority-this.registryFactory[It].priority)}initializeBackendsAndReturnBest(){let It=this.getSortedBackends();for(let St=0;St<It.length;St++){let vt=It[St],{success:Ft,asyncInit:Qt}=this.initializeBackend(vt);if(Qt||Ft)return{name:vt,asyncInit:Qt}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(It,St){let vt=this.state.tensorInfo.get(St),Ft=vt.backend,Qt=this.readSync(St),Gt=Ft.refCount(St);Ft.disposeData(St,!0),vt.backend=It,It.move(St,Qt,vt.shape,vt.dtype,Gt),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(It,St){let vt,Ft=null;if(St==null){if(typeof It!="function")throw new Error("Please provide a function to tidy()");St=It}else{if(typeof It!="string"&&!(It instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof St!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");Ft=It}return this.scopedRun(()=>this.startScope(Ft),()=>this.endScope(vt),()=>(vt=St(),vt instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),vt))}scopedRun(It,St,vt){It();try{let Ft=vt();return St(),Ft}catch(Ft){throw St(),Ft}}nextTensorId(){return wt.nextTensorId++}nextVariableId(){return wt.nextVariableId++}clone(It){let St=bt.runKernel(Z.lzr,{x:It}),vt={x:It};return this.addTapeNode(this.state.activeScope.name,vt,[St],Ft=>({x:()=>{let Qt={x:Ft},Gt={dtype:"float32"};return bt.runKernel(Z.KXH,Qt,Gt)}}),[],{}),St}runKernel(It,St,vt){if((0,Y._5)(It,this.backendName)==null)throw new Error(`Kernel '${It}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:It,inputs:St,attrs:vt})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(It,St,vt){let Ft=this.backend.numDataIds(),Qt=0;vt.forEach(ee=>{Qt+=ee.dtype==="complex64"?3:1});let Gt=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],ge=Ft-St-Qt-Gt;if(ge>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${ge} data ids) after running '${It}'`)}runKernelFunc(It){let St,vt=[],Ft=this.isTapeOn(),Qt=this.state.numBytes,Gt=this.state.numTensors,ge,ee;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let Ee=gt(It)?It.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(gt(It)){let{kernelName:m,inputs:ye,attrs:Ge}=It,te=(0,Y._5)(m,this.backendName);q.vA(te!=null,()=>`Cannot find registered kernel '${m}' for backend '${this.backendName}'`),ge=()=>{let Me=this.backend.numDataIds();ee=te.kernelFunc({inputs:ye,attrs:Ge,backend:this.backend});let Ye=Array.isArray(ee)?ee:[ee];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(m,Me,Ye);let Ue=Ye.map(kn=>kn.rank!=null?kn:this.makeTensorFromTensorInfo(kn));if(Ft){let kn=this.getTensorsForGradient(m,ye,Ue);vt=this.saveTensorsForBackwardMode(kn)}return Ue}}else{let{forwardFunc:m}=It,ye=Ge=>{Ft&&(vt=Ge.map(te=>this.keep(this.clone(te))))};ge=()=>{let Ge=this.backend.numDataIds();ee=this.tidy(()=>m(this.backend,ye));let te=Array.isArray(ee)?ee:[ee];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(Ee,Ge,te),te}}let{inputs:Bt,attrs:Xt}=It,we=gt(It)?null:It.backwardsFunc,ie;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(ie=this.profiler.profileKernel(Ee,Bt,()=>ge()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(ie),St=ie.outputs):St=ge()}),Ft&&this.addTapeNode(Ee,Bt,St,we,vt,Xt),this.state.profiling&&this.state.activeProfile.kernels.push({name:Ee,bytesAdded:this.state.numBytes-Qt,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-Gt,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(Bt).map(m=>Bt[m]!=null?Bt[m].shape:null),outputShapes:St.map(m=>m.shape),kernelTimeMs:ie.timeMs,extraInfo:ie.extraInfo}),Array.isArray(ee)?St:St[0]}saveTensorsForBackwardMode(It){return It.map(vt=>this.keep(this.clone(vt)))}getTensorsForGradient(It,St,vt){let Ft=(0,Y.vQ)(It);if(Ft!=null){let Qt=Ft.inputsToSave||[],Gt=Ft.outputsToSave||[],ge;Ft.saveAllInputs?(q.vA(Array.isArray(St),()=>"saveAllInputs is true, expected inputs to be an array."),ge=Object.keys(St).map(Ee=>St[Ee])):ge=Qt.map(Ee=>St[Ee]);let ee=vt.filter((Ee,Bt)=>Gt[Bt]);return ge.concat(ee)}return[]}makeTensor(It,St,vt,Ft){if(It==null)throw new Error("Values passed to engine.makeTensor() are null");vt=vt||"float32",Ft=Ft||this.backend;let Qt=It;vt==="string"&&q.Kg(It[0])&&(Qt=It.map(ee=>J.encodeString(ee)));let Gt=Ft.write(Qt,St,vt),ge=new lt.qY(St,vt,Gt,this.nextTensorId());if(this.trackTensor(ge,Ft),vt==="string"){let ee=this.state.tensorInfo.get(Gt),Ee=(0,q.SL)(Qt);this.state.numBytes+=Ee-ee.bytes,ee.bytes=Ee}return ge}makeTensorFromDataId(It,St,vt,Ft){let Qt={dataId:It,shape:St,dtype:vt=vt||"float32"};return this.makeTensorFromTensorInfo(Qt,Ft)}makeTensorFromTensorInfo(It,St){let{dataId:vt,shape:Ft,dtype:Qt}=It,Gt=new lt.qY(Ft,Qt,vt,this.nextTensorId());return this.trackTensor(Gt,St),Gt}makeVariable(It,St=!0,vt,Ft){vt=vt||this.nextVariableId().toString(),Ft!=null&&Ft!==It.dtype&&(It=It.cast(Ft));let Qt=new lt.rT(It,St,vt,this.nextTensorId());if(this.state.registeredVariables[Qt.name]!=null)throw new Error(`Variable with name ${Qt.name} was already registered`);return this.state.registeredVariables[Qt.name]=Qt,this.incRef(Qt,this.backend),Qt}trackTensor(It,St){this.state.numTensors++,It.dtype==="string"&&this.state.numStringTensors++;let vt=0;It.dtype!=="complex64"&&It.dtype!=="string"&&(vt=It.size*q.jv(It.dtype)),this.state.numBytes+=vt,this.state.tensorInfo.has(It.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(It.dataId,{backend:St||this.backend,dtype:It.dtype,shape:It.shape,bytes:vt})),It instanceof lt.rT||this.track(It)}incRef(It,St){this.trackTensor(It,St),this.backend.incRef(It.dataId)}removeDataId(It,St){this.state.tensorInfo.has(It)&&this.state.tensorInfo.get(It).backend===St&&(this.state.tensorInfo.delete(It),this.state.numDataBuffers--)}disposeTensor(It){if(!this.state.tensorInfo.has(It.dataId))return;let St=this.state.tensorInfo.get(It.dataId);if(this.state.numTensors--,It.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=St.bytes),It.dtype!=="complex64"&&It.dtype!=="string"){let vt=It.size*q.jv(It.dtype);this.state.numBytes-=vt}St.backend.disposeData(It.dataId)&&this.removeDataId(It.dataId,St.backend)}disposeVariables(){for(let It in this.state.registeredVariables){let St=this.state.registeredVariables[It];this.disposeVariable(St)}}disposeVariable(It){this.disposeTensor(It),this.state.registeredVariables[It.name]!=null&&delete this.state.registeredVariables[It.name]}memory(){let It=this.backend.memory();return It.numTensors=this.state.numTensors,It.numDataBuffers=this.state.numDataBuffers,It.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(It.unreliable=!0,It.reasons==null&&(It.reasons=[]),It.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),It}profile(It){return ce(this,null,function*(){this.state.profiling=!0;let St=this.state.numBytes,vt=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=yield It(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(Ft=>Ft.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-St,this.state.activeProfile.newTensors=this.state.numTensors-vt;for(let Ft of this.state.activeProfile.kernels)Ft.kernelTimeMs=yield Ft.kernelTimeMs,Ft.extraInfo=yield Ft.extraInfo;return this.state.activeProfile})}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(It,St,vt,Ft,Qt,Gt){let ge={id:this.state.nextTapeNodeId++,kernelName:It,inputs:St,outputs:vt,saved:Qt},ee=(0,Y.vQ)(It);ee!=null&&(Ft=ee.gradFunc),Ft!=null&&(ge.gradient=Ee=>(Ee=Ee.map((Bt,Xt)=>{if(Bt==null){let we=vt[Xt],ie=q.Ty(we.size,we.dtype);return this.makeTensor(ie,we.shape,we.dtype)}return Bt}),Ft(Ee.length>1?Ee:Ee[0],Qt,Gt))),this.state.activeTape.push(ge)}keep(It){return It.kept=!0,It}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(It){let St={track:[],name:"unnamed scope",id:this.state.nextScopeId++};It&&(St.name=It),this.state.scopeStack.push(St),this.state.activeScope=St}endScope(It){let St=(0,ft.getTensorsInContainer)(It),vt=new Set(St.map(Qt=>Qt.id));for(let Qt=0;Qt<this.state.activeScope.track.length;Qt++){let Gt=this.state.activeScope.track[Qt];Gt.kept||vt.has(Gt.id)||Gt.dispose()}let Ft=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],St.forEach(Qt=>{Qt.kept||Qt.scopeId!==Ft.id||this.track(Qt)})}gradients(It,St,vt,Ft=!1){if(q.vA(St.length>0,()=>"gradients() received an empty list of xs."),vt!=null&&vt.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${vt.dtype}'`);let Qt=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",It));q.vA(Qt instanceof lt.qY,()=>"The result y returned by f() must be a tensor.");let Gt=function(ge,ee,Ee){let Bt={},Xt={};for(let ye=0;ye<ee.length;ye++)Bt[ee[ye].id]=!0;for(let ye=0;ye<ge.length;ye++){let Ge=ge[ye],te=Ge.inputs;for(let Me in te){let Ye=te[Me],Ue=!1;for(let kn=0;kn<ee.length;kn++)if(Bt[Ye.id]){Ge.outputs.forEach(mn=>Bt[mn.id]=!0),Ue=!0,Xt[Ge.id]=!0;break}if(Ue)break}}let we={};we[Ee.id]=!0;let ie={};for(let ye=ge.length-1;ye>=0;ye--){let Ge=ge[ye],te=Ge.inputs;for(let Me=0;Me<Ge.outputs.length;Me++)if(we[Ge.outputs[Me].id]){for(let Ye in te)we[te[Ye].id]=!0,ie[Ge.id]=!0;break}}let m=[];for(let ye=0;ye<ge.length;ye++){let Ge=ge[ye];if(Xt[Ge.id]&&ie[Ge.id]){let te={};for(let Ye in Ge.inputs){let Ue=Ge.inputs[Ye];Bt[Ue.id]&&(te[Ye]=Ue)}let Me=Object.assign({},Ge);Me.inputs=te,Me.outputs=Ge.outputs,m.push(Me)}}return m}(this.state.activeTape,St,Qt);if(!Ft&&Gt.length===0&&St.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let ge={};ge[Qt.id]=vt??function(Ee){let Bt=(0,q.FZ)((0,q.Ze)(Ee),"float32");return bt.makeTensor(Bt,Ee,"float32")}(Qt.shape),function(Ee,Bt,Xt,we){for(let ie=Bt.length-1;ie>=0;ie--){let m=Bt[ie],ye=[];if(m.outputs.forEach(te=>{let Me=Ee[te.id];Me!=null?ye.push(Me):ye.push(null)}),m.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${m.kernelName}.`);let Ge=m.gradient(ye);for(let te in m.inputs){if(!(te in Ge))throw new Error(`Cannot backprop through input ${te}. Available gradients found: ${Object.keys(Ge)}.`);let Me=Xt(()=>Ge[te]());if(Me.dtype!=="float32")throw new Error(`Error in gradient for op ${m.kernelName}. The gradient of input ${te} must have 'float32' dtype, but has '${Me.dtype}'`);let Ye=m.inputs[te];if(!q.r1(Me.shape,Ye.shape))throw new Error(`Error in gradient for op ${m.kernelName}. The gradient of input '${te}' has shape '${Me.shape}', which does not match the shape of the input '${Ye.shape}'`);if(Ee[Ye.id]==null)Ee[Ye.id]=Me;else{let Ue=Ee[Ye.id];Ee[Ye.id]=we(Ue,Me),Ue.dispose()}}}}(ge,Gt,Ee=>this.tidy(Ee),Tt);let ee=St.map(Ee=>ge[Ee.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(Ee=>{for(let Bt of Ee.saved)Bt.dispose()}),this.state.activeTape=null),{value:Qt,grads:ee}})}customGrad(It){return q.vA(q.Tn(It),()=>"The f passed in customGrad(f) must be a function."),(...St)=>{let vt;q.vA(St.every(Qt=>Qt instanceof lt.qY),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let Ft={};return St.forEach((Qt,Gt)=>{Ft[Gt]=Qt}),this.runKernelFunc({forwardFunc:(Qt,Gt)=>(vt=It(...St,Gt),q.vA(vt.value instanceof lt.qY,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),q.vA(q.Tn(vt.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),vt.value),backwardsFunc:(Qt,Gt)=>{let ge=vt.gradFunc(Qt,Gt),ee=Array.isArray(ge)?ge:[ge];q.vA(ee.length===St.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),q.vA(ee.every(Bt=>Bt instanceof lt.qY),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let Ee={};return ee.forEach((Bt,Xt)=>{Ee[Xt]=()=>Bt}),Ee},inputs:Ft})}}readSync(It){return this.state.tensorInfo.get(It).backend.readSync(It)}read(It){return this.state.tensorInfo.get(It).backend.read(It)}readToGPU(It,St){return this.state.tensorInfo.get(It).backend.readToGPU(It,St)}time(It){return ce(this,null,function*(){let St=(0,J.now)(),vt=yield this.backend.time(It);return vt.wallMs=(0,J.now)()-St,vt})}track(It){return this.state.activeScope!=null&&(It.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(It)),It}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new xt;for(let It in this.registry)this.disposeRegisteredKernels(It),this.registry[It].dispose(),delete this.registry[It];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function _t(){let qt=(0,K.L)();if(qt._tfengine==null){let It=new j.OH(qt);qt._tfengine=new wt(It)}return(0,j.tj)(qt._tfengine.ENV),(0,lt.qP)(()=>qt._tfengine),qt._tfengine}wt.nextTensorId=0,wt.nextVariableId=0;let bt=_t();function Tt(qt,It){let St={a:qt,b:It};return bt.runKernel(Z.OMN,St)}},6574:(L,O,S)=>{S.d(O,{Km:()=>X,OH:()=>K,_K:()=>Y,tj:()=>J});var B=S(5119);let j="tfjsflags";class K{constructor(H){this.global=H,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Z,this.populateURLFlags()}setPlatform(H,tt){this.platform!=null&&(Y().getBool("IS_TEST")||Y().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${H}.`)),this.platformName=H,this.platform=tt}registerFlag(H,tt,st){if(this.flagRegistry[H]={evaluationFn:tt,setHook:st},this.urlFlags[H]!=null){let lt=this.urlFlags[H];Y().getBool("IS_TEST")||Y().getBool("PROD")||console.warn(`Setting feature override from URL ${H}: ${lt}.`),this.set(H,lt)}}getAsync(H){return ce(this,null,function*(){return H in this.flags||(this.flags[H]=yield this.evaluateFlag(H)),this.flags[H]})}get(H){if(H in this.flags)return this.flags[H];let tt=this.evaluateFlag(H);if((0,B.yL)(tt))throw new Error(`Flag ${H} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[H]=tt,this.flags[H]}getNumber(H){return this.get(H)}getBool(H){return this.get(H)}getString(H){return this.get(H)}getFlags(){return this.flags}get features(){return this.flags}set(H,tt){if(this.flagRegistry[H]==null)throw new Error(`Cannot set flag ${H} as it has not been registered.`);this.flags[H]=tt,this.flagRegistry[H].setHook!=null&&this.flagRegistry[H].setHook(tt)}evaluateFlag(H){if(this.flagRegistry[H]==null)throw new Error(`Cannot evaluate flag '${H}': no evaluation function found.`);return this.flagRegistry[H].evaluationFn()}setFlags(H){this.flags=Object.assign({},H)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(this.global===void 0||this.global.location===void 0||this.global.location.search===void 0)return;let H=this.getQueryParams(this.global.location.search);j in H&&H[j].split(",").forEach(tt=>{let[st,lt]=tt.split(":");this.urlFlags[st]=function(ft,gt){let xt=gt.toLowerCase();return xt==="true"||xt==="false"?xt==="true":""+ +xt===xt?+xt:gt}(0,lt)})}}function Z(q){let H={};return q.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(tt,...st)=>(function(lt,ft,gt){lt[decodeURIComponent(ft)]=decodeURIComponent(gt||"")}(H,st[0],st[1]),st.join("="))),H}function Y(){return X}let X=null;function J(q){X=q}},1743:(L,O,S)=>{let B;function j(){if(B==null){let Z;if(typeof window<"u")Z=window;else if(S.g!==void 0)Z=S.g;else if(typeof Iu<"u")Z=Iu;else{if(typeof self>"u")throw new Error("Could not find a global object");Z=self}B=Z}return B}function K(Z,Y){let X=function(){let J=j();return J._tfGlobals==null&&(J._tfGlobals=new Map),J._tfGlobals}();if(X.has(Z))return X.get(Z);{let J=Y();return X.set(Z,J),X.get(Z)}}S.d(O,{L:()=>j,m:()=>K})},5287:(L,O,S)=>{S.d(O,{AS:()=>gt,DZ:()=>ft,Gc:()=>bt,Hi:()=>tt,Hs:()=>Ft,IS:()=>J,ME:()=>lt,Ok:()=>Qt,Sm:()=>Y,W4:()=>St,aC:()=>xt,fL:()=>q,gJ:()=>vt,gY:()=>X,go:()=>It,jh:()=>_t,jz:()=>Tt,kB:()=>wt,m1:()=>st,rE:()=>qt,rm:()=>H});var B=S(1585),j=S(6574),K=S(259),Z=S(565);function Y(){(0,j._K)().set("PROD",!0)}function X(){(0,j._K)().set("DEBUG",!0)}function J(){(0,j._K)().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function q(Gt){(0,j._K)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(Gt+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function H(){B.T2.disposeVariables()}function tt(){return B.T2}function st(){return B.T2.memory()}function lt(Gt){return B.T2.profile(Gt)}function ft(Gt,ge){return B.T2.tidy(Gt,ge)}function gt(Gt){(0,Z.getTensorsInContainer)(Gt).forEach(ge=>ge.dispose())}function xt(Gt){return B.T2.keep(Gt)}function wt(Gt){return B.T2.time(Gt)}function _t(Gt){return B.T2.setBackend(Gt)}function bt(){return B.T2.ready()}function Tt(){return B.T2.backendName}function qt(Gt){B.T2.removeBackend(Gt)}function It(Gt){return B.T2.findBackend(Gt)}function St(Gt){return B.T2.findBackendFactory(Gt)}function vt(Gt,ge,ee=1){return B.T2.registerBackend(Gt,ge,ee)}function Ft(){return B.T2.backend}function Qt(Gt,ge){(0,j._K)().setPlatform(Gt,ge)}(0,K.B4)(q)},1830:(L,O,S)=>{S.d(O,{Dv:()=>Y,_X:()=>tt,jY:()=>J,mu:()=>q,ok:()=>X,y7:()=>H});var B=S(1585),j=S(259),K=S(8189),Z=S(5119);function Y(lt){return Z.vA(Z.Tn(lt),()=>"The f passed in grad(f) must be a function"),(ft,gt)=>{let xt=(0,K.YT)(ft,"x","tf.grad","string_or_numeric"),wt=gt!=null?(0,K.YT)(gt,"dy","tf.grad"):null;return B.T2.tidy(()=>{let{value:_t,grads:bt}=B.T2.gradients(()=>lt(xt),[xt],wt);return wt!=null&&Z.O3(_t.shape,wt.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),st(bt),bt[0]})}}function X(lt){return Z.vA(Z.Tn(lt),()=>"The f passed in grads(f) must be a function"),(ft,gt)=>{Z.vA(Array.isArray(ft),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");let xt=(0,K.j1)(ft,"args","tf.grads","string_or_numeric"),wt=gt!=null?(0,K.YT)(gt,"dy","tf.grads"):null;return B.T2.tidy(()=>{let{value:_t,grads:bt}=B.T2.gradients(()=>lt(...xt),xt,wt);return wt!=null&&Z.O3(_t.shape,wt.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),st(bt),bt})}}function J(lt){return Z.vA(Z.Tn(lt),()=>"The f passed in valueAndGrad(f) must be a function"),(ft,gt)=>{Z.vA(ft instanceof j.qY,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),Z.vA(gt==null||gt instanceof j.qY,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");let{grads:xt,value:wt}=B.T2.gradients(()=>lt(ft),[ft],gt);return st(xt),{grad:xt[0],value:wt}}}function q(lt){return Z.vA(Z.Tn(lt),()=>"The f passed in valueAndGrads(f) must be a function"),(ft,gt)=>{Z.vA(Array.isArray(ft)&&ft.every(wt=>wt instanceof j.qY),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),Z.vA(gt==null||gt instanceof j.qY,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");let xt=B.T2.gradients(()=>lt(...ft),ft,gt);return gt!=null&&Z.O3(xt.value.shape,gt.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),st(xt.grads),xt}}function H(lt,ft){Z.vA(Z.Tn(lt),()=>"The f passed in variableGrads(f) must be a function"),Z.vA(ft==null||Array.isArray(ft)&&ft.every(qt=>qt instanceof j.rT),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let gt=ft!=null;if(!gt){ft=[];for(let qt in B.T2.registeredVariables)ft.push(B.T2.registeredVariables[qt])}let xt=gt?ft.filter(qt=>!qt.trainable):null,wt=ft.length;ft=ft.filter(qt=>qt.trainable),Z.vA(ft.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${wt} variables is trainable.`);let{value:_t,grads:bt}=B.T2.gradients(lt,ft,null,!0);Z.vA(bt.some(qt=>qt!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),Z.vA(_t.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${_t.rank} tensor`);let Tt={};return ft.forEach((qt,It)=>{bt[It]!=null&&(Tt[qt.name]=bt[It])}),xt?.forEach(qt=>Tt[qt.name]=null),{value:_t,grads:Tt}}function tt(lt){return B.T2.customGrad(lt)}function st(lt){if(lt.filter(ft=>ft==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}},5838:(L,O,S)=>{S.r(O),S.d(O,{Abs:()=>_n.ljI,Acos:()=>_n.Vvy,Acosh:()=>_n.PH8,AdadeltaOptimizer:()=>Jn,AdagradOptimizer:()=>Ur,AdamOptimizer:()=>li,AdamaxOptimizer:()=>Da,Add:()=>_n.OMN,AddN:()=>_n.EkD,All:()=>_n.u8Z,Any:()=>_n.FSt,ArgMax:()=>_n.Jp_,ArgMin:()=>_n.p_m,Asin:()=>_n.QKF,Asinh:()=>_n.epO,Atan:()=>_n.TyE,Atan2:()=>_n.lxb,Atanh:()=>_n.zP9,AvgPool:()=>_n.ho8,AvgPool3D:()=>_n.cS,AvgPool3DGrad:()=>_n.wwC,AvgPoolGrad:()=>_n.VCH,BatchMatMul:()=>_n.jAQ,BatchToSpaceND:()=>_n.Ik2,Bincount:()=>_n.N4F,BitwiseAnd:()=>_n.HNs,BroadcastArgs:()=>_n.vj7,BroadcastTo:()=>_n.LB5,Cast:()=>_n.KXH,Ceil:()=>_n.QDP,ClipByValue:()=>_n.vaV,Complex:()=>_n.pr3,ComplexAbs:()=>_n.$zE,Concat:()=>_n.$dB,Conv2D:()=>_n.p2J,Conv2DBackpropFilter:()=>_n.rFm,Conv2DBackpropInput:()=>_n.jfg,Conv3D:()=>_n.A1h,Conv3DBackpropFilterV2:()=>_n.iGz,Conv3DBackpropInputV2:()=>_n.gC7,Cos:()=>_n.Mn0,Cosh:()=>_n.MnK,CropAndResize:()=>_n.MRQ,Cumprod:()=>_n.jj_,Cumsum:()=>_n.nY8,DataStorage:()=>Xh.GJ,DenseBincount:()=>_n.wNW,DepthToSpace:()=>_n.TMz,DepthwiseConv2dNative:()=>_n.tGH,DepthwiseConv2dNativeBackpropFilter:()=>_n.X$8,DepthwiseConv2dNativeBackpropInput:()=>_n.nVu,Diag:()=>_n.ORI,Dilation2D:()=>_n.jxD,Dilation2DBackpropFilter:()=>_n.pk0,Dilation2DBackpropInput:()=>_n.bP9,Draw:()=>_n.XmO,ENV:()=>wt.Km,Einsum:()=>_n.Qgm,Elu:()=>_n.Pah,EluGrad:()=>_n.rsH,Environment:()=>wt.OH,Equal:()=>_n.BRl,Erf:()=>_n._s9,Exp:()=>_n.ox3,ExpandDims:()=>_n.ybN,Expm1:()=>_n.ybj,FFT:()=>_n.rGP,Fill:()=>_n.SQl,FlipLeftRight:()=>_n.BxF,Floor:()=>_n.ZgB,FloorDiv:()=>_n.ElG,FromPixels:()=>_n.awo,FusedBatchNorm:()=>_n.i5R,FusedConv2D:()=>_n.aAr,FusedDepthwiseConv2D:()=>_n.T7M,GatherNd:()=>_n.O4G,GatherV2:()=>_n.mxL,Greater:()=>_n.XhZ,GreaterEqual:()=>_n.lLS,IFFT:()=>_n.OAQ,Identity:()=>_n.lzr,Imag:()=>_n.dv8,IsFinite:()=>_n.gIW,IsInf:()=>_n.E3$,IsNan:()=>_n.iPs,KernelBackend:()=>Xh.uI,LRN:()=>_n.jM4,LRNGrad:()=>_n.ToN,LeakyRelu:()=>_n.X0$,Less:()=>_n.mIA,LessEqual:()=>_n.CwD,LinSpace:()=>_n.mnI,Log:()=>_n.tG8,Log1p:()=>_n.Cg$,LogSoftmax:()=>_n.zfU,LogicalAnd:()=>_n.RUm,LogicalNot:()=>_n.nZd,LogicalOr:()=>_n.LXA,LogicalXor:()=>_n.RW8,LowerBound:()=>_n.yPW,MatrixBandPart:()=>_n.WRv,Max:()=>_n.VAI,MaxPool:()=>_n.t3d,MaxPool3D:()=>_n.ySp,MaxPool3DGrad:()=>_n.cHb,MaxPoolGrad:()=>_n.RXX,MaxPoolWithArgmax:()=>_n.TL8,Maximum:()=>_n.LDN,Mean:()=>_n.g5A,Min:()=>_n.lNG,Minimum:()=>_n.LG0,MirrorPad:()=>_n.x7F,Mod:()=>_n.BLA,MomentumOptimizer:()=>la,Multinomial:()=>_n.WT3,Multiply:()=>_n.xu7,Neg:()=>_n.l0G,NonMaxSuppressionV3:()=>_n.SDM,NonMaxSuppressionV4:()=>_n.Zl4,NonMaxSuppressionV5:()=>_n.e0f,NotEqual:()=>_n.ylV,OP_SCOPE_SUFFIX:()=>an.BTT,OneHot:()=>_n.urI,OnesLike:()=>_n.LWX,Optimizer:()=>jn,OptimizerConstructors:()=>ku,Pack:()=>_n.mM$,PadV2:()=>_n.ODT,Pool:()=>_n.bCz,Pow:()=>_n.pyJ,Prelu:()=>_n.Ncv,Prod:()=>_n.kdj,RMSPropOptimizer:()=>so,RaggedGather:()=>_n.oJ2,RaggedRange:()=>_n.CQC,RaggedTensorToTensor:()=>_n.mH5,Range:()=>_n.Q6t,Rank:()=>io.rg,Real:()=>_n.LRy,RealDiv:()=>_n.sDr,Reciprocal:()=>_n.huO,Reduction:()=>Ms.i,Relu:()=>_n.fUj,Relu6:()=>_n.P_L,Reshape:()=>_n.R23,ResizeBilinear:()=>_n.hgw,ResizeBilinearGrad:()=>_n.FCQ,ResizeNearestNeighbor:()=>_n.jOE,ResizeNearestNeighborGrad:()=>_n.XQy,Reverse:()=>_n.D7i,RotateWithOffset:()=>_n.BK4,Round:()=>_n.hVg,Rsqrt:()=>_n.TOR,SGDOptimizer:()=>_i,ScatterNd:()=>_n.pJc,SearchSorted:()=>_n.uWl,Select:()=>_n.l6P,Selu:()=>_n.u$b,Sigmoid:()=>_n.vI1,Sign:()=>_n.YVe,Sin:()=>_n.hql,Sinh:()=>_n.J3C,Slice:()=>_n.JiE,Softmax:()=>_n.rFG,Softplus:()=>_n.Fin,SpaceToBatchND:()=>_n.A8B,SparseFillEmptyRows:()=>_n.C8s,SparseReshape:()=>_n.BoJ,SparseSegmentMean:()=>_n.L6G,SparseSegmentSum:()=>_n.DvZ,SparseToDense:()=>_n.jgd,SplitV:()=>_n.Blb,Sqrt:()=>_n.dFH,Square:()=>_n.M6A,SquaredDifference:()=>_n.Ddj,StaticRegexReplace:()=>_n.GZp,Step:()=>_n.pnw,StridedSlice:()=>_n.UcO,StringNGrams:()=>_n.YAb,StringSplit:()=>_n.iW0,StringToHashBucketFast:()=>_n.$jE,Sub:()=>_n.PbM,Sum:()=>_n.WuN,Tan:()=>_n.oFs,Tanh:()=>_n.iuW,Tensor:()=>Cr.qY,TensorBuffer:()=>Cr.yl,TensorScatterUpdate:()=>_n.X4r,Tile:()=>_n.FAs,TopK:()=>_n.TBb,Transform:()=>_n.dLy,Transpose:()=>_n.wx0,Unique:()=>_n.EwU,Unpack:()=>_n.dXR,UnsortedSegmentSum:()=>_n.pPe,UpperBound:()=>_n.RMm,Variable:()=>Cr.rT,ZerosLike:()=>_n.xJ3,_FusedMatMul:()=>_n.Dr,abs:()=>an.tnl,acos:()=>an.HQu,acosh:()=>an.FqL,add:()=>an.WQq,addN:()=>an.QiD,all:()=>an.Q7R,any:()=>an.bzn,argMax:()=>an.FLi,argMin:()=>an.XRg,asin:()=>an.qRo,asinh:()=>an.yHs,atan:()=>an.rYl,atan2:()=>an.FPz,atanh:()=>an.rfv,avgPool:()=>an.$jT,avgPool3d:()=>an.sub,backend:()=>Be.Hs,backend_util:()=>H,basicLSTMCell:()=>an.lZX,batchNorm:()=>an.$v7,batchNorm2d:()=>an.BFc,batchNorm3d:()=>an.kSi,batchNorm4d:()=>an.T5N,batchToSpaceND:()=>an.GTe,bincount:()=>an.HbZ,bitwiseAnd:()=>an.vjT,booleanMaskAsync:()=>an.ftb,broadcastArgs:()=>an.ROE,broadcastTo:()=>an.hOW,broadcast_util:()=>pa,browser:()=>Y,buffer:()=>an.ra8,cast:()=>an.wgE,ceil:()=>an.mkO,clipByValue:()=>an.zQh,clone:()=>an.o8B,complex:()=>an.faB,concat:()=>an.xWs,concat1d:()=>an.I1m,concat2d:()=>an.RPU,concat3d:()=>an.O5O,concat4d:()=>an.P1l,conv1d:()=>an.kA9,conv2d:()=>an.Xtf,conv2dTranspose:()=>an.wX9,conv3d:()=>an.IPL,conv3dTranspose:()=>an.jIJ,copyRegisteredKernels:()=>ls.Cf,cos:()=>an.gnS,cosh:()=>an.yIG,cosineWindow:()=>an._jP,cumprod:()=>an.Lp0,cumsum:()=>an.rCv,customGrad:()=>vi._X,denseBincount:()=>an.aOp,deprecationWarn:()=>Be.fL,depthToSpace:()=>an.Rj8,depthwiseConv2d:()=>an.Gl3,device_util:()=>B,diag:()=>an.smy,dilation2d:()=>an.X7t,disableDeprecationWarnings:()=>Be.IS,dispose:()=>Be.AS,disposeVariables:()=>Be.rm,div:()=>an.y4m,divNoNan:()=>an.ek5,dot:()=>an.Omf,dropout:()=>an.EZY,einsum:()=>an._3C,elu:()=>an.Pqc,enableDebugMode:()=>Be.gY,enableProdMode:()=>Be.Sm,enclosingPowerOfTwo:()=>an.FJY,engine:()=>Be.Hi,ensureShape:()=>an.QP2,env:()=>wt._K,equal:()=>an.LCg,erf:()=>an.Y12,euclideanNorm:()=>an.p4S,exp:()=>an.oNF,expandDims:()=>an.UG6,expm1:()=>an.IYd,eye:()=>an.y5U,fft:()=>an.hVP,fill:()=>an.GSj,findBackend:()=>Be.go,findBackendFactory:()=>Be.W4,floor:()=>an.RIf,floorDiv:()=>an.wh_,fused:()=>an.cZk,gather:()=>an.kgh,gatherND:()=>an.SY9,gather_util:()=>X,getBackend:()=>Be.jz,getGradient:()=>ls.vQ,getKernel:()=>ls._5,getKernelsForBackend:()=>ls.Op,grad:()=>vi.Dv,grads:()=>vi.ok,greater:()=>an.rhj,greaterEqual:()=>an.DQN,ifft:()=>an.KGM,imag:()=>an.ngS,image:()=>an.Slp,inTopKAsync:()=>an.U4u,io:()=>K,irfft:()=>an.ggX,isFinite:()=>an.MIs,isInf:()=>an.EN4,isNaN:()=>an.yrW,keep:()=>Be.aC,kernel_impls:()=>tt,leakyRelu:()=>an.H8d,less:()=>an.M7h,lessEqual:()=>an.InN,linalg:()=>an.mPL,linspace:()=>an.mT8,localResponseNormalization:()=>an.Kgs,log:()=>an.Rm2,log1p:()=>an.Kko,logSigmoid:()=>an.nqI,logSoftmax:()=>an.HPB,logSumExp:()=>an.VZ,logicalAnd:()=>an.n76,logicalNot:()=>an.NSZ,logicalOr:()=>an.ztW,logicalXor:()=>an.rxB,losses:()=>an.YYh,lowerBound:()=>an.yzS,matMul:()=>an.NoW,math:()=>Z,max:()=>an.T9B,maxPool:()=>an.jgi,maxPool3d:()=>an.NYV,maxPoolWithArgmax:()=>an.RO,maximum:()=>an.PhQ,mean:()=>an.i2o,memory:()=>Be.m1,meshgrid:()=>an.OYQ,min:()=>an.jkA,minimum:()=>an.BpO,mirrorPad:()=>an.FFZ,mod:()=>an.ziu,moments:()=>an.Clk,movingAverage:()=>an.CRk,mul:()=>an.lKK,multiRNNCell:()=>an.YDF,multinomial:()=>an.OjQ,neg:()=>an.HZy,nextFrame:()=>Ou,norm:()=>an.xbf,notEqual:()=>an.Ec,oneHot:()=>an.Mw0,ones:()=>an.SaS,onesLike:()=>an.P61,op:()=>an.op,outerProduct:()=>an.X4o,pad:()=>an.eVF,pad1d:()=>an.BZs,pad2d:()=>an.grY,pad3d:()=>an.XHu,pad4d:()=>an.WLX,pool:()=>an.dzn,pow:()=>an.n7C,prelu:()=>an.NsG,print:()=>an.yyV,prod:()=>an._eU,profile:()=>Be.ME,raggedGather:()=>an.whe,raggedRange:()=>an.iyU,raggedTensorToTensor:()=>an.Q0_,rand:()=>an._9M,randomGamma:()=>an.pR9,randomNormal:()=>an.FE$,randomStandardNormal:()=>an.m0H,randomUniform:()=>an.YeY,randomUniformInt:()=>an.HYA,range:()=>an.y17,ready:()=>Be.Gc,real:()=>an.xav,reciprocal:()=>an.VOZ,registerBackend:()=>Be.gJ,registerGradient:()=>ls.kr,registerKernel:()=>ls.tA,relu:()=>an.VVh,relu6:()=>an.j__,removeBackend:()=>Be.rE,reshape:()=>an.tQQ,reverse:()=>an.BEg,reverse1d:()=>an.QD2,reverse2d:()=>an.LMr,reverse3d:()=>an.I2l,reverse4d:()=>an.JYU,rfft:()=>an.z8$,round:()=>an.LIG,rsqrt:()=>an.Z$r,scalar:()=>an.d_2,scatterND:()=>an.NFr,scatter_util:()=>Ai,searchSorted:()=>an.sZg,selu:()=>an.WfX,separableConv2d:()=>an.wdz,serialization:()=>j,setBackend:()=>Be.jh,setPlatform:()=>Be.Ok,setdiff1dAsync:()=>an.F12,sigmoid:()=>an.ry7,sign:()=>an._SZ,signal:()=>an.vPA,sin:()=>an.F8e,sinh:()=>an.L0l,slice:()=>an.dik,slice1d:()=>an.Q$M,slice2d:()=>an.zAd,slice3d:()=>an.wck,slice4d:()=>an.R0O,slice_util:()=>Rr,softmax:()=>an.Vs9,softplus:()=>an.lw0,spaceToBatchND:()=>an.eDJ,sparse:()=>an.lMo,sparseToDense:()=>an.Zhr,spectral:()=>an.lOn,split:()=>an.lDo,sqrt:()=>an.RZD,square:()=>an.EwI,squaredDifference:()=>an.Pbu,squeeze:()=>an.r2V,stack:()=>an.t$z,step:()=>an.PMw,stridedSlice:()=>an.Ym9,string:()=>an.YjP,sub:()=>an.jbE,sum:()=>an.czq,sumOutType:()=>io.ch,tan:()=>an.Mlm,tanh:()=>an.ymU,tensor:()=>an.OEK,tensor1d:()=>an.tGX,tensor2d:()=>an.KtR,tensor3d:()=>an.$_$,tensor4d:()=>an.g9W,tensor5d:()=>an.Lpo,tensor6d:()=>an.yxw,tensorScatterUpdate:()=>an.NNh,tensor_util:()=>Jr,test_util:()=>J,tidy:()=>Be.DZ,tile:()=>an.Vsq,time:()=>Be.kB,topk:()=>an.rfw,train:()=>lu,transpose:()=>an.mgz,truncatedNormal:()=>an.efE,unique:()=>an.AmM,unregisterGradient:()=>ls.rY,unregisterKernel:()=>ls.iP,unsortedSegmentSum:()=>an.zAU,unstack:()=>an.K$i,upcastType:()=>io.Tu,upperBound:()=>an.rni,util:()=>di,valueAndGrad:()=>vi.jY,valueAndGrads:()=>vi.mu,variable:()=>an.bvq,variableGrads:()=>vi.y7,version_core:()=>Po,where:()=>an._M9,whereAsync:()=>an.YJN,zeros:()=>an.Ul9,zerosLike:()=>an.POl});var B={};S.r(B),S.d(B,{isBrowser:()=>xt,isMobile:()=>gt,mockIsMobile:()=>ft});var j={};S.r(j),S.d(j,{Serializable:()=>Fo,SerializationMap:()=>Wa,getRegisteredName:()=>bn,registerClass:()=>Le});var K={};S.r(K),S.d(K,{CompositeArrayBuffer:()=>Ft.D,browserFiles:()=>na,browserHTTPRequest:()=>Ga,concatenateArrayBuffers:()=>bt.AQ,copyModel:()=>tn,decodeWeights:()=>bt.CY,decodeWeightsStream:()=>bt.s5,encodeWeights:()=>bt.aG,fromMemory:()=>bu,fromMemorySync:()=>Qs,getLoadHandlers:()=>vt,getModelArtifactsForJSON:()=>bt.Ej,getModelArtifactsForJSONSync:()=>bt.Rl,getModelArtifactsInfoForJSON:()=>bt.oR,getSaveHandlers:()=>St,getWeightSpecs:()=>bt.Xf,http:()=>Ko,isHTTPScheme:()=>Ra,listModels:()=>Ae,loadWeights:()=>Du,moveModel:()=>wn,registerLoadRouter:()=>It,registerSaveRouter:()=>qt,removeModel:()=>$e,weightsLoaderFactory:()=>uu,withSaveHandler:()=>wu,withSaveHandlerSync:()=>Tl});var Z={};S.r(Z),S.d(Z,{confusionMatrix:()=>xu});var Y={};S.r(Y),S.d(Y,{draw:()=>hr,fromPixels:()=>Kr,fromPixelsAsync:()=>rn,toPixels:()=>Vn});var X={};S.r(X),S.d(X,{prepareAndValidate:()=>$i});var J={};S.r(J),S.d(J,{TEST_EPSILON_FLOAT16:()=>Ci,createVideoElement:()=>sa,encodeStrings:()=>Ui,expectArrayBuffersEqual:()=>Dn,expectArraysClose:()=>ra,expectArraysEqual:()=>Ca,expectNumbersClose:()=>Gi,expectPromiseToFail:()=>_a,expectValuesInRange:()=>Ta,play:()=>ks,testEpsilon:()=>oa});var q={};S.r(q),S.d(q,{collectGatherOpShapeInfo:()=>i0,computeOutShape:()=>bw,segOpComputeOptimalWindowSize:()=>bv});var H={};S.r(H),S.d(H,{ERF_A1:()=>U,ERF_A2:()=>et,ERF_A3:()=>ut,ERF_A4:()=>pt,ERF_A5:()=>mt,ERF_P:()=>D,PARALLELIZE_THRESHOLD:()=>Oc,RowPartitionType:()=>ni,SELU_SCALE:()=>yt.X,SELU_SCALEALPHA:()=>yt.j,applyActivation:()=>Qu.f2,assertAndGetBroadcastShape:()=>pa.assertAndGetBroadcastShape,assertAxesAreInnerMostDims:()=>Lu.WC,assertParamsConsistent:()=>Ed,assignToTypedArray:()=>nn,axesAreInnerMostDims:()=>Lu.WH,calculateShapes:()=>Ai.calculateShapes,checkEinsumDimSizes:()=>Lr,checkPadOnDimRoundingMode:()=>Zr.s_,combineLocations:()=>Lu.aF,combineRaggedTensorToTensorShapes:()=>Wl,complexWithEvenIndex:()=>We,complexWithOddIndex:()=>Ke,computeConv2DInfo:()=>Zr.uf,computeConv3DInfo:()=>Zr.p$,computeDefaultPad:()=>Zr.G8,computeDilation2DInfo:()=>Zr.YQ,computeOptimalWindowSize:()=>oc,computeOutAndReduceShapes:()=>Lu.lb,computeOutShape:()=>Fc,computePool2DInfo:()=>Zr.E6,computePool3DInfo:()=>Zr.l5,convertConv2DDataFormat:()=>Zr.$Q,decodeEinsumEquation:()=>Na,eitherStridesOrDilationsAreOne:()=>Zr.G0,expandShapeToKeepDim:()=>Lu.SM,exponent:()=>zn,exponents:()=>un,fromStringArrayToUint8:()=>wv,fromUint8ToStringArray:()=>qh,getAxesPermutation:()=>Lu.Em,getBroadcastDims:()=>pa.getBroadcastDims,getComplexWithIndex:()=>Tn,getEinsumComputePath:()=>wi,getEinsumPermutation:()=>fi,getFusedBiasGradient:()=>Qu.Do,getFusedDyActivation:()=>Qu.XB,getImageCenter:()=>sc,getInnerMostAxes:()=>Lu.fK,getPermuted:()=>Ju,getRaggedRank:()=>Ba,getReductionAxes:()=>pa.getReductionAxes,getReshaped:()=>Lc,getReshapedPermuted:()=>ph,getRowPartitionTypesHelper:()=>Yh,getSliceBeginCoords:()=>$c,getSliceSize:()=>uc,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>pi,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>cu,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>Vl,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>zc,getSparseReshapeInputOutputMismatchErrorMessage:()=>vw,getSparseReshapeInputOutputMultipleErrorMessage:()=>r0,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>Al,getSparseReshapeNegativeOutputDimErrorMessage:()=>yw,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>Wi,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>mh,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>Gl,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>yn,getUndoAxesPermutation:()=>Lu.gx,isIdentityPermutation:()=>cs,log:()=>At.R,mergeRealAndImagArrays:()=>zt,prepareAndValidate:()=>$i,prepareSplitSize:()=>zs,segment_util:()=>q,shouldFuse:()=>Qu.zE,slice_util:()=>Rr,splitRealAndImagArrays:()=>pe,stridesOrDilationsArePositive:()=>Zr.qk,tupleValuesAreOne:()=>Zr.Dh,upcastType:()=>io.Tu,validateDefaultValueShape:()=>$s,validateInput:()=>Ai.validateInput,validateUpdateShape:()=>Ai.validateUpdateShape,warn:()=>At.i});var tt={};S.r(tt),S.d(tt,{nonMaxSuppressionV3Impl:()=>$u.c7,nonMaxSuppressionV4Impl:()=>$u.ZS,nonMaxSuppressionV5Impl:()=>$u.ut,whereImpl:()=>xo.Y});var st=S(1585);let lt;function ft(oe){lt=oe}function gt(oe){if(lt!==void 0)return lt;if(oe||typeof navigator<"u"&&navigator!=null){if(oe||(oe=navigator),oe.product==="ReactNative")return!0;let Lt=oe.userAgent||oe.vendor||(typeof window<"u"?window.opera:"");if(!Lt){let ne=oe;return ne.userAgentData&&ne.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(Lt)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(Lt.substr(0,4))}return!1}function xt(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var wt=S(6574);let _t=(0,wt._K)();_t.registerFlag("DEBUG",()=>!1,oe=>{oe&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),_t.registerFlag("IS_BROWSER",()=>xt()),_t.registerFlag("IS_NODE",()=>typeof Iu<"u"&&Iu.versions!==void 0&&Iu.versions.node!==void 0),_t.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),_t.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),_t.registerFlag("PROD",()=>!1),_t.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>_t.getBool("DEBUG")),_t.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),_t.registerFlag("IS_TEST",()=>!1),_t.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>_t.getBool("DEBUG")),_t.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),_t.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),_t.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);var bt=S(7084);class Tt{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Tt.instance==null&&(Tt.instance=new Tt),Tt.instance}static registerSaveRouter(Lt){Tt.getInstance().saveRouters.push(Lt)}static registerLoadRouter(Lt){Tt.getInstance().loadRouters.push(Lt)}static getSaveHandlers(Lt){return Tt.getHandlers(Lt,"save")}static getLoadHandlers(Lt,ne){return Tt.getHandlers(Lt,"load",ne)}static getHandlers(Lt,ne,xe){let Oe=[];return(ne==="load"?Tt.getInstance().loadRouters:Tt.getInstance().saveRouters).forEach(fn=>{let vn=fn(Lt,xe);vn!==null&&Oe.push(vn)}),Oe}}let qt=oe=>Tt.registerSaveRouter(oe),It=oe=>Tt.registerLoadRouter(oe),St=oe=>Tt.getSaveHandlers(oe),vt=(oe,Lt)=>Tt.getLoadHandlers(oe,Lt);var Ft=S(6734);let Qt="tensorflowjs",Gt="models_store",ge="model_info_store";function ee(){if(!(0,wt._K)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let oe=typeof window>"u"?self:window,Lt=oe.indexedDB||oe.mozIndexedDB||oe.webkitIndexedDB||oe.msIndexedDB||oe.shimIndexedDB;if(Lt==null)throw new Error("The current browser does not appear to support IndexedDB.");return Lt}function Ee(oe){let Lt=oe.result;Lt.createObjectStore(Gt,{keyPath:"modelPath"}),Lt.createObjectStore(ge,{keyPath:"modelPath"})}let Bt=(()=>{class oe{constructor(ne){if(this.indexedDB=ee(),ne==null||!ne)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=ne}save(ne){return ce(this,null,function*(){if(ne.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,ne)})}load(){return ce(this,null,function*(){return this.databaseAction(this.modelPath)})}databaseAction(ne,xe){return new Promise((Oe,fn)=>{let vn=this.indexedDB.open(Qt,1);vn.onupgradeneeded=()=>Ee(vn),vn.onsuccess=()=>{let rr=vn.result;if(xe==null){let pr=rr.transaction(Gt,"readonly"),Yr=pr.objectStore(Gt).get(this.modelPath);Yr.onsuccess=()=>{if(Yr.result==null)return rr.close(),fn(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));Oe(Yr.result.modelArtifacts)},Yr.onerror=qr=>(rr.close(),fn(Yr.error)),pr.oncomplete=()=>rr.close()}else{xe.weightData=Ft.D.join(xe.weightData);let pr=(0,bt.oR)(xe),Yr=rr.transaction(ge,"readwrite"),qr,xr,ma=Yr.objectStore(ge);try{qr=ma.put({modelPath:this.modelPath,modelArtifactsInfo:pr})}catch(ca){return fn(ca)}qr.onsuccess=()=>{xr=rr.transaction(Gt,"readwrite");let ca=xr.objectStore(Gt),uo;try{uo=ca.put({modelPath:this.modelPath,modelArtifacts:xe,modelArtifactsInfo:pr})}catch(Qo){return fn(Qo)}uo.onsuccess=()=>Oe({modelArtifactsInfo:pr}),uo.onerror=Qo=>{ma=Yr.objectStore(ge);let Ps=ma.delete(this.modelPath);Ps.onsuccess=()=>(rr.close(),fn(uo.error)),Ps.onerror=Cg=>(rr.close(),fn(uo.error))}},qr.onerror=ca=>(rr.close(),fn(qr.error)),Yr.oncomplete=()=>{xr==null?rr.close():xr.oncomplete=()=>rr.close()}}},vn.onerror=rr=>fn(vn.error)})}}return oe.URL_SCHEME="indexeddb://",oe})(),Xt=oe=>{return(0,wt._K)().getBool("IS_BROWSER")&&!Array.isArray(oe)&&oe.startsWith(Bt.URL_SCHEME)?(Lt=oe.slice(Bt.URL_SCHEME.length),new Bt(Lt)):null;var Lt};Tt.registerSaveRouter(Xt),Tt.registerLoadRouter(Xt);class we{constructor(){this.indexedDB=ee()}listModels(){return ce(this,null,function*(){return new Promise((Lt,ne)=>{let xe=this.indexedDB.open(Qt,1);xe.onupgradeneeded=()=>Ee(xe),xe.onsuccess=()=>{let Oe=xe.result,fn=Oe.transaction(ge,"readonly"),vn=fn.objectStore(ge).getAll();vn.onsuccess=()=>{let rr={};for(let pr of vn.result)rr[pr.modelPath]=pr.modelArtifactsInfo;Lt(rr)},vn.onerror=rr=>(Oe.close(),ne(vn.error)),fn.oncomplete=()=>Oe.close()},xe.onerror=Oe=>ne(xe.error)})})}removeModel(Lt){return ce(this,null,function*(){var ne;return Lt=(ne=Lt).startsWith(Bt.URL_SCHEME)?ne.slice(Bt.URL_SCHEME.length):ne,new Promise((xe,Oe)=>{let fn=this.indexedDB.open(Qt,1);fn.onupgradeneeded=()=>Ee(fn),fn.onsuccess=()=>{let vn=fn.result,rr=vn.transaction(ge,"readwrite"),pr=rr.objectStore(ge),Yr=pr.get(Lt),qr;Yr.onsuccess=()=>{if(Yr.result==null)return vn.close(),Oe(new Error(`Cannot find model with path '${Lt}' in IndexedDB.`));{let xr=pr.delete(Lt),ma=()=>{qr=vn.transaction(Gt,"readwrite");let ca=qr.objectStore(Gt).delete(Lt);ca.onsuccess=()=>xe(Yr.result.modelArtifactsInfo),ca.onerror=uo=>Oe(Yr.error)};xr.onsuccess=ma,xr.onerror=ca=>(ma(),vn.close(),Oe(Yr.error))}},Yr.onerror=xr=>(vn.close(),Oe(Yr.error)),rr.oncomplete=()=>{qr==null?vn.close():qr.oncomplete=()=>vn.close()}},fn.onerror=vn=>Oe(fn.error)})})}}var ie=S(5119);let m="/",ye="tensorflowjs_models",Ge="info",te="model_topology",Me="weight_specs",Ye="weight_data",Ue="model_metadata";function kn(oe){return{info:[ye,oe,Ge].join(m),topology:[ye,oe,te].join(m),weightSpecs:[ye,oe,Me].join(m),weightData:[ye,oe,Ye].join(m),modelMetadata:[ye,oe,Ue].join(m)}}function mn(oe){for(let Lt of Object.values(oe))window.localStorage.removeItem(Lt)}function Kn(oe){let Lt=oe.split(m);if(Lt.length<3)throw new Error(`Invalid key format: ${oe}`);return Lt.slice(1,Lt.length-1).join(m)}let Sn=(()=>{class oe{constructor(ne){if(!(0,wt._K)().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,ne==null||!ne)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=ne,this.keys=kn(this.modelPath)}save(ne){return ce(this,null,function*(){if(ne.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let xe=JSON.stringify(ne.modelTopology),Oe=JSON.stringify(ne.weightSpecs),fn=(0,bt.oR)(ne),vn=Ft.D.join(ne.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(fn)),this.LS.setItem(this.keys.topology,xe),this.LS.setItem(this.keys.weightSpecs,Oe),this.LS.setItem(this.keys.weightData,(0,bt.l3)(vn));let rr={format:ne.format,generatedBy:ne.generatedBy,convertedBy:ne.convertedBy,signature:ne.signature!=null?ne.signature:void 0,userDefinedMetadata:ne.userDefinedMetadata!=null?ne.userDefinedMetadata:void 0,modelInitializer:ne.modelInitializer!=null?ne.modelInitializer:void 0,initializerSignature:ne.initializerSignature!=null?ne.initializerSignature:void 0,trainingConfig:ne.trainingConfig!=null?ne.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(rr)),{modelArtifactsInfo:fn}}catch{throw mn(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${fn.modelTopologyBytes}, weightSpecsBytes=${fn.weightSpecsBytes}, weightDataBytes=${fn.weightDataBytes}.`)}}})}load(){return ce(this,null,function*(){let ne=JSON.parse(this.LS.getItem(this.keys.info));if(ne==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(ne.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let xe={},Oe=JSON.parse(this.LS.getItem(this.keys.topology));if(Oe==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);xe.modelTopology=Oe;let fn=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(fn==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);xe.weightSpecs=fn;let vn=this.LS.getItem(this.keys.modelMetadata);if(vn!=null){let pr=JSON.parse(vn);xe.format=pr.format,xe.generatedBy=pr.generatedBy,xe.convertedBy=pr.convertedBy,pr.signature!=null&&(xe.signature=pr.signature),pr.userDefinedMetadata!=null&&(xe.userDefinedMetadata=pr.userDefinedMetadata),pr.modelInitializer!=null&&(xe.modelInitializer=pr.modelInitializer),pr.initializerSignature!=null&&(xe.initializerSignature=pr.initializerSignature),pr.trainingConfig!=null&&(xe.trainingConfig=pr.trainingConfig)}let rr=this.LS.getItem(this.keys.weightData);if(rr==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return xe.weightData=(0,bt.jf)(rr),xe})}}return oe.URL_SCHEME="localstorage://",oe})(),Wn=oe=>{return(0,wt._K)().getBool("IS_BROWSER")&&!Array.isArray(oe)&&oe.startsWith(Sn.URL_SCHEME)?(Lt=oe.slice(Sn.URL_SCHEME.length),new Sn(Lt)):null;var Lt};Tt.registerSaveRouter(Wn),Tt.registerLoadRouter(Wn);class Ze{constructor(){(0,ie.vA)((0,wt._K)().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),(0,ie.vA)(typeof window>"u"||window.localStorage!==void 0,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}listModels(){return ce(this,null,function*(){let Lt={},ne=ye+m,xe=m+Ge;for(let Oe=0;Oe<this.LS.length;++Oe){let fn=this.LS.key(Oe);fn.startsWith(ne)&&fn.endsWith(xe)&&(Lt[Kn(fn)]=JSON.parse(this.LS.getItem(fn)))}return Lt})}removeModel(Lt){return ce(this,null,function*(){var ne;let xe=kn(Lt=(ne=Lt).startsWith(Sn.URL_SCHEME)?ne.slice(Sn.URL_SCHEME.length):ne);if(this.LS.getItem(xe.info)==null)throw new Error(`Cannot find model at path '${Lt}'`);let Oe=JSON.parse(this.LS.getItem(xe.info));return mn(xe),Oe})}}let de="://";class Re{constructor(){this.managers={}}static getInstance(){return Re.instance==null&&(Re.instance=new Re),Re.instance}static registerManager(Lt,ne){(0,ie.vA)(Lt!=null,()=>"scheme must not be undefined or null."),Lt.endsWith(de)&&(Lt=Lt.slice(0,Lt.indexOf(de))),(0,ie.vA)(Lt.length>0,()=>"scheme must not be an empty string.");let xe=Re.getInstance();(0,ie.vA)(xe.managers[Lt]==null,()=>`A model store manager is already registered for scheme '${Lt}'.`),xe.managers[Lt]=ne}static getManager(Lt){let ne=Re.getInstance().managers[Lt];if(ne==null)throw new Error(`Cannot find model manager for scheme '${Lt}'`);return ne}static getSchemes(){return Object.keys(Re.getInstance().managers)}}function Kt(oe){if(oe.indexOf(de)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Re.getSchemes().join(",")}`);return{scheme:oe.split(de)[0],path:oe.split(de)[1]}}function Jt(oe,Lt,ne=!1){return ce(this,null,function*(){(0,ie.vA)(oe!==Lt,()=>`Old path and new path are the same: '${oe}'`);let xe=Tt.getLoadHandlers(oe);(0,ie.vA)(xe.length>0,()=>`Copying failed because no load handler is found for source URL ${oe}.`),(0,ie.vA)(xe.length<2,()=>`Copying failed because more than one (${xe.length}) load handlers for source URL ${oe}.`);let Oe=xe[0],fn=Tt.getSaveHandlers(Lt);(0,ie.vA)(fn.length>0,()=>`Copying failed because no save handler is found for destination URL ${Lt}.`),(0,ie.vA)(fn.length<2,()=>`Copying failed because more than one (${xe.length}) save handlers for destination URL ${Lt}.`);let vn=fn[0],rr=Kt(oe).scheme,pr=Kt(oe).path,Yr=rr===Kt(oe).scheme,qr=yield Oe.load();ne&&Yr&&(yield Re.getManager(rr).removeModel(pr));let xr=yield vn.save(qr);return ne&&!Yr&&(yield Re.getManager(rr).removeModel(pr)),xr.modelArtifactsInfo})}function Ae(){return ce(this,null,function*(){let oe=Re.getSchemes(),Lt={};for(let ne of oe){let xe=yield Re.getManager(ne).listModels();for(let Oe in xe)Lt[ne+de+Oe]=xe[Oe]}return Lt})}function $e(oe){return ce(this,null,function*(){let Lt=Kt(oe);return Re.getManager(Lt.scheme).removeModel(Lt.path)})}function tn(oe,Lt){return ce(this,null,function*(){return Jt(oe,Lt,!1)})}function wn(oe,Lt){return ce(this,null,function*(){return Jt(oe,Lt,!0)})}var Mn=S(6448);class Hn{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(Lt,ne){return fetch(Lt,ne)}now(){return performance.now()}encode(Lt,ne){if(ne!=="utf-8"&&ne!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${ne}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(Lt)}decode(Lt,ne){return new TextDecoder(ne).decode(Lt)}setTimeoutCustom(Lt,ne){typeof window<"u"&&(0,wt._K)().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(Lt),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},ne),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",xe=>{xe.source===window&&xe.data.name===this.messageName&&(xe.stopPropagation(),(0,this.functionRefs[xe.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0))},!0))):setTimeout(Lt,ne)}isTypedArray(Lt){return(0,Mn.Y)(Lt)}}if((0,wt._K)().get("IS_BROWSER")){(0,wt._K)().setPlatform("browser",new Hn);try{Re.registerManager(Sn.URL_SCHEME,new Ze)}catch{}try{Re.registerManager(Bt.URL_SCHEME,new we)}catch{}}let Zn=()=>S(5817),_r;class Sr{constructor(){this.util=S(8590),this.textEncoder=new this.util.TextEncoder}fetch(Lt,ne){return(0,wt._K)().global.fetch!=null?(0,wt._K)().global.fetch(Lt,ne):(_r==null&&(_r=Zn()),_r(Lt,ne))}now(){let Lt=Iu.hrtime();return 1e3*Lt[0]+Lt[1]/1e6}encode(Lt,ne){if(ne!=="utf-8"&&ne!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${ne}`);return this.textEncoder.encode(Lt)}decode(Lt,ne){return Lt.length===0?"":new this.util.TextDecoder(ne).decode(Lt)}isTypedArray(Lt){return this.util.types.isFloat32Array(Lt)||this.util.types.isInt32Array(Lt)||this.util.types.isUint8Array(Lt)||this.util.types.isUint8ClampedArray(Lt)}}(0,wt._K)().get("IS_NODE")&&!(0,wt._K)().get("IS_BROWSER")&&(0,wt._K)().setPlatform("node",new Sr);var Mr=S(448),ai=S(9809),ea=S(125),Pi=S(5295),Cr=S(259);(0,st.Ye)();let Ti={buffer:Mr.r,cast:ai.w,clone:ea.o,print:Pi.y};(0,Cr.Q5)(Ti);var Be=S(5287),En=S(7523),lr=S(9359),qn=S(9258),fr=S(9348),Er=S(5793),Qr=S(5537),vi=S(1830),ua=S(5702);let br=new Map,eo=new Map;class Fo{getClassName(){return this.constructor.className}static fromConfig(Lt,ne){return new Lt(ne)}}class Wa{constructor(){this.classNameMap={}}static getMap(){return Wa.instance==null&&(Wa.instance=new Wa),Wa.instance}static register(Lt){Wa.getMap().classNameMap[Lt.className]=[Lt,Lt.fromConfig]}}function Le(oe,Lt,ne){(0,ie.vA)(oe.className!=null,()=>"Class being registered does not have the static className property defined."),(0,ie.vA)(typeof oe.className=="string",()=>"className is required to be a string, but got type "+typeof oe.className),(0,ie.vA)(oe.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),Lt===void 0&&(Lt="Custom"),ne===void 0&&(ne=oe.className);let xe=Lt+">"+ne;return Wa.register(oe),br.set(xe,oe),eo.set(oe,xe),oe}function bn(oe){return eo.has(oe)?eo.get(oe):oe.className}class jn extends Fo{minimize(Lt,ne=!1,xe){let{value:Oe,grads:fn}=this.computeGradients(Lt,xe);if(xe!=null){let vn=xe.map(rr=>({name:rr.name,tensor:fn[rr.name]}));this.applyGradients(vn)}else this.applyGradients(fn);return(0,Be.AS)(fn),ne?Oe:(Oe.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(Lt,ne){return(0,vi.y7)(Lt,ne)}dispose(){this.iterations_!=null&&(0,Be.AS)(this.iterations_)}saveIterations(){return ce(this,null,function*(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:(0,ua.d)(this.iterations_,"int32")}})}getWeights(){return ce(this,null,function*(){throw new Error("getWeights() is not implemented for this optimizer yet.")})}setWeights(Lt){return ce(this,null,function*(){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)})}extractIterations(Lt){return ce(this,null,function*(){return this.iterations_=(yield Lt[0].tensor.data())[0],Lt.slice(1)})}}Object.defineProperty(jn,Symbol.hasInstance,{value:oe=>oe.minimize!=null&&oe.computeGradients!=null&&oe.applyGradients!=null});class Jn extends jn{static get className(){return"Adadelta"}constructor(Lt,ne,xe=null){super(),this.learningRate=Lt,this.rho=ne,this.epsilon=xe,this.accumulatedGrads=[],this.accumulatedUpdates=[],xe==null&&(this.epsilon=st.T2.backend.epsilon())}applyGradients(Lt){(Array.isArray(Lt)?Lt.map(ne=>ne.name):Object.keys(Lt)).forEach((ne,xe)=>{let Oe=st.T2.registeredVariables[ne],fn=!1;this.accumulatedGrads[xe]==null&&(this.accumulatedGrads[xe]={originalName:`${ne}/accum_grad`,variable:(0,Be.DZ)(()=>(0,Qr.P)(Oe).variable(fn))}),this.accumulatedUpdates[xe]==null&&(this.accumulatedUpdates[xe]={originalName:`${ne}/accum_var`,variable:(0,Be.DZ)(()=>(0,Qr.P)(Oe).variable(fn))});let vn=Array.isArray(Lt)?Lt[xe].tensor:Lt[ne];if(vn==null)return;let rr=this.accumulatedGrads[xe].variable,pr=this.accumulatedUpdates[xe].variable;(0,Be.DZ)(()=>{let Yr=(0,En.W)((0,qn.l)(rr,this.rho),(0,qn.l)((0,Er.E)(vn),1-this.rho)),qr=(0,qn.l)((0,lr.y)((0,fr.R)((0,En.W)(pr,this.epsilon)),(0,fr.R)((0,En.W)(rr,this.epsilon))),vn),xr=(0,En.W)((0,qn.l)(pr,this.rho),(0,qn.l)((0,Er.E)(qr),1-this.rho));rr.assign(Yr),pr.assign(xr);let ma=(0,En.W)((0,qn.l)(qr,-this.learningRate),Oe);Oe.assign(ma)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&((0,Be.AS)(this.accumulatedGrads.map(Lt=>Lt.variable)),(0,Be.AS)(this.accumulatedUpdates.map(Lt=>Lt.variable)))}getWeights(){return ce(this,null,function*(){let Lt=[...this.accumulatedGrads,...this.accumulatedUpdates];return[yield this.saveIterations()].concat(Lt.map(ne=>({name:ne.originalName,tensor:ne.variable})))})}setWeights(Lt){return ce(this,null,function*(){let ne=(Lt=yield this.extractIterations(Lt)).length/2,xe=!1;this.accumulatedGrads=Lt.slice(0,ne).map(Oe=>({originalName:Oe.name,variable:Oe.tensor.variable(xe)})),this.accumulatedUpdates=Lt.slice(ne,2*ne).map(Oe=>({originalName:Oe.name,variable:Oe.tensor.variable(xe)}))})}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(Lt,ne){return new Lt(ne.learningRate,ne.rho,ne.epsilon)}}var dr=S(6111);class Ur extends jn{static get className(){return"Adagrad"}constructor(Lt,ne=.1){super(),this.learningRate=Lt,this.initialAccumulatorValue=ne,this.accumulatedGrads=[]}applyGradients(Lt){(Array.isArray(Lt)?Lt.map(ne=>ne.name):Object.keys(Lt)).forEach((ne,xe)=>{let Oe=st.T2.registeredVariables[ne];this.accumulatedGrads[xe]==null&&(this.accumulatedGrads[xe]={originalName:`${ne}/accumulator`,variable:(0,Be.DZ)(()=>(0,dr.G)(Oe.shape,this.initialAccumulatorValue).variable(!1))});let fn=Array.isArray(Lt)?Lt[xe].tensor:Lt[ne];if(fn==null)return;let vn=this.accumulatedGrads[xe].variable;(0,Be.DZ)(()=>{let rr=(0,En.W)(vn,(0,Er.E)(fn));vn.assign(rr);let pr=(0,En.W)((0,qn.l)((0,lr.y)(fn,(0,fr.R)((0,En.W)(rr,st.T2.backend.epsilon()))),-this.learningRate),Oe);Oe.assign(pr)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&(0,Be.AS)(this.accumulatedGrads.map(Lt=>Lt.variable))}getWeights(){return ce(this,null,function*(){return[yield this.saveIterations()].concat(this.accumulatedGrads.map(Lt=>({name:Lt.originalName,tensor:Lt.variable})))})}setWeights(Lt){return ce(this,null,function*(){Lt=yield this.extractIterations(Lt),this.accumulatedGrads=Lt.map(ne=>({originalName:ne.name,variable:ne.tensor.variable(!1)}))})}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(Lt,ne){return new Lt(ne.learningRate,ne.initialAccumulatorValue)}}var or=S(8990),Yn=S(7126);class li extends jn{static get className(){return"Adam"}constructor(Lt,ne,xe,Oe=null){super(),this.learningRate=Lt,this.beta1=ne,this.beta2=xe,this.epsilon=Oe,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],(0,Be.DZ)(()=>{this.accBeta1=(0,ua.d)(ne).variable(),this.accBeta2=(0,ua.d)(xe).variable()}),Oe==null&&(this.epsilon=st.T2.backend.epsilon())}applyGradients(Lt){let ne=Array.isArray(Lt)?Lt.map(xe=>xe.name):Object.keys(Lt);(0,Be.DZ)(()=>{let xe=(0,Yn.j)(1,this.accBeta1),Oe=(0,Yn.j)(1,this.accBeta2);ne.forEach((fn,vn)=>{let rr=st.T2.registeredVariables[fn],pr=!1;this.accumulatedFirstMoment[vn]==null&&(this.accumulatedFirstMoment[vn]={originalName:`${fn}/m`,variable:(0,Be.DZ)(()=>(0,Qr.P)(rr).variable(pr))}),this.accumulatedSecondMoment[vn]==null&&(this.accumulatedSecondMoment[vn]={originalName:`${fn}/v`,variable:(0,Be.DZ)(()=>(0,Qr.P)(rr).variable(pr))});let Yr=Array.isArray(Lt)?Lt[vn].tensor:Lt[fn];if(Yr==null)return;let qr=this.accumulatedFirstMoment[vn].variable,xr=this.accumulatedSecondMoment[vn].variable,ma=(0,En.W)((0,qn.l)(qr,this.beta1),(0,qn.l)(Yr,1-this.beta1)),ca=(0,En.W)((0,qn.l)(xr,this.beta2),(0,qn.l)((0,Er.E)(Yr),1-this.beta2)),uo=(0,lr.y)(ma,xe),Qo=(0,lr.y)(ca,Oe);qr.assign(ma),xr.assign(ca);let Ps=(0,En.W)((0,qn.l)((0,lr.y)(uo,(0,En.W)((0,fr.R)(Qo),this.epsilon)),-this.learningRate),rr);rr.assign(Ps)}),this.accBeta1.assign((0,qn.l)(this.accBeta1,this.beta1)),this.accBeta2.assign((0,qn.l)(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&(0,Be.AS)(this.accumulatedFirstMoment.map(Lt=>Lt.variable)),this.accumulatedSecondMoment!=null&&(0,Be.AS)(this.accumulatedSecondMoment.map(Lt=>Lt.variable))}getWeights(){return ce(this,null,function*(){let Lt=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[yield this.saveIterations()].concat(Lt.map(ne=>({name:ne.originalName,tensor:ne.variable})))})}setWeights(Lt){return ce(this,null,function*(){Lt=yield this.extractIterations(Lt),(0,Be.DZ)(()=>{this.accBeta1.assign((0,or.n)(this.beta1,this.iterations_+1)),this.accBeta2.assign((0,or.n)(this.beta2,this.iterations_+1))});let ne=Lt.length/2,xe=!1;this.accumulatedFirstMoment=Lt.slice(0,ne).map(Oe=>({originalName:Oe.name,variable:Oe.tensor.variable(xe)})),this.accumulatedSecondMoment=Lt.slice(ne,2*ne).map(Oe=>({originalName:Oe.name,variable:Oe.tensor.variable(xe)}))})}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(Lt,ne){return new Lt(ne.learningRate,ne.beta1,ne.beta2,ne.epsilon)}}var Ki=S(4888),Si=S(178);class Da extends jn{static get className(){return"Adamax"}constructor(Lt,ne,xe,Oe=null,fn=0){super(),this.learningRate=Lt,this.beta1=ne,this.beta2=xe,this.epsilon=Oe,this.decay=fn,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],(0,Be.DZ)(()=>{this.iteration=(0,ua.d)(0).variable(),this.accBeta1=(0,ua.d)(ne).variable()}),Oe==null&&(this.epsilon=st.T2.backend.epsilon())}applyGradients(Lt){let ne=Array.isArray(Lt)?Lt.map(xe=>xe.name):Object.keys(Lt);(0,Be.DZ)(()=>{let xe=(0,Yn.j)(1,this.accBeta1),Oe=(0,lr.y)(-this.learningRate,(0,En.W)((0,qn.l)(this.iteration,this.decay),1));ne.forEach((fn,vn)=>{let rr=st.T2.registeredVariables[fn],pr=!1;this.accumulatedFirstMoment[vn]==null&&(this.accumulatedFirstMoment[vn]={originalName:`${fn}/m`,variable:(0,Qr.P)(rr).variable(pr)}),this.accumulatedWeightedInfNorm[vn]==null&&(this.accumulatedWeightedInfNorm[vn]={originalName:`${fn}/v`,variable:(0,Qr.P)(rr).variable(pr)});let Yr=Array.isArray(Lt)?Lt[vn].tensor:Lt[fn];if(Yr==null)return;let qr=this.accumulatedFirstMoment[vn].variable,xr=this.accumulatedWeightedInfNorm[vn].variable,ma=(0,En.W)((0,qn.l)(qr,this.beta1),(0,qn.l)(Yr,1-this.beta1)),ca=(0,qn.l)(xr,this.beta2),uo=(0,Ki.t)(Yr),Qo=(0,Si.P)(ca,uo);qr.assign(ma),xr.assign(Qo);let Ps=(0,En.W)((0,qn.l)((0,lr.y)(Oe,xe),(0,lr.y)(ma,(0,En.W)(Qo,this.epsilon))),rr);rr.assign(Ps)}),this.iteration.assign((0,En.W)(this.iteration,1)),this.accBeta1.assign((0,qn.l)(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&(0,Be.AS)(this.accumulatedFirstMoment.map(Lt=>Lt.variable)),this.accumulatedWeightedInfNorm!=null&&(0,Be.AS)(this.accumulatedWeightedInfNorm.map(Lt=>Lt.variable))}getWeights(){return ce(this,null,function*(){throw new Error("getWeights() is not implemented for Adamax yet.")})}setWeights(Lt){return ce(this,null,function*(){throw new Error("setWeights() is not implemented for Adamax yet.")})}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(Lt,ne){return new Lt(ne.learningRate,ne.beta1,ne.beta2,ne.epsilon,ne.decay)}}class _i extends jn{static get className(){return"SGD"}constructor(Lt){super(),this.learningRate=Lt,this.setLearningRate(Lt)}applyGradients(Lt){(Array.isArray(Lt)?Lt.map(ne=>ne.name):Object.keys(Lt)).forEach((ne,xe)=>{let Oe=Array.isArray(Lt)?Lt[xe].tensor:Lt[ne];if(Oe==null)return;let fn=st.T2.registeredVariables[ne];(0,Be.DZ)(()=>{let vn=(0,En.W)((0,qn.l)(this.c,Oe),fn);fn.assign(vn)})}),this.incrementIterations()}setLearningRate(Lt){this.learningRate=Lt,this.c!=null&&this.c.dispose(),this.c=(0,Be.aC)((0,ua.d)(-Lt))}dispose(){this.c.dispose()}getWeights(){return ce(this,null,function*(){return[yield this.saveIterations()]})}setWeights(Lt){return ce(this,null,function*(){if((Lt=yield this.extractIterations(Lt)).length!==0)throw new Error("SGD optimizer does not have settable weights.")})}getConfig(){return{learningRate:this.learningRate}}static fromConfig(Lt,ne){return new Lt(ne.learningRate)}}class la extends _i{static get className(){return"Momentum"}constructor(Lt,ne,xe=!1){super(Lt),this.learningRate=Lt,this.momentum=ne,this.useNesterov=xe,this.accumulations=[],this.m=(0,ua.d)(this.momentum)}applyGradients(Lt){(Array.isArray(Lt)?Lt.map(ne=>ne.name):Object.keys(Lt)).forEach((ne,xe)=>{let Oe=st.T2.registeredVariables[ne];this.accumulations[xe]==null&&(this.accumulations[xe]={originalName:`${ne}/momentum`,variable:(0,Be.DZ)(()=>(0,Qr.P)(Oe).variable(!1))});let fn=this.accumulations[xe].variable,vn=Array.isArray(Lt)?Lt[xe].tensor:Lt[ne];vn!=null&&(0,Be.DZ)(()=>{let rr,pr=(0,En.W)((0,qn.l)(this.m,fn),vn);rr=this.useNesterov?(0,En.W)((0,qn.l)(this.c,(0,En.W)(vn,(0,qn.l)(pr,this.m))),Oe):(0,En.W)((0,qn.l)(this.c,pr),Oe),fn.assign(pr),Oe.assign(rr)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&(0,Be.AS)(this.accumulations.map(Lt=>Lt.variable))}setMomentum(Lt){this.momentum=Lt}getWeights(){return ce(this,null,function*(){return[yield this.saveIterations()].concat(this.accumulations.map(Lt=>({name:Lt.originalName,tensor:Lt.variable})))})}setWeights(Lt){return ce(this,null,function*(){Lt=yield this.extractIterations(Lt),this.accumulations=Lt.map(ne=>({originalName:ne.name,variable:ne.tensor.variable(!1)}))})}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(Lt,ne){return new Lt(ne.learningRate,ne.momentum,ne.useNesterov)}}class so extends jn{static get className(){return"RMSProp"}constructor(Lt,ne=.9,xe=0,Oe=null,fn=!1){if(super(),this.learningRate=Lt,this.decay=ne,this.momentum=xe,this.epsilon=Oe,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=fn,Oe==null&&(this.epsilon=st.T2.backend.epsilon()),Lt==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(Lt){(Array.isArray(Lt)?Lt.map(ne=>ne.name):Object.keys(Lt)).forEach((ne,xe)=>{let Oe=st.T2.registeredVariables[ne],fn=!1;this.accumulatedMeanSquares[xe]==null&&(this.accumulatedMeanSquares[xe]={originalName:`${ne}/rms`,variable:(0,Be.DZ)(()=>(0,Qr.P)(Oe).variable(fn))}),this.accumulatedMoments[xe]==null&&(this.accumulatedMoments[xe]={originalName:`${ne}/momentum`,variable:(0,Be.DZ)(()=>(0,Qr.P)(Oe).variable(fn))}),this.accumulatedMeanGrads[xe]==null&&this.centered&&(this.accumulatedMeanGrads[xe]={originalName:`${ne}/mg`,variable:(0,Be.DZ)(()=>(0,Qr.P)(Oe).variable(fn))});let vn=Array.isArray(Lt)?Lt[xe].tensor:Lt[ne];if(vn==null)return;let rr=this.accumulatedMeanSquares[xe].variable,pr=this.accumulatedMoments[xe].variable;(0,Be.DZ)(()=>{let Yr=(0,En.W)((0,qn.l)(rr,this.decay),(0,qn.l)((0,Er.E)(vn),1-this.decay));if(this.centered){let qr=this.accumulatedMeanGrads[xe].variable,xr=(0,En.W)((0,qn.l)(qr,this.decay),(0,qn.l)(vn,1-this.decay)),ma=(0,lr.y)((0,qn.l)(vn,this.learningRate),(0,fr.R)((0,Yn.j)(Yr,(0,En.W)((0,Er.E)(xr),this.epsilon)))),ca=(0,En.W)((0,qn.l)(pr,this.momentum),ma);rr.assign(Yr),qr.assign(xr),pr.assign(ca);let uo=(0,Yn.j)(Oe,ca);Oe.assign(uo)}else{let qr=(0,En.W)((0,qn.l)(rr,this.decay),(0,qn.l)((0,Er.E)(vn),1-this.decay)),xr=(0,En.W)((0,qn.l)(pr,this.momentum),(0,lr.y)((0,qn.l)(vn,this.learningRate),(0,fr.R)((0,En.W)(qr,this.epsilon))));rr.assign(qr),pr.assign(xr);let ma=(0,Yn.j)(Oe,xr);Oe.assign(ma)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&(0,Be.AS)(this.accumulatedMeanSquares.map(Lt=>Lt.variable)),this.accumulatedMeanGrads!=null&&this.centered&&(0,Be.AS)(this.accumulatedMeanGrads.map(Lt=>Lt.variable)),this.accumulatedMoments!=null&&(0,Be.AS)(this.accumulatedMoments.map(Lt=>Lt.variable))}getWeights(){return ce(this,null,function*(){let Lt=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&Lt.push(...this.accumulatedMeanGrads),[yield this.saveIterations()].concat(Lt.map(ne=>({name:ne.originalName,tensor:ne.variable})))})}setWeights(Lt){return ce(this,null,function*(){Lt=yield this.extractIterations(Lt);let ne=this.centered?Lt.length/3:Lt.length/2,xe=!1;this.accumulatedMeanSquares=Lt.slice(0,ne).map(Oe=>({originalName:Oe.name,variable:Oe.tensor.variable(xe)})),this.accumulatedMoments=Lt.slice(ne,2*ne).map(Oe=>({originalName:Oe.name,variable:Oe.tensor.variable(xe)})),this.centered&&(this.accumulatedMeanGrads=Lt.slice(2*ne,3*ne).map(Oe=>({originalName:Oe.name,variable:Oe.tensor.variable(xe)})))})}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(Lt,ne){return new Lt(ne.learningRate,ne.decay,ne.momentum,ne.epsilon,ne.centered)}}let ys=[Jn,Ur,li,Da,la,so,_i];function vs(oe){return new Promise(Lt=>setTimeout(Lt)).then(oe)}let qo=(()=>{class oe{constructor(ne){if(!(0,wt._K)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");ne.startsWith(oe.URL_SCHEME)&&(ne=ne.slice(oe.URL_SCHEME.length)),ne!=null&&ne.length!==0||(ne="model"),this.modelJsonFileName=ne+".json",this.weightDataFileName=ne+".weights.bin"}save(ne){return ce(this,null,function*(){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");let xe=Ft.D.join(ne.weightData),Oe=window.URL.createObjectURL(new Blob([xe],{type:"application/octet-stream"}));if(ne.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let fn=[{paths:["./"+this.weightDataFileName],weights:ne.weightSpecs}],vn=(0,bt.zV)(ne,fn),rr=window.URL.createObjectURL(new Blob([JSON.stringify(vn)],{type:"application/json"})),pr=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(pr.download=this.modelJsonFileName,pr.href=rr,yield vs(()=>pr.dispatchEvent(new MouseEvent("click"))),ne.weightData!=null){let Yr=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;Yr.download=this.weightDataFileName,Yr.href=Oe,yield vs(()=>Yr.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:(0,bt.oR)(ne)}}})}}return oe.URL_SCHEME="downloads://",oe})();class bs{constructor(Lt){if(Lt==null||Lt.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${Lt}`);this.jsonFile=Lt[0],this.weightsFiles=Lt.slice(1)}load(){return ce(this,null,function*(){return new Promise((Lt,ne)=>{let xe=new FileReader;xe.onload=Oe=>{let fn=JSON.parse(Oe.target.result),vn=fn.modelTopology;if(vn==null)return void ne(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));if(fn.weightsManifest==null)return void ne(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));if(this.weightsFiles.length===0)return void Lt({modelTopology:vn});let rr=(0,bt.Ej)(fn,pr=>this.loadWeights(pr));Lt(rr)},xe.onerror=Oe=>ne(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),xe.readAsText(this.jsonFile)})})}loadWeights(Lt){let ne=[],xe=[];for(let vn of Lt)ne.push(...vn.weights),xe.push(...vn.paths);let Oe=this.checkManifestAndWeightFiles(Lt),fn=xe.map(vn=>this.loadWeightsFile(vn,Oe[vn]));return Promise.all(fn).then(vn=>[ne,vn])}loadWeightsFile(Lt,ne){return new Promise((xe,Oe)=>{let fn=new FileReader;fn.onload=vn=>{let rr=vn.target.result;xe(rr)},fn.onerror=vn=>Oe(`Failed to weights data from file of path '${Lt}'.`),fn.readAsArrayBuffer(ne)})}checkManifestAndWeightFiles(Lt){let ne=[],xe=this.weightsFiles.map(fn=>(0,bt.P8)(fn.name)),Oe={};for(let fn of Lt)fn.paths.forEach(vn=>{let rr=(0,bt.P8)(vn);if(ne.indexOf(rr)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${rr}'`);if(ne.push(rr),xe.indexOf(rr)===-1)throw new Error(`Weight file with basename '${rr}' is not provided.`);Oe[vn]=this.weightsFiles[xe.indexOf(rr)]});if(ne.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${ne.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return Oe}}function na(oe){return new bs(oe)}function va(oe,Lt,ne,xe){(function(fn){(0,ie.vA)(fn!=null&&Array.isArray(fn)&&fn.length>0,()=>"promises must be a none empty array")})(oe),function(fn,vn){(0,ie.vA)(fn>=0&&fn<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${fn}`),(0,ie.vA)(vn>=0&&vn<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${vn}`),(0,ie.vA)(vn>=fn,()=>`startFraction must be no more than endFraction, but got startFraction ${fn} and endFraction ${vn}`)}(ne=ne??0,xe=xe??1);let Oe=0;return Promise.all(oe.map(fn=>(fn.then(vn=>{let rr=ne+ ++Oe/oe.length*(xe-ne);return Lt(rr),vn}),fn)))}Tt.registerSaveRouter(oe=>(0,wt._K)().getBool("IS_BROWSER")&&!Array.isArray(oe)&&oe.startsWith(qo.URL_SCHEME)?function(Lt="model"){return new qo(Lt)}(oe.slice(qo.URL_SCHEME.length)):null);var Ya=S(5685);function Xo(oe,Lt){return ce(this,null,function*(){Lt==null&&(Lt={});let ne=Lt.fetchFunc==null?(0,wt._K)().platform.fetch:Lt.fetchFunc,xe=oe.map(fn=>ne(fn,Lt.requestInit,{isBinary:!0})),Oe=(Lt.onProgress==null?yield Promise.all(xe):yield va(xe,Lt.onProgress,0,.5)).map(fn=>fn.arrayBuffer());return Lt.onProgress==null?yield Promise.all(Oe):yield va(Oe,Lt.onProgress,.5,1)})}function Du(oe,Lt="",ne,xe){return ce(this,null,function*(){return uu(Oe=>Xo(Oe,{requestInit:xe}))(oe,Lt,ne)})}function uu(oe){return(Lt,ne="",xe)=>ce(this,null,function*(){let Oe=Lt.map(()=>!1),fn={},vn=xe!=null?xe.map(()=>!1):[],rr=[];if(Lt.forEach((ca,uo)=>{let Qo=0;ca.weights.forEach(Ps=>{let Cg="quantization"in Ps?Ps.quantization.dtype:Ps.dtype,a0=Ya.i[Cg]*ie.Ze(Ps.shape),Pc=()=>{Oe[uo]=!0,fn[uo]==null&&(fn[uo]=[]),fn[uo].push({manifestEntry:Ps,groupOffset:Qo,sizeBytes:a0})};xe!=null?xe.forEach((xv,u2)=>{xv===Ps.name&&(Pc(),vn[u2]=!0)}):Pc(),rr.push(Ps.name),Qo+=a0})}),!vn.every(ca=>ca)){let ca=xe.filter((uo,Qo)=>!vn[Qo]);throw new Error(`Could not find weights in manifest with names: ${ca.join(", ")}. 
Manifest JSON has weights with names: ${rr.join(", ")}.`)}let pr=Oe.reduce((ca,uo,Qo)=>(uo&&ca.push(Qo),ca),[]),Yr=[];pr.forEach(ca=>{Lt[ca].paths.forEach(uo=>{let Qo=ne+(ne.endsWith("/")?"":"/")+uo;Yr.push(Qo)})});let qr=yield oe(Yr),xr={},ma=0;return pr.forEach(ca=>{let uo=Lt[ca].paths.length,Qo=new Ft.D(qr.slice(ma,ma+uo));fn[ca].forEach(Ps=>{let Cg=Qo.slice(Ps.groupOffset,Ps.groupOffset+Ps.sizeBytes),a0=(0,bt.CY)(Cg,[Ps.manifestEntry]);for(let Pc in a0)xr[Pc]=a0[Pc]}),ma+=uo}),xr})}class ws{constructor(Lt,ne){if(this.DEFAULT_METHOD="POST",ne==null&&(ne={}),this.weightPathPrefix=ne.weightPathPrefix,this.weightUrlConverter=ne.weightUrlConverter,ne.fetchFunc!=null?((0,ie.vA)(typeof ne.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=ne.fetchFunc):this.fetch=(0,wt._K)().platform.fetch,(0,ie.vA)(Lt!=null&&Lt.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(Lt)&&(0,ie.vA)(Lt.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${Lt.length}).`),this.path=Lt,ne.requestInit!=null&&ne.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=ne.requestInit||{},this.loadOptions=ne}save(Lt){return ce(this,null,function*(){if(Lt.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let ne=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);ne.body=new FormData;let xe=[{paths:["./model.weights.bin"],weights:Lt.weightSpecs}],Oe=(0,bt.zV)(Lt,xe);if(ne.body.append("model.json",new Blob([JSON.stringify(Oe)],{type:"application/json"}),"model.json"),Lt.weightData!=null){let vn=Ft.D.join(Lt.weightData);ne.body.append("model.weights.bin",new Blob([vn],{type:"application/octet-stream"}),"model.weights.bin")}let fn=yield this.fetch(this.path,ne);if(fn.ok)return{modelArtifactsInfo:(0,bt.oR)(Lt),responses:[fn]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${fn.status}.`)})}loadModelJSON(){return ce(this,null,function*(){let Lt=yield this.fetch(this.path,this.requestInit);if(!Lt.ok)throw new Error(`Request to ${this.path} failed with status code ${Lt.status}. Please verify this URL points to the model JSON of the model to load.`);let ne;try{ne=yield Lt.json()}catch{let vn=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?vn+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":vn+=" Please make sure the server is serving valid JSON for this request.",new Error(vn)}let xe=ne.modelTopology,Oe=ne.weightsManifest;if(xe==null&&Oe==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return ne})}load(){return ce(this,null,function*(){if(this.loadOptions.streamWeights)return this.loadStream();let Lt=yield this.loadModelJSON();return(0,bt.Ej)(Lt,ne=>this.loadWeights(ne))})}loadStream(){return ce(this,null,function*(){let Lt=yield this.loadModelJSON(),ne=yield this.getWeightUrls(Lt.weightsManifest),xe=(0,bt.Xf)(Lt.weightsManifest);return Object.assign(Object.assign({},Lt),{weightSpecs:xe,getWeightStream:()=>function(Oe,fn){var vn;let rr=fn.fetchFunc==null?(0,wt._K)().platform.fetch:fn.fetchFunc,pr,Yr=0;return(vn=fn.onProgress)===null||vn===void 0||vn.call(fn,0),new ReadableStream({pull:qr=>ce(this,null,function*(){for(var xr;Yr<Oe.length;){pr||(pr=(yield rr(Oe[Yr],fn.requestInit,{isBinary:!0})).body.getReader());let{done:ma,value:ca}=yield pr.read();if(!ma)return void qr.enqueue(ca);Yr++,pr=void 0,(xr=fn.onProgress)===null||xr===void 0||xr.call(fn,Yr/Oe.length)}qr.close()})})}(ne,this.loadOptions)})})}getWeightUrls(Lt){return ce(this,null,function*(){let ne=Array.isArray(this.path)?this.path[1]:this.path,[xe,Oe]=function(pr){let Yr=pr.lastIndexOf("/"),qr=pr.lastIndexOf("?"),xr=pr.substring(0,Yr),ma=qr>Yr?pr.substring(qr):"";return[xr+"/",ma]}(ne),fn=this.weightPathPrefix||xe,vn=[],rr=[];for(let pr of Lt)for(let Yr of pr.paths)this.weightUrlConverter!=null?rr.push(this.weightUrlConverter(Yr)):vn.push(fn+Yr+Oe);return this.weightUrlConverter&&vn.push(...yield Promise.all(rr)),vn})}loadWeights(Lt){return ce(this,null,function*(){let ne=yield this.getWeightUrls(Lt);return[(0,bt.Xf)(Lt),yield Xo(ne,this.loadOptions)]})}}function Ra(oe){return oe.match(ws.URL_SCHEME_REGEX)!=null}ws.URL_SCHEME_REGEX=/^https?:\/\//;let Ru=(oe,Lt)=>{if(typeof fetch>"u"&&(Lt==null||Lt.fetchFunc==null))return null;{let ne=!0;if(ne=Array.isArray(oe)?oe.every(xe=>Ra(xe)):Ra(oe),ne)return Ko(oe,Lt)}return null};function Ko(oe,Lt){return new ws(oe,Lt)}function Ga(oe,Lt){return Ko(oe,Lt)}Tt.registerSaveRouter(Ru),Tt.registerLoadRouter(Ru);class Fu{constructor(Lt){this.modelArtifacts=Lt}load(){return this.modelArtifacts}}class Zs{constructor(Lt){this.saveHandler=Lt}save(Lt){return this.saveHandler(Lt)}}class Rc{constructor(Lt){Lt.load&&(this.load=()=>Promise.resolve(Lt.load())),Lt.save&&(this.save=ne=>Promise.resolve(Lt.save(ne)))}}function bu(oe,Lt,ne,xe){return new Rc(Qs(...arguments))}function Qs(oe,Lt,ne,xe){return arguments.length===1?oe.modelTopology!=null||oe.weightSpecs!=null?new Fu(oe):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Fu({modelTopology:oe})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Fu({modelTopology:oe,weightSpecs:Lt,weightData:ne,trainingConfig:xe}))}function wu(oe){return new Zs(oe)}function Tl(oe){return new Zs(oe)}var Zo=S(8189),ji=S(5703),Ku=S(1760),Zu=S(929),xs=S(7703);let xu=(0,Zu.op)({confusionMatrix_:function(oe,Lt,ne){let xe=(0,Zo.YT)(oe,"labels","confusionMatrix"),Oe=(0,Zo.YT)(Lt,"predictions","confusionMatrix");ie.vA(ne==null||ne>0&&Number.isInteger(ne),()=>`If provided, numClasses must be a positive integer, but got ${ne}`),ie.vA(xe.rank===1,()=>`Expected the rank of labels to be 1, but got ${xe.rank}`),ie.vA(Oe.rank===1,()=>`Expected the rank of predictions to be 1, but got ${Oe.rank}`),ie.vA(xe.shape[0]===Oe.shape[0],()=>`Mismatch in the number of examples: ${xe.shape[0]} vs. ${Oe.shape[0]}. Labels and predictions should have the same number of elements.`),ie.vA(ne>0&&Number.isInteger(ne),()=>`numClasses is required to be a positive integer, but got ${ne}`);let fn=(0,Ku.M)((0,ai.w)(xe,"int32"),ne),vn=(0,Ku.M)((0,ai.w)(Oe,"int32"),ne),rr=(0,xs.m)(fn),pr=(0,ji.N)(rr,vn);return(0,ai.w)(pr,"int32")}});var pa=S(2198),_n=S(5441),ls=S(7074),Dt=S(2768);let Zt,Ce=!1;function le(oe,Lt=3){if(Lt>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(oe==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let ne=!1,xe=!1,Oe=!1,fn=!1,vn=!1,rr=!1;if(oe.data instanceof Uint8Array)ne=!0;else if(typeof ImageData<"u"&&oe instanceof ImageData)xe=!0;else if(typeof HTMLVideoElement<"u"&&oe instanceof HTMLVideoElement)Oe=!0;else if(typeof HTMLImageElement<"u"&&oe instanceof HTMLImageElement)fn=!0;else if(oe.getContext!=null)vn=!0;else{if(!(typeof ImageBitmap<"u"&&oe instanceof ImageBitmap))throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${oe.constructor.name}`);rr=!0}if((0,ls._5)(_n.awo,st.T2.backendName)!=null){let ca={pixels:oe},uo={numChannels:Lt};return st.T2.runKernel(_n.awo,ca,uo)}let[pr,Yr]=Oe?[oe.videoWidth,oe.videoHeight]:[oe.width,oe.height],qr,xr;if(vn)qr=oe.getContext("2d").getImageData(0,0,pr,Yr).data;else if(xe||ne)qr=oe.data;else if(fn||Oe||rr){if(Zt==null)if(typeof document>"u"){if(typeof OffscreenCanvas>"u"||typeof OffscreenCanvasRenderingContext2D>"u")throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");Zt=new OffscreenCanvas(1,1).getContext("2d")}else Zt=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Zt.canvas.width=pr,Zt.canvas.height=Yr,Zt.drawImage(oe,0,0,pr,Yr),qr=Zt.getImageData(0,0,pr,Yr).data}if(Lt===4)xr=new Int32Array(qr);else{let ca=pr*Yr;xr=new Int32Array(ca*Lt);for(let uo=0;uo<ca;uo++)for(let Qo=0;Qo<Lt;++Qo)xr[uo*Lt+Qo]=qr[4*uo+Qo]}let ma=[Yr,pr,Lt];return(0,Dt.$)(xr,ma,"int32")}function Pe(oe){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")&&!(oe instanceof ImageBitmap)&&function(Lt){return Lt!=null&&Lt.width!==0&&Lt.height!==0}(oe)&&!function(Lt){return Lt!=null&&Lt.data instanceof Uint8Array}(oe)}function rn(oe,Lt=3){return ce(this,null,function*(){let ne=null;if((0,wt._K)().getBool("WRAP_TO_IMAGEBITMAP")&&Pe(oe)){let xe;try{xe=yield createImageBitmap(oe,{premultiplyAlpha:"none"})}catch{xe=null}ne=xe!=null&&xe.width===oe.width&&xe.height===oe.height?xe:oe}else ne=oe;return le(ne,Lt)})}function Cn(oe){if(oe.rank!==2&&oe.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${oe.rank}.`);let Lt=oe.rank===2?1:oe.shape[2];if(Lt>4||Lt===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${Lt}`);if(oe.dtype!=="float32"&&oe.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${oe.dtype}. Please use float32 or int32 tensors.`)}function Vn(oe,Lt){return ce(this,null,function*(){let ne=(0,Zo.YT)(oe,"img","toPixels");if(!(oe instanceof Cr.qY)){let Yr=ne;ne=(0,ai.w)(Yr,"int32"),Yr.dispose()}Cn(ne);let[xe,Oe]=ne.shape.slice(0,2),fn=ne.rank===2?1:ne.shape[2],vn=yield ne.data(),rr=ne.dtype==="float32"?255:1,pr=new Uint8ClampedArray(Oe*xe*4);for(let Yr=0;Yr<xe*Oe;++Yr){let qr=[0,0,0,255];for(let ma=0;ma<fn;ma++){let ca=vn[Yr*fn+ma];if(ne.dtype==="float32"){if(ca<0||ca>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${ca}.`)}else if(ne.dtype==="int32"&&(ca<0||ca>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${ca}.`);fn===1?(qr[0]=ca*rr,qr[1]=ca*rr,qr[2]=ca*rr):qr[ma]=ca*rr}let xr=4*Yr;pr[xr+0]=Math.round(qr[0]),pr[xr+1]=Math.round(qr[1]),pr[xr+2]=Math.round(qr[2]),pr[xr+3]=Math.round(qr[3])}if(Lt!=null){Ce||(0,ls._5)(_n.XmO,st.T2.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),Ce=!0),Lt.width=Oe,Lt.height=xe;let Yr=Lt.getContext("2d"),qr=new ImageData(pr,Oe,xe);Yr.putImageData(qr,0,0)}return ne!==oe&&ne.dispose(),pr})}function hr(oe,Lt,ne){let xe=(0,Zo.YT)(oe,"img","draw");if(!(oe instanceof Cr.qY)){let vn=xe;xe=(0,ai.w)(vn,"int32"),vn.dispose()}Cn(xe),function(vn){let rr=vn?.alpha||1;if(rr>1||rr<0)throw new Error(`Alpha value ${rr} is suppoed to be in range [0 - 1].`)}(ne?.imageOptions);let Oe={image:xe},fn={canvas:Lt,options:ne};st.T2.runKernel(_n.XmO,Oe,fn)}let Kr=(0,Zu.op)({fromPixels_:le});function $i(oe,Lt){let ne=oe.shape.length,xe=Lt.shape.length;if(ne<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${ne}.`);if(xe<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${xe}.`);if(Lt.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${Lt.dtype}.`);if(Lt.shape[xe-1]>ne)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${Lt.shape[xe-1]} vs. ${ne}`);if((0,ie.Ze)(oe.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${oe.shape}.`);let Oe=Lt.shape,fn=Oe[Oe.length-1],vn=1;for(let xr=0;xr<Oe.length-1;++xr)vn*=Oe[xr];let rr=oe.shape,pr=Oe.slice();pr.pop();let Yr=1;for(let xr=fn;xr<ne;++xr)Yr*=rr[xr],pr.push(rr[xr]);let qr=[...(0,ie.Ur)(oe.shape).map(xr=>xr/Yr),1].slice(0,fn);return[pr,vn,Yr,qr]}var Ai=S(6170),Rr=S(4969),Jr=S(565),di=S(3879);let bi=.001,Ci=.1;function ra(oe,Lt,ne){return ne==null&&(ne=oa()),Wr(oe,Lt,(xe,Oe)=>Ea(xe,Oe,ne))}function oa(){return st.T2.backend.floatPrecision()===32?bi:Ci}function Wr(oe,Lt,ne){let xe=!0;if(((0,di.isTypedArray)(oe)||(0,di.isTypedArray)(Lt))&&(xe=!1),(0,di.isTypedArray)(oe)&&(0,di.isTypedArray)(Lt)&&(xe=!0),xe){let vn=oe.constructor.name,rr=Lt.constructor.name;if(vn!==rr)throw new Error(`Arrays are of different type. Actual: ${vn}. Expected: ${rr}`)}if(Array.isArray(oe)&&Array.isArray(Lt)){let vn=(0,Zo.MZ)(oe),rr=(0,Zo.MZ)(Lt);if(!(0,ie.r1)(vn,rr))throw new Error(`Arrays have different shapes. Actual: [${vn}]. Expected: [${rr}]`)}let Oe=(0,di.isTypedArray)(oe)?oe:(0,di.flatten)(oe),fn=(0,di.isTypedArray)(Lt)?Lt:(0,di.flatten)(Lt);if(Oe.length!==fn.length)throw new Error(`Arrays have different lengths actual: ${Oe.length} vs expected: ${fn.length}.
Actual:   ${Oe}.
Expected: ${fn}.`);for(let vn=0;vn<fn.length;++vn){let rr=Oe[vn],pr=fn[vn];if(!ne(rr,pr))throw new Error(`Arrays differ: actual[${vn}] = ${rr}, expected[${vn}] = ${pr}.
Actual:   ${Oe}.
Expected: ${fn}.`)}typeof expect<"u"&&expect().nothing()}function _a(oe,Lt){oe().then(()=>Lt.fail(),()=>Lt()),typeof expect<"u"&&expect().nothing()}function Ca(oe,Lt){let ne=typeof Lt=="string"||typeof Lt=="number"||typeof Lt=="boolean"?[Lt]:Lt;return(0,ie.Kg)(oe)||(0,ie.Kg)(oe[0])||(0,ie.Kg)(Lt)||(0,ie.Kg)(Lt[0])?Wr(oe,ne,(xe,Oe)=>xe==Oe):Wr(oe,Lt,(xe,Oe)=>Ea(xe,Oe,0))}function Gi(oe,Lt,ne){if(ne==null&&(ne=oa()),!Ea(oe,Lt,ne))throw new Error(`Numbers differ: actual === ${oe}, expected === ${Lt}`);typeof expect<"u"&&expect().nothing()}function Ea(oe,Lt,ne){return!isFinite(oe)&&!isFinite(Lt)||!(isNaN(oe)||isNaN(Lt)||Math.abs(oe-Lt)>ne)}function Ta(oe,Lt,ne){for(let xe=0;xe<oe.length;xe++)if(oe[xe]<Lt||oe[xe]>ne)throw new Error(`Value out of range:${oe[xe]} low: ${Lt}, high: ${ne}`)}function Dn(oe,Lt){let ne=new Float32Array(oe),xe=new Float32Array(Lt);if(ne.length!==xe.length)throw new Error(`Expected ArrayBuffer to be of length ${xe.length}, but it was ${ne.length}`);for(let Oe=0;Oe<xe.length;Oe++)if(ne[Oe]!==xe[Oe])throw new Error(`Expected ArrayBuffer value at ${Oe} to be ${xe[Oe]} but got ${ne[Oe]} instead`)}function Ui(oe){for(let Lt=0;Lt<oe.length;Lt++){let ne=oe[Lt];Array.isArray(ne)?Ui(ne):oe[Lt]=(0,di.encodeString)(ne)}return oe}function sa(oe){let Lt=document.createElement("video");return"playsInline"in Lt&&(Lt.playsInline=!0),Lt.muted=!0,Lt.loop=!0,Lt.style.position="fixed",Lt.style.left="0px",Lt.style.top="0px",Lt.preload="auto",Lt.appendChild(oe),new Promise(ne=>{Lt.addEventListener("loadeddata",xe=>ne(Lt)),Lt.load()})}function ks(oe){return ce(this,null,function*(){yield oe.play(),"requestVideoFrameCallback"in oe&&(yield new Promise(Lt=>{oe.requestVideoFrameCallback(Lt)}))})}let Po="4.22.0";class ku{static sgd(Lt){return new _i(Lt)}static momentum(Lt,ne,xe=!1){return new la(Lt,ne,xe)}static rmsprop(Lt,ne=.9,xe=0,Oe=null,fn=!1){return new so(Lt,ne,xe,Oe,fn)}static adam(Lt=.001,ne=.9,xe=.999,Oe=null){return new li(Lt,ne,xe,Oe)}static adadelta(Lt=.001,ne=.95,xe=null){return new Jn(Lt,ne,xe)}static adamax(Lt=.002,ne=.9,xe=.999,Oe=null,fn=0){return new Da(Lt,ne,xe,Oe,fn)}static adagrad(Lt,ne=.1){return new Ur(Lt,ne)}}var io=S(2046),an=S(7270),Ms=S(4703);let lu=ku,Ul=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:oe=>oe();function Ou(){return new Promise(oe=>Ul(()=>oe()))}var Lu=S(1078);function Ed(oe,Lt){let ne=oe[0].length;oe.forEach((Oe,fn)=>{ie.vA(Oe.length===ne,()=>`Error in concat${ne}D: rank of tensors[${fn}] must be the same as the rank of the rest (${ne})`)}),ie.vA(Lt>=0&&Lt<ne,()=>`Error in concat${ne}D: axis must be between 0 and ${ne-1}.`);let xe=oe[0];oe.forEach((Oe,fn)=>{for(let vn=0;vn<ne;vn++)ie.vA(vn===Lt||Oe[vn]===xe[vn],()=>`Error in concat${ne}D: Shape of tensors[${fn}] (${Oe}) does not match the shape of the rest (${xe}) along the non-concatenated axis ${fn}.`)})}function Fc(oe,Lt){let ne=oe[0].slice();for(let xe=1;xe<oe.length;xe++)ne[Lt]+=oe[xe][Lt];return ne}var ni,Zr=S(7195),Qu=S(8646);function Wl(oe,Lt,ne){let xe=new Array;if(ne==null&&Lt==null)return xe;if(Lt==null)for(;xe.length<oe+ne.length;)xe.push(-1);else xe=Lt.slice();if(ne==null)return xe;if(oe+ne.length!==xe.length)throw new Error(`rt input.shape and shape=${Lt} are incompatible: rt input.rank = ${oe+ne.length}, but shape.rank = ${xe.length}`);for(let Oe=1;Oe<ne.length;++Oe){let fn=ne[Oe],vn=xe[xe.length-ne.length+Oe],rr=xe[vn];if(fn>=0)if(rr>=0){if(rr!==fn)throw new Error(`rt input.shape and shape=${Lt} are incompatible: rt input.shape[${Oe+oe}] = ${fn} but shape[${Oe+oe}] = ${rr}`)}else xe[vn]=fn}return xe}function Yh(oe){let Lt={FIRST_DIM_SIZE:ni.FIRST_DIM_SIZE,VALUE_ROWIDS:ni.VALUE_ROWIDS,ROW_LENGTHS:ni.ROW_LENGTHS,ROW_SPLITS:ni.ROW_SPLITS,ROW_LIMITS:ni.ROW_LIMITS,ROW_STARTS:ni.ROW_STARTS},ne=[];for(let xe of oe){if(!(xe in Lt))break;ne.push(Lt[xe])}return ne}function Ba(oe){return oe.length===0?0:oe[0]===ni.FIRST_DIM_SIZE?oe.length-1:oe.length}function $s(oe,Lt){if(oe==null||Lt==null)return;let ne=oe.length,xe=Lt.length;if(ne>=xe)throw new Error(`defaultValue.shape=${oe} and ragged tensor flatValues.shape=${Lt}, are incompatible: defaultValue.rank = ${ne} must be less than ragged tensor input flatValues.rank = ${xe})`);for(let Oe=0;Oe<Math.min(ne,xe-1);++Oe){let fn=oe[Oe],vn=Lt[Oe+1];if(fn>=0&&vn>=0&&fn!==1&&fn!==vn)throw new Error(`defaultValue.shape=${oe}, and ragged tensor input flatValues.shape=${Lt} are incompatible: defaultValue.shape[${Oe-oe.length}] = ${fn} but ragged tensor input.flatValues.shape[${Oe-oe.length}] = ${vn}`)}}(function(oe){oe[oe.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",oe[oe.VALUE_ROWIDS=1]="VALUE_ROWIDS",oe[oe.ROW_LENGTHS=2]="ROW_LENGTHS",oe[oe.ROW_SPLITS=3]="ROW_SPLITS",oe[oe.ROW_LIMITS=4]="ROW_LIMITS",oe[oe.ROW_STARTS=5]="ROW_STARTS"})(ni||(ni={}));let Oc=30;function oc(oe){return oe<=Oc?oe:(0,ie.lK)(oe,Math.floor(Math.sqrt(oe)))}function sc(oe,Lt,ne){return[ne*(typeof oe=="number"?oe:oe[0]),Lt*(typeof oe=="number"?oe:oe[1])]}function Lc(oe,Lt,ne,xe=!0){let Oe=[];if(xe)Oe=Oe.concat(Lt.slice(0)),Oe.push(oe[0]/ne),Oe=Oe.concat(oe.slice(1));else{Oe=Oe.concat(oe[0]);let fn=Lt.length;for(let vn=0;vn<fn;++vn)Oe=Oe.concat([oe[vn+1]/Lt[vn],Lt[vn]]);Oe=Oe.concat(oe.slice(fn+1))}return Oe}function Ju(oe,Lt,ne=!0){let xe=[];if(ne){xe.push(Lt);for(let Oe=Lt+1;Oe<oe;++Oe)Oe<=2*Lt?(xe.push(Oe),xe.push(Oe-(Lt+1))):xe.push(Oe)}else{let Oe=[],fn=[];for(let vn=1;vn<oe;++vn)vn>=2*Lt+1||vn%2==1?fn.push(vn):Oe.push(vn);xe.push(...Oe),xe.push(0),xe.push(...fn)}return xe}function ph(oe,Lt,ne,xe=!0){let Oe=[];xe?Oe.push(oe[0]/ne):Oe.push(oe[0]*ne);for(let fn=1;fn<oe.length;++fn)fn<=Lt.length?xe?Oe.push(Lt[fn-1]*oe[fn]):Oe.push(oe[fn]/Lt[fn-1]):Oe.push(oe[fn]);return Oe}function $c(oe,Lt){let ne=[0];for(let xe=0;xe<Lt;++xe)ne.push(oe[xe][0]);return ne}function uc(oe,Lt,ne){let xe=oe.slice(0,1);for(let Oe=0;Oe<ne;++Oe)xe.push(oe[Oe+1]-Lt[Oe][0]-Lt[Oe][1]);return xe}var yt=S(8576);let D=.3275911,U=.254829592,et=-.284496736,ut=1.421413741,pt=-1.453152027,mt=1.061405429;var At=S(3673);function zt(oe,Lt){if(oe.length!==Lt.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${oe.length}, imag: ${Lt.length}.`);let ne=new Float32Array(2*oe.length);for(let xe=0;xe<ne.length;xe+=2)ne[xe]=oe[xe/2],ne[xe+1]=Lt[xe/2];return ne}function pe(oe){let Lt=new Float32Array(oe.length/2),ne=new Float32Array(oe.length/2);for(let xe=0;xe<oe.length;xe+=2)Lt[xe/2]=oe[xe],ne[xe/2]=oe[xe+1];return{real:Lt,imag:ne}}function We(oe){let Lt=Math.ceil(oe.length/4),ne=new Float32Array(Lt),xe=new Float32Array(Lt);for(let Oe=0;Oe<oe.length;Oe+=4)ne[Math.floor(Oe/4)]=oe[Oe],xe[Math.floor(Oe/4)]=oe[Oe+1];return{real:ne,imag:xe}}function Ke(oe){let Lt=Math.floor(oe.length/4),ne=new Float32Array(Lt),xe=new Float32Array(Lt);for(let Oe=2;Oe<oe.length;Oe+=4)ne[Math.floor(Oe/4)]=oe[Oe],xe[Math.floor(Oe/4)]=oe[Oe+1];return{real:ne,imag:xe}}function Tn(oe,Lt){return{real:oe[2*Lt],imag:oe[2*Lt+1]}}function nn(oe,Lt,ne,xe){oe[2*xe]=Lt,oe[2*xe+1]=ne}function un(oe,Lt){let ne=new Float32Array(oe/2),xe=new Float32Array(oe/2);for(let Oe=0;Oe<Math.ceil(oe/2);Oe++){let fn=(Lt?2:-2)*Math.PI*(Oe/oe);ne[Oe]=Math.cos(fn),xe[Oe]=Math.sin(fn)}return{real:ne,imag:xe}}function zn(oe,Lt,ne){let xe=(ne?2:-2)*Math.PI*(oe/Lt);return{real:Math.cos(xe),imag:Math.sin(xe)}}let In="->",Or=/->/g,oi=",",ur="...";function Na(oe,Lt){let ne=((oe=oe.replace(/\s/g,"")).length-oe.replace(Or,"").length)/In.length;if(ne<1)throw new Error("Equations without an arrow are not supported.");if(ne>1)throw new Error(`Equation must contain exactly one arrow ("${In}").`);let[xe,Oe]=oe.split(In);(0,ie.vA)(xe.indexOf(ur)===-1,()=>`The ellipsis notation ("${ur}") is not supported yet.`);let fn=xe.split(oi),vn=fn.length;if(Lt!==vn)throw new Error(`Expected ${vn} input tensors, received ${Lt}`);if(vn>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");let rr=[];for(let xr=0;xr<Oe.length;++xr){let ma=Oe[xr];if(!fn.some(ca=>ca.indexOf(ma)!==-1))throw new Error(`Output subscripts contain the label ${ma} not present in the input subscripts.`);rr.indexOf(ma)===-1&&rr.push(ma)}for(let xr=0;xr<xe.length;++xr){let ma=xe[xr];rr.indexOf(ma)===-1&&ma!==oi&&rr.push(ma)}let pr=new Array(fn.length);for(let xr=0;xr<vn;++xr){if(new Set(fn[xr].split("")).size!==fn[xr].length)throw new Error(`Found duplicate axes in input component ${fn[xr]}. Support for duplicate axes in input is not implemented yet.`);pr[xr]=[];for(let ma=0;ma<fn[xr].length;++ma)pr[xr].push(rr.indexOf(fn[xr][ma]))}let Yr=rr.length,qr=[];for(let xr=Oe.length;xr<Yr;++xr)qr.push(xr);return{allDims:rr,summedDims:qr,idDims:pr}}function fi(oe,Lt){let ne=new Array(oe);ne.fill(-1);for(let Oe=0;Oe<Lt.length;++Oe)ne[Lt[Oe]]=Oe;let xe=[];for(let Oe=0;Oe<oe;++Oe)ne[Oe]===-1&&xe.push(Oe);return ne=ne.filter(Oe=>Oe!==-1),{permutationIndices:ne,expandDims:xe}}function Lr(oe,Lt,ne){let xe=new Array(oe);for(let Oe=0;Oe<ne.length;++Oe){let fn=ne[Oe].shape;for(let vn=0;vn<Lt[Oe].length;++vn)xe[Lt[Oe][vn]]===void 0?xe[Lt[Oe][vn]]=fn[vn]:(0,ie.vA)(xe[Lt[Oe][vn]]===fn[vn],()=>`Expected dimension ${xe[Lt[Oe][vn]]} at axis ${vn} of input shaped ${JSON.stringify(fn)}, but got dimension ${fn[vn]}`)}}function wi(oe,Lt){let ne=oe,xe=[],Oe=0;oe.length===0&&ne.push(-1),Oe=oe.length+1;for(let vn=0;vn<Oe;++vn)xe.push([]);let fn=[];for(let vn=0;vn<ne.length;++vn){let rr=Js(Lt,ne[vn]);for(let pr of rr)fn.indexOf(pr)===-1&&(xe[vn].push(pr),fn.push(pr))}return{path:ne,steps:xe}}function cs(oe){return oe.every((Lt,ne)=>Lt===ne)}function Js(oe,Lt){let ne=[];for(let xe=0;xe<oe.length;++xe)oe[xe].length!==0&&oe[xe].indexOf(Lt)===-1&&Lt!==-1||ne.push(xe);return ne}function zs(oe,Lt,ne=0){let xe=[];if(typeof Lt=="number")(0,ie.vA)(oe.shape[ne]%Lt==0,()=>"Number of splits must evenly divide the axis."),xe=new Array(Lt).fill(oe.shape[ne]/Lt);else{let Oe=Lt.reduce((vn,rr)=>(rr===-1&&(vn+=1),vn),0);(0,ie.vA)(Oe<=1,()=>"There should be only one negative value in split array.");let fn=Lt.indexOf(-1);if(fn!==-1){let vn=Lt.reduce((rr,pr)=>pr>0?rr+pr:rr);Lt[fn]=oe.shape[ne]-vn}(0,ie.vA)(oe.shape[ne]===Lt.reduce((vn,rr)=>vn+rr),()=>"The sum of sizes must match the size of the axis dimension."),xe=Lt}return xe}function pi(oe){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${oe}`}function cu(oe,Lt){return`indices(${oe}, 0) is invalid: ${Lt} < 0`}function Vl(oe,Lt,ne){return`indices(${oe}, 0) is invalid: ${Lt} >= ${ne}`}function Al(oe,Lt){return`only one output dimension may be -1, not both ${oe} and ${Lt}`}function yw(oe,Lt){return`size ${oe} must be non-negative, not ${Lt}`}function zc(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function r0(oe,Lt){return`Input to reshape is a SparseTensor with ${(0,ie.Ze)(oe)}
  dense values, but the requested shape requires a multiple of ${(0,ie.Ze)(Lt)}. inputShape=${oe} outputShape= ${Lt}`}function vw(oe,Lt){return`Input to reshape is a tensor with ${(0,ie.Ze)(oe)} dense values, but the requested shape has ${(0,ie.Ze)(Lt)}. inputShape=${oe} outputShape=${Lt}`}function mh(){return"segment ids must be >= 0"}function Gl(){return"segment ids are not increasing"}function yn(oe,Lt){return`Segment id ${oe} out of range [0, ${Lt}), possibly because segmentIds input is not sorted.`}function Wi(oe,Lt,ne){return`Bad: indices[${oe}] == ${Lt} out of range [0, ${ne})`}function bv(oe,Lt){let ne,xe=!1;for(oe<=Oc?(ne=oe,xe=!0):ne=(0,ie.lK)(oe,Math.floor(Math.sqrt(oe)));!xe;)ne>Lt||ne===oe?xe=!0:ne=(0,ie.lK)(oe,ne+1);return ne}function bw(oe,Lt,ne){let xe=[],Oe=oe.length;for(let fn=0;fn<Oe;fn++)fn!==Lt?xe.push(oe[fn]):xe.push(ne);return xe}function i0(oe,Lt,ne,xe){let Oe=Lt.shape.length,fn=oe.shape.length;if(xe!==0&&(xe<-Oe||xe>Oe))throw new Error(`Expect batchDims in the range of [-${Oe}, ${Oe}], but got ${xe}`);if(xe<0&&(xe+=Oe),xe>fn)throw new Error(`batchDims (${xe}) must be less than rank(x) (
    ${fn}).`);if(ne<xe)throw new Error(`batchDims (${xe}) must be less than or equal to axis (${ne}).`);for(let xr=0;xr<xe;++xr)if(oe.shape[xr]!==Lt.shape[xr])throw new Error(`x.shape[${xr}]: ${oe.shape[xr]} should be equal to indices.shape[${xr}]: ${Lt.shape[xr]}.`);let vn=oe.shape[ne],rr=[],pr=1,Yr=1,qr=1;for(let xr=0;xr<xe;++xr)rr.push(oe.shape[xr]),pr*=oe.shape[xr];for(let xr=xe;xr<ne;xr++)rr.push(oe.shape[xr]),Yr*=oe.shape[xr];for(let xr=xe;xr<Oe;xr++)rr.push(Lt.shape[xr]);for(let xr=ne+1;xr<fn;xr++)rr.push(oe.shape[xr]),qr*=oe.shape[xr];return{batchSize:pr,sliceSize:qr,outerSize:Yr,dimSize:vn,outputShape:rr}}function qh(oe){try{return oe.map(Lt=>(0,di.decodeString)(Lt))}catch(Lt){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${Lt}`)}}function wv(oe){return oe.map(Lt=>(0,di.encodeString)(Lt))}var $u=S(8360),xo=S(4411),Xh=S(5149);(function(){for(let oe of ys)Le(oe)})()},6734:(L,O,S)=>{S.d(O,{D:()=>j});var B=S(3879);class j{static join(Z){return new j(Z).slice()}constructor(Z){if(this.shards=[],this.previousShardIndex=0,Z==null||(Z instanceof Array||(Z=[Z]),(Z=Z.map(X=>B.isTypedArray(X)?X.buffer:X)).length===0))return;this.bufferUniformSize=Z[0].byteLength;let Y=0;for(let X=0;X<Z.length;X++){let J=Z[X];X!==Z.length-1&&J.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let q=Y+J.byteLength;this.shards.push({buffer:J,start:Y,end:q}),Y=q}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(Z=0,Y=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(Z=isNaN(Number(Z))?0:Z,Y=isNaN(Number(Y))?0:Y,Z=Math.max(0,Z),(Y=Math.min(this.byteLength,Y))<=Z)return new ArrayBuffer(0);let X=this.findShardForByte(Z);if(X===-1)throw new Error(`Could not find start shard for byte ${Z}`);let J=new ArrayBuffer(Y-Z),q=new Uint8Array(J),H=0;for(let tt=X;tt<this.shards.length;tt++){let st=this.shards[tt],lt=Z+H-st.start,ft=H,gt=Math.min(Y,st.end)-st.start,xt=new Uint8Array(st.buffer,lt,gt-lt);if(q.set(xt,ft),H+=xt.length,Y<st.end)break}return J}findShardForByte(Z){if(this.shards.length===0||Z<0||Z>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(Z/this.bufferUniformSize),this.previousShardIndex;function Y(J){return Z<J.start?-1:Z>=J.end?1:0}if(Y(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;let X=function(J,q){let H=0,tt=J.length;for(;H<=tt;){let st=Math.floor((tt-H)/2)+H,lt=q(J[st]);if(lt===0)return st;lt<0?tt=st:H=st+1}return-1}(this.shards,Y);return X===-1?-1:(this.previousShardIndex=X,this.previousShardIndex)}}},7084:(L,O,S)=>{S.d(O,{AQ:()=>It,CY:()=>tt,Ej:()=>Qt,P8:()=>St,Rl:()=>Ft,Xf:()=>ge,aG:()=>H,jf:()=>qt,l3:()=>Tt,oR:()=>Gt,s5:()=>xt,zV:()=>vt});var B=S(7148),j=S(4027),K=S(5119),Z=S(5685),Y=S(6734),X=S(5287),J=S(6574);let q=4;function H(ee,Ee){return ce(this,null,function*(){let Bt=[],Xt=[],we=Array.isArray(ee)?ee.map(ie=>ie.name):Object.keys(ee);for(let ie=0;ie<we.length;++ie){let m=we[ie],ye=Array.isArray(ee)?ee[ie].tensor:ee[m];if(ye.dtype!=="float32"&&ye.dtype!=="int32"&&ye.dtype!=="bool"&&ye.dtype!=="string"&&ye.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${m}': ${ye.dtype}`);let Ge={name:m,shape:ye.shape,dtype:ye.dtype};if(ye.dtype==="string"){let te=new Promise(Me=>ce(this,null,function*(){let Ye=yield ye.bytes(),Ue=Ye.reduce((Kn,Sn)=>Kn+Sn.length,0)+q*Ye.length,kn=new Uint8Array(Ue),mn=0;for(let Kn=0;Kn<Ye.length;Kn++){let Sn=Ye[Kn],Wn=new Uint8Array(new Uint32Array([Sn.length]).buffer);kn.set(Wn,mn),mn+=q,kn.set(Sn,mn),mn+=Sn.length}Me(kn)}));Xt.push(te)}else Xt.push(ye.data());Ee!=null&&(Ge.group=Ee),Bt.push(Ge)}return{data:wt(yield Promise.all(Xt)),specs:Bt}})}function tt(ee,Ee){let Bt=new Y.D(ee),Xt={},we=0;for(let ie of Ee){let m=st(ie,(ye,Ge)=>Bt.slice(we+ye,we+Ge));Xt[ie.name]=ft(ie,Bt.slice(we,we+m)),we+=m}return Xt}function st(ee,Ee){let Bt=(0,K.Ze)(ee.shape),Xt;if("quantization"in ee){let we=ee.quantization;Xt=Z.i[we.dtype]}else{if(ee.dtype==="string"){let we=0;for(let ie=0;ie<Bt;ie++)we+=q+new Uint32Array(Ee(we,we+q))[0];return we}Xt=Z.i[ee.dtype]}return Bt*Xt}function lt(ee,Ee){return ce(this,null,function*(){let Bt=(0,K.Ze)(ee.shape),Xt;if("quantization"in ee){let we=ee.quantization;Xt=Z.i[we.dtype]}else{if(ee.dtype==="string"){let we=0;for(let ie=0;ie<Bt;ie++)we+=q+new Uint32Array(yield Ee(we,we+q))[0];return we}Xt=Z.i[ee.dtype]}return Bt*Xt})}function ft(ee,Ee){let Bt=ee.name,Xt=ee.dtype,we=ee.shape,ie=(0,K.Ze)(we),m,ye=0;if("quantization"in ee){let Ge=ee.quantization;if(Ge.dtype==="uint8"||Ge.dtype==="uint16"){if(!("min"in Ge)||!("scale"in Ge))throw new Error(`Weight ${ee.name} with quantization ${Ge.dtype} doesn't have corresponding metadata min and scale.`)}else{if(Ge.dtype!=="float16")throw new Error(`Weight ${ee.name} has unknown quantization dtype ${Ge.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if(Xt!=="float32")throw new Error(`Weight ${ee.name} is quantized with ${Ge.dtype} which only supports weights of type float32 not ${Xt}.`)}let te=Z.i[Ge.dtype],Me=Ge.dtype==="uint8"?new Uint8Array(Ee):new Uint16Array(Ee);if(Xt==="float32")if(Ge.dtype==="uint8"||Ge.dtype==="uint16"){m=new Float32Array(Me.length);for(let Ye=0;Ye<Me.length;Ye++){let Ue=Me[Ye];m[Ye]=Ue*Ge.scale+Ge.min}}else{if(Ge.dtype!=="float16")throw new Error(`Unsupported quantization type ${Ge.dtype} for weight type float32.`);m=function(){let Ue=function(){let Kn=Wn=>{let Ze=Wn<<13,de=0;for(;!(8388608&Ze);)de-=8388608,Ze<<=1;return Ze&=-8388609,de+=947912704,Ze|de},Sn=new Uint32Array(2048);Sn[0]=0;for(let Wn=1;Wn<1024;Wn++)Sn[Wn]=Kn(Wn);for(let Wn=1024;Wn<2048;Wn++)Sn[Wn]=939524096+(Wn-1024<<13);return Sn}(),kn=function(){let Kn=new Uint32Array(64);Kn[0]=0,Kn[31]=1199570944,Kn[32]=2147483648,Kn[63]=3347054592;for(let Sn=1;Sn<31;Sn++)Kn[Sn]=Sn<<23;for(let Sn=33;Sn<63;Sn++)Kn[Sn]=2147483648+(Sn-32<<23);return Kn}(),mn=function(){let Kn=new Uint32Array(64);for(let Sn=0;Sn<64;Sn++)Kn[Sn]=1024;return Kn[0]=Kn[32]=0,Kn}();return Kn=>{let Sn=new ArrayBuffer(4*Kn.length),Wn=new Uint32Array(Sn);for(let Ze=0;Ze<Kn.length;Ze++){let de=Kn[Ze],Re=Ue[mn[de>>10]+(1023&de)]+kn[de>>10];Wn[Ze]=Re}return new Float32Array(Sn)}}()(Me)}else{if(Xt!=="int32")throw new Error(`Unsupported dtype in weight '${Bt}': ${Xt}`);if(Ge.dtype!=="uint8"&&Ge.dtype!=="uint16")throw new Error(`Unsupported quantization type ${Ge.dtype} for weight type int32.`);m=new Int32Array(Me.length);for(let Ye=0;Ye<Me.length;Ye++){let Ue=Me[Ye];m[Ye]=Math.round(Ue*Ge.scale+Ge.min)}}ye+=ie*te}else if(Xt==="string"){let Ge=(0,K.Ze)(ee.shape);m=[];for(let te=0;te<Ge;te++){let Me=new Uint32Array(Ee.slice(ye,ye+q))[0];ye+=q;let Ye=new Uint8Array(Ee.slice(ye,ye+Me));m.push(Ye),ye+=Me}}else{let Ge=Z.i[Xt];if(Xt==="float32")m=new Float32Array(Ee);else if(Xt==="int32")m=new Int32Array(Ee);else{if(Xt!=="bool"){if(Xt==="complex64"){m=new Float32Array(Ee);let te=new Float32Array(m.length/2),Me=new Float32Array(m.length/2);for(let mn=0;mn<te.length;mn++)te[mn]=m[2*mn],Me[mn]=m[2*mn+1];let Ye=(0,j.O)(te,we,"float32"),Ue=(0,j.O)(Me,we,"float32"),kn=(0,B.f)(Ye,Ue);return Ye.dispose(),Ue.dispose(),kn}throw new Error(`Unsupported dtype in weight '${Bt}': ${Xt}`)}m=new Uint8Array(Ee)}ye+=ie*Ge}return(0,j.O)(m,we,Xt)}function gt(ee,Ee,Bt){return ce(this,null,function*(){let Xt=new Uint8Array(Ee);for(;Xt.byteLength<Bt;){let{done:we,value:ie}=yield ee.read();if(we&&ie==null){let ye=Bt-Xt.byteLength;throw new Error(`Reader is done but ${ye} bytes are still expected`)}let m=new Uint8Array(Xt.length+ie.byteLength);m.set(Xt,0),m.set(new Uint8Array(ie),Xt.length),Xt=m}return Xt.buffer})}function xt(ee,Ee){return ce(this,null,function*(){let Bt={},Xt=ee.getReader(),we=new ArrayBuffer(0);for(let ie of Ee){let m=yield lt(ie,(te,Me)=>ce(this,null,function*(){return we=yield gt(Xt,we,Me),we.slice(te,Me)}));we=yield gt(Xt,we,m);let ye=we.slice(0,m);we=we.slice(m);let Ge=ft(ie,ye);if(Bt[ie.name]=Ge,(0,X.jz)()==="webgpu"){let te=(0,X.Hs)();"uploadToGPU"in te&&(0,K.Ze)(Ge.shape)>=(0,J._K)().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&te.uploadToGPU(Ge.dataId)}}return Bt})}function wt(ee){if(ee===null)throw new Error(`Invalid input value: ${JSON.stringify(ee)}`);let Ee=0,Bt=[];ee.forEach(ie=>{if(Ee+=ie.byteLength,Bt.push(ie.byteLength===ie.buffer.byteLength?ie:new ie.constructor(ie)),!(ie instanceof Float32Array||ie instanceof Int32Array||ie instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${ie.constructor.name}`)});let Xt=new Uint8Array(Ee),we=0;return Bt.forEach(ie=>{Xt.set(new Uint8Array(ie.buffer),we),we+=ie.byteLength}),Xt.buffer}let _t=typeof Un<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function bt(ee){return _t?Un.byteLength(ee,"utf8"):new Blob([ee]).size}function Tt(ee){if(_t)return Un.from(ee).toString("base64");let Ee=new Uint8Array(ee),Bt="";for(let Xt=0,we=Ee.length;Xt<we;Xt++)Bt+=String.fromCharCode(Ee[Xt]);return btoa(Bt)}function qt(ee){if(_t){let Xt=Un.from(ee,"base64");return Xt.buffer.slice(Xt.byteOffset,Xt.byteOffset+Xt.byteLength)}let Ee=atob(ee),Bt=new Uint8Array(Ee.length);for(let Xt=0;Xt<Ee.length;++Xt)Bt.set([Ee.charCodeAt(Xt)],Xt);return Bt.buffer}function It(ee){return Y.D.join(ee)}function St(ee){for(ee=ee.trim();ee.endsWith("/");)ee=ee.slice(0,ee.length-1);let Ee=ee.split("/");return Ee[Ee.length-1]}function vt(ee,Ee){let Bt={modelTopology:ee.modelTopology,format:ee.format,generatedBy:ee.generatedBy,convertedBy:ee.convertedBy,weightsManifest:Ee};return ee.signature!=null&&(Bt.signature=ee.signature),ee.userDefinedMetadata!=null&&(Bt.userDefinedMetadata=ee.userDefinedMetadata),ee.modelInitializer!=null&&(Bt.modelInitializer=ee.modelInitializer),ee.initializerSignature!=null&&(Bt.initializerSignature=ee.initializerSignature),ee.trainingConfig!=null&&(Bt.trainingConfig=ee.trainingConfig),Bt}function Ft(ee,Ee,Bt){let Xt={modelTopology:ee.modelTopology,format:ee.format,generatedBy:ee.generatedBy,convertedBy:ee.convertedBy};if(ee.trainingConfig!=null&&(Xt.trainingConfig=ee.trainingConfig),ee.weightsManifest!=null){if(!Ee)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!Bt)throw new Error("modelJSON has weightsManifest but weightData is null");Xt.weightSpecs=Ee,Xt.weightData=Bt}return ee.signature!=null&&(Xt.signature=ee.signature),ee.userDefinedMetadata!=null&&(Xt.userDefinedMetadata=ee.userDefinedMetadata),ee.modelInitializer!=null&&(Xt.modelInitializer=ee.modelInitializer),ee.initializerSignature!=null&&(Xt.initializerSignature=ee.initializerSignature),Xt}function Qt(ee,Ee){return ce(this,null,function*(){let Bt,Xt;return ee.weightsManifest!=null&&([Bt,Xt]=yield Ee(ee.weightsManifest)),Ft(ee,Bt,Xt)})}function Gt(ee){if(ee.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:ee.modelTopology==null?0:bt(JSON.stringify(ee.modelTopology)),weightSpecsBytes:ee.weightSpecs==null?0:bt(JSON.stringify(ee.weightSpecs)),weightDataBytes:ee.weightData==null?0:new Y.D(ee.weightData).byteLength}}function ge(ee){let Ee=[];for(let Bt of ee)Ee.push(...Bt.weights);return Ee}},5685:(L,O,S)=>{S.d(O,{i:()=>B});let B={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}},5441:(L,O,S)=>{S.d(O,{$dB:()=>Bt,$jE:()=>Lu,$zE:()=>Ee,A1h:()=>m,A8B:()=>Ea,BK4:()=>ph,BLA:()=>uu,BRl:()=>Zn,Blb:()=>Ta,BoJ:()=>sa,BxF:()=>Pi,C8s:()=>Ui,CQC:()=>xs,Cg$:()=>Jn,CwD:()=>Le,D7i:()=>Vn,Ddj:()=>io,Dr:()=>$c,DvZ:()=>Po,E3$:()=>br,EkD:()=>Y,ElG:()=>Ti,EwU:()=>Ba,FAs:()=>Zr,FCQ:()=>rn,FSt:()=>J,Fin:()=>_a,GZp:()=>Ms,HNs:()=>St,Ik2:()=>qt,J3C:()=>ra,JiE:()=>bi,Jp_:()=>q,KXH:()=>Qt,L6G:()=>ks,LB5:()=>vt,LDN:()=>so,LG0:()=>Xo,LRy:()=>_n,LWX:()=>Rc,LXA:()=>or,M6A:()=>an,MRQ:()=>kn,Mn0:()=>te,MnK:()=>Me,N4F:()=>It,Ncv:()=>ji,O4G:()=>lr,OAQ:()=>Qr,ODT:()=>wu,OMN:()=>Z,ORI:()=>de,PH8:()=>K,P_L:()=>Cn,Pah:()=>wn,PbM:()=>Ed,Q6t:()=>pa,QDP:()=>Gt,QKF:()=>tt,Qgm:()=>tn,R23:()=>Zt,RMm:()=>oc,RUm:()=>dr,RW8:()=>Yn,RXX:()=>vs,SDM:()=>Ga,SQl:()=>ea,T7M:()=>yt,TBb:()=>Qu,TL8:()=>na,TMz:()=>Kn,TOR:()=>Kr,ToN:()=>Da,TyE:()=>lt,UcO:()=>lu,VAI:()=>la,VCH:()=>wt,Vvy:()=>j,WRv:()=>_i,WT3:()=>ws,WuN:()=>Gi,X$8:()=>Wn,X0$:()=>Fo,X4r:()=>Ai,XQy:()=>le,XhZ:()=>qn,XmO:()=>Ae,YAb:()=>Ul,YVe:()=>oa,ZgB:()=>Cr,Zl4:()=>Fu,_s9:()=>Hn,aAr:()=>uc,awo:()=>Ju,bCz:()=>Tl,bP9:()=>Kt,cHb:()=>bs,cS:()=>_t,dFH:()=>Ca,dLy:()=>Wl,dXR:()=>$s,dv8:()=>vi,e0f:()=>Zs,epO:()=>st,fUj:()=>Dt,g5A:()=>va,gC7:()=>Ge,gIW:()=>ua,hVg:()=>hr,hgw:()=>Pe,ho8:()=>xt,hql:()=>Ci,huO:()=>ls,i5R:()=>Be,iGz:()=>ye,iPs:()=>eo,iW0:()=>Ou,iuW:()=>ni,jAQ:()=>Tt,jM4:()=>Si,jOE:()=>Ce,jfg:()=>ie,jgd:()=>ku,jj_:()=>Ye,jxD:()=>Re,kdj:()=>Ku,l0G:()=>Ru,l6P:()=>Jr,lLS:()=>fr,lNG:()=>Ya,ljI:()=>B,lxb:()=>gt,lzr:()=>Er,mH5:()=>xu,mIA:()=>Wa,mM$:()=>Qs,mnI:()=>bn,mxL:()=>En,nVu:()=>Ze,nY8:()=>Ue,nZd:()=>Ur,oFs:()=>Fc,oJ2:()=>Zu,ox3:()=>_r,p2J:()=>Xt,pJc:()=>$i,pPe:()=>Oc,p_m:()=>H,pk0:()=>Jt,pnw:()=>Lc,pr3:()=>ee,pyJ:()=>Zo,rFG:()=>Dn,rFm:()=>we,rGP:()=>ai,rsH:()=>Mn,sDr:()=>$e,t3d:()=>ys,tG8:()=>jn,tGH:()=>Sn,u$b:()=>di,u8Z:()=>X,uWl:()=>Rr,urI:()=>bu,vI1:()=>Wr,vaV:()=>ge,vj7:()=>Ft,wNW:()=>mn,wwC:()=>bt,wx0:()=>Yh,x7F:()=>Du,xJ3:()=>sc,xu7:()=>Ra,yPW:()=>Ki,ySp:()=>qo,ybN:()=>Sr,ybj:()=>Mr,ylV:()=>Ko,zP9:()=>ft,zfU:()=>li});let B="Abs",j="Acos",K="Acosh",Z="Add",Y="AddN",X="All",J="Any",q="ArgMax",H="ArgMin",tt="Asin",st="Asinh",lt="Atan",ft="Atanh",gt="Atan2",xt="AvgPool",wt="AvgPoolGrad",_t="AvgPool3D",bt="AvgPool3DGrad",Tt="BatchMatMul",qt="BatchToSpaceND",It="Bincount",St="BitwiseAnd",vt="BroadcastTo",Ft="BroadcastArgs",Qt="Cast",Gt="Ceil",ge="ClipByValue",ee="Complex",Ee="ComplexAbs",Bt="Concat",Xt="Conv2D",we="Conv2DBackpropFilter",ie="Conv2DBackpropInput",m="Conv3D",ye="Conv3DBackpropFilterV2",Ge="Conv3DBackpropInputV2",te="Cos",Me="Cosh",Ye="Cumprod",Ue="Cumsum",kn="CropAndResize",mn="DenseBincount",Kn="DepthToSpace",Sn="DepthwiseConv2dNative",Wn="DepthwiseConv2dNativeBackpropFilter",Ze="DepthwiseConv2dNativeBackpropInput",de="Diag",Re="Dilation2D",Kt="Dilation2DBackpropInput",Jt="Dilation2DBackpropFilter",Ae="Draw",$e="RealDiv",tn="Einsum",wn="Elu",Mn="EluGrad",Hn="Erf",Zn="Equal",_r="Exp",Sr="ExpandDims",Mr="Expm1",ai="FFT",ea="Fill",Pi="FlipLeftRight",Cr="Floor",Ti="FloorDiv",Be="FusedBatchNorm",En="GatherV2",lr="GatherNd",qn="Greater",fr="GreaterEqual",Er="Identity",Qr="IFFT",vi="Imag",ua="IsFinite",br="IsInf",eo="IsNan",Fo="LeakyRelu",Wa="Less",Le="LessEqual",bn="LinSpace",jn="Log",Jn="Log1p",dr="LogicalAnd",Ur="LogicalNot",or="LogicalOr",Yn="LogicalXor",li="LogSoftmax",Ki="LowerBound",Si="LRN",Da="LRNGrad",_i="MatrixBandPart",la="Max",so="Maximum",ys="MaxPool",vs="MaxPoolGrad",qo="MaxPool3D",bs="MaxPool3DGrad",na="MaxPoolWithArgmax",va="Mean",Ya="Min",Xo="Minimum",Du="MirrorPad",uu="Mod",ws="Multinomial",Ra="Multiply",Ru="Neg",Ko="NotEqual",Ga="NonMaxSuppressionV3",Fu="NonMaxSuppressionV4",Zs="NonMaxSuppressionV5",Rc="OnesLike",bu="OneHot",Qs="Pack",wu="PadV2",Tl="Pool",Zo="Pow",ji="Prelu",Ku="Prod",Zu="RaggedGather",xs="RaggedRange",xu="RaggedTensorToTensor",pa="Range",_n="Real",ls="Reciprocal",Dt="Relu",Zt="Reshape",Ce="ResizeNearestNeighbor",le="ResizeNearestNeighborGrad",Pe="ResizeBilinear",rn="ResizeBilinearGrad",Cn="Relu6",Vn="Reverse",hr="Round",Kr="Rsqrt",$i="ScatterNd",Ai="TensorScatterUpdate",Rr="SearchSorted",Jr="Select",di="Selu",bi="Slice",Ci="Sin",ra="Sinh",oa="Sign",Wr="Sigmoid",_a="Softplus",Ca="Sqrt",Gi="Sum",Ea="SpaceToBatchND",Ta="SplitV",Dn="Softmax",Ui="SparseFillEmptyRows",sa="SparseReshape",ks="SparseSegmentMean",Po="SparseSegmentSum",ku="SparseToDense",io="SquaredDifference",an="Square",Ms="StaticRegexReplace",lu="StridedSlice",Ul="StringNGrams",Ou="StringSplit",Lu="StringToHashBucketFast",Ed="Sub",Fc="Tan",ni="Tanh",Zr="Tile",Qu="TopK",Wl="Transform",Yh="Transpose",Ba="Unique",$s="Unpack",Oc="UnsortedSegmentSum",oc="UpperBound",sc="ZerosLike",Lc="Step",Ju="FromPixels",ph="RotateWithOffset",$c="_FusedMatMul",uc="FusedConv2D",yt="FusedDepthwiseConv2D"},7074:(L,O,S)=>{S.d(O,{Cf:()=>ft,Op:()=>q,_5:()=>X,iP:()=>st,kr:()=>tt,rY:()=>lt,tA:()=>H,vQ:()=>J});var B=S(6574),j=S(1743),K=S(3673);let Z=(0,j.m)("kernelRegistry",()=>new Map),Y=(0,j.m)("gradRegistry",()=>new Map);function X(xt,wt){let _t=gt(xt,wt);return Z.get(_t)}function J(xt){return Y.get(xt)}function q(xt){let wt=Z.entries(),_t=[];for(;;){let{done:bt,value:Tt}=wt.next();if(bt)break;let[qt,It]=Tt,[St]=qt.split("_");St===xt&&_t.push(It)}return _t}function H(xt){let{kernelName:wt,backendName:_t}=xt,bt=gt(wt,_t);Z.has(bt)&&K.i(`The kernel '${wt}' for backend '${_t}' is already registered`),Z.set(bt,xt)}function tt(xt){let{kernelName:wt}=xt;Y.has(wt)&&(0,B._K)().getBool("DEBUG")&&K.i(`Overriding the gradient for '${wt}'`),Y.set(wt,xt)}function st(xt,wt){let _t=gt(xt,wt);if(!Z.has(_t))throw new Error(`The kernel '${xt}' for backend '${wt}' is not registered`);Z.delete(_t)}function lt(xt){if(!Y.has(xt))throw new Error(`The gradient '${xt}' for backend is not registered`);Y.delete(xt)}function ft(xt,wt){q(xt).forEach(_t=>{H(Object.assign({},_t,{backendName:wt}))})}function gt(xt,wt){return`${wt}_${xt}`}},3673:(L,O,S)=>{S.d(O,{R:()=>K,i:()=>j});var B=S(6574);function j(...Z){(0,B._K)().getBool("IS_TEST")||(0,B._K)().getBool("PROD")||console.warn(...Z)}function K(...Z){(0,B._K)().getBool("IS_TEST")||(0,B._K)().getBool("PROD")||console.log(...Z)}},4888:(L,O,S)=>{S.d(O,{t:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({abs_:function(Y){let X=(0,K.YT)(Y,"x","abs");if(X.dtype==="complex64"){let J={x:X};return B.T2.runKernel(j.$zE,J)}{let J={x:X};return B.T2.runKernel(j.ljI,J)}}})},2804:(L,O,S)=>{S.d(O,{H:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({acos_:function(Y){let X={x:(0,K.YT)(Y,"x","acos")};return B.T2.runKernel(j.Vvy,X)}})},7558:(L,O,S)=>{S.d(O,{F:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({acosh_:function(Y){let X={x:(0,K.YT)(Y,"x","acosh")};return B.T2.runKernel(j.PH8,X)}})},7523:(L,O,S)=>{S.d(O,{W:()=>Y});var B=S(1585),j=S(5441),K=S(565),Z=S(8189);let Y=(0,S(929).op)({add_:function(X,J){let q=(0,Z.YT)(X,"a","add"),H=(0,Z.YT)(J,"b","add");[q,H]=(0,K.makeTypesMatch)(q,H);let tt={a:q,b:H};return B.T2.runKernel(j.OMN,tt)}})},2307:(L,O,S)=>{S.d(O,{Q:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({all_:function(Y,X=null,J=!1){let q={x:(0,K.YT)(Y,"x","all","bool")},H={axis:X,keepDims:J};return B.T2.runKernel(j.u8Z,q,H)}})},9326:(L,O,S)=>{S.d(O,{b:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({any_:function(Y,X=null,J=!1){let q={x:(0,K.YT)(Y,"x","any","bool")},H={axis:X,keepDims:J};return B.T2.runKernel(j.FSt,q,H)}})},897:(L,O,S)=>{S.d(O,{F:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({argMax_:function(Y,X=0){let J={x:(0,K.YT)(Y,"x","argMax")},q={axis:X};return B.T2.runKernel(j.Jp_,J,q)}})},4339:(L,O,S)=>{S.d(O,{X:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({argMin_:function(Y,X=0){let J={x:(0,K.YT)(Y,"x","argMin")},q={axis:X};return B.T2.runKernel(j.p_m,J,q)}})},6841:(L,O,S)=>{S.d(O,{q:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({asin_:function(Y){let X={x:(0,K.YT)(Y,"x","asin")};return B.T2.runKernel(j.QKF,X)}})},269:(L,O,S)=>{S.d(O,{y:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({asinh_:function(Y){let X={x:(0,K.YT)(Y,"x","asinh")};return B.T2.runKernel(j.epO,X)}})},9580:(L,O,S)=>{S.d(O,{r:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({atan_:function(Y){let X={x:(0,K.YT)(Y,"x","atan")};return B.T2.runKernel(j.TyE,X)}})},1404:(L,O,S)=>{S.d(O,{F:()=>Y});var B=S(1585),j=S(5441),K=S(565),Z=S(8189);let Y=(0,S(929).op)({atan2_:function(X,J){let q=(0,Z.YT)(X,"a","atan2"),H=(0,Z.YT)(J,"b","atan2");[q,H]=(0,K.makeTypesMatch)(q,H);let tt={a:q,b:H};return B.T2.runKernel(j.lxb,tt)}})},3774:(L,O,S)=>{S.d(O,{r:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({atanh_:function(Y){let X={x:(0,K.YT)(Y,"x","atanh")};return B.T2.runKernel(j.zP9,X)}})},3909:(L,O,S)=>{S.d(O,{$:()=>H});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119),Y=S(9809),X=S(7195),J=S(929),q=S(2302);let H=(0,J.op)({avgPool_:function(tt,st,lt,ft,gt){let xt=(0,K.YT)(tt,"x","avgPool","float32");Z.vA(X.G0(lt,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${lt} and dilations '1'`);let wt=xt,_t=!1;xt.rank===3&&(_t=!0,wt=(0,q.t)(xt,[1,xt.shape[0],xt.shape[1],xt.shape[2]])),Z.vA(wt.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${wt.rank}.`),X.s_("avgPool",ft,gt);let bt={x:wt},Tt={filterSize:st,strides:lt,pad:ft,dimRoundingMode:gt},qt=B.T2.runKernel(j.ho8,bt,Tt);return qt=(0,Y.w)(qt,xt.dtype),_t?(0,q.t)(qt,[qt.shape[1],qt.shape[2],qt.shape[3]]):qt}})},1078:(L,O,S)=>{S.d(O,{Em:()=>J,SM:()=>Y,WC:()=>X,WH:()=>j,aF:()=>K,fK:()=>H,gx:()=>q,lb:()=>Z});var B=S(5119);function j(tt,st){for(let lt=0;lt<tt.length;++lt)if(tt[tt.length-lt-1]!==st-1-lt)return!1;return!0}function K(tt,st,lt){let ft=tt.length+st.length,gt=[],xt=0,wt=0;for(let _t=0;_t<ft;_t++)lt.indexOf(_t)===-1?gt.push(tt[xt++]):gt.push(st[wt++]);return gt}function Z(tt,st){let lt=[],ft=tt.length;for(let gt=0;gt<ft;gt++)st.indexOf(gt)===-1&&lt.push(tt[gt]);return[lt,st.map(gt=>tt[gt])]}function Y(tt,st){return K(tt,st.map(lt=>1),st)}function X(tt,st,lt){B.vA(j(st,lt),()=>`${tt} supports only inner-most axes for now. Got axes ${st} and rank-${lt} input.`)}function J(tt,st){if(j(tt,st))return null;let lt=[];for(let ft=0;ft<st;++ft)tt.indexOf(ft)===-1&&lt.push(ft);return tt.forEach(ft=>lt.push(ft)),lt}function q(tt){return tt.map((st,lt)=>[lt,st]).sort((st,lt)=>st[1]-lt[1]).map(st=>st[0])}function H(tt,st){let lt=[];for(let ft=st-tt;ft<st;++ft)lt.push(ft);return lt}},9772:(L,O,S)=>{S.d(O,{G:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119);let Y=(0,S(929).op)({batchToSpaceND_:function(X,J,q){let H=(0,K.YT)(X,"x","batchToSpaceND"),tt=J.reduce((ft,gt)=>ft*gt);Z.vA(H.rank>=1+J.length,()=>`input rank is ${H.rank} but should be > than blockShape.length ${J.length}`),Z.vA(q.length===J.length,()=>`crops.length is ${q.length} but should be equal to blockShape.length  ${J.length}`),Z.vA(H.shape[0]%tt==0,()=>`input tensor batch is ${H.shape[0]} but is not divisible by the product of the elements of blockShape ${J.join(" * ")} === ${tt}`);let st={x:H},lt={blockShape:J,crops:q};return B.T2.runKernel(j.Ik2,st,lt)}})},9160:(L,O,S)=>{S.d(O,{$:()=>X});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119),Y=S(2302);let X=(0,S(929).op)({batchNorm_:function(J,q,H,tt,st,lt){lt==null&&(lt=.001);let ft=(0,K.YT)(J,"x","batchNorm"),gt=(0,K.YT)(q,"mean","batchNorm"),xt=(0,K.YT)(H,"variance","batchNorm"),wt,_t;st!=null&&(wt=(0,K.YT)(st,"scale","batchNorm")),tt!=null&&(_t=(0,K.YT)(tt,"offset","batchNorm")),Z.vA(gt.rank===xt.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Z.vA(_t==null||gt.rank===_t.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Z.vA(wt==null||gt.rank===wt.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let bt={x:function(It){let St;return St=It.rank===0||It.rank===1?(0,Y.t)(It,[1,1,1,It.size]):It.rank===2?(0,Y.t)(It,[1,1,It.shape[0],It.shape[1]]):It.rank===3?(0,Y.t)(It,[1,It.shape[0],It.shape[1],It.shape[2]]):It,St}(ft),scale:wt,offset:_t,mean:gt,variance:xt},Tt={varianceEpsilon:lt},qt=B.T2.runKernel(j.i5R,bt,Tt);return(0,Y.t)(qt,ft.shape)}})},3567:(L,O,S)=>{S.d(O,{h:()=>q});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119),Y=S(125),X=S(929),J=S(2302);let q=(0,X.op)({broadcastTo_:function(H,tt){let st=(0,K.YT)(H,"broadcastTo","x"),lt=st.shape;if((0,Z.SA)(tt),tt.length<st.rank)throw new Error(`broadcastTo(): shape.length=${tt.length} < input.rank=${st.rank}.`);if(tt.length>st.rank){let _t=st.shape.slice();for(;_t.length<tt.length;)_t.unshift(1);st=(0,J.t)(st,_t)}let ft=st.shape,gt=Array.from(tt);for(let _t=tt.length-1;_t>=0;_t--)if(ft[_t]===tt[_t])gt[_t]=1;else if(st.shape[_t]!==1)throw new Error(`broadcastTo(): [${lt}] cannot be broadcast to [${tt}].`);if(gt.map((_t,bt)=>_t>1?bt:-1).filter(_t=>_t>=0).length===0)return(0,Y.o)(st);let xt={x:st},wt={reps:gt};return B.T2.runKernel(j.FAs,xt,wt)}})},2198:(L,O,S)=>{function B(Z,Y){let X=Z.length,J=[];for(let q=0;q<X;q++){let H=X-1-q,tt=Z[H]||1;(Y[Y.length-1-q]||1)>1&&tt===1&&J.unshift(H)}return J}function j(Z,Y){let X=[];for(let J=0;J<Y.length;J++){let q=Z[Z.length-J-1],H=Y.length-J-1,tt=Y[H];(q==null||q===1&&tt>1)&&X.unshift(H)}return X}function K(Z,Y){let X=Math.max(Z.length,Y.length),J=new Array(X);for(let q=0;q<X;q++){let H=Z[Z.length-q-1];H==null&&(H=1);let tt=Y[Y.length-q-1];if(tt==null&&(tt=1),H===1)J[X-q-1]=tt;else if(tt===1)J[X-q-1]=H;else{if(H!==tt)throw Error(`Operands could not be broadcast together with shapes ${Z} and ${Y}.`);J[X-q-1]=H}}return J}S.r(O),S.d(O,{assertAndGetBroadcastShape:()=>K,getBroadcastDims:()=>B,getReductionAxes:()=>j})},448:(L,O,S)=>{S.d(O,{r:()=>K});var B=S(259),j=S(5119);function K(Z,Y="float32",X){return Y=Y||"float32",j.SA(Z),new B.yl(Z,Y,X)}},9809:(L,O,S)=>{S.d(O,{w:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119);let Y=(0,S(929).op)({cast_:function(X,J){let q=(0,K.YT)(X,"x","cast");if(!Z.xn(J))throw new Error(`Failed to cast to unknown dtype ${J}`);if(J==="string"&&q.dtype!=="string"||J!=="string"&&q.dtype==="string")throw new Error("Only strings can be casted to strings");let H={x:q},tt={dtype:J};return B.T2.runKernel(j.KXH,H,tt)}})},855:(L,O,S)=>{S.d(O,{m:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({ceil_:function(Y){let X={x:(0,K.YT)(Y,"x","ceil","float32")};return B.T2.runKernel(j.QDP,X)}})},6928:(L,O,S)=>{S.d(O,{z:()=>X});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119),Y=S(6111);let X=(0,S(929).op)({clipByValue_:function(J,q,H){let tt=(0,K.YT)(J,"x","clipByValue");if(Z.vA(q<=H,()=>`Error in clip: min (${q}) must be less than or equal to max (${H}).`),q===H)return(0,Y.G)(tt.shape,q,tt.dtype);let st={x:tt},lt={clipValueMin:q,clipValueMax:H};return B.T2.runKernel(j.vaV,st,lt)}})},125:(L,O,S)=>{S.d(O,{o:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({clone_:function(Y){let X={x:(0,K.YT)(Y,"x","clone","string_or_numeric")};return B.T2.runKernel(j.lzr,X)}})},7148:(L,O,S)=>{S.d(O,{f:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119);let Y=(0,S(929).op)({complex_:function(X,J){let q=(0,K.YT)(X,"real","complex"),H=(0,K.YT)(J,"imag","complex");Z.O3(q.shape,H.shape,`real and imag shapes, ${q.shape} and ${H.shape}, must match in call to tf.complex().`);let tt={real:q,imag:H};return B.T2.runKernel(j.pr3,tt)}})},5030:(L,O,S)=>{S.d(O,{x:()=>X});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119),Y=S(125);let X=(0,S(929).op)({concat_:function(J,q=0){(0,Z.vA)(J.length>=1,()=>"Pass at least one tensor to concat");let H=(0,K.j1)(J,"tensors","concat","string_or_numeric");if(H[0].dtype==="complex64"&&H.forEach(lt=>{if(lt.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${lt.dtype}. `)}),H.length===1)return(0,Y.o)(H[0]);let tt=H,st={axis:q};return B.T2.runKernel(j.$dB,tt,st)}})},3701:(L,O,S)=>{S.d(O,{k:()=>J});var B=S(8189),j=S(5119),K=S(8794),Z=S(7195),Y=S(929),X=S(2302);let J=(0,Y.op)({conv1d_:function(q,H,tt,st,lt="NWC",ft=1,gt){let xt=(0,B.YT)(q,"x","conv1d"),wt=(0,B.YT)(H,"filter","conv1d"),_t=xt,bt=!1;xt.rank===2&&(bt=!0,_t=(0,X.t)(xt,[1,xt.shape[0],xt.shape[1]])),j.vA(_t.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${_t.rank}.`),j.vA(wt.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${wt.rank}.`),Z.s_("conv1d",st,gt),j.vA(_t.shape[2]===wt.shape[1],()=>`Error in conv1d: depth of input (${_t.shape[2]}) must match input depth for filter ${wt.shape[1]}.`),j.vA(Z.G0(tt,ft),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${tt} and dilation '${ft}'`),j.vA(Z.qk(ft),()=>"Error in conv1D: Dilated rates should be larger than 0."),j.vA(Z.qk(tt),()=>"Error in conv1D: Stride should be larger than 0."),j.vA(lt==="NWC",()=>`Error in conv1d: got dataFormat of ${lt} but only NWC is currently supported.`);let Tt=(0,X.t)(wt,[1,wt.shape[0],wt.shape[1],wt.shape[2]]),qt=(0,X.t)(_t,[_t.shape[0],1,_t.shape[1],_t.shape[2]]),It=[1,tt],St=[1,ft],vt=(0,K.X)(qt,Tt,It,st,"NHWC",St,gt);return bt?(0,X.t)(vt,[vt.shape[2],vt.shape[3]]):(0,X.t)(vt,[vt.shape[0],vt.shape[2],vt.shape[3]])}})},8794:(L,O,S)=>{S.d(O,{X:()=>q});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119),Y=S(7195),X=S(929),J=S(2302);let q=(0,X.op)({conv2d_:function(H,tt,st,lt,ft="NHWC",gt=[1,1],xt){let wt=(0,K.YT)(H,"x","conv2d","float32"),_t=(0,K.YT)(tt,"filter","conv2d","float32"),bt=wt,Tt=!1;wt.rank===3&&(Tt=!0,bt=(0,J.t)(wt,[1,wt.shape[0],wt.shape[1],wt.shape[2]])),Z.vA(bt.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${bt.rank}.`),Z.vA(_t.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${_t.rank}.`),Y.s_("conv2d",lt,xt);let qt=ft==="NHWC"?bt.shape[3]:bt.shape[1];Z.vA(qt===_t.shape[2],()=>`Error in conv2d: depth of input (${qt}) must match input depth for filter ${_t.shape[2]}.`),Z.vA(Y.G0(st,gt),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${st} and dilations '${gt}'`),Z.vA(Y.qk(gt),()=>"Error in conv2D: Dilated rates should be larger than 0."),Z.vA(Y.qk(st),()=>"Error in conv2D: Strides should be larger than 0.");let It={x:bt,filter:_t},St={strides:st,pad:lt,dataFormat:ft,dilations:gt,dimRoundingMode:xt},vt=B.T2.runKernel(j.p2J,It,St);return Tt?(0,J.t)(vt,[vt.shape[1],vt.shape[2],vt.shape[3]]):vt}})},5248:(L,O,S)=>{S.d(O,{H:()=>J});var B=S(1585),j=S(5441),K=S(5119),Z=S(7195),Y=S(929),X=S(2302);let J=(0,Y.op)({conv2DBackpropFilter_:function(q,H,tt,st,lt,ft="NHWC",gt){let xt=q;q.rank===3&&(xt=(0,X.t)(q,[1,q.shape[0],q.shape[1],q.shape[2]]));let wt=H;wt.rank===3&&(wt=(0,X.t)(H,[1,H.shape[0],H.shape[1],H.shape[2]])),K.vA(xt.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${xt.shape}.`),K.vA(wt.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${wt.shape}.`),K.vA(tt.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${tt}.`);let _t=ft==="NHWC"?xt.shape[3]:xt.shape[1],bt=ft==="NHWC"?wt.shape[3]:wt.shape[1];K.vA(_t===tt[2],()=>`Error in conv2dDerFilter: depth of input ${_t}) must match input depth in filter (${tt[2]}.`),K.vA(bt===tt[3],()=>`Error in conv2dDerFilter: depth of dy (${bt}) must match output depth for filter (${tt[3]}).`),Z.s_("conv2dDerFilter",lt,gt);let Tt={x:xt,dy:wt},qt={strides:st,pad:lt,dataFormat:ft,dimRoundingMode:gt,filterShape:tt};return B.T2.runKernel(j.rFm,Tt,qt)}})},252:(L,O,S)=>{S.d(O,{v:()=>J});var B=S(1585),j=S(5441),K=S(5119),Z=S(7195),Y=S(929),X=S(2302);let J=(0,Y.op)({conv2DBackpropInput_:function(q,H,tt,st,lt,ft="NHWC",gt){K.vA(q.length===H.rank,()=>`Length of inShape (${q.length}) and rank of dy (${H.rank}) must match`);let xt=q,wt=H,_t=!1;H.rank===3&&(_t=!0,wt=(0,X.t)(H,[1,H.shape[0],H.shape[1],H.shape[2]]),xt=[1,q[0],q[1],q[2]]),K.vA(xt.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${xt.length}.`),K.vA(wt.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${wt.rank}`),K.vA(tt.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${tt.rank}`);let bt=ft==="NHWC"?xt[3]:xt[1],Tt=ft==="NHWC"?wt.shape[3]:wt.shape[1];K.vA(bt===tt.shape[2],()=>`Error in conv2dDerInput: depth of input (${bt}) must match input depth for filter ${tt.shape[2]}.`),K.vA(Tt===tt.shape[3],()=>`Error in conv2dDerInput: depth of output (${Tt}) must match output depth for filter ${tt.shape[3]}.`),Z.s_("conv2dDerInput",lt,gt);let qt={dy:wt,filter:tt},It={strides:st,pad:lt,dataFormat:ft,dimRoundingMode:gt,inputShape:xt},St=B.T2.runKernel(j.jfg,qt,It);return _t?(0,X.t)(St,[St.shape[1],St.shape[2],St.shape[3]]):St}})},1106:(L,O,S)=>{S.d(O,{w:()=>K});var B=S(8189),j=S(252);let K=(0,S(929).op)({conv2dTranspose_:function(Z,Y,X,J,q,H){let tt=(0,B.YT)(Z,"x","conv2dTranspose"),st=(0,B.YT)(Y,"filter","conv2dTranspose");return(0,j.v)(X,tt,st,J,q,"NHWC",H)}})},1895:(L,O,S)=>{S.d(O,{c:()=>X});var B=S(1585),j=S(5441),K=S(5119),Z=S(929),Y=S(2302);let X=(0,Z.op)({conv3DBackpropInput_:function(J,q,H,tt,st){K.vA(J.length===q.rank,()=>`Length of inShape (${J.length}) and rank of dy (${q.rank}) must match`);let lt=J,ft=q,gt=!1;q.rank===4&&(gt=!0,ft=(0,Y.t)(q,[1,q.shape[0],q.shape[1],q.shape[2],q.shape[3]]),lt=[1,J[0],J[1],J[2],J[3]]);let xt=lt[4],wt=ft.shape[4];K.vA(lt.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${lt.length}.`),K.vA(ft.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${ft.rank}`),K.vA(H.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${H.rank}`),K.vA(xt===H.shape[3],()=>`Error in conv3dDerInput: depth of input (${xt}) must match input depth for filter ${H.shape[3]}.`),K.vA(wt===H.shape[4],()=>`Error in conv3dDerInput: depth of output (${wt}) must match output depth for filter ${H.shape[4]}.`);let _t={dy:ft,filter:H},bt={pad:st,strides:tt,inputShape:lt},Tt=B.T2.runKernel(j.gC7,_t,bt);return gt?(0,Y.t)(Tt,[Tt.shape[1],Tt.shape[2],Tt.shape[3],Tt.shape[4]]):Tt}})},7195:(L,O,S)=>{S.d(O,{$Q:()=>xt,Dh:()=>lt,E6:()=>K,G0:()=>ft,G8:()=>J,YQ:()=>j,l5:()=>Z,p$:()=>X,qk:()=>gt,s_:()=>wt,uf:()=>Y});var B=S(5119);function j(_t,bt,Tt,qt,It="NHWC",St){return Y(_t,[...bt,_t[3]],Tt,St,qt,null,null,xt(It))}function K(_t,bt,Tt,qt,It,St,vt="channelsLast"){let[Ft,Qt]=q(bt),Gt;if(vt==="channelsLast")Gt=[Ft,Qt,_t[3],_t[3]];else{if(vt!=="channelsFirst")throw new Error(`Unknown dataFormat ${vt}`);Gt=[Ft,Qt,_t[1],_t[1]]}return Y(_t,Gt,Tt,qt,It,St,!1,vt)}function Z(_t,bt,Tt,qt,It,St,vt="NDHWC"){let[Ft,Qt,Gt]=H(bt),ge,ee;if(vt==="NDHWC")ee="channelsLast",ge=[Ft,Qt,Gt,_t[4],_t[4]];else{if(vt!=="NCDHW")throw new Error(`Unknown dataFormat ${vt}`);ee="channelsFirst",ge=[Ft,Qt,Gt,_t[1],_t[1]]}return X(_t,ge,Tt,qt,It,!1,ee,St)}function Y(_t,bt,Tt,qt,It,St,vt=!1,Ft="channelsLast"){let[Qt,Gt,ge,ee]=[-1,-1,-1,-1];if(Ft==="channelsLast")[Qt,Gt,ge,ee]=_t;else{if(Ft!=="channelsFirst")throw new Error(`Unknown dataFormat ${Ft}`);[Qt,ee,Gt,ge]=_t}let[Ee,Bt,,Xt]=bt,[we,ie]=q(Tt),[m,ye]=q(qt),Ge=tt(Ee,m),te=tt(Bt,ye),{padInfo:Me,outHeight:Ye,outWidth:Ue}=function(Kn,Sn,Wn,Ze,de,Re,Kt,Jt,Ae){let $e,tn,wn;if(typeof Kn=="number"){$e={top:Kn,bottom:Kn,left:Kn,right:Kn,type:Kn===0?"VALID":"NUMBER"};let Mn=function(Hn,Zn,_r,Sr,Mr){Sr==null&&(Sr=J(Hn,Zn,_r));let ai=Hn[0],ea=Hn[1],Pi=st((ai-Zn+2*Sr)/_r+1,Mr),Cr=st((ea-Zn+2*Sr)/_r+1,Mr);return[Pi,Cr]}([Sn,Wn],Re,Ze,Kn,Jt);tn=Mn[0],wn=Mn[1]}else if(Kn==="same"){tn=Math.ceil(Sn/Ze),wn=Math.ceil(Wn/de);let Mn=Math.max(0,(tn-1)*Ze+Re-Sn),Hn=Math.max(0,(wn-1)*de+Kt-Wn),Zn=Math.floor(Mn/2),_r=Mn-Zn,Sr=Math.floor(Hn/2);$e={top:Zn,bottom:_r,left:Sr,right:Hn-Sr,type:"SAME"}}else if(Kn==="valid")$e={top:0,bottom:0,left:0,right:0,type:"VALID"},tn=Math.ceil((Sn-Re+1)/Ze),wn=Math.ceil((Wn-Kt+1)/de);else{if(typeof Kn!="object")throw Error(`Unknown padding parameter: ${Kn}`);{let Mn=Ae==="channelsLast"?Kn[1][0]:Kn[2][0],Hn=Ae==="channelsLast"?Kn[1][1]:Kn[2][1],Zn=Ae==="channelsLast"?Kn[2][0]:Kn[3][0],_r=Ae==="channelsLast"?Kn[2][1]:Kn[3][1];$e={top:Mn,bottom:Hn,left:Zn,right:_r,type:Mn===0&&Hn===0&&Zn===0&&_r===0?"VALID":"EXPLICIT"},tn=st((Sn-Re+Mn+Hn)/Ze+1,Jt),wn=st((Wn-Kt+Zn+_r)/de+1,Jt)}}return{padInfo:$e,outHeight:tn,outWidth:wn}}(It,Gt,ge,we,ie,Ge,te,St,Ft),kn=vt?Xt*ee:Xt,mn;return Ft==="channelsFirst"?mn=[Qt,kn,Ye,Ue]:Ft==="channelsLast"&&(mn=[Qt,Ye,Ue,kn]),{batchSize:Qt,dataFormat:Ft,inHeight:Gt,inWidth:ge,inChannels:ee,outHeight:Ye,outWidth:Ue,outChannels:kn,padInfo:Me,strideHeight:we,strideWidth:ie,filterHeight:Ee,filterWidth:Bt,effectiveFilterHeight:Ge,effectiveFilterWidth:te,dilationHeight:m,dilationWidth:ye,inShape:_t,outShape:mn,filterShape:bt}}function X(_t,bt,Tt,qt,It,St=!1,vt="channelsLast",Ft){let[Qt,Gt,ge,ee,Ee]=[-1,-1,-1,-1,-1];if(vt==="channelsLast")[Qt,Gt,ge,ee,Ee]=_t;else{if(vt!=="channelsFirst")throw new Error(`Unknown dataFormat ${vt}`);[Qt,Ee,Gt,ge,ee]=_t}let[Bt,Xt,we,,ie]=bt,[m,ye,Ge]=H(Tt),[te,Me,Ye]=H(qt),Ue=tt(Bt,te),kn=tt(Xt,Me),mn=tt(we,Ye),{padInfo:Kn,outDepth:Sn,outHeight:Wn,outWidth:Ze}=function(Kt,Jt,Ae,$e,tn,wn,Mn,Hn,Zn,_r,Sr){let Mr,ai,ea,Pi;if(Kt==="valid"&&(Kt=0),typeof Kt=="number"){Mr={top:Kt,bottom:Kt,left:Kt,right:Kt,front:Kt,back:Kt,type:Kt===0?"VALID":"NUMBER"};let Cr=function(Ti,Be,En,lr,qn,fr){qn==null&&(qn=J(Ti,Be[0],lr[0]));let Er=[0,0,0,En];for(let Qr=0;Qr<3;Qr++)Ti[Qr]+2*qn>=Be[Qr]&&(Er[Qr]=st((Ti[Qr]-Be[Qr]+2*qn)/lr[Qr]+1,fr));return Er}([Jt,Ae,$e,1],[Hn,Zn,_r],1,[tn,wn,Mn],Kt,Sr);ai=Cr[0],ea=Cr[1],Pi=Cr[2]}else{if(Kt!=="same")throw Error(`Unknown padding parameter: ${Kt}`);{ai=Math.ceil(Jt/tn),ea=Math.ceil(Ae/wn),Pi=Math.ceil($e/Mn);let Cr=(ai-1)*tn+Hn-Jt,Ti=(ea-1)*wn+Zn-Ae,Be=(Pi-1)*Mn+_r-$e,En=Math.floor(Cr/2),lr=Cr-En,qn=Math.floor(Ti/2),fr=Ti-qn,Er=Math.floor(Be/2);Mr={top:qn,bottom:fr,left:Er,right:Be-Er,front:En,back:lr,type:"SAME"}}}return{padInfo:Mr,outDepth:ai,outHeight:ea,outWidth:Pi}}(It,Gt,ge,ee,m,ye,Ge,Ue,kn,mn,Ft),de=St?ie*Ee:ie,Re;return vt==="channelsFirst"?Re=[Qt,de,Sn,Wn,Ze]:vt==="channelsLast"&&(Re=[Qt,Sn,Wn,Ze,de]),{batchSize:Qt,dataFormat:vt,inDepth:Gt,inHeight:ge,inWidth:ee,inChannels:Ee,outDepth:Sn,outHeight:Wn,outWidth:Ze,outChannels:de,padInfo:Kn,strideDepth:m,strideHeight:ye,strideWidth:Ge,filterDepth:Bt,filterHeight:Xt,filterWidth:we,effectiveFilterDepth:Ue,effectiveFilterHeight:kn,effectiveFilterWidth:mn,dilationDepth:te,dilationHeight:Me,dilationWidth:Ye,inShape:_t,outShape:Re,filterShape:bt}}function J(_t,bt,Tt,qt=1){let It=tt(bt,qt);return Math.floor((_t[0]*(Tt-1)-Tt+It)/2)}function q(_t){return typeof _t=="number"?[_t,_t,_t]:_t.length===2?[_t[0],_t[1],1]:_t}function H(_t){return typeof _t=="number"?[_t,_t,_t]:_t}function tt(_t,bt){return bt<=1?_t:_t+(_t-1)*(bt-1)}function st(_t,bt){if(!bt)return Math.trunc(_t);switch(bt){case"round":return Math.round(_t);case"ceil":return Math.ceil(_t);case"floor":return Math.floor(_t);default:throw new Error(`Unknown roundingMode ${bt}`)}}function lt(_t){let[bt,Tt,qt]=q(_t);return bt===1&&Tt===1&&qt===1}function ft(_t,bt){return lt(_t)||lt(bt)}function gt(_t){return q(_t).every(bt=>bt>0)}function xt(_t){if(_t==="NHWC")return"channelsLast";if(_t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${_t}`)}function wt(_t,bt,Tt){if(Tt!=null){if(typeof bt=="string")throw Error(`Error in ${_t}: pad must be an integer when using dimRoundingMode ${Tt} but got pad ${bt}.`);if(typeof bt=="number")B.vA(B.E6(bt),()=>`Error in ${_t}: pad must be an integer when using dimRoundingMode ${Tt} but got pad ${bt}.`);else{if(typeof bt!="object")throw Error(`Error in ${_t}: Unknown padding parameter: ${bt}`);bt.forEach(qt=>{qt.forEach(It=>{B.vA(B.E6(It),()=>`Error in ${_t}: pad must be an integer when using dimRoundingMode ${Tt} but got pad ${It}.`)})})}}}},9907:(L,O,S)=>{S.d(O,{g:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({cos_:function(Y){let X={x:(0,K.YT)(Y,"x","cos","float32")};return B.T2.runKernel(j.Mn0,X)}})},7451:(L,O,S)=>{S.d(O,{y:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({cosh_:function(Y){let X={x:(0,K.YT)(Y,"x","cosh","float32")};return B.T2.runKernel(j.MnK,X)}})},302:(L,O,S)=>{S.d(O,{L:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({cumprod_:function(Y,X=0,J=!1,q=!1){let H={x:(0,K.YT)(Y,"x","cumprod")},tt={axis:X,exclusive:J,reverse:q};return B.T2.runKernel(j.jj_,H,tt)}})},6808:(L,O,S)=>{S.d(O,{r:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({cumsum_:function(Y,X=0,J=!1,q=!1){let H={x:(0,K.YT)(Y,"x","cumsum")},tt={axis:X,exclusive:J,reverse:q};return B.T2.runKernel(j.nY8,H,tt)}})},1216:(L,O,S)=>{S.d(O,{R:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119);let Y=(0,S(929).op)({depthToSpace_:function(X,J,q="NHWC"){let H=(0,K.YT)(X,"x","depthToSpace","float32"),tt=q==="NHWC"?H.shape[1]:H.shape[2],st=q==="NHWC"?H.shape[2]:H.shape[3],lt=q==="NHWC"?H.shape[3]:H.shape[1];Z.vA(J>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${J}`),Z.vA(tt*J>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${tt} and ${J}  for depthToSpace with input shape
    ${H.shape}`),Z.vA(st*J>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${st} and ${J} for depthToSpace with input shape
        ${H.shape}`),Z.vA(lt%(J*J)==0,()=>`Dimension size must be evenly divisible by ${J*J} but is ${lt} for depthToSpace with input shape ${H.shape}`);let ft={x:H},gt={blockSize:J,dataFormat:q};return B.T2.runKernel(j.TMz,ft,gt)}})},676:(L,O,S)=>{S.d(O,{G:()=>q});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119),Y=S(7195),X=S(929),J=S(2302);let q=(0,X.op)({depthwiseConv2d_:function(H,tt,st,lt,ft="NHWC",gt=[1,1],xt){let wt=(0,K.YT)(H,"x","depthwiseConv2d","float32"),_t=(0,K.YT)(tt,"filter","depthwiseConv2d","float32"),bt=wt,Tt=!1;wt.rank===3&&(Tt=!0,bt=(0,J.t)(wt,[1,wt.shape[0],wt.shape[1],wt.shape[2]])),Z.vA(bt.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${bt.rank}.`),Z.vA(_t.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${_t.rank}.`);let qt=ft==="NHWC"?bt.shape[3]:bt.shape[1];Z.vA(qt===_t.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${qt}) must match the inChannels dimension in filter ${_t.shape[2]}.`),Y.s_("depthwiseConv2d",lt,xt);let It={x:bt,filter:_t},St={strides:st,pad:lt,dataFormat:ft,dilations:gt,dimRoundingMode:xt},vt=B.T2.runKernel(j.tGH,It,St);return Tt?(0,J.t)(vt,[vt.shape[1],vt.shape[2],vt.shape[3]]):vt}})},1890:(L,O,S)=>{S.d(O,{x:()=>Y});var B=S(1585),j=S(5441),K=S(929),Z=S(2302);let Y=(0,K.op)({depthwiseConv2dNativeBackpropFilter_:function(X,J,q,H,tt,st=[1,1],lt){let ft=X;X.rank===3&&(ft=(0,Z.t)(X,[1,X.shape[0],X.shape[1],X.shape[2]]));let gt=J;gt.rank===3&&(gt=(0,Z.t)(J,[1,J.shape[0],J.shape[1],J.shape[2]]));let xt={x:ft,dy:gt},wt={strides:H,pad:tt,dimRoundingMode:lt,dilations:st,filterShape:q};return B.T2.runKernel(j.X$8,xt,wt)}})},3134:(L,O,S)=>{S.d(O,{l:()=>Y});var B=S(1585),j=S(5441),K=S(929),Z=S(2302);let Y=(0,K.op)({depthwiseConv2dNativeBackpropInput_:function(X,J,q,H,tt,st=[1,1],lt){let ft=J,gt=!1;J.rank===3&&(gt=!0,ft=(0,Z.t)(J,[1,J.shape[0],J.shape[1],J.shape[2]]));let xt={dy:ft,filter:q},wt={strides:H,pad:tt,dimRoundingMode:lt,dilations:st,inputShape:X},_t=B.T2.runKernel(j.nVu,xt,wt);return gt?(0,Z.t)(_t,[_t.shape[1],_t.shape[2],_t.shape[3]]):_t}})},3002:(L,O,S)=>{S.d(O,{X:()=>J});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119),Y=S(929),X=S(2302);let J=(0,Y.op)({dilation2d_:function(q,H,tt,st,lt=[1,1],ft="NHWC"){let gt=(0,K.YT)(q,"x","dilation2d"),xt=(0,K.YT)(H,"filter","dilation2d");Z.vA(gt.rank===3||gt.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${gt.rank}.`),Z.vA(xt.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${xt.rank}.`),Z.vA(ft==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${ft}`);let wt=gt,_t=!1;gt.rank===3&&(wt=(0,X.t)(gt,[1,gt.shape[0],gt.shape[1],gt.shape[2]]),_t=!0),Z.vA(wt.shape[3]===xt.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${wt.shape[3]} vs ${xt.shape[2]}`);let bt={x:wt,filter:xt},Tt={strides:tt,pad:st,dilations:lt},qt=B.T2.runKernel(j.jxD,bt,Tt);return _t?(0,X.t)(qt,[qt.shape[1],qt.shape[2],qt.shape[3]]):qt}})},9359:(L,O,S)=>{S.d(O,{y:()=>X});var B=S(1585),j=S(5441),K=S(565),Z=S(8189),Y=S(8991);let X=(0,S(929).op)({div_:function(J,q){let H=(0,Z.YT)(J,"a","div"),tt=(0,Z.YT)(q,"b","div");if([H,tt]=(0,K.makeTypesMatch)(H,tt),H.dtype==="int32"&&tt.dtype==="int32")return(0,Y.w)(H,tt);let st={a:H,b:tt};return B.T2.runKernel(j.sDr,st,{})}})},919:(L,O,S)=>{S.d(O,{e:()=>q});var B=S(565),j=S(8189),K=S(9359),Z=S(3020),Y=S(929),X=S(2151),J=S(5537);let q=(0,Y.op)({divNoNan_:function(H,tt){let st=(0,j.YT)(H,"a","div"),lt=(0,j.YT)(tt,"b","div");[st,lt]=(0,B.makeTypesMatch)(st,lt);let ft=(0,K.y)(st,lt),gt=(0,J.P)(ft),xt=(0,Z.L)(lt,gt);return(0,X._)(xt,gt,ft)}})},9759:(L,O,S)=>{S.d(O,{O:()=>X});var B=S(8189),j=S(5119),K=S(5703),Z=S(929),Y=S(2302);let X=(0,Z.op)({dot_:function(J,q){let H=(0,B.YT)(J,"t1","dot"),tt=(0,B.YT)(q,"t2","dot");j.vA(!(H.rank!==1&&H.rank!==2||tt.rank!==1&&tt.rank!==2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${H.rank} and ${tt.rank}.`);let st=H.rank===1?H.size:H.shape[1],lt=tt.rank===1?tt.size:tt.shape[0];if(j.vA(st===lt,()=>`Error in dot: inner dimensions of inputs must match, but got ${st} and ${lt}.`),H.rank===1&&tt.rank===1){let ft=(0,Y.t)(H,[1,-1]),gt=(0,Y.t)(tt,[-1,1]),xt=(0,K.N)(ft,gt);return(0,Y.t)(xt,[])}if(H.rank===1&&tt.rank===2){let ft=(0,Y.t)(H,[1,-1]),gt=(0,Y.t)(tt,[tt.shape[0],tt.shape[1]]),xt=(0,K.N)(ft,gt);return(0,Y.t)(xt,[xt.size])}if(H.rank===2&&tt.rank===1){let ft=(0,Y.t)(tt,[-1,1]),gt=(0,K.N)(H,ft);return(0,Y.t)(gt,[gt.size])}{let ft=(0,Y.t)(tt,[tt.shape[0],tt.shape[1]]);return(0,K.N)(H,ft)}}})},3416:(L,O,S)=>{S.d(O,{P:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({elu_:function(Y){let X={x:(0,K.YT)(Y,"x","elu","float32")};return B.T2.runKernel(j.Pah,X)}})},3020:(L,O,S)=>{S.d(O,{L:()=>X});var B=S(1585),j=S(5441),K=S(565),Z=S(8189),Y=S(2198);let X=(0,S(929).op)({equal_:function(J,q){let H=(0,Z.YT)(J,"a","equal","string_or_numeric"),tt=(0,Z.YT)(q,"b","equal","string_or_numeric");[H,tt]=(0,K.makeTypesMatch)(H,tt),(0,Y.assertAndGetBroadcastShape)(H.shape,tt.shape);let st={a:H,b:tt};return B.T2.runKernel(j.BRl,st)}})},5207:(L,O,S)=>{S.d(O,{Y:()=>X});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119),Y=S(9809);let X=(0,S(929).op)({erf_:function(J){let q=(0,K.YT)(J,"x","erf");Z.vA(q.dtype==="int32"||q.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),q.dtype==="int32"&&(q=(0,Y.w)(q,"float32"));let H={x:q};return B.T2.runKernel(j._s9,H)}})},4881:(L,O,S)=>{S.d(O,{p:()=>j});var B=S(2596);let j=(0,S(929).op)({euclideanNorm_:function(K,Z=null,Y=!1){return(0,B.x)(K,"euclidean",Z,Y)}})},8631:(L,O,S)=>{S.d(O,{o:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({exp_:function(Y){let X={x:(0,K.YT)(Y,"x","exp")};return B.T2.runKernel(j.ox3,X)}})},8710:(L,O,S)=>{S.d(O,{U:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119);let Y=(0,S(929).op)({expandDims_:function(X,J=0){let q=(0,K.YT)(X,"x","expandDims","string_or_numeric");Z.vA(J<=q.rank,()=>"Axis must be <= rank of the tensor");let H={input:q},tt={dim:J};return B.T2.runKernel(j.ybN,H,tt)}})},517:(L,O,S)=>{S.d(O,{I:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({expm1_:function(Y){let X={x:(0,K.YT)(Y,"x","expm1")};return B.T2.runKernel(j.ybj,X)}})},6111:(L,O,S)=>{S.d(O,{G:()=>Z});var B=S(1585),j=S(5441),K=S(5119);function Z(Y,X,J){(0,K.SA)(Y);let q={shape:Y,value:X,dtype:J=J||(0,K.X$)(X)};return B.T2.runKernel(j.SQl,{},q)}},5606:(L,O,S)=>{S.d(O,{R:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({floor_:function(Y){let X={x:(0,K.YT)(Y,"x","floor","float32")};return B.T2.runKernel(j.ZgB,X)}})},8991:(L,O,S)=>{S.d(O,{w:()=>Y});var B=S(1585),j=S(5441),K=S(565),Z=S(8189);let Y=(0,S(929).op)({floorDiv_:function(X,J){let q=(0,Z.YT)(X,"a","floorDiv"),H=(0,Z.YT)(J,"b","floorDiv");[q,H]=(0,K.makeTypesMatch)(q,H);let tt={a:q,b:H};return B.T2.runKernel(j.ElG,tt)}})},8646:(L,O,S)=>{S.d(O,{Do:()=>ft,XB:()=>lt,f2:()=>gt,zE:()=>xt});var B=S(2198),j=S(3416),K=S(6919),Z=S(9258),Y=S(4394),X=S(112),J=S(3732),q=S(2302),H=S(8968),tt=S(700),st=S(3791);function lt(wt,_t,bt){if(bt==null||bt==="linear")return wt;if(bt==="relu")return(0,Z.l)(wt,(0,tt.P)(_t));throw new Error(`Cannot compute gradient for fused activation ${bt}.`)}function ft(wt,_t){let bt=_t,Tt=B.getReductionAxes(wt.shape,_t.shape);return Tt.length>0&&(bt=(0,st.c)(bt,Tt)),(0,q.t)(bt,wt.shape)}function gt(wt,_t,bt,Tt){if(_t==="linear")return wt;if(_t==="relu")return(0,X.V)(wt);if(_t==="elu")return(0,j.P)(wt);if(_t==="relu6")return(0,J.j)(wt);if(_t==="prelu")return(0,Y.N)(wt,bt);if(_t==="leakyrelu")return(0,K.H)(wt,Tt);if(_t==="sigmoid")return(0,H.r)(wt);throw new Error(`Unknown fused activation ${_t}.`)}let xt=(wt,_t)=>!(wt>0)||_t==="linear"},8229:(L,O,S)=>{S.d(O,{k:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({gather_:function(Y,X,J=0,q=0){let H={x:(0,K.YT)(Y,"x","gather"),indices:(0,K.YT)(X,"indices","gather","int32")},tt={axis:J,batchDims:q};return B.T2.runKernel(j.mxL,H,tt)}})},2058:(L,O,S)=>{S.d(O,{r:()=>X});var B=S(1585),j=S(5441),K=S(565),Z=S(8189),Y=S(2198);let X=(0,S(929).op)({greater_:function(J,q){let H=(0,Z.YT)(J,"a","greater","string_or_numeric"),tt=(0,Z.YT)(q,"b","greater","string_or_numeric");[H,tt]=(0,K.makeTypesMatch)(H,tt),(0,Y.assertAndGetBroadcastShape)(H.shape,tt.shape);let st={a:H,b:tt};return B.T2.runKernel(j.XhZ,st)}})},3337:(L,O,S)=>{S.d(O,{D:()=>X});var B=S(1585),j=S(5441),K=S(565),Z=S(8189),Y=S(2198);let X=(0,S(929).op)({greaterEqual_:function(J,q){let H=(0,Z.YT)(J,"a","greaterEqual","string_or_numeric"),tt=(0,Z.YT)(q,"b","greaterEqual","string_or_numeric");[H,tt]=(0,K.makeTypesMatch)(H,tt),(0,Y.assertAndGetBroadcastShape)(H.shape,tt.shape);let st={a:H,b:tt};return B.T2.runKernel(j.lLS,st)}})},5040:(L,O,S)=>{S.d(O,{n:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({imag_:function(Y){let X={input:(0,K.YT)(Y,"input","imag")};return B.T2.runKernel(j.dv8,X)}})},4711:(L,O,S)=>{S.d(O,{v:()=>J});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119),Y=S(929),X=S(2302);let J=(0,Y.op)({resizeBilinear_:function(q,H,tt=!1,st=!1){let lt=(0,K.YT)(q,"images","resizeBilinear");Z.vA(lt.rank===3||lt.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${lt.rank}.`),Z.vA(H.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${H}.`),Z.vA(st===!1||tt===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let ft=lt,gt=!1;lt.rank===3&&(gt=!0,ft=(0,X.t)(lt,[1,lt.shape[0],lt.shape[1],lt.shape[2]]));let xt={images:ft},wt={alignCorners:tt,halfPixelCenters:st,size:H},_t=B.T2.runKernel(j.hgw,xt,wt);return gt?(0,X.t)(_t,[_t.shape[1],_t.shape[2],_t.shape[3]]):_t}})},2954:(L,O,S)=>{S.d(O,{b:()=>J});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119),Y=S(929),X=S(2302);let J=(0,Y.op)({resizeNearestNeighbor_:function(q,H,tt=!1,st=!1){let lt=(0,K.YT)(q,"images","resizeNearestNeighbor");Z.vA(lt.rank===3||lt.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${lt.rank}.`),Z.vA(H.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${H}.`),Z.vA(lt.dtype==="float32"||lt.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),Z.vA(st===!1||tt===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let ft=lt,gt=!1;lt.rank===3&&(gt=!0,ft=(0,X.t)(lt,[1,lt.shape[0],lt.shape[1],lt.shape[2]]));let xt={images:ft},wt={alignCorners:tt,halfPixelCenters:st,size:H},_t=B.T2.runKernel(j.jOE,xt,wt);return gt?(0,X.t)(_t,[_t.shape[1],_t.shape[2],_t.shape[3]]):_t}})},8318:(L,O,S)=>{S.d(O,{M:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({isFinite_:function(Y){let X={x:(0,K.YT)(Y,"x","isFinite")};return B.T2.runKernel(j.gIW,X)}})},3454:(L,O,S)=>{S.d(O,{E:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({isInf_:function(Y){let X={x:(0,K.YT)(Y,"x","isInf")};return B.T2.runKernel(j.E3$,X)}})},6300:(L,O,S)=>{S.d(O,{y:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({isNaN_:function(Y){let X={x:(0,K.YT)(Y,"x","isNaN")};return B.T2.runKernel(j.iPs,X)}})},6919:(L,O,S)=>{S.d(O,{H:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({leakyRelu_:function(Y,X=.2){let J={x:(0,K.YT)(Y,"x","leakyRelu")},q={alpha:X};return B.T2.runKernel(j.X0$,J,q)}})},1303:(L,O,S)=>{S.d(O,{M:()=>X});var B=S(1585),j=S(5441),K=S(565),Z=S(8189),Y=S(2198);let X=(0,S(929).op)({less_:function(J,q){let H=(0,Z.YT)(J,"a","less","string_or_numeric"),tt=(0,Z.YT)(q,"b","less","string_or_numeric");[H,tt]=(0,K.makeTypesMatch)(H,tt),(0,Y.assertAndGetBroadcastShape)(H.shape,tt.shape);let st={a:H,b:tt};return B.T2.runKernel(j.mIA,st)}})},6508:(L,O,S)=>{S.d(O,{I:()=>X});var B=S(1585),j=S(5441),K=S(565),Z=S(8189),Y=S(2198);let X=(0,S(929).op)({lessEqual_:function(J,q){let H=(0,Z.YT)(J,"a","lessEqual","string_or_numeric"),tt=(0,Z.YT)(q,"b","lessEqual","string_or_numeric");[H,tt]=(0,K.makeTypesMatch)(H,tt),(0,Y.assertAndGetBroadcastShape)(H.shape,tt.shape);let st={a:H,b:tt};return B.T2.runKernel(j.CwD,st)}})},3531:(L,O,S)=>{S.d(O,{K:()=>J});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119),Y=S(929),X=S(2302);let J=(0,Y.op)({localResponseNormalization_:function(q,H=5,tt=1,st=1,lt=.5){let ft=(0,K.YT)(q,"x","localResponseNormalization");Z.vA(ft.rank===4||ft.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${ft.rank}.`),Z.vA(Z.E6(H),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${H}.`);let gt=ft,xt=!1;ft.rank===3&&(xt=!0,gt=(0,X.t)(ft,[1,ft.shape[0],ft.shape[1],ft.shape[2]]));let wt={x:gt},_t={depthRadius:H,bias:tt,alpha:st,beta:lt},bt=B.T2.runKernel(j.jM4,wt,_t);return xt?(0,X.t)(bt,[bt.shape[1],bt.shape[2],bt.shape[3]]):bt}})},4010:(L,O,S)=>{S.d(O,{R:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({log_:function(Y){let X={x:(0,K.YT)(Y,"x","log","float32")};return B.T2.runKernel(j.tG8,X)}})},2015:(L,O,S)=>{S.d(O,{K:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({log1p_:function(Y){let X={x:(0,K.YT)(Y,"x","log1p")};return B.T2.runKernel(j.Cg$,X)}})},5645:(L,O,S)=>{S.d(O,{n:()=>q});var B=S(1830),j=S(8189),K=S(9258),Z=S(6522),Y=S(929),X=S(8968),J=S(6030);let q=(0,Y.op)({logSigmoid_:function(H){let tt=(0,j.YT)(H,"x","logSigmoid");return(0,B._X)(st=>({value:(0,Z.H)((0,J.l)((0,Z.H)(st))),gradFunc:lt=>(0,K.l)(lt,(0,X.r)((0,Z.H)(st)))}))(tt)}})},7991:(L,O,S)=>{S.d(O,{H:()=>st});var B=S(1830),j=S(8189),K=S(9809),Z=S(8631),Y=S(4010),X=S(1938),J=S(9258),q=S(929),H=S(7126),tt=S(3791);let st=(0,q.op)({logSoftmax_:function(lt,ft=-1){let gt=(0,j.YT)(lt,"logits","logSoftmax");if(ft===-1&&(ft=gt.rank-1),ft!==gt.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${gt.rank} and axis was ${ft}`);return(0,B._X)((xt,wt)=>{let _t=(0,X.T)(xt,ft,!0),bt=(0,H.j)(xt,_t),Tt=(0,H.j)((0,K.w)(bt,"float32"),(0,Y.R)((0,tt.c)((0,Z.o)(bt),ft,!0)));return wt([Tt]),{value:Tt,gradFunc:(qt,It)=>{let[St]=It,vt=(0,Z.o)(St);return(0,H.j)(qt,(0,J.l)((0,tt.c)(qt,ft,!0),vt))}}})(gt)}})},3330:(L,O,S)=>{S.d(O,{V:()=>lt});var B=S(8189),j=S(5119),K=S(7523),Z=S(1078),Y=S(8631),X=S(4010),J=S(1938),q=S(929),H=S(2302),tt=S(7126),st=S(3791);let lt=(0,q.op)({logSumExp_:function(ft,gt=null,xt=!1){let wt=(0,B.YT)(ft,"x","logSumExp"),_t=(0,j.Y6)(gt,wt.shape),bt=(0,J.T)(wt,_t,!0),Tt=(0,tt.j)(wt,bt),qt=(0,Y.o)(Tt),It=(0,st.c)(qt,_t),St=(0,X.R)(It),vt=(0,K.W)((0,H.t)(bt,St.shape),St);if(xt){let Ft=(0,Z.SM)(vt.shape,_t);return(0,H.t)(vt,Ft)}return vt}})},3789:(L,O,S)=>{S.d(O,{n:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(2198);let Y=(0,S(929).op)({logicalAnd_:function(X,J){let q=(0,K.YT)(X,"a","logicalAnd","bool"),H=(0,K.YT)(J,"b","logicalAnd","bool");(0,Z.assertAndGetBroadcastShape)(q.shape,H.shape);let tt={a:q,b:H};return B.T2.runKernel(j.RUm,tt)}})},9881:(L,O,S)=>{S.d(O,{N:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({logicalNot_:function(Y){let X={x:(0,K.YT)(Y,"x","logicalNot","bool")};return B.T2.runKernel(j.nZd,X)}})},9879:(L,O,S)=>{S.d(O,{z:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(2198);let Y=(0,S(929).op)({logicalOr_:function(X,J){let q=(0,K.YT)(X,"a","logicalOr","bool"),H=(0,K.YT)(J,"b","logicalOr","bool");(0,Z.assertAndGetBroadcastShape)(q.shape,H.shape);let tt={a:q,b:H};return B.T2.runKernel(j.LXA,tt)}})},9925:(L,O,S)=>{S.d(O,{r:()=>X});var B=S(8189),j=S(2198),K=S(3789),Z=S(9881),Y=S(9879);let X=(0,S(929).op)({logicalXor_:function(J,q){let H=(0,B.YT)(J,"a","logicalXor","bool"),tt=(0,B.YT)(q,"b","logicalXor","bool");return(0,j.assertAndGetBroadcastShape)(H.shape,tt.shape),(0,K.n)((0,Y.z)(J,q),(0,Z.N)((0,K.n)(J,q)))}})},4703:(L,O,S)=>{var B;S.d(O,{i:()=>B}),function(j){j[j.NONE=0]="NONE",j[j.MEAN=1]="MEAN",j[j.SUM=2]="SUM",j[j.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(B||(B={}))},5703:(L,O,S)=>{S.d(O,{N:()=>Y});var B=S(1585),j=S(5441),K=S(565),Z=S(8189);let Y=(0,S(929).op)({matMul_:function(X,J,q=!1,H=!1){let tt=(0,Z.YT)(X,"a","matMul"),st=(0,Z.YT)(J,"b","matMul");[tt,st]=(0,K.makeTypesMatch)(tt,st);let lt={a:tt,b:st},ft={transposeA:q,transposeB:H};return B.T2.runKernel(j.jAQ,lt,ft)}})},1938:(L,O,S)=>{S.d(O,{T:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({max_:function(Y,X=null,J=!1){let q={x:(0,K.YT)(Y,"x","max")},H={reductionIndices:X,keepDims:J};return B.T2.runKernel(j.VAI,q,H)}})},6999:(L,O,S)=>{S.d(O,{j:()=>q});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119),Y=S(7195),X=S(929),J=S(2302);let q=(0,X.op)({maxPool_:function(H,tt,st,lt,ft){let gt=(0,K.YT)(H,"x","maxPool"),xt=gt,wt=!1;gt.rank===3&&(wt=!0,xt=(0,J.t)(gt,[1,gt.shape[0],gt.shape[1],gt.shape[2]])),Z.vA(xt.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${xt.rank}.`),Z.vA(Y.G0(st,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${st} and dilations '1'`),Y.s_("maxPool",lt,ft);let _t={x:xt},bt={filterSize:tt,strides:st,pad:lt,dimRoundingMode:ft},Tt=B.T2.runKernel(j.t3d,_t,bt);return wt?(0,J.t)(Tt,[Tt.shape[1],Tt.shape[2],Tt.shape[3]]):Tt}})},178:(L,O,S)=>{S.d(O,{P:()=>J});var B=S(1585),j=S(5441),K=S(565),Z=S(8189),Y=S(2198),X=S(9809);let J=(0,S(929).op)({maximum_:function(q,H){let tt=(0,Z.YT)(q,"a","maximum"),st=(0,Z.YT)(H,"b","maximum");[tt,st]=(0,K.makeTypesMatch)(tt,st),tt.dtype==="bool"&&(tt=(0,X.w)(tt,"int32"),st=(0,X.w)(st,"int32")),(0,Y.assertAndGetBroadcastShape)(tt.shape,st.shape);let lt={a:tt,b:st};return B.T2.runKernel(j.LDN,lt)}})},2611:(L,O,S)=>{S.d(O,{i:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({mean_:function(Y,X=null,J=!1){let q={x:(0,K.YT)(Y,"x","mean")},H={axis:X,keepDims:J};return B.T2.runKernel(j.g5A,q,H)}})},7436:(L,O,S)=>{S.d(O,{j:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({min_:function(Y,X=null,J=!1){let q={x:(0,K.YT)(Y,"x","min")},H={axis:X,keepDims:J};return B.T2.runKernel(j.lNG,q,H)}})},2644:(L,O,S)=>{S.d(O,{B:()=>J});var B=S(1585),j=S(5441),K=S(565),Z=S(8189),Y=S(2198),X=S(9809);let J=(0,S(929).op)({minimum_:function(q,H){let tt=(0,Z.YT)(q,"a","minimum"),st=(0,Z.YT)(H,"b","minimum");[tt,st]=(0,K.makeTypesMatch)(tt,st),tt.dtype==="bool"&&(tt=(0,X.w)(tt,"int32"),st=(0,X.w)(st,"int32")),(0,Y.assertAndGetBroadcastShape)(tt.shape,st.shape);let lt={a:tt,b:st};return B.T2.runKernel(j.LG0,lt)}})},6567:(L,O,S)=>{S.d(O,{F:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119);let Y=(0,S(929).op)({mirrorPad_:function(X,J,q){Z.vA(q==="reflect"||q==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${q}.`);let H=(0,K.YT)(X,"x","mirrorPad");if(H.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");Z.vA(J.length===H.rank,()=>`Padding doesn't match input. Must be ${H.rank}. Got ${J.length}.`);let tt=q==="reflect"?1:0;for(let ft=0;ft<H.rank;ft++)Z.vA(J[ft].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Z.vA(J[ft][0]>=0&&J[ft][0]<=H.shape[ft]-tt&&J[ft][1]>=0&&J[ft][1]<=H.shape[ft]-tt,()=>`Padding in dimension ${ft} cannot be greater than or equal to ${H.shape[ft]-tt} or less than 0 for input of shape ${H.shape}`);let st={paddings:J,mode:q},lt={x:H};return B.T2.runKernel(j.x7F,lt,st)}})},152:(L,O,S)=>{S.d(O,{z:()=>Y});var B=S(1585),j=S(5441),K=S(565),Z=S(8189);let Y=(0,S(929).op)({mod_:function(X,J){let q=(0,Z.YT)(X,"a","mod"),H=(0,Z.YT)(J,"b","mod");[q,H]=(0,K.makeTypesMatch)(q,H);let tt={a:q,b:H};return B.T2.runKernel(j.BLA,tt)}})},9258:(L,O,S)=>{S.d(O,{l:()=>Y});var B=S(1585),j=S(5441),K=S(565),Z=S(8189);let Y=(0,S(929).op)({mul_:function(X,J){let q=(0,Z.YT)(X,"a","mul"),H=(0,Z.YT)(J,"b","mul");[q,H]=(0,K.makeTypesMatch)(q,H);let tt={a:q,b:H};return B.T2.runKernel(j.xu7,tt)}})},6522:(L,O,S)=>{S.d(O,{H:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({neg_:function(Y){let X={x:(0,K.YT)(Y,"x","neg")};return B.T2.runKernel(j.l0G,X)}})},2596:(L,O,S)=>{S.d(O,{x:()=>xt});var B=S(8189),j=S(5119),K=S(4888),Z=S(1078),Y=S(1938),X=S(7436),J=S(929),q=S(8990),H=S(2302),tt=S(5702),st=S(9348),lt=S(5793),ft=S(3791);function gt(wt,_t,bt=null){if(wt.rank===0)return(0,K.t)(wt);if(wt.rank!==1&&bt===null)return gt((0,H.t)(wt,[-1]),_t,bt);if(wt.rank===1||typeof bt=="number"||Array.isArray(bt)&&bt.length===1){if(_t===1)return(0,ft.c)((0,K.t)(wt),bt);if(_t===1/0)return(0,Y.T)((0,K.t)(wt),bt);if(_t===-1/0)return(0,X.j)((0,K.t)(wt),bt);if(_t==="euclidean"||_t===2)return(0,st.R)((0,ft.c)((0,q.n)((0,K.t)(wt),(0,tt.d)(2,"int32")),bt));throw new Error(`Error in norm: invalid ord value: ${_t}`)}if(Array.isArray(bt)&&bt.length===2){if(_t===1)return(0,Y.T)((0,ft.c)((0,K.t)(wt),bt[0]),bt[1]-1);if(_t===1/0)return(0,Y.T)((0,ft.c)((0,K.t)(wt),bt[1]),bt[0]);if(_t===-1/0)return(0,X.j)((0,ft.c)((0,K.t)(wt),bt[1]),bt[0]);if(_t==="fro"||_t==="euclidean")return(0,st.R)((0,ft.c)((0,lt.E)(wt),bt));throw new Error(`Error in norm: invalid ord value: ${_t}`)}throw new Error(`Error in norm: invalid axis: ${bt}`)}let xt=(0,J.op)({norm_:function(wt,_t="euclidean",bt=null,Tt=!1){let qt=gt(wt=(0,B.YT)(wt,"x","norm"),_t,bt),It=qt.shape;if(Tt){let St=(0,j.Y6)(bt,wt.shape);It=Z.SM(qt.shape,St)}return(0,H.t)(qt,It)}})},2118:(L,O,S)=>{S.d(O,{E:()=>X});var B=S(1585),j=S(5441),K=S(565),Z=S(8189),Y=S(2198);let X=(0,S(929).op)({notEqual_:function(J,q){let H=(0,Z.YT)(J,"a","notEqual","string_or_numeric"),tt=(0,Z.YT)(q,"b","notEqual","string_or_numeric");[H,tt]=(0,K.makeTypesMatch)(H,tt),(0,Y.assertAndGetBroadcastShape)(H.shape,tt.shape);let st={a:H,b:tt};return B.T2.runKernel(j.ylV,st)}})},1760:(L,O,S)=>{S.d(O,{M:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({oneHot_:function(Y,X,J=1,q=0,H="int32"){if(X<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${X}`);let tt={indices:(0,K.YT)(Y,"indices","oneHot","int32")},st={dtype:H,depth:X,onValue:J,offValue:q};return B.T2.runKernel(j.urI,tt,st)}})},1411:(L,O,S)=>{S.d(O,{S:()=>Y});var B=S(1585),j=S(5119),K=S(7148),Z=S(2855);function Y(X,J="float32"){if((0,j.SA)(X),J==="complex64"){let H=Y(X,"float32"),tt=(0,Z.U)(X,"float32");return(0,K.f)(H,tt)}let q=(0,j.FZ)((0,j.Ze)(X),J);return B.T2.makeTensor(q,X,J)}},9885:(L,O,S)=>{S.d(O,{P:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({onesLike_:function(Y){let X={x:(0,K.YT)(Y,"x","onesLike")};return B.T2.runKernel(j.LWX,X)}})},929:(L,O,S)=>{S.d(O,{B:()=>K,op:()=>Z});var B=S(1585),j=S(5119);let K="__op";function Z(Y){let X=Object.keys(Y);if(X.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${X.length} keys.`);let J=X[0],q=Y[J];J.endsWith("_")&&(J=J.substring(0,J.length-1)),J+=K;let H=(...tt)=>{B.T2.startScope(J);try{let st=q(...tt);return(0,j.yL)(st)&&console.error("Cannot return a Promise inside of tidy."),B.T2.endScope(st),st}catch(st){throw B.T2.endScope(null),st}};return Object.defineProperty(H,"name",{value:J,configurable:!0}),H}},7270:(L,O,S)=>{S.d(O,{BTT:()=>tt.B,tnl:()=>j.t,HQu:()=>K.H,FqL:()=>Z.F,WQq:()=>Y.W,QiD:()=>st,Q7R:()=>lt.Q,bzn:()=>ft.b,FLi:()=>gt.F,XRg:()=>xt.X,qRo:()=>wt.q,yHs:()=>_t.y,rYl:()=>bt.r,FPz:()=>Tt.F,rfv:()=>qt.r,$jT:()=>It.$,sub:()=>Qt,lZX:()=>we,$v7:()=>m.$,BFc:()=>ye,kSi:()=>Ge,T5N:()=>te,GTe:()=>ie.G,HbZ:()=>Me,vjT:()=>Ye,ftb:()=>mh,ROE:()=>Ue,hOW:()=>kn.h,ra8:()=>mn.r,wgE:()=>St.w,mkO:()=>Kn.m,zQh:()=>Sn.z,o8B:()=>Wn.o,faB:()=>Ze.f,xWs:()=>Gt.x,I1m:()=>de,RPU:()=>Re,O5O:()=>Kt,P1l:()=>Jt,kA9:()=>Ae.k,Xtf:()=>$e.X,wX9:()=>tn.w,IPL:()=>wn,jIJ:()=>Hn,gnS:()=>Zn.g,yIG:()=>_r.y,_jP:()=>xo,Lp0:()=>Sr.L,rCv:()=>Mr.r,aOp:()=>ai,Rj8:()=>ea.R,Gl3:()=>Pi.G,smy:()=>Cr,X7t:()=>Ti.X,y4m:()=>Be.y,ek5:()=>En.e,Omf:()=>lr.O,EZY:()=>wv,_3C:()=>qn,Pqc:()=>fr.P,FJY:()=>$u,QP2:()=>Er,LCg:()=>Qr.L,Y12:()=>vi.Y,p4S:()=>ua.p,oNF:()=>br.o,UG6:()=>eo.U,IYd:()=>Fo.I,y5U:()=>Le,hVP:()=>yt.h,GSj:()=>bn.G,RIf:()=>jn.R,wh_:()=>Jn.w,cZk:()=>B,kgh:()=>dr.k,SY9:()=>qh,rhj:()=>Ur.r,DQN:()=>or.D,KGM:()=>D.K,ngS:()=>Yn.n,Slp:()=>Ad,U4u:()=>Xh,ggX:()=>U.g,MIs:()=>li.M,EN4:()=>Ki.E,yrW:()=>Si.y,H8d:()=>Da.H,M7h:()=>_i.M,InN:()=>la.I,mPL:()=>N5,mT8:()=>so,Kgs:()=>ys.K,Rm2:()=>vs.R,Kko:()=>qo.K,nqI:()=>bs.n,HPB:()=>na.H,VZ:()=>va.V,n76:()=>Ya.n,NSZ:()=>Xo.N,ztW:()=>Du.z,rxB:()=>uu.r,YYh:()=>kw,yzS:()=>Ru,NoW:()=>ge.N,T9B:()=>Ko.T,jgi:()=>Ga.j,NYV:()=>Fu,RO:()=>Zs,PhQ:()=>Rc.P,i2o:()=>bu.i,OYQ:()=>Tl,jkA:()=>Zo.j,BpO:()=>ji.B,FFZ:()=>Ku.F,ziu:()=>Zu.z,Clk:()=>_n,CRk:()=>bv,lKK:()=>ee.l,YDF:()=>ls,OjQ:()=>Dt,HZy:()=>Zt.H,xbf:()=>yn.x,Ec:()=>Ce.E,Mw0:()=>le.M,SaS:()=>Qs.S,P61:()=>Pe.P,op:()=>tt.op,X4o:()=>rn,eVF:()=>Cn.e,BZs:()=>Vn,grY:()=>hr,XHu:()=>Kr,WLX:()=>$i,dzn:()=>Ai.d,n7C:()=>Rr.n,NsG:()=>Jr.N,yyV:()=>di.y,_eU:()=>bi._,whe:()=>Ci,iyU:()=>ra,Q0_:()=>oa,_9M:()=>Wr,pR9:()=>Ta,FE$:()=>Dn,m0H:()=>Ui,YeY:()=>sa,HYA:()=>ks,y17:()=>Po,xav:()=>ku.x,VOZ:()=>io.V,VVh:()=>an.V,j__:()=>Ms.j,tQQ:()=>Ft.t,BEg:()=>lu.B,QD2:()=>Ul,LMr:()=>Ou,I2l:()=>Lu,JYU:()=>Ed,z8$:()=>et.z,LIG:()=>Fc.L,Z$r:()=>ni.Z,d_2:()=>Zr.d,NFr:()=>bw,sZg:()=>Ra,WfX:()=>Qu.W,wdz:()=>Wl.w,F12:()=>Yh,ry7:()=>Ee.r,_SZ:()=>Ba._,vPA:()=>I5,F8e:()=>$s.F,L0l:()=>Oc.L,dik:()=>Bt.d,Q$M:()=>oc,zAd:()=>sc,wck:()=>Lc,R0O:()=>Ju,Vs9:()=>ph.V,lw0:()=>$c.l,eDJ:()=>uc.e,lMo:()=>M5,Zhr:()=>i0,lOn:()=>bf,lDo:()=>ut.l,RZD:()=>pt.R,EwI:()=>xu.E,Pbu:()=>mt.P,r2V:()=>At.r,t$z:()=>zt.t,PMw:()=>pe.P,Ym9:()=>We.Y,YjP:()=>D5,jbE:()=>pa.j,czq:()=>Ke.c,Mlm:()=>Tn.M,ymU:()=>Xt.y,OEK:()=>nn.O,tGX:()=>zn,KtR:()=>In,$_$:()=>Or.$,g9W:()=>oi,Lpo:()=>ur,yxw:()=>Na,NNh:()=>Lr,Vsq:()=>Wa.V,rfw:()=>wi.r,mgz:()=>Gl.m,efE:()=>cs,AmM:()=>Js.A,zAU:()=>zs.z,K$i:()=>pi.K,rni:()=>cu,bvq:()=>Vl,_M9:()=>Al._,YJN:()=>zc,Ul9:()=>r0.U,POl:()=>vw.P});var B={};S.r(B),S.d(B,{conv2d:()=>fn,depthwiseConv2d:()=>pr,matMul:()=>Yr});var j=S(4888),K=S(2804),Z=S(7558),Y=S(7523),X=S(1585),J=S(5441),q=S(8189),H=S(5119),tt=S(929);let st=(0,tt.op)({addN_:function(Ne){H.vA(Array.isArray(Ne),()=>"The argument passed to tf.addN() must be a list of tensors"),H.vA(Ne.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${Ne.length}`);let Se=Ne.map((Te,Fe)=>(0,q.YT)(Te,`tensors${Fe}`,"addN")),ke=Se[0];Se.forEach(Te=>{if(Te.dtype!==ke.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),Se.forEach(Te=>{if(!H.r1(Te.shape,ke.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});let ve=Se;return X.T2.runKernel(J.EkD,ve)}});var lt=S(2307),ft=S(9326),gt=S(897),xt=S(4339),wt=S(6841),_t=S(269),bt=S(9580),Tt=S(1404),qt=S(3774),It=S(3909),St=S(9809),vt=S(7195),Ft=S(2302);let Qt=(0,tt.op)({avgPool3d_:function(Ne,Se,ke,ve,Te,Fe="NDHWC"){let je=(0,q.YT)(Ne,"x","avgPool3d","float32"),hn=je,Pn=!1;je.rank===4&&(Pn=!0,hn=(0,Ft.t)(je,[1,je.shape[0],je.shape[1],je.shape[2],je.shape[3]])),H.vA(hn.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${hn.rank}.`),H.vA(Fe==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${Fe}`),H.vA(typeof ke=="number"&&ke>0||Array.isArray(ke)&&ke[0]>0&&ke[1]>0&&ke[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${ke}'`),(0,vt.s_)("avgPool3d",ve,Te);let On={x:hn},sr={filterSize:Se,strides:ke,pad:ve,dimRoundingMode:Te,dataFormat:Fe},ir=X.T2.runKernel(J.cS,On,sr);return ir=(0,St.w)(ir,hn.dtype),Pn?(0,Ft.t)(ir,[ir.shape[1],ir.shape[2],ir.shape[3],ir.shape[4]]):ir}});var Gt=S(5030),ge=S(5703),ee=S(9258),Ee=S(8968),Bt=S(7986),Xt=S(7311);let we=(0,tt.op)({basicLSTMCell_:function(Ne,Se,ke,ve,Te,Fe){let je=(0,q.YT)(Ne,"forgetBias","basicLSTMCell"),hn=(0,q.YT)(Se,"lstmKernel","basicLSTMCell"),Pn=(0,q.YT)(ke,"lstmBias","basicLSTMCell"),On=(0,q.YT)(ve,"data","basicLSTMCell"),sr=(0,q.YT)(Te,"c","basicLSTMCell"),ir=(0,q.YT)(Fe,"h","basicLSTMCell"),Xr=(0,Gt.x)([On,ir],1),Pr=(0,ge.N)(Xr,hn),ci=(0,Y.W)(Pr,Pn),Fa=ci.shape[0],Ha=ci.shape[1]/4,Vr=[Fa,Ha],Vi=(0,Bt.d)(ci,[0,0],Vr),Bs=(0,Bt.d)(ci,[0,Ha],Vr),tu=(0,Bt.d)(ci,[0,2*Ha],Vr),To=(0,Bt.d)(ci,[0,3*Ha],Vr),ja=(0,Y.W)((0,ee.l)((0,Ee.r)(Vi),(0,Xt.y)(Bs)),(0,ee.l)(sr,(0,Ee.r)((0,Y.W)(je,tu))));return[ja,(0,ee.l)((0,Xt.y)(ja),(0,Ee.r)(To))]}});var ie=S(9772),m=S(9160);let ye=(0,tt.op)({batchNorm2d_:function(Ne,Se,ke,ve,Te,Fe){let je=(0,q.YT)(Ne,"x","batchNorm"),hn=(0,q.YT)(Se,"mean","batchNorm"),Pn=(0,q.YT)(ke,"variance","batchNorm"),On,sr;return Te!=null&&(On=(0,q.YT)(Te,"scale","batchNorm")),ve!=null&&(sr=(0,q.YT)(ve,"offset","batchNorm")),H.vA(je.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${je.rank}.`),H.vA(hn.rank===2||hn.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${hn.rank}.`),H.vA(Pn.rank===2||Pn.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${Pn.rank}.`),On!=null&&H.vA(On.rank===2||On.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${On.rank}.`),sr!=null&&H.vA(sr.rank===2||sr.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${sr.rank}.`),(0,m.$)(je,hn,Pn,sr,On,Fe)}}),Ge=(0,tt.op)({batchNorm3d_:function(Ne,Se,ke,ve,Te,Fe){let je=(0,q.YT)(Ne,"x","batchNorm"),hn=(0,q.YT)(Se,"mean","batchNorm"),Pn=(0,q.YT)(ke,"variance","batchNorm"),On,sr;return Te!=null&&(On=(0,q.YT)(Te,"scale","batchNorm")),ve!=null&&(sr=(0,q.YT)(ve,"offset","batchNorm")),H.vA(je.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${je.rank}.`),H.vA(hn.rank===3||hn.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${hn.rank}.`),H.vA(Pn.rank===3||Pn.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${Pn.rank}.`),On!=null&&H.vA(On.rank===3||On.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${On.rank}.`),sr!=null&&H.vA(sr.rank===3||sr.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${sr.rank}.`),(0,m.$)(je,hn,Pn,sr,On,Fe)}}),te=(0,tt.op)({batchNorm4d_:function(Ne,Se,ke,ve,Te,Fe){let je=(0,q.YT)(Ne,"x","batchNorm"),hn=(0,q.YT)(Se,"mean","batchNorm"),Pn=(0,q.YT)(ke,"variance","batchNorm"),On,sr;return Te!=null&&(On=(0,q.YT)(Te,"scale","batchNorm")),ve!=null&&(sr=(0,q.YT)(ve,"offset","batchNorm")),H.vA(je.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${je.rank}.`),H.vA(hn.rank===4||hn.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${hn.rank}.`),H.vA(Pn.rank===4||Pn.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${Pn.rank}.`),On!=null&&H.vA(On.rank===4||On.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${On.rank}.`),sr!=null&&H.vA(sr.rank===4||sr.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${sr.rank}.`),(0,m.$)(je,hn,Pn,sr,On,Fe)}}),Me=(0,tt.op)({bincount_:function(Ne,Se,ke){let ve=(0,q.YT)(Ne,"x","bincount"),Te=(0,q.YT)(Se,"weights","bincount");H.vA(ve.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${ve.dtype}`),H.vA(ke>=0,()=>`size must be non-negative, but got ${ke}.`),H.vA(Te.size===ve.size||Te.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${ve.shape}, weights shape: ${Te.shape}.`);let Fe={x:ve,weights:Te},je={size:ke};return X.T2.runKernel(J.N4F,Fe,je)}}),Ye=(0,tt.op)({bitwiseAnd_:function(Ne,Se){let ke=(0,q.YT)(Ne,"x","bitwiseAnd"),ve=(0,q.YT)(Se,"y","bitwiseAnd");if(!(0,H.r1)(ke.shape,ve.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${ke.shape}, y: ${ve.shape}`);if(ke.dtype!=="int32"||ve.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${ke.dtype} and type of y: ${ve.dtype}`);let Te={a:ke,b:ve};return X.T2.runKernel(J.HNs,Te)}}),Ue=(0,tt.op)({broadcastArgs_:function(Ne,Se){let ke=(0,q.YT)(Ne,"s0","broadcastArgs","int32"),ve=(0,q.YT)(Se,"s1","broadcastArgs","int32");if(ke.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${ke.rank}`);if(ve.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${ve.rank}`);let Te={s0:ke,s1:ve};return X.T2.runKernel(J.vj7,Te)}});var kn=S(3567),mn=S(448),Kn=S(855),Sn=S(6928),Wn=S(125),Ze=S(7148);let de=(0,tt.op)({concat1d_:function(Ne){return(0,Gt.x)(Ne,0)}}),Re=(0,tt.op)({concat2d_:function(Ne,Se){return(0,Gt.x)(Ne,Se)}}),Kt=(0,tt.op)({concat3d_:function(Ne,Se){return(0,Gt.x)(Ne,Se)}}),Jt=(0,tt.op)({concat4d_:function(Ne,Se){return(0,Gt.x)(Ne,Se)}});var Ae=S(3701),$e=S(8794),tn=S(1106);let wn=(0,tt.op)({conv3d_:function(Ne,Se,ke,ve,Te="NDHWC",Fe=[1,1,1]){let je=(0,q.YT)(Ne,"x","conv3d"),hn=(0,q.YT)(Se,"filter","conv3d"),Pn=je,On=!1;je.rank===4&&(On=!0,Pn=(0,Ft.t)(je,[1,je.shape[0],je.shape[1],je.shape[2],je.shape[3]])),H.vA(Pn.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${Pn.rank}.`),H.vA(hn.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${hn.rank}.`),H.vA(Pn.shape[4]===hn.shape[3],()=>`Error in conv3d: depth of input (${Pn.shape[4]}) must match input depth for filter ${hn.shape[3]}.`),H.vA((0,vt.G0)(ke,Fe),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${ke} and dilations '${Fe}'`),H.vA(Te==="NDHWC",()=>`Error in conv3d: got dataFormat of ${Te} but only NDHWC is currently supported.`),H.vA((0,vt.qk)(Fe),()=>"Error in conv3D: Dilated rates should be larger than 0."),H.vA((0,vt.qk)(ke),()=>"Error in conv3D: Strides should be larger than 0.");let sr={x:Pn,filter:hn},ir={strides:ke,pad:ve,dataFormat:Te,dilations:Fe},Xr=X.T2.runKernel(J.A1h,sr,ir);return On?(0,Ft.t)(Xr,[Xr.shape[1],Xr.shape[2],Xr.shape[3],Xr.shape[4]]):Xr}});var Mn=S(1895);let Hn=(0,tt.op)({conv3dTranspose_:function(Ne,Se,ke,ve,Te){let Fe=(0,q.YT)(Ne,"x","conv3dTranspose"),je=(0,q.YT)(Se,"filter","conv3dTranspose");return(0,Mn.c)(ke,Fe,je,ve,Te)}});var Zn=S(9907),_r=S(7451),Sr=S(302),Mr=S(6808);let ai=(0,tt.op)({denseBincount_:function(Ne,Se,ke,ve=!1){let Te=(0,q.YT)(Ne,"x","denseBincount"),Fe=(0,q.YT)(Se,"weights","denseBincount");H.vA(Te.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${Te.dtype}`),H.vA(Te.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${Te.rank}.`),H.vA(ke>=0,()=>`size must be non-negative, but got ${ke}.`),H.vA(Fe.size===Te.size||Fe.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${Te.shape}, weights shape: ${Fe.shape}.`);let je={x:Te,weights:Fe},hn={size:ke,binaryOutput:ve};return X.T2.runKernel(J.wNW,je,hn)}});var ea=S(1216),Pi=S(676);let Cr=(0,tt.op)({diag_:function(Ne){let Se={x:(0,q.YT)(Ne,"x","diag")};return X.T2.runKernel(J.ORI,Se)}});var Ti=S(3002),Be=S(9359),En=S(919),lr=S(9759);let qn=(0,tt.op)({einsum_:function(Ne,...Se){let ke=Se.map((Te,Fe)=>(0,q.YT)(Te,`tensors${Fe}`,"einsum")),ve={equation:Ne};return X.T2.runKernel(J.Qgm,ke,ve)}});var fr=S(3416);let Er=(0,tt.op)({ensureShape_:function(Ne,Se){let ke=(0,q.YT)(Ne,"x","ensureShape","string_or_numeric");if(!(0,H.e_)(ke.shape,Se))throw new Error(`EnsureShape: Shape of tensor ${ke.shape} is not compatible with expected shape ${Se}`);return Ne}});var Qr=S(3020),vi=S(5207),ua=S(4881),br=S(8631),eo=S(8710),Fo=S(517),Wa=S(4826);let Le=(0,tt.op)({eye_:function(Ne,Se,ke,ve="float32"){Se==null&&(Se=Ne);let Te=(0,mn.r)([Ne,Se],ve),Fe=Ne<=Se?Ne:Se;for(let hn=0;hn<Fe;++hn)Te.set(1,hn,hn);let je=(0,Ft.t)(Te.toTensor(),[Ne,Se]);if(ke==null)return je;if(ke.length===1)return(0,Wa.V)((0,eo.U)(je,0),[ke[0],1,1]);if(ke.length===2)return(0,Wa.V)((0,eo.U)((0,eo.U)(je,0),0),[ke[0],ke[1],1,1]);if(ke.length===3)return(0,Wa.V)((0,eo.U)((0,eo.U)((0,eo.U)(je,0),0),0),[ke[0],ke[1],ke[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${ke.length}D.`)}});var bn=S(6111),jn=S(5606),Jn=S(8991),dr=S(8229),Ur=S(2058),or=S(3337),Yn=S(5040),li=S(8318),Ki=S(3454),Si=S(6300),Da=S(6919),_i=S(1303),la=S(6508);function so(Ne,Se,ke){if(ke<=0)throw new Error("The number of values should be positive.");let ve={start:Ne,stop:Se,num:ke};return X.T2.runKernel(J.mnI,{},ve)}var ys=S(3531),vs=S(4010),qo=S(2015),bs=S(5645),na=S(7991),va=S(3330),Ya=S(3789),Xo=S(9881),Du=S(9879),uu=S(9925);let ws=2147483648,Ra=(0,tt.op)({searchSorted_:function(Ne,Se,ke="left"){let ve=(0,q.YT)(Ne,"sortedSequence","searchSorted"),Te=(0,q.YT)(Se,"values","searchSorted"),Fe=ve.shape[ve.shape.length-1],je=Te.shape[Te.shape.length-1],hn=(0,Ft.t)(ve,[-1,Fe]),Pn=(0,Ft.t)(Te,[-1,je]);if(hn.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(hn.shape[0]!==Pn.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if((0,H.Ze)(Pn.shape)>=ws)throw new Error("values tensor size must less than 2147483648");if(hn.shape[1]>=ws)throw new Error(`trailing dim_size must less than 2147483648 for int32 output type, was ${hn.shape[1]}`);let On={sortedSequence:hn,values:Pn},sr={side:ke};return X.T2.runKernel(J.uWl,On,sr)}});function Ru(Ne,Se){return Ra(Ne,Se,"left")}var Ko=S(1938),Ga=S(6999);let Fu=(0,tt.op)({maxPool3d_:function(Ne,Se=[1,1,1],ke,ve,Te,Fe="NDHWC"){let je=(0,q.YT)(Ne,"x","maxPool3d"),hn=je,Pn=!1;je.rank===4&&(Pn=!0,hn=(0,Ft.t)(je,[1,je.shape[0],je.shape[1],je.shape[2],je.shape[3]])),H.vA(hn.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${hn.rank}.`),H.vA(Fe==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${Fe}`),(0,vt.s_)("maxPool3d",ve,Te);let On={x:hn},sr={filterSize:Se,strides:ke,pad:ve,dimRoundingMode:Te,dataFormat:Fe},ir=X.T2.runKernel(J.ySp,On,sr);return Pn?(0,Ft.t)(ir,[ir.shape[1],ir.shape[2],ir.shape[3],ir.shape[4]]):ir}}),Zs=(0,tt.op)({maxPoolWithArgmax_:function(Ne,Se,ke,ve,Te=!1){let Fe={x:(0,q.YT)(Ne,"x","maxPoolWithArgmax")},je={filterSize:Se,strides:ke,pad:ve,includeBatchInIndex:Te},hn=X.T2.runKernel(J.TL8,Fe,je);return{result:hn[0],indexes:hn[1]}}});var Rc=S(178),bu=S(2611),Qs=S(1411),wu=S(259);function Tl(Ne,Se,{indexing:ke="xy"}={}){if(ke!=="xy"&&ke!=="ij")throw new TypeError(`${ke} is not a valid third argument to meshgrid`);if(Ne===void 0)return[];let ve=(0,q.YT)(Ne,"x","meshgrid",Ne instanceof wu.qY?Ne.dtype:"float32");if(Se===void 0)return[ve];let Te=(0,q.YT)(Se,"y","meshgrid",Se instanceof wu.qY?Se.dtype:"float32"),Fe=(0,H.Ze)(ve.shape),je=(0,H.Ze)(Te.shape);return ke==="xy"?(ve=(0,Ft.t)(ve,[1,-1]),Te=(0,Ft.t)(Te,[-1,1]),[(0,ge.N)((0,Qs.S)([je,1],ve.dtype),ve),(0,ge.N)(Te,(0,Qs.S)([1,Fe],Te.dtype))]):(ve=(0,Ft.t)(ve,[-1,1]),Te=(0,Ft.t)(Te,[1,-1]),[(0,ge.N)(ve,(0,Qs.S)([1,je],ve.dtype)),(0,ge.N)((0,Qs.S)([Fe,1],Te.dtype),Te)])}var Zo=S(7436),ji=S(2644),Ku=S(6567),Zu=S(152),xs=S(1078),xu=S(5793),pa=S(7126);let _n=(0,tt.op)({moments_:function(Ne,Se=null,ke=!1){Ne=(0,q.YT)(Ne,"x","moments");let ve=(0,H.Y6)(Se,Ne.shape),Te=(0,bu.i)(Ne,ve,ke),Fe=Te.shape;ke||(Fe=(0,xs.SM)(Te.shape,ve));let je=(0,xu.E)((0,pa.j)((0,St.w)(Ne,"float32"),(0,Ft.t)(Te,Fe)));return{mean:Te,variance:(0,bu.i)(je,ve,ke)}}}),ls=(0,tt.op)({multiRNNCell_:function(Ne,Se,ke,ve){let Te=(0,q.YT)(Se,"data","multiRNNCell"),Fe=(0,q.j1)(ke,"c","multiRNNCell"),je=(0,q.j1)(ve,"h","multiRNNCell"),hn=Te,Pn=[];for(let ir=0;ir<Ne.length;ir++){let Xr=Ne[ir](hn,Fe[ir],je[ir]);Pn.push(Xr[0]),Pn.push(Xr[1]),hn=Xr[1]}let On=[],sr=[];for(let ir=0;ir<Pn.length;ir+=2)On.push(Pn[ir]),sr.push(Pn[ir+1]);return[On,sr]}}),Dt=(0,tt.op)({multinomial_:function(Ne,Se,ke,ve=!1){let Te=(0,q.YT)(Ne,"logits","multinomial"),Fe=Te.size,je=Te.rank;if(Fe<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${Fe}.`);if(je>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${je}`);ke=ke||Math.random();let hn={logits:je===1?(0,Ft.t)(Te,[1,-1]):Te},Pn={numSamples:Se,seed:ke,normalized:ve},On=X.T2.runKernel(J.WT3,hn,Pn);return je===1?(0,Ft.t)(On,[On.size]):On}});var Zt=S(6522),Ce=S(2118),le=S(1760),Pe=S(9885);let rn=(0,tt.op)({outerProduct_:function(Ne,Se){let ke=(0,q.YT)(Ne,"v1","outerProduct"),ve=(0,q.YT)(Se,"v2","outerProduct");H.vA(ke.rank===1&&ve.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${ke.rank} and ${ve.rank}.`);let Te=(0,Ft.t)(ke,[-1,1]),Fe=(0,Ft.t)(ve,[1,-1]);return(0,ge.N)(Te,Fe)}});var Cn=S(5661);let Vn=(0,tt.op)({pad1d_:function(Ne,Se,ke=0){return(0,H.vA)(Se.length===2,()=>"Invalid number of paddings. Must be length of 2."),(0,Cn.e)(Ne,[Se],ke)}}),hr=(0,tt.op)({pad2d_:function(Ne,Se,ke=0){return(0,H.vA)(Se.length===2&&Se[0].length===2&&Se[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),(0,Cn.e)(Ne,Se,ke)}}),Kr=(0,tt.op)({pad3d_:function(Ne,Se,ke=0){return(0,H.vA)(Se.length===3&&Se[0].length===2&&Se[1].length===2&&Se[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),(0,Cn.e)(Ne,Se,ke)}}),$i=(0,tt.op)({pad4d_:function(Ne,Se,ke=0){return(0,H.vA)(Se.length===4&&Se[0].length===2&&Se[1].length===2&&Se[2].length===2&&Se[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),(0,Cn.e)(Ne,Se,ke)}});var Ai=S(7872),Rr=S(8990),Jr=S(4394),di=S(5295),bi=S(7771);let Ci=(0,tt.op)({raggedGather_:function(Ne,Se,ke,ve){let Te={paramsNestedSplits:Ne.map((hn,Pn)=>(0,q.YT)(hn,`tensors${Pn}`,"raggedGather","int32")),paramsDenseValues:(0,q.YT)(Se,"paramsDenseValues","raggedGather"),indices:(0,q.YT)(ke,"indices","raggedGather","int32")},Fe={outputRaggedRank:ve},je=X.T2.runKernel(J.oJ2,Te,Fe);return{outputNestedSplits:je.slice(0,je.length-1),outputDenseValues:je[je.length-1]}}}),ra=(0,tt.op)({raggedRange_:function(Ne,Se,ke){let ve=(0,q.YT)(Ne,"starts","raggedRange"),Te={starts:ve,limits:(0,q.YT)(Se,"limits","raggedRange",ve.dtype),deltas:(0,q.YT)(ke,"deltas","raggedRange",ve.dtype)},Fe=X.T2.runKernel(J.CQC,Te);return{rtNestedSplits:Fe[0],rtDenseValues:Fe[1]}}}),oa=(0,tt.op)({raggedTensorToTensor_:function(Ne,Se,ke,ve,Te){let Fe=(0,q.YT)(Ne,"shape","raggedTensorToTensor","int32"),je=(0,q.YT)(Se,"values","raggedTensorToTensor"),hn={shape:Fe,values:je,defaultValue:(0,q.YT)(ke,"defaultValue","raggedTensorToTensor",je.dtype),rowPartitionTensors:ve.map((On,sr)=>(0,q.YT)(On,`tensors${sr}`,"raggedTensorToTensor","int32"))},Pn={rowPartitionTypes:Te};return X.T2.runKernel(J.mH5,hn,Pn)}}),Wr=(0,tt.op)({rand_:function(Ne,Se,ke){(0,H.SA)(Ne);let ve=(0,H.Ze)(Ne),Te=null;if(ke==null||ke==="float32")Te=new Float32Array(ve);else if(ke==="int32")Te=new Int32Array(ve);else{if(ke!=="bool")throw new Error(`Unknown data type ${ke}`);Te=new Uint8Array(ve)}for(let Fe=0;Fe<ve;Fe++)Te[Fe]=Se();return X.T2.makeTensor(Te,Ne,ke)}});var _a=S(7391);class Ca{constructor(Se,ke,ve,Te,Fe){this.mean=Se,this.stdDev=ke,this.dtype=ve,this.nextVal=NaN,this.truncated=Te,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);let je=Fe||Math.random();this.random=_a.alea(je.toString())}nextValue(){if(!isNaN(this.nextVal)){let Te=this.nextVal;return this.nextVal=NaN,Te}let Se,ke,ve=!1;for(;!ve;){let Te,Fe,je;do Te=2*this.random()-1,Fe=2*this.random()-1,je=Te*Te+Fe*Fe;while(je>=1||je===0);let hn=Math.sqrt(-2*Math.log(je)/je);Se=this.mean+this.stdDev*Te*hn,ke=this.mean+this.stdDev*Fe*hn,this.truncated&&!this.isValidTruncated(Se)||(ve=!0)}return this.truncated&&!this.isValidTruncated(ke)||(this.nextVal=this.convertValue(ke)),this.convertValue(Se)}convertValue(Se){return this.dtype==null||this.dtype==="float32"?Se:Math.round(Se)}isValidTruncated(Se){return Se<=this.upper&&Se>=this.lower}}class Gi{constructor(Se,ke,ve,Te){this.alpha=Se,this.beta=1/ke,this.dtype=ve;let Fe=Te||Math.random();this.randu=_a.alea(Fe.toString()),this.randn=new Ca(0,1,ve,!1,this.randu()),this.d=Se<1?Se+.6666666666666666:Se-.3333333333333333,this.c=1/Math.sqrt(9*this.d)}nextValue(){let Se,ke,ve,Te,Fe,je;for(;;){do Te=this.randn.nextValue(),je=1+this.c*Te;while(je<=0);if(je*=je*je,Se=Te*Te,ke=1-.331*Se*Se,ve=.5*Se+this.d*(1-je+Math.log(je)),Fe=this.randu(),Fe<ke||Math.log(Fe)<ve)break}return je=1/this.beta*this.d*je,this.alpha<1&&(je*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(je)}convertValue(Se){return this.dtype==="float32"?Se:Math.round(Se)}}class Ea{constructor(Se=0,ke=1,ve,Te){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=Se,this.range=ke-Se,this.dtype=ve,Te==null&&(Te=Math.random()),typeof Te=="number"&&(Te=Te.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${Se} - ${ke} <= 1 and dtype is not float`);this.random=_a.alea(Te)}convertValue(Se){return this.canReturnFloat()?Se:Math.round(Se)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}let Ta=(0,tt.op)({randomGamma_:function(Ne,Se,ke=1,ve="float32",Te){if((0,H.SA)(Ne),ke==null&&(ke=1),ve==null&&(ve="float32"),ve!=="float32"&&ve!=="int32")throw new Error(`Unsupported data type ${ve}`);let Fe=new Gi(Se,ke,ve,Te),je=(0,mn.r)(Ne,ve);for(let hn=0;hn<je.values.length;hn++)je.values[hn]=Fe.nextValue();return je.toTensor()}}),Dn=(0,tt.op)({randomNormal_:function(Ne,Se=0,ke=1,ve,Te){if((0,H.SA)(Ne),ve!=null&&ve==="bool")throw new Error(`Unsupported data type ${ve}`);let Fe=new Ca(Se,ke,ve,!1,Te),je=(0,mn.r)(Ne,ve);for(let hn=0;hn<je.values.length;hn++)je.values[hn]=Fe.nextValue();return je.toTensor()}}),Ui=(0,tt.op)({randomStandardNormal_:function(Ne,Se,ke){if(Se!=null&&Se==="bool")throw new Error(`Unsupported data type ${Se}`);return Dn(Ne,0,1,Se,ke)}}),sa=(0,tt.op)({randomUniform_:function(Ne,Se=0,ke=1,ve="float32",Te){(0,H.SA)(Ne);let Fe=(0,mn.r)(Ne,ve),je=new Ea(Se,ke,null,Te);for(let hn=0;hn<Fe.values.length;hn++)Fe.values[hn]=je.nextValue();return Fe.toTensor()}}),ks=(0,tt.op)({randomUniformInt_:function(Ne,Se,ke,ve){return sa(Ne,Se,ke,"int32",ve)}});function Po(Ne,Se,ke=1,ve="float32"){if(ke===0)throw new Error("Cannot have a step of zero");let Te={start:Ne,stop:Se,step:ke,dtype:ve};return X.T2.runKernel(J.Q6t,{},Te)}var ku=S(1902),io=S(9870),an=S(112),Ms=S(3732),lu=S(3262);let Ul=(0,tt.op)({reverse1d_:function(Ne){let Se=(0,q.YT)(Ne,"x","reverse");return H.vA(Se.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${Se.rank}.`),(0,lu.B)(Se,0)}}),Ou=(0,tt.op)({reverse2d_:function(Ne,Se){let ke=(0,q.YT)(Ne,"x","reverse");return H.vA(ke.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${ke.rank}.`),(0,lu.B)(ke,Se)}}),Lu=(0,tt.op)({reverse3d_:function(Ne,Se){let ke=(0,q.YT)(Ne,"x","reverse");return H.vA(ke.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${ke.rank}.`),(0,lu.B)(ke,Se)}}),Ed=(0,tt.op)({reverse4d_:function(Ne,Se){let ke=(0,q.YT)(Ne,"x","reverse");return H.vA(ke.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${ke.rank}.`),(0,lu.B)(ke,Se)}});var Fc=S(5912),ni=S(7820),Zr=S(5702),Qu=S(6325),Wl=S(9986);let Yh=function(Ne,Se){return ce(this,null,function*(){let ke=(0,q.YT)(Ne,"x","setdiff1d"),ve=(0,q.YT)(Se,"y","setdiff1d");H.vA(ke.dtype===ve.dtype,()=>`x and y should have the same dtype, but got x (${ke.dtype}) and y (${ve.dtype}).`),H.vA(ke.rank===1,()=>`x should be 1D tensor, but got x (${ke.shape}).`),H.vA(ve.rank===1,()=>`y should be 1D tensor, but got y (${ve.shape}).`);let Te=yield ke.data(),Fe=yield ve.data(),je=new Set(Fe),hn=0;for(let sr=0;sr<Te.length;sr++)je.has(Te[sr])||hn++;let Pn=new wu.yl([hn],ke.dtype),On=new wu.yl([hn],"int32");for(let sr=0,ir=0;sr<Te.length;sr++)je.has(Te[sr])||(Pn.values[ir]=Te[sr],On.values[ir]=sr,ir++);return[Pn.toTensor(),On.toTensor()]})};var Ba=S(1115),$s=S(3726),Oc=S(8276);let oc=(0,tt.op)({slice1d_:function(Ne,Se,ke){let ve=(0,q.YT)(Ne,"x","slice1d");return H.vA(ve.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${ve.rank} tensor`),(0,Bt.d)(ve,[Se],[ke])}}),sc=(0,tt.op)({slice2d_:function(Ne,Se,ke){let ve=(0,q.YT)(Ne,"x","slice2d");return H.vA(ve.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${ve.rank} tensor`),(0,Bt.d)(ve,Se,ke)}}),Lc=(0,tt.op)({slice3d_:function(Ne,Se,ke){let ve=(0,q.YT)(Ne,"x","slice3d");return H.vA(ve.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${ve.rank} tensor`),(0,Bt.d)(ve,Se,ke)}}),Ju=(0,tt.op)({slice4d_:function(Ne,Se,ke){let ve=(0,q.YT)(Ne,"x","slice4d");return H.vA(ve.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${ve.rank} tensor`),(0,Bt.d)(ve,Se,ke)}});var ph=S(6346),$c=S(6030),uc=S(776),yt=S(1361),D=S(3108),U=S(2292),et=S(8775),ut=S(6512),pt=S(9348),mt=S(3427),At=S(5932),zt=S(4268),pe=S(700),We=S(5894),Ke=S(3791),Tn=S(7823),nn=S(4027),un=S(9171);function zn(Ne,Se){(0,H.HO)(Ne);let ke=(0,q.MZ)(Ne,Se);if(ke.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return(0,un.Q)(Ne,null,ke,Se)}function In(Ne,Se,ke){if((0,H.HO)(Ne),Se!=null&&Se.length!==2)throw new Error("tensor2d() requires shape to have two numbers");let ve=(0,q.MZ)(Ne,ke);if(ve.length!==2&&ve.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(ve.length===1&&Se==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return(0,un.Q)(Ne,Se,ve,ke)}var Or=S(2768);function oi(Ne,Se,ke){if((0,H.HO)(Ne),Se!=null&&Se.length!==4)throw new Error("tensor4d() requires shape to have four numbers");let ve=(0,q.MZ)(Ne,ke);if(ve.length!==4&&ve.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(ve.length===1&&Se==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return(0,un.Q)(Ne,Se,ve,ke)}function ur(Ne,Se,ke){if((0,H.HO)(Ne),Se!=null&&Se.length!==5)throw new Error("tensor5d() requires shape to have five numbers");let ve=(0,q.MZ)(Ne,ke);if(ve.length!==5&&ve.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(ve.length===1&&Se==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return(0,un.Q)(Ne,Se,ve,ke)}function Na(Ne,Se,ke){if((0,H.HO)(Ne),Se!=null&&Se.length!==6)throw new Error("tensor6d() requires shape to have six numbers");let ve=(0,q.MZ)(Ne,ke);if(ve.length!==6&&ve.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(ve.length===1&&Se==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Se=Se||ve,(0,un.Q)(Ne,Se,ve,ke)}var fi=S(6170);let Lr=(0,tt.op)({tensorScatterUpdate_:function(Ne,Se,ke){let ve=(0,q.YT)(Ne,"tensor","tensorScatterupdate"),Te=(0,q.YT)(Se,"indices","tensorScatterupdate","int32"),Fe=(0,q.YT)(ke,"updates","tensorScatterupdate");if(fi.validateInput(Fe,Te,ve.shape),ve.dtype!==Fe.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${ve.dtype} and ${Fe.dtype}.`);let je={tensor:ve,indices:Te,updates:Fe};return X.T2.runKernel(J.X4r,je,{})}});var wi=S(1190);let cs=(0,tt.op)({truncatedNormal_:function(Ne,Se=0,ke=1,ve,Te){if((0,H.SA)(Ne),ve!=null&&ve==="bool")throw new Error("Unsupported data type $ { dtype }");let Fe=new Ca(Se,ke,ve,!0,Te),je=(0,mn.r)(Ne,ve);for(let hn=0;hn<je.values.length;hn++)je.values[hn]=Fe.nextValue();return je.toTensor()}});var Js=S(3937),zs=S(7706),pi=S(7261);function cu(Ne,Se){return Ra(Ne,Se,"right")}function Vl(Ne,Se=!0,ke,ve){return X.T2.makeVariable(Ne,Se,ke,ve)}var Al=S(2151),yw=S(4411);let zc=function(Ne){return ce(this,null,function*(){let Se=(0,q.YT)(Ne,"condition","whereAsync","bool"),ke=yield Se.data(),ve=(0,yw.Y)(Se.shape,ke);return Ne!==Se&&Se.dispose(),ve})};var r0=S(2855),vw=S(5537);let mh=function(Ne,Se,ke){return ce(this,null,function*(){let ve=(0,q.YT)(Ne,"tensor","boolMask"),Te=(0,q.YT)(Se,"mask","boolMask","bool"),Fe=ke??0,je=Te.rank,hn=ve.shape;H.vA(je>0,()=>"mask cannot be scalar"),H.O3(hn.slice(Fe,Fe+je),Te.shape,"mask's shape must match the first K dimensions of tensor's shape,");let Pn=1;for(let Fa=Fe;Fa<Fe+je;Fa++)Pn*=hn[Fa];let On=hn.slice(0,Fe).concat([Pn],hn.slice(Fe+je)),sr=(0,Ft.t)(ve,On),ir=(0,Ft.t)(Te,[-1]),Xr=yield zc(ir),Pr=(0,At.r)(Xr,[1]),ci=(0,dr.k)(sr,Pr,Fe);return Ne!==ve&&ve.dispose(),Se!==Te&&Te.dispose(),Pr.dispose(),sr.dispose(),ir.dispose(),Xr.dispose(),ci})};var Gl=S(7703),yn=S(2596),Wi=S(565);let bv=(0,tt.op)({movingAverage_:function(Ne,Se,ke,ve,Te=!0){let Fe=(0,q.YT)(Ne,"v","movingAverage"),je=(0,q.YT)(Se,"x","movingAverage"),hn=(0,q.YT)(ke,"decay","movingAverage");(0,Wi.assertTypesMatch)(Fe,je),H.vA(H.r1(Fe.shape,je.shape),()=>"Shape mismatch in v and x");let Pn=(0,Zr.d)(1),On=(0,pa.j)(Pn,hn),sr=(0,ee.l)((0,pa.j)(je,Fe),On);if(Te){H.vA(ve!=null,()=>"When using zeroDebias: true, step is required.");let ir=(0,q.YT)(ve,"step","movingAverage");sr=(0,Be.y)(sr,(0,pa.j)(Pn,(0,Rr.n)(hn,ir)))}return(0,Y.W)(Fe,sr)}}),bw=(0,tt.op)({scatterND_:function(Ne,Se,ke){(0,H.SA)(ke);let ve=(0,q.YT)(Ne,"indices","scatterND","int32"),Te=(0,q.YT)(Se,"updates","scatterND");fi.validateInput(Te,ve,ke);let Fe={indices:ve,updates:Te},je={shape:ke};return X.T2.runKernel(J.pJc,Fe,je)}}),i0=(0,tt.op)({sparseToDense_:function(Ne,Se,ke,ve=0){(0,H.SA)(ke);let Te=(0,q.YT)(Ne,"sparseIndices","sparseToDense","int32"),Fe=(0,q.YT)(Se,"sparseValues","sparseToDense","string_or_numeric"),je=(0,q.YT)(ve,"defaultValue","sparseToDense",Fe.dtype);(function(On,sr,ir,Xr){if(On.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${On.dtype}.`);if(On.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${On.shape}.`);let Pr=On.rank>0?On.shape[0]:1,ci=On.rank>1?On.shape[1]:1;if(ir.length!==ci)throw new Error(`outputShape has incorrect number of elements:, ${ir.length}, should be: ${ci}.`);let Fa=sr.size;if(sr.rank!==0&&(sr.rank!==1||Fa!==Pr))throw new Error(`sparseValues has incorrect shape ${sr.shape}, should be [] or [${Pr}]`);if(sr.dtype!==Xr.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")})(Te,Fe,ke,je);let hn={sparseIndices:Te,sparseValues:Fe,defaultValue:je},Pn={outputShape:ke};return X.T2.runKernel(J.jgd,hn,Pn)}}),qh=(0,tt.op)({gatherND_:function(Ne,Se){let ke=(0,q.YT)(Se,"indices","gatherND","int32"),ve={params:(0,q.YT)(Ne,"x","gatherND","string_or_numeric"),indices:ke};return X.T2.runKernel(J.O4G,ve)}}),wv=(0,tt.op)({dropout_:function(Ne,Se,ke,ve){let Te=(0,q.YT)(Ne,"x","dropout");if(H.vA(Te.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${Te.dtype} tensor instead.`),H.vA(Se>=0&&Se<1,()=>`rate must be a float in the range [0, 1), but got ${Se}.`),Se===0)return Ne instanceof wu.qY?Te.clone():Te;let Fe=function(Pn,On){if(On==null)return Pn.shape.slice();if(H.r1(Pn.shape,On))return On;if(Pn.shape.length===On.length){let sr=[];for(let ir=0;ir<Pn.shape.length;ir++)On[ir]==null&&Pn.shape[ir]!=null?sr.push(Pn.shape[ir]):sr.push(On[ir]);return sr}return On}(Te,ke),je=1-Se,hn=(0,Be.y)((0,jn.R)((0,Y.W)(sa(Fe,0,1,"float32",ve),je)),je);return(0,ee.l)(Te,hn)}});function $u(Ne){return Math.floor(Math.pow(2,Math.ceil(Math.log(Ne)/Math.log(2))))}function xo(Ne,Se,ke){let ve=1-Ne%2,Te=new Float32Array(Ne);for(let Fe=0;Fe<Ne;++Fe){let je=2*Math.PI*Fe/(Ne+ve-1);Te[Fe]=Se-ke*Math.cos(je)}return zn(Te,"float32")}let Xh=function(Ne,Se,ke=1){return ce(this,null,function*(){let ve=(0,q.YT)(Ne,"predictions","inTopK"),Te=(0,q.YT)(Se,"targets","inTopK");(0,H.vA)(ve.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${ve.rank}`),(0,H.vA)(ve.rank-1===Te.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${ve.rank} and targets rank ${Te.rank}`),(0,H.O3)(ve.shape.slice(0,ve.shape.length-1),Te.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");let Fe=ve.shape[ve.shape.length-1];(0,H.vA)(ke>0&&ke<=Fe,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${Fe}), but got ${ke}`);let je=yield ve.data(),hn=yield Te.data(),[Pn,On]=[je.length/Fe,Fe],sr=(0,H.ce)("bool",Pn);for(let ir=0;ir<Pn;ir++){let Xr=ir*On,Pr=je.subarray(Xr,Xr+On),ci=[];for(let Fa=0;Fa<Pr.length;Fa++)ci.push({value:Pr[Fa],index:Fa});ci.sort((Fa,Ha)=>Ha.value-Fa.value),sr[ir]=0;for(let Fa=0;Fa<ke;Fa++)if(ci[Fa].index===hn[ir]){sr[ir]=1;break}}return Ne!==ve&&ve.dispose(),Se!==Te&&Te.dispose(),(0,nn.O)(sr,Te.shape,"bool")})};var oe=S(1830),Lt=S(2198),ne=S(5248),xe=S(252),Oe=S(8646);let fn=(0,tt.op)({fusedConv2d_:function({x:Ne,filter:Se,strides:ke,pad:ve,dataFormat:Te="NHWC",dilations:Fe=[1,1],dimRoundingMode:je,bias:hn,activation:Pn="linear",preluActivationWeights:On,leakyreluAlpha:sr}){if(Pn=Pn||"linear",(0,Oe.zE)(X.T2.state.gradientDepth,Pn)===!1){H.vA(Te==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${Te} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let ja=(0,$e.X)(Ne,Se,ke,ve,Te,Fe,je);return hn!=null&&(ja=(0,Y.W)(ja,hn)),(0,Oe.f2)(ja,Pn,On,sr)}let ir=(0,q.YT)(Ne,"x","conv2d","float32"),Xr=(0,q.YT)(Se,"filter","conv2d","float32"),Pr=ir,ci=!1;ir.rank===3&&(ci=!0,Pr=(0,Ft.t)(ir,[1,ir.shape[0],ir.shape[1],ir.shape[2]])),H.vA(Pr.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${Pr.rank}.`),H.vA(Xr.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${Xr.rank}.`),vt.s_("fused conv2d",ve,je);let Fa=Te==="NHWC"?Pr.shape[3]:Pr.shape[1];H.vA(Xr.shape[2]===Fa,()=>`Error in conv2d: depth of input (${Fa}) must match input depth for filter ${Xr.shape[2]}.`),H.vA(vt.G0(ke,Fe),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${ke} and dilations '${Fe}'`);let Ha=vt.uf(Pr.shape,Xr.shape,ke,Fe,ve,je),Vr,Vi;if(hn!=null&&(Vr=(0,q.YT)(hn,"bias","fused conv2d"),[Vr]=(0,Wi.makeTypesMatch)(Vr,ir),Te==="NHWC"?Lt.assertAndGetBroadcastShape(Ha.outShape,Vr.shape):(H.vA(Vr.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${Vr.shape.length}.`),H.vA(Vr.shape.length===0||Vr.shape[0]===Ha.outChannels||Vr.shape[0]===1,()=>`Error in fused conv2d: bias shape (${Vr.shape}) is not compatible with the number of output channels (${Ha.outChannels})`))),On!=null){let ja=On.shape;if(H.vA(ja.length<=1||ja.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${ja.length}.`),ja.length===1)H.vA(ja[0]===1||ja[0]===Ha.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${ja}) is not compatible with the number of output channels (${Ha.outChannels}).`);else if(ja.length===3)try{Lt.assertAndGetBroadcastShape(ja,Ha.outShape)}catch{let La=`Error in fused conv2d: PReLU activation weights (${ja}) is not compatible with the output shape of the conv2d (${Ha.outShape}).`;throw Error(La)}Vi=(0,q.YT)(On,"prelu weights","fused conv2d")}let Bs=(ja,Bo)=>{H.vA(Te==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${Te} but only NHWC is currently supported.`);let[La,no,Ao,js]=Bo,Nl=(0,Oe.XB)(ja,Ao,Pn);H.vA(vt.Dh(Fe),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${Fe}'`);let Hi=[(0,xe.v)(no.shape,Nl,La,ke,ve),(0,ne.H)(no,Nl,La.shape,ke,ve)];if(js!=null){let Id=(0,Oe.Do)(js,Nl);Hi.push(Id)}return Hi},tu={x:Pr,filter:Xr,bias:Vr,preluActivationWeights:Vi},To={strides:ke,pad:ve,dataFormat:Te,dilations:Fe,dimRoundingMode:je,activation:Pn,leakyreluAlpha:sr};return hn==null?(0,oe._X)((Bo,La,no)=>{let Ao=X.T2.runKernel(J.aAr,tu,To);return no([La,Bo,Ao]),ci&&(Ao=(0,Ft.t)(Ao,[Ao.shape[1],Ao.shape[2],Ao.shape[3]])),{value:Ao,gradFunc:Bs}})(Pr,Xr):(0,oe._X)((Bo,La,no,Ao)=>{let js=X.T2.runKernel(J.aAr,tu,To);return Ao([La,Bo,js,no]),ci&&(js=(0,Ft.t)(js,[js.shape[1],js.shape[2],js.shape[3]])),{value:js,gradFunc:Bs}})(Pr,Xr,Vr)}});var vn=S(1890),rr=S(3134);let pr=(0,tt.op)({fusedDepthwiseConv2d_:function({x:Ne,filter:Se,strides:ke,pad:ve,dataFormat:Te="NHWC",dilations:Fe=[1,1],dimRoundingMode:je,bias:hn,activation:Pn="linear",preluActivationWeights:On,leakyreluAlpha:sr}){if((0,Oe.zE)(X.T2.state.gradientDepth,Pn)===!1){let To=(0,Pi.G)(Ne,Se,ke,ve,Te,Fe,je);return hn!=null&&(To=(0,Y.W)(To,hn)),(0,Oe.f2)(To,Pn,On,sr)}let ir=(0,q.YT)(Ne,"x","depthwiseConv2d","float32"),Xr=(0,q.YT)(Se,"filter","depthwiseConv2d","float32"),Pr=ir,ci=!1;ir.rank===3&&(ci=!0,Pr=(0,Ft.t)(ir,[1,ir.shape[0],ir.shape[1],ir.shape[2]])),H.vA(Pr.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${Pr.rank}.`),H.vA(Xr.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${Xr.rank}.`),H.vA(Pr.shape[3]===Xr.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${Pr.shape[3]}) must match the inChannels dimension in filter ${Xr.shape[2]}.`),Fe==null&&(Fe=[1,1]),H.vA(vt.G0(ke,Fe),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${ke} and dilations '${Fe}'`),vt.s_("fused depthwiseConv2d",ve,je);let Fa=vt.uf(Pr.shape,Xr.shape,ke,Fe,ve,je,!0),Ha,Vr;hn!=null&&(Ha=(0,q.YT)(hn,"bias","fused conv2d"),[Ha]=(0,Wi.makeTypesMatch)(Ha,ir),Lt.assertAndGetBroadcastShape(Fa.outShape,Ha.shape)),On!=null&&(Vr=(0,q.YT)(On,"prelu weights","fused depthwiseConv2d"));let Vi=(To,ja)=>{H.vA(vt.Dh(Fe),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${Fe}'`);let[Bo,La,no,Ao]=ja,js=(0,Oe.XB)(To,no,Pn),Nl=(0,rr.l)(La.shape,js,Bo,ke,ve,Fe,je),Hi=(0,vn.x)(La,js,Bo.shape,ke,ve,Fe,je);return Ao!=null?[Nl,Hi,(0,Oe.Do)(Ha,js)]:[Nl,Hi]},Bs={x:Pr,filter:Xr,bias:Ha,preluActivationWeights:Vr},tu={strides:ke,pad:ve,dataFormat:Te,dilations:Fe,dimRoundingMode:je,activation:Pn,leakyreluAlpha:sr};return hn==null?(0,oe._X)((ja,Bo,La)=>{let no=X.T2.runKernel(J.T7M,Bs,tu);return La([Bo,ja,no]),ci&&(no=(0,Ft.t)(no,[no.shape[1],no.shape[2],no.shape[3]])),{value:no,gradFunc:Vi}})(Pr,Xr):(0,oe._X)((ja,Bo,La,no)=>{let Ao=X.T2.runKernel(J.T7M,Bs,tu);return no([Bo,ja,Ao,La]),ci&&(Ao=(0,Ft.t)(Ao,[Ao.shape[1],Ao.shape[2],Ao.shape[3]])),{value:Ao,gradFunc:Vi}})(Pr,Xr,Ha)}}),Yr=(0,tt.op)({fusedMatMul_:function({a:Ne,b:Se,transposeA:ke=!1,transposeB:ve=!1,bias:Te,activation:Fe="linear",preluActivationWeights:je,leakyreluAlpha:hn=.2}){if((0,Oe.zE)(X.T2.state.gradientDepth,Fe)===!1){let Ao=(0,ge.N)(Ne,Se,ke,ve);return Te!=null&&(Ao=(0,Y.W)(Ao,Te)),(0,Oe.f2)(Ao,Fe,je,hn)}let Pn=(0,q.YT)(Ne,"a","fused matMul"),On=(0,q.YT)(Se,"b","fused matMul");[Pn,On]=(0,Wi.makeTypesMatch)(Pn,On);let sr=ke?Pn.shape[Pn.rank-2]:Pn.shape[Pn.rank-1],ir=ve?On.shape[On.rank-1]:On.shape[On.rank-2],Xr=ke?Pn.shape[Pn.rank-1]:Pn.shape[Pn.rank-2],Pr=ve?On.shape[On.rank-2]:On.shape[On.rank-1],ci=Pn.shape.slice(0,-2),Fa=On.shape.slice(0,-2),Ha=H.Ze(ci),Vr=H.Ze(Fa);H.vA(sr===ir,()=>`Error in fused matMul: inner shapes (${sr}) and (${ir}) of Tensors with shapes ${Pn.shape} and ${On.shape} and transposeA=${ke} and transposeB=${ve} must match.`);let Vi=Lt.assertAndGetBroadcastShape(Pn.shape.slice(0,-2),On.shape.slice(0,-2)).concat([Xr,Pr]),Bs=ke?(0,Ft.t)(Pn,[Ha,sr,Xr]):(0,Ft.t)(Pn,[Ha,Xr,sr]),tu=ve?(0,Ft.t)(On,[Vr,Pr,ir]):(0,Ft.t)(On,[Vr,ir,Pr]),To,ja;Te!=null&&(To=(0,q.YT)(Te,"bias","fused matMul"),[To]=(0,Wi.makeTypesMatch)(To,Pn),Lt.assertAndGetBroadcastShape(Vi,To.shape)),je!=null&&(ja=(0,q.YT)(je,"prelu weights","fused matMul"));let Bo=(Ao,js)=>{let[Nl,Hi,Id,Nd]=js,ap=(0,Oe.XB)((0,Ft.t)(Ao,Id.shape),Id,Fe),Zh,u0;return ke||ve?!ke&&ve?(Zh=(0,ge.N)(ap,Hi,!1,!1),u0=(0,ge.N)(ap,Nl,!0,!1)):ke&&!ve?(Zh=(0,ge.N)(Hi,ap,!1,!0),u0=(0,ge.N)(Nl,ap,!1,!1)):(Zh=(0,ge.N)(Hi,ap,!0,!0),u0=(0,ge.N)(ap,Nl,!0,!0)):(Zh=(0,ge.N)(ap,Hi,!1,!0),u0=(0,ge.N)(Nl,ap,!0,!1)),Te!=null?[Zh,u0,(0,Oe.Do)(Nd,ap)]:[Zh,u0]},La={a:Bs,b:tu,bias:To,preluActivationWeights:ja},no={transposeA:ke,transposeB:ve,activation:Fe,leakyreluAlpha:hn};return Te==null?(0,oe._X)((js,Nl,Hi)=>{let Id=X.T2.runKernel(J.Dr,La,no);return Hi([js,Nl,Id]),{value:(0,Ft.t)(Id,Vi),gradFunc:Bo}})(Bs,tu):(0,oe._X)((js,Nl,Hi,Id)=>{let Nd=X.T2.runKernel(J.Dr,La,no);return Id([js,Nl,Nd,Hi]),{value:(0,Ft.t)(Nd,Vi),gradFunc:Bo}})(Bs,tu,To)}}),qr=(0,tt.op)({hammingWindow_:function(Ne){return xo(Ne,.54,.46)}}),xr=(0,tt.op)({hannWindow_:function(Ne){return xo(Ne,.5,.5)}}),ma=(0,tt.op)({frame_:function(Ne,Se,ke,ve=!1,Te=0){let Fe=0,je=[];for(;Fe+Se<=Ne.size;)je.push((0,Bt.d)(Ne,Fe,Se)),Fe+=ke;if(ve)for(;Fe<Ne.size;){let hn=Fe+Se-Ne.size,Pn=(0,Gt.x)([(0,Bt.d)(Ne,Fe,Se-hn),(0,bn.G)([hn],Te)]);je.push(Pn),Fe+=ke}return je.length===0?In([],[0,Se]):(0,Ft.t)((0,Gt.x)(je),[je.length,Se])}}),ca=(0,tt.op)({stft_:function(Ne,Se,ke,ve,Te=xr){ve==null&&(ve=$u(Se));let Fe=ma(Ne,Se,ke),je=(0,ee.l)(Fe,Te(Se));return(0,et.z)(je,ve)}}),uo=(0,tt.op)({cropAndResize_:function(Ne,Se,ke,ve,Te="bilinear",Fe=0){let je=(0,q.YT)(Ne,"image","cropAndResize"),hn=(0,q.YT)(Se,"boxes","cropAndResize","float32"),Pn=(0,q.YT)(ke,"boxInd","cropAndResize","int32"),On=hn.shape[0];H.vA(je.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${je.rank}.`),H.vA(hn.rank===2&&hn.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${On},4] but had shape ${hn.shape}.`),H.vA(Pn.rank===1&&Pn.shape[0]===On,()=>`Error in cropAndResize: boxInd must be have size [${On}] but had shape ${hn.shape}.`),H.vA(ve.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${ve.length}.`),H.vA(ve[0]>=1&&ve[1]>=1,()=>`cropSize must be atleast [1,1], but was ${ve}`),H.vA(Te==="bilinear"||Te==="nearest",()=>`method must be bilinear or nearest, but was ${Te}`);let sr={image:je,boxes:hn,boxInd:Pn},ir={method:Te,extrapolationValue:Fe,cropSize:ve};return X.T2.runKernel(J.MRQ,sr,ir)}}),Qo=(0,tt.op)({flipLeftRight_:function(Ne){let Se=(0,q.YT)(Ne,"image","flipLeftRight","float32");H.vA(Se.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${Se.rank}.`);let ke={image:Se};return X.T2.runKernel(J.BxF,ke,{})}}),Ps=(0,tt.op)({grayscaleToRGB_:function(Ne){let Se=(0,q.YT)(Ne,"image","grayscaleToRGB"),ke=Se.rank-1,ve=Se.shape[ke];H.vA(Se.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${Se.rank}.`),H.vA(ve===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${ve}.`);let Te=new Array(Se.rank);return Te.fill(1,0,ke),Te[ke]=3,(0,Wa.V)(Se,Te)}}),Cg=(0,tt.op)({rgbToGrayscale_:function(Ne){let Se=(0,q.YT)(Ne,"image","RGBToGrayscale"),ke=Se.rank-1,ve=Se.shape[ke];H.vA(Se.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${Se.rank}.`),H.vA(ve===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${ve}.`);let Te=Se.dtype,Fe=(0,St.w)(Se,"float32"),je=zn([.2989,.587,.114]),hn;switch(Se.rank){case 2:hn=qn("ij,j->i",Fe,je);break;case 3:hn=qn("ijk,k->ij",Fe,je);break;case 4:hn=qn("ijkl,l->ijk",Fe,je);break;case 5:hn=qn("ijklm,m->ijkl",Fe,je);break;case 6:hn=qn("ijklmn,n->ijklm",Fe,je);break;default:throw new Error("Not a valid tensor rank.")}return hn=(0,eo.U)(hn,-1),(0,St.w)(hn,Te)}}),a0=(0,tt.op)({rotateWithOffset_:function(Ne,Se,ke=0,ve=.5){let Te=(0,q.YT)(Ne,"image","rotateWithOffset","float32");H.vA(Te.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${Te.rank}.`);let Fe={image:Te},je={radians:Se,fillValue:ke,center:ve};return X.T2.runKernel(J.BK4,Fe,je)}});function Pc(Ne,Se,ke,ve,Te,Fe){ve==null&&(ve=.5),Te==null&&(Te=Number.NEGATIVE_INFINITY),Fe==null&&(Fe=0);let je=Ne.shape[0];return ke=Math.min(ke,je),H.vA(0<=ve&&ve<=1,()=>`iouThreshold must be in [0, 1], but was '${ve}'`),H.vA(Ne.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${Ne.rank}'`),H.vA(Ne.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${Ne.shape[1]}`),H.vA(Se.rank===1,()=>"scores must be a 1D tensor"),H.vA(Se.shape[0]===je,()=>`scores has incompatible shape with boxes. Expected ${je}, but was ${Se.shape[0]}`),H.vA(0<=Fe&&Fe<=1,()=>`softNmsSigma must be in [0, 1], but was '${Fe}'`),{maxOutputSize:ke,iouThreshold:ve,scoreThreshold:Te,softNmsSigma:Fe}}let xv=(0,tt.op)({nonMaxSuppression_:function(Ne,Se,ke,ve=.5,Te=Number.NEGATIVE_INFINITY){let Fe=(0,q.YT)(Ne,"boxes","nonMaxSuppression","float32"),je=(0,q.YT)(Se,"scores","nonMaxSuppression","float32"),hn=Pc(Fe,je,ke,ve,Te),Pn={maxOutputSize:ke=hn.maxOutputSize,iouThreshold:ve=hn.iouThreshold,scoreThreshold:Te=hn.scoreThreshold};return X.T2.runKernel(J.SDM,{boxes:Fe,scores:je},Pn)}});var u2=S(8360);let Eg=function(Fe,je,hn){return ce(this,arguments,function*(Ne,Se,ke,ve=.5,Te=Number.NEGATIVE_INFINITY){let Pn=(0,q.YT)(Ne,"boxes","nonMaxSuppressionAsync"),On=(0,q.YT)(Se,"scores","nonMaxSuppressionAsync"),sr=Pc(Pn,On,ke,ve,Te);ke=sr.maxOutputSize,ve=sr.iouThreshold,Te=sr.scoreThreshold;let ir=yield Promise.all([Pn.data(),On.data()]),Xr=ir[0],Pr=ir[1],{selectedIndices:ci}=(0,u2.c7)(Xr,Pr,ke,ve,Te);return Pn!==Ne&&Pn.dispose(),On!==Se&&On.dispose(),zn(ci,"int32")})},hu=(0,tt.op)({nonMaxSuppressionWithScore_:function(Ne,Se,ke,ve=.5,Te=Number.NEGATIVE_INFINITY,Fe=0){let je=(0,q.YT)(Ne,"boxes","nonMaxSuppression"),hn=(0,q.YT)(Se,"scores","nonMaxSuppression"),Pn=Pc(je,hn,ke,ve,Te,Fe),On={boxes:je,scores:hn},sr={maxOutputSize:ke=Pn.maxOutputSize,iouThreshold:ve=Pn.iouThreshold,scoreThreshold:Te=Pn.scoreThreshold,softNmsSigma:Fe=Pn.softNmsSigma},ir=X.T2.runKernel(J.e0f,On,sr);return{selectedIndices:ir[0],selectedScores:ir[1]}}}),Bc=function(je,hn,Pn){return ce(this,arguments,function*(Ne,Se,ke,ve=.5,Te=Number.NEGATIVE_INFINITY,Fe=0){let On=(0,q.YT)(Ne,"boxes","nonMaxSuppressionAsync"),sr=(0,q.YT)(Se,"scores","nonMaxSuppressionAsync"),ir=Pc(On,sr,ke,ve,Te,Fe);ke=ir.maxOutputSize,ve=ir.iouThreshold,Te=ir.scoreThreshold,Fe=ir.softNmsSigma;let Xr=yield Promise.all([On.data(),sr.data()]),Pr=Xr[0],ci=Xr[1],{selectedIndices:Fa,selectedScores:Ha}=(0,u2.ut)(Pr,ci,ke,ve,Te,Fe);return On!==Ne&&On.dispose(),sr!==Se&&sr.dispose(),{selectedIndices:zn(Fa,"int32"),selectedScores:zn(Ha)}})},ww=(0,tt.op)({nonMaxSuppressionPadded_:function(Ne,Se,ke,ve=.5,Te=Number.NEGATIVE_INFINITY,Fe=!1){let je=(0,q.YT)(Ne,"boxes","nonMaxSuppression"),hn=(0,q.YT)(Se,"scores","nonMaxSuppression"),Pn=Pc(je,hn,ke,ve,Te,null),On={boxes:je,scores:hn},sr={maxOutputSize:Pn.maxOutputSize,iouThreshold:Pn.iouThreshold,scoreThreshold:Pn.scoreThreshold,padToMaxOutputSize:Fe},ir=X.T2.runKernel(J.Zl4,On,sr);return{selectedIndices:ir[0],validOutputs:ir[1]}}}),du=function(je,hn,Pn){return ce(this,arguments,function*(Ne,Se,ke,ve=.5,Te=Number.NEGATIVE_INFINITY,Fe=!1){let On=(0,q.YT)(Ne,"boxes","nonMaxSuppressionAsync"),sr=(0,q.YT)(Se,"scores","nonMaxSuppressionAsync"),ir=Pc(On,sr,ke,ve,Te,null),Xr=ir.maxOutputSize,Pr=ir.iouThreshold,ci=ir.scoreThreshold,[Fa,Ha]=yield Promise.all([On.data(),sr.data()]),{selectedIndices:Vr,validOutputs:Vi}=(0,u2.ZS)(Fa,Ha,Xr,Pr,ci,Fe);return On!==Ne&&On.dispose(),sr!==Se&&sr.dispose(),{selectedIndices:zn(Vr,"int32"),validOutputs:(0,Zr.d)(Vi,"int32")}})};var yf=S(4711),o0=S(2954);let l2=(0,tt.op)({threshold_:function(Ne,Se="binary",ke=!1,ve=.5){let Te=(0,q.YT)(Ne,"image","threshold"),Fe=Te.shape[0]*Te.shape[1],je,hn,Pn,On,sr=(0,ee.l)(zn([ve]),255);if(H.vA(Te.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${Te.rank}.`),H.vA(Te.shape[2]===3||Te.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${Te.shape[2]}.`),H.vA(Te.dtype==="int32"||Te.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${Te.dtype}.`),H.vA(Se==="otsu"||Se==="binary",()=>`Method must be binary or otsu, but was ${Se}`),Te.shape[2]===3){[je,hn,Pn]=(0,ut.l)(Te,[1,1,1],-1);let Xr=(0,ee.l)(je,.2989),Pr=(0,ee.l)(hn,.587),ci=(0,ee.l)(Pn,.114);On=(0,Y.W)((0,Y.W)(Xr,Pr),ci)}else On=Ne;Se==="otsu"&&(sr=function(Xr,Pr){let ci,Fa,Ha,Vr,Vi,Bs,tu=zn([-1]),To=zn([0]),ja=zn([0]);for(let Bo=0;Bo<Xr.size-1;Bo++){ci=(0,Bt.d)(Xr,0,Bo+1),Fa=(0,Bt.d)(Xr,Bo+1),Vi=(0,Be.y)((0,Ke.c)(ci),Pr),Bs=(0,Be.y)((0,Ke.c)(Fa),Pr);let La=(0,Ke.c)((0,ee.l)(ci,Po(0,ci.size)));Ha=(0,Be.y)(La,(0,Ke.c)(ci));let no=(0,bn.G)(Fa.shape,ci.size),Ao=(0,Y.W)(Po(0,Fa.size),no),js=(0,ee.l)(Fa,Ao);Vr=(0,Be.y)((0,Ke.c)(js),(0,Ke.c)(Fa));let Nl=(0,pa.j)(Ha,Vr),Hi=(0,pa.j)(Ha,Vr),Id=(0,ee.l)(Vi,Bs);ja=(0,ee.l)((0,ee.l)(Id,Nl),Hi);let Nd=(0,Ur.r)(ja,To);To=(0,Al._)(Nd,ja,To),tu=(0,Al._)(Nd,zn([Bo]),tu)}return tu}(Me((0,St.w)((0,Fc.L)(On),"int32"),(0,nn.O)([]),256),Fe));let ir=ke?(0,la.I)(On,sr):(0,Ur.r)(On,sr);return(0,St.w)((0,ee.l)(ir,255),"int32")}}),kv=(0,tt.op)({transform_:function(Ne,Se,ke="nearest",ve="constant",Te=0,Fe){let je=(0,q.YT)(Ne,"image","transform","float32"),hn=(0,q.YT)(Se,"transforms","transform","float32");H.vA(je.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${je.rank}.`),H.vA(hn.rank===2&&(hn.shape[0]===je.shape[0]||hn.shape[0]===1)&&hn.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),H.vA(Fe==null||Fe.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${Fe}.`);let Pn={image:je,transforms:hn},On={interpolation:ke,fillMode:ve,fillValue:Te,outputShape:Fe};return X.T2.runKernel(J.dLy,Pn,On)}}),xw=(0,tt.op)({bandPart_:function(Ne,Se,ke){let ve=(0,q.YT)(Ne,"a","bandPart");(0,H.vA)(ve.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${ve.rank}.`);let Te=ve.shape,[Fe,je]=ve.shape.slice(-2),hn,Pn;typeof Se=="number"?((0,H.vA)(Se%1==0,()=>`bandPart(): numLower must be an integer, got ${Se}.`),(0,H.vA)(Se<=Fe,()=>`bandPart(): numLower (${Se}) must not be greater than the number of rows (${Fe}).`),hn=(0,q.YT)(Se<0?Fe:Se,"numLower","bandPart")):((0,H.vA)(Se.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),hn=(0,Al._)((0,_i.M)(Se,0),Fe,(0,ji.B)(Se,Fe))),typeof ke=="number"?((0,H.vA)(ke%1==0,()=>`bandPart(): numUpper must be an integer, got ${ke}.`),(0,H.vA)(ke<=je,()=>`bandPart(): numUpper (${ke}) must not be greater than the number of columns (${je}).`),Pn=(0,q.YT)(ke<0?je:ke,"numUpper","bandPart")):((0,H.vA)(ke.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),Pn=(0,Al._)((0,_i.M)(ke,0),je,(0,ji.B)(ke,je)));let On=(0,Ft.t)(Po(0,Fe,1,"int32"),[-1,1]),sr=Po(0,je,1,"int32"),ir=(0,pa.j)(On,sr),Xr=(0,Ya.n)((0,la.I)(ir,hn),(0,or.D)(ir,(0,Zt.H)(Pn))),Pr=(0,r0.U)([Fe,je],ve.dtype);return(0,Ft.t)((0,zt.t)((0,pi.K)((0,Ft.t)(ve,[-1,Fe,je])).map(ci=>(0,Al._)(Xr,ci,Pr))),Te)}}),lm=(0,tt.op)({gramSchmidt_:function(Ne){let Se;if(Array.isArray(Ne)){Se=!1,(0,H.vA)(Ne!=null&&Ne.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let Te=Ne[0].shape[0];for(let Fe=1;Fe<Ne.length;++Fe)(0,H.vA)(Ne[Fe].shape[0]===Te,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${Ne[Fe].shape[0]} vs. ${Te})`)}else Se=!0,Ne=(0,ut.l)(Ne,Ne.shape[0],0).map(Te=>(0,At.r)(Te,[0]));(0,H.vA)(Ne.length<=Ne[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${Ne.length}) exceeds number of dimensions (${Ne[0].shape[0]}).`);let ke=[],ve=Ne;for(let Te=0;Te<Ne.length;++Te)ke.push(X.T2.tidy(()=>{let Fe=ve[Te];if(Te>0)for(let je=0;je<Te;++je){let hn=(0,ee.l)((0,Ke.c)((0,ee.l)(ke[je],Fe)),ke[je]);Fe=(0,pa.j)(Fe,hn)}return(0,Be.y)(Fe,(0,yn.x)(Fe,"euclidean"))}));return Se?(0,zt.t)(ke,0):ke}});var cm=S(5287);function Ds(Ne,Se=!1){return X.T2.tidy(()=>{(0,H.vA)(Ne.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${Ne.shape.length}D Tensor.`);let ke=Ne.shape[0],ve=Ne.shape[1],Te=Le(ke),Fe=(0,Wn.o)(Ne),je=In([[1]],[1,1]),hn=(0,Wn.o)(je),Pn=ke>=ve?ve:ke;for(let On=0;On<Pn;++On){let sr=Fe,ir=hn,Xr=Te;[hn,Fe,Te]=X.T2.tidy(()=>{let Pr=(0,Bt.d)(Fe,[On,On],[ke-On,1]),ci=(0,yn.x)(Pr),Fa=(0,Bt.d)(Fe,[On,On],[1,1]),Ha=(0,Al._)((0,Ur.r)(Fa,0),In([[-1]]),In([[1]])),Vr=(0,pa.j)(Fa,(0,ee.l)(Ha,ci)),Vi=(0,Be.y)(Pr,Vr);hn=Vi.shape[0]===1?(0,Wn.o)(je):(0,Gt.x)([je,(0,Bt.d)(Vi,[1,0],[Vi.shape[0]-1,Vi.shape[1]])],0);let Bs=(0,Zt.H)((0,Be.y)((0,ge.N)(Ha,Vr),ci)),tu=(0,Bt.d)(Fe,[On,0],[ke-On,ve]),To=(0,ee.l)(Bs,hn),ja=(0,Gl.m)(hn);if(On===0)Fe=(0,pa.j)(tu,(0,ge.N)(To,(0,ge.N)(ja,tu)));else{let no=(0,pa.j)(tu,(0,ge.N)(To,(0,ge.N)(ja,tu)));Fe=(0,Gt.x)([(0,Bt.d)(Fe,[0,0],[On,ve]),no],0)}let Bo=(0,Gl.m)(To),La=(0,Bt.d)(Te,[0,On],[ke,Te.shape[1]-On]);if(On===0)Te=(0,pa.j)(La,(0,ge.N)((0,ge.N)(La,hn),Bo));else{let no=(0,pa.j)(La,(0,ge.N)((0,ge.N)(La,hn),Bo));Te=(0,Gt.x)([(0,Bt.d)(Te,[0,0],[ke,On]),no],1)}return[hn,Fe,Te]}),(0,cm.AS)([sr,ir,Xr])}return!Se&&ke>ve&&(Te=(0,Bt.d)(Te,[0,0],[ke,ve]),Fe=(0,Bt.d)(Fe,[0,0],[ve,ve])),[Te,Fe]})}let Ss=(0,tt.op)({qr_:function(Ne,Se=!1){if((0,H.vA)(Ne.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${Ne.rank}`),Ne.rank===2)return Ds(Ne,Se);{let ke=Ne.shape.slice(0,Ne.shape.length-2).reduce((je,hn)=>je*hn),ve=(0,pi.K)((0,Ft.t)(Ne,[ke,Ne.shape[Ne.shape.length-2],Ne.shape[Ne.shape.length-1]]),0),Te=[],Fe=[];return ve.forEach(je=>{let[hn,Pn]=Ds(je,Se);Te.push(hn),Fe.push(Pn)}),[(0,Ft.t)((0,zt.t)(Te,0),Ne.shape),(0,Ft.t)((0,zt.t)(Fe,0),Ne.shape)]}}});var jc=S(4703);let ko=(0,tt.op)({computeWeightedLoss_:function(Ne,Se,ke=jc.i.SUM_BY_NONZERO_WEIGHTS){let ve=(0,q.YT)(Ne,"losses","computeWeightedLoss"),Te=null;Se!=null&&(Te=(0,q.YT)(Se,"weights","computeWeightedLoss"));let Fe=Te==null?ve:(0,ee.l)(ve,Te);if(ke===jc.i.NONE)return Fe;if(ke===jc.i.SUM)return(0,Ke.c)(Fe);if(ke===jc.i.MEAN){if(Te==null)return(0,bu.i)(Fe);{let je=ve.size/Te.size,hn=(0,Be.y)((0,Ke.c)(Fe),(0,Ke.c)(Te));return je>1?(0,Be.y)(hn,(0,Zr.d)(je)):hn}}if(ke===jc.i.SUM_BY_NONZERO_WEIGHTS){if(Te==null)return(0,Be.y)((0,Ke.c)(Fe),(0,Zr.d)(ve.size));{let je=(0,ee.l)(Te,(0,Qs.S)(ve.shape)),hn=(0,St.w)((0,Ke.c)((0,Ce.E)(je,(0,Zr.d)(0))),"float32");return(0,Be.y)((0,Ke.c)(Fe),hn)}}throw Error(`Unknown reduction: ${ke}`)}}),Hl=(0,tt.op)({absoluteDifference_:function(Ne,Se,ke,ve=jc.i.SUM_BY_NONZERO_WEIGHTS){let Te=(0,q.YT)(Ne,"labels","absoluteDifference"),Fe=(0,q.YT)(Se,"predictions","absoluteDifference"),je=null;ke!=null&&(je=(0,q.YT)(ke,"weights","absoluteDifference")),(0,H.O3)(Te.shape,Fe.shape,"Error in absoluteDifference: ");let hn=(0,j.t)((0,pa.j)(Te,Fe));return ko(hn,je,ve)}}),Tg=(0,tt.op)({cosineDistance_:function(Ne,Se,ke,ve,Te=jc.i.SUM_BY_NONZERO_WEIGHTS){let Fe=(0,q.YT)(Ne,"labels","cosineDistance"),je=(0,q.YT)(Se,"predictions","cosineDistance"),hn=null;ve!=null&&(hn=(0,q.YT)(ve,"weights","cosineDistance")),(0,H.O3)(Fe.shape,je.shape,"Error in cosineDistance: ");let Pn=(0,Zr.d)(1),On=(0,pa.j)(Pn,(0,Ke.c)((0,ee.l)(Fe,je),ke,!0));return ko(On,hn,Te)}}),vf=(0,tt.op)({hingeLoss_:function(Ne,Se,ke,ve=jc.i.SUM_BY_NONZERO_WEIGHTS){let Te=(0,q.YT)(Ne,"labels","hingeLoss"),Fe=(0,q.YT)(Se,"predictions","hingeLoss"),je=null;ke!=null&&(je=(0,q.YT)(ke,"weights","hingeLoss")),(0,H.O3)(Te.shape,Fe.shape,"Error in hingeLoss: ");let hn=(0,Zr.d)(1);Te=(0,pa.j)((0,ee.l)((0,Zr.d)(2),Te),hn);let Pn=(0,an.V)((0,pa.j)(hn,(0,ee.l)(Te,Fe)));return ko(Pn,je,ve)}}),s0=(0,tt.op)({huberLoss_:function(Ne,Se,ke,ve=1,Te=jc.i.SUM_BY_NONZERO_WEIGHTS){let Fe=(0,q.YT)(Ne,"labels","huberLoss"),je=(0,q.YT)(Se,"predictions","huberLoss"),hn=null;ke!=null&&(hn=(0,q.YT)(ke,"weights","huberLoss")),(0,H.O3)(Fe.shape,je.shape,"Error in huberLoss: ");let Pn=(0,Zr.d)(ve),On=(0,j.t)((0,pa.j)(je,Fe)),sr=(0,ji.B)(On,Pn),ir=(0,pa.j)(On,sr),Xr=(0,Y.W)((0,ee.l)((0,Zr.d)(.5),(0,xu.E)(sr)),(0,ee.l)(Pn,ir));return ko(Xr,hn,Te)}}),Td=(0,tt.op)({logLoss_:function(Ne,Se,ke,ve=1e-7,Te=jc.i.SUM_BY_NONZERO_WEIGHTS){let Fe=(0,q.YT)(Ne,"labels","logLoss"),je=(0,q.YT)(Se,"predictions","logLoss"),hn=null;ke!=null&&(hn=(0,q.YT)(ke,"weights","logLoss")),(0,H.O3)(Fe.shape,je.shape,"Error in logLoss: ");let Pn=(0,Zr.d)(1),On=(0,Zr.d)(ve),sr=(0,Zt.H)((0,ee.l)(Fe,(0,vs.R)((0,Y.W)(je,On)))),ir=(0,ee.l)((0,pa.j)(Pn,Fe),(0,vs.R)((0,Y.W)((0,pa.j)(Pn,je),On))),Xr=(0,pa.j)(sr,ir);return ko(Xr,hn,Te)}}),Sv=(0,tt.op)({meanSquaredError_:function(Ne,Se,ke,ve=jc.i.SUM_BY_NONZERO_WEIGHTS){let Te=(0,q.YT)(Ne,"labels","meanSquaredError"),Fe=(0,q.YT)(Se,"predictions","meanSquaredError"),je=null;ke!=null&&(je=(0,q.YT)(ke,"weights","meanSquaredError")),(0,H.O3)(Te.shape,Fe.shape,"Error in meanSquaredError: ");let hn=(0,mt.P)(Te,Fe);return ko(hn,je,ve)}}),c2=(0,tt.op)({sigmoidCrossEntropy_:function(Ne,Se,ke,ve=0,Te=jc.i.SUM_BY_NONZERO_WEIGHTS){let Fe=(0,q.YT)(Ne,"multiClassLabels","sigmoidCrossEntropy"),je=(0,q.YT)(Se,"logits","sigmoidCrossEntropy"),hn=null;if(ke!=null&&(hn=(0,q.YT)(ke,"weights","sigmoidCrossEntropy")),(0,H.O3)(Fe.shape,je.shape,"Error in sigmoidCrossEntropy: "),ve>0){let On=(0,Zr.d)(ve),sr=(0,Zr.d)(1),ir=(0,Zr.d)(.5);Fe=(0,Y.W)((0,ee.l)(Fe,(0,pa.j)(sr,On)),(0,ee.l)(ir,On))}let Pn=function(On,sr){let ir=(0,q.YT)(On,"labels","sigmoidCrossEntropyWithLogits"),Xr=(0,q.YT)(sr,"logits","sigmoidCrossEntropyWithLogits");(0,H.O3)(ir.shape,Xr.shape,"Error in sigmoidCrossEntropyWithLogits: ");let Pr=(0,an.V)(Xr),ci=(0,ee.l)(Xr,ir),Fa=(0,qo.K)((0,br.o)((0,Zt.H)((0,j.t)(Xr))));return(0,Y.W)((0,pa.j)(Pr,ci),Fa)}(Fe,je);return ko(Pn,hn,Te)}}),gh=(0,tt.op)({softmaxCrossEntropy_:function(Ne,Se,ke,ve=0,Te=jc.i.SUM_BY_NONZERO_WEIGHTS){let Fe=(0,q.YT)(Ne,"onehotLabels","softmaxCrossEntropy"),je=(0,q.YT)(Se,"logits","softmaxCrossEntropy"),hn=null;if(ke!=null&&(hn=(0,q.YT)(ke,"weights","softmaxCrossEntropy")),(0,H.O3)(Fe.shape,je.shape,"Error in softmaxCrossEntropy: "),ve>0){let On=(0,Zr.d)(ve),sr=(0,Zr.d)(1),ir=(0,Zr.d)(Fe.shape[1]);Fe=(0,Y.W)((0,ee.l)(Fe,(0,pa.j)(sr,On)),(0,Be.y)(On,ir))}let Pn=function(On,sr,ir=-1){if(ir===-1&&(ir=sr.rank-1),ir!==sr.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${sr.rank} and dim was ${ir}`);return(0,oe._X)((Pr,ci,Fa)=>{let Ha=(0,va.V)(ci,[ir],!0),Vr=(0,pa.j)((0,St.w)(ci,"float32"),Ha);Fa([Pr,Vr]);let Vi=(0,Zt.H)((0,ee.l)(Vr,Pr));return{value:(0,Ke.c)(Vi,[ir]),gradFunc:(Bs,tu)=>{let[To,ja]=tu,Bo=(0,xs.SM)(Bs.shape,[ir]);return[(0,ee.l)((0,Ft.t)(Bs,Bo),(0,pa.j)((0,St.w)(To,"float32"),(0,br.o)(ja))),(0,ee.l)((0,Ft.t)(Bs,Bo),(0,pa.j)((0,br.o)(ja),(0,St.w)(To,"float32")))]}}})(On,sr)}(Fe,je);return ko(Pn,hn,Te)}}),Uc=(0,tt.op)({sparseFillEmptyRows_:function(Ne,Se,ke,ve){let Te=(0,q.YT)(Ne,"indices","sparseFillEmptyRows","int32"),Fe=(0,q.YT)(Se,"values","sparseFillEmptyRows"),je=(0,q.YT)(ke,"denseShape","sparseFillEmptyRows","int32"),hn=(0,q.YT)(ve,"defaultValue","sparseFillEmptyRows",Fe.dtype);if(Te.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${Te.shape}`);if(Fe.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${Fe.shape}`);if(je.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${je.shape}`);if(hn.rank!==0)throw new Error(`Default value should be a scalar but received shape ${hn.shape}`);let Pn={indices:Te,values:Fe,denseShape:je,defaultValue:hn},On=X.T2.runKernel(J.C8s,Pn);return{outputIndices:On[0],outputValues:On[1],emptyRowIndicator:On[2],reverseIndexMap:On[3]}}}),tl=(0,tt.op)({sparseReshape_:function(Ne,Se,ke){let ve=(0,q.YT)(Ne,"inputIndices","sparseReshape","int32"),Te=(0,q.YT)(Se,"inputShape","sparseReshape","int32"),Fe=(0,q.YT)(ke,"newShape","sparseReshape","int32");if(ve.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${ve.shape}`);if(Te.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${Te.shape}`);if(Fe.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${Fe.shape}`);let je={inputIndices:ve,inputShape:Te,newShape:Fe},hn=X.T2.runKernel(J.BoJ,je);return{outputIndices:hn[0],outputShape:hn[1]}}}),Kh=(0,tt.op)({sparseSegmentMean_:function(Ne,Se,ke){let ve=(0,q.YT)(Ne,"data","sparseSegmentMean"),Te=(0,q.YT)(Se,"indices","sparseSegmentMean","int32"),Fe=(0,q.YT)(ke,"segmentIds","sparseSegmentMean","int32");if(ve.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(Te.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${Te.shape}`);if(Fe.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${Fe.shape}`);let je={data:ve,indices:Te,segmentIds:Fe};return X.T2.runKernel(J.L6G,je)}}),ip=(0,tt.op)({sparseSegmentSum_:function(Ne,Se,ke){let ve=(0,q.YT)(Ne,"data","sparseSegmentSum"),Te=(0,q.YT)(Se,"indices","sparseSegmentSum","int32"),Fe=(0,q.YT)(ke,"segmentIds","sparseSegmentSum","int32");if(ve.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(Te.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${Te.shape}`);if(Fe.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${Fe.shape}`);let je={data:ve,indices:Te,segmentIds:Fe};return X.T2.runKernel(J.DvZ,je)}}),hm=(0,tt.op)({stringNGrams_:function(Ne,Se,ke,ve,Te,Fe,je,hn){let Pn=(0,q.YT)(Ne,"data","stringNGrams","string");if(Pn.dtype!=="string")throw new Error("Data must be of datatype string");if(Pn.shape.length!==1)throw new Error(`Data must be a vector, saw: ${Pn.shape}`);let On=(0,q.YT)(Se,"dataSplits","stringNGrams");if(On.dtype!=="int32")throw new Error("Data splits must be of datatype int32");let sr={separator:ke,nGramWidths:ve,leftPad:Te,rightPad:Fe,padWidth:je,preserveShortSequences:hn},ir={data:Pn,dataSplits:On},Xr=X.T2.runKernel(J.YAb,ir,sr);return{nGrams:Xr[0],nGramsSplits:Xr[1]}}}),lc=(0,tt.op)({stringSplit_:function(Ne,Se,ke=!0){let ve=(0,q.YT)(Ne,"input","stringSplit","string"),Te=(0,q.YT)(Se,"delimiter","stringSplit","string");if(ve.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${ve.shape}`);if(Te.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${Te.shape}`);let Fe={skipEmpty:ke},je={input:ve,delimiter:Te},hn=X.T2.runKernel(J.iW0,je,Fe);return{indices:hn[0],values:hn[1],shape:hn[2]}}}),Ag=(0,tt.op)({stringToHashBucketFast_:function(Ne,Se){let ke=(0,q.YT)(Ne,"input","stringToHashBucketFast","string"),ve={numBuckets:Se};if(Se<=0)throw new Error("Number of buckets must be at least 1");let Te={input:ke};return X.T2.runKernel(J.$jE,Te,ve)}}),Il=(0,tt.op)({staticRegexReplace_:function(Ne,Se,ke,ve=!0){let Te=(0,q.YT)(Ne,"input","staticRegexReplace","string"),Fe={pattern:Se,rewrite:ke,replaceGlobal:ve};return X.T2.runKernel(J.GZp,{x:Te},Fe)}}),bf={fft:yt.h,ifft:D.K,rfft:et.z,irfft:U.g},I5={hammingWindow:qr,hannWindow:xr,frame:ma,stft:ca},Ad={flipLeftRight:Qo,grayscaleToRGB:Ps,resizeNearestNeighbor:o0.b,resizeBilinear:yf.v,rgbToGrayscale:Cg,rotateWithOffset:a0,cropAndResize:uo,nonMaxSuppression:xv,nonMaxSuppressionAsync:Eg,nonMaxSuppressionWithScore:hu,nonMaxSuppressionWithScoreAsync:Bc,nonMaxSuppressionPadded:ww,nonMaxSuppressionPaddedAsync:du,threshold:l2,transform:kv},N5={bandPart:xw,gramSchmidt:lm,qr:Ss},kw={absoluteDifference:Hl,computeWeightedLoss:ko,cosineDistance:Tg,hingeLoss:vf,huberLoss:s0,logLoss:Td,meanSquaredError:Sv,sigmoidCrossEntropy:c2,softmaxCrossEntropy:gh},M5={sparseFillEmptyRows:Uc,sparseReshape:tl,sparseSegmentMean:Kh,sparseSegmentSum:ip},D5={stringNGrams:hm,stringSplit:lc,stringToHashBucketFast:Ag,staticRegexReplace:Il}},5661:(L,O,S)=>{S.d(O,{e:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({pad_:function(Y,X,J=0){let q=(0,K.YT)(Y,"x","pad");if(q.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");let H={paddings:X,constantValue:J},tt={x:q};return B.T2.runKernel(j.ODT,tt,H)}})},7872:(L,O,S)=>{S.d(O,{d:()=>tt});var B=S(8189),j=S(5119),K=S(3909),Z=S(9772),Y=S(7195),X=S(6999),J=S(929),q=S(2302),H=S(776);let tt=(0,J.op)({pool_:function(st,lt,ft,gt,xt,wt,_t){xt==null&&(xt=[1,1]),wt==null&&(wt=1),gt===0&&(gt="valid");let bt=(0,B.YT)(st,"x","maxPool"),Tt=bt,qt=!1;bt.rank===3&&(qt=!0,Tt=(0,q.t)(bt,[1,bt.shape[0],bt.shape[1],bt.shape[2]])),j.vA(Y.G0(wt,xt),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${wt} and dilations '${xt}'`);let It=Y.E6(Tt.shape,lt,wt,xt,gt),St=[It.dilationHeight,It.dilationWidth],vt;vt=gt==="same"?function(Xt,we){let ie=Xt.map((te,Me)=>te+(te-1)*(we[Me]-1)),m=ie.map(te=>te-1),ye=m.map(te=>Math.floor(te/2)),Ge=m.map((te,Me)=>te-ye[Me]);return m.map((te,Me)=>[ye[Me],Ge[Me]])}([It.filterHeight,It.filterWidth],St):[[0,0],[0,0]];let Ft=St[0]===1&&St[1]===1,[Qt,Gt]=function(Xt,we,ie){let m=ie.map(kn=>kn[0]),ye=ie.map(kn=>kn[1]),Ge=Xt.concat(m,ye),te=we.map((kn,mn)=>(kn-Ge[mn]%kn)%kn),Me=ye.map((kn,mn)=>kn+te[mn]),Ye=we.map((kn,mn)=>[m[mn],Me[mn]]),Ue=we.map((kn,mn)=>[0,te[mn]]);return[Ye,Ue]}([It.inHeight,It.inWidth],St,vt),ge=Ft?gt:"valid",ee=Ft?Tt:(0,H.e)(Tt,St,Qt),Ee=(ft==="avg"?()=>(0,K.$)(ee,lt,wt,ge,_t):()=>(0,X.j)(ee,lt,wt,ge,_t))(),Bt=Ft?Ee:(0,Z.G)(Ee,St,Gt);return qt?(0,q.t)(Bt,[Bt.shape[1],Bt.shape[2],Bt.shape[3]]):Bt}})},8990:(L,O,S)=>{S.d(O,{n:()=>Y});var B=S(1585),j=S(5441),K=S(565),Z=S(8189);let Y=(0,S(929).op)({pow_:function(X,J){let q=(0,Z.YT)(X,"base","pow"),H=(0,Z.YT)(J,"exp","pow");[q,H]=(0,K.makeTypesMatch)(q,H);let tt={a:q,b:H};return B.T2.runKernel(j.pyJ,tt)}})},4394:(L,O,S)=>{S.d(O,{N:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({prelu_:function(Y,X){let J={x:(0,K.YT)(Y,"x","prelu"),alpha:(0,K.YT)(X,"alpha","prelu")};return B.T2.runKernel(j.Ncv,J)}})},5295:(L,O,S)=>{function B(j,K=!1){console.log(j.toString(K))}S.d(O,{y:()=>B})},7771:(L,O,S)=>{S.d(O,{_:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(9809);let Y=(0,S(929).op)({prod_:function(X,J=null,q=!1){let H=(0,K.YT)(X,"x","prod");H.dtype==="bool"&&(H=(0,Z.w)(H,"int32"));let tt={x:H},st={axis:J,keepDims:q};return B.T2.runKernel(j.kdj,tt,st)}})},1902:(L,O,S)=>{S.d(O,{x:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({real_:function(Y){let X={input:(0,K.YT)(Y,"input","real")};return B.T2.runKernel(j.LRy,X)}})},9870:(L,O,S)=>{S.d(O,{V:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({reciprocal_:function(Y){let X={x:(0,K.YT)(Y,"x","reciprocal")};return B.T2.runKernel(j.huO,X)}})},112:(L,O,S)=>{S.d(O,{V:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({relu_:function(Y){let X={x:(0,K.YT)(Y,"x","relu")};return B.T2.runKernel(j.fUj,X)}})},3732:(L,O,S)=>{S.d(O,{j:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({relu6_:function(Y){let X={x:(0,K.YT)(Y,"x","relu6")};return B.T2.runKernel(j.P_L,X)}})},2302:(L,O,S)=>{S.d(O,{t:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({reshape_:function(Y,X){let J={x:(0,K.YT)(Y,"x","reshape","string_or_numeric")},q={shape:X};return B.T2.runKernel(j.R23,J,q)}})},3262:(L,O,S)=>{S.d(O,{B:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({reverse_:function(Y,X){let J={x:(0,K.YT)(Y,"x","reverse")},q={dims:X};return B.T2.runKernel(j.D7i,J,q)}})},5912:(L,O,S)=>{S.d(O,{L:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({round_:function(Y){let X={x:(0,K.YT)(Y,"x","round")};return B.T2.runKernel(j.hVg,X)}})},7820:(L,O,S)=>{S.d(O,{Z:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({rsqrt_:function(Y){let X={x:(0,K.YT)(Y,"x","rsqrt","float32")};return B.T2.runKernel(j.TOR,X)}})},5702:(L,O,S)=>{S.d(O,{d:()=>K});var B=S(3879),j=S(9171);function K(Z,Y){if(((0,B.isTypedArray)(Z)&&Y!=="string"||Array.isArray(Z))&&Y!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(Y==="string"&&(0,B.isTypedArray)(Z)&&!(Z instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return(0,j.Q)(Z,[],[],Y)}},6170:(L,O,S)=>{S.r(O),S.d(O,{calculateShapes:()=>Z,validateInput:()=>K,validateUpdateShape:()=>j});var B=S(5119);function j(Y,X,J){let q=X.rank>1?X.shape[X.rank-1]:1,H=X.rank>1?X.rank-1:1,tt=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${J.shape}, indices.shape: ${X.shape}, shape: ${Y}, sliceDim: ${q}, and batchDim: ${H}.`;if(J.rank<H)throw new Error(tt+` update.rank < ${H}. `);if(Y.length<q+(J.rank-H))throw new Error(tt+` Output shape length < ${q+(J.rank-H)}`);if(J.rank!==H+Y.length-q)throw new Error(tt+" update.rank != "+(H+Y.length-q));for(let st=0;st<H;++st)if(J.shape[st]!==X.shape[st])throw new Error(tt+` updates.shape[${st}] (${J.shape[st]}) != indices.shape[${st}] (${X.shape[st]}).`);for(let st=0;st<J.rank-H;++st)if(J.shape[st+H]!==Y[st+q])throw new Error(tt+` updates.shape[${st+H}] (${J.shape[st+H]}) != shape[${st+H}] (${Y[st+H]})`)}function K(Y,X,J){if(X.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${X.rank}.`);if(Y.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${Y.rank}.`);if(X.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${X.dtype}`);if(J.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${J}`);if(J.length===0){if(X.size===0)throw new Error(`Indices specified for empty output. indices shape: ${X.shape}`);if(Y.size===0)throw new Error(`Updates specified for empty output. updates shape: ${Y.shape}`)}j(J,X,Y)}function Z(Y,X,J){let q=X.shape.length,H=q>1?X.shape[q-1]:1,tt=J.length,st=1;for(let ft=H;ft<tt;++ft)st*=J[ft];let lt=H<1?1:H;return{sliceRank:H,numUpdates:(0,B.Ze)(X.shape)/lt,sliceSize:st,strides:[...(0,B.Ur)(J.slice(0,H)),1],outputSize:(0,B.Ze)(J)}}},6325:(L,O,S)=>{S.d(O,{W:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({selu_:function(Y){let X={x:(0,K.YT)(Y,"x","selu")};return B.T2.runKernel(j.u$b,X)}})},8576:(L,O,S)=>{S.d(O,{X:()=>j,j:()=>B});let B=1.7580993408473768,j=1.0507009873554805},9986:(L,O,S)=>{S.d(O,{w:()=>J});var B=S(8189),j=S(5119),K=S(8794),Z=S(676),Y=S(929),X=S(2302);let J=(0,Y.op)({separableConv2d_:function(q,H,tt,st,lt,ft=[1,1],gt="NHWC"){let xt=(0,B.YT)(q,"x","separableConv2d"),wt=(0,B.YT)(H,"depthwiseFilter","separableConv2d"),_t=(0,B.YT)(tt,"pointwiseFilter","separableConv2d"),bt=xt,Tt=!1;if(xt.rank===3&&(Tt=!0,bt=(0,X.t)(xt,[1,xt.shape[0],xt.shape[1],xt.shape[2]])),gt==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");j.vA(bt.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${bt.rank}.`),j.vA(wt.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${wt.rank}.`),j.vA(_t.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${wt.rank}.`),j.vA(_t.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${_t.shape[0]}.`),j.vA(_t.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${_t.shape[1]}.`);let qt=wt.shape[2],It=wt.shape[3];j.vA(_t.shape[2]===qt*It,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${qt*It}, but got ${_t.shape[2]}.`);let St=(0,Z.G)(bt,wt,st,lt,gt,ft),vt=(0,K.X)(St,_t,1,"valid",gt);return Tt?(0,X.t)(vt,[vt.shape[1],vt.shape[2],vt.shape[3]]):vt}})},8968:(L,O,S)=>{S.d(O,{r:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({sigmoid_:function(Y){let X={x:(0,K.YT)(Y,"x","sigmoid","float32")};return B.T2.runKernel(j.vI1,X)}})},1115:(L,O,S)=>{S.d(O,{_:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({sign_:function(Y){let X={x:(0,K.YT)(Y,"x","sign")};return B.T2.runKernel(j.YVe,X)}})},3726:(L,O,S)=>{S.d(O,{F:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({sin_:function(Y){let X={x:(0,K.YT)(Y,"x","sin","float32")};return B.T2.runKernel(j.hql,X)}})},8276:(L,O,S)=>{S.d(O,{L:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({sinh_:function(Y){let X={x:(0,K.YT)(Y,"x","sinh")};return B.T2.runKernel(j.J3C,X)}})},7986:(L,O,S)=>{S.d(O,{d:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({slice_:function(Y,X,J){let q=(0,K.YT)(Y,"x","slice","string_or_numeric");if(q.rank===0)throw new Error("Slicing scalar is not possible");let H={x:q},tt={begin:X,size:J};return B.T2.runKernel(j.JiE,H,tt)}})},4969:(L,O,S)=>{S.r(O),S.d(O,{assertParamsValid:()=>Z,computeFlatOffset:()=>_t,computeOutShape:()=>X,getNormalizedAxes:()=>tt,isSliceContinous:()=>wt,maskToAxes:()=>Y,parseSliceParams:()=>bt,sliceInfo:()=>Tt,startForAxis:()=>gt,startIndicesWithElidedDims:()=>st,stopForAxis:()=>xt,stopIndicesWithElidedDims:()=>lt,stridesForAxis:()=>ft,stridesWithElidedDims:()=>J});var B=S(5119);let j=-2,K=-1;function Z(It,St,vt){let Ft=It.shape.length;B.vA(Ft===St.length,()=>`Error in slice${Ft}D: Length of begin ${St} must match the rank of the array (${Ft}).`),B.vA(Ft===vt.length,()=>`Error in slice${Ft}D: Length of size ${vt} must match the rank of the array (${Ft}).`);for(let Qt=0;Qt<Ft;++Qt)B.vA(St[Qt]+vt[Qt]<=It.shape[Qt],()=>`Error in slice${Ft}D: begin[${Qt}] + size[${Qt}] (${St[Qt]+vt[Qt]}) would overflow input.shape[${Qt}] (${It.shape[Qt]})`)}function Y(It){let St=[],vt=0;for(;It>0;)1&It&&St.push(vt),It/=2,vt++;return St}function X(It,St,vt){let Ft=[];for(let Qt=0;Qt<It.length;Qt++)Ft[Qt]=Math.ceil((St[Qt]-It[Qt])/vt[Qt]);return Ft}function J(It,St,vt,Ft){let Qt=[...It];for(let Gt=Qt.length;Gt<Ft.length;Gt++)Qt.push(1);for(let Gt=0;Gt<vt;Gt++)Gt===0?Qt[St]=1:(Qt.splice(St,0,1),Qt.pop());return Qt}function q(It,St,vt){return vt<=It?vt:vt-(St-1)}function H(It,St){let vt=[];for(let Ft=0;Ft<It;Ft++)vt.push(St+Ft);return vt}function tt(It,St,vt,Ft,Qt,Gt,ge,ee,Ee){let Bt=It.length,Xt=new Array(Bt),we=new Array(Bt),ie=new Array(Bt);if(St.length&&vt>0){let m=St[0],ye=vt+1;Xt=st(ge,m,ye,Ft,It),we=lt(ee,m,ye,Qt,It),ie=J(Gt,m,ye,It)}else for(let m=0;m<Bt;m++)Xt[m]=gt(ge,Ft,Gt,It,m,Ee),we[m]=xt(ee,Qt,Gt,It,m,Ee),ie[m]=ft(Gt,m,Ee);return{begin:Xt,end:we,strides:ie}}function st(It,St,vt,Ft,Qt){let Gt=[...Qt],ge=H(vt,St);for(let ee=0;ee<Gt.length;ee++)if(ge.indexOf(ee)>-1)Gt[ee]=0;else{let Ee=q(St,vt,ee),Bt=Ft[Ee];It&1<<Ee&&(Bt=0),Gt[ee]=Bt}return Gt}function lt(It,St,vt,Ft,Qt){let Gt=[...Qt],ge=H(vt,St);for(let ee=0;ee<Gt.length;ee++)if(ge.indexOf(ee)>-1)Gt[ee]=Number.MAX_SAFE_INTEGER;else{let Ee=q(St,vt,ee),Bt=Ft[Ee];It&1<<Ee&&(Bt=Number.MAX_SAFE_INTEGER),Gt[ee]=Bt}for(let ee=0;ee<Gt.length;ee++){let Ee=Qt[ee];Gt[ee]<0&&(Gt[ee]+=Ee),Gt[ee]=B.qE(0,Gt[ee],Qt[ee])}return Gt}function ft(It,St,vt){let Ft=It[St];return(vt&1<<St||Ft==null)&&(Ft=1),Ft}function gt(It,St,vt,Ft,Qt,Gt){let ge=St[Qt],ee=vt[Qt]||1;(It&1<<Qt||Gt&1<<Qt||ge==null)&&(ge=ee>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);let Ee=Ft[Qt];return ge<0&&(ge+=Ee),ge=B.qE(0,ge,Ee-1),ge}function xt(It,St,vt,Ft,Qt,Gt){let ge=St[Qt],ee=vt[Qt]||1;(It&1<<Qt||Gt&1<<Qt||ge==null)&&(ge=ee>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);let Ee=Ft[Qt];return ge<0&&(ge+=Ee),ge=ee>0?B.qE(0,ge,Ee):B.qE(-1,ge,Ee-1),ge}function wt(It,St,vt){let Ft=vt.length;for(let Qt=0;Qt<vt.length;Qt++)if(vt[Qt]>1){Ft=Qt;break}for(let Qt=Ft+1;Qt<vt.length;Qt++)if(St[Qt]>0||vt[Qt]!==It[Qt])return!1;return!0}function _t(It,St){let vt=It.length>0?It[It.length-1]:1;for(let Ft=0;Ft<It.length-1;Ft++)vt+=It[Ft]*St[Ft];return vt}function bt(It,St,vt){let Ft,Qt=It.shape.length,Gt;return Ft=typeof St=="number"?[St,...new Array(Qt-1).fill(0)]:St.length<Qt?St.concat(new Array(Qt-St.length).fill(0)):St.slice(),Ft.forEach(ge=>{B.vA(ge!==-1,()=>"slice() does not support negative begin indexing.")}),Gt=vt==null?new Array(Qt).fill(-1):typeof vt=="number"?[vt,...new Array(Qt-1).fill(-1)]:vt.length<Qt?vt.concat(new Array(Qt-vt.length).fill(-1)):vt,Gt=Gt.map((ge,ee)=>ge>=0?ge:(B.vA(ge===-1,()=>`Negative size values should be exactly -1 but got ${ge} for the slice() size at index ${ee}.`),It.shape[ee]-Ft[ee])),[Ft,Gt]}function Tt(It,St,vt,Ft,Qt,Gt,ge,ee,Ee){let Bt;if(Ft==null?(Bt=new Array(St.length),Bt.fill(1)):Bt=Ft,ge!=null&&ge&ge-1)throw new Error("Multiple ellipses in slice is not allowed.");let Xt=!1,we={dims:Bt.length,numAddAxisAfterEllipsis:0,begin:St.slice(),end:vt.slice(),strides:Bt.slice(),beginMask:Qt,endMask:Gt,ellipsisMask:ge,newAxisMask:ee,shrinkAxisMask:Ee};for(let Ye=0;Ye<we.dims;Ye++)Xt&&1<<Ye&ee&&we.numAddAxisAfterEllipsis++,1<<Ye&ge&&(Xt=!0);Xt||(we.ellipsisMask|=1<<we.dims,we.dims++);let ie={dims:It.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};(function(Ye,Ue){Ue.beginMask=0,Ue.endMask=0,Ue.shrinkAxisMask=0;let kn=0;Ue.beginValid=Ye.begin!=null,Ue.endValid=Ye.end!=null,Ue.begin=new Array(Ue.dims),Ue.end=new Array(Ue.dims),Ue.strides=new Array(Ue.dims),Ue.finalShapeGatherIndices=[],Ue.finalShapeGatherIndicesSparse=[],Ue.inputShapeGatherIndicesSparse=new Array(Ue.dims);for(let mn=0;mn<Ye.dims;mn++)if(1<<mn&Ye.ellipsisMask){let Kn=Math.min(Ue.dims-(Ye.dims-mn)+1+Ye.numAddAxisAfterEllipsis,Ue.dims);for(;kn<Kn;kn++)Ue.begin[kn]=0,Ue.end[kn]=0,Ue.strides[kn]=1,Ue.beginMask|=1<<kn,Ue.endMask|=1<<kn,Ue.finalShapeGatherIndices.push(kn),Ue.finalShapeGatherIndicesSparse.push(-1),Ue.inputShapeGatherIndicesSparse[kn]=mn}else if(1<<mn&Ye.newAxisMask)Ue.finalShapeGatherIndices.push(j),Ue.finalShapeGatherIndicesSparse.push(-1);else{if(kn===Ue.begin.length)throw Error(`Index out of range using input dim ${kn}; input has only ${Ue.dims} dims, ${Ue.begin.length}.`);Ye.begin!=null&&(Ue.begin[kn]=Ye.begin[mn]),Ye.end!=null&&(Ue.end[kn]=Ye.end[mn]),Ue.strides[kn]=Ye.strides[mn],Ye.beginMask&1<<mn&&(Ue.beginMask|=1<<kn),Ye.endMask&1<<mn&&(Ue.endMask|=1<<kn),Ye.shrinkAxisMask&1<<mn?(Ue.finalShapeGatherIndices.push(K),Ue.finalShapeGatherIndicesSparse.push(-1),Ue.shrinkAxisMask|=1<<kn):(Ue.finalShapeGatherIndices.push(kn),Ue.finalShapeGatherIndicesSparse.push(mn)),Ue.inputShapeGatherIndicesSparse[kn]=mn,kn++}})(we,ie);let m=!0,ye=!0,Ge=!0,te=[],Me=[];for(let Ye=0;Ye<It.length;++Ye){if(ie.strides[Ye]===0)throw Error(`strides[${Ye}] must be non-zero`);let Ue=!!(ie.shrinkAxisMask&1<<Ye),kn=It[Ye];if(kn===-1){te.push(Ue?1:-1);continue}let mn=[ie.beginMask&1<<Ye,ie.endMask&1<<Ye],Kn=[ie.strides[Ye]>0?0:-1,ie.strides[Ye]>0?kn:kn-1];if(Ue&&ie.strides[Ye]<=0)throw Error("only stride 1 allowed on non-range indexing.");Ge=Ge&&ie.strides[Ye]===1;let Sn=!!(ie.beginMask&1<<Ye&&ie.endMask&1<<Ye);if(ie.beginValid&&ie.endValid){if(Ue){let Re=ie.begin[Ye]<0?kn+ie.begin[Ye]:ie.begin[Ye];if(ie.begin[Ye]=Re,ie.end[Ye]=ie.begin[Ye]+1,Re<0||Re>=kn)throw Error(`slice index ${ie.begin[Ye]} of dimension ${Ye} out of bounds.`)}else ie.begin[Ye]=qt(ie.begin[Ye],0,ie.strides[Ye],kn,mn,Kn),ie.end[Ye]=qt(ie.end[Ye],1,ie.strides[Ye],kn,mn,Kn);let de=ie.strides[Ye]===1&&ie.begin[Ye]===0&&ie.end[Ye]===kn;m=m&&de,ye=ye&&(Ye===0&&ie.strides[Ye]===1||de)}else m=m&&ie.strides[Ye]===1&&Sn,ye=ye&&(Ye===0&&ie.strides[Ye]===1||Sn);let Wn,Ze=!1;if(ie.beginValid&&ie.endValid?(Wn=ie.end[Ye]-ie.begin[Ye],Ze=!0):Ue?(Wn=1,Ze=!0):Sn&&kn>=0&&(Wn=ie.strides[Ye]<0?-kn:kn,Ze=!0),Ze){let de;de=Wn===0||Wn<0!=ie.strides[Ye]<0?0:Math.trunc(Wn/ie.strides[Ye])+(Wn%ie.strides[Ye]!=0?1:0),te.push(de)}else te.push(-1)}for(let Ye=0;Ye<ie.finalShapeGatherIndices.length;++Ye){let Ue=ie.finalShapeGatherIndices[Ye];Ue>=0?Me.push(te[Ue]):Ue===j&&Me.push(1)}return{finalShapeSparse:Me.filter((Ye,Ue)=>ie.finalShapeGatherIndices[Ue]!==j),finalShape:Me,isIdentity:m,sliceDim0:ye,isSimpleSlice:Ge,begin:ie.begin,end:ie.end,strides:ie.strides}}function qt(It,St,vt,Ft,Qt,Gt){if(Qt[St])return vt>0?Gt[St]:Gt[St+1&1];{let ge=It<0?Ft+It:It;return ge<Gt[0]?Gt[0]:ge>Gt[1]?Gt[1]:ge}}},6346:(L,O,S)=>{S.d(O,{V:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({softmax_:function(Y,X=-1){let J=(0,K.YT)(Y,"logits","softmax","float32");if(X===-1&&(X=J.rank-1),X!==J.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${J.rank} and dim was ${X}`);let q={logits:J},H={dim:X};return B.T2.runKernel(j.rFG,q,H)}})},6030:(L,O,S)=>{S.d(O,{l:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({softplus_:function(Y){let X={x:(0,K.YT)(Y,"x","softplus")};return B.T2.runKernel(j.Fin,X)}})},776:(L,O,S)=>{S.d(O,{e:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119);let Y=(0,S(929).op)({spaceToBatchND_:function(X,J,q){let H=(0,K.YT)(X,"x","spaceToBatchND");Z.vA(H.rank>=1+J.length,()=>`input rank ${H.rank} should be > than [blockShape] ${J.length}`),Z.vA(q.length===J.length,()=>`paddings.shape[0] ${q.length} must be equal to [blockShape] ${J.length}`),Z.vA(H.shape.reduce((lt,ft,gt)=>gt>0&&gt<=J.length?lt&&(ft+q[gt-1][0]+q[gt-1][1])%J[gt-1]==0:lt,!0),()=>`input spatial dimensions ${H.shape.slice(1)} with paddings ${q.toString()} must be divisible by blockShapes ${J.toString()}`);let tt={x:H},st={blockShape:J,paddings:q};return B.T2.runKernel(j.A8B,tt,st)}})},1361:(L,O,S)=>{S.d(O,{h:()=>Z});var B=S(1585),j=S(5441),K=S(5119);let Z=(0,S(929).op)({fft_:function(Y){(0,K.vA)(Y.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${Y.dtype}.`);let X={input:Y};return B.T2.runKernel(j.rGP,X)}})},3108:(L,O,S)=>{S.d(O,{K:()=>Z});var B=S(1585),j=S(5441),K=S(5119);let Z=(0,S(929).op)({ifft_:function(Y){(0,K.vA)(Y.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${Y.dtype}.`);let X={input:Y};return B.T2.runKernel(j.OAQ,X)}})},2292:(L,O,S)=>{S.d(O,{g:()=>lt});var B=S(7148),j=S(5030),K=S(5040),Z=S(9258),Y=S(929),X=S(1902),J=S(2302),q=S(3262),H=S(5702),tt=S(7986),st=S(3108);let lt=(0,Y.op)({irfft_:function(ft){let gt=ft.shape[ft.shape.length-1],xt=ft.size/gt,wt;if(gt<=2){let _t=(0,J.t)(ft,[xt,gt]);wt=(0,st.K)(_t)}else{let _t=[xt,2*(gt-1)],bt=(0,J.t)((0,X.x)(ft),[xt,gt]),Tt=(0,J.t)((0,K.n)(ft),[xt,gt]),qt=(0,q.B)((0,tt.d)(bt,[0,1],[xt,gt-2]),1),It=(0,Z.l)((0,q.B)((0,tt.d)(Tt,[0,1],[xt,gt-2]),1),(0,H.d)(-1)),St=(0,j.x)([bt,qt],1),vt=(0,j.x)([Tt,It],1),Ft=(0,J.t)((0,B.f)(St,vt),[_t[0],_t[1]]);wt=(0,st.K)(Ft)}if(wt=(0,X.x)(wt),ft.rank===3&&ft.shape[0]!==0){let _t=wt,bt=ft.shape[0];wt=(0,J.t)(wt,[bt,wt.shape[0]/bt,wt.shape[1]]),_t.dispose()}return wt}})},8775:(L,O,S)=>{S.d(O,{z:()=>ft});var B=S(5119),j=S(7148),K=S(5030),Z=S(5040),Y=S(929),X=S(1902),J=S(2302),q=S(7986),H=S(6512),tt=S(2855),st=S(5537),lt=S(1361);let ft=(0,Y.op)({rfft_:function(gt,xt){(0,B.vA)(gt.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${gt.dtype}`);let wt=gt.shape[gt.shape.length-1],_t=gt.size/wt,bt;if(xt!=null&&xt<wt){let ee=gt.shape.map(Bt=>0),Ee=gt.shape.map(Bt=>Bt);Ee[gt.shape.length-1]=xt,bt=(0,q.d)(gt,ee,Ee),wt=xt}else if(xt!=null&&xt>wt){let ee=gt.shape.map(Ee=>Ee);ee[gt.shape.length-1]=xt-wt,bt=(0,K.x)([gt,(0,tt.U)(ee)],gt.shape.length-1),wt=xt}else bt=gt;let Tt=(0,st.P)(bt),qt=(0,J.t)((0,j.f)(bt,Tt),[_t,wt]),It=(0,lt.h)(qt),St=Math.floor(wt/2)+1,vt=(0,X.x)(It),Ft=(0,Z.n)(It),Qt=(0,H.l)(vt,[St,wt-St],vt.shape.length-1),Gt=(0,H.l)(Ft,[St,wt-St],Ft.shape.length-1),ge=bt.shape.slice();return ge[bt.shape.length-1]=St,(0,J.t)((0,j.f)(Qt[0],Gt[0]),ge)}})},6512:(L,O,S)=>{S.d(O,{l:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({split_:function(Y,X,J=0){let q={x:(0,K.YT)(Y,"x","split")},H={numOrSizeSplits:X,axis:J};return B.T2.runKernel(j.Blb,q,H)}})},9348:(L,O,S)=>{S.d(O,{R:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({sqrt_:function(Y){let X={x:(0,K.YT)(Y,"x","sqrt","float32")};return B.T2.runKernel(j.dFH,X)}})},5793:(L,O,S)=>{S.d(O,{E:()=>K});var B=S(1585),j=S(8189);let K=(0,S(929).op)({square_:function(Z){let Y=(0,j.YT)(Z,"x","square");return B.T2.runKernel("Square",{x:Y},{})}})},3427:(L,O,S)=>{S.d(O,{P:()=>X});var B=S(1585),j=S(5441),K=S(565),Z=S(8189),Y=S(2198);let X=(0,S(929).op)({squaredDifference_:function(J,q){let H=(0,Z.YT)(J,"a","squaredDifference"),tt=(0,Z.YT)(q,"b","squaredDifference");[H,tt]=(0,K.makeTypesMatch)(H,tt),(0,Y.assertAndGetBroadcastShape)(H.shape,tt.shape);let st={a:H,b:tt};return B.T2.runKernel(j.Ddj,st,{})}})},5932:(L,O,S)=>{S.d(O,{r:()=>Y});var B=S(8189),j=S(5119),K=S(929),Z=S(2302);let Y=(0,K.op)({squeeze_:function(X,J){let q=(0,B.YT)(X,"x","squeeze","string_or_numeric");return(0,Z.t)(q,(0,j.gx)(q.shape,J).newShape)}})},4268:(L,O,S)=>{S.d(O,{t:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119);let Y=(0,S(929).op)({stack_:function(X,J=0){let q=(0,K.j1)(X,"tensors","stack","string_or_numeric");Z.vA(q.length>=1,()=>"Pass at least one tensor to tf.stack"),q.length>0&&Z.vA(J<=q[0].rank,()=>"Axis must be <= rank of the tensor");let H=q,tt={axis:J};return B.T2.runKernel(j.mM$,H,tt)}})},700:(L,O,S)=>{S.d(O,{P:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({step_:function(Y,X=0){let J={x:(0,K.YT)(Y,"x","step")},q={alpha:X};return B.T2.runKernel(j.pnw,J,q)}})},5894:(L,O,S)=>{S.d(O,{Y:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({stridedSlice_:function(Y,X,J,q,H=0,tt=0,st=0,lt=0,ft=0){let gt={x:(0,K.YT)(Y,"x","stridedSlice","string_or_numeric")},xt={begin:X,end:J,strides:q,beginMask:H,endMask:tt,ellipsisMask:st,newAxisMask:lt,shrinkAxisMask:ft};return B.T2.runKernel(j.UcO,gt,xt)}})},7126:(L,O,S)=>{S.d(O,{j:()=>Y});var B=S(1585),j=S(5441),K=S(565),Z=S(8189);let Y=(0,S(929).op)({sub_:function(X,J){let q=(0,Z.YT)(X,"a","sub"),H=(0,Z.YT)(J,"b","sub");[q,H]=(0,K.makeTypesMatch)(q,H);let tt={a:q,b:H};return B.T2.runKernel(j.PbM,tt)}})},3791:(L,O,S)=>{S.d(O,{c:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(9809);let Y=(0,S(929).op)({sum_:function(X,J=null,q=!1){let H=(0,K.YT)(X,"x","sum");H.dtype==="bool"&&(H=(0,Z.w)(H,"int32"));let tt={x:H},st={axis:J,keepDims:q};return B.T2.runKernel(j.WuN,tt,st)}})},7823:(L,O,S)=>{S.d(O,{M:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({tan_:function(Y){let X={x:(0,K.YT)(Y,"x","tan","float32")};return B.T2.runKernel(j.oFs,X)}})},7311:(L,O,S)=>{S.d(O,{y:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({tanh_:function(Y){let X={x:(0,K.YT)(Y,"x","tanh","float32")};return B.T2.runKernel(j.iuW,X)}})},4027:(L,O,S)=>{S.d(O,{O:()=>K});var B=S(8189),j=S(9171);function K(Z,Y,X){let J=(0,B.MZ)(Z,X);return(0,j.Q)(Z,Y,J,X)}},2768:(L,O,S)=>{S.d(O,{$:()=>Z});var B=S(8189),j=S(5119),K=S(9171);function Z(Y,X,J){if((0,j.HO)(Y),X!=null&&X.length!==3)throw new Error("tensor3d() requires shape to have three numbers");let q=(0,B.MZ)(Y,J);if(q.length!==3&&q.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(q.length===1&&X==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return(0,K.Q)(Y,X,q,J)}},9171:(L,O,S)=>{S.d(O,{Q:()=>Y});var B=S(1585),j=S(2046),K=S(5119),Z=S(3879);function Y(X,J,q,H){if(H==null)H=(0,K.X$)(X);else if(H==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if((0,j.Nw)(X)||(0,j.Oj)(X)){if(H!=="float32"&&H!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${H}.`);return B.T2.backend.createTensorFromGPUData(X,J||q,H)}if(!(0,Z.isTypedArray)(X)&&!Array.isArray(X)&&typeof X!="number"&&typeof X!="boolean"&&typeof X!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(J!=null){(0,K.SA)(J);let tt=(0,K.Ze)(J),st=(0,K.Ze)(q);(0,K.vA)(tt===st,()=>`Based on the provided shape, [${J}], the tensor should have ${tt} values but has ${st}`);for(let lt=0;lt<q.length;++lt){let ft=q[lt],gt=lt!==q.length-1||ft!==(0,K.Ze)(J.slice(lt));(0,K.vA)(q[lt]===J[lt]||!gt,()=>`Error creating a new Tensor. Inferred shape (${q}) does not match the provided shape (${J}). `)}}return(0,Z.isTypedArray)(X)||Array.isArray(X)||(X=[X]),J=J||q,X=H!=="string"?(0,Z.toTypedArray)(X,H):(0,Z.flatten)(X,[],!0),B.T2.makeTensor(X,J,H)}},4826:(L,O,S)=>{S.d(O,{V:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119);let Y=(0,S(929).op)({tile_:function(X,J){let q=(0,K.YT)(X,"x","tile","string_or_numeric");Z.vA(q.rank===J.length,()=>`Error in transpose: rank of input ${q.rank} must match length of reps ${J}.`);let H={x:q},tt={reps:J};return B.T2.runKernel(j.FAs,H,tt)}})},1190:(L,O,S)=>{S.d(O,{r:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({topk_:function(Y,X=1,J=!0){let q=(0,K.YT)(Y,"x","topk");if(q.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");let H=q.shape[q.shape.length-1];if(X<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${X}`);if(X>H)throw new Error(`'k' passed to topk() must be <= the last dimension (${H}) but got ${X}`);let tt={x:q},st={k:X,sorted:J},[lt,ft]=B.T2.runKernel(j.TBb,tt,st);return{values:lt,indices:ft}}})},7703:(L,O,S)=>{S.d(O,{m:()=>st});var B=S(1585),j=S(5287),K=S(5441),Z=S(8189),Y=S(5119),X=S(7148),J=S(5040),q=S(6522),H=S(929),tt=S(1902);let st=(0,H.op)({transpose_:function(lt,ft,gt){let xt=(0,Z.YT)(lt,"x","transpose");if(ft==null&&(ft=xt.shape.map((bt,Tt)=>Tt).reverse()),Y.vA(xt.rank===ft.length,()=>`Error in transpose: rank of input ${xt.rank} must match length of perm ${ft}.`),ft.forEach(bt=>{Y.vA(bt>=0&&bt<xt.rank,()=>"All entries in 'perm' must be between 0 and "+(xt.rank-1)+` but got ${ft}`)}),xt.rank<=1)return xt.clone();let wt={x:xt},_t={perm:ft};return xt.dtype==="complex64"?(0,j.DZ)(()=>{let bt=(0,tt.x)(xt),Tt=(0,J.n)(xt);return bt=B.T2.runKernel(K.wx0,{x:bt},_t),Tt=B.T2.runKernel(K.wx0,{x:Tt},_t),gt&&(Tt=(0,q.H)(Tt)),(0,X.f)(bt,Tt)}):B.T2.runKernel(K.wx0,wt,_t)}})},3937:(L,O,S)=>{S.d(O,{A:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119);let Y=(0,S(929).op)({unique_:function(X,J=0){let q=(0,K.YT)(X,"x","unique","string_or_numeric");(0,Z.vA)(q.rank>0,()=>"The input tensor must be at least 1D");let H={x:q},tt={axis:J},[st,lt]=B.T2.runKernel(j.EwU,H,tt);return{values:st,indices:lt}}})},7706:(L,O,S)=>{S.d(O,{z:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119);let Y=(0,S(929).op)({unsortedSegmentSum_:function(X,J,q){let H=(0,K.YT)(X,"x","unsortedSegmentSum"),tt=(0,K.YT)(J,"segmentIds","unsortedSegmentSum","int32");(0,Z.vA)((0,Z.E6)(q),()=>"numSegments must be of dtype int");let st={x:H,segmentIds:tt},lt={numSegments:q};return B.T2.runKernel(j.pPe,st,lt)}})},7261:(L,O,S)=>{S.d(O,{K:()=>Y});var B=S(1585),j=S(5441),K=S(8189),Z=S(5119);let Y=(0,S(929).op)({unstack_:function(X,J=0){let q=(0,K.YT)(X,"x","unstack","string_or_numeric");Z.vA(J>=-q.shape.length&&J<q.shape.length,()=>`Axis = ${J} is not in [-${q.shape.length}, ${q.shape.length})`);let H={value:q},tt={axis:J};return B.T2.runKernel(j.dXR,H,tt)}})},2151:(L,O,S)=>{S.d(O,{_:()=>X});var B=S(1585),j=S(5441),K=S(8189),Z=S(3567),Y=S(2198);let X=(0,S(929).op)({where_:function(J,q,H){let tt=(0,K.YT)(q,"a","where"),st=(0,K.YT)(H,"b","where"),lt=(0,K.YT)(J,"condition","where","bool"),ft=(0,Y.assertAndGetBroadcastShape)((0,Y.assertAndGetBroadcastShape)(lt.shape,tt.shape),st.shape),gt={condition:(0,Z.h)(lt,ft),t:(0,Z.h)(tt,ft),e:(0,Z.h)(st,ft)};return B.T2.runKernel(j.l6P,gt)}})},2855:(L,O,S)=>{S.d(O,{U:()=>Z});var B=S(1585),j=S(5119),K=S(7148);function Z(Y,X="float32"){if((0,j.SA)(Y),X==="complex64"){let q=Z(Y,"float32"),H=Z(Y,"float32");return(0,K.f)(q,H)}let J=(0,j.Ty)((0,j.Ze)(Y),X);return B.T2.makeTensor(J,Y,X)}},5537:(L,O,S)=>{S.d(O,{P:()=>Z});var B=S(1585),j=S(5441),K=S(8189);let Z=(0,S(929).op)({zerosLike_:function(Y){let X={x:(0,K.YT)(Y,"x","zerosLike")};return B.T2.runKernel(j.xJ3,X)}})},6448:(L,O,S)=>{function B(j){return j instanceof Float32Array||j instanceof Int32Array||j instanceof Uint8Array||j instanceof Uint8ClampedArray}S.d(O,{Y:()=>B})},455:(L,O,S)=>{var B=S(4888),j=S(259);(0,j.tp)().prototype.abs=function(){return this.throwIfDisposed(),(0,B.t)(this)};var K=S(2804);(0,j.tp)().prototype.acos=function(){return this.throwIfDisposed(),(0,K.H)(this)};var Z=S(7558);(0,j.tp)().prototype.acosh=function(){return this.throwIfDisposed(),(0,Z.F)(this)};var Y=S(7523);(0,j.tp)().prototype.add=function(le){return this.throwIfDisposed(),(0,Y.W)(this,le)};var X=S(2307);(0,j.tp)().prototype.all=function(le,Pe){return this.throwIfDisposed(),(0,X.Q)(this,le,Pe)};var J=S(9326);(0,j.tp)().prototype.any=function(le,Pe){return this.throwIfDisposed(),(0,J.b)(this,le,Pe)};var q=S(897);(0,j.tp)().prototype.argMax=function(le){return this.throwIfDisposed(),(0,q.F)(this,le)};var H=S(4339);(0,j.tp)().prototype.argMin=function(le){return this.throwIfDisposed(),(0,H.X)(this,le)};var tt=S(2302),st=S(5119);(0,j.tp)().prototype.asScalar=function(){return this.throwIfDisposed(),(0,st.vA)(this.size===1,()=>"The array must have only 1 element."),(0,tt.t)(this,[])};var lt=S(9809);(0,j.tp)().prototype.asType=function(le){return this.throwIfDisposed(),(0,lt.w)(this,le)},(0,j.tp)().prototype.as1D=function(){return this.throwIfDisposed(),(0,tt.t)(this,[this.size])},(0,j.tp)().prototype.as2D=function(le,Pe){return this.throwIfDisposed(),(0,tt.t)(this,[le,Pe])},(0,j.tp)().prototype.as3D=function(le,Pe,rn){return this.throwIfDisposed(),(0,tt.t)(this,[le,Pe,rn])},(0,j.tp)().prototype.as4D=function(le,Pe,rn,Cn){return this.throwIfDisposed(),(0,tt.t)(this,[le,Pe,rn,Cn])},(0,j.tp)().prototype.as5D=function(le,Pe,rn,Cn,Vn){return this.throwIfDisposed(),(0,tt.t)(this,[le,Pe,rn,Cn,Vn])};var ft=S(6841);(0,j.tp)().prototype.asin=function(){return this.throwIfDisposed(),(0,ft.q)(this)};var gt=S(269);(0,j.tp)().prototype.asinh=function(){return this.throwIfDisposed(),(0,gt.y)(this)};var xt=S(9580);(0,j.tp)().prototype.atan=function(){return this.throwIfDisposed(),(0,xt.r)(this)};var wt=S(1404);(0,j.tp)().prototype.atan2=function(le){return this.throwIfDisposed(),(0,wt.F)(this,le)};var _t=S(3774);(0,j.tp)().prototype.atanh=function(){return this.throwIfDisposed(),(0,_t.r)(this)};var bt=S(3909);(0,j.tp)().prototype.avgPool=function(le,Pe,rn,Cn){return this.throwIfDisposed(),(0,bt.$)(this,le,Pe,rn,Cn)};var Tt=S(9772);(0,j.tp)().prototype.batchToSpaceND=function(le,Pe){return this.throwIfDisposed(),(0,Tt.G)(this,le,Pe)};var qt=S(9160);(0,j.tp)().prototype.batchNorm=function(le,Pe,rn,Cn,Vn){return this.throwIfDisposed(),(0,qt.$)(this,le,Pe,rn,Cn,Vn)};var It=S(3567);(0,j.tp)().prototype.broadcastTo=function(le){return this.throwIfDisposed(),(0,It.h)(this,le)},(0,j.tp)().prototype.cast=function(le){return this.throwIfDisposed(),(0,lt.w)(this,le)};var St=S(855);(0,j.tp)().prototype.ceil=function(){return this.throwIfDisposed(),(0,St.m)(this)};var vt=S(6928);(0,j.tp)().prototype.clipByValue=function(le,Pe){return this.throwIfDisposed(),(0,vt.z)(this,le,Pe)};var Ft=S(5030);(0,j.tp)().prototype.concat=function(le,Pe){return this.throwIfDisposed(),le instanceof j.qY&&(le=[le]),(0,Ft.x)([this,...le],Pe)};var Qt=S(3701);(0,j.tp)().prototype.conv1d=function(le,Pe,rn,Cn,Vn,hr){return this.throwIfDisposed(),(0,Qt.k)(this,le,Pe,rn,Cn,Vn,hr)};var Gt=S(1106);(0,j.tp)().prototype.conv2dTranspose=function(le,Pe,rn,Cn,Vn){return this.throwIfDisposed(),(0,Gt.w)(this,le,Pe,rn,Cn,Vn)};var ge=S(8794);(0,j.tp)().prototype.conv2d=function(le,Pe,rn,Cn,Vn,hr){return this.throwIfDisposed(),(0,ge.X)(this,le,Pe,rn,Cn,Vn,hr)};var ee=S(9907);(0,j.tp)().prototype.cos=function(){return this.throwIfDisposed(),(0,ee.g)(this)};var Ee=S(7451);(0,j.tp)().prototype.cosh=function(){return this.throwIfDisposed(),(0,Ee.y)(this)};var Bt=S(302);(0,j.tp)().prototype.cumprod=function(le,Pe,rn){return this.throwIfDisposed(),(0,Bt.L)(this,le,Pe,rn)};var Xt=S(6808);(0,j.tp)().prototype.cumsum=function(le,Pe,rn){return this.throwIfDisposed(),(0,Xt.r)(this,le,Pe,rn)};var we=S(1216);(0,j.tp)().prototype.depthToSpace=function(le,Pe){return this.throwIfDisposed(),(0,we.R)(this,le,Pe)};var ie=S(676);(0,j.tp)().prototype.depthwiseConv2d=function(le,Pe,rn,Cn,Vn,hr){return this.throwIfDisposed(),(0,ie.G)(this,le,Pe,rn,Cn,Vn,hr)};var m=S(3002);(0,j.tp)().prototype.dilation2d=function(le,Pe,rn,Cn,Vn){return this.throwIfDisposed(),(0,m.X)(this,le,Pe,rn,Cn,Vn)};var ye=S(919);(0,j.tp)().prototype.divNoNan=function(le){return this.throwIfDisposed(),(0,ye.e)(this,le)};var Ge=S(9359);(0,j.tp)().prototype.div=function(le){return this.throwIfDisposed(),(0,Ge.y)(this,le)};var te=S(9759);(0,j.tp)().prototype.dot=function(le){return this.throwIfDisposed(),(0,te.O)(this,le)};var Me=S(3416);(0,j.tp)().prototype.elu=function(){return this.throwIfDisposed(),(0,Me.P)(this)};var Ye=S(3020);(0,j.tp)().prototype.equal=function(le){return this.throwIfDisposed(),(0,Ye.L)(this,le)};var Ue=S(5207);(0,j.tp)().prototype.erf=function(){return this.throwIfDisposed(),(0,Ue.Y)(this)};var kn=S(4881);(0,j.tp)().prototype.euclideanNorm=function(le,Pe){return this.throwIfDisposed(),(0,kn.p)(this,le,Pe)};var mn=S(8631);(0,j.tp)().prototype.exp=function(){return this.throwIfDisposed(),(0,mn.o)(this)};var Kn=S(8710);(0,j.tp)().prototype.expandDims=function(le){return this.throwIfDisposed(),(0,Kn.U)(this,le)};var Sn=S(517);(0,j.tp)().prototype.expm1=function(){return this.throwIfDisposed(),(0,Sn.I)(this)};var Wn=S(1361);(0,j.tp)().prototype.fft=function(){return this.throwIfDisposed(),(0,Wn.h)(this)},(0,j.tp)().prototype.flatten=function(){return this.throwIfDisposed(),(0,tt.t)(this,[this.size])};var Ze=S(5606);(0,j.tp)().prototype.floor=function(){return this.throwIfDisposed(),(0,Ze.R)(this)};var de=S(8991);(0,j.tp)().prototype.floorDiv=function(le){return this.throwIfDisposed(),(0,de.w)(this,le)};var Re=S(8229);(0,j.tp)().prototype.gather=function(le,Pe,rn){return this.throwIfDisposed(),(0,Re.k)(this,le,Pe,rn)};var Kt=S(3337);(0,j.tp)().prototype.greaterEqual=function(le){return this.throwIfDisposed(),(0,Kt.D)(this,le)};var Jt=S(2058);(0,j.tp)().prototype.greater=function(le){return this.throwIfDisposed(),(0,Jt.r)(this,le)};var Ae=S(3108);(0,j.tp)().prototype.ifft=function(){return this.throwIfDisposed(),(0,Ae.K)(this)};var $e=S(2292);(0,j.tp)().prototype.irfft=function(){return this.throwIfDisposed(),(0,$e.g)(this)};var tn=S(8318);(0,j.tp)().prototype.isFinite=function(){return this.throwIfDisposed(),(0,tn.M)(this)};var wn=S(3454);(0,j.tp)().prototype.isInf=function(){return this.throwIfDisposed(),(0,wn.E)(this)};var Mn=S(6300);(0,j.tp)().prototype.isNaN=function(){return this.throwIfDisposed(),(0,Mn.y)(this)};var Hn=S(6919);(0,j.tp)().prototype.leakyRelu=function(le){return this.throwIfDisposed(),(0,Hn.H)(this,le)};var Zn=S(6508);(0,j.tp)().prototype.lessEqual=function(le){return this.throwIfDisposed(),(0,Zn.I)(this,le)};var _r=S(1303);(0,j.tp)().prototype.less=function(le){return this.throwIfDisposed(),(0,_r.M)(this,le)};var Sr=S(3531);(0,j.tp)().prototype.localResponseNormalization=function(le,Pe,rn,Cn){return this.throwIfDisposed(),(0,Sr.K)(this,le,Pe,rn,Cn)};var Mr=S(5645);(0,j.tp)().prototype.logSigmoid=function(){return this.throwIfDisposed(),(0,Mr.n)(this)};var ai=S(7991);(0,j.tp)().prototype.logSoftmax=function(le){return this.throwIfDisposed(),(0,ai.H)(this,le)};var ea=S(3330);(0,j.tp)().prototype.logSumExp=function(le,Pe){return this.throwIfDisposed(),(0,ea.V)(this,le,Pe)};var Pi=S(4010);(0,j.tp)().prototype.log=function(){return this.throwIfDisposed(),(0,Pi.R)(this)};var Cr=S(2015);(0,j.tp)().prototype.log1p=function(){return this.throwIfDisposed(),(0,Cr.K)(this)};var Ti=S(3789);(0,j.tp)().prototype.logicalAnd=function(le){return this.throwIfDisposed(),(0,Ti.n)(this,le)};var Be=S(9881);(0,j.tp)().prototype.logicalNot=function(){return this.throwIfDisposed(),(0,Be.N)(this)};var En=S(9879);(0,j.tp)().prototype.logicalOr=function(le){return this.throwIfDisposed(),(0,En.z)(this,le)};var lr=S(9925);(0,j.tp)().prototype.logicalXor=function(le){return this.throwIfDisposed(),(0,lr.r)(this,le)};var qn=S(5703);(0,j.tp)().prototype.matMul=function(le,Pe,rn){return this.throwIfDisposed(),(0,qn.N)(this,le,Pe,rn)};var fr=S(6999);(0,j.tp)().prototype.maxPool=function(le,Pe,rn,Cn){return this.throwIfDisposed(),(0,fr.j)(this,le,Pe,rn,Cn)};var Er=S(1938);(0,j.tp)().prototype.max=function(le,Pe){return this.throwIfDisposed(),(0,Er.T)(this,le,Pe)};var Qr=S(178);(0,j.tp)().prototype.maximum=function(le){return this.throwIfDisposed(),(0,Qr.P)(this,le)};var vi=S(2611);(0,j.tp)().prototype.mean=function(le,Pe){return this.throwIfDisposed(),(0,vi.i)(this,le,Pe)};var ua=S(7436);(0,j.tp)().prototype.min=function(le,Pe){return this.throwIfDisposed(),(0,ua.j)(this,le,Pe)};var br=S(2644);(0,j.tp)().prototype.minimum=function(le){return this.throwIfDisposed(),(0,br.B)(this,le)};var eo=S(6567);(0,j.tp)().prototype.mirrorPad=function(le,Pe){return this.throwIfDisposed(),(0,eo.F)(this,le,Pe)};var Fo=S(152);(0,j.tp)().prototype.mod=function(le){return this.throwIfDisposed(),(0,Fo.z)(this,le)};var Wa=S(9258);(0,j.tp)().prototype.mul=function(le){return this.throwIfDisposed(),(0,Wa.l)(this,le)};var Le=S(6522);(0,j.tp)().prototype.neg=function(){return this.throwIfDisposed(),(0,Le.H)(this)};var bn=S(2596);(0,j.tp)().prototype.norm=function(le,Pe,rn){return this.throwIfDisposed(),(0,bn.x)(this,le,Pe,rn)};var jn=S(2118);(0,j.tp)().prototype.notEqual=function(le){return this.throwIfDisposed(),(0,jn.E)(this,le)};var Jn=S(1760);(0,j.tp)().prototype.oneHot=function(le,Pe=1,rn=0){return this.throwIfDisposed(),(0,Jn.M)(this,le,Pe,rn)};var dr=S(9885);(0,j.tp)().prototype.onesLike=function(){return this.throwIfDisposed(),(0,dr.P)(this)};var Ur=S(5661);(0,j.tp)().prototype.pad=function(le,Pe){return this.throwIfDisposed(),(0,Ur.e)(this,le,Pe)};var or=S(7872);(0,j.tp)().prototype.pool=function(le,Pe,rn,Cn,Vn,hr){return this.throwIfDisposed(),(0,or.d)(this,le,Pe,rn,Cn,Vn,hr)};var Yn=S(8990);(0,j.tp)().prototype.pow=function(le){return this.throwIfDisposed(),(0,Yn.n)(this,le)};var li=S(4394);(0,j.tp)().prototype.prelu=function(le){return this.throwIfDisposed(),(0,li.N)(this,le)};var Ki=S(7771);(0,j.tp)().prototype.prod=function(le,Pe){return this.throwIfDisposed(),(0,Ki._)(this,le,Pe)};var Si=S(9870);(0,j.tp)().prototype.reciprocal=function(){return this.throwIfDisposed(),(0,Si.V)(this)};var Da=S(112);(0,j.tp)().prototype.relu=function(){return this.throwIfDisposed(),(0,Da.V)(this)};var _i=S(3732);(0,j.tp)().prototype.relu6=function(){return this.throwIfDisposed(),(0,_i.j)(this)},(0,j.tp)().prototype.reshapeAs=function(le){return this.throwIfDisposed(),(0,tt.t)(this,le.shape)},(0,j.tp)().prototype.reshape=function(le){return this.throwIfDisposed(),(0,tt.t)(this,le)};var la=S(4711);(0,j.tp)().prototype.resizeBilinear=function(le,Pe,rn){return this.throwIfDisposed(),(0,la.v)(this,le,Pe,rn)};var so=S(2954);(0,j.tp)().prototype.resizeNearestNeighbor=function(le,Pe,rn){return this.throwIfDisposed(),(0,so.b)(this,le,Pe,rn)};var ys=S(3262);(0,j.tp)().prototype.reverse=function(le){return this.throwIfDisposed(),(0,ys.B)(this,le)};var vs=S(8775);(0,j.tp)().prototype.rfft=function(){return this.throwIfDisposed(),(0,vs.z)(this)};var qo=S(5912);(0,j.tp)().prototype.round=function(){return this.throwIfDisposed(),(0,qo.L)(this)};var bs=S(7820);(0,j.tp)().prototype.rsqrt=function(){return this.throwIfDisposed(),(0,bs.Z)(this)};var na=S(6325);(0,j.tp)().prototype.selu=function(){return this.throwIfDisposed(),(0,na.W)(this)};var va=S(9986);(0,j.tp)().prototype.separableConv2d=function(le,Pe,rn,Cn,Vn,hr){return this.throwIfDisposed(),(0,va.w)(this,le,Pe,rn,Cn,Vn,hr)};var Ya=S(8968);(0,j.tp)().prototype.sigmoid=function(){return this.throwIfDisposed(),(0,Ya.r)(this)};var Xo=S(1115);(0,j.tp)().prototype.sign=function(){return this.throwIfDisposed(),(0,Xo._)(this)};var Du=S(3726);(0,j.tp)().prototype.sin=function(){return this.throwIfDisposed(),(0,Du.F)(this)};var uu=S(8276);(0,j.tp)().prototype.sinh=function(){return this.throwIfDisposed(),(0,uu.L)(this)};var ws=S(7986);(0,j.tp)().prototype.slice=function(le,Pe){return this.throwIfDisposed(),(0,ws.d)(this,le,Pe)};var Ra=S(6346);(0,j.tp)().prototype.softmax=function(le){return this.throwIfDisposed(),(0,Ra.V)(this,le)};var Ru=S(6030);(0,j.tp)().prototype.softplus=function(){return this.throwIfDisposed(),(0,Ru.l)(this)};var Ko=S(776);(0,j.tp)().prototype.spaceToBatchND=function(le,Pe){return this.throwIfDisposed(),(0,Ko.e)(this,le,Pe)};var Ga=S(6512);(0,j.tp)().prototype.split=function(le,Pe){return this.throwIfDisposed(),(0,Ga.l)(this,le,Pe)};var Fu=S(9348);(0,j.tp)().prototype.sqrt=function(){return this.throwIfDisposed(),(0,Fu.R)(this)};var Zs=S(5793);(0,j.tp)().prototype.square=function(){return this.throwIfDisposed(),(0,Zs.E)(this)};var Rc=S(3427);(0,j.tp)().prototype.squaredDifference=function(le){return this.throwIfDisposed(),(0,Rc.P)(this,le)};var bu=S(5932);(0,j.tp)().prototype.squeeze=function(le){return this.throwIfDisposed(),(0,bu.r)(this,le)};var Qs=S(4268);(0,j.tp)().prototype.stack=function(le,Pe){this.throwIfDisposed();let rn=le instanceof j.qY?[this,le]:[this,...le];return(0,Qs.t)(rn,Pe)};var wu=S(700);(0,j.tp)().prototype.step=function(le){return this.throwIfDisposed(),(0,wu.P)(this,le)};var Tl=S(5894);(0,j.tp)().prototype.stridedSlice=function(le,Pe,rn,Cn,Vn,hr,Kr,$i){return this.throwIfDisposed(),(0,Tl.Y)(this,le,Pe,rn,Cn,Vn,hr,Kr,$i)};var Zo=S(7126);(0,j.tp)().prototype.sub=function(le){return this.throwIfDisposed(),(0,Zo.j)(this,le)};var ji=S(3791);(0,j.tp)().prototype.sum=function(le,Pe){return this.throwIfDisposed(),(0,ji.c)(this,le,Pe)};var Ku=S(7823);(0,j.tp)().prototype.tan=function(){return this.throwIfDisposed(),(0,Ku.M)(this)};var Zu=S(7311);(0,j.tp)().prototype.tanh=function(){return this.throwIfDisposed(),(0,Zu.y)(this)};var xs=S(4826);(0,j.tp)().prototype.tile=function(le){return this.throwIfDisposed(),(0,xs.V)(this,le)},(0,j.tp)().prototype.toBool=function(){return this.throwIfDisposed(),(0,lt.w)(this,"bool")},(0,j.tp)().prototype.toFloat=function(){return this.throwIfDisposed(),(0,lt.w)(this,"float32")},(0,j.tp)().prototype.toInt=function(){return this.throwIfDisposed(),(0,lt.w)(this,"int32")};var xu=S(1190);(0,j.tp)().prototype.topk=function(le,Pe){return this.throwIfDisposed(),(0,xu.r)(this,le,Pe)};var pa=S(7703);(0,j.tp)().prototype.transpose=function(le){return this.throwIfDisposed(),(0,pa.m)(this,le)};var _n=S(3937);(0,j.tp)().prototype.unique=function(le){return this.throwIfDisposed(),(0,_n.A)(this,le)};var ls=S(7706);(0,j.tp)().prototype.unsortedSegmentSum=function(le,Pe){return this.throwIfDisposed(),(0,ls.z)(this,le,Pe)};var Dt=S(7261);(0,j.tp)().prototype.unstack=function(le){return this.throwIfDisposed(),(0,Dt.K)(this,le)};var Zt=S(2151);(0,j.tp)().prototype.where=function(le,Pe){return this.throwIfDisposed(),(0,Zt._)(le,this,Pe)};var Ce=S(5537);(0,j.tp)().prototype.zerosLike=function(){return this.throwIfDisposed(),(0,Ce.P)(this)}},259:(L,O,S)=>{S.d(O,{qY:()=>xt,yl:()=>H,rT:()=>_t,tp:()=>wt,B4:()=>gt,Q5:()=>ft,qP:()=>lt});var B=S(1743),j=S(5119);function K(bt,Tt,qt,It){let St=(0,j.Ur)(Tt),vt=function(ge,ee,Ee,Bt){let Xt=(0,j.Ze)(ee),we=Bt[Bt.length-1],ie=new Array(we).fill(0),m=ee.length,ye=Ee==="complex64"?J(ge):ge;if(m>1)for(let Ge=0;Ge<Xt/we;Ge++){let te=Ge*we;for(let Me=0;Me<we;Me++)ie[Me]=Math.max(ie[Me],Z(ye[te+Me],0,Ee).length)}return ie}(bt,Tt,qt,St),Ft=Tt.length,Qt=X(bt,Tt,qt,St,vt),Gt=["Tensor"];return It&&(Gt.push(`  dtype: ${qt}`),Gt.push(`  rank: ${Ft}`),Gt.push(`  shape: [${Tt}]`),Gt.push("  values:")),Gt.push(Qt.map(ge=>"    "+ge).join(`
`)),Gt.join(`
`)}function Z(bt,Tt,qt){let It;return It=Array.isArray(bt)?`${parseFloat(bt[0].toFixed(7))} + ${parseFloat(bt[1].toFixed(7))}j`:(0,j.Kg)(bt)?`'${bt}'`:qt==="bool"?Y(bt):parseFloat(bt.toFixed(7)).toString(),(0,j.av)(It,Tt)}function Y(bt){return bt===0?"false":"true"}function X(bt,Tt,qt,It,St,vt=!0){let Ft=qt==="complex64"?2:1,Qt=Tt[0],Gt=Tt.length;if(Gt===0)return qt==="complex64"?[Z(J(bt)[0],0,qt)]:qt==="bool"?[Y(bt[0])]:[bt[0].toString()];if(Gt===1){if(Qt>20){let ie=3*Ft,m=Array.from(bt.slice(0,ie)),ye=Array.from(bt.slice((Qt-3)*Ft,Qt*Ft));return qt==="complex64"&&(m=J(m),ye=J(ye)),["["+m.map((Ge,te)=>Z(Ge,St[te],qt)).join(", ")+", ..., "+ye.map((Ge,te)=>Z(Ge,St[Qt-3+te],qt)).join(", ")+"]"]}return["["+(qt==="complex64"?J(bt):Array.from(bt)).map((ie,m)=>Z(ie,St[m],qt)).join(", ")+"]"]}let ge=Tt.slice(1),ee=It.slice(1),Ee=It[0]*Ft,Bt=[];if(Qt>20){for(let ie=0;ie<3;ie++){let m=ie*Ee,ye=m+Ee;Bt.push(...X(bt.slice(m,ye),ge,qt,ee,St,!1))}Bt.push("...");for(let ie=Qt-3;ie<Qt;ie++){let m=ie*Ee,ye=m+Ee;Bt.push(...X(bt.slice(m,ye),ge,qt,ee,St,ie===Qt-1))}}else for(let ie=0;ie<Qt;ie++){let m=ie*Ee,ye=m+Ee;Bt.push(...X(bt.slice(m,ye),ge,qt,ee,St,ie===Qt-1))}let Xt=Gt===2?",":"";Bt[0]="["+(Qt>0?Bt[0]+Xt:"");for(let ie=1;ie<Bt.length-1;ie++)Bt[ie]=" "+Bt[ie]+Xt;let we=`,
`;for(let ie=2;ie<Gt;ie++)we+=`
`;return Bt[Bt.length-1]=" "+Bt[Bt.length-1]+"]"+(vt?"":we),Bt}function J(bt){let Tt=[];for(let qt=0;qt<bt.length;qt+=2)Tt.push([bt[qt],bt[qt+1]]);return Tt}var q=S(3879);class H{constructor(Tt,qt,It){if(this.dtype=qt,this.shape=Tt.slice(),this.size=j.Ze(Tt),It!=null){let St=It.length;j.vA(St===this.size,()=>`Length of values '${St}' does not match the size inferred by the shape '${this.size}'.`)}if(qt==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=It||j.Ab(qt,this.size),this.strides=(0,j.Ur)(Tt)}set(Tt,...qt){qt.length===0&&(qt=[0]),j.vA(qt.length===this.rank,()=>`The number of provided coordinates (${qt.length}) must match the rank (${this.rank})`);let It=this.locToIndex(qt);this.values[It]=Tt}get(...Tt){Tt.length===0&&(Tt=[0]);let qt=0;for(let St of Tt){if(St<0||St>=this.shape[qt]){let vt=`Requested out of range element at ${Tt}.   Buffer shape=${this.shape}`;throw new Error(vt)}qt++}let It=Tt[Tt.length-1];for(let St=0;St<Tt.length-1;++St)It+=this.strides[St]*Tt[St];return this.values[It]}locToIndex(Tt){if(this.rank===0)return 0;if(this.rank===1)return Tt[0];let qt=Tt[Tt.length-1];for(let It=0;It<Tt.length-1;++It)qt+=this.strides[It]*Tt[It];return qt}indexToLoc(Tt){if(this.rank===0)return[];if(this.rank===1)return[Tt];let qt=new Array(this.shape.length);for(let It=0;It<qt.length-1;++It)qt[It]=Math.floor(Tt/this.strides[It]),Tt-=qt[It]*this.strides[It];return qt[qt.length-1]=Tt,qt}get rank(){return this.shape.length}toTensor(){return tt().makeTensor(this.values,this.shape,this.dtype)}}let tt=null,st=null;function lt(bt){tt=bt}function ft(bt){st=bt}function gt(bt){}class xt{constructor(Tt,qt,It,St){this.kept=!1,this.isDisposedInternal=!1,this.shape=Tt.slice(),this.dtype=qt||"float32",this.size=j.Ze(Tt),this.strides=(0,j.Ur)(Tt),this.dataId=It,this.id=St,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}buffer(){return ce(this,null,function*(){let Tt=yield this.data();return st.buffer(this.shape,this.dtype,Tt)})}bufferSync(){return st.buffer(this.shape,this.dtype,this.dataSync())}array(){return ce(this,null,function*(){let Tt=yield this.data();return(0,j.yw)(this.shape,Tt,this.dtype==="complex64")})}arraySync(){return(0,j.yw)(this.shape,this.dataSync(),this.dtype==="complex64")}data(){return ce(this,null,function*(){this.throwIfDisposed();let Tt=tt().read(this.dataId);if(this.dtype==="string"){let qt=yield Tt;try{return qt.map(It=>q.decodeString(It))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return Tt})}dataToGPU(Tt){return this.throwIfDisposed(),tt().readToGPU(this.dataId,Tt)}dataSync(){this.throwIfDisposed();let Tt=tt().readSync(this.dataId);if(this.dtype==="string")try{return Tt.map(qt=>q.decodeString(qt))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return Tt}bytes(){return ce(this,null,function*(){this.throwIfDisposed();let Tt=yield tt().read(this.dataId);return this.dtype==="string"?Tt:new Uint8Array(Tt.buffer)})}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),tt().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(Tt=!1){return st.print(this,Tt)}clone(){return this.throwIfDisposed(),st.clone(this)}toString(Tt=!1){return K(this.dataSync(),this.shape,this.dtype,Tt)}cast(Tt){return this.throwIfDisposed(),st.cast(this,Tt)}variable(Tt=!0,qt,It){return this.throwIfDisposed(),tt().makeVariable(this,Tt,qt,It)}}function wt(){return(0,B.m)("Tensor",()=>xt)}Object.defineProperty(xt,Symbol.hasInstance,{value:bt=>!!bt&&bt.data!=null&&bt.dataSync!=null&&bt.throwIfDisposed!=null}),wt();class _t extends xt{constructor(Tt,qt,It,St){super(Tt.shape,Tt.dtype,Tt.dataId,St),this.trainable=qt,this.name=It}assign(Tt){if(Tt.dtype!==this.dtype)throw new Error(`dtype of the new value (${Tt.dtype}) and previous value (${this.dtype}) must match`);if(!j.r1(Tt.shape,this.shape))throw new Error(`shape of the new value (${Tt.shape}) and previous value (${this.shape}) must match`);tt().disposeTensor(this),this.dataId=Tt.dataId,tt().incRef(this,null)}dispose(){tt().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(_t,Symbol.hasInstance,{value:bt=>bt instanceof xt&&bt.assign!=null&&bt.assign instanceof Function})},565:(L,O,S)=>{S.r(O),S.d(O,{assertTypesMatch:()=>Y,getTensorsInContainer:()=>J,isTensorInList:()=>X,makeTypesMatch:()=>Z});var B=S(259),j=S(2046),K=S(5119);function Z(H,tt){if(H.dtype===tt.dtype)return[H,tt];let st=(0,j.Tu)(H.dtype,tt.dtype);return[H.cast(st),tt.cast(st)]}function Y(H,tt){(0,K.vA)(H.dtype===tt.dtype,()=>`The dtypes of the first(${H.dtype}) and second(${tt.dtype}) input must match`)}function X(H,tt){return tt.some(st=>st.id===H.id)}function J(H){let tt=[];return q(H,tt,new Set),tt}function q(H,tt,st){if(H==null)return;if(H instanceof B.qY)return void tt.push(H);if(lt=H,!Array.isArray(lt)&&typeof lt!="object")return;var lt;let ft=H;for(let gt in ft){let xt=ft[gt];st.has(xt)||(st.add(xt),q(xt,tt,st))}}},8189:(L,O,S)=>{S.d(O,{MZ:()=>J,YT:()=>tt,j1:()=>st});var B=S(1585),j=S(6574),K=S(259),Z=S(2046),Y=S(3879),X=S(5119);function J(lt,ft){let gt=lt;if((0,Y.isTypedArray)(lt))return ft==="string"?[]:[lt.length];if((0,Z.Oj)(lt)){let wt=lt.channels||"RGBA";return[lt.height,lt.width*wt.length]}if((0,Z.Nw)(lt))return[lt.buffer.size/(ft==null?4:(0,X.jv)(ft))];if(!Array.isArray(lt))return[];let xt=[];for(;Array.isArray(gt)||(0,Y.isTypedArray)(gt)&&ft!=="string";)xt.push(gt.length),gt=gt[0];return Array.isArray(lt)&&(0,j._K)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&q(lt,xt,[]),xt}function q(lt,ft,gt){if(gt=gt||[],!Array.isArray(lt)&&!(0,Y.isTypedArray)(lt))return void(0,X.vA)(ft.length===0,()=>`Element arr[${gt.join("][")}] is a primitive, but should be an array/TypedArray of ${ft[0]} elements`);(0,X.vA)(ft.length>0,()=>`Element arr[${gt.join("][")}] should be a primitive, but is an array of ${lt.length} elements`),(0,X.vA)(lt.length===ft[0],()=>`Element arr[${gt.join("][")}] should have ${ft[0]} elements, but has ${lt.length} elements`);let xt=ft.slice(1);for(let wt=0;wt<lt.length;++wt)q(lt[wt],xt,gt.concat(wt))}function H(lt,ft,gt,xt){if(lt!=="string_or_numeric"){if(lt==null)throw new Error("Expected dtype cannot be null.");if(lt!=="numeric"&&lt!==ft||lt==="numeric"&&ft==="string")throw new Error(`Argument '${gt}' passed to '${xt}' must be ${lt} tensor, but got ${ft} tensor`)}}function tt(lt,ft,gt,xt="numeric"){if(lt instanceof(0,K.tp)())return H(xt,lt.dtype,ft,gt),lt;let wt=(0,X.X$)(lt);if(wt!=="string"&&["bool","int32","float32"].indexOf(xt)>=0&&(wt=xt),H(xt,wt,ft,gt),lt==null||!(0,Y.isTypedArray)(lt)&&!Array.isArray(lt)&&typeof lt!="number"&&typeof lt!="boolean"&&typeof lt!="string"){let Tt=lt==null?"null":lt.constructor.name;throw new Error(`Argument '${ft}' passed to '${gt}' must be a Tensor or TensorLike, but got '${Tt}'`)}let _t=J(lt,wt);(0,Y.isTypedArray)(lt)||Array.isArray(lt)||(lt=[lt]);let bt=wt!=="string"?(0,Y.toTypedArray)(lt,wt):(0,Y.flatten)(lt,[],!0);return B.T2.makeTensor(bt,_t,wt)}function st(lt,ft,gt,xt="numeric"){if(!Array.isArray(lt))throw new Error(`Argument ${ft} passed to ${gt} must be a \`Tensor[]\` or \`TensorLike[]\``);return lt.map((wt,_t)=>tt(wt,`${ft}[${_t}]`,gt,xt))}},2046:(L,O,S)=>{var B,j,K,Z,Y;S.d(O,{Nw:()=>tt,Oj:()=>H,Tu:()=>J,ch:()=>q,rg:()=>B}),function(st){st.R0="R0",st.R1="R1",st.R2="R2",st.R3="R3",st.R4="R4",st.R5="R5",st.R6="R6"}(B||(B={})),function(st){st.float32="float32",st.int32="int32",st.bool="int32",st.complex64="complex64"}(j||(j={})),function(st){st.float32="float32",st.int32="int32",st.bool="bool",st.complex64="complex64"}(K||(K={})),function(st){st.float32="float32",st.int32="float32",st.bool="float32",st.complex64="complex64"}(Z||(Z={})),function(st){st.float32="complex64",st.int32="complex64",st.bool="complex64",st.complex64="complex64"}(Y||(Y={}));let X={float32:Z,int32:j,bool:K,complex64:Y};function J(st,lt){if(st==="string"||lt==="string"){if(st==="string"&&lt==="string")return"string";throw new Error(`Can not upcast ${st} with ${lt}`)}return X[st][lt]}function q(st){return J(st,"int32")}function H(st){return st!=null&&typeof st=="object"&&"texture"in st&&st.texture instanceof WebGLTexture}function tt(st){return typeof GPUBuffer<"u"&&st!=null&&typeof st=="object"&&"buffer"in st&&st.buffer instanceof GPUBuffer}},3879:(L,O,S)=>{S.r(O),S.d(O,{arraysEqual:()=>K.r1,arraysEqualWithNull:()=>K.e_,assert:()=>K.vA,assertNonNegativeIntegerDimensions:()=>K.SA,assertNonNull:()=>K.HO,assertShapesMatch:()=>K.O3,bytesFromStringArray:()=>K.SL,bytesPerElement:()=>K.jv,checkConversionForErrors:()=>K.nd,clamp:()=>K.qE,computeStrides:()=>K.Ur,convertBackendValuesAndArrayBuffer:()=>K.o2,createScalarValue:()=>bt,createShuffledIndices:()=>K.P8,decodeString:()=>vt,distSquared:()=>K.oO,encodeString:()=>St,fetch:()=>It,fingerPrint64:()=>_t,flatten:()=>Qt,getArrayFromDType:()=>K.Ab,getTypedArrayFromDType:()=>K.ce,hasEncodingLoss:()=>K.BE,hexToLong:()=>X,indexToLoc:()=>K._k,inferDtype:()=>K.X$,inferFromImplicitShape:()=>K.XT,isBoolean:()=>K.Lm,isFunction:()=>K.Tn,isInt:()=>K.E6,isNumber:()=>K.Et,isPromise:()=>K.yL,isScalarShape:()=>K.Sf,isString:()=>K.Kg,isTypedArray:()=>Ft,isValidDtype:()=>K.xn,locToIndex:()=>K.sX,makeOnesTypedArray:()=>K.FZ,makeZerosNestedTypedArray:()=>K.c7,makeZerosTypedArray:()=>K.Ty,nearestDivisor:()=>K.lK,nearestLargerEven:()=>K.eV,now:()=>qt,parseAxisParam:()=>K.Y6,randUniform:()=>K.so,repeatedTry:()=>K._q,rightPad:()=>K.av,shuffle:()=>K.k4,shuffleCombo:()=>K.a0,sizeFromShape:()=>K.Ze,sizeToSquarishShape:()=>K.gS,squeezeShape:()=>K.gx,sum:()=>K.cz,swap:()=>K.wg,tanh:()=>K.ym,toNestedArray:()=>K.yw,toTypedArray:()=>Tt});var B=S(6574),j=S(6448),K=S(5119),Z=S(8570);let Y=S.n(Z)()||Z;function X(Gt){return Y.fromString(Gt,!0,16)}let J=X("c3a5c85c97cb3127"),q=X("b492b66fbe98f273"),H=X("9ae16a3b2f90404f");function tt(Gt){return Gt.xor(Gt.shru(47))}function st(Gt,ge,ee){let Ee=Gt.slice(ge,ge+ee);return Y.fromBytes(Array.from(Ee),!0,!0)}function lt(Gt,ge){return st(Gt,ge,8)}function ft(Gt,ge){return st(Gt,ge,4)}function gt(Gt,ge){return ge===0?Gt:Gt.shru(ge).or(Gt.shl(64-ge))}function xt(Gt,ge,ee=X("9ddfea08eb382d69")){let Ee=Gt.xor(ge).mul(ee);Ee=Ee.xor(Ee.shru(47));let Bt=ge.xor(Ee).mul(ee);return Bt=Bt.xor(Bt.shru(47)),Bt=Bt.mul(ee),Bt}function wt(Gt,ge,ee,Ee){return function(Bt,Xt,we,ie,m,ye){m=m.add(Bt),ye=gt(ye.add(m).add(ie),21);let Ge=m;return m=(m=m.add(Xt)).add(we),ye=ye.add(gt(m,44)),[m.add(ie),ye.add(Ge)]}(lt(Gt,ge),lt(Gt,ge+8),lt(Gt,ge+16),lt(Gt,ge+24),ee,Ee)}function _t(Gt,ge=Gt.length){let ee=Y.fromNumber(81,!0);if(ge<=32)return ge<=16?function(Me,Ye=Me.length){if(Ye>=8){let Ue=H.add(2*Ye),kn=lt(Me,0).add(H),mn=lt(Me,Ye-8);return xt(gt(mn,37).mul(Ue).add(kn),gt(kn,25).add(mn).mul(Ue),Ue)}if(Ye>=4){let Ue=H.add(2*Ye);return xt(ft(Me,0).shl(3).add(Ye),ft(Me,Ye-4),Ue)}if(Ye>0){let Ue=Me[0]+(Me[Ye>>1]<<8),kn=Ye+(Me[Ye-1]<<2);return tt(H.mul(Ue).xor(J.mul(kn))).mul(H)}return H}(Gt,ge):function(Me,Ye=Me.length){let Ue=H.add(2*Ye),kn=lt(Me,0).mul(q),mn=lt(Me,8),Kn=lt(Me,Ye-8).mul(Ue),Sn=lt(Me,Ye-16).mul(H);return xt(gt(kn.add(mn),43).add(gt(Kn,30)).add(Sn),kn.add(gt(mn.add(H),18)).add(Kn),Ue)}(Gt,ge);if(ge<=64)return function(Me,Ye=Me.length){let Ue=H.add(2*Ye),kn=lt(Me,0).mul(H),mn=lt(Me,8),Kn=lt(Me,Ye-8).mul(Ue),Sn=lt(Me,Ye-16).mul(H),Wn=gt(kn.add(mn),43).add(gt(Kn,30)).add(Sn),Ze=xt(Wn,kn.add(gt(mn.add(H),18)).add(Kn),Ue),de=lt(Me,16).mul(Ue),Re=lt(Me,24),Kt=Wn.add(lt(Me,Ye-32)).mul(Ue),Jt=Ze.add(lt(Me,Ye-24)).mul(Ue);return xt(gt(de.add(Re),43).add(gt(Kt,30)).add(Jt),de.add(gt(Re.add(kn),18)).add(Kt),Ue)}(Gt,ge);let Ee=ee,Bt=ee.mul(q).add(113),Xt=tt(Bt.mul(H).add(113)).mul(H),we=[Y.UZERO,Y.UZERO],ie=[Y.UZERO,Y.UZERO];Ee=Ee.mul(H).add(lt(Gt,0));let m=0,ye=64*(ge-1>>6),Ge=ye+(ge-1&63)-63;do Ee=gt(Ee.add(Bt).add(we[0]).add(lt(Gt,m+8)),37).mul(q),Bt=gt(Bt.add(we[1]).add(lt(Gt,m+48)),42).mul(q),Ee=Ee.xor(ie[1]),Bt=Bt.add(we[0]).add(lt(Gt,m+40)),Xt=gt(Xt.add(ie[0]),33).mul(q),we=wt(Gt,m,we[1].mul(q),Ee.add(ie[0])),ie=wt(Gt,m+32,Xt.add(ie[1]),Bt.add(lt(Gt,m+16))),[Xt,Ee]=[Ee,Xt],m+=64;while(m!==ye);let te=q.add(Xt.and(255).shl(1));return m=Ge,ie[0]=ie[0].add(ge-1&63),we[0]=we[0].add(ie[0]),ie[0]=ie[0].add(we[0]),Ee=gt(Ee.add(Bt).add(we[0]).add(lt(Gt,m+8)),37).mul(te),Bt=gt(Bt.add(we[1]).add(lt(Gt,m+48)),42).mul(te),Ee=Ee.xor(ie[1].mul(9)),Bt=Bt.add(we[0].mul(9).add(lt(Gt,m+40))),Xt=gt(Xt.add(ie[0]),33).mul(te),we=wt(Gt,m,we[1].mul(te),Ee.add(ie[0])),ie=wt(Gt,m+32,Xt.add(ie[1]),Bt.add(lt(Gt,m+16))),[Xt,Ee]=[Ee,Xt],xt(xt(we[0],ie[0],te).add(tt(Bt).mul(J)).add(Xt),xt(we[1],ie[1],te).add(Ee),te)}function bt(Gt,ge){return ge==="string"?St(Gt):Tt([Gt],ge)}function Tt(Gt,ge){if(ge==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(Gt)&&(Gt=Qt(Gt)),(0,B._K)().getBool("DEBUG")&&K.nd(Gt,ge),function(ee,Ee){return ee instanceof Float32Array&&Ee==="float32"||ee instanceof Int32Array&&Ee==="int32"||ee instanceof Uint8Array&&Ee==="bool"}(Gt,ge))return Gt;if(ge==null||ge==="float32"||ge==="complex64")return new Float32Array(Gt);if(ge==="int32")return new Int32Array(Gt);if(ge==="bool"){let ee=new Uint8Array(Gt.length);for(let Ee=0;Ee<ee.length;++Ee)Math.round(Gt[Ee])!==0&&(ee[Ee]=1);return ee}throw new Error(`Unknown data type ${ge}`)}function qt(){return(0,B._K)().platform.now()}function It(Gt,ge){return(0,B._K)().platform.fetch(Gt,ge)}function St(Gt,ge="utf-8"){return ge=ge||"utf-8",(0,B._K)().platform.encode(Gt,ge)}function vt(Gt,ge="utf-8"){return ge=ge||"utf-8",(0,B._K)().platform.decode(Gt,ge)}function Ft(Gt){return(0,B._K)().platform.isTypedArray!=null?(0,B._K)().platform.isTypedArray(Gt):(0,j.Y)(Gt)}function Qt(Gt,ge=[],ee=!1){if(ge==null&&(ge=[]),typeof Gt=="boolean"||typeof Gt=="number"||typeof Gt=="string"||K.yL(Gt)||Gt==null||Ft(Gt)&&ee)ge.push(Gt);else if(Array.isArray(Gt)||Ft(Gt))for(let Ee=0;Ee<Gt.length;++Ee)Qt(Gt[Ee],ge,ee);else{let Ee=-1;for(let Bt of Object.keys(Gt))/^([1-9]+[0-9]*|0)$/.test(Bt)&&(Ee=Math.max(Ee,Number(Bt)));for(let Bt=0;Bt<=Ee;Bt++)Qt(Gt[Bt],ge,ee)}return ge}},5119:(L,O,S)=>{function B(Kt){let Jt=Kt.length,Ae=0;for(;Jt>0;)Ae=Math.random()*Jt|0,Jt--,Y(Kt,Jt,Ae)}function j(Kt,Jt){if(Kt.length!==Jt.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${Kt.length}Second array length was ${Jt.length}`);let Ae=Kt.length,$e=0;for(;Ae>0;)$e=Math.random()*Ae|0,Ae--,Y(Kt,Ae,$e),Y(Jt,Ae,$e)}function K(Kt,Jt,Ae){return Math.max(Kt,Math.min(Jt,Ae))}function Z(Kt){return Kt%2==0?Kt:Kt+1}function Y(Kt,Jt,Ae){let $e=Kt[Jt];Kt[Jt]=Kt[Ae],Kt[Ae]=$e}function X(Kt){let Jt=0;for(let Ae=0;Ae<Kt.length;Ae++)Jt+=Kt[Ae];return Jt}function J(Kt,Jt){let Ae=Math.random();return Jt*Ae+(1-Ae)*Kt}function q(Kt,Jt){let Ae=0;for(let $e=0;$e<Kt.length;$e++){let tn=Number(Kt[$e])-Number(Jt[$e]);Ae+=tn*tn}return Ae}function H(Kt,Jt){if(!Kt)throw new Error(typeof Jt=="string"?Jt:Jt())}function tt(Kt,Jt,Ae=""){H(xt(Kt,Jt),()=>Ae+` Shapes ${Kt} and ${Jt} must match`)}function st(Kt){H(Kt!=null,()=>"The input to the tensor constructor must be a non-null value.")}function lt(Kt){if(Kt.length===0)return 1;let Jt=Kt[0];for(let Ae=1;Ae<Kt.length;Ae++)Jt*=Kt[Ae];return Jt}function ft(Kt){return Kt.length===0}function gt(Kt,Jt){if(Kt===Jt)return!0;if(Kt==null||Jt==null||Kt.length!==Jt.length)return!1;for(let Ae=0;Ae<Kt.length;Ae++)if(Kt[Ae]!==null&&Jt[Ae]!==null&&Kt[Ae]!==Jt[Ae])return!1;return!0}function xt(Kt,Jt){if(Kt===Jt)return!0;if(Kt==null||Jt==null||Kt.length!==Jt.length)return!1;for(let Ae=0;Ae<Kt.length;Ae++)if(Kt[Ae]!==Jt[Ae])return!1;return!0}function wt(Kt){return Kt%1==0}function _t(Kt){if(Math.tanh!=null)return Math.tanh(Kt);if(Kt===1/0)return 1;if(Kt===-1/0)return-1;{let Jt=Math.exp(2*Kt);return(Jt-1)/(Jt+1)}}function bt(Kt){let Jt=Math.ceil(Math.sqrt(Kt));return[Jt,Math.ceil(Kt/Jt)]}function Tt(Kt){let Jt=new Uint32Array(Kt);for(let Ae=0;Ae<Kt;++Ae)Jt[Ae]=Ae;return B(Jt),Jt}function qt(Kt,Jt){return Jt<=Kt.length?Kt:Kt+" ".repeat(Jt-Kt.length)}function It(Kt,Jt=tn=>0,Ae,$e){return new Promise((tn,wn)=>{let Mn=0,Hn=()=>{if(Kt())return void tn();Mn++;let Zn=Jt(Mn);Ae!=null&&Mn>=Ae?wn():$e!=null?$e(Hn,Zn):setTimeout(Hn,Zn)};Hn()})}function St(Kt,Jt){let Ae=1,$e=-1;for(let wn=0;wn<Kt.length;++wn)if(Kt[wn]>=0)Ae*=Kt[wn];else if(Kt[wn]===-1){if($e!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${$e} and dim ${wn}`);$e=wn}else if(Kt[wn]<0)throw Error(`Shapes can not be < 0. Found ${Kt[wn]} at dim ${wn}`);if($e===-1){if(Jt>0&&Jt!==Ae)throw Error(`Size(${Jt}) must match the product of shape ${Kt}`);return Kt}if(Ae===0)throw Error(`Cannot infer the missing size in [${Kt}] when there are 0 elements`);if(Jt%Ae!=0)throw Error(`The implicit shape can't be a fractional number. Got ${Jt} / ${Ae}`);let tn=Kt.slice();return tn[$e]=Jt/Ae,tn}function vt(Kt,Jt){let Ae=Jt.length;return H((Kt=Kt==null?Jt.map(($e,tn)=>tn):[].concat(Kt)).every($e=>$e>=-Ae&&$e<Ae),()=>`All values in axis param must be in range [-${Ae}, ${Ae}) but got axis ${Kt}`),H(Kt.every($e=>wt($e)),()=>`All values in axis param must be integers but got axis ${Kt}`),Kt.map($e=>$e<0?Ae+$e:$e)}function Ft(Kt,Jt){let Ae=[],$e=[],tn=Jt!=null&&Array.isArray(Jt)&&Jt.length===0,wn=Jt==null||tn?null:vt(Jt,Kt).sort(),Mn=0;for(let Hn=0;Hn<Kt.length;++Hn){if(wn!=null){if(wn[Mn]===Hn&&Kt[Hn]!==1)throw new Error(`Can't squeeze axis ${Hn} since its dim '${Kt[Hn]}' is not 1`);(wn[Mn]==null||wn[Mn]>Hn)&&Kt[Hn]===1&&(Ae.push(Kt[Hn]),$e.push(Hn)),wn[Mn]<=Hn&&Mn++}Kt[Hn]!==1&&(Ae.push(Kt[Hn]),$e.push(Hn))}return{newShape:Ae,keptDims:$e}}function Qt(Kt,Jt){return Gt(Kt,Jt)}function Gt(Kt,Jt){let Ae=null;if(Kt==null||Kt==="float32")Ae=new Float32Array(Jt);else if(Kt==="int32")Ae=new Int32Array(Jt);else if(Kt==="bool")Ae=new Uint8Array(Jt);else{if(Kt!=="string")throw new Error(`Unknown data type ${Kt}`);Ae=new Array(Jt)}return Ae}function ge(Kt,Jt){for(let Ae=0;Ae<Kt.length;Ae++){let $e=Kt[Ae];if(isNaN($e)||!isFinite($e))throw Error(`A tensor of type ${Jt} being uploaded contains ${$e}.`)}}function ee(Kt){return Kt==="bool"||Kt==="complex64"||Kt==="float32"||Kt==="int32"||Kt==="string"}function Ee(Kt,Jt){return Jt!=="complex64"&&(Jt!=="float32"||Kt==="complex64")&&(Jt!=="int32"||Kt==="float32"||Kt==="complex64")&&(Jt!=="bool"||Kt!=="bool")}function Bt(Kt){if(Kt==="float32"||Kt==="int32")return 4;if(Kt==="complex64")return 8;if(Kt==="bool")return 1;throw new Error(`Unknown dtype ${Kt}`)}function Xt(Kt){if(Kt==null)return 0;let Jt=0;return Kt.forEach(Ae=>Jt+=Ae.length),Jt}function we(Kt){return typeof Kt=="string"||Kt instanceof String}function ie(Kt){return typeof Kt=="boolean"}function m(Kt){return typeof Kt=="number"}function ye(Kt){return Array.isArray(Kt)?ye(Kt[0]):Kt instanceof Float32Array?"float32":Kt instanceof Int32Array||Kt instanceof Uint8Array||Kt instanceof Uint8ClampedArray?"int32":m(Kt)?"float32":we(Kt)?"string":ie(Kt)?"bool":"float32"}function Ge(Kt){return!!(Kt&&Kt.constructor&&Kt.call&&Kt.apply)}function te(Kt,Jt){for(let Ae=Jt;Ae<Kt;++Ae)if(Kt%Ae==0)return Ae;return Kt}function Me(Kt){let Jt=Kt.length;if(Jt<2)return[];let Ae=new Array(Jt-1);Ae[Jt-2]=Kt[Jt-1];for(let $e=Jt-3;$e>=0;--$e)Ae[$e]=Ae[$e+1]*Kt[$e+1];return Ae}function Ye(Kt,Jt,Ae,$e=!1){let tn=new Array;if(Jt.length===1){let wn=Jt[0]*($e?2:1);for(let Mn=0;Mn<wn;Mn++)tn[Mn]=Ae[Kt+Mn]}else{let wn=Jt[0],Mn=Jt.slice(1),Hn=Mn.reduce((Zn,_r)=>Zn*_r)*($e?2:1);for(let Zn=0;Zn<wn;Zn++)tn[Zn]=Ye(Kt+Zn*Hn,Mn,Ae,$e)}return tn}function Ue(Kt,Jt,Ae=!1){if(Kt.length===0)return Jt[0];let $e=Kt.reduce((tn,wn)=>tn*wn)*(Ae?2:1);if($e===0)return[];if($e!==Jt.length)throw new Error(`[${Kt}] does not match the input size ${Jt.length}${Ae?" for a complex tensor":""}.`);return Ye(0,Kt,Jt,Ae)}function kn(Kt,Jt){if(Array.isArray(Kt))return Kt;if(Jt==="float32")return Kt instanceof Float32Array?Kt:new Float32Array(Kt);if(Jt==="int32")return Kt instanceof Int32Array?Kt:new Int32Array(Kt);if(Jt==="bool"||Jt==="string")return Uint8Array.from(new Int32Array(Kt));throw new Error(`Unknown dtype ${Jt}`)}function mn(Kt,Jt){let Ae=Kn(Kt,Jt);for(let $e=0;$e<Ae.length;$e++)Ae[$e]=1;return Ae}function Kn(Kt,Jt){if(Jt==null||Jt==="float32"||Jt==="complex64")return new Float32Array(Kt);if(Jt==="int32")return new Int32Array(Kt);if(Jt==="bool")return new Uint8Array(Kt);throw new Error(`Unknown data type ${Jt}`)}function Sn(Kt,Jt){let Ae=Kt.reduce(($e,tn)=>$e*tn,1);if(Jt==null||Jt==="float32")return Ue(Kt,new Float32Array(Ae));if(Jt==="int32")return Ue(Kt,new Int32Array(Ae));if(Jt==="bool")return Ue(Kt,new Uint8Array(Ae));throw new Error(`Unknown data type ${Jt}`)}function Wn(Kt){Kt.forEach(Jt=>{H(Number.isInteger(Jt)&&Jt>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${Kt}].`)})}function Ze(Kt,Jt,Ae){if(Jt===0)return 0;if(Jt===1)return Kt[0];let $e=Kt[Kt.length-1];for(let tn=0;tn<Kt.length-1;++tn)$e+=Ae[tn]*Kt[tn];return $e}function de(Kt,Jt,Ae){if(Jt===0)return[];if(Jt===1)return[Kt];let $e=new Array(Jt);for(let tn=0;tn<$e.length-1;++tn)$e[tn]=Math.floor(Kt/Ae[tn]),Kt-=$e[tn]*Ae[tn];return $e[$e.length-1]=Kt,$e}function Re(Kt){return Kt&&Kt.then&&typeof Kt.then=="function"}S.d(O,{Ab:()=>Gt,BE:()=>Ee,E6:()=>wt,Et:()=>m,FZ:()=>mn,HO:()=>st,Kg:()=>we,Lm:()=>ie,O3:()=>tt,P8:()=>Tt,SA:()=>Wn,SL:()=>Xt,Sf:()=>ft,Tn:()=>Ge,Ty:()=>Kn,Ur:()=>Me,X$:()=>ye,XT:()=>St,Y6:()=>vt,Ze:()=>lt,_k:()=>de,_q:()=>It,a0:()=>j,av:()=>qt,c7:()=>Sn,ce:()=>Qt,cz:()=>X,eV:()=>Z,e_:()=>gt,gS:()=>bt,gx:()=>Ft,jv:()=>Bt,k4:()=>B,lK:()=>te,nd:()=>ge,o2:()=>kn,oO:()=>q,qE:()=>K,r1:()=>xt,sX:()=>Ze,so:()=>J,vA:()=>H,wg:()=>Y,xn:()=>ee,yL:()=>Re,ym:()=>_t,yw:()=>Ue})},1936:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0});let B=S(5237),j=S(8205);class K extends B.Component{componentDidMount(){let{name:Y,tab:X}=this.props;this.props.registerSurface(Y,X,this)}componentDidUpdate(){return!1}render(){let{name:Y,visible:X,styles:J}=this.props,q=Object.assign({},K.defaultStyles,J),{width:H,height:tt}=q,{maxHeight:st,maxWidth:lt}=q;st=tt===K.defaultStyles.height?st:tt,lt=H===K.defaultStyles.width?lt:H;let ft=j.css({display:X?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:tt,width:H,maxHeight:st,maxWidth:lt,overflow:"auto"}),gt=j.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),xt=j.css({boxSizing:"border-box"});return B.h("div",{className:`${ft} tf-surface`,ref:wt=>this.container=wt,"data-visible":X},B.h("div",{className:`${gt} tf-label`,ref:wt=>this.label=wt},Y),B.h("div",{className:`${xt} tf-draw-area`,ref:wt=>this.drawArea=wt}))}}K.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},O.SurfaceComponent=K},9779:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0});let B=S(5237),j=S(8205);class K extends B.Component{render(){let{tabNames:X,activeTab:J,handleClick:q}=this.props,H=X.length>0?X.map(st=>B.h(Z,{key:st,id:st,handleClick:q,isActive:st===J},st)):null,tt=j.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return B.h("div",{className:`${tt} visor-tabs`},H)}}O.Tabs=K;class Z extends B.Component{render(){let{children:X,isActive:J,handleClick:q,id:H}=this.props,tt=j.css({borderBottomColor:J?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return B.h("a",{className:`${tt} tf-tab`,"data-isactive":J,onClick:()=>q(H)},X)}}},5976:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0});let B=S(5237),j=S(8205),K=S(1936),Z=S(9779);class Y extends B.Component{static render(q,H,tt){return B.render(B.h(Y,Object.assign({},tt)),q,H)}constructor(q){super(q),this.surfaces=new Map;let H=q.startOpen==null||q.startOpen;this.state={isOpen:H,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(q,H){let tt=this.surfaceId(q,H),st;if(!this.surfaces.has(tt))throw Error(`Surface not found with id: ${tt}`);return st=this.surfaces.get(tt),{container:st.container,label:st.label,drawArea:st.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(q,H){return q+H}setTabs(q){let H=q.map(lt=>lt.tab),tt=this.state.tabs,st;for(let lt of H)tt.has(lt)||(tt.add(lt),st=lt);st!=null&&this.setState({tabs:tt,activeTab:st})}getTabs(){return this.state.tabs}registerSurface(q,H,tt){let st=this.surfaceId(q,H);this.surfaces.set(st,tt)}keyHandler(q){q.keyCode===192&&(q.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(q){this.setState({activeTab:q})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(q){this.setTabs(q.surfaceList)}render(){let{isOpen:q,isFullscreen:H,activeTab:tt}=this.state,{surfaceList:st}=this.props,lt=Array.from(this.getTabs().values()),ft=H?"90vw":"550px",gt=j.css({width:ft,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),xt=j.css({right:"0"}),wt=j.css({right:`calc(-${ft} - 10px)`}),_t=q?xt:wt,bt=j.css({});return B.h("div",{className:`${gt} ${_t} visor`,"data-isopen":q,"data-isfullscreen":H},B.h(X,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:H}),B.h(Z.Tabs,{tabNames:lt,activeTab:tt,handleClick:this.setActiveTab.bind(this)}),B.h("div",{className:`${bt} visor-surfaces`},st.map(Tt=>B.h(K.SurfaceComponent,{key:Tt.name+Tt.tab,name:Tt.name,tab:Tt.tab,styles:Tt.styles,registerSurface:this.registerSurface.bind(this),visible:tt===Tt.tab}))))}}function X(J){let{isFullScreen:q,fullScreenHandler:H,closeHandler:tt}=J,st=j.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),lt=j.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),ft=j.css({marginLeft:"auto"});return B.h("div",{className:`${st} visor-controls`},B.h("button",{className:`${lt}`,onClick:H},q?"Minimize":"Maximize"),B.h("button",{className:`${lt} ${ft}`,onClick:tt},"Hide"))}O.VisorComponent=Y},9778:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0}),S(5838),S(455);let B=S(2784),j=S(3739),K=S(7483),Z=S(5877),Y=S(4857),X=S(898),J=S(9827),q=S(62),H=S(3559),tt=S(5727),st=S(4853),lt=S(2729),ft=S(454);O.version_vis=ft.version;let gt={barchart:B.barchart,table:J.table,histogram:Z.histogram,linechart:Y.linechart,scatterplot:X.scatterplot,confusionMatrix:j.confusionMatrix,heatmap:K.heatmap};O.render=gt;let xt={accuracy:lt.accuracy,perClassAccuracy:lt.perClassAccuracy,confusionMatrix:lt.confusionMatrix};O.metrics=xt;let wt={history:q.history,fitCallbacks:q.fitCallbacks,perClassAccuracy:tt.perClassAccuracy,valuesDistribution:st.valuesDistribution,layer:H.layer,modelSummary:H.modelSummary};O.show=wt;var _t=S(4701);O.visor=_t.visor,function(bt){for(var Tt in bt)O.hasOwnProperty(Tt)||(O[Tt]=bt[Tt])}(S(5759))},2784:function(L,O,S){var B=this&&this.__awaiter||function(q,H,tt,st){return new(tt||(tt=Promise))(function(lt,ft){function gt(_t){try{wt(st.next(_t))}catch(bt){ft(bt)}}function xt(_t){try{wt(st.throw(_t))}catch(bt){ft(bt)}}function wt(_t){_t.done?lt(_t.value):new tt(function(bt){bt(_t.value)}).then(gt,xt)}wt((st=st.apply(q,H||[])).next())})},j=this&&this.__importDefault||function(q){return q&&q.__esModule?q:{default:q}};Object.defineProperty(O,"__esModule",{value:!0});let K=j(S(8731)),Z=S(8227),Y=S(6857);O.barchart=function(q,H,tt={}){return B(this,void 0,void 0,function*(){let st=Y.getDrawArea(q),lt=H,ft=Object.assign({},X,tt);if(J.has(st)){let vt=J.get(st);if(Y.shallowEquals(ft,vt.lastOptions)){yield Y.nextFrame();let Ft=vt.view,Qt=Ft.changeset().remove(()=>!0).insert(lt);return void(yield Ft.change("values",Qt).runAsync())}}let{xLabel:gt,yLabel:xt,xType:wt,yType:_t}=ft,bt=null;gt!=null&&(bt={title:gt});let Tt=null;xt!=null&&(Tt={title:xt});let qt;qt=ft.color!=null?Array.isArray(ft.color)?{field:"index",type:"nominal",scale:{range:ft.color}}:{value:ft.color}:{value:"#4C78A0"};let It={width:ft.width||Z.getDefaultWidth(st),height:ft.height||Z.getDefaultHeight(st),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:ft.fontSize,titleFontSize:ft.fontSize},text:{fontSize:ft.fontSize},legend:{labelFontSize:ft.fontSize,titleFontSize:ft.fontSize}},data:{values:lt,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:wt,axis:bt},y:{field:"value",type:_t,axis:Tt},color:qt}};yield Y.nextFrame();let St=yield K.default(st,It,{actions:!1,mode:"vega-lite",defaultStyle:!1});J.set(st,{view:St.view,lastOptions:ft})})};let X={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},J=new Map},3739:function(L,O,S){var B=this&&this.__awaiter||function(J,q,H,tt){return new(H||(H=Promise))(function(st,lt){function ft(wt){try{xt(tt.next(wt))}catch(_t){lt(_t)}}function gt(wt){try{xt(tt.throw(wt))}catch(_t){lt(_t)}}function xt(wt){wt.done?st(wt.value):new H(function(_t){_t(wt.value)}).then(ft,gt)}xt((tt=tt.apply(J,q||[])).next())})},j=this&&this.__importDefault||function(J){return J&&J.__esModule?J:{default:J}};Object.defineProperty(O,"__esModule",{value:!0});let K=j(S(8731)),Z=S(8227),Y=S(6857);O.confusionMatrix=function(J,q,H={}){return B(this,void 0,void 0,function*(){let tt=Object.assign({},X,H),st=Y.getDrawArea(J),lt=[],ft=q.values,gt=q.tickLabels||[],xt=gt.length===0,wt=!0;for(let Tt=0;Tt<ft.length;Tt++){let qt=xt?`Class ${Tt}`:gt[Tt];xt&&gt.push(qt);for(let It=0;It<ft[Tt].length;It++){let St=xt?`Class ${It}`:gt[It],vt=ft[Tt][It];Tt!==It||tt.shadeDiagonal?(lt.push({label:qt,prediction:St,count:vt,scaleCount:vt}),vt!==0&&(wt=!1)):lt.push({label:qt,prediction:St,count:vt,noFill:!0})}}if(!tt.shadeDiagonal&&wt)for(let Tt of lt)Tt.noFill===!0&&(Tt.noFill=!1,Tt.scaleCount=Tt.count);let _t={width:tt.width||Z.getDefaultWidth(st),height:tt.height||Z.getDefaultHeight(st),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:tt.fontSize,titleFontSize:tt.fontSize},text:{fontSize:tt.fontSize},legend:{labelFontSize:tt.fontSize,titleFontSize:tt.fontSize}},data:{values:lt},encoding:{x:{field:"prediction",type:"ordinal",title:tt.xLabel||"prediction",scale:{domain:gt}},y:{field:"label",type:"ordinal",title:tt.yLabel||"label",scale:{domain:gt}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:tt.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};tt.shadeDiagonal===!1&&_t.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),tt.showTextOverlay&&_t.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}});let bt=typeof tt.colorMap=="string"?{scheme:tt.colorMap}:tt.colorMap;_t.layer[0].encoding.color.scale.range=bt,yield K.default(st,_t,{actions:!1,mode:"vega-lite",defaultStyle:!1})})};let X={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]}},7483:function(L,O,S){var B=this&&this.__awaiter||function(st,lt,ft,gt){return new(ft||(ft=Promise))(function(xt,wt){function _t(qt){try{Tt(gt.next(qt))}catch(It){wt(It)}}function bt(qt){try{Tt(gt.throw(qt))}catch(It){wt(It)}}function Tt(qt){qt.done?xt(qt.value):new ft(function(It){It(qt.value)}).then(_t,bt)}Tt((gt=gt.apply(st,lt||[])).next())})},j=this&&this.__importStar||function(st){if(st&&st.__esModule)return st;var lt={};if(st!=null)for(var ft in st)Object.hasOwnProperty.call(st,ft)&&(lt[ft]=st[ft]);return lt.default=st,lt},K=this&&this.__importDefault||function(st){return st&&st.__esModule?st:{default:st}};Object.defineProperty(O,"__esModule",{value:!0});let Z=j(S(5838)),Y=K(S(8731)),X=S(8227),J=S(6286),q=S(6857);function H(st,lt,ft){let gt=st instanceof Z.Tensor?st.shape:[st.length,st[0].length];ft===0?J.assert(gt[0]===lt.length,`Length of xTickLabels (${lt.length}) must match number of rows (${gt[0]})`):ft===1&&J.assert(gt[1]===lt.length,`Length of yTickLabels (${lt.length}) must match number of columns (${gt[1]})`)}O.heatmap=function(st,lt,ft={}){return B(this,void 0,void 0,function*(){let gt=Object.assign({},tt,ft),xt=q.getDrawArea(st),wt=lt.values;gt.rowMajor&&(wt=yield function(Gt){return B(this,void 0,void 0,function*(){let ge,ee;Gt instanceof Z.Tensor?(ge=Gt.shape,ee=Gt.transpose()):(ge=[Gt.length,Gt[0].length],ee=Z.tidy(()=>Z.tensor2d(Gt).transpose())),J.assert(ee.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");let Ee=yield ee.array();ee.dispose();let Bt=[Ee.length,Ee[0].length];return J.assert(ge[0]===Bt[1]&&ge[1]===Bt[0],`Unexpected transposed shape. Original ${ge} : Transposed ${Bt}`),Ee})}(lt.values));let{xTickLabels:_t,yTickLabels:bt}=lt;_t!=null&&H(wt,_t,0),bt!=null&&H(wt,bt,1);let Tt="@tfidx@",qt=[];if(wt instanceof Z.Tensor){J.assert(wt.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");let Gt=yield wt.data(),[ge,ee]=wt.shape;for(let Ee=0;Ee<ge;Ee++){let Bt=_t?`${_t[Ee]}${Tt}${Ee}`:Ee;for(let Xt=0;Xt<ee;Xt++){let we=bt?`${bt[Xt]}${Tt}${Xt}`:Xt,ie=Gt[Ee*ee+Xt];qt.push({x:Bt,y:we,value:ie})}}}else{let Gt=wt;for(let ge=0;ge<Gt.length;ge++){let ee=_t?`${_t[ge]}${Tt}${ge}`:ge;for(let Ee=0;Ee<Gt[ge].length;Ee++){let Bt=bt?`${bt[Ee]}${Tt}${Ee}`:Ee,Xt=Gt[ge][Ee];qt.push({x:ee,y:Bt,value:Xt})}}}let It={actions:!1,mode:"vega-lite",defaultStyle:!1},St={width:gt.width||X.getDefaultWidth(xt),height:gt.height||X.getDefaultHeight(xt),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:gt.fontSize,titleFontSize:gt.fontSize},text:{fontSize:gt.fontSize},legend:{labelFontSize:gt.fontSize,titleFontSize:gt.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:qt},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:gt.xType,title:gt.xLabel,sort:!1},y:{field:"y",type:gt.yType,title:gt.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},vt=`${Tt}\\d+$`,Ft=new RegExp(vt),Qt;switch(_t&&(St.encoding.x.axis={labelExpr:`replace(datum.value, regexp(/${vt}/), '')`}),bt&&(St.encoding.y.axis={labelExpr:`replace(datum.value, regexp(/${vt}/), '')`}),(_t||bt)&&(It.tooltip={sanitize:Gt=>String(Gt).replace(Ft,"")}),gt.colorMap){case"blues":Qt=["#f7fbff","#4292c6"];break;case"greyscale":Qt=["#000000","#ffffff"];break;default:Qt="viridis"}if(Qt!=="viridis"&&(St.encoding.fill.scale={range:Qt}),gt.domain){let Gt=St.encoding.fill;Gt.scale!=null?Gt.scale=Object.assign({},Gt.scale,{domain:gt.domain}):Gt.scale={domain:gt.domain}}yield Y.default(xt,St,It)})};let tt={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1}},5877:function(L,O,S){var B=this&&this.__awaiter||function(H,tt,st,lt){return new(st||(st=Promise))(function(ft,gt){function xt(bt){try{_t(lt.next(bt))}catch(Tt){gt(Tt)}}function wt(bt){try{_t(lt.throw(bt))}catch(Tt){gt(Tt)}}function _t(bt){bt.done?ft(bt.value):new st(function(Tt){Tt(bt.value)}).then(xt,wt)}_t((lt=lt.apply(H,tt||[])).next())})},j=this&&this.__importDefault||function(H){return H&&H.__esModule?H:{default:H}};Object.defineProperty(O,"__esModule",{value:!0});let K=S(1934),Z=j(S(8731)),Y=S(8227),X=S(2729),J=S(9827),q={maxBins:12,fontSize:11};O.histogram=function(H,tt,st={}){return B(this,void 0,void 0,function*(){let lt=function(_t){if(_t.length==null)throw new Error("input data must be an array");if(_t.length===0)return[];if(typeof _t[0]=="object"){if(_t[0].value==null)throw new Error("input data must have a value field");return _t}{let bt=Array(_t.length);for(let Tt=0;Tt<_t.length;Tt++)bt[Tt]={value:_t[Tt]};return bt}}(tt),ft=Object.assign({},q,st),gt=Y.subSurface(H,"histogram");if(st.stats!==!1){let _t=Y.subSurface(H,"stats",{prepend:!0}),bt;bt=st.stats?st.stats:X.arrayStats(lt.map(Tt=>Tt.value)),function(Tt,qt,It){let St=K.format(",.4~f"),vt=K.format(".4~p"),Ft=[],Qt=[];if(Tt.numVals!=null&&(Ft.push("Num Vals"),Qt.push(St(Tt.numVals))),Tt.min!=null&&(Ft.push("Min"),Qt.push(St(Tt.min))),Tt.max!=null&&(Ft.push("Max"),Qt.push(St(Tt.max))),Tt.numZeros!=null){Ft.push("# Zeros");let Gt="";Tt.numVals&&(Gt=Tt.numZeros>0?`(${vt(Tt.numZeros/Tt.numVals)})`:""),Qt.push(`${St(Tt.numZeros)} ${Gt}`)}if(Tt.numNans!=null){Ft.push("# NaNs");let Gt="";Tt.numVals&&(Gt=Tt.numNans>0?`(${vt(Tt.numNans/Tt.numVals)})`:""),Qt.push(`${St(Tt.numNans)} ${Gt}`)}if(Tt.numInfs!=null){Ft.push("# Infinity");let Gt="";Tt.numVals&&(Gt=Tt.numInfs>0?`(${vt(Tt.numInfs/Tt.numVals)})`:""),Qt.push(`${St(Tt.numInfs)} ${Gt}`)}J.table(qt,{headers:Ft,values:[Qt]},It)}(bt,_t,{fontSize:ft.fontSize})}if(lt.length===0)return;let xt=[];for(let _t=0;_t<lt.length;_t++){let bt=lt[_t].value;bt!=null&&isFinite(bt)&&xt.push(lt[_t])}let wt={width:ft.width||Y.getDefaultWidth(gt),height:ft.height||Y.getDefaultHeight(gt),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:xt},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:ft.fontSize,titleFontSize:ft.fontSize},text:{fontSize:ft.fontSize},legend:{labelFontSize:ft.fontSize,titleFontSize:ft.fontSize}},encoding:{x:{bin:{maxbins:ft.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:ft.color||"#001B44"}}};return Z.default(gt,wt,{actions:!1,mode:"vega-lite",defaultStyle:!1})})}},4857:function(L,O,S){var B=this&&this.__awaiter||function(q,H,tt,st){return new(tt||(tt=Promise))(function(lt,ft){function gt(_t){try{wt(st.next(_t))}catch(bt){ft(bt)}}function xt(_t){try{wt(st.throw(_t))}catch(bt){ft(bt)}}function wt(_t){_t.done?lt(_t.value):new tt(function(bt){bt(_t.value)}).then(gt,xt)}wt((st=st.apply(q,H||[])).next())})},j=this&&this.__importDefault||function(q){return q&&q.__esModule?q:{default:q}};Object.defineProperty(O,"__esModule",{value:!0});let K=j(S(8731)),Z=S(8227),Y=S(6286),X=S(6857);O.linechart=function(q,H,tt={}){return B(this,void 0,void 0,function*(){let st=Array.isArray(H.values[0])?H.values:[H.values],lt=st[0].length,ft=H.series?H.series:st.map((qt,It)=>`Series ${It+1}`);Y.assert(ft.length===st.length,"Must have an equal number of series labels as there are data series"),tt.seriesColors!=null&&Y.assert(tt.seriesColors.length===st.length,"Must have an equal number of series colors as there are data series");let gt=[];for(let qt=0;qt<lt;qt++){let It={x:qt};ft.forEach((St,vt)=>{let Ft=st[vt][qt].y;It[St]=Ft,It[`${St}-name`]=St}),gt.push(It)}let xt=Object.assign({},J,tt),wt={x:{field:"x",type:xt.xType,title:xt.xLabel},tooltip:[{field:"x",type:"quantitative"},...ft.map(qt=>({field:qt,type:"quantitative"}))]},_t=ft.map(qt=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:qt,type:xt.yType,title:xt.yLabel,scale:xt.zoomToFit?{zero:!1}:xt.yAxisDomain!=null?{domain:xt.yAxisDomain}:void 0},color:{field:`${qt}-name`,type:"nominal",legend:{values:ft,title:null},scale:{range:xt.seriesColors}}}})),bt=X.getDrawArea(q),Tt={width:xt.width||Z.getDefaultWidth(bt),height:xt.height||Z.getDefaultHeight(bt),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:xt.fontSize,titleFontSize:xt.fontSize},text:{fontSize:xt.fontSize},legend:{labelFontSize:xt.fontSize,titleFontSize:xt.fontSize}},data:{values:gt},encoding:wt,layer:[..._t,{mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}}]};return yield K.default(bt,Tt,{actions:!1,mode:"vega-lite",defaultStyle:!1}),Promise.resolve()})};let J={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},6857:function(L,O,S){var B=this&&this.__awaiter||function(Z,Y,X,J){return new(X||(X=Promise))(function(q,H){function tt(ft){try{lt(J.next(ft))}catch(gt){H(gt)}}function st(ft){try{lt(J.throw(ft))}catch(gt){H(gt)}}function lt(ft){ft.done?q(ft.value):new X(function(gt){gt(ft.value)}).then(tt,st)}lt((J=J.apply(Z,Y||[])).next())})};Object.defineProperty(O,"__esModule",{value:!0});let j=S(5759),K=S(4701);O.getDrawArea=function(Z){if(Z instanceof HTMLElement)return Z;if(j.isSurface(Z))return Z.drawArea;if(j.isSurfaceInfo(Z))return K.visor().surface({name:Z.name,tab:Z.tab,styles:Z.styles}).drawArea;throw new Error("Not a drawable")},O.shallowEquals=function(Z,Y){let X=Object.getOwnPropertyNames(Z),J=Object.getOwnPropertyNames(Y);if(X.length!==J.length)return!1;for(let q=0;q<X.length;q++){let H=X[q];if(Z[H]!==Y[H])return!1}return!0},O.nextFrame=function(){return B(this,void 0,void 0,function*(){yield new Promise(Z=>requestAnimationFrame(Z))})}},898:function(L,O,S){var B=this&&this.__awaiter||function(q,H,tt,st){return new(tt||(tt=Promise))(function(lt,ft){function gt(_t){try{wt(st.next(_t))}catch(bt){ft(bt)}}function xt(_t){try{wt(st.throw(_t))}catch(bt){ft(bt)}}function wt(_t){_t.done?lt(_t.value):new tt(function(bt){bt(_t.value)}).then(gt,xt)}wt((st=st.apply(q,H||[])).next())})},j=this&&this.__importDefault||function(q){return q&&q.__esModule?q:{default:q}};Object.defineProperty(O,"__esModule",{value:!0});let K=j(S(8731)),Z=S(8227),Y=S(6286),X=S(6857);O.scatterplot=function(q,H,tt={}){return B(this,void 0,void 0,function*(){let st=H.values,lt=H.series==null?[]:H.series;st=Array.isArray(st[0])?st:[st];let ft=[];st.forEach((_t,bt)=>{let Tt=lt[bt]!=null?lt[bt]:`Series ${bt+1}`,qt=_t.map(It=>Object.assign({},It,{series:Tt}));ft.push(...qt)}),tt.seriesColors!=null&&Y.assert(tt.seriesColors.length===st.length,"Must have an equal number of series colors as there are data series");let gt=X.getDrawArea(q),xt=Object.assign({},J,tt),wt={width:xt.width||Z.getDefaultWidth(gt),height:xt.height||Z.getDefaultHeight(gt),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:xt.fontSize,titleFontSize:xt.fontSize},text:{fontSize:xt.fontSize},legend:{labelFontSize:xt.fontSize,titleFontSize:xt.fontSize}},data:{values:ft},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:xt.xType,title:xt.xLabel,scale:xt.zoomToFit?{zero:!1}:xt.xAxisDomain!=null?{domain:xt.xAxisDomain}:void 0},y:{field:"y",type:xt.yType,title:xt.yLabel,scale:xt.zoomToFit?{zero:!1}:xt.yAxisDomain!=null?{domain:xt.yAxisDomain}:void 0},color:{field:"series",type:"nominal",scale:{range:xt.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield K.default(gt,wt,{actions:!1,mode:"vega-lite",defaultStyle:!1}),Promise.resolve()})};let J={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},9827:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0});let B=S(1934),j=S(716),K=S(8205),Z=S(6857);O.table=function(X,J,q={}){if(J&&J.headers==null)throw new Error('Data to render must have a "headers" property');if(J&&J.values==null)throw new Error('Data to render must have a "values" property');let H=Z.getDrawArea(X),tt=Object.assign({},Y,q),st=j.select(H).select("table.tf-table"),lt=K.css({fontSize:tt.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(st.size()===0&&(st=j.select(H).append("table"),st.attr("class",` ${lt} tf-table`),st.append("thead").append("tr"),st.append("tbody")),st.size()!==1)throw new Error("Error inserting table");let ft=K.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),gt=st.select("thead").select("tr").selectAll("th").data(J.headers),xt=gt.enter().append("th").attr("class",`${ft}`);gt.merge(xt).html(St=>St),gt.exit().remove();let wt=B.format(",.4~f"),_t=st.select("tbody").selectAll("tr").data(J.values),bt=_t.enter().append("tr"),Tt=K.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),qt=_t.merge(bt).selectAll("td").data(St=>St),It=qt.enter().append("td").attr("class",`${Tt}`);qt.merge(It).html(St=>typeof St=="number"?wt(St):St),qt.exit().remove(),_t.exit().remove()};let Y={fontSize:14}},62:function(L,O,S){var B=this&&this.__awaiter||function(H,tt,st,lt){return new(st||(st=Promise))(function(ft,gt){function xt(bt){try{_t(lt.next(bt))}catch(Tt){gt(Tt)}}function wt(bt){try{_t(lt.throw(bt))}catch(Tt){gt(Tt)}}function _t(bt){bt.done?ft(bt.value):new st(function(Tt){Tt(bt.value)}).then(xt,wt)}_t((lt=lt.apply(H,tt||[])).next())})};Object.defineProperty(O,"__esModule",{value:!0});let j=S(4857),K=S(6857),Z=S(8227);function Y(H,tt,st,lt={}){return B(this,void 0,void 0,function*(){let ft=K.getDrawArea(H),gt={};for(let bt of st)if(/val_/.test(bt)){let Tt=bt.replace("val_","");X(gt,Tt);let qt=J(tt,bt,st.indexOf(bt));gt[Tt].series.push(bt),gt[Tt].values.push(qt)}else{let Tt=J(tt,bt,st.indexOf(bt));X(gt,bt),gt[bt].series.push(bt),gt[bt].values.push(Tt)}let xt=Object.keys(gt),wt=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},lt),_t=[];for(let bt of xt){let Tt=Z.subSurface(ft,bt),qt=gt[bt].series,It=gt[bt].values;qt.every(vt=>!!vt.match("acc"))&&(wt.zoomToFitAccuracy?wt.zoomToFit=!0:(wt.yAxisDomain=[0,1],delete wt.zoomToFit));let St=j.linechart(Tt,{values:It,series:qt},wt);_t.push(St)}yield Promise.all(_t)})}function X(H,tt){H[tt]==null&&(H[tt]={series:[],values:[]})}function J(H,tt,st){if(Array.isArray(H)){let lt=Array.isArray(H[0])?H[st]:H,ft=[];for(let gt=0;gt<lt.length;gt++){let xt=lt[gt];ft.push({x:gt,y:xt[tt]})}return ft}return H.history[tt].map((lt,ft)=>({x:ft,y:lt}))}function q(H,tt,st){return H[tt]==null&&(H[tt]={}),H[tt][st]==null&&(H[tt][st]=[]),H[tt][st]}O.history=Y,O.fitCallbacks=function(H,tt,st={}){let lt={},ft=st.callbacks||["onEpochEnd","onBatchEnd"],gt=K.getDrawArea(H),xt=Object.assign({},st);delete xt.callbacks;let wt={};return ft.forEach(_t=>{wt[_t]=function(bt){return(Tt,qt)=>B(this,void 0,void 0,function*(){/batch/i.test(bt)?xt.xLabel="Batch":/epoch/i.test(bt)&&(xt.xLabel="Epoch");let It=[],St=[];for(let vt of tt)if(qt[vt]!=null){St.push(vt);let Ft=q(lt,bt,vt);Ft.push({[vt]:qt[vt]}),It.push(Ft)}Y(Z.subSurface(gt,bt,{title:bt}),It,St,xt),yield K.nextFrame()})}(_t)}),wt}},3559:function(L,O,S){var B=this&&this.__awaiter||function(H,tt,st,lt){return new(st||(st=Promise))(function(ft,gt){function xt(bt){try{_t(lt.next(bt))}catch(Tt){gt(Tt)}}function wt(bt){try{_t(lt.throw(bt))}catch(Tt){gt(Tt)}}function _t(bt){bt.done?ft(bt.value):new st(function(Tt){Tt(bt.value)}).then(xt,wt)}_t((lt=lt.apply(H,tt||[])).next())})};Object.defineProperty(O,"__esModule",{value:!0});let j=S(5877),K=S(6857),Z=S(9827),Y=S(8227),X=S(2729);function J(H){let tt;return Array.isArray(H.outputShape[0])?tt=`[${H.outputShape.map(st=>q(st)).join(", ")}]`:tt=q(H.outputShape),{name:H.name,trainable:H.trainable,parameters:H.countParams(),outputShape:tt}}function q(H){let tt=H.slice();return tt.length===0?"Scalar":(tt[0]===null&&(tt[0]="batch"),`[${tt.join(",")}]`)}O.modelSummary=function(H,tt){return B(this,void 0,void 0,function*(){let st=K.getDrawArea(H),lt=function(gt){return{layers:gt.layers.map(J)}}(tt),ft=lt.layers.map(gt=>[gt.name,gt.outputShape,gt.parameters,gt.trainable]);Z.table(st,{headers:["Layer Name","Output Shape","# Of Params","Trainable"],values:ft})})},O.layer=function(H,tt){return B(this,void 0,void 0,function*(){let st=K.getDrawArea(H),lt=yield function(_t){return B(this,void 0,void 0,function*(){let bt=_t.getWeights(),Tt=_t.weights,qt=bt.map(X.tensorStats),It=yield Promise.all(qt),St=bt.map(vt=>vt.shape);return bt.map((vt,Ft)=>({name:Tt[Ft].name,stats:It[Ft],shape:q(St[Ft]),weight:vt}))})}(tt),ft=Y.subSurface(st,"layer-weights-info"),gt=lt.map(_t=>[_t.name,_t.shape,_t.stats.min,_t.stats.max,_t.weight.size,_t.stats.numZeros,_t.stats.numNans,_t.stats.numInfs]);Z.table(ft,{headers:["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],values:gt});let xt=Y.subSurface(st,"select-layer"),wt=Y.subSurface(st,"param-distribution");(function(_t,bt,Tt){let qt=`
    <select>
      ${_t.map(Ft=>`<option value=${Ft}>${Ft}</option>`)}
    </select>
  `,It=`<div><button>Show Values Distribution for:</button>${qt}</div>`;bt.innerHTML=It;let St=bt.querySelector("button"),vt=bt.querySelector("select");St.addEventListener("click",()=>{Tt(vt.selectedOptions[0].label)})})(lt.map(_t=>_t.name),xt,_t=>B(this,void 0,void 0,function*(){let bt=lt.filter(qt=>qt.name===_t)[0],Tt=yield bt.weight.data();j.histogram(wt,Tt,{height:150,width:460,stats:!1})}))})}},5727:function(L,O,S){var B=this&&this.__awaiter||function(Z,Y,X,J){return new(X||(X=Promise))(function(q,H){function tt(ft){try{lt(J.next(ft))}catch(gt){H(gt)}}function st(ft){try{lt(J.throw(ft))}catch(gt){H(gt)}}function lt(ft){ft.done?q(ft.value):new X(function(gt){gt(ft.value)}).then(tt,st)}lt((J=J.apply(Z,Y||[])).next())})};Object.defineProperty(O,"__esModule",{value:!0});let j=S(6857),K=S(9827);O.perClassAccuracy=function(Z,Y,X){return B(this,void 0,void 0,function*(){let J=j.getDrawArea(Z),q=[];for(let H=0;H<Y.length;H++){let tt=X?X[H]:H.toString(),st=Y[H];q.push([tt,st.accuracy,st.count])}return K.table(J,{headers:["Class","Accuracy","# Samples"],values:q})})}},4853:function(L,O,S){var B=this&&this.__awaiter||function(Y,X,J,q){return new(J||(J=Promise))(function(H,tt){function st(gt){try{ft(q.next(gt))}catch(xt){tt(xt)}}function lt(gt){try{ft(q.throw(gt))}catch(xt){tt(xt)}}function ft(gt){gt.done?H(gt.value):new J(function(xt){xt(gt.value)}).then(st,lt)}ft((q=q.apply(Y,X||[])).next())})};Object.defineProperty(O,"__esModule",{value:!0});let j=S(5877),K=S(6857),Z=S(2729);O.valuesDistribution=function(Y,X){return B(this,void 0,void 0,function*(){let J=K.getDrawArea(Y),q=yield Z.tensorStats(X),H=yield X.data();j.histogram(J,H,{height:150,stats:q})})}},5759:(L,O)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.isSurfaceInfo=function(S){return S.name!=null},O.isSurface=function(S){return S.drawArea instanceof HTMLElement}},8227:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0});let B=S(8205),j=S(6857),K={prepend:!1};O.subSurface=function(Z,Y,X={}){let J=j.getDrawArea(Z),q=B.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),H=B.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),tt=Object.assign({},K,X),st=J.querySelector(`div[data-name=${Y}]`);if(!st){if(st=document.createElement("div"),st.setAttribute("class",`${q}`),st.dataset.name=Y,tt.title){let lt=document.createElement("div");lt.setAttribute("class",`subsurface-title ${H}`),lt.innerText=tt.title,st.appendChild(lt)}tt.prepend?J.insertBefore(st,J.firstChild):J.appendChild(st)}return st},O.getDefaultWidth=function(Z){let Y=0,X=Z;for(;X&&X.clientWidth===0;)X=X.parentElement,Y=50;return X.clientWidth-Y},O.getDefaultHeight=function(Z){return Z.clientHeight===0?200:Z.clientHeight}},2729:function(L,O,S){var B=this&&this.__awaiter||function(Z,Y,X,J){return new(X||(X=Promise))(function(q,H){function tt(ft){try{lt(J.next(ft))}catch(gt){H(gt)}}function st(ft){try{lt(J.throw(ft))}catch(gt){H(gt)}}function lt(ft){ft.done?q(ft.value):new X(function(gt){gt(ft.value)}).then(tt,st)}lt((J=J.apply(Z,Y||[])).next())})};Object.defineProperty(O,"__esModule",{value:!0});let j=S(5838),K=S(6286);O.arrayStats=function(Z){if(!Array.isArray(Z))throw new Error("input must be an array");if(Z.length===0)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};let Y=Z.length,X=-1/0,J=1/0,q=0,H=0,tt=0;for(let lt=0;lt<Y;lt++){let ft=Z[lt];ft>X&&(X=ft),ft<J&&(J=ft),ft===0&&(q+=1),isNaN(ft)?H+=1:isFinite(ft)||(tt+=1)}let st={numVals:Y,numZeros:q,numNans:H,max:X,min:J,numInfs:tt};return st.max===-1/0&&(st.max=NaN),st.min===1/0&&(st.min=NaN),st},O.tensorStats=function(Z){return B(this,void 0,void 0,function*(){let[Y,X,J]=j.tidy(()=>{let q=j.scalar(0,Z.dtype);return[Z.min(),Z.max(),Z.equal(q).sum()]});return Promise.all([Z.data(),Y.data(),X.data(),J.data()]).then(([q,H,tt,st])=>{let lt=q.length,ft=0,gt=0;for(let _t=0;_t<lt;_t++){let bt=q[_t];isNaN(bt)?ft+=1:isFinite(bt)||(gt+=1)}let xt=H[0],wt=tt[0];return ft===lt&&(xt=NaN,wt=NaN),{numVals:lt,numZeros:st[0],numNans:ft,min:xt,max:wt,numInfs:gt}})})},O.confusionMatrix=function(Z,Y,X,J){return B(this,void 0,void 0,function*(){K.assert(Z.rank===1,"labels must be a 1D tensor"),K.assert(Y.rank===1,"predictions must be a 1D tensor"),K.assert(Z.size===Y.size,"labels and predictions must be the same length"),J!=null&&K.assert(J.size===Y.size,"labels and predictions must be the same length");let q=Z.cast("int32"),H=Y.cast("int32");X==null&&(X=j.tidy(()=>j.maximum(q.max(),H.max()).cast("int32").dataSync()[0]+1));let tt=Promise.resolve(null);return J!=null&&(tt=J.data()),Promise.all([q.data(),H.data(),tt]).then(([st,lt,ft])=>{let gt=Array(X).fill(0);for(let xt=0;xt<X;xt++)gt[xt]=Array(X).fill(0);for(let xt=0;xt<st.length;xt++){let wt=st[xt],_t=lt[xt];gt[wt][_t]+=ft!=null?ft[xt]:1}return gt})})},O.accuracy=function(Z,Y){return B(this,void 0,void 0,function*(){K.assertShapesMatch(Z.shape,Y.shape,"Error computing accuracy.");let X=Z.equal(Y),J=X.mean(),q=(yield J.data())[0];return j.dispose([X,J]),q})},O.perClassAccuracy=function(Z,Y,X){return B(this,void 0,void 0,function*(){return K.assert(Z.rank===1,"labels must be a 1D tensor"),K.assert(Y.rank===1,"predictions must be a 1D tensor"),K.assert(Z.size===Y.size,"labels and predictions must be the same length"),X==null&&(X=j.tidy(()=>j.maximum(Z.max(),Y.max()).dataSync()[0]+1)),Promise.all([Z.data(),Y.data()]).then(([J,q])=>{let H=Array(X).fill(0),tt=Array(X).fill(0);for(let lt=0;lt<J.length;lt++){let ft=J[lt],gt=q[lt];H[ft]+=1,ft===gt&&(tt[ft]+=1)}let st=[];for(let lt=0;lt<H.length;lt++)st.push({count:H[lt],accuracy:H[lt]===0?0:tt[lt]/H[lt]});return st})})}},6286:(L,O)=>{function S(j,K){if(!j)throw new Error(typeof K=="string"?K:K())}function B(j,K){if(j.length!==K.length)return!1;for(let Z=0;Z<j.length;Z++)if(j[Z]!==K[Z])return!1;return!0}Object.defineProperty(O,"__esModule",{value:!0}),O.assert=S,O.assertShapesMatch=function(j,K,Z=""){S(B(j,K),Z+` Shapes ${j} and ${K} must match`)},O.arraysEqual=B,O.DECIMAL_PLACES_TO_CHECK=4},454:(L,O)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.version="1.5.1"},4701:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0});let B=S(5976),j,K="tfjs-visor-container";O.visor=function(){if(typeof document>"u")throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(K)&&j!=null)return j;let Y,X=document.getElementById(K);function J(tt,st){let lt=null;return Y=B.VisorComponent.render(tt,Y,{ref:ft=>lt=ft,surfaceList:Array.from(st.values())}),lt}X==null&&(X=document.createElement("div"),X.id=K,document.body.appendChild(X));let q=new Map,H=J(X,q);return j=new Z(H,X,q,J),j};class Z{constructor(X,J,q,H){this.visorComponent=X,this.el=J,this.surfaceList=q,this.renderVisor=H}surface(X){let{name:J}=X,q=X.tab==null?"Visor":X.tab;if(J==null||!(typeof J=="string"||J instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");let H=Object.assign({},X,{tab:q}),tt=`${J}-${q}`;return this.surfaceList.has(tt)||this.surfaceList.set(tt,H),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(J,q)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(X){if(!this.visorComponent.state.tabs.has(X))throw new Error(`Tab '${X}' does not exist`);this.visorComponent.setState({activeTab:X})}}O.Visor=Z},1934:(L,O,S)=>{function B(Tt,qt){if((It=(Tt=qt?Tt.toExponential(qt-1):Tt.toExponential()).indexOf("e"))<0)return null;var It,St=Tt.slice(0,It);return[St.length>1?St[0]+St.slice(2):St,+Tt.slice(It+1)]}function j(Tt){return(Tt=B(Math.abs(Tt)))?Tt[1]:NaN}S.r(O),S.d(O,{format:()=>st,formatDefaultLocale:()=>xt,formatLocale:()=>gt,formatPrefix:()=>lt,formatSpecifier:()=>Y,precisionFixed:()=>wt,precisionPrefix:()=>_t,precisionRound:()=>bt});var K,Z=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Y(Tt){return new X(Tt)}function X(Tt){if(!(qt=Z.exec(Tt)))throw new Error("invalid format: "+Tt);var qt;this.fill=qt[1]||" ",this.align=qt[2]||">",this.sign=qt[3]||"-",this.symbol=qt[4]||"",this.zero=!!qt[5],this.width=qt[6]&&+qt[6],this.comma=!!qt[7],this.precision=qt[8]&&+qt[8].slice(1),this.trim=!!qt[9],this.type=qt[10]||""}function J(Tt,qt){var It=B(Tt,qt);if(!It)return Tt+"";var St=It[0],vt=It[1];return vt<0?"0."+new Array(-vt).join("0")+St:St.length>vt+1?St.slice(0,vt+1)+"."+St.slice(vt+1):St+new Array(vt-St.length+2).join("0")}Y.prototype=X.prototype,X.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width==null?"":Math.max(1,0|this.width))+(this.comma?",":"")+(this.precision==null?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};let q={"%":function(Tt,qt){return(100*Tt).toFixed(qt)},b:function(Tt){return Math.round(Tt).toString(2)},c:function(Tt){return Tt+""},d:function(Tt){return Math.round(Tt).toString(10)},e:function(Tt,qt){return Tt.toExponential(qt)},f:function(Tt,qt){return Tt.toFixed(qt)},g:function(Tt,qt){return Tt.toPrecision(qt)},o:function(Tt){return Math.round(Tt).toString(8)},p:function(Tt,qt){return J(100*Tt,qt)},r:J,s:function(Tt,qt){var It=B(Tt,qt);if(!It)return Tt+"";var St=It[0],vt=It[1],Ft=vt-(K=3*Math.max(-8,Math.min(8,Math.floor(vt/3))))+1,Qt=St.length;return Ft===Qt?St:Ft>Qt?St+new Array(Ft-Qt+1).join("0"):Ft>0?St.slice(0,Ft)+"."+St.slice(Ft):"0."+new Array(1-Ft).join("0")+B(Tt,Math.max(0,qt+Ft-1))[0]},X:function(Tt){return Math.round(Tt).toString(16).toUpperCase()},x:function(Tt){return Math.round(Tt).toString(16)}};function H(Tt){return Tt}var tt,st,lt,ft=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function gt(Tt){var qt,It,St=Tt.grouping&&Tt.thousands?(qt=Tt.grouping,It=Tt.thousands,function(ee,Ee){for(var Bt=ee.length,Xt=[],we=0,ie=qt[0],m=0;Bt>0&&ie>0&&(m+ie+1>Ee&&(ie=Math.max(1,Ee-m)),Xt.push(ee.substring(Bt-=ie,Bt+ie)),!((m+=ie+1)>Ee));)ie=qt[we=(we+1)%qt.length];return Xt.reverse().join(It)}):H,vt=Tt.currency,Ft=Tt.decimal,Qt=Tt.numerals?function(ee){return function(Ee){return Ee.replace(/[0-9]/g,function(Bt){return ee[+Bt]})}}(Tt.numerals):H,Gt=Tt.percent||"%";function ge(ee){var Ee=(ee=Y(ee)).fill,Bt=ee.align,Xt=ee.sign,we=ee.symbol,ie=ee.zero,m=ee.width,ye=ee.comma,Ge=ee.precision,te=ee.trim,Me=ee.type;Me==="n"?(ye=!0,Me="g"):q[Me]||(Ge==null&&(Ge=12),te=!0,Me="g"),(ie||Ee==="0"&&Bt==="=")&&(ie=!0,Ee="0",Bt="=");var Ye=we==="$"?vt[0]:we==="#"&&/[boxX]/.test(Me)?"0"+Me.toLowerCase():"",Ue=we==="$"?vt[1]:/[%p]/.test(Me)?Gt:"",kn=q[Me],mn=/[defgprs%]/.test(Me);function Kn(Sn){var Wn,Ze,de,Re=Ye,Kt=Ue;if(Me==="c")Kt=kn(Sn)+Kt,Sn="";else{var Jt=(Sn=+Sn)<0;if(Sn=kn(Math.abs(Sn),Ge),te&&(Sn=function(tn){t:for(var wn,Mn=tn.length,Hn=1,Zn=-1;Hn<Mn;++Hn)switch(tn[Hn]){case".":Zn=wn=Hn;break;case"0":Zn===0&&(Zn=Hn),wn=Hn;break;default:if(Zn>0){if(!+tn[Hn])break t;Zn=0}}return Zn>0?tn.slice(0,Zn)+tn.slice(wn+1):tn}(Sn)),Jt&&+Sn==0&&(Jt=!1),Re=(Jt?Xt==="("?Xt:"-":Xt==="-"||Xt==="("?"":Xt)+Re,Kt=(Me==="s"?ft[8+K/3]:"")+Kt+(Jt&&Xt==="("?")":""),mn){for(Wn=-1,Ze=Sn.length;++Wn<Ze;)if(48>(de=Sn.charCodeAt(Wn))||de>57){Kt=(de===46?Ft+Sn.slice(Wn+1):Sn.slice(Wn))+Kt,Sn=Sn.slice(0,Wn);break}}}ye&&!ie&&(Sn=St(Sn,1/0));var Ae=Re.length+Sn.length+Kt.length,$e=Ae<m?new Array(m-Ae+1).join(Ee):"";switch(ye&&ie&&(Sn=St($e+Sn,$e.length?m-Kt.length:1/0),$e=""),Bt){case"<":Sn=Re+Sn+Kt+$e;break;case"=":Sn=Re+$e+Sn+Kt;break;case"^":Sn=$e.slice(0,Ae=$e.length>>1)+Re+Sn+Kt+$e.slice(Ae);break;default:Sn=$e+Re+Sn+Kt}return Qt(Sn)}return Ge=Ge==null?6:/[gprs]/.test(Me)?Math.max(1,Math.min(21,Ge)):Math.max(0,Math.min(20,Ge)),Kn.toString=function(){return ee+""},Kn}return{format:ge,formatPrefix:function(ee,Ee){var Bt=ge(((ee=Y(ee)).type="f",ee)),Xt=3*Math.max(-8,Math.min(8,Math.floor(j(Ee)/3))),we=Math.pow(10,-Xt),ie=ft[8+Xt/3];return function(m){return Bt(we*m)+ie}}}}function xt(Tt){return tt=gt(Tt),st=tt.format,lt=tt.formatPrefix,tt}function wt(Tt){return Math.max(0,-j(Math.abs(Tt)))}function _t(Tt,qt){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(j(qt)/3)))-j(Math.abs(Tt)))}function bt(Tt,qt){return Tt=Math.abs(Tt),qt=Math.abs(qt)-Tt,Math.max(0,j(qt)-j(Tt))+1}xt({decimal:".",thousands:",",grouping:[3],currency:["$",""]})},1779:L=>{var O=function(){function S(J,q){return q!=null&&J instanceof q}var B,j,K;try{B=Map}catch{B=function(){}}try{j=Set}catch{j=function(){}}try{K=Promise}catch{K=function(){}}function Z(J,q,H,tt,st){typeof q=="object"&&(H=q.depth,tt=q.prototype,st=q.includeNonEnumerable,q=q.circular);var lt=[],ft=[],gt=typeof Un<"u";return q===void 0&&(q=!0),H===void 0&&(H=1/0),function xt(wt,_t){if(wt===null)return null;if(_t===0)return wt;var bt,Tt;if(typeof wt!="object")return wt;if(S(wt,B))bt=new B;else if(S(wt,j))bt=new j;else if(S(wt,K))bt=new K(function(ee,Ee){wt.then(function(Bt){ee(xt(Bt,_t-1))},function(Bt){Ee(xt(Bt,_t-1))})});else if(Z.__isArray(wt))bt=[];else if(Z.__isRegExp(wt))bt=new RegExp(wt.source,X(wt)),wt.lastIndex&&(bt.lastIndex=wt.lastIndex);else if(Z.__isDate(wt))bt=new Date(wt.getTime());else{if(gt&&Un.isBuffer(wt))return bt=Un.allocUnsafe?Un.allocUnsafe(wt.length):new Un(wt.length),wt.copy(bt),bt;S(wt,Error)?bt=Object.create(wt):tt===void 0?(Tt=Object.getPrototypeOf(wt),bt=Object.create(Tt)):(bt=Object.create(tt),Tt=tt)}if(q){var qt=lt.indexOf(wt);if(qt!=-1)return ft[qt];lt.push(wt),ft.push(bt)}for(var It in S(wt,B)&&wt.forEach(function(ee,Ee){var Bt=xt(Ee,_t-1),Xt=xt(ee,_t-1);bt.set(Bt,Xt)}),S(wt,j)&&wt.forEach(function(ee){var Ee=xt(ee,_t-1);bt.add(Ee)}),wt){var St;Tt&&(St=Object.getOwnPropertyDescriptor(Tt,It)),St&&St.set==null||(bt[It]=xt(wt[It],_t-1))}if(Object.getOwnPropertySymbols){var vt=Object.getOwnPropertySymbols(wt);for(It=0;It<vt.length;It++){var Ft=vt[It];(!(Gt=Object.getOwnPropertyDescriptor(wt,Ft))||Gt.enumerable||st)&&(bt[Ft]=xt(wt[Ft],_t-1),Gt.enumerable||Object.defineProperty(bt,Ft,{enumerable:!1}))}}if(st){var Qt=Object.getOwnPropertyNames(wt);for(It=0;It<Qt.length;It++){var Gt,ge=Qt[It];(Gt=Object.getOwnPropertyDescriptor(wt,ge))&&Gt.enumerable||(bt[ge]=xt(wt[ge],_t-1),Object.defineProperty(bt,ge,{enumerable:!1}))}}return bt}(J,H)}function Y(J){return Object.prototype.toString.call(J)}function X(J){var q="";return J.global&&(q+="g"),J.ignoreCase&&(q+="i"),J.multiline&&(q+="m"),q}return Z.clonePrototype=function(J){if(J===null)return null;var q=function(){};return q.prototype=J,new q},Z.__objToStr=Y,Z.__isDate=function(J){return typeof J=="object"&&Y(J)==="[object Date]"},Z.__isArray=function(J){return typeof J=="object"&&Y(J)==="[object Array]"},Z.__isRegExp=function(J){return typeof J=="object"&&Y(J)==="[object RegExp]"},Z.__getRegExpFlags=X,Z}();L.exports&&(L.exports=O)},5721:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(Z){return(0,K.default)(Z)};var B,j=S(8066),K=(B=j)&&B.__esModule?B:{default:B};L.exports=O.default},4014:(L,O)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(B){return typeof B=="string"&&S.test(B)};var S=/-webkit-|-moz-|-ms-/;L.exports=O.default},716:(L,O,S)=>{S.r(O),S.d(O,{clientPoint:()=>ua,create:()=>qn,creator:()=>X,customEvent:()=>Mr,event:()=>Mn,local:()=>Er,matcher:()=>gt,mouse:()=>br,namespace:()=>K,namespaces:()=>j,select:()=>lr,selectAll:()=>eo,selection:()=>En,selector:()=>q,selectorAll:()=>tt,style:()=>Bt,touch:()=>Fo,touches:()=>Wa,window:()=>Gt});var B="http://www.w3.org/1999/xhtml";let j={svg:"http://www.w3.org/2000/svg",xhtml:B,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function K(Le){var bn=Le+="",jn=bn.indexOf(":");return jn>=0&&(bn=Le.slice(0,jn))!=="xmlns"&&(Le=Le.slice(jn+1)),j.hasOwnProperty(bn)?{space:j[bn],local:Le}:Le}function Z(Le){return function(){var bn=this.ownerDocument,jn=this.namespaceURI;return jn===B&&bn.documentElement.namespaceURI===B?bn.createElement(Le):bn.createElementNS(jn,Le)}}function Y(Le){return function(){return this.ownerDocument.createElementNS(Le.space,Le.local)}}function X(Le){var bn=K(Le);return(bn.local?Y:Z)(bn)}function J(){}function q(Le){return Le==null?J:function(){return this.querySelector(Le)}}function H(){return[]}function tt(Le){return Le==null?H:function(){return this.querySelectorAll(Le)}}var st=function(Le){return function(){return this.matches(Le)}};if(typeof document<"u"){var lt=document.documentElement;if(!lt.matches){var ft=lt.webkitMatchesSelector||lt.msMatchesSelector||lt.mozMatchesSelector||lt.oMatchesSelector;st=function(Le){return function(){return ft.call(this,Le)}}}}let gt=st;function xt(Le){return new Array(Le.length)}function wt(Le,bn){this.ownerDocument=Le.ownerDocument,this.namespaceURI=Le.namespaceURI,this._next=null,this._parent=Le,this.__data__=bn}wt.prototype={constructor:wt,appendChild:function(Le){return this._parent.insertBefore(Le,this._next)},insertBefore:function(Le,bn){return this._parent.insertBefore(Le,bn)},querySelector:function(Le){return this._parent.querySelector(Le)},querySelectorAll:function(Le){return this._parent.querySelectorAll(Le)}};function _t(Le,bn,jn,Jn,dr,Ur){for(var or,Yn=0,li=bn.length,Ki=Ur.length;Yn<Ki;++Yn)(or=bn[Yn])?(or.__data__=Ur[Yn],Jn[Yn]=or):jn[Yn]=new wt(Le,Ur[Yn]);for(;Yn<li;++Yn)(or=bn[Yn])&&(dr[Yn]=or)}function bt(Le,bn,jn,Jn,dr,Ur,or){var Yn,li,Ki,Si={},Da=bn.length,_i=Ur.length,la=new Array(Da);for(Yn=0;Yn<Da;++Yn)(li=bn[Yn])&&(la[Yn]=Ki="$"+or.call(li,li.__data__,Yn,bn),Ki in Si?dr[Yn]=li:Si[Ki]=li);for(Yn=0;Yn<_i;++Yn)(li=Si[Ki="$"+or.call(Le,Ur[Yn],Yn,Ur)])?(Jn[Yn]=li,li.__data__=Ur[Yn],Si[Ki]=null):jn[Yn]=new wt(Le,Ur[Yn]);for(Yn=0;Yn<Da;++Yn)(li=bn[Yn])&&Si[la[Yn]]===li&&(dr[Yn]=li)}function Tt(Le,bn){return Le<bn?-1:Le>bn?1:Le>=bn?0:NaN}function qt(Le){return function(){this.removeAttribute(Le)}}function It(Le){return function(){this.removeAttributeNS(Le.space,Le.local)}}function St(Le,bn){return function(){this.setAttribute(Le,bn)}}function vt(Le,bn){return function(){this.setAttributeNS(Le.space,Le.local,bn)}}function Ft(Le,bn){return function(){var jn=bn.apply(this,arguments);jn==null?this.removeAttribute(Le):this.setAttribute(Le,jn)}}function Qt(Le,bn){return function(){var jn=bn.apply(this,arguments);jn==null?this.removeAttributeNS(Le.space,Le.local):this.setAttributeNS(Le.space,Le.local,jn)}}function Gt(Le){return Le.ownerDocument&&Le.ownerDocument.defaultView||Le.document&&Le||Le.defaultView}function ge(Le){return function(){this.style.removeProperty(Le)}}function ee(Le,bn,jn){return function(){this.style.setProperty(Le,bn,jn)}}function Ee(Le,bn,jn){return function(){var Jn=bn.apply(this,arguments);Jn==null?this.style.removeProperty(Le):this.style.setProperty(Le,Jn,jn)}}function Bt(Le,bn){return Le.style.getPropertyValue(bn)||Gt(Le).getComputedStyle(Le,null).getPropertyValue(bn)}function Xt(Le){return function(){delete this[Le]}}function we(Le,bn){return function(){this[Le]=bn}}function ie(Le,bn){return function(){var jn=bn.apply(this,arguments);jn==null?delete this[Le]:this[Le]=jn}}function m(Le){return Le.trim().split(/^|\s+/)}function ye(Le){return Le.classList||new Ge(Le)}function Ge(Le){this._node=Le,this._names=m(Le.getAttribute("class")||"")}function te(Le,bn){for(var jn=ye(Le),Jn=-1,dr=bn.length;++Jn<dr;)jn.add(bn[Jn])}function Me(Le,bn){for(var jn=ye(Le),Jn=-1,dr=bn.length;++Jn<dr;)jn.remove(bn[Jn])}function Ye(Le){return function(){te(this,Le)}}function Ue(Le){return function(){Me(this,Le)}}function kn(Le,bn){return function(){(bn.apply(this,arguments)?te:Me)(this,Le)}}function mn(){this.textContent=""}function Kn(Le){return function(){this.textContent=Le}}function Sn(Le){return function(){var bn=Le.apply(this,arguments);this.textContent=bn??""}}function Wn(){this.innerHTML=""}function Ze(Le){return function(){this.innerHTML=Le}}function de(Le){return function(){var bn=Le.apply(this,arguments);this.innerHTML=bn??""}}function Re(){this.nextSibling&&this.parentNode.appendChild(this)}function Kt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Jt(){return null}function Ae(){var Le=this.parentNode;Le&&Le.removeChild(this)}function $e(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function tn(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}Ge.prototype={add:function(Le){this._names.indexOf(Le)<0&&(this._names.push(Le),this._node.setAttribute("class",this._names.join(" ")))},remove:function(Le){var bn=this._names.indexOf(Le);bn>=0&&(this._names.splice(bn,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(Le){return this._names.indexOf(Le)>=0}};var wn={},Mn=null;typeof document<"u"&&("onmouseenter"in document.documentElement||(wn={mouseenter:"mouseover",mouseleave:"mouseout"}));function Hn(Le,bn,jn){return Le=Zn(Le,bn,jn),function(Jn){var dr=Jn.relatedTarget;dr&&(dr===this||8&dr.compareDocumentPosition(this))||Le.call(this,Jn)}}function Zn(Le,bn,jn){return function(Jn){var dr=Mn;Mn=Jn;try{Le.call(this,this.__data__,bn,jn)}finally{Mn=dr}}}function _r(Le){return function(){var bn=this.__on;if(bn){for(var jn,Jn=0,dr=-1,Ur=bn.length;Jn<Ur;++Jn)jn=bn[Jn],Le.type&&jn.type!==Le.type||jn.name!==Le.name?bn[++dr]=jn:this.removeEventListener(jn.type,jn.listener,jn.capture);++dr?bn.length=dr:delete this.__on}}}function Sr(Le,bn,jn){var Jn=wn.hasOwnProperty(Le.type)?Hn:Zn;return function(dr,Ur,or){var Yn,li=this.__on,Ki=Jn(bn,Ur,or);if(li){for(var Si=0,Da=li.length;Si<Da;++Si)if((Yn=li[Si]).type===Le.type&&Yn.name===Le.name)return this.removeEventListener(Yn.type,Yn.listener,Yn.capture),this.addEventListener(Yn.type,Yn.listener=Ki,Yn.capture=jn),void(Yn.value=bn)}this.addEventListener(Le.type,Ki,jn),Yn={type:Le.type,name:Le.name,value:bn,listener:Ki,capture:jn},li?li.push(Yn):this.__on=[Yn]}}function Mr(Le,bn,jn,Jn){var dr=Mn;Le.sourceEvent=Mn,Mn=Le;try{return bn.apply(jn,Jn)}finally{Mn=dr}}function ai(Le,bn,jn){var Jn=Gt(Le),dr=Jn.CustomEvent;typeof dr=="function"?dr=new dr(bn,jn):(dr=Jn.document.createEvent("Event"),jn?(dr.initEvent(bn,jn.bubbles,jn.cancelable),dr.detail=jn.detail):dr.initEvent(bn,!1,!1)),Le.dispatchEvent(dr)}function ea(Le,bn){return function(){return ai(this,Le,bn)}}function Pi(Le,bn){return function(){return ai(this,Le,bn.apply(this,arguments))}}var Cr=[null];function Ti(Le,bn){this._groups=Le,this._parents=bn}function Be(){return new Ti([[document.documentElement]],Cr)}Ti.prototype=Be.prototype={constructor:Ti,select:function(Le){typeof Le!="function"&&(Le=q(Le));for(var bn=this._groups,jn=bn.length,Jn=new Array(jn),dr=0;dr<jn;++dr)for(var Ur,or,Yn=bn[dr],li=Yn.length,Ki=Jn[dr]=new Array(li),Si=0;Si<li;++Si)(Ur=Yn[Si])&&(or=Le.call(Ur,Ur.__data__,Si,Yn))&&("__data__"in Ur&&(or.__data__=Ur.__data__),Ki[Si]=or);return new Ti(Jn,this._parents)},selectAll:function(Le){typeof Le!="function"&&(Le=tt(Le));for(var bn=this._groups,jn=bn.length,Jn=[],dr=[],Ur=0;Ur<jn;++Ur)for(var or,Yn=bn[Ur],li=Yn.length,Ki=0;Ki<li;++Ki)(or=Yn[Ki])&&(Jn.push(Le.call(or,or.__data__,Ki,Yn)),dr.push(or));return new Ti(Jn,dr)},filter:function(Le){typeof Le!="function"&&(Le=gt(Le));for(var bn=this._groups,jn=bn.length,Jn=new Array(jn),dr=0;dr<jn;++dr)for(var Ur,or=bn[dr],Yn=or.length,li=Jn[dr]=[],Ki=0;Ki<Yn;++Ki)(Ur=or[Ki])&&Le.call(Ur,Ur.__data__,Ki,or)&&li.push(Ur);return new Ti(Jn,this._parents)},data:function(Le,bn){if(!Le)return so=new Array(this.size()),Si=-1,this.each(function(Xo){so[++Si]=Xo}),so;var jn,Jn=bn?bt:_t,dr=this._parents,Ur=this._groups;typeof Le!="function"&&(jn=Le,Le=function(){return jn});for(var or=Ur.length,Yn=new Array(or),li=new Array(or),Ki=new Array(or),Si=0;Si<or;++Si){var Da=dr[Si],_i=Ur[Si],la=_i.length,so=Le.call(Da,Da&&Da.__data__,Si,dr),ys=so.length,vs=li[Si]=new Array(ys),qo=Yn[Si]=new Array(ys);Jn(Da,_i,vs,qo,Ki[Si]=new Array(la),so,bn);for(var bs,na,va=0,Ya=0;va<ys;++va)if(bs=vs[va]){for(va>=Ya&&(Ya=va+1);!(na=qo[Ya])&&++Ya<ys;);bs._next=na||null}}return(Yn=new Ti(Yn,dr))._enter=li,Yn._exit=Ki,Yn},enter:function(){return new Ti(this._enter||this._groups.map(xt),this._parents)},exit:function(){return new Ti(this._exit||this._groups.map(xt),this._parents)},merge:function(Le){for(var bn=this._groups,jn=Le._groups,Jn=bn.length,dr=jn.length,Ur=Math.min(Jn,dr),or=new Array(Jn),Yn=0;Yn<Ur;++Yn)for(var li,Ki=bn[Yn],Si=jn[Yn],Da=Ki.length,_i=or[Yn]=new Array(Da),la=0;la<Da;++la)(li=Ki[la]||Si[la])&&(_i[la]=li);for(;Yn<Jn;++Yn)or[Yn]=bn[Yn];return new Ti(or,this._parents)},order:function(){for(var Le=this._groups,bn=-1,jn=Le.length;++bn<jn;)for(var Jn,dr=Le[bn],Ur=dr.length-1,or=dr[Ur];--Ur>=0;)(Jn=dr[Ur])&&(or&&or!==Jn.nextSibling&&or.parentNode.insertBefore(Jn,or),or=Jn);return this},sort:function(Le){function bn(Da,_i){return Da&&_i?Le(Da.__data__,_i.__data__):!Da-!_i}Le||(Le=Tt);for(var jn=this._groups,Jn=jn.length,dr=new Array(Jn),Ur=0;Ur<Jn;++Ur){for(var or,Yn=jn[Ur],li=Yn.length,Ki=dr[Ur]=new Array(li),Si=0;Si<li;++Si)(or=Yn[Si])&&(Ki[Si]=or);Ki.sort(bn)}return new Ti(dr,this._parents).order()},call:function(){var Le=arguments[0];return arguments[0]=this,Le.apply(null,arguments),this},nodes:function(){var Le=new Array(this.size()),bn=-1;return this.each(function(){Le[++bn]=this}),Le},node:function(){for(var Le=this._groups,bn=0,jn=Le.length;bn<jn;++bn)for(var Jn=Le[bn],dr=0,Ur=Jn.length;dr<Ur;++dr){var or=Jn[dr];if(or)return or}return null},size:function(){var Le=0;return this.each(function(){++Le}),Le},empty:function(){return!this.node()},each:function(Le){for(var bn=this._groups,jn=0,Jn=bn.length;jn<Jn;++jn)for(var dr,Ur=bn[jn],or=0,Yn=Ur.length;or<Yn;++or)(dr=Ur[or])&&Le.call(dr,dr.__data__,or,Ur);return this},attr:function(Le,bn){var jn=K(Le);if(arguments.length<2){var Jn=this.node();return jn.local?Jn.getAttributeNS(jn.space,jn.local):Jn.getAttribute(jn)}return this.each((bn==null?jn.local?It:qt:typeof bn=="function"?jn.local?Qt:Ft:jn.local?vt:St)(jn,bn))},style:function(Le,bn,jn){return arguments.length>1?this.each((bn==null?ge:typeof bn=="function"?Ee:ee)(Le,bn,jn??"")):Bt(this.node(),Le)},property:function(Le,bn){return arguments.length>1?this.each((bn==null?Xt:typeof bn=="function"?ie:we)(Le,bn)):this.node()[Le]},classed:function(Le,bn){var jn=m(Le+"");if(arguments.length<2){for(var Jn=ye(this.node()),dr=-1,Ur=jn.length;++dr<Ur;)if(!Jn.contains(jn[dr]))return!1;return!0}return this.each((typeof bn=="function"?kn:bn?Ye:Ue)(jn,bn))},text:function(Le){return arguments.length?this.each(Le==null?mn:(typeof Le=="function"?Sn:Kn)(Le)):this.node().textContent},html:function(Le){return arguments.length?this.each(Le==null?Wn:(typeof Le=="function"?de:Ze)(Le)):this.node().innerHTML},raise:function(){return this.each(Re)},lower:function(){return this.each(Kt)},append:function(Le){var bn=typeof Le=="function"?Le:X(Le);return this.select(function(){return this.appendChild(bn.apply(this,arguments))})},insert:function(Le,bn){var jn=typeof Le=="function"?Le:X(Le),Jn=bn==null?Jt:typeof bn=="function"?bn:q(bn);return this.select(function(){return this.insertBefore(jn.apply(this,arguments),Jn.apply(this,arguments)||null)})},remove:function(){return this.each(Ae)},clone:function(Le){return this.select(Le?tn:$e)},datum:function(Le){return arguments.length?this.property("__data__",Le):this.node().__data__},on:function(Le,bn,jn){var Jn,dr,Ur=function(Da){return Da.trim().split(/^|\s+/).map(function(_i){var la="",so=_i.indexOf(".");return so>=0&&(la=_i.slice(so+1),_i=_i.slice(0,so)),{type:_i,name:la}})}(Le+""),or=Ur.length;if(!(arguments.length<2)){for(Yn=bn?Sr:_r,jn==null&&(jn=!1),Jn=0;Jn<or;++Jn)this.each(Yn(Ur[Jn],bn,jn));return this}var Yn=this.node().__on;if(Yn){for(var li,Ki=0,Si=Yn.length;Ki<Si;++Ki)for(Jn=0,li=Yn[Ki];Jn<or;++Jn)if((dr=Ur[Jn]).type===li.type&&dr.name===li.name)return li.value}},dispatch:function(Le,bn){return this.each((typeof bn=="function"?Pi:ea)(Le,bn))}};let En=Be;function lr(Le){return typeof Le=="string"?new Ti([[document.querySelector(Le)]],[document.documentElement]):new Ti([[Le]],Cr)}function qn(Le){return lr(X(Le).call(document.documentElement))}var fr=0;function Er(){return new Qr}function Qr(){this._="@"+(++fr).toString(36)}function vi(){for(var Le,bn=Mn;Le=bn.sourceEvent;)bn=Le;return bn}function ua(Le,bn){var jn=Le.ownerSVGElement||Le;if(jn.createSVGPoint){var Jn=jn.createSVGPoint();return Jn.x=bn.clientX,Jn.y=bn.clientY,[(Jn=Jn.matrixTransform(Le.getScreenCTM().inverse())).x,Jn.y]}var dr=Le.getBoundingClientRect();return[bn.clientX-dr.left-Le.clientLeft,bn.clientY-dr.top-Le.clientTop]}function br(Le){var bn=vi();return bn.changedTouches&&(bn=bn.changedTouches[0]),ua(Le,bn)}function eo(Le){return typeof Le=="string"?new Ti([document.querySelectorAll(Le)],[document.documentElement]):new Ti([Le??[]],Cr)}function Fo(Le,bn,jn){arguments.length<3&&(jn=bn,bn=vi().changedTouches);for(var Jn,dr=0,Ur=bn?bn.length:0;dr<Ur;++dr)if((Jn=bn[dr]).identifier===jn)return ua(Le,Jn);return null}function Wa(Le,bn){bn==null&&(bn=vi().touches);for(var jn=0,Jn=bn?bn.length:0,dr=new Array(Jn);jn<Jn;++jn)dr[jn]=ua(Le,bn[jn]);return dr}Qr.prototype=Er.prototype={constructor:Qr,get:function(Le){for(var bn=this._;!(bn in Le);)if(!(Le=Le.parentNode))return;return Le[bn]},set:function(Le,bn){return Le[this._]=bn},remove:function(Le){return this._ in Le&&delete Le[this._]},toString:function(){return this._}}},2017:L=>{L.exports=function O(S,B){if(S===B)return!0;if(S&&B&&typeof S=="object"&&typeof B=="object"){if(S.constructor!==B.constructor)return!1;var j,K,Z;if(Array.isArray(S)){if((j=S.length)!=B.length)return!1;for(K=j;K--!=0;)if(!O(S[K],B[K]))return!1;return!0}if(S.constructor===RegExp)return S.source===B.source&&S.flags===B.flags;if(S.valueOf!==Object.prototype.valueOf)return S.valueOf()===B.valueOf();if(S.toString!==Object.prototype.toString)return S.toString()===B.toString();if((j=(Z=Object.keys(S)).length)!==Object.keys(B).length)return!1;for(K=j;K--!=0;)if(!Object.prototype.hasOwnProperty.call(B,Z[K]))return!1;for(K=j;K--!=0;){var Y=Z[K];if(!O(S[Y],B[Y]))return!1}return!0}return S!=S&&B!=B}},2492:L=>{L.exports=function(O,S){S||(S={}),typeof S=="function"&&(S={cmp:S});var B,j=typeof S.cycles=="boolean"&&S.cycles,K=S.cmp&&(B=S.cmp,function(Y){return function(X,J){var q={key:X,value:Y[X]},H={key:J,value:Y[J]};return B(q,H)}}),Z=[];return function Y(X){if(X&&X.toJSON&&typeof X.toJSON=="function"&&(X=X.toJSON()),X!==void 0){if(typeof X=="number")return isFinite(X)?""+X:"null";if(typeof X!="object")return JSON.stringify(X);var J,q;if(Array.isArray(X)){for(q="[",J=0;J<X.length;J++)J&&(q+=","),q+=Y(X[J])||"null";return q+"]"}if(X===null)return"null";if(Z.indexOf(X)!==-1){if(j)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var H=Z.push(X)-1,tt=Object.keys(X).sort(K&&K(X));for(q="",J=0;J<tt.length;J++){var st=tt[J],lt=Y(X[st]);lt&&(q&&(q+=","),q+=JSON.stringify(st)+":"+lt)}return Z.splice(H,1),"{"+q+"}"}}(O)}},8748:L=>{var O=/-(.)/g;L.exports=function(S){return S.replace(O,function(B,j){return j.toUpperCase()})}},480:(L,O,S)=>{var B=S(8748),j=/^-ms-/;L.exports=function(K){return B(K.replace(j,"ms-"))}},9395:L=>{function O(B){return function(){return B}}var S=function(){};S.thatReturns=O,S.thatReturnsFalse=O(!1),S.thatReturnsTrue=O(!0),S.thatReturnsNull=O(null),S.thatReturnsThis=function(){return this},S.thatReturnsArgument=function(B){return B},L.exports=S},3998:L=>{var O=/([A-Z])/g;L.exports=function(S){return S.replace(O,"-$1").toLowerCase()}},1254:(L,O,S)=>{var B=S(3998),j=/^ms-/;L.exports=function(K){return B(K).replace(j,"-ms-")}},4793:L=>{L.exports=function(O){var S={};return function(B){return S.hasOwnProperty(B)||(S[B]=O.call(this,B)),S[B]}}},4594:(L,O,S)=>{var B=S(9395);L.exports=B},2208:(L,O)=>{Object.defineProperty(O,"__esModule",{value:!0});var S={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},B=["Webkit","ms","Moz","O"];Object.keys(S).forEach(function(K){B.forEach(function(Z){S[function(Y,X){return Y+X.charAt(0).toUpperCase()+X.substring(1)}(Z,K)]=S[K]})});var j={isUnitlessNumber:S,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}};O.default=j},1104:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0});var B=j(S(2208));j(S(4594));function j(Z){return Z&&Z.__esModule?Z:{default:Z}}var K=B.default.isUnitlessNumber;O.default=function(Z,Y,X){return Y==null||typeof Y=="boolean"||Y===""?"":isNaN(Y)||Y===0||K.hasOwnProperty(Z)&&K[Z]?""+Y:(typeof Y=="string"&&(Y=Y.trim()),Y+"px")}},6050:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.processStyleName=void 0,O.createMarkupForStyles=function(X,J){var q="";for(var H in X){var tt=H.indexOf("--")===0;if(X.hasOwnProperty(H)&&H!=="label"){var st=X[H];st!=null&&(tt?q+=H+":"+st+";":(q+=Y(H)+":",q+=(0,B.default)(H,st,J)+";"))}}return q||null},Z(S(480));var B=Z(S(1104)),j=Z(S(1254)),K=Z(S(4793));Z(S(4594));function Z(X){return X&&X.__esModule?X:{default:X}}var Y=O.processStyleName=(0,K.default)(j.default)},5960:(L,O)=>{Object.defineProperty(O,"__esModule",{value:!0});var S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(K){return typeof K}:function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K};function B(K){if(function(tt){return tt==null||tt===!1||(tt===void 0?"undefined":S(tt))==="object"&&Object.keys(tt).length===0}(K))return null;if((K===void 0?"undefined":S(K))!=="object")return K;for(var Z={},Y=Object.keys(K),X=!1,J=0;J<Y.length;J++){var q=K[Y[J]],H=j(q);H!==null&&H===q||(X=!0),H!==null&&(Z[Y[J]]=H)}return Object.keys(Z).length===0?null:X?Z:K}function j(K){return Array.isArray(K)?(Y=!1,X=[],(Z=K).forEach(function(J){var q=j(J);q!==null&&q===J||(Y=!0),q!==null&&X.push(q)}),X.length==0?null:Y?X:Z):B(K);var Z,Y,X}O.default=j},2493:(L,O)=>{function S(K,Z){return K.charCodeAt(Z++)+(K.charCodeAt(Z++)<<8)+(K.charCodeAt(Z++)<<16)+(K.charCodeAt(Z)<<24)}function B(K,Z){return K.charCodeAt(Z++)+(K.charCodeAt(Z++)<<8)}function j(K,Z){return(65535&(K|=0))*(Z|=0)+(((K>>>16)*Z&65535)<<16)|0}Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(K,Z){for(var Y=1540483477,X=Z^K.length,J=K.length,q=0;J>=4;){var H=S(K,q);H=j(H,Y),H=j(H^=H>>>24,Y),X=j(X,Y),X^=H,q+=4,J-=4}switch(J){case 3:X^=B(K,q),X=j(X^=K.charCodeAt(q+2)<<16,Y);break;case 2:X=j(X^=B(K,q),Y);break;case 1:X=j(X^=K.charCodeAt(q),Y)}return X=j(X^=X>>>13,Y),(X^=X>>>15)>>>0}},8205:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.compose=O.merge=O.$=O.style=O.presets=O.keyframes=O.fontFace=O.insertGlobal=O.insertRule=O.plugins=O.styleSheet=void 0,O.speedy=function(de){return H.speedy(de)},O.simulations=function(){var de=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];gt=!!de},O.simulate=function(){for(var de=arguments.length,Re=Array(de),Kt=0;Kt<de;Kt++)Re[Kt]=arguments[Kt];return(Re=(0,Z.default)(Re))?gt?Re.reduce(function(Jt,Ae){return Jt["data-simulate-"+bt(Ae)]="",Jt},{}):(xt||(console.warn("can't simulate without once calling simulations(true)"),xt=!0),st||lt||wt||(console.warn("don't use simulation outside dev"),wt=!0),{}):{}},O.cssLabels=function(de){_t=!!de},O.isLikeRule=qt,O.idFor=It,O.css=Kn,O.rehydrate=function(de){(0,B.default)(ee,de.reduce(function(Re,Kt){return Re[Kt]=!0,Re},{}))},O.flush=function(){ee=H.inserted={},Ee=H.registered={},Xt={},H.flush(),H.inject()},O.select=Wn,O.parent=function(de){for(var Re=arguments.length,Kt=Array(Re>1?Re-1:0),Jt=1;Jt<Re;Jt++)Kt[Jt-1]=arguments[Jt];return Kn(q({},de+" &",Kt))},O.media=function(de){for(var Re=arguments.length,Kt=Array(Re>1?Re-1:0),Jt=1;Jt<Re;Jt++)Kt[Jt-1]=arguments[Jt];return Kn(q({},"@media "+de,Kt))},O.pseudo=Ze,O.active=function(de){return Ze(":active",de)},O.any=function(de){return Ze(":any",de)},O.checked=function(de){return Ze(":checked",de)},O.disabled=function(de){return Ze(":disabled",de)},O.empty=function(de){return Ze(":empty",de)},O.enabled=function(de){return Ze(":enabled",de)},O._default=function(de){return Ze(":default",de)},O.first=function(de){return Ze(":first",de)},O.firstChild=function(de){return Ze(":first-child",de)},O.firstOfType=function(de){return Ze(":first-of-type",de)},O.fullscreen=function(de){return Ze(":fullscreen",de)},O.focus=function(de){return Ze(":focus",de)},O.hover=function(de){return Ze(":hover",de)},O.indeterminate=function(de){return Ze(":indeterminate",de)},O.inRange=function(de){return Ze(":in-range",de)},O.invalid=function(de){return Ze(":invalid",de)},O.lastChild=function(de){return Ze(":last-child",de)},O.lastOfType=function(de){return Ze(":last-of-type",de)},O.left=function(de){return Ze(":left",de)},O.link=function(de){return Ze(":link",de)},O.onlyChild=function(de){return Ze(":only-child",de)},O.onlyOfType=function(de){return Ze(":only-of-type",de)},O.optional=function(de){return Ze(":optional",de)},O.outOfRange=function(de){return Ze(":out-of-range",de)},O.readOnly=function(de){return Ze(":read-only",de)},O.readWrite=function(de){return Ze(":read-write",de)},O.required=function(de){return Ze(":required",de)},O.right=function(de){return Ze(":right",de)},O.root=function(de){return Ze(":root",de)},O.scope=function(de){return Ze(":scope",de)},O.target=function(de){return Ze(":target",de)},O.valid=function(de){return Ze(":valid",de)},O.visited=function(de){return Ze(":visited",de)},O.dir=function(de,Re){return Ze(":dir("+de+")",Re)},O.lang=function(de,Re){return Ze(":lang("+de+")",Re)},O.not=function(de,Re){var Kt=de.split(",").map(function(Jt){return Jt.trim()}).map(function(Jt){return":not("+Jt+")"});return Kt.length===1?Ze(":not("+de+")",Re):Wn(Kt.join(""),Re)},O.nthChild=function(de,Re){return Ze(":nth-child("+de+")",Re)},O.nthLastChild=function(de,Re){return Ze(":nth-last-child("+de+")",Re)},O.nthLastOfType=function(de,Re){return Ze(":nth-last-of-type("+de+")",Re)},O.nthOfType=function(de,Re){return Ze(":nth-of-type("+de+")",Re)},O.after=function(de){return Ze("::after",de)},O.before=function(de){return Ze("::before",de)},O.firstLetter=function(de){return Ze("::first-letter",de)},O.firstLine=function(de){return Ze("::first-line",de)},O.selection=function(de){return Ze("::selection",de)},O.backdrop=function(de){return Ze("::backdrop",de)},O.placeholder=function(de){return Kn({"::placeholder":de})},O.cssFor=function(){for(var de=arguments.length,Re=Array(de),Kt=0;Kt<de;Kt++)Re[Kt]=arguments[Kt];return(Re=(0,Z.default)(Re))?Re.map(function(Jt){var Ae={label:[]};return te(Ae,{src:Jt}),ge(Tt(Ae),Gt(Ae)).join("")}).join(""):""},O.attribsFor=function(){for(var de=arguments.length,Re=Array(de),Kt=0;Kt<de;Kt++)Re[Kt]=arguments[Kt];return(Re=(0,Z.default)(Re))?Re.map(function(Jt){It(Jt);var Ae=Object.keys(Jt)[0];return Ae+'="'+(Jt[Ae]||"")+'"'}).join(" "):""};var B=J(S(5228)),j=S(6314),K=S(6050),Z=J(S(5960)),Y=S(7769),X=J(S(2493));function J(de){return de&&de.__esModule?de:{default:de}}function q(de,Re,Kt){return Re in de?Object.defineProperty(de,Re,{value:Kt,enumerable:!0,configurable:!0,writable:!0}):de[Re]=Kt,de}var H=O.styleSheet=new j.StyleSheet;H.inject();var tt=O.plugins=H.plugins=new Y.PluginSet([Y.prefixes,Y.contentWrap,Y.fallbacks]);tt.media=new Y.PluginSet,tt.fontFace=new Y.PluginSet,tt.keyframes=new Y.PluginSet([Y.prefixes,Y.fallbacks]);var st=!1,lt=!1,ft=typeof window<"u",gt=st,xt=!1,wt=!1,_t=st;function bt(de){var Re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return de.toLowerCase().replace(/[^a-z0-9]/g,Re)}function Tt(de){var Re=JSON.stringify(de),Kt=(0,X.default)(Re).toString(36);return de.label&&de.label.length>0&&st?bt(de.label.join("."),"-")+"-"+Kt:Kt}function qt(de){var Re=Object.keys(de).filter(function(Kt){return Kt!=="toString"});return Re.length===1&&!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(Re[0])}function It(de){var Re=Object.keys(de).filter(function(Jt){return Jt!=="toString"});if(Re.length!==1)throw new Error("not a rule");var Kt=/data\-css\-([a-zA-Z0-9\-_]+)/.exec(Re[0]);if(!Kt)throw new Error("not a rule");return Kt[1]}var St=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function vt(de){if(de.indexOf(",")===-1)return[de];for(var Re,Kt=[],Jt=[],Ae=0;Re=St.exec(de);)switch(Re[0]){case"(":Ae++;break;case")":Ae--;break;case",":if(Ae)break;Kt.push(Re.index)}for(Re=Kt.length;Re--;)Jt.unshift(de.slice(Kt[Re]+1)),de=de.slice(0,Kt[Re]);return Jt.unshift(de),Jt}function Ft(de,Re){if(!de)return Re.replace(/\&/g,"");if(!Re)return".css-"+de+",[data-css-"+de+"]";var Kt=vt(Re).map(function(Jt){return Jt.indexOf("&")>=0?[Jt.replace(/\&/gm,".css-"+de),Jt.replace(/\&/gm,"[data-css-"+de+"]")].join(","):".css-"+de+Jt+",[data-css-"+de+"]"+Jt}).join(",");return gt&&/^\&\:/.exec(Re)&&!/\s/.exec(Re)&&(Kt+=",.css-"+de+"[data-simulate-"+bt(Re)+"],[data-css-"+de+"][data-simulate-"+bt(Re)+"]"),Kt}function Qt(de){var Re=de.selector,Kt=de.style,Jt=tt.transform({selector:Re,style:Kt});return Jt.selector+"{"+(0,K.createMarkupForStyles)(Jt.style)+"}"}function Gt(de){var Re=void 0,Kt=void 0,Jt=void 0,Ae=void 0;return Object.keys(de).forEach(function($e){$e.indexOf("&")>=0?(Kt=Kt||{})[$e]=de[$e]:$e.indexOf("@media")===0?(Jt=Jt||{})[$e]=Gt(de[$e]):$e.indexOf("@supports")===0?(Ae=Ae||{})[$e]=Gt(de[$e]):$e==="label"?de.label.length>0&&((Re=Re||{}).label=_t?de.label.join("."):""):(Re=Re||{})[$e]=de[$e]}),{plain:Re,selects:Kt,medias:Jt,supports:Ae}}function ge(de,Re){var Kt=[],Jt=Re.plain,Ae=Re.selects,$e=Re.medias,tn=Re.supports;return Jt&&Kt.push(Qt({style:Jt,selector:Ft(de)})),Ae&&Object.keys(Ae).forEach(function(wn){return Kt.push(Qt({style:Ae[wn],selector:Ft(de,wn)}))}),$e&&Object.keys($e).forEach(function(wn){return Kt.push(wn+"{"+ge(de,$e[wn]).join("")+"}")}),tn&&Object.keys(tn).forEach(function(wn){return Kt.push(wn+"{"+ge(de,tn[wn]).join("")+"}")}),Kt}var ee=H.inserted={},Ee=H.registered={};function Bt(de){Ee[de.id]||(Ee[de.id]=de)}var Xt={};function we(de){if(Bt(de),function(Kt){if(!ee[Kt.id]){ee[Kt.id]=!0;var Jt=Gt(Kt.style),Ae=ge(Kt.id,Jt);ee[Kt.id]=!!ft||Ae,Ae.forEach(function($e){return H.insert($e)})}}(de),Xt[de.id])return Xt[de.id];var Re=q({},"data-css-"+de.id,_t&&de.label||"");return Object.defineProperty(Re,"toString",{enumerable:!1,value:function(){return"css-"+de.id}}),Xt[de.id]=Re,Re}function ie(de,Re){var Kt=vt(de).map(function(Ae){return Ae.indexOf("&")>=0?Ae:"&"+Ae}),Jt=vt(Re).map(function(Ae){return Ae.indexOf("&")>=0?Ae:"&"+Ae});return Jt.reduce(function(Ae,$e){return Ae.concat(Kt.map(function(tn){return $e.replace(/\&/g,tn)}))},[]).join(",")}function m(de,Re){return de?"@supports "+de.substring(9)+" and "+Re.substring(9):Re}function ye(de){for(var Re=[],Kt=0;Kt<de.length;Kt++)Re=Array.isArray(de[Kt])?Re.concat(ye(de[Kt])):Re.concat(de[Kt]);return Re}var Ge={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function te(de,Re){var Kt=Re.selector,Jt=Kt===void 0?"":Kt,Ae=Re.mq,$e=Ae===void 0?"":Ae,tn=Re.supp,wn=tn===void 0?"":tn,Mn=Re.src,Hn=Mn===void 0?{}:Mn;Array.isArray(Hn)||(Hn=[Hn]),(Hn=ye(Hn)).forEach(function(Zn){if(qt(Zn)){var _r=function(Sr){if(qt(Sr)){var Mr=Ee[It(Sr)];if(Mr==null)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return Mr}return Sr}(Zn);if(_r.type!=="css")throw new Error("cannot merge this rule");Zn=_r.style}(Zn=(0,Z.default)(Zn))&&Zn.composes&&te(de,{selector:Jt,mq:$e,supp:wn,src:Zn.composes}),Object.keys(Zn||{}).forEach(function(Sr){if(function(Pi){for(var Cr=[":",".","[",">"," "],Ti=!1,Be=Pi.charAt(0),En=0;En<Cr.length;En++)if(Be===Cr[En]){Ti=!0;break}return Ti||Pi.indexOf("&")>=0}(Sr))Ge[Sr]&&Ge[Sr].forEach(function(Pi){return te(de,{selector:ie(Jt,Pi),mq:$e,supp:wn,src:Zn[Sr]})}),te(de,{selector:ie(Jt,Sr),mq:$e,supp:wn,src:Zn[Sr]});else if(function(Pi){return Pi.indexOf("@media")===0}(Sr))te(de,{selector:Jt,mq:(ai=$e,ea=Sr,ai?"@media "+ai.substring(6)+" and "+ea.substring(6):ea),supp:wn,src:Zn[Sr]});else if(function(Pi){return Pi.indexOf("@supports")===0}(Sr))te(de,{selector:Jt,mq:$e,supp:m(wn,Sr),src:Zn[Sr]});else if(Sr!=="composes"){var Mr=de;wn&&(Mr[wn]=Mr[wn]||{},Mr=Mr[wn]),$e&&(Mr[$e]=Mr[$e]||{},Mr=Mr[$e]),Jt&&(Mr[Jt]=Mr[Jt]||{},Mr=Mr[Jt]),Sr==="label"?_t&&(de.label=de.label.concat(Zn.label)):Mr[Sr]=Zn[Sr]}var ai,ea})})}function Me(de){var Re={label:[]};return te(Re,{src:de}),we({id:Tt(Re),style:Re,label:_t?Re.label.join("."):"",type:"css"})}var Ye={};Object.defineProperty(Ye,"toString",{enumerable:!1,value:function(){return"css-nil"}});var Ue=typeof WeakMap<"u"?[Ye,new WeakMap,new WeakMap,new WeakMap]:[Ye],kn,mn=typeof WeakMap<"u"?(kn=Me,function(de){if(Ue[de.length]){for(var Re=Ue[de.length],Kt=0;Kt<de.length-1;)Re.has(de[Kt])||Re.set(de[Kt],new WeakMap),Re=Re.get(de[Kt]),Kt++;if(Re.has(de[de.length-1])){var Jt=Re.get(de[Kt]);if(Ee[Jt.toString().substring(4)])return Jt}}var Ae=kn(de);if(Ue[de.length]){for(var $e=0,tn=Ue[de.length];$e<de.length-1;)tn=tn.get(de[$e]),$e++;try{tn.set(de[$e],Ae)}catch{}}return Ae}):Me;function Kn(){for(var de=arguments.length,Re=Array(de),Kt=0;Kt<de;Kt++)Re[Kt]=arguments[Kt];if(Re[0]&&Re[0].length&&Re[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return(Re=(0,Z.default)(Re))?mn(Re):Ye}Kn.insert=function(de){var Re={id:Tt(de),css:de,type:"raw"};Bt(Re),ee[Re.id]||(H.insert(Re.css),ee[Re.id]=!!ft||[Re.css])},O.insertRule=Kn.insert,Kn.global=function(de,Re){if(Re=(0,Z.default)(Re))return Kn.insert(Qt({selector:de,style:Re}))},O.insertGlobal=Kn.global,Kn.keyframes=function(de,Re){Re||(Re=de,de="animation");var Kt={id:Tt({name:de,kfs:Re=(0,Z.default)(Re)||{}}),type:"keyframes",name:de,keyframes:Re};return Bt(Kt),function(Jt){if(!ee[Jt.id]){var Ae=Object.keys(Jt.keyframes).map(function(tn){var wn=tt.keyframes.transform({id:Jt.id,name:tn,style:Jt.keyframes[tn]});return wn.name+"{"+(0,K.createMarkupForStyles)(wn.style)+"}"}).join(""),$e=["-webkit-","-moz-","-o-",""].map(function(tn){return"@"+tn+"keyframes "+Jt.name+"_"+Jt.id+"{"+Ae+"}"});$e.forEach(function(tn){return H.insert(tn)}),ee[Jt.id]=!!ft||$e}}(Kt),de+"_"+Kt.id},Kn.fontFace=function(de){var Re={id:Tt(de=(0,Z.default)(de)),type:"font-face",font:de};return Bt(Re),function(Kt){if(!ee[Kt.id]){var Jt="@font-face{"+(0,K.createMarkupForStyles)(Kt.font)+"}";H.insert(Jt),ee[Kt.id]=!!ft||[Jt]}}(Re),de.fontFamily},O.fontFace=Kn.fontFace,O.keyframes=Kn.keyframes,O.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var Sn=O.style=Kn;function Wn(de){for(var Re=arguments.length,Kt=Array(Re>1?Re-1:0),Jt=1;Jt<Re;Jt++)Kt[Jt-1]=arguments[Jt];return de?Kn(q({},de,Kt)):Sn(Kt)}O.$=Wn,O.merge=Kn,O.compose=Kn;function Ze(de){for(var Re=arguments.length,Kt=Array(Re>1?Re-1:0),Jt=1;Jt<Re;Jt++)Kt[Jt-1]=arguments[Jt];return Kn(q({},de,Kt))}},7769:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0});var B=Object.assign||function(q){for(var H=1;H<arguments.length;H++){var tt=arguments[H];for(var st in tt)Object.prototype.hasOwnProperty.call(tt,st)&&(q[st]=tt[st])}return q};O.PluginSet=X,O.fallbacks=function(q){if(Object.keys(q.style).map(function(st){return Array.isArray(q.style[st])}).indexOf(!0)>=0){var H=q.style,tt=Object.keys(H).reduce(function(st,lt){return st[lt]=Array.isArray(H[lt])?H[lt].join("; "+(0,K.processStyleName)(lt)+": "):H[lt],st},{});return(0,j.default)({},q,{style:tt})}return q},O.contentWrap=function(q){if(q.style.content){var H=q.style.content;return J.indexOf(H)>=0||/^(attr|calc|counters?|url)\(/.test(H)?q:H.charAt(0)!==H.charAt(H.length-1)||H.charAt(0)!=='"'&&H.charAt(0)!=="'"?B({},q,{style:B({},q.style,{content:'"'+H+'"'})}):q}return q},O.prefixes=function(q){return(0,j.default)({},q,{style:(0,Z.default)(B({},q.style))})};var j=Y(S(5228)),K=S(6050),Z=Y(S(9654));function Y(q){return q&&q.__esModule?q:{default:q}}function X(q){this.fns=q||[]}(0,j.default)(X.prototype,{add:function(){for(var q=this,H=arguments.length,tt=Array(H),st=0;st<H;st++)tt[st]=arguments[st];tt.forEach(function(lt){q.fns.indexOf(lt)>=0||(q.fns=[lt].concat(q.fns))})},remove:function(q){this.fns=this.fns.filter(function(H){return H!==q})},clear:function(){this.fns=[]},transform:function(q){return this.fns.reduce(function(H,tt){return tt(H)},q)}});var J=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"]},9654:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(_t){for(var bt in _t){var Tt=_t[bt],qt=(0,K.default)(xt,bt,Tt,_t,wt);qt&&(_t[bt]=qt),(0,j.default)(wt,bt,_t)}return _t};var B=gt(S(113)),j=gt(S(4397)),K=gt(S(6127)),Z=gt(S(1244)),Y=gt(S(3038)),X=gt(S(436)),J=gt(S(1421)),q=gt(S(807)),H=gt(S(5086)),tt=gt(S(7637)),st=gt(S(8877)),lt=gt(S(4796)),ft=gt(S(5309));function gt(_t){return _t&&_t.__esModule?_t:{default:_t}}var xt=[Y.default,Z.default,X.default,q.default,H.default,tt.default,st.default,lt.default,ft.default,J.default],wt=B.default.prefixMap},6314:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.StyleSheet=H;var B,j=S(5228),K=(B=j)&&B.__esModule?B:{default:B};function Z(tt){return tt[tt.length-1]}function Y(tt){if(tt.sheet)return tt.sheet;for(var st=0;st<document.styleSheets.length;st++)if(document.styleSheets[st].ownerNode===tt)return document.styleSheets[st]}var X=typeof window<"u",J=function(){if(X){var tt=document.createElement("div");return tt.innerHTML="<!--[if lt IE 10]><i></i><![endif]-->",tt.getElementsByTagName("i").length===1}}();function q(){var tt=document.createElement("style");return tt.type="text/css",tt.setAttribute("data-glamor",""),tt.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(tt),tt}function H(){var tt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},st=tt.speedy,lt=st===void 0?!0:st,ft=tt.maxLength,gt=ft===void 0?X&&J?4e3:65e3:ft;this.isSpeedy=lt,this.sheet=void 0,this.tags=[],this.maxLength=gt,this.ctr=0}(0,K.default)(H.prototype,{getSheet:function(){return Y(Z(this.tags))},inject:function(){var tt=this;if(this.injected)throw new Error("already injected stylesheet!");X?this.tags[0]=q():this.sheet={cssRules:[],insertRule:function(st){tt.sheet.cssRules.push({cssText:st})}},this.injected=!0},speedy:function(tt){if(this.ctr!==0)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+tt+") earlier in your app, or call flush() before speedy("+tt+")");this.isSpeedy=!!tt},_insert:function(tt){try{var st=this.getSheet();st.insertRule(tt,tt.indexOf("@import")!==-1?0:st.cssRules.length)}catch{}},insert:function(tt){if(X)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(tt);else if(tt.indexOf("@import")!==-1){var st=Z(this.tags);st.insertBefore(document.createTextNode(tt),st.firstChild)}else Z(this.tags).appendChild(document.createTextNode(tt));else this.sheet.insertRule(tt,tt.indexOf("@import")!==-1?0:this.sheet.cssRules.length);return this.ctr++,X&&this.ctr%this.maxLength==0&&this.tags.push(q()),this.ctr-1},delete:function(tt){return this.replace(tt,"")},flush:function(){X?(this.tags.forEach(function(tt){return tt.parentNode.removeChild(tt)}),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!X)return this.sheet.cssRules;var tt=[];return this.tags.forEach(function(st){return tt.splice.apply(tt,[tt.length,0].concat(function(lt){if(Array.isArray(lt)){for(var ft=0,gt=Array(lt.length);ft<lt.length;ft++)gt[ft]=lt[ft];return gt}return Array.from(lt)}(Array.from(Y(st).cssRules))))}),tt}})},8066:(L,O,S)=>{S.r(O),S.d(O,{default:()=>Y});var B=/[A-Z]/g,j=/^ms-/,K={};function Z(X){return"-"+X.toLowerCase()}let Y=function(X){if(K.hasOwnProperty(X))return K[X];var J=X.replace(B,Z);return K[X]=j.test(J)?"-"+J:J}},3038:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(Y,X){if(typeof X=="string"&&!(0,K.default)(X)&&X.indexOf("cross-fade(")>-1)return Z.map(function(J){return X.replace(/cross-fade\(/g,J+"cross-fade(")})};var B,j=S(4014),K=(B=j)&&B.__esModule?B:{default:B},Z=["-webkit-",""];L.exports=O.default},1244:(L,O)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(j,K){if(j==="cursor"&&B.hasOwnProperty(K))return S.map(function(Z){return Z+K})};var S=["-webkit-","-moz-",""],B={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};L.exports=O.default},436:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(Y,X){if(typeof X=="string"&&!(0,K.default)(X)&&X.indexOf("filter(")>-1)return Z.map(function(J){return X.replace(/filter\(/g,J+"filter(")})};var B,j=S(4014),K=(B=j)&&B.__esModule?B:{default:B},Z=["-webkit-",""];L.exports=O.default},1421:(L,O)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(B,j){if(B==="display"&&S.hasOwnProperty(j))return S[j]};var S={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};L.exports=O.default},807:(L,O)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(j,K,Z){j==="flexDirection"&&typeof K=="string"&&(K.indexOf("column")>-1?Z.WebkitBoxOrient="vertical":Z.WebkitBoxOrient="horizontal",K.indexOf("reverse")>-1?Z.WebkitBoxDirection="reverse":Z.WebkitBoxDirection="normal"),B.hasOwnProperty(j)&&(Z[B[j]]=S[K]||K)};var S={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},B={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};L.exports=O.default},5086:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(X,J){if(typeof J=="string"&&!(0,K.default)(J)&&Y.test(J))return Z.map(function(q){return q+J})};var B,j=S(4014),K=(B=j)&&B.__esModule?B:{default:B},Z=["-webkit-","-moz-",""],Y=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;L.exports=O.default},7637:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(Y,X){if(typeof X=="string"&&!(0,K.default)(X)&&X.indexOf("image-set(")>-1)return Z.map(function(J){return X.replace(/image-set\(/g,J+"image-set(")})};var B,j=S(4014),K=(B=j)&&B.__esModule?B:{default:B},Z=["-webkit-",""];L.exports=O.default},8877:(L,O)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(S,B){if(S==="position"&&B==="sticky")return["-webkit-sticky","sticky"]},L.exports=O.default},4796:(L,O)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(K,Z){if(B.hasOwnProperty(K)&&j.hasOwnProperty(Z))return S.map(function(Y){return Y+Z})};var S=["-webkit-","-moz-",""],B={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},j={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};L.exports=O.default},5309:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(J,q,H,tt){if(typeof q=="string"&&Y.hasOwnProperty(J)){var st=function(gt,xt){if((0,j.default)(gt))return gt;for(var wt=gt.split(/,(?![^()]*(?:\([^()]*\))?\))/g),_t=0,bt=wt.length;_t<bt;++_t){var Tt=wt[_t],qt=[Tt];for(var It in xt){var St=(0,B.default)(It);if(Tt.indexOf(St)>-1&&St!=="order")for(var vt=xt[It],Ft=0,Qt=vt.length;Ft<Qt;++Ft)qt.unshift(Tt.replace(St,X[vt[Ft]]+St))}wt[_t]=qt.join(",")}return wt.join(",")}(q,tt),lt=st.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(gt){return!/-moz-|-ms-/.test(gt)}).join(",");if(J.indexOf("Webkit")>-1)return lt;var ft=st.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(gt){return!/-webkit-|-ms-/.test(gt)}).join(",");return J.indexOf("Moz")>-1?ft:(H["Webkit"+(0,K.default)(J)]=lt,H["Moz"+(0,K.default)(J)]=ft,st)}};var B=Z(S(5721)),j=Z(S(4014)),K=Z(S(7479));function Z(J){return J&&J.__esModule?J:{default:J}}var Y={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},X={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};L.exports=O.default},113:(L,O)=>{Object.defineProperty(O,"__esModule",{value:!0});var S=["Webkit"],B=["Moz"],j=["ms"],K=["Webkit","Moz"],Z=["Webkit","ms"],Y=["Webkit","Moz","ms"];O.default={plugins:[],prefixMap:{appearance:K,userSelect:Y,textEmphasisPosition:S,textEmphasis:S,textEmphasisStyle:S,textEmphasisColor:S,boxDecorationBreak:S,clipPath:S,maskImage:S,maskMode:S,maskRepeat:S,maskPosition:S,maskClip:S,maskOrigin:S,maskSize:S,maskComposite:S,mask:S,maskBorderSource:S,maskBorderMode:S,maskBorderSlice:S,maskBorderWidth:S,maskBorderOutset:S,maskBorderRepeat:S,maskBorder:S,maskType:S,textDecorationStyle:S,textDecorationSkip:S,textDecorationLine:S,textDecorationColor:S,filter:S,fontFeatureSettings:S,breakAfter:Y,breakBefore:Y,breakInside:Y,columnCount:K,columnFill:K,columnGap:K,columnRule:K,columnRuleColor:K,columnRuleStyle:K,columnRuleWidth:K,columns:K,columnSpan:K,columnWidth:K,writingMode:Z,flex:S,flexBasis:S,flexDirection:S,flexGrow:S,flexFlow:S,flexShrink:S,flexWrap:S,alignContent:S,alignItems:S,alignSelf:S,justifyContent:S,order:S,transform:S,transformOrigin:S,transformOriginX:S,transformOriginY:S,backfaceVisibility:S,perspective:S,perspectiveOrigin:S,transformStyle:S,transformOriginZ:S,animation:S,animationDelay:S,animationDirection:S,animationFillMode:S,animationDuration:S,animationIterationCount:S,animationName:S,animationPlayState:S,animationTimingFunction:S,backdropFilter:S,fontKerning:S,scrollSnapType:Z,scrollSnapPointsX:Z,scrollSnapPointsY:Z,scrollSnapDestination:Z,scrollSnapCoordinate:Z,shapeImageThreshold:S,shapeImageMargin:S,shapeImageOutside:S,hyphens:Y,flowInto:Z,flowFrom:Z,regionFragment:Z,textAlignLast:B,tabSize:B,wrapFlow:j,wrapThrough:j,wrapMargin:j,gridTemplateColumns:j,gridTemplateRows:j,gridTemplateAreas:j,gridTemplate:j,gridAutoColumns:j,gridAutoRows:j,gridAutoFlow:j,grid:j,gridRowStart:j,gridColumnStart:j,gridRowEnd:j,gridRow:j,gridColumn:j,gridColumnEnd:j,gridColumnGap:j,gridRowGap:j,gridArea:j,gridGap:j,textSizeAdjust:Z,borderImage:S,borderImageOutset:S,borderImageRepeat:S,borderImageSlice:S,borderImageSource:S,borderImageWidth:S,transitionDelay:S,transitionDuration:S,transitionProperty:S,transitionTimingFunction:S}},L.exports=O.default},7479:(L,O)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(S){return S.charAt(0).toUpperCase()+S.slice(1)},L.exports=O.default},4397:(L,O,S)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(Z,Y,X){if(Z.hasOwnProperty(Y))for(var J=Z[Y],q=0,H=J.length;q<H;++q)X[J[q]+(0,K.default)(Y)]=X[Y]};var B,j=S(7479),K=(B=j)&&B.__esModule?B:{default:B};L.exports=O.default},6127:(L,O)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(S,B,j,K,Z){for(var Y=0,X=S.length;Y<X;++Y){var J=S[Y](B,j,K,Z);if(J)return J}},L.exports=O.default},8570:L=>{L.exports=S;var O=null;try{O=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function S(vt,Ft,Qt){this.low=0|vt,this.high=0|Ft,this.unsigned=!!Qt}function B(vt){return(vt&&vt.__isLong__)===!0}Object.defineProperty(S.prototype,"__isLong__",{value:!0}),S.isLong=B;var j={},K={};function Z(vt,Ft){var Qt,Gt,ge;return Ft?(ge=0<=(vt>>>=0)&&vt<256)&&(Gt=K[vt])?Gt:(Qt=X(vt,(0|vt)<0?-1:0,!0),ge&&(K[vt]=Qt),Qt):(ge=-128<=(vt|=0)&&vt<128)&&(Gt=j[vt])?Gt:(Qt=X(vt,vt<0?-1:0,!1),ge&&(j[vt]=Qt),Qt)}function Y(vt,Ft){if(isNaN(vt))return Ft?xt:gt;if(Ft){if(vt<0)return xt;if(vt>=st)return qt}else{if(vt<=-9223372036854776e3)return It;if(vt+1>=lt)return Tt}return vt<0?Y(-vt,Ft).neg():X(vt%tt|0,vt/tt|0,Ft)}function X(vt,Ft,Qt){return new S(vt,Ft,Qt)}S.fromInt=Z,S.fromNumber=Y,S.fromBits=X;var J=Math.pow;function q(vt,Ft,Qt){if(vt.length===0)throw Error("empty string");if(vt==="NaN"||vt==="Infinity"||vt==="+Infinity"||vt==="-Infinity")return gt;if(typeof Ft=="number"?(Qt=Ft,Ft=!1):Ft=!!Ft,(Qt=Qt||10)<2||36<Qt)throw RangeError("radix");var Gt;if((Gt=vt.indexOf("-"))>0)throw Error("interior hyphen");if(Gt===0)return q(vt.substring(1),Ft,Qt).neg();for(var ge=Y(J(Qt,8)),ee=gt,Ee=0;Ee<vt.length;Ee+=8){var Bt=Math.min(8,vt.length-Ee),Xt=parseInt(vt.substring(Ee,Ee+Bt),Qt);if(Bt<8){var we=Y(J(Qt,Bt));ee=ee.mul(we).add(Y(Xt))}else ee=(ee=ee.mul(ge)).add(Y(Xt))}return ee.unsigned=Ft,ee}function H(vt,Ft){return typeof vt=="number"?Y(vt,Ft):typeof vt=="string"?q(vt,Ft):X(vt.low,vt.high,typeof Ft=="boolean"?Ft:vt.unsigned)}S.fromString=q,S.fromValue=H;var tt=4294967296,st=tt*tt,lt=st/2,ft=Z(1<<24),gt=Z(0);S.ZERO=gt;var xt=Z(0,!0);S.UZERO=xt;var wt=Z(1);S.ONE=wt;var _t=Z(1,!0);S.UONE=_t;var bt=Z(-1);S.NEG_ONE=bt;var Tt=X(-1,2147483647,!1);S.MAX_VALUE=Tt;var qt=X(-1,-1,!0);S.MAX_UNSIGNED_VALUE=qt;var It=X(0,-2147483648,!1);S.MIN_VALUE=It;var St=S.prototype;St.toInt=function(){return this.unsigned?this.low>>>0:this.low},St.toNumber=function(){return this.unsigned?(this.high>>>0)*tt+(this.low>>>0):this.high*tt+(this.low>>>0)},St.toString=function(vt){if((vt=vt||10)<2||36<vt)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(It)){var Ft=Y(vt),Qt=this.div(Ft),Gt=Qt.mul(Ft).sub(this);return Qt.toString(vt)+Gt.toInt().toString(vt)}return"-"+this.neg().toString(vt)}for(var ge=Y(J(vt,6),this.unsigned),ee=this,Ee="";;){var Bt=ee.div(ge),Xt=(ee.sub(Bt.mul(ge)).toInt()>>>0).toString(vt);if((ee=Bt).isZero())return Xt+Ee;for(;Xt.length<6;)Xt="0"+Xt;Ee=""+Xt+Ee}},St.getHighBits=function(){return this.high},St.getHighBitsUnsigned=function(){return this.high>>>0},St.getLowBits=function(){return this.low},St.getLowBitsUnsigned=function(){return this.low>>>0},St.getNumBitsAbs=function(){if(this.isNegative())return this.eq(It)?64:this.neg().getNumBitsAbs();for(var vt=this.high!=0?this.high:this.low,Ft=31;Ft>0&&!(vt&1<<Ft);Ft--);return this.high!=0?Ft+33:Ft+1},St.isZero=function(){return this.high===0&&this.low===0},St.eqz=St.isZero,St.isNegative=function(){return!this.unsigned&&this.high<0},St.isPositive=function(){return this.unsigned||this.high>=0},St.isOdd=function(){return!(1&~this.low)},St.isEven=function(){return!(1&this.low)},St.equals=function(vt){return B(vt)||(vt=H(vt)),(this.unsigned===vt.unsigned||this.high>>>31!=1||vt.high>>>31!=1)&&this.high===vt.high&&this.low===vt.low},St.eq=St.equals,St.notEquals=function(vt){return!this.eq(vt)},St.neq=St.notEquals,St.ne=St.notEquals,St.lessThan=function(vt){return this.comp(vt)<0},St.lt=St.lessThan,St.lessThanOrEqual=function(vt){return this.comp(vt)<=0},St.lte=St.lessThanOrEqual,St.le=St.lessThanOrEqual,St.greaterThan=function(vt){return this.comp(vt)>0},St.gt=St.greaterThan,St.greaterThanOrEqual=function(vt){return this.comp(vt)>=0},St.gte=St.greaterThanOrEqual,St.ge=St.greaterThanOrEqual,St.compare=function(vt){if(B(vt)||(vt=H(vt)),this.eq(vt))return 0;var Ft=this.isNegative(),Qt=vt.isNegative();return Ft&&!Qt?-1:!Ft&&Qt?1:this.unsigned?vt.high>>>0>this.high>>>0||vt.high===this.high&&vt.low>>>0>this.low>>>0?-1:1:this.sub(vt).isNegative()?-1:1},St.comp=St.compare,St.negate=function(){return!this.unsigned&&this.eq(It)?It:this.not().add(wt)},St.neg=St.negate,St.add=function(vt){B(vt)||(vt=H(vt));var Ft=this.high>>>16,Qt=65535&this.high,Gt=this.low>>>16,ge=65535&this.low,ee=vt.high>>>16,Ee=65535&vt.high,Bt=vt.low>>>16,Xt=0,we=0,ie=0,m=0;return ie+=(m+=ge+(65535&vt.low))>>>16,we+=(ie+=Gt+Bt)>>>16,Xt+=(we+=Qt+Ee)>>>16,Xt+=Ft+ee,X((ie&=65535)<<16|(m&=65535),(Xt&=65535)<<16|(we&=65535),this.unsigned)},St.subtract=function(vt){return B(vt)||(vt=H(vt)),this.add(vt.neg())},St.sub=St.subtract,St.multiply=function(vt){if(this.isZero())return gt;if(B(vt)||(vt=H(vt)),O)return X(O.mul(this.low,this.high,vt.low,vt.high),O.get_high(),this.unsigned);if(vt.isZero())return gt;if(this.eq(It))return vt.isOdd()?It:gt;if(vt.eq(It))return this.isOdd()?It:gt;if(this.isNegative())return vt.isNegative()?this.neg().mul(vt.neg()):this.neg().mul(vt).neg();if(vt.isNegative())return this.mul(vt.neg()).neg();if(this.lt(ft)&&vt.lt(ft))return Y(this.toNumber()*vt.toNumber(),this.unsigned);var Ft=this.high>>>16,Qt=65535&this.high,Gt=this.low>>>16,ge=65535&this.low,ee=vt.high>>>16,Ee=65535&vt.high,Bt=vt.low>>>16,Xt=65535&vt.low,we=0,ie=0,m=0,ye=0;return m+=(ye+=ge*Xt)>>>16,ie+=(m+=Gt*Xt)>>>16,m&=65535,ie+=(m+=ge*Bt)>>>16,we+=(ie+=Qt*Xt)>>>16,ie&=65535,we+=(ie+=Gt*Bt)>>>16,ie&=65535,we+=(ie+=ge*Ee)>>>16,we+=Ft*Xt+Qt*Bt+Gt*Ee+ge*ee,X((m&=65535)<<16|(ye&=65535),(we&=65535)<<16|(ie&=65535),this.unsigned)},St.mul=St.multiply,St.divide=function(vt){if(B(vt)||(vt=H(vt)),vt.isZero())throw Error("division by zero");var Ft,Qt,Gt;if(O)return this.unsigned||this.high!==-2147483648||vt.low!==-1||vt.high!==-1?X((this.unsigned?O.div_u:O.div_s)(this.low,this.high,vt.low,vt.high),O.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?xt:gt;if(this.unsigned){if(vt.unsigned||(vt=vt.toUnsigned()),vt.gt(this))return xt;if(vt.gt(this.shru(1)))return _t;Gt=xt}else{if(this.eq(It))return vt.eq(wt)||vt.eq(bt)?It:vt.eq(It)?wt:(Ft=this.shr(1).div(vt).shl(1)).eq(gt)?vt.isNegative()?wt:bt:(Qt=this.sub(vt.mul(Ft)),Gt=Ft.add(Qt.div(vt)));if(vt.eq(It))return this.unsigned?xt:gt;if(this.isNegative())return vt.isNegative()?this.neg().div(vt.neg()):this.neg().div(vt).neg();if(vt.isNegative())return this.div(vt.neg()).neg();Gt=gt}for(Qt=this;Qt.gte(vt);){Ft=Math.max(1,Math.floor(Qt.toNumber()/vt.toNumber()));for(var ge=Math.ceil(Math.log(Ft)/Math.LN2),ee=ge<=48?1:J(2,ge-48),Ee=Y(Ft),Bt=Ee.mul(vt);Bt.isNegative()||Bt.gt(Qt);)Bt=(Ee=Y(Ft-=ee,this.unsigned)).mul(vt);Ee.isZero()&&(Ee=wt),Gt=Gt.add(Ee),Qt=Qt.sub(Bt)}return Gt},St.div=St.divide,St.modulo=function(vt){return B(vt)||(vt=H(vt)),O?X((this.unsigned?O.rem_u:O.rem_s)(this.low,this.high,vt.low,vt.high),O.get_high(),this.unsigned):this.sub(this.div(vt).mul(vt))},St.mod=St.modulo,St.rem=St.modulo,St.not=function(){return X(~this.low,~this.high,this.unsigned)},St.and=function(vt){return B(vt)||(vt=H(vt)),X(this.low&vt.low,this.high&vt.high,this.unsigned)},St.or=function(vt){return B(vt)||(vt=H(vt)),X(this.low|vt.low,this.high|vt.high,this.unsigned)},St.xor=function(vt){return B(vt)||(vt=H(vt)),X(this.low^vt.low,this.high^vt.high,this.unsigned)},St.shiftLeft=function(vt){return B(vt)&&(vt=vt.toInt()),(vt&=63)==0?this:vt<32?X(this.low<<vt,this.high<<vt|this.low>>>32-vt,this.unsigned):X(0,this.low<<vt-32,this.unsigned)},St.shl=St.shiftLeft,St.shiftRight=function(vt){return B(vt)&&(vt=vt.toInt()),(vt&=63)==0?this:vt<32?X(this.low>>>vt|this.high<<32-vt,this.high>>vt,this.unsigned):X(this.high>>vt-32,this.high>=0?0:-1,this.unsigned)},St.shr=St.shiftRight,St.shiftRightUnsigned=function(vt){if(B(vt)&&(vt=vt.toInt()),(vt&=63)===0)return this;var Ft=this.high;return vt<32?X(this.low>>>vt|Ft<<32-vt,Ft>>>vt,this.unsigned):X(vt===32?Ft:Ft>>>vt-32,0,this.unsigned)},St.shru=St.shiftRightUnsigned,St.shr_u=St.shiftRightUnsigned,St.toSigned=function(){return this.unsigned?X(this.low,this.high,!1):this},St.toUnsigned=function(){return this.unsigned?this:X(this.low,this.high,!0)},St.toBytes=function(vt){return vt?this.toBytesLE():this.toBytesBE()},St.toBytesLE=function(){var vt=this.high,Ft=this.low;return[255&Ft,Ft>>>8&255,Ft>>>16&255,Ft>>>24,255&vt,vt>>>8&255,vt>>>16&255,vt>>>24]},St.toBytesBE=function(){var vt=this.high,Ft=this.low;return[vt>>>24,vt>>>16&255,vt>>>8&255,255&vt,Ft>>>24,Ft>>>16&255,Ft>>>8&255,255&Ft]},S.fromBytes=function(vt,Ft,Qt){return Qt?S.fromBytesLE(vt,Ft):S.fromBytesBE(vt,Ft)},S.fromBytesLE=function(vt,Ft){return new S(vt[0]|vt[1]<<8|vt[2]<<16|vt[3]<<24,vt[4]|vt[5]<<8|vt[6]<<16|vt[7]<<24,Ft)},S.fromBytesBE=function(vt,Ft){return new S(vt[4]<<24|vt[5]<<16|vt[6]<<8|vt[7],vt[0]<<24|vt[1]<<16|vt[2]<<8|vt[3],Ft)}},5228:L=>{var O=Object.getOwnPropertySymbols,S=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;L.exports=function(){try{if(!Object.assign)return!1;var j=new String("abc");if(j[5]="de",Object.getOwnPropertyNames(j)[0]==="5")return!1;for(var K={},Z=0;Z<10;Z++)K["_"+String.fromCharCode(Z)]=Z;if(Object.getOwnPropertyNames(K).map(function(X){return K[X]}).join("")!=="0123456789")return!1;var Y={};return"abcdefghijklmnopqrst".split("").forEach(function(X){Y[X]=X}),Object.keys(Object.assign({},Y)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}()?Object.assign:function(j,K){for(var Z,Y,X=function(tt){if(tt==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(tt)}(j),J=1;J<arguments.length;J++){for(var q in Z=Object(arguments[J]))S.call(Z,q)&&(X[q]=Z[q]);if(O){Y=O(Z);for(var H=0;H<Y.length;H++)B.call(Z,Y[H])&&(X[Y[H]]=Z[Y[H]])}}return X}},5237:(L,O,S)=>{function B(){}S.r(O),S.d(O,{Component:()=>m,cloneElement:()=>q,createElement:()=>Y,default:()=>Ge,h:()=>Y,options:()=>j,render:()=>ye,rerender:()=>lt});var j={},K=[],Z=[];function Y(te,Me){var Ye,Ue,kn,mn,Kn=Z;for(mn=arguments.length;mn-- >2;)K.push(arguments[mn]);for(Me&&Me.children!=null&&(K.length||K.push(Me.children),delete Me.children);K.length;)if((Ue=K.pop())&&Ue.pop!==void 0)for(mn=Ue.length;mn--;)K.push(Ue[mn]);else typeof Ue=="boolean"&&(Ue=null),(kn=typeof te!="function")&&(Ue==null?Ue="":typeof Ue=="number"?Ue=String(Ue):typeof Ue!="string"&&(kn=!1)),kn&&Ye?Kn[Kn.length-1]+=Ue:Kn===Z?Kn=[Ue]:Kn.push(Ue),Ye=kn;var Sn=new B;return Sn.nodeName=te,Sn.children=Kn,Sn.attributes=Me??void 0,Sn.key=Me?.key,j.vnode!==void 0&&j.vnode(Sn),Sn}function X(te,Me){for(var Ye in Me)te[Ye]=Me[Ye];return te}var J=typeof Promise=="function"?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function q(te,Me){return Y(te.nodeName,X(X({},te.attributes),Me),arguments.length>2?[].slice.call(arguments,2):te.children)}var H=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,tt=[];function st(te){!te._dirty&&(te._dirty=!0)&&tt.push(te)==1&&(j.debounceRendering||J)(lt)}function lt(){var te,Me=tt;for(tt=[];te=Me.pop();)te._dirty&&we(te)}function ft(te,Me,Ye){return typeof Me=="string"||typeof Me=="number"?te.splitText!==void 0:typeof Me.nodeName=="string"?!te._componentConstructor&&gt(te,Me.nodeName):Ye||te._componentConstructor===Me.nodeName}function gt(te,Me){return te.normalizedNodeName===Me||te.nodeName.toLowerCase()===Me.toLowerCase()}function xt(te){var Me=X({},te.attributes);Me.children=te.children;var Ye=te.nodeName.defaultProps;if(Ye!==void 0)for(var Ue in Ye)Me[Ue]===void 0&&(Me[Ue]=Ye[Ue]);return Me}function wt(te){var Me=te.parentNode;Me&&Me.removeChild(te)}function _t(te,Me,Ye,Ue,kn){if(Me==="className"&&(Me="class"),Me!=="key")if(Me==="ref")Ye&&Ye(null),Ue&&Ue(te);else if(Me!=="class"||kn)if(Me==="style"){if(Ue&&typeof Ue!="string"&&typeof Ye!="string"||(te.style.cssText=Ue||""),Ue&&typeof Ue=="object"){if(typeof Ye!="string")for(var mn in Ye)mn in Ue||(te.style[mn]="");for(var mn in Ue)te.style[mn]=typeof Ue[mn]=="number"&&H.test(mn)===!1?Ue[mn]+"px":Ue[mn]}}else if(Me==="dangerouslySetInnerHTML")Ue&&(te.innerHTML=Ue.__html||"");else if(Me[0]=="o"&&Me[1]=="n"){var Kn=Me!==(Me=Me.replace(/Capture$/,""));Me=Me.toLowerCase().substring(2),Ue?Ye||te.addEventListener(Me,bt,Kn):te.removeEventListener(Me,bt,Kn),(te._listeners||(te._listeners={}))[Me]=Ue}else if(Me!=="list"&&Me!=="type"&&!kn&&Me in te)(function(Wn,Ze,de){try{Wn[Ze]=de}catch{}})(te,Me,Ue??""),Ue!=null&&Ue!==!1||te.removeAttribute(Me);else{var Sn=kn&&Me!==(Me=Me.replace(/^xlink:?/,""));Ue==null||Ue===!1?Sn?te.removeAttributeNS("http://www.w3.org/1999/xlink",Me.toLowerCase()):te.removeAttribute(Me):typeof Ue!="function"&&(Sn?te.setAttributeNS("http://www.w3.org/1999/xlink",Me.toLowerCase(),Ue):te.setAttribute(Me,Ue))}else te.className=Ue||""}function bt(te){return this._listeners[te.type](j.event&&j.event(te)||te)}var Tt=[],qt=0,It=!1,St=!1;function vt(){for(var te;te=Tt.pop();)j.afterMount&&j.afterMount(te),te.componentDidMount&&te.componentDidMount()}function Ft(te,Me,Ye,Ue,kn,mn){qt++||(It=kn!=null&&kn.ownerSVGElement!==void 0,St=te!=null&&!("__preactattr_"in te));var Kn=Qt(te,Me,Ye,Ue,mn);return kn&&Kn.parentNode!==kn&&kn.appendChild(Kn),--qt||(St=!1,mn||vt()),Kn}function Qt(te,Me,Ye,Ue,kn){var mn=te,Kn=It;if(Me!=null&&typeof Me!="boolean"||(Me=""),typeof Me=="string"||typeof Me=="number")return te&&te.splitText!==void 0&&te.parentNode&&(!te._component||kn)?te.nodeValue!=Me&&(te.nodeValue=Me):(mn=document.createTextNode(Me),te&&(te.parentNode&&te.parentNode.replaceChild(mn,te),Gt(te,!0))),mn.__preactattr_=!0,mn;var Sn,Wn,Ze=Me.nodeName;if(typeof Ze=="function")return function($e,tn,wn,Mn){for(var Hn=$e&&$e._component,Zn=Hn,_r=$e,Sr=Hn&&$e._componentConstructor===tn.nodeName,Mr=Sr,ai=xt(tn);Hn&&!Mr&&(Hn=Hn._parentComponent);)Mr=Hn.constructor===tn.nodeName;return Hn&&Mr&&(!Mn||Hn._component)?(Xt(Hn,ai,3,wn,Mn),$e=Hn.base):(Zn&&!Sr&&(ie(Zn),$e=_r=null),Hn=Ee(tn.nodeName,ai,wn),$e&&!Hn.nextBase&&(Hn.nextBase=$e,_r=null),Xt(Hn,ai,1,wn,Mn),$e=Hn.base,_r&&$e!==_r&&(_r._component=null,Gt(_r,!1))),$e}(te,Me,Ye,Ue);if(It=Ze==="svg"||Ze!=="foreignObject"&&It,Ze=String(Ze),(!te||!gt(te,Ze))&&(Sn=Ze,(Wn=It?document.createElementNS("http://www.w3.org/2000/svg",Sn):document.createElement(Sn)).normalizedNodeName=Sn,mn=Wn,te)){for(;te.firstChild;)mn.appendChild(te.firstChild);te.parentNode&&te.parentNode.replaceChild(mn,te),Gt(te,!0)}var de=mn.firstChild,Re=mn.__preactattr_,Kt=Me.children;if(Re==null){Re=mn.__preactattr_={};for(var Jt=mn.attributes,Ae=Jt.length;Ae--;)Re[Jt[Ae].name]=Jt[Ae].value}return!St&&Kt&&Kt.length===1&&typeof Kt[0]=="string"&&de!=null&&de.splitText!==void 0&&de.nextSibling==null?de.nodeValue!=Kt[0]&&(de.nodeValue=Kt[0]):(Kt&&Kt.length||de!=null)&&function($e,tn,wn,Mn,Hn){var Zn,_r,Sr,Mr,ai,ea=$e.childNodes,Pi=[],Cr={},Ti=0,Be=0,En=ea.length,lr=0,qn=tn?tn.length:0;if(En!==0)for(var fr=0;fr<En;fr++){var Er=ea[fr],Qr=Er.__preactattr_;(vi=qn&&Qr?Er._component?Er._component.__key:Qr.key:null)!=null?(Ti++,Cr[vi]=Er):(Qr||(Er.splitText!==void 0?!Hn||Er.nodeValue.trim():Hn))&&(Pi[lr++]=Er)}if(qn!==0)for(fr=0;fr<qn;fr++){var vi;if(ai=null,(vi=(Mr=tn[fr]).key)!=null)Ti&&Cr[vi]!==void 0&&(ai=Cr[vi],Cr[vi]=void 0,Ti--);else if(!ai&&Be<lr){for(Zn=Be;Zn<lr;Zn++)if(Pi[Zn]!==void 0&&ft(_r=Pi[Zn],Mr,Hn)){ai=_r,Pi[Zn]=void 0,Zn===lr-1&&lr--,Zn===Be&&Be++;break}}ai=Qt(ai,Mr,wn,Mn),Sr=ea[fr],ai&&ai!==$e&&ai!==Sr&&(Sr==null?$e.appendChild(ai):ai===Sr.nextSibling?wt(Sr):$e.insertBefore(ai,Sr))}if(Ti)for(var fr in Cr)Cr[fr]!==void 0&&Gt(Cr[fr],!1);for(;Be<=lr;)(ai=Pi[lr--])!==void 0&&Gt(ai,!1)}(mn,Kt,Ye,Ue,St||Re.dangerouslySetInnerHTML!=null),function($e,tn,wn){var Mn;for(Mn in wn)tn&&tn[Mn]!=null||wn[Mn]==null||_t($e,Mn,wn[Mn],wn[Mn]=void 0,It);for(Mn in tn)Mn==="children"||Mn==="innerHTML"||Mn in wn&&tn[Mn]===(Mn==="value"||Mn==="checked"?$e[Mn]:wn[Mn])||_t($e,Mn,wn[Mn],wn[Mn]=tn[Mn],It)}(mn,Me.attributes,Re),It=Kn,mn}function Gt(te,Me){var Ye=te._component;Ye?ie(Ye):(te.__preactattr_!=null&&te.__preactattr_.ref&&te.__preactattr_.ref(null),Me!==!1&&te.__preactattr_!=null||wt(te),ge(te))}function ge(te){for(te=te.lastChild;te;){var Me=te.previousSibling;Gt(te,!0),te=Me}}var ee={};function Ee(te,Me,Ye){var Ue,kn=ee[te.name];if(te.prototype&&te.prototype.render?(Ue=new te(Me,Ye),m.call(Ue,Me,Ye)):((Ue=new m(Me,Ye)).constructor=te,Ue.render=Bt),kn){for(var mn=kn.length;mn--;)if(kn[mn].constructor===te){Ue.nextBase=kn[mn].nextBase,kn.splice(mn,1);break}}return Ue}function Bt(te,Me,Ye){return this.constructor(te,Ye)}function Xt(te,Me,Ye,Ue,kn){te._disable||(te._disable=!0,(te.__ref=Me.ref)&&delete Me.ref,(te.__key=Me.key)&&delete Me.key,!te.base||kn?te.componentWillMount&&te.componentWillMount():te.componentWillReceiveProps&&te.componentWillReceiveProps(Me,Ue),Ue&&Ue!==te.context&&(te.prevContext||(te.prevContext=te.context),te.context=Ue),te.prevProps||(te.prevProps=te.props),te.props=Me,te._disable=!1,Ye!==0&&(Ye!==1&&j.syncComponentUpdates===!1&&te.base?st(te):we(te,1,kn)),te.__ref&&te.__ref(te))}function we(te,Me,Ye,Ue){if(!te._disable){var kn,mn,Kn,Sn=te.props,Wn=te.state,Ze=te.context,de=te.prevProps||Sn,Re=te.prevState||Wn,Kt=te.prevContext||Ze,Jt=te.base,Ae=te.nextBase,$e=Jt||Ae,tn=te._component,wn=!1;if(Jt&&(te.props=de,te.state=Re,te.context=Kt,Me!==2&&te.shouldComponentUpdate&&te.shouldComponentUpdate(Sn,Wn,Ze)===!1?wn=!0:te.componentWillUpdate&&te.componentWillUpdate(Sn,Wn,Ze),te.props=Sn,te.state=Wn,te.context=Ze),te.prevProps=te.prevState=te.prevContext=te.nextBase=null,te._dirty=!1,!wn){kn=te.render(Sn,Wn,Ze),te.getChildContext&&(Ze=X(X({},Ze),te.getChildContext()));var Mn,Hn,Zn=kn&&kn.nodeName;if(typeof Zn=="function"){var _r=xt(kn);(mn=tn)&&mn.constructor===Zn&&_r.key==mn.__key?Xt(mn,_r,1,Ze,!1):(Mn=mn,te._component=mn=Ee(Zn,_r,Ze),mn.nextBase=mn.nextBase||Ae,mn._parentComponent=te,Xt(mn,_r,0,Ze,!1),we(mn,1,Ye,!0)),Hn=mn.base}else Kn=$e,(Mn=tn)&&(Kn=te._component=null),($e||Me===1)&&(Kn&&(Kn._component=null),Hn=Ft(Kn,kn,Ze,Ye||!Jt,$e&&$e.parentNode,!0));if($e&&Hn!==$e&&mn!==tn){var Sr=$e.parentNode;Sr&&Hn!==Sr&&(Sr.replaceChild(Hn,$e),Mn||($e._component=null,Gt($e,!1)))}if(Mn&&ie(Mn),te.base=Hn,Hn&&!Ue){for(var Mr=te,ai=te;ai=ai._parentComponent;)(Mr=ai).base=Hn;Hn._component=Mr,Hn._componentConstructor=Mr.constructor}}if(!Jt||Ye?Tt.unshift(te):wn||(te.componentDidUpdate&&te.componentDidUpdate(de,Re,Kt),j.afterUpdate&&j.afterUpdate(te)),te._renderCallbacks!=null)for(;te._renderCallbacks.length;)te._renderCallbacks.pop().call(te);qt||Ue||vt()}}function ie(te){j.beforeUnmount&&j.beforeUnmount(te);var Me=te.base;te._disable=!0,te.componentWillUnmount&&te.componentWillUnmount(),te.base=null;var Ye=te._component;Ye?ie(Ye):Me&&(Me.__preactattr_&&Me.__preactattr_.ref&&Me.__preactattr_.ref(null),te.nextBase=Me,wt(Me),function(Ue){var kn=Ue.constructor.name;(ee[kn]||(ee[kn]=[])).push(Ue)}(te),ge(Me)),te.__ref&&te.__ref(null)}function m(te,Me){this._dirty=!0,this.context=Me,this.props=te,this.state=this.state||{}}function ye(te,Me,Ye){return Ft(Ye,te,{},!1,Me,!1)}X(m.prototype,{setState:function(te,Me){var Ye=this.state;this.prevState||(this.prevState=X({},Ye)),X(Ye,typeof te=="function"?te(Ye,this.props):te),Me&&(this._renderCallbacks=this._renderCallbacks||[]).push(Me),st(this)},forceUpdate:function(te){te&&(this._renderCallbacks=this._renderCallbacks||[]).push(te),we(this,2)},render:function(){}});let Ge={h:Y,createElement:Y,cloneElement:q,Component:m,render:ye,rerender:lt,options:j}},7391:(L,O,S)=>{var B=S(7180),j=S(3181),K=S(3031),Z=S(9067),Y=S(6833),X=S(3717),J=S(4801);J.alea=B,J.xor128=j,J.xorwow=K,J.xorshift7=Z,J.xor4096=Y,J.tychei=X,L.exports=J},7180:function(L,O,S){var B;(function(j,K){function Z(J){var q=this,H=function(){var tt=4022871197,st=function(lt){lt=String(lt);for(var ft=0;ft<lt.length;ft++){var gt=.02519603282416938*(tt+=lt.charCodeAt(ft));gt-=tt=gt>>>0,tt=(gt*=tt)>>>0,tt+=4294967296*(gt-=tt)}return 23283064365386963e-26*(tt>>>0)};return st}();q.next=function(){var tt=2091639*q.s0+23283064365386963e-26*q.c;return q.s0=q.s1,q.s1=q.s2,q.s2=tt-(q.c=0|tt)},q.c=1,q.s0=H(" "),q.s1=H(" "),q.s2=H(" "),q.s0-=H(J),q.s0<0&&(q.s0+=1),q.s1-=H(J),q.s1<0&&(q.s1+=1),q.s2-=H(J),q.s2<0&&(q.s2+=1),H=null}function Y(J,q){return q.c=J.c,q.s0=J.s0,q.s1=J.s1,q.s2=J.s2,q}function X(J,q){var H=new Z(J),tt=q&&q.state,st=H.next;return st.int32=function(){return 4294967296*H.next()|0},st.double=function(){return st()+11102230246251565e-32*(2097152*st()|0)},st.quick=st,tt&&(typeof tt=="object"&&Y(tt,H),st.state=function(){return Y(H,{})}),st}K&&K.exports?K.exports=X:S.amdD&&S.amdO?(B=(function(){return X}).call(O,S,O,K))===void 0||(K.exports=B):this.alea=X})(0,L=S.nmd(L))},3717:function(L,O,S){var B;(function(j,K){function Z(J){var q=this,H="";q.next=function(){var st=q.b,lt=q.c,ft=q.d,gt=q.a;return st=st<<25^st>>>7^lt,lt=lt-ft|0,ft=ft<<24^ft>>>8^gt,gt=gt-st|0,q.b=st=st<<20^st>>>12^lt,q.c=lt=lt-ft|0,q.d=ft<<16^lt>>>16^gt,q.a=gt-st|0},q.a=0,q.b=0,q.c=-1640531527,q.d=1367130551,J===Math.floor(J)?(q.a=J/4294967296|0,q.b=0|J):H+=J;for(var tt=0;tt<H.length+20;tt++)q.b^=0|H.charCodeAt(tt),q.next()}function Y(J,q){return q.a=J.a,q.b=J.b,q.c=J.c,q.d=J.d,q}function X(J,q){var H=new Z(J),tt=q&&q.state,st=function(){return(H.next()>>>0)/4294967296};return st.double=function(){do var lt=((H.next()>>>11)+(H.next()>>>0)/4294967296)/2097152;while(lt===0);return lt},st.int32=H.next,st.quick=st,tt&&(typeof tt=="object"&&Y(tt,H),st.state=function(){return Y(H,{})}),st}K&&K.exports?K.exports=X:S.amdD&&S.amdO?(B=(function(){return X}).call(O,S,O,K))===void 0||(K.exports=B):this.tychei=X})(0,L=S.nmd(L))},3181:function(L,O,S){var B;(function(j,K){function Z(J){var q=this,H="";q.x=0,q.y=0,q.z=0,q.w=0,q.next=function(){var st=q.x^q.x<<11;return q.x=q.y,q.y=q.z,q.z=q.w,q.w^=q.w>>>19^st^st>>>8},J===(0|J)?q.x=J:H+=J;for(var tt=0;tt<H.length+64;tt++)q.x^=0|H.charCodeAt(tt),q.next()}function Y(J,q){return q.x=J.x,q.y=J.y,q.z=J.z,q.w=J.w,q}function X(J,q){var H=new Z(J),tt=q&&q.state,st=function(){return(H.next()>>>0)/4294967296};return st.double=function(){do var lt=((H.next()>>>11)+(H.next()>>>0)/4294967296)/2097152;while(lt===0);return lt},st.int32=H.next,st.quick=st,tt&&(typeof tt=="object"&&Y(tt,H),st.state=function(){return Y(H,{})}),st}K&&K.exports?K.exports=X:S.amdD&&S.amdO?(B=(function(){return X}).call(O,S,O,K))===void 0||(K.exports=B):this.xor128=X})(0,L=S.nmd(L))},6833:function(L,O,S){var B;(function(j,K){function Z(J){var q=this;q.next=function(){var H,tt,st=q.w,lt=q.X,ft=q.i;return q.w=st=st+1640531527|0,tt=lt[ft+34&127],H=lt[ft=ft+1&127],tt^=tt<<13,H^=H<<17,tt^=tt>>>15,H^=H>>>12,tt=lt[ft]=tt^H,q.i=ft,tt+(st^st>>>16)|0},function(H,tt){var st,lt,ft,gt,xt,wt=[],_t=128;for(tt===(0|tt)?(lt=tt,tt=null):(tt+="\0",lt=0,_t=Math.max(_t,tt.length)),ft=0,gt=-32;gt<_t;++gt)tt&&(lt^=tt.charCodeAt((gt+32)%tt.length)),gt===0&&(xt=lt),lt^=lt<<10,lt^=lt>>>15,lt^=lt<<4,lt^=lt>>>13,gt>=0&&(xt=xt+1640531527|0,ft=(st=wt[127&gt]^=lt+xt)==0?ft+1:0);for(ft>=128&&(wt[127&(tt&&tt.length||0)]=-1),ft=127,gt=512;gt>0;--gt)lt=wt[ft+34&127],st=wt[ft=ft+1&127],lt^=lt<<13,st^=st<<17,lt^=lt>>>15,st^=st>>>12,wt[ft]=lt^st;H.w=xt,H.X=wt,H.i=ft}(q,J)}function Y(J,q){return q.i=J.i,q.w=J.w,q.X=J.X.slice(),q}function X(J,q){J==null&&(J=+new Date);var H=new Z(J),tt=q&&q.state,st=function(){return(H.next()>>>0)/4294967296};return st.double=function(){do var lt=((H.next()>>>11)+(H.next()>>>0)/4294967296)/2097152;while(lt===0);return lt},st.int32=H.next,st.quick=st,tt&&(tt.X&&Y(tt,H),st.state=function(){return Y(H,{})}),st}K&&K.exports?K.exports=X:S.amdD&&S.amdO?(B=(function(){return X}).call(O,S,O,K))===void 0||(K.exports=B):this.xor4096=X})(0,L=S.nmd(L))},9067:function(L,O,S){var B;(function(j,K){function Z(J){var q=this;q.next=function(){var H,tt,st=q.x,lt=q.i;return H=st[lt],tt=(H^=H>>>7)^H<<24,tt^=(H=st[lt+1&7])^H>>>10,tt^=(H=st[lt+3&7])^H>>>3,tt^=(H=st[lt+4&7])^H<<7,H=st[lt+7&7],tt^=(H^=H<<13)^H<<9,st[lt]=tt,q.i=lt+1&7,tt},function(H,tt){var st,lt=[];if(tt===(0|tt))lt[0]=tt;else for(tt=""+tt,st=0;st<tt.length;++st)lt[7&st]=lt[7&st]<<15^tt.charCodeAt(st)+lt[st+1&7]<<13;for(;lt.length<8;)lt.push(0);for(st=0;st<8&&lt[st]===0;++st);for(st==8?lt[7]=-1:lt[st],H.x=lt,H.i=0,st=256;st>0;--st)H.next()}(q,J)}function Y(J,q){return q.x=J.x.slice(),q.i=J.i,q}function X(J,q){J==null&&(J=+new Date);var H=new Z(J),tt=q&&q.state,st=function(){return(H.next()>>>0)/4294967296};return st.double=function(){do var lt=((H.next()>>>11)+(H.next()>>>0)/4294967296)/2097152;while(lt===0);return lt},st.int32=H.next,st.quick=st,tt&&(tt.x&&Y(tt,H),st.state=function(){return Y(H,{})}),st}K&&K.exports?K.exports=X:S.amdD&&S.amdO?(B=(function(){return X}).call(O,S,O,K))===void 0||(K.exports=B):this.xorshift7=X})(0,L=S.nmd(L))},3031:function(L,O,S){var B;(function(j,K){function Z(J){var q=this,H="";q.next=function(){var st=q.x^q.x>>>2;return q.x=q.y,q.y=q.z,q.z=q.w,q.w=q.v,(q.d=q.d+362437|0)+(q.v=q.v^q.v<<4^st^st<<1)|0},q.x=0,q.y=0,q.z=0,q.w=0,q.v=0,J===(0|J)?q.x=J:H+=J;for(var tt=0;tt<H.length+64;tt++)q.x^=0|H.charCodeAt(tt),tt==H.length&&(q.d=q.x<<10^q.x>>>4),q.next()}function Y(J,q){return q.x=J.x,q.y=J.y,q.z=J.z,q.w=J.w,q.v=J.v,q.d=J.d,q}function X(J,q){var H=new Z(J),tt=q&&q.state,st=function(){return(H.next()>>>0)/4294967296};return st.double=function(){do var lt=((H.next()>>>11)+(H.next()>>>0)/4294967296)/2097152;while(lt===0);return lt},st.int32=H.next,st.quick=st,tt&&(typeof tt=="object"&&Y(tt,H),st.state=function(){return Y(H,{})}),st}K&&K.exports?K.exports=X:S.amdD&&S.amdO?(B=(function(){return X}).call(O,S,O,K))===void 0||(K.exports=B):this.xorwow=X})(0,L=S.nmd(L))},4801:function(L,O,S){var B;(function(j,K,Z){var Y,X=256,J=Z.pow(X,6),q=Z.pow(2,52),H=2*q,tt=255;function st(_t,bt,Tt){var qt=[],It=xt(gt((bt=bt==1?{entropy:!0}:bt||{}).entropy?[_t,wt(K)]:_t??function(){try{var Ft;return Y&&(Ft=Y.randomBytes)?Ft=Ft(X):(Ft=new Uint8Array(X),(j.crypto||j.msCrypto).getRandomValues(Ft)),wt(Ft)}catch{var Qt=j.navigator,Gt=Qt&&Qt.plugins;return[+new Date,j,Gt,j.screen,wt(K)]}}(),3),qt),St=new lt(qt),vt=function(){for(var Ft=St.g(6),Qt=J,Gt=0;Ft<q;)Ft=(Ft+Gt)*X,Qt*=X,Gt=St.g(1);for(;Ft>=H;)Ft/=2,Qt/=2,Gt>>>=1;return(Ft+Gt)/Qt};return vt.int32=function(){return 0|St.g(4)},vt.quick=function(){return St.g(4)/4294967296},vt.double=vt,xt(wt(St.S),K),(bt.pass||Tt||function(Ft,Qt,Gt,ge){return ge&&(ge.S&&ft(ge,St),Ft.state=function(){return ft(St,{})}),Gt?(Z.random=Ft,Qt):Ft})(vt,It,"global"in bt?bt.global:this==Z,bt.state)}function lt(_t){var bt,Tt=_t.length,qt=this,It=0,St=qt.i=qt.j=0,vt=qt.S=[];for(Tt||(_t=[Tt++]);It<X;)vt[It]=It++;for(It=0;It<X;It++)vt[It]=vt[St=tt&St+_t[It%Tt]+(bt=vt[It])],vt[St]=bt;(qt.g=function(Ft){for(var Qt,Gt=0,ge=qt.i,ee=qt.j,Ee=qt.S;Ft--;)Qt=Ee[ge=tt&ge+1],Gt=Gt*X+Ee[tt&(Ee[ge]=Ee[ee=tt&ee+Qt])+(Ee[ee]=Qt)];return qt.i=ge,qt.j=ee,Gt})(X)}function ft(_t,bt){return bt.i=_t.i,bt.j=_t.j,bt.S=_t.S.slice(),bt}function gt(_t,bt){var Tt,qt=[],It=typeof _t;if(bt&&It=="object")for(Tt in _t)try{qt.push(gt(_t[Tt],bt-1))}catch{}return qt.length?qt:It=="string"?_t:_t+"\0"}function xt(_t,bt){for(var Tt,qt=_t+"",It=0;It<qt.length;)bt[tt&It]=tt&(Tt^=19*bt[tt&It])+qt.charCodeAt(It++);return wt(bt)}function wt(_t){return String.fromCharCode.apply(0,_t)}if(xt(Z.random(),K),L.exports){L.exports=st;try{Y=S(1234)}catch{}}else(B=(function(){return st}).call(O,S,O,L))===void 0||(L.exports=B)})(typeof self<"u"?self:this,[],Math)},8731:(L,O,S)=>{S.r(O),S.d(O,{DEFAULT_ACTIONS:()=>SNt,default:()=>JJt,guessMode:()=>CNt,vega:()=>U3,vegaLite:()=>FM});var B={};S.r(B),S.d(B,{JsonPatchError:()=>we,_areEquals:()=>mn,applyOperation:()=>te,applyPatch:()=>Me,applyReducer:()=>Ye,deepClone:()=>ie,getValueByPointer:()=>Ge,validate:()=>kn,validator:()=>Ue});var j={};S.r(j),S.d(j,{compare:()=>Jt,generate:()=>Re,observe:()=>de,unobserve:()=>Ze});var K={};S.r(K),S.d(K,{aggregate:()=>Fg,bin:()=>eF,collect:()=>nF,compare:()=>CH,countpattern:()=>rF,cross:()=>iF,density:()=>aF,dotbin:()=>sF,expression:()=>MH,extent:()=>lF,facet:()=>$w,field:()=>DH,filter:()=>oS,flatten:()=>hF,fold:()=>dF,formula:()=>fF,generate:()=>RH,impute:()=>FE,joinaggregate:()=>OE,kde:()=>pF,key:()=>OH,load:()=>LH,lookup:()=>gF,multiextent:()=>$H,multivalues:()=>zH,params:()=>PH,pivot:()=>yF,prefacet:()=>BH,project:()=>vF,proxy:()=>jH,quantile:()=>bF,relay:()=>UH,sample:()=>wF,sequence:()=>xF,sieve:()=>WH,subflow:()=>cF,timeunit:()=>kF,tupleindex:()=>GH,values:()=>HH,window:()=>SF});var Z={};S.r(Z),S.d(Z,{interpolate:()=>_T,interpolateArray:()=>kct,interpolateBasis:()=>dO,interpolateBasisClosed:()=>tq,interpolateCubehelix:()=>Mct,interpolateCubehelixLong:()=>Dct,interpolateDate:()=>iq,interpolateDiscrete:()=>Sct,interpolateHcl:()=>Ict,interpolateHclLong:()=>Nct,interpolateHsl:()=>hq,interpolateHslLong:()=>dq,interpolateHue:()=>sq,interpolateLab:()=>Act,interpolateNumber:()=>v0,interpolateNumberArray:()=>xT,interpolateObject:()=>aq,interpolateRgb:()=>wT,interpolateRgbBasis:()=>xct,interpolateRgbBasisClosed:()=>nq,interpolateRound:()=>_ct,interpolateString:()=>oq,interpolateTransformCss:()=>Cct,interpolateTransformSvg:()=>lq,interpolateZoom:()=>cq,piecewise:()=>pO,quantize:()=>NO});var Y={};S.r(Y),S.d(Y,{bound:()=>BX,identifier:()=>xA,mark:()=>JL,overlap:()=>t$,render:()=>qg,viewlayout:()=>VX});var X={};S.r(X),S.d(X,{axisticks:()=>TA,datajoin:()=>oK,encode:()=>sK,legendentries:()=>uK,linkpath:()=>f$,pie:()=>G2,scale:()=>fK,sortitems:()=>gK,stack:()=>m$});var J={};S.r(J),S.d(J,{contour:()=>jx,geojson:()=>oz,geopath:()=>wI,geopoint:()=>sz,geoshape:()=>$_,graticule:()=>Ux,heatmap:()=>z_,isocontour:()=>Px,kde2d:()=>rz,projection:()=>P_});var q={};S.r(q),S.d(q,{force:()=>EI});var H={};S.r(H),S.d(H,{nest:()=>e4,pack:()=>RI,partition:()=>FI,stratify:()=>Cz,tree:()=>n4,treelinks:()=>Ep,treemap:()=>r6});var tt={};S.r(tt),S.d(tt,{label:()=>Ef});var st={};S.r(st),S.d(st,{loess:()=>a6,regression:()=>Az});var lt={};S.r(lt),S.d(lt,{voronoi:()=>Mz});var ft={};S.r(ft),S.d(ft,{wordcloud:()=>UI});var gt={};S.r(gt),S.d(gt,{crossfilter:()=>Rz,resolvefilter:()=>Fz});var xt={};S.r(xt),S.d(xt,{interpolate:()=>E7,interpolateArray:()=>e0t,interpolateBasis:()=>qJ,interpolateBasisClosed:()=>XJ,interpolateCubehelix:()=>w0t,interpolateCubehelixLong:()=>x0t,interpolateDate:()=>ttt,interpolateDiscrete:()=>n0t,interpolateHcl:()=>p0t,interpolateHclLong:()=>m0t,interpolateHsl:()=>u0t,interpolateHslLong:()=>l0t,interpolateHue:()=>r0t,interpolateLab:()=>f0t,interpolateNumber:()=>Gm,interpolateNumberArray:()=>$P,interpolateObject:()=>ett,interpolateRgb:()=>LP,interpolateRgbBasis:()=>Jpt,interpolateRgbBasisClosed:()=>t0t,interpolateRound:()=>i0t,interpolateString:()=>ntt,interpolateTransformCss:()=>a0t,interpolateTransformSvg:()=>o0t,interpolateZoom:()=>s0t,piecewise:()=>rtt,quantize:()=>k0t});var wt={};S.r(wt),S.d(wt,{interpolate:()=>yp,interpolateArray:()=>Fht,interpolateBasis:()=>QX,interpolateBasisClosed:()=>JX,interpolateCubehelix:()=>TPt,interpolateCubehelixLong:()=>APt,interpolateDate:()=>rK,interpolateDiscrete:()=>me,interpolateHcl:()=>wPt,interpolateHclLong:()=>xPt,interpolateHsl:()=>$a,interpolateHslLong:()=>Di,interpolateHue:()=>Ie,interpolateLab:()=>bPt,interpolateNumber:()=>C0,interpolateNumberArray:()=>c$,interpolateObject:()=>iK,interpolateRgb:()=>EA,interpolateRgbBasis:()=>Dht,interpolateRgbBasisClosed:()=>Rht,interpolateRound:()=>lo,interpolateString:()=>aK,interpolateTransformCss:()=>Br,interpolateTransformSvg:()=>xi,interpolateZoom:()=>Ja,piecewise:()=>NN,quantize:()=>IPt});var _t={};S.r(_t),S.d(_t,{interpolate:()=>uit,interpolateArray:()=>YWt,interpolateBasis:()=>TCt,interpolateBasisClosed:()=>ACt,interpolateCubehelix:()=>fVt,interpolateCubehelixLong:()=>pVt,interpolateDate:()=>RCt,interpolateDiscrete:()=>qWt,interpolateHcl:()=>oVt,interpolateHclLong:()=>sVt,interpolateHsl:()=>tVt,interpolateHslLong:()=>eVt,interpolateHue:()=>XWt,interpolateLab:()=>aVt,interpolateNumber:()=>Cy,interpolateNumberArray:()=>S1t,interpolateObject:()=>FCt,interpolateRgb:()=>k1t,interpolateRgbBasis:()=>GWt,interpolateRgbBasisClosed:()=>HWt,interpolateRound:()=>KWt,interpolateString:()=>OCt,interpolateTransformCss:()=>ZWt,interpolateTransformSvg:()=>QWt,interpolateZoom:()=>JWt,piecewise:()=>LCt,quantize:()=>mVt});var bt={};S.r(bt),S.d(bt,{Bounds:()=>Xd,CanvasHandler:()=>z4,CanvasRenderer:()=>lC,DATE:()=>Tf,DAY:()=>vl,DAYOFYEAR:()=>I0,Dataflow:()=>Dg,Debug:()=>ua,Error:()=>Er,EventStream:()=>Rw,Gradient:()=>L0t,GroupItem:()=>R7,HOURS:()=>Zc,Handler:()=>Qm,Info:()=>vi,Item:()=>fB,MILLISECONDS:()=>M0,MINUTES:()=>Nr,MONTH:()=>Xc,Marks:()=>B0,MultiPulse:()=>q5,None:()=>fr,Operator:()=>ts,Parameters:()=>Dw,Pulse:()=>pm,QUARTER:()=>Mp,RenderType:()=>YB,Renderer:()=>j0,ResourceLoader:()=>pB,SECONDS:()=>N0,SVGHandler:()=>LB,SVGRenderer:()=>fC,SVGStringRenderer:()=>GB,Scenegraph:()=>Nh,TIME_UNITS:()=>hi,Transform:()=>ar,View:()=>Q_t,WEEK:()=>Kc,Warn:()=>Qr,YEAR:()=>Eh,accessor:()=>wn,accessorFields:()=>Hn,accessorName:()=>Mn,array:()=>Xo,ascending:()=>Ru,bandwidthNRD:()=>zm,bin:()=>Z2,bootstrapCI:()=>uft,boundClip:()=>pC,boundContext:()=>D4,boundItem:()=>MB,boundMark:()=>uet,boundStroke:()=>Zb,changeset:()=>sp,clampRange:()=>Du,codegenExpression:()=>Zqt,compare:()=>Ra,constant:()=>Zs,cumulativeLogNormal:()=>Bz,cumulativeNormal:()=>T0,cumulativeUniform:()=>_Q,dayofyear:()=>c4,debounce:()=>Rc,defaultLocale:()=>G6t,definition:()=>gE,densityLogNormal:()=>kQ,densityNormal:()=>a1,densityUniform:()=>Vz,domChild:()=>tc,domClear:()=>sd,domCreate:()=>Rp,domFind:()=>DB,dotbin:()=>bQ,error:()=>Mr,expressionFunction:()=>Cc,extend:()=>bu,extent:()=>Qs,extentIndex:()=>wu,falsy:()=>lr,fastmap:()=>Ku,field:()=>ea,flush:()=>Zu,font:()=>X7,fontFamily:()=>nC,fontSize:()=>Km,format:()=>s7,formatLocale:()=>Rrt,formats:()=>pP,hasOwnProperty:()=>Zo,id:()=>Pi,identity:()=>Cr,inferType:()=>hP,inferTypes:()=>uJ,ingest:()=>Jo,inherits:()=>xs,inrange:()=>xu,interpolate:()=>Qkt,interpolateColors:()=>Zkt,interpolateRange:()=>LPt,intersect:()=>Iet,intersectBoxLine:()=>t3,intersectPath:()=>H6,intersectPoint:()=>B7,intersectRule:()=>Ytt,isArray:()=>eo,isBoolean:()=>pa,isDate:()=>_n,isFunction:()=>uu,isIterable:()=>ls,isNumber:()=>Dt,isObject:()=>Fo,isRegExp:()=>Zt,isString:()=>Ce,isTuple:()=>Qh,key:()=>le,lerp:()=>Pe,lineHeight:()=>Zm,loader:()=>ppt,locale:()=>hWt,logger:()=>br,lruCache:()=>Cn,markup:()=>j4,merge:()=>Vn,mergeConfig:()=>Le,multiLineOffset:()=>q0t,one:()=>Be,pad:()=>Kr,panLinear:()=>Da,panLog:()=>_i,panPow:()=>la,panSymlog:()=>so,parse:()=>XYt,parseExpression:()=>qqt,parseSelector:()=>e9,pathCurves:()=>A4,pathEqual:()=>ZB,pathParse:()=>P6,pathRectangle:()=>Btt,pathRender:()=>M4,pathSymbols:()=>Jc,pathTrail:()=>sB,peek:()=>Jn,point:()=>RB,projection:()=>tSt,quantileLogNormal:()=>jz,quantileNormal:()=>A0,quantileUniform:()=>CQ,quantiles:()=>Np,quantizeInterpolator:()=>$Pt,quarter:()=>va,quartiles:()=>$m,random:()=>Pm,randomInteger:()=>Lz,randomKDE:()=>Pz,randomLCG:()=>Oz,randomLogNormal:()=>Uz,randomMixture:()=>SQ,randomNormal:()=>zz,randomUniform:()=>cft,read:()=>fpt,regressionExp:()=>dft,regressionLinear:()=>GI,regressionLoess:()=>AQ,regressionLog:()=>hft,regressionPoly:()=>pft,regressionPow:()=>fft,regressionQuad:()=>EQ,renderModule:()=>qB,repeat:()=>hr,resetDefaultLocale:()=>dWt,resetSVGClipId:()=>Wtt,resetSVGDefIds:()=>Det,responseType:()=>dpt,runtimeContext:()=>JYt,sampleCurve:()=>Gz,sampleLogNormal:()=>xQ,sampleNormal:()=>$z,sampleUniform:()=>Wz,scale:()=>gu,sceneEqual:()=>KB,sceneFromJSON:()=>pu,scenePickVisit:()=>j7,sceneToJSON:()=>Q7,sceneVisit:()=>P0,sceneZOrder:()=>q6,scheme:()=>n5t,serializeXML:()=>ket,setRandom:()=>sft,span:()=>$i,splitAccessPath:()=>ai,stringValue:()=>Ai,textMetrics:()=>L4,timeBin:()=>jft,timeFloor:()=>Mft,timeFormatLocale:()=>Frt,timeInterval:()=>Qc,timeOffset:()=>$ft,timeSequence:()=>YQ,timeUnitSpecifier:()=>jm,timeUnits:()=>Qz,toBoolean:()=>Rr,toDate:()=>di,toNumber:()=>dr,toSet:()=>Ci,toString:()=>bi,transform:()=>yE,transforms:()=>m2,truncate:()=>ra,truthy:()=>En,tupleid:()=>qi,typeParsers:()=>lP,utcFloor:()=>Fft,utcInterval:()=>tP,utcOffset:()=>e7,utcSequence:()=>n7,utcdayofyear:()=>Ift,utcquarter:()=>Ya,utcweek:()=>Nft,version:()=>aXt,visitArray:()=>oa,week:()=>Ma,writeConfig:()=>bn,zero:()=>Ti,zoomLinear:()=>vs,zoomLog:()=>qo,zoomPow:()=>bs,zoomSymlog:()=>na});var Tt={};S.r(Tt),S.d(Tt,{compile:()=>xJt,extractTransforms:()=>SJt,normalize:()=>iIt,version:()=>_Jt});var qt={};S.r(qt),S.d(qt,{carbong10:()=>PJt,carbong100:()=>jJt,carbong90:()=>BJt,carbonwhite:()=>zJt,dark:()=>EJt,excel:()=>TJt,fivethirtyeight:()=>AJt,ggplot2:()=>IJt,googlecharts:()=>FJt,latimes:()=>NJt,powerbi:()=>OJt,quartz:()=>MJt,urbaninstitute:()=>RJt,version:()=>UJt,vox:()=>DJt});var It=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var s in a)a.hasOwnProperty(s)&&(r[s]=a[s])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),St=Object.prototype.hasOwnProperty;function vt(t,e){return St.call(t,e)}function Ft(t){if(Array.isArray(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);var r=[];for(var a in t)vt(t,a)&&r.push(a);return r}function Qt(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function Gt(t){for(var e,n=0,r=t.length;n<r;){if(!((e=t.charCodeAt(n))>=48&&e<=57))return!1;n++}return!0}function ge(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function ee(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function Ee(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(Ee(t[e]))return!0}else if(typeof t=="object"){for(var r=Ft(t),a=r.length,s=0;s<a;s++)if(Ee(t[r[s]]))return!0}}return!1}function Bt(t,e){var n=[t];for(var r in e){var a=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];a!==void 0&&n.push(r+": "+a)}return n.join(`
`)}var Xt=function(t){function e(n,r,a,s,h){var d=this.constructor,g=t.call(this,Bt(n,{name:r,index:a,operation:s,tree:h}))||this;return g.name=r,g.index=a,g.operation=s,g.tree=h,Object.setPrototypeOf(g,d.prototype),g.message=Bt(n,{name:r,index:a,operation:s,tree:h}),g}return It(e,t),e}(Error),we=Xt,ie=Qt,m={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=Ge(n,this.path);r&&(r=Qt(r));var a=te(n,{op:"remove",path:this.from}).removed;return te(n,{op:"add",path:this.path,value:a}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=Ge(n,this.from);return te(n,{op:"add",path:this.path,value:Qt(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:mn(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},ye={add:function(t,e,n){return Gt(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){return{newDocument:n,removed:t.splice(e,1)[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:m.move,copy:m.copy,test:m.test,_get:m._get};function Ge(t,e){if(e=="")return t;var n={op:"_get",path:e};return te(t,n),n.value}function te(t,e,n,r,a,s){if(n===void 0&&(n=!1),r===void 0&&(r=!0),a===void 0&&(a=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(e,0,t,e.path):Ue(e,0)),e.path===""){var h={newDocument:t};if(e.op==="add")return h.newDocument=e.value,h;if(e.op==="replace")return h.newDocument=e.value,h.removed=t,h;if(e.op==="move"||e.op==="copy")return h.newDocument=Ge(t,e.from),e.op==="move"&&(h.removed=t),h;if(e.op==="test"){if(h.test=mn(t,e.value),h.test===!1)throw new we("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return h.newDocument=t,h}if(e.op==="remove")return h.removed=t,h.newDocument=null,h;if(e.op==="_get")return e.value=t,h;if(n)throw new we("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,t);return h}r||(t=Qt(t));var d=(e.path||"").split("/"),g=t,b=1,_=d.length,E=void 0,I=void 0,R=void 0;for(R=typeof n=="function"?n:Ue;;){if((I=d[b])&&I.indexOf("~")!=-1&&(I=ee(I)),a&&(I=="__proto__"||I=="prototype"&&b>0&&d[b-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&E===void 0&&(g[I]===void 0?E=d.slice(0,b).join("/"):b==_-1&&(E=e.path),E!==void 0&&R(e,0,t,E)),b++,Array.isArray(g)){if(I==="-")I=g.length;else{if(n&&!Gt(I))throw new we("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,t);Gt(I)&&(I=~~I)}if(b>=_){if(n&&e.op==="add"&&I>g.length)throw new we("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,t);if((h=ye[e.op].call(e,g,I,t)).test===!1)throw new we("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return h}}else if(b>=_){if((h=m[e.op].call(e,g,I,t)).test===!1)throw new we("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return h}if(g=g[I],n&&b<_&&(!g||typeof g!="object"))throw new we("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,e,t)}}function Me(t,e,n,r,a){if(r===void 0&&(r=!0),a===void 0&&(a=!0),n&&!Array.isArray(e))throw new we("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=Qt(t));for(var s=new Array(e.length),h=0,d=e.length;h<d;h++)s[h]=te(t,e[h],n,!0,a,h),t=s[h].newDocument;return s.newDocument=t,s}function Ye(t,e,n){var r=te(t,e);if(r.test===!1)throw new we("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function Ue(t,e,n,r){if(typeof t!="object"||t===null||Array.isArray(t))throw new we("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(!m[t.op])throw new we("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n);if(typeof t.path!="string")throw new we("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new we('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new we("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new we("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&Ee(t.value))throw new we("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var a=t.path.split("/").length,s=r.split("/").length;if(a!==s+1&&a!==s)throw new we("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==r)throw new we("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var h=kn([{op:"_get",path:t.from,value:void 0}],n);if(h&&h.name==="OPERATION_PATH_UNRESOLVABLE")throw new we("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}function kn(t,e,n){try{if(!Array.isArray(t))throw new we("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)Me(Qt(e),Qt(t),n||!0);else{n=n||Ue;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(a){if(a instanceof we)return a;throw a}}function mn(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n,r,a,s=Array.isArray(t),h=Array.isArray(e);if(s&&h){if((r=t.length)!=e.length)return!1;for(n=r;n--!=0;)if(!mn(t[n],e[n]))return!1;return!0}if(s!=h)return!1;var d=Object.keys(t);if((r=d.length)!==Object.keys(e).length)return!1;for(n=r;n--!=0;)if(!e.hasOwnProperty(d[n]))return!1;for(n=r;n--!=0;)if(!mn(t[a=d[n]],e[a]))return!1;return!0}return t!=t&&e!=e}var Kn=new WeakMap,Sn=function(t){this.observers=new Map,this.obj=t},Wn=function(t,e){this.callback=t,this.observer=e};function Ze(t,e){e.unobserve()}function de(t,e){var n,r=function(d){return Kn.get(d)}(t);if(r){var a=function(d,g){return d.observers.get(g)}(r,e);n=a&&a.observer}else r=new Sn(t),Kn.set(t,r);if(n)return n;if(n={},r.value=Qt(t),e){n.callback=e,n.next=null;var s=function(){Re(n)},h=function(){clearTimeout(n.next),n.next=setTimeout(s)};typeof window<"u"&&(window.addEventListener("mouseup",h),window.addEventListener("keyup",h),window.addEventListener("mousedown",h),window.addEventListener("keydown",h),window.addEventListener("change",h))}return n.patches=[],n.object=t,n.unobserve=function(){Re(n),clearTimeout(n.next),function(d,g){d.observers.delete(g.callback)}(r,n),typeof window<"u"&&(window.removeEventListener("mouseup",h),window.removeEventListener("keyup",h),window.removeEventListener("mousedown",h),window.removeEventListener("keydown",h),window.removeEventListener("change",h))},r.observers.set(e,new Wn(e,n)),n}function Re(t,e){e===void 0&&(e=!1);var n=Kn.get(t.object);Kt(n.value,t.object,t.patches,"",e),t.patches.length&&Me(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function Kt(t,e,n,r,a){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=Ft(e),h=Ft(t),d=!1,g=h.length-1;g>=0;g--){var b=t[E=h[g]];if(!vt(e,E)||e[E]===void 0&&b!==void 0&&Array.isArray(e)===!1)Array.isArray(t)===Array.isArray(e)?(a&&n.push({op:"test",path:r+"/"+ge(E),value:Qt(b)}),n.push({op:"remove",path:r+"/"+ge(E)}),d=!0):(a&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}));else{var _=e[E];typeof b=="object"&&b!=null&&typeof _=="object"&&_!=null&&Array.isArray(b)===Array.isArray(_)?Kt(b,_,n,r+"/"+ge(E),a):b!==_&&(a&&n.push({op:"test",path:r+"/"+ge(E),value:Qt(b)}),n.push({op:"replace",path:r+"/"+ge(E),value:Qt(_)}))}}if(d||s.length!=h.length)for(g=0;g<s.length;g++){var E;vt(t,E=s[g])||e[E]===void 0||n.push({op:"add",path:r+"/"+ge(E),value:Qt(e[E])})}}}function Jt(t,e,n){n===void 0&&(n=!1);var r=[];return Kt(t,e,r,"",n),r}Object.assign({},B,j,{JsonPatchError:Xt,deepClone:Qt,escapePathComponent:ge,unescapePathComponent:ee});var Ae=S(8487),$e=S.n(Ae),tn=S(6392);function wn(t,e,n){return t.fields=e||[],t.fname=n,t}function Mn(t){return t==null?null:t.fname}function Hn(t){return t==null?null:t.fields}function Zn(t){return t.length===1?_r(t[0]):Sr(t)}let _r=t=>function(e){return e[t]},Sr=t=>{let e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Mr(t){throw Error(t)}function ai(t){let e=[],n=t.length,r,a,s,h=null,d=0,g="";function b(){e.push(g+t.substring(r,a)),g="",r=a+1}for(t+="",r=a=0;a<n;++a)if(s=t[a],s==="\\")g+=t.substring(r,a),g+=t.substring(++a,++a),r=a;else if(s===h)b(),h=null,d=-1;else{if(h)continue;r===d&&s==='"'||r===d&&s==="'"?(r=a+1,h=s):s!=="."||d?s==="["?(a>r&&b(),d=r=a+1):s==="]"&&(d||Mr("Access path missing open bracket: "+t),d>0&&b(),d=0,r=a+1):a>r?b():r=a+1}return d&&Mr("Access path missing closing bracket: "+t),h&&Mr("Access path missing closing quote: "+t),a>r&&(a++,b()),e}function ea(t,e,n){let r=ai(t);return t=r.length===1?r[0]:t,wn((n&&n.get||Zn)(r),[t],e||t)}let Pi=ea("id"),Cr=wn(t=>t,[],"identity"),Ti=wn(()=>0,[],"zero"),Be=wn(()=>1,[],"one"),En=wn(()=>!0,[],"true"),lr=wn(()=>!1,[],"false");function qn(t,e,n){let r=[e].concat([].slice.call(n));console[t].apply(console,r)}let fr=0,Er=1,Qr=2,vi=3,ua=4;function br(t,e){let n=t||fr;return{level(r){return arguments.length?(n=+r,this):n},error(){return n>=Er&&qn(e||"error","ERROR",arguments),this},warn(){return n>=Qr&&qn(e||"warn","WARN",arguments),this},info(){return n>=vi&&qn(e||"log","INFO",arguments),this},debug(){return n>=ua&&qn(e||"log","DEBUG",arguments),this}}}var eo=Array.isArray;function Fo(t){return t===Object(t)}let Wa=t=>t!=="__proto__";function Le(...t){return t.reduce((e,n)=>{for(let r in n)if(r==="signals")e.signals=jn(e.signals,n.signals);else{let a=r==="legend"?{layout:1}:r==="style"||null;bn(e,r,n[r],a)}return e},{})}function bn(t,e,n,r){if(!Wa(e))return;let a,s;if(Fo(n)&&!eo(n))for(a in s=Fo(t[e])?t[e]:t[e]={},n)r&&(r===!0||r[a])?bn(s,a,n[a]):Wa(a)&&(s[a]=n[a]);else t[e]=n}function jn(t,e){if(t==null)return e;let n={},r=[];function a(s){n[s.name]||(n[s.name]=1,r.push(s))}return e.forEach(a),t.forEach(a),r}function Jn(t){return t[t.length-1]}function dr(t){return t==null||t===""?null:+t}let Ur=t=>e=>t*Math.exp(e),or=t=>e=>Math.log(t*e),Yn=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),li=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,Ki=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function Si(t,e,n,r){let a=n(t[0]),s=n(Jn(t)),h=(s-a)*e;return[r(a-h),r(s-h)]}function Da(t,e){return Si(t,e,dr,Cr)}function _i(t,e){var n=Math.sign(t[0]);return Si(t,e,or(n),Ur(n))}function la(t,e,n){return Si(t,e,Ki(n),Ki(1/n))}function so(t,e,n){return Si(t,e,Yn(n),li(n))}function ys(t,e,n,r,a){let s=r(t[0]),h=r(Jn(t)),d=e!=null?r(e):(s+h)/2;return[a(d+(s-d)*n),a(d+(h-d)*n)]}function vs(t,e,n){return ys(t,e,n,dr,Cr)}function qo(t,e,n){let r=Math.sign(t[0]);return ys(t,e,n,or(r),Ur(r))}function bs(t,e,n,r){return ys(t,e,n,Ki(r),Ki(1/r))}function na(t,e,n,r){return ys(t,e,n,Yn(r),li(r))}function va(t){return 1+~~(new Date(t).getMonth()/3)}function Ya(t){return 1+~~(new Date(t).getUTCMonth()/3)}function Xo(t){return t!=null?eo(t)?t:[t]:[]}function Du(t,e,n){let r,a=t[0],s=t[1];return s<a&&(r=s,s=a,a=r),r=s-a,r>=n-e?[e,n]:[a=Math.min(Math.max(a,e),n-r),a+r]}function uu(t){return typeof t=="function"}let ws="descending";function Ra(t,e,n){n=n||{},e=Xo(e)||[];let r=[],a=[],s={},h=n.comparator||Ko;return Xo(t).forEach((d,g)=>{d!=null&&(r.push(e[g]===ws?-1:1),a.push(d=uu(d)?d:ea(d,null,n)),(Hn(d)||[]).forEach(b=>s[b]=1))}),a.length===0?null:wn(h(a,r),Object.keys(s))}let Ru=(t,e)=>(t<e||t==null)&&e!=null?-1:(t>e||e==null)&&t!=null?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e==e?-1:e!=e&&t==t?1:0),Ko=(t,e)=>t.length===1?Ga(t[0],e[0]):Fu(t,e,t.length),Ga=(t,e)=>function(n,r){return Ru(t(n),t(r))*e},Fu=(t,e,n)=>(e.push(0),function(r,a){let s,h=0,d=-1;for(;h===0&&++d<n;)s=t[d],h=Ru(s(r),s(a));return h*e[d]});function Zs(t){return uu(t)?t:()=>t}function Rc(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(e(r),n=null),t)}}function bu(t){for(let e,n,r=1,a=arguments.length;r<a;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function Qs(t,e){let n,r,a,s,h=0;if(t&&(n=t.length))if(e==null){for(r=t[h];h<n&&(r==null||r!=r);r=t[++h]);for(a=s=r;h<n;++h)r=t[h],r!=null&&(r<a&&(a=r),r>s&&(s=r))}else{for(r=e(t[h]);h<n&&(r==null||r!=r);r=e(t[++h]));for(a=s=r;h<n;++h)r=e(t[h]),r!=null&&(r<a&&(a=r),r>s&&(s=r))}return[a,s]}function wu(t,e){let n=t.length,r,a,s,h,d,g=-1;if(e==null){for(;++g<n;)if(a=t[g],a!=null&&a>=a){r=s=a;break}if(g===n)return[-1,-1];for(h=d=g;++g<n;)a=t[g],a!=null&&(r>a&&(r=a,h=g),s<a&&(s=a,d=g))}else{for(;++g<n;)if(a=e(t[g],g,t),a!=null&&a>=a){r=s=a;break}if(g===n)return[-1,-1];for(h=d=g;++g<n;)a=e(t[g],g,t),a!=null&&(r>a&&(r=a,h=g),s<a&&(s=a,d=g))}return[h,d]}let Tl=Object.prototype.hasOwnProperty;function Zo(t,e){return Tl.call(t,e)}let ji={};function Ku(t){let e,n={};function r(s){return Zo(n,s)&&n[s]!==ji}let a={size:0,empty:0,object:n,has:r,get:s=>r(s)?n[s]:void 0,set(s,h){return r(s)||(++a.size,n[s]===ji&&--a.empty),n[s]=h,this},delete(s){return r(s)&&(--a.size,++a.empty,n[s]=ji),this},clear(){a.size=a.empty=0,a.object=n={}},test(s){return arguments.length?(e=s,a):e},clean(){let s={},h=0;for(let d in n){let g=n[d];g===ji||e&&e(g)||(s[d]=g,++h)}a.size=h,a.empty=0,a.object=n=s}};return t&&Object.keys(t).forEach(s=>{a.set(s,t[s])}),a}function Zu(t,e,n,r,a,s){if(!n&&n!==0)return s;let h=+n,d,g=t[0],b=Jn(t);b<g&&(d=g,g=b,b=d),d=Math.abs(e-g);let _=Math.abs(b-e);return d<_&&d<=h?r:_<=h?a:s}function xs(t,e,n){let r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),bu(r,n)}function xu(t,e,n,r){let a,s=e[0],h=e[e.length-1];return s>h&&(a=s,s=h,h=a),r=r===void 0||r,((n=n===void 0||n)?s<=t:s<t)&&(r?t<=h:t<h)}function pa(t){return typeof t=="boolean"}function _n(t){return Object.prototype.toString.call(t)==="[object Date]"}function ls(t){return t&&uu(t[Symbol.iterator])}function Dt(t){return typeof t=="number"}function Zt(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Ce(t){return typeof t=="string"}function le(t,e,n){t&&(t=e?Xo(t).map(d=>d.replace(/\\(.)/g,"$1")):Xo(t));let r=t&&t.length,a=n&&n.get||Zn,s=d=>a(e?[d]:ai(d)),h;if(r)if(r===1){let d=s(t[0]);h=function(g){return""+d(g)}}else{let d=t.map(s);h=function(g){let b=""+d[0](g),_=0;for(;++_<r;)b+="|"+d[_](g);return b}}else h=function(){return""};return wn(h,t,"key")}function Pe(t,e){let n=t[0],r=Jn(t),a=+e;return a?a===1?r:n+a*(r-n):n}let rn=1e4;function Cn(t){let e,n,r;t=+t||rn;let a=()=>{e={},n={},r=0},s=(h,d)=>(++r>t&&(n=e,e={},r=1),e[h]=d);return a(),{clear:a,has:h=>Zo(e,h)||Zo(n,h),get:h=>Zo(e,h)?e[h]:Zo(n,h)?s(h,n[h]):void 0,set:(h,d)=>Zo(e,h)?e[h]=d:s(h,d)}}function Vn(t,e,n,r){let a=e.length,s=n.length;if(!s)return e;if(!a)return n;let h=r||new e.constructor(a+s),d=0,g=0,b=0;for(;d<a&&g<s;++b)h[b]=t(e[d],n[g])>0?n[g++]:e[d++];for(;d<a;++d,++b)h[b]=e[d];for(;g<s;++g,++b)h[b]=n[g];return h}function hr(t,e){let n="";for(;--e>=0;)n+=t;return n}function Kr(t,e,n,r){let a=n||" ",s=t+"",h=e-s.length;return h<=0?s:r==="left"?hr(a,h)+s:r==="center"?hr(a,~~(h/2))+s+hr(a,Math.ceil(h/2)):s+hr(a,h)}function $i(t){return t&&Jn(t)-t[0]||0}function Ai(t){return eo(t)?"["+t.map(Ai)+"]":Fo(t)||Ce(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Rr(t){return t==null||t===""?null:!(!t||t==="false"||t==="0")&&!!t}let Jr=t=>Dt(t)||_n(t)?t:Date.parse(t);function di(t,e){return e=e||Jr,t==null||t===""?null:e(t)}function bi(t){return t==null||t===""?null:t+""}function Ci(t){let e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function ra(t,e,n,r){let a=r??"\u2026",s=t+"",h=s.length,d=Math.max(0,e-a.length);return h<=e?s:n==="left"?a+s.slice(h-d):n==="center"?s.slice(0,Math.ceil(d/2))+a+s.slice(h-~~(d/2)):s.slice(0,d)+a}function oa(t,e,n){if(t)if(e){let r=t.length;for(let a=0;a<r;++a){let s=e(t[a]);s&&n(s,a,t)}}else t.forEach(n)}function Wr(t,e,n){return t.fields=e||[],t.fname=n,t}function _a(t){return t==null?null:t.fname}function Ca(t){return t==null?null:t.fields}function Gi(t){return t.length===1?Ea(t[0]):Ta(t)}let Ea=t=>function(e){return e[t]},Ta=t=>{let e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Dn(t){throw Error(t)}function Ui(t){let e=[],n=t.length,r,a,s,h=null,d=0,g="";function b(){e.push(g+t.substring(r,a)),g="",r=a+1}for(t+="",r=a=0;a<n;++a)if(s=t[a],s==="\\")g+=t.substring(r,a++),r=a;else if(s===h)b(),h=null,d=-1;else{if(h)continue;r===d&&s==='"'||r===d&&s==="'"?(r=a+1,h=s):s!=="."||d?s==="["?(a>r&&b(),d=r=a+1):s==="]"&&(d||Dn("Access path missing open bracket: "+t),d>0&&b(),d=0,r=a+1):a>r?b():r=a+1}return d&&Dn("Access path missing closing bracket: "+t),h&&Dn("Access path missing closing quote: "+t),a>r&&(a++,b()),e}function sa(t,e,n){let r=Ui(t);return t=r.length===1?r[0]:t,Wr((n&&n.get||Gi)(r),[t],e||t)}let ks=sa("id"),Po=Wr(t=>t,[],"identity"),ku=Wr(()=>0,[],"zero"),io=Wr(()=>1,[],"one"),an=Wr(()=>!0,[],"true"),Ms=Wr(()=>!1,[],"false");function lu(t,e,n){let r=[e].concat([].slice.call(n));console[t].apply(console,r)}let Ul=0,Ou=1,Lu=2,Ed=3,Fc=4;var ni=Array.isArray;function Zr(t){return t===Object(t)}let Qu=t=>t!=="__proto__";function Wl(t,e,n,r){if(!Qu(e))return;let a,s;if(Zr(n)&&!ni(n))for(a in s=Zr(t[e])?t[e]:t[e]={},n)r&&(r===!0||r[a])?Wl(s,a,n[a]):Qu(a)&&(s[a]=n[a]);else t[e]=n}function Yh(t,e){if(t==null)return e;let n={},r=[];function a(s){n[s.name]||(n[s.name]=1,r.push(s))}return e.forEach(a),t.forEach(a),r}function Ba(t){return t[t.length-1]}function $s(t){return t==null||t===""?null:+t}let Oc=t=>e=>t*Math.exp(e),oc=t=>e=>Math.log(t*e),sc=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),Lc=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,Ju=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function ph(t,e,n,r){let a=n(t[0]),s=n(Ba(t)),h=(s-a)*e;return[r(a-h),r(s-h)]}function $c(t,e,n,r,a){let s=r(t[0]),h=r(Ba(t)),d=e!=null?r(e):(s+h)/2;return[a(d+(s-d)*n),a(d+(h-d)*n)]}function uc(t,e,n){return $c(t,e,n,$s,Po)}function yt(t,e,n){let r=Math.sign(t[0]);return $c(t,e,n,oc(r),Oc(r))}function D(t,e,n,r){return $c(t,e,n,Ju(r),Ju(1/r))}function U(t,e,n,r){return $c(t,e,n,sc(r),Lc(r))}function et(t){return t!=null?ni(t)?t:[t]:[]}function ut(t){return typeof t=="function"}let pt="descending";function mt(t,e,n){n=n||{},e=et(e)||[];let r=[],a=[],s={},h=n.comparator||zt;return et(t).forEach((d,g)=>{d!=null&&(r.push(e[g]===pt?-1:1),a.push(d=ut(d)?d:sa(d,null,n)),(Ca(d)||[]).forEach(b=>s[b]=1))}),a.length===0?null:Wr(h(a,r),Object.keys(s))}let At=(t,e)=>(t<e||t==null)&&e!=null?-1:(t>e||e==null)&&t!=null?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e==e?-1:e!=e&&t==t?1:0),zt=(t,e)=>t.length===1?pe(t[0],e[0]):We(t,e,t.length),pe=(t,e)=>function(n,r){return At(t(n),t(r))*e},We=(t,e,n)=>(e.push(0),function(r,a){let s,h=0,d=-1;for(;h===0&&++d<n;)s=t[d],h=At(s(r),s(a));return h*e[d]});function Ke(t){return ut(t)?t:()=>t}function Tn(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(e(r),n=null),t)}}function nn(t){for(let e,n,r=1,a=arguments.length;r<a;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function un(t,e){let n,r,a,s,h=0;if(t&&(n=t.length))if(e==null){for(r=t[h];h<n&&(r==null||r!=r);r=t[++h]);for(a=s=r;h<n;++h)r=t[h],r!=null&&(r<a&&(a=r),r>s&&(s=r))}else{for(r=e(t[h]);h<n&&(r==null||r!=r);r=e(t[++h]));for(a=s=r;h<n;++h)r=e(t[h]),r!=null&&(r<a&&(a=r),r>s&&(s=r))}return[a,s]}let zn=Object.prototype.hasOwnProperty;function In(t,e){return zn.call(t,e)}let Or={};function oi(t){let e,n={};function r(s){return In(n,s)&&n[s]!==Or}let a={size:0,empty:0,object:n,has:r,get:s=>r(s)?n[s]:void 0,set(s,h){return r(s)||(++a.size,n[s]===Or&&--a.empty),n[s]=h,this},delete(s){return r(s)&&(--a.size,++a.empty,n[s]=Or),this},clear(){a.size=a.empty=0,a.object=n={}},test(s){return arguments.length?(e=s,a):e},clean(){let s={},h=0;for(let d in n){let g=n[d];g===Or||e&&e(g)||(s[d]=g,++h)}a.size=h,a.empty=0,a.object=n=s}};return t&&Object.keys(t).forEach(s=>{a.set(s,t[s])}),a}function ur(t,e,n){let r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),nn(r,n)}function Na(t,e,n,r){let a,s=e[0],h=e[e.length-1];return s>h&&(a=s,s=h,h=a),r=r===void 0||r,((n=n===void 0||n)?s<=t:s<t)&&(r?t<=h:t<h)}function fi(t){return Object.prototype.toString.call(t)==="[object Date]"}function Lr(t){return typeof t=="number"}function wi(t){return typeof t=="string"}function cs(t,e,n){t&&(t=e?et(t).map(d=>d.replace(/\\(.)/g,"$1")):et(t));let r=t&&t.length,a=n&&n.get||Gi,s=d=>a(e?[d]:Ui(d)),h;if(r)if(r===1){let d=s(t[0]);h=function(g){return""+d(g)}}else{let d=t.map(s);h=function(g){let b=""+d[0](g),_=0;for(;++_<r;)b+="|"+d[_](g);return b}}else h=function(){return""};return Wr(h,t,"key")}function Js(t,e){let n="";for(;--e>=0;)n+=t;return n}function zs(t){return t&&Ba(t)-t[0]||0}function pi(t){return ni(t)?"["+t.map(pi)+"]":Zr(t)||wi(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function cu(t){return t==null||t===""?null:!(!t||t==="false"||t==="0")&&!!t}let Vl=t=>Lr(t)||fi(t)?t:Date.parse(t);function Al(t,e){return e=e||Vl,t==null||t===""?null:e(t)}function yw(t){return t==null||t===""?null:t+""}function zc(t){let e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function r0(t,e,n){if(t)if(e){let r=t.length;for(let a=0;a<r;++a){let s=e(t[a]);s&&n(s,a,t)}}else t.forEach(n)}var vw={},mh={};function Gl(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function yn(t){var e=Object.create(null),n=[];return t.forEach(function(r){for(var a in r)a in e||n.push(e[a]=a)}),n}function Wi(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function bv(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":function(s){return s<0?"-"+Wi(-s,6):s>9999?"+"+Wi(s,6):Wi(s,4)}(t.getUTCFullYear())+"-"+Wi(t.getUTCMonth()+1,2)+"-"+Wi(t.getUTCDate(),2)+(a?"T"+Wi(e,2)+":"+Wi(n,2)+":"+Wi(r,2)+"."+Wi(a,3)+"Z":r?"T"+Wi(e,2)+":"+Wi(n,2)+":"+Wi(r,2)+"Z":n||e?"T"+Wi(e,2)+":"+Wi(n,2)+"Z":"")}function bw(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function r(d,g){var b,_=[],E=d.length,I=0,R=0,z=E<=0,P=!1;function rt(){if(z)return mh;if(P)return P=!1,vw;var at,dt,ct=I;if(d.charCodeAt(ct)===34){for(;I++<E&&d.charCodeAt(I)!==34||d.charCodeAt(++I)===34;);return(at=I)>=E?z=!0:(dt=d.charCodeAt(I++))===10?P=!0:dt===13&&(P=!0,d.charCodeAt(I)===10&&++I),d.slice(ct+1,at-1).replace(/""/g,'"')}for(;I<E;){if((dt=d.charCodeAt(at=I++))===10)P=!0;else if(dt===13)P=!0,d.charCodeAt(I)===10&&++I;else if(dt!==n)continue;return d.slice(ct,at)}return z=!0,d.slice(ct,E)}for(d.charCodeAt(E-1)===10&&--E,d.charCodeAt(E-1)===13&&--E;(b=rt())!==mh;){for(var ot=[];b!==vw&&b!==mh;)ot.push(b),b=rt();g&&(ot=g(ot,R++))==null||_.push(ot)}return _}function a(d,g){return d.map(function(b){return g.map(function(_){return h(b[_])}).join(t)})}function s(d){return d.map(h).join(t)}function h(d){return d==null?"":d instanceof Date?bv(d):e.test(d+="")?'"'+d.replace(/"/g,'""')+'"':d}return{parse:function(d,g){var b,_,E=r(d,function(I,R){if(b)return b(I,R-1);_=I,b=g?function(z,P){var rt=Gl(z);return function(ot,at){return P(rt(ot),at,z)}}(I,g):Gl(I)});return E.columns=_||[],E},parseRows:r,format:function(d,g){return g==null&&(g=yn(d)),[g.map(h).join(t)].concat(a(d,g)).join(`
`)},formatBody:function(d,g){return g==null&&(g=yn(d)),a(d,g).join(`
`)},formatRows:function(d){return d.map(s).join(`
`)},formatRow:s,formatValue:h}}function i0(t){return t}function qh(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(n){return wv(t,n)})}:wv(t,e)}function wv(t,e){var n=e.id,r=e.bbox,a=e.properties==null?{}:e.properties,s=$u(t,e);return n==null&&r==null?{type:"Feature",properties:a,geometry:s}:r==null?{type:"Feature",id:n,properties:a,geometry:s}:{type:"Feature",id:n,bbox:r,properties:a,geometry:s}}function $u(t,e){var n=function(b){if(b==null)return i0;var _,E,I=b.scale[0],R=b.scale[1],z=b.translate[0],P=b.translate[1];return function(rt,ot){ot||(_=E=0);var at=2,dt=rt.length,ct=new Array(dt);for(ct[0]=(_+=rt[0])*I+z,ct[1]=(E+=rt[1])*R+P;at<dt;)ct[at]=rt[at],++at;return ct}}(t.transform),r=t.arcs;function a(b,_){_.length&&_.pop();for(var E=r[b<0?~b:b],I=0,R=E.length;I<R;++I)_.push(n(E[I],I));b<0&&function(z,P){for(var rt,ot=z.length,at=ot-P;at<--ot;)rt=z[at],z[at++]=z[ot],z[ot]=rt}(_,R)}function s(b){return n(b)}function h(b){for(var _=[],E=0,I=b.length;E<I;++E)a(b[E],_);return _.length<2&&_.push(_[0]),_}function d(b){for(var _=h(b);_.length<4;)_.push(_[0]);return _}function g(b){return b.map(d)}return function b(_){var E,I=_.type;switch(I){case"GeometryCollection":return{type:I,geometries:_.geometries.map(b)};case"Point":E=s(_.coordinates);break;case"MultiPoint":E=_.coordinates.map(s);break;case"LineString":E=h(_.arcs);break;case"MultiLineString":E=_.arcs.map(h);break;case"Polygon":E=g(_.arcs);break;case"MultiPolygon":E=_.arcs.map(g);break;default:return null}return{type:I,coordinates:E}}(e)}function xo(t,e){var n={},r={},a={},s=[],h=-1;function d(g,b){for(var _ in g){var E=g[_];delete b[E.start],delete E.start,delete E.end,E.forEach(function(I){n[I<0?~I:I]=1}),s.push(E)}}return e.forEach(function(g,b){var _,E=t.arcs[g<0?~g:g];E.length<3&&!E[1][0]&&!E[1][1]&&(_=e[++h],e[h]=g,e[b]=_)}),e.forEach(function(g){var b,_,E=function(rt){var ot,at=t.arcs[rt<0?~rt:rt],dt=at[0];return t.transform?(ot=[0,0],at.forEach(function(ct){ot[0]+=ct[0],ot[1]+=ct[1]})):ot=at[at.length-1],rt<0?[ot,dt]:[dt,ot]}(g),I=E[0],R=E[1];if(b=a[I])if(delete a[b.end],b.push(g),b.end=R,_=r[R]){delete r[_.start];var z=_===b?b:b.concat(_);r[z.start=b.start]=a[z.end=_.end]=z}else r[b.start]=a[b.end]=b;else if(b=r[R])if(delete r[b.start],b.unshift(g),b.start=I,_=a[I]){delete a[_.end];var P=_===b?b:_.concat(b);r[P.start=_.start]=a[P.end=b.end]=P}else r[b.start]=a[b.end]=b;else r[(b=[g]).start=I]=a[b.end=R]=b}),d(a,r),d(r,a),e.forEach(function(g){n[g<0?~g:g]||s.push([g])}),s}function Xh(t){return $u(t,oe.apply(this,arguments))}function oe(t,e,n){var r,a,s;if(arguments.length>1)r=function(h,d,g){var b,_=[],E=[];function I(ot){var at=ot<0?~ot:ot;(E[at]||(E[at]=[])).push({i:ot,g:b})}function R(ot){ot.forEach(I)}function z(ot){ot.forEach(R)}function P(ot){ot.forEach(z)}function rt(ot){switch(b=ot,ot.type){case"GeometryCollection":ot.geometries.forEach(rt);break;case"LineString":R(ot.arcs);break;case"MultiLineString":case"Polygon":z(ot.arcs);break;case"MultiPolygon":P(ot.arcs)}}return rt(d),E.forEach(g==null?function(ot){_.push(ot[0].i)}:function(ot){g(ot[0].g,ot[ot.length-1].g)&&_.push(ot[0].i)}),_}(0,e,n);else for(a=0,r=new Array(s=t.arcs.length);a<s;++a)r[a]=a;return{type:"MultiLineString",arcs:xo(t,r)}}let Lt=Math.sqrt(50),ne=Math.sqrt(10),xe=Math.sqrt(2);function Oe(t,e,n){let r=(e-t)/Math.max(0,n),a=Math.floor(Math.log10(r)),s=r/Math.pow(10,a),h=s>=Lt?10:s>=ne?5:s>=xe?2:1,d,g,b;return a<0?(b=Math.pow(10,-a)/h,d=Math.round(t*b),g=Math.round(e*b),d/b<t&&++d,g/b>e&&--g,b=-b):(b=Math.pow(10,a)*h,d=Math.round(t/b),g=Math.round(e/b),d*b<t&&++d,g*b>e&&--g),g<d&&.5<=n&&n<2?Oe(t,e,2*n):[d,g,b]}function fn(t,e,n){return Oe(t=+t,e=+e,n=+n)[2]}var vn,rr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pr(t){if(!(e=rr.exec(t)))throw new Error("invalid format: "+t);var e;return new Yr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Yr(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}function qr(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function xr(t){return(t=qr(Math.abs(t)))?t[1]:NaN}function ma(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(xr(e)/3)))-xr(Math.abs(t)))}function ca(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,xr(e)-xr(t))+1}function uo(t){return Math.max(0,-xr(Math.abs(t)))}function Qo(t,e){var n=qr(t,e);if(!n)return t+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}pr.prototype=Yr.prototype,Yr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,0|this.width))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};let Ps={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Qo(100*t,e),r:Qo,s:function(t,e){var n=qr(t,e);if(!n)return t+"";var r=n[0],a=n[1],s=a-(vn=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,h=r.length;return s===h?r:s>h?r+new Array(s-h+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+qr(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Cg(t){return t}var a0,Pc,xv,u2=Array.prototype.map,Eg=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function hu(t){var e,n,r=t.grouping===void 0||t.thousands===void 0?Cg:(e=u2.call(t.grouping,Number),n=t.thousands+"",function(I,R){for(var z=I.length,P=[],rt=0,ot=e[0],at=0;z>0&&ot>0&&(at+ot+1>R&&(ot=Math.max(1,R-at)),P.push(I.substring(z-=ot,z+ot)),!((at+=ot+1)>R));)ot=e[rt=(rt+1)%e.length];return P.reverse().join(n)}),a=t.currency===void 0?"":t.currency[0]+"",s=t.currency===void 0?"":t.currency[1]+"",h=t.decimal===void 0?".":t.decimal+"",d=t.numerals===void 0?Cg:function(I){return function(R){return R.replace(/[0-9]/g,function(z){return I[+z]})}}(u2.call(t.numerals,String)),g=t.percent===void 0?"%":t.percent+"",b=t.minus===void 0?"\u2212":t.minus+"",_=t.nan===void 0?"NaN":t.nan+"";function E(I){var R=(I=pr(I)).fill,z=I.align,P=I.sign,rt=I.symbol,ot=I.zero,at=I.width,dt=I.comma,ct=I.precision,Ct=I.trim,Et=I.type;Et==="n"?(dt=!0,Et="g"):Ps[Et]||(ct===void 0&&(ct=12),Ct=!0,Et="g"),(ot||R==="0"&&z==="=")&&(ot=!0,R="0",z="=");var Rt=rt==="$"?a:rt==="#"&&/[boxX]/.test(Et)?"0"+Et.toLowerCase():"",Ot=rt==="$"?s:/[%p]/.test(Et)?g:"",Wt=Ps[Et],jt=/[defgprs%]/.test(Et);function Ht(Vt){var fe,se,he,_e=Rt,Ve=Ot;if(Et==="c")Ve=Wt(Vt)+Ve,Vt="";else{var gn=(Vt=+Vt)<0||1/Vt<0;if(Vt=isNaN(Vt)?_:Wt(Math.abs(Vt),ct),Ct&&(Vt=function(qe){t:for(var tr,er=qe.length,An=1,dn=-1;An<er;++An)switch(qe[An]){case".":dn=tr=An;break;case"0":dn===0&&(dn=An),tr=An;break;default:if(!+qe[An])break t;dn>0&&(dn=0)}return dn>0?qe.slice(0,dn)+qe.slice(tr+1):qe}(Vt)),gn&&+Vt==0&&P!=="+"&&(gn=!1),_e=(gn?P==="("?P:b:P==="-"||P==="("?"":P)+_e,Ve=(Et==="s"?Eg[8+vn/3]:"")+Ve+(gn&&P==="("?")":""),jt){for(fe=-1,se=Vt.length;++fe<se;)if(48>(he=Vt.charCodeAt(fe))||he>57){Ve=(he===46?h+Vt.slice(fe+1):Vt.slice(fe))+Ve,Vt=Vt.slice(0,fe);break}}}dt&&!ot&&(Vt=r(Vt,1/0));var $n=_e.length+Vt.length+Ve.length,Gn=$n<at?new Array(at-$n+1).join(R):"";switch(dt&&ot&&(Vt=r(Gn+Vt,Gn.length?at-Ve.length:1/0),Gn=""),z){case"<":Vt=_e+Vt+Ve+Gn;break;case"=":Vt=_e+Gn+Vt+Ve;break;case"^":Vt=Gn.slice(0,$n=Gn.length>>1)+_e+Vt+Ve+Gn.slice($n);break;default:Vt=Gn+_e+Vt+Ve}return d(Vt)}return ct=ct===void 0?6:/[gprs]/.test(Et)?Math.max(1,Math.min(21,ct)):Math.max(0,Math.min(20,ct)),Ht.toString=function(){return I+""},Ht}return{format:E,formatPrefix:function(I,R){var z=E(((I=pr(I)).type="f",I)),P=3*Math.max(-8,Math.min(8,Math.floor(xr(R)/3))),rt=Math.pow(10,-P),ot=Eg[8+P/3];return function(at){return z(rt*at)+ot}}}}(function(t){a0=hu(t),Pc=a0.format,xv=a0.formatPrefix})({thousands:",",grouping:[3],currency:["$",""]});let Bc=new Date,ww=new Date;function du(t,e,n,r){function a(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=s=>(t(s=new Date(+s)),s),a.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),a.round=s=>{let h=a(s),d=a.ceil(s);return s-h<d-s?h:d},a.offset=(s,h)=>(e(s=new Date(+s),h==null?1:Math.floor(h)),s),a.range=(s,h,d)=>{let g=[];if(s=a.ceil(s),d=d==null?1:Math.floor(d),!(s<h&&d>0))return g;let b;do g.push(b=new Date(+s)),e(s,d),t(s);while(b<s&&s<h);return g},a.filter=s=>du(h=>{if(h>=h)for(;t(h),!s(h);)h.setTime(h-1)},(h,d)=>{if(h>=h)if(d<0)for(;++d<=0;)for(;e(h,-1),!s(h););else for(;--d>=0;)for(;e(h,1),!s(h););}),n&&(a.count=(s,h)=>(Bc.setTime(+s),ww.setTime(+h),t(Bc),t(ww),Math.floor(n(Bc,ww))),a.every=s=>(s=Math.floor(s),isFinite(s)&&s>0?s>1?a.filter(r?h=>r(h)%s==0:h=>a.count(0,h)%s==0):a:null)),a}let yf=1e3,o0=6e4,l2=36e5,kv=864e5,xw=6048e5,lm=2592e6,cm=31536e6,Ds=du(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*o0)/kv,t=>t.getDate()-1),Ss=du(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/kv,t=>t.getUTCDate()-1),jc=du(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/kv,t=>Math.floor(t/kv));function ko(t){return du(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+7*n)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*o0)/xw)}let Hl=ko(0),Tg=ko(1);ko(2),ko(3);let vf=ko(4);ko(5),ko(6);function s0(t){return du(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+7*n)},(e,n)=>(n-e)/xw)}let Td=s0(0),Sv=s0(1);s0(2),s0(3);let c2=s0(4);s0(5),s0(6);let gh=du(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());gh.every=t=>isFinite(t=Math.floor(t))&&t>0?du(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)}):null;let Uc=du(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Uc.every=t=>isFinite(t=Math.floor(t))&&t>0?du(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null;let tl=du(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear()),t=>t.getMonth()),Kh=du(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear()),t=>t.getUTCMonth()),ip=du(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*yf-t.getMinutes()*o0)},(t,e)=>{t.setTime(+t+e*l2)},(t,e)=>(e-t)/l2,t=>t.getHours()),hm=du(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*l2)},(t,e)=>(e-t)/l2,t=>t.getUTCHours()),lc=du(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*yf)},(t,e)=>{t.setTime(+t+e*o0)},(t,e)=>(e-t)/o0,t=>t.getMinutes()),Ag=du(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*o0)},(t,e)=>(e-t)/o0,t=>t.getUTCMinutes()),Il=du(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*yf)},(t,e)=>(e-t)/yf,t=>t.getUTCSeconds()),bf=du(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);bf.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?du(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):bf:null);function I5(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ad(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function N5(){return 0}let kw=Math.sqrt(50),M5=Math.sqrt(10),D5=Math.sqrt(2);function Ne(t,e,n){let r=(e-t)/Math.max(0,n),a=Math.floor(Math.log10(r)),s=r/Math.pow(10,a),h=s>=kw?10:s>=M5?5:s>=D5?2:1,d,g,b;return a<0?(b=Math.pow(10,-a)/h,d=Math.round(t*b),g=Math.round(e*b),d/b<t&&++d,g/b>e&&--g,b=-b):(b=Math.pow(10,a)*h,d=Math.round(t/b),g=Math.round(e/b),d*b<t&&++d,g*b>e&&--g),g<d&&.5<=n&&n<2?Ne(t,e,2*n):[d,g,b]}function Se(t,e,n){return Ne(t=+t,e=+e,n=+n)[2]}function ke(t,e,n){n=+n;let r=(e=+e)<(t=+t),a=r?Se(e,t,n):Se(t,e,n);return(r?-1:1)*(a<0?1/-a:a)}let ve="year",Te="quarter",Fe="month",je="week",hn="date",Pn="day",On="dayofyear",sr="hours",ir="minutes",Xr="seconds",Pr="milliseconds",ci=[ve,Te,Fe,je,hn,Pn,On,sr,ir,Xr,Pr],Fa=ci.reduce((t,e,n)=>(t[e]=1+n,t),{});function Ha(t){let e=et(t).slice(),n={};return e.length||Dn("Missing time unit."),e.forEach(r=>{In(Fa,r)?n[r]=1:Dn(`Invalid time unit: ${r}.`)}),(n[je]||n[Pn]?1:0)+(n[Te]||n[Fe]||n[hn]?1:0)+(n[On]?1:0)>1&&Dn(`Incompatible time units: ${t}`),e.sort((r,a)=>Fa[r]-Fa[a]),e}let Vr={[ve]:"%Y ",[Te]:"Q%q ",[Fe]:"%b ",[hn]:"%d ",[je]:"W%U ",[Pn]:"%a ",[On]:"%j ",[sr]:"%H:00",[ir]:"00:%M",[Xr]:":%S",[Pr]:".%L",[`${ve}-${Fe}`]:"%Y-%m ",[`${ve}-${Fe}-${hn}`]:"%Y-%m-%d ",[`${sr}-${ir}`]:"%H:%M"},Vi=new Date;function Bs(t){return Vi.setFullYear(t),Vi.setMonth(0),Vi.setDate(1),Vi.setHours(0,0,0,0),Vi}function tu(t){return Ds.count(Bs(t.getFullYear())-1,t)}function To(t){return Hl.count(Bs(t.getFullYear())-1,t)}function ja(t){return Bs(t).getDay()}function Bo(t,e,n,r,a,s,h){if(0<=t&&t<100){let d=new Date(-1,e,n,r,a,s,h);return d.setFullYear(t),d}return new Date(t,e,n,r,a,s,h)}function La(t){let e=Date.UTC(t.getUTCFullYear(),0,1);return Ss.count(e-1,t)}function no(t){let e=Date.UTC(t.getUTCFullYear(),0,1);return Td.count(e-1,t)}function Ao(t){return Vi.setTime(Date.UTC(t,0,1)),Vi.getUTCDay()}function js(t,e,n,r,a,s,h){if(0<=t&&t<100){let d=new Date(Date.UTC(-1,e,n,r,a,s,h));return d.setUTCFullYear(n.y),d}return new Date(Date.UTC(t,e,n,r,a,s,h))}function Nl(t,e,n,r,a){let s=e||1,h=Ba(t),d=(ot,at,dt)=>function(ct,Ct,Et,Rt){let Ot=Et<=1?ct:Rt?(Wt,jt)=>Rt+Et*Math.floor((ct(Wt,jt)-Rt)/Et):(Wt,jt)=>Et*Math.floor(ct(Wt,jt)/Et);return Ct?(Wt,jt)=>Ct(Ot(Wt,jt),jt):Ot}(n[dt=dt||ot],r[dt],ot===h&&s,at),g=new Date,b=zc(t),_=b[ve]?d(ve):Ke(2012),E=b[Fe]?d(Fe):b[Te]?d(Te):ku,I=b[je]&&b[Pn]?d(Pn,1,je+Pn):b[je]?d(je,1):b[Pn]?d(Pn,1):b[hn]?d(hn,1):b[On]?d(On,1):io,R=b[sr]?d(sr):ku,z=b[ir]?d(ir):ku,P=b[Xr]?d(Xr):ku,rt=b[Pr]?d(Pr):ku;return function(ot){g.setTime(+ot);let at=_(g);return a(at,E(g),I(g,at),R(g),z(g),P(g),rt(g))}}function Hi(t,e,n){return e+7*t-(n+6)%7}let Id={[ve]:t=>t.getFullYear(),[Te]:t=>Math.floor(t.getMonth()/3),[Fe]:t=>t.getMonth(),[hn]:t=>t.getDate(),[sr]:t=>t.getHours(),[ir]:t=>t.getMinutes(),[Xr]:t=>t.getSeconds(),[Pr]:t=>t.getMilliseconds(),[On]:t=>tu(t),[je]:t=>To(t),[je+Pn]:(t,e)=>Hi(To(t),t.getDay(),ja(e)),[Pn]:(t,e)=>Hi(1,t.getDay(),ja(e))},Nd={[Te]:t=>3*t,[je]:(t,e)=>Hi(t,0,ja(e))};function ap(t,e){return Nl(t,e||1,Id,Nd,Bo)}let Zh={[ve]:t=>t.getUTCFullYear(),[Te]:t=>Math.floor(t.getUTCMonth()/3),[Fe]:t=>t.getUTCMonth(),[hn]:t=>t.getUTCDate(),[sr]:t=>t.getUTCHours(),[ir]:t=>t.getUTCMinutes(),[Xr]:t=>t.getUTCSeconds(),[Pr]:t=>t.getUTCMilliseconds(),[On]:t=>La(t),[je]:t=>no(t),[Pn]:(t,e)=>Hi(1,t.getUTCDay(),Ao(e)),[je+Pn]:(t,e)=>Hi(no(t),t.getUTCDay(),Ao(e))},u0={[Te]:t=>3*t,[je]:(t,e)=>Hi(t,0,Ao(e))};function X8(t,e){return Nl(t,e||1,Zh,u0,js)}let R5={[ve]:gh,[Te]:tl.every(3),[Fe]:tl,[je]:Hl,[hn]:Ds,[Pn]:Ds,[On]:Ds,[sr]:ip,[ir]:lc,[Xr]:Il,[Pr]:bf},xlt={[ve]:Uc,[Te]:Kh.every(3),[Fe]:Kh,[je]:Td,[hn]:Ss,[Pn]:Ss,[On]:Ss,[sr]:hm,[ir]:Ag,[Xr]:Il,[Pr]:bf};function Sw(t){return R5[t]}function F5(t){return xlt[t]}function K8(t,e,n){return t?t.offset(e,n):void 0}function _w(t,e,n,r){return t?t.range(e,n,r):void 0}let JD=1e3,tR=6e4,eR=36e5,nR=864e5,DG=2592e6,el=31536e6,rR=[ve,Fe,hn,sr,ir,Xr,Pr],Su=rR.slice(0,-1),O5=Su.slice(0,-1),L5=O5.slice(0,-1),klt=L5.slice(0,-1),RG=[ve,Fe],FG=[ve],$5=[[Su,1,JD],[Su,5,5e3],[Su,15,15e3],[Su,30,3e4],[O5,1,tR],[O5,5,3e5],[O5,15,9e5],[O5,30,18e5],[L5,1,eR],[L5,3,108e5],[L5,6,216e5],[L5,12,432e5],[klt,1,nR],[[ve,je],1,6048e5],[RG,1,DG],[RG,3,7776e6],[FG,1,el]];function Slt(t){let e=t.extent,n=t.maxbins||40,r=Math.abs(zs(e))/n,a,s,h=function(d){let g,b,_;function E(I,R,z=0,P=I.length){if(z<P){if(g(R,R)!==0)return P;do{let rt=z+P>>>1;b(I[rt],R)<0?z=rt+1:P=rt}while(z<P)}return z}return d.length!==2?(g=I5,b=(I,R)=>I5(d(I),R),_=(I,R)=>d(I)-R):(g=d===I5||d===Ad?d:N5,b=d,_=d),{left:E,center:function(I,R,z=0,P=I.length){let rt=E(I,R,z,P-1);return rt>z&&_(I[rt-1],R)>-_(I[rt],R)?rt-1:rt},right:function(I,R,z=0,P=I.length){if(z<P){if(g(R,R)!==0)return P;do{let rt=z+P>>>1;b(I[rt],R)<=0?z=rt+1:P=rt}while(z<P)}return z}}}(d=>d[2]).right($5,r);return h===$5.length?(a=FG,s=ke(e[0]/el,e[1]/el,n)):h?(h=$5[r/$5[h-1][2]<$5[h][2]/r?h-1:h],a=h[0],s=h[1]):(a=rR,s=Math.max(ke(e[0],e[1],n),1)),{units:a,step:s}}function iR(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function aR(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function z5(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function oR(t){var e=t.dateTime,n=t.date,r=t.time,a=t.periods,s=t.days,h=t.shortDays,d=t.months,g=t.shortMonths,b=d2(a),_=dm(a),E=d2(s),I=dm(s),R=d2(h),z=dm(h),P=d2(d),rt=dm(d),ot=d2(g),at=dm(g),dt={a:function(Wt){return h[Wt.getDay()]},A:function(Wt){return s[Wt.getDay()]},b:function(Wt){return g[Wt.getMonth()]},B:function(Wt){return d[Wt.getMonth()]},c:null,d:rE,e:rE,f:GG,g:aE,G:Mlt,H:dR,I:UG,j:WG,L:VG,m:HG,M:fR,p:function(Wt){return a[+(Wt.getHours()>=12)]},q:function(Wt){return 1+~~(Wt.getMonth()/3)},Q:kR,s:fm,S:YG,u:iE,U:Tlt,V:Alt,w:qG,W:pR,x:null,X:null,y:Ilt,Y:Nlt,Z:XG,"%":xR},ct={a:function(Wt){return h[Wt.getUTCDay()]},A:function(Wt){return s[Wt.getUTCDay()]},b:function(Wt){return g[Wt.getUTCMonth()]},B:function(Wt){return d[Wt.getUTCMonth()]},c:null,d:Ew,e:Ew,f:ZG,g:eH,G:wR,H:mR,I:oE,j:c0,L:KG,m:QG,M:Dlt,p:function(Wt){return a[+(Wt.getUTCHours()>=12)]},q:function(Wt){return 1+~~(Wt.getUTCMonth()/3)},Q:kR,s:fm,S:JG,u:tH,U:Rlt,V:yR,w:W5,W:vR,x:null,X:null,y:bR,Y:h0,Z:nH,"%":xR},Ct={a:function(Wt,jt,Ht){var Vt=R.exec(jt.slice(Ht));return Vt?(Wt.w=z.get(Vt[0].toLowerCase()),Ht+Vt[0].length):-1},A:function(Wt,jt,Ht){var Vt=E.exec(jt.slice(Ht));return Vt?(Wt.w=I.get(Vt[0].toLowerCase()),Ht+Vt[0].length):-1},b:function(Wt,jt,Ht){var Vt=ot.exec(jt.slice(Ht));return Vt?(Wt.m=at.get(Vt[0].toLowerCase()),Ht+Vt[0].length):-1},B:function(Wt,jt,Ht){var Vt=P.exec(jt.slice(Ht));return Vt?(Wt.m=rt.get(Vt[0].toLowerCase()),Ht+Vt[0].length):-1},c:function(Wt,jt,Ht){return Ot(Wt,e,jt,Ht)},d:B5,e:B5,f:Elt,g:lR,G:Md,H:jG,I:jG,j:Cw,L:eE,m:_v,M:j5,p:function(Wt,jt,Ht){var Vt=b.exec(jt.slice(Ht));return Vt?(Wt.p=_.get(Vt[0].toLowerCase()),Ht+Vt[0].length):-1},q:J8,Q:nE,s:hR,S:tE,u:Clt,U:zG,V:PG,w:$G,W:BG,x:function(Wt,jt,Ht){return Ot(Wt,n,jt,Ht)},X:function(Wt,jt,Ht){return Ot(Wt,r,jt,Ht)},y:lR,Y:Md,Z:l0,"%":cR};function Et(Wt,jt){return function(Ht){var Vt,fe,se,he=[],_e=-1,Ve=0,gn=Wt.length;for(Ht instanceof Date||(Ht=new Date(+Ht));++_e<gn;)Wt.charCodeAt(_e)===37&&(he.push(Wt.slice(Ve,_e)),(fe=OG[Vt=Wt.charAt(++_e)])!=null?Vt=Wt.charAt(++_e):fe=Vt==="e"?" ":"0",(se=jt[Vt])&&(Vt=se(Ht,fe)),he.push(Vt),Ve=_e+1);return he.push(Wt.slice(Ve,_e)),he.join("")}}function Rt(Wt,jt){return function(Ht){var Vt,fe,se=z5(1900,void 0,1);if(Ot(se,Wt,Ht+="",0)!=Ht.length)return null;if("Q"in se)return new Date(se.Q);if("s"in se)return new Date(1e3*se.s+("L"in se?se.L:0));if(jt&&!("Z"in se)&&(se.Z=0),"p"in se&&(se.H=se.H%12+12*se.p),se.m===void 0&&(se.m="q"in se?se.q:0),"V"in se){if(se.V<1||se.V>53)return null;"w"in se||(se.w=1),"Z"in se?(fe=(Vt=aR(z5(se.y,0,1))).getUTCDay(),Vt=fe>4||fe===0?Sv.ceil(Vt):Sv(Vt),Vt=Ss.offset(Vt,7*(se.V-1)),se.y=Vt.getUTCFullYear(),se.m=Vt.getUTCMonth(),se.d=Vt.getUTCDate()+(se.w+6)%7):(fe=(Vt=iR(z5(se.y,0,1))).getDay(),Vt=fe>4||fe===0?Tg.ceil(Vt):Tg(Vt),Vt=Ds.offset(Vt,7*(se.V-1)),se.y=Vt.getFullYear(),se.m=Vt.getMonth(),se.d=Vt.getDate()+(se.w+6)%7)}else("W"in se||"U"in se)&&("w"in se||(se.w="u"in se?se.u%7:"W"in se?1:0),fe="Z"in se?aR(z5(se.y,0,1)).getUTCDay():iR(z5(se.y,0,1)).getDay(),se.m=0,se.d="W"in se?(se.w+6)%7+7*se.W-(fe+5)%7:se.w+7*se.U-(fe+6)%7);return"Z"in se?(se.H+=se.Z/100|0,se.M+=se.Z%100,aR(se)):iR(se)}}function Ot(Wt,jt,Ht,Vt){for(var fe,se,he=0,_e=jt.length,Ve=Ht.length;he<_e;){if(Vt>=Ve)return-1;if((fe=jt.charCodeAt(he++))===37){if(fe=jt.charAt(he++),!(se=Ct[fe in OG?jt.charAt(he++):fe])||(Vt=se(Wt,Ht,Vt))<0)return-1}else if(fe!=Ht.charCodeAt(Vt++))return-1}return Vt}return dt.x=Et(n,dt),dt.X=Et(r,dt),dt.c=Et(e,dt),ct.x=Et(n,ct),ct.X=Et(r,ct),ct.c=Et(e,ct),{format:function(Wt){var jt=Et(Wt+="",dt);return jt.toString=function(){return Wt},jt},parse:function(Wt){var jt=Rt(Wt+="",!1);return jt.toString=function(){return Wt},jt},utcFormat:function(Wt){var jt=Et(Wt+="",ct);return jt.toString=function(){return Wt},jt},utcParse:function(Wt){var jt=Rt(Wt+="",!0);return jt.toString=function(){return Wt},jt}}}var P5,Z8,sR,Q8,uR,OG={"-":"",_:" ",0:"0"},cc=/^\s*\d+/,_lt=/^%/,h2=/[\\^$*+?|[\]().{}]/g;function Oo(t,e,n){var r=t<0?"-":"",a=(r?-t:t)+"",s=a.length;return r+(s<n?new Array(n-s+1).join(e)+a:a)}function LG(t){return t.replace(h2,"\\$&")}function d2(t){return new RegExp("^(?:"+t.map(LG).join("|")+")","i")}function dm(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function $G(t,e,n){var r=cc.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Clt(t,e,n){var r=cc.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function zG(t,e,n){var r=cc.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function PG(t,e,n){var r=cc.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function BG(t,e,n){var r=cc.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Md(t,e,n){var r=cc.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function lR(t,e,n){var r=cc.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function l0(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function J8(t,e,n){var r=cc.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function _v(t,e,n){var r=cc.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function B5(t,e,n){var r=cc.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Cw(t,e,n){var r=cc.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function jG(t,e,n){var r=cc.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function j5(t,e,n){var r=cc.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function tE(t,e,n){var r=cc.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function eE(t,e,n){var r=cc.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Elt(t,e,n){var r=cc.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function cR(t,e,n){var r=_lt.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function nE(t,e,n){var r=cc.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function hR(t,e,n){var r=cc.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function rE(t,e){return Oo(t.getDate(),e,2)}function dR(t,e){return Oo(t.getHours(),e,2)}function UG(t,e){return Oo(t.getHours()%12||12,e,2)}function WG(t,e){return Oo(1+Ds.count(gh(t),t),e,3)}function VG(t,e){return Oo(t.getMilliseconds(),e,3)}function GG(t,e){return VG(t,e)+"000"}function HG(t,e){return Oo(t.getMonth()+1,e,2)}function fR(t,e){return Oo(t.getMinutes(),e,2)}function YG(t,e){return Oo(t.getSeconds(),e,2)}function iE(t){var e=t.getDay();return e===0?7:e}function Tlt(t,e){return Oo(Hl.count(gh(t)-1,t),e,2)}function U5(t){var e=t.getDay();return e>=4||e===0?vf(t):vf.ceil(t)}function Alt(t,e){return t=U5(t),Oo(vf.count(gh(t),t)+(gh(t).getDay()===4),e,2)}function qG(t){return t.getDay()}function pR(t,e){return Oo(Tg.count(gh(t)-1,t),e,2)}function Ilt(t,e){return Oo(t.getFullYear()%100,e,2)}function aE(t,e){return Oo((t=U5(t)).getFullYear()%100,e,2)}function Nlt(t,e){return Oo(t.getFullYear()%1e4,e,4)}function Mlt(t,e){var n=t.getDay();return Oo((t=n>=4||n===0?vf(t):vf.ceil(t)).getFullYear()%1e4,e,4)}function XG(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Oo(e/60|0,"0",2)+Oo(e%60,"0",2)}function Ew(t,e){return Oo(t.getUTCDate(),e,2)}function mR(t,e){return Oo(t.getUTCHours(),e,2)}function oE(t,e){return Oo(t.getUTCHours()%12||12,e,2)}function c0(t,e){return Oo(1+Ss.count(Uc(t),t),e,3)}function KG(t,e){return Oo(t.getUTCMilliseconds(),e,3)}function ZG(t,e){return KG(t,e)+"000"}function QG(t,e){return Oo(t.getUTCMonth()+1,e,2)}function Dlt(t,e){return Oo(t.getUTCMinutes(),e,2)}function JG(t,e){return Oo(t.getUTCSeconds(),e,2)}function tH(t){var e=t.getUTCDay();return e===0?7:e}function Rlt(t,e){return Oo(Td.count(Uc(t)-1,t),e,2)}function gR(t){var e=t.getUTCDay();return e>=4||e===0?c2(t):c2.ceil(t)}function yR(t,e){return t=gR(t),Oo(c2.count(Uc(t),t)+(Uc(t).getUTCDay()===4),e,2)}function W5(t){return t.getUTCDay()}function vR(t,e){return Oo(Sv.count(Uc(t)-1,t),e,2)}function bR(t,e){return Oo(t.getUTCFullYear()%100,e,2)}function eH(t,e){return Oo((t=gR(t)).getUTCFullYear()%100,e,2)}function h0(t,e){return Oo(t.getUTCFullYear()%1e4,e,4)}function wR(t,e){var n=t.getUTCDay();return Oo((t=n>=4||n===0?c2(t):c2.ceil(t)).getUTCFullYear()%1e4,e,4)}function nH(){return"+0000"}function xR(){return"%"}function kR(t){return+t}function fm(t){return Math.floor(+t/1e3)}function Tw(t){let e={};return n=>e[n]||(e[n]=t(n))}function rH(t){let e=Tw(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(r){let a=pr(r||",");if(a.precision==null){switch(a.precision=12,a.type){case"%":a.precision-=2;break;case"e":a.precision-=1}return function(s,h){return d=>{let g=s(d),b=g.indexOf(h);if(b<0)return g;let _=function(I,R){let z,P=I.lastIndexOf("e");if(P>0)return P;for(P=I.length;--P>R;)if(z=I.charCodeAt(P),z>=48&&z<=57)return P+1}(g,b),E=_<g.length?g.slice(_):"";for(;--_>b;)if(g[_]!=="0"){++_;break}return g.slice(0,_)+E}}(e(a),e(".1f")(1)[1])}return e(a)},formatSpan(r,a,s,h){h=pr(h??",f");let d=function(_,E,I){I=+I;let R=(E=+E)<(_=+_),z=R?fn(E,_,I):fn(_,E,I);return(R?-1:1)*(z<0?1/-z:z)}(r,a,s),g=Math.max(Math.abs(r),Math.abs(a)),b;if(h.precision==null)switch(h.type){case"s":return isNaN(b=ma(d,g))||(h.precision=b),n(h,g);case"":case"e":case"g":case"p":case"r":isNaN(b=ca(d,g))||(h.precision=b-(h.type==="e"));break;case"f":case"%":isNaN(b=uo(d))||(h.precision=b-2*(h.type==="%"))}return e(h)}}}let Dd,Ig;function SR(){return Dd=rH({format:Pc,formatPrefix:xv})}function sE(t){return rH(hu(t))}function uE(t){return arguments.length?Dd=sE(t):Dd}function iH(t,e,n){Zr(n=n||{})||Dn(`Invalid time multi-format specifier: ${n}`);let r=e(Xr),a=e(ir),s=e(sr),h=e(hn),d=e(je),g=e(Fe),b=e(Te),_=e(ve),E=t(n[Pr]||".%L"),I=t(n[Xr]||":%S"),R=t(n[ir]||"%I:%M"),z=t(n[sr]||"%I %p"),P=t(n[hn]||n[Pn]||"%a %d"),rt=t(n[je]||"%b %d"),ot=t(n[Fe]||"%B"),at=t(n[Te]||"%B"),dt=t(n[ve]||"%Y");return ct=>(r(ct)<ct?E:a(ct)<ct?I:s(ct)<ct?R:h(ct)<ct?z:g(ct)<ct?d(ct)<ct?P:rt:_(ct)<ct?b(ct)<ct?ot:at:dt)(ct)}function hc(t){let e=Tw(t.format),n=Tw(t.utcFormat);return{timeFormat:r=>wi(r)?e(r):iH(e,Sw,r),utcFormat:r=>wi(r)?n(r):iH(n,F5,r),timeParse:Tw(t.parse),utcParse:Tw(t.utcParse)}}function aH(){return Ig=hc({format:Z8,parse:sR,utcFormat:Q8,utcParse:uR})}function _R(t){return hc(oR(t))}function V5(t){return arguments.length?Ig=_R(t):Ig}(function(t){P5=oR(t),Z8=P5.format,sR=P5.parse,Q8=P5.utcFormat,uR=P5.utcParse})({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),SR(),aH();let lE=(t,e)=>nn({},t,e);function oH(t,e){let n=arguments.length;return n&&n!==2&&Dn("defaultLocale expects either zero or two arguments."),n?lE(uE(t),V5(e)):lE(uE(),V5())}let sH=/^(data:|([A-Za-z]+:)?\/\/)/,uH=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,lH=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,cH="file://";function hH(t,e){return ce(this,null,function*(){let n=yield this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)})}function CR(t,e){return ce(this,null,function*(){e=nn({},this.options,e);let n=this.fileAccess,r={href:null},a,s,h,d=uH.test(t.replace(lH,""));t!=null&&typeof t=="string"&&d||Dn("Sanitize failure, invalid URI: "+pi(t));let g=sH.test(t);return(h=e.baseURL)&&!g&&(t.startsWith("/")||h.endsWith("/")||(t="/"+t),t=h+t),s=(a=t.startsWith(cH))||e.mode==="file"||e.mode!=="http"&&!g&&n,a?t=t.slice(7):t.startsWith("//")&&(e.defaultProtocol==="file"?(t=t.slice(2),s=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!s}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),e.context==="image"&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r})}function dH(t){return t?e=>new Promise((n,r)=>{t.readFile(e,(a,s)=>{a?r(a):n(s)})}):fH}function fH(){return ce(this,null,function*(){Dn("No file system access.")})}function pH(t){return t?function(e,n){return ce(this,null,function*(){let r=nn({},this.options.http,n),a=n&&n.response,s=yield t(e,r);return s.ok?ut(s[a])?s[a]():s.text():Dn(s.status+""+s.statusText)})}:mH}function mH(){return ce(this,null,function*(){Dn("No HTTP fetch method available.")})}let ER=t=>!(Number.isNaN(+t)||t instanceof Date),Ng={boolean:cu,integer:$s,number:$s,date:Al,string:yw,unknown:Po},Aw=[t=>t==="true"||t==="false"||t===!0||t===!1,t=>ER(t)&&Number.isInteger(+t),ER,t=>!Number.isNaN(Date.parse(t))],f2=["boolean","integer","number","date"];function TR(t,e){return e.reduce((n,r)=>(n[r]=function(a,s){if(!a||!a.length)return"unknown";let h=a.length,d=Aw.length,g=Aw.map((_,E)=>E+1);for(let _,E,I=0,R=0;I<h;++I)for(E=s?a[I][s]:a[I],_=0;_<d;++_)if(g[_]&&(b=E)!=null&&b==b&&!Aw[_](E)&&(g[_]=0,++R,R===Aw.length))return"string";var b;return f2[g.reduce((_,E)=>_===0?E:_,0)-1]}(t,r),n),{})}function AR(t){let e=function(n,r){let a={delimiter:t};return Cv(n,r?nn(r,a):a)};return e.responseType="text",e}function Cv(t,e){return e.header&&(t=e.header.map(pi).join(e.delimiter)+`
`+t),bw(e.delimiter).parse(t+"")}function cE(t,e){let n=e&&e.property?sa(e.property):Po;return!Zr(t)||(r=t,typeof Un=="function"&&ut(Un.isBuffer)&&Un.isBuffer(r))?n(JSON.parse(t)):function(a,s){return!ni(a)&&function(h){return h&&ut(h[Symbol.iterator])}(a)&&(a=[...a]),s&&s.copy?JSON.parse(JSON.stringify(a)):a}(n(t),e);var r}Cv.responseType="text",cE.responseType="json";let Rs={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function IR(t,e){let n,r,a,s;return t=cE(t,e),e&&e.feature?(n=qh,a=e.feature):e&&e.mesh?(n=Xh,a=e.mesh,s=Rs[e.filter]):Dn("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[a])?n(t,r,s):Dn("Invalid TopoJSON object: "+a),r&&r.features||[r]}IR.responseType="json";let Us={dsv:Cv,csv:AR(","),tsv:AR("	"),json:cE,topojson:IR};function hE(t,e){return arguments.length>1?(Us[t]=e,this):In(Us,t)?Us[t]:null}function NR(t){let e=hE(t);return e&&e.responseType||"text"}function MR(t,e,n,r){let a=hE((e=e||{}).type||"json");return a||Dn("Unknown data format type: "+e.type),t=a(t,e),e.parse&&function(s,h,d,g){if(!s.length)return;let b=V5();d=d||b.timeParse,g=g||b.utcParse;let _,E,I,R,z,P,rt=s.columns||Object.keys(s[0]);h==="auto"&&(h=TR(s,rt)),rt=Object.keys(h);let ot=rt.map(at=>{let dt=h[at],ct,Ct;if(dt&&(dt.startsWith("date:")||dt.startsWith("utc:")))return ct=dt.split(/:(.+)?/,2),Ct=ct[1],(Ct[0]==="'"&&Ct[Ct.length-1]==="'"||Ct[0]==='"'&&Ct[Ct.length-1]==='"')&&(Ct=Ct.slice(1,-1)),(ct[0]==="utc"?g:d)(Ct);if(!Ng[dt])throw Error("Illegal format pattern: "+at+":"+dt);return Ng[dt]});for(I=0,z=s.length,P=rt.length;I<z;++I)for(_=s[I],R=0;R<P;++R)E=rt[R],_[E]=ot[R](_[E])}(t,e.parse,n,r),In(t,"columns")&&delete t.columns,t}let G5=function(t,e){return n=>({options:n||{},sanitize:CR,load:hH,fileAccess:!1,file:dH(e),http:pH(t)})}(typeof fetch<"u"&&fetch,null);function Iw(t){let e=t||Po,n=[],r={};return n.add=a=>{let s=e(a);return r[s]||(r[s]=1,n.push(a)),n},n.remove=a=>{let s=e(a);if(r[s]){r[s]=0;let h=n.indexOf(a);h>=0&&n.splice(h,1)}return n},n}function Nw(t,e){return ce(this,null,function*(){try{yield e(t)}catch(n){t.error(n)}})}let Ev=Symbol("vega_id"),d0=1;function Qh(t){return!(!t||!qi(t))}function qi(t){return t[Ev]}function DR(t,e){return t[Ev]=e,t}function Jo(t){let e=t===Object(t)?t:{data:t};return qi(e)?e:DR(e,d0++)}function dE(t){return fE(t,Jo({}))}function fE(t,e){for(let n in t)e[n]=t[n];return e}function H5(t,e){return DR(e,qi(t))}function op(t,e){return t?e?(n,r)=>t(n,r)||qi(e(n))-qi(e(r)):(n,r)=>t(n,r)||qi(n)-qi(r):null}function Tv(t){return t&&t.constructor===sp}function sp(){let t=[],e=[],n=[],r=[],a=[],s=null,h=!1;return{constructor:sp,insert(d){let g=et(d),b=g.length;for(let _=0;_<b;++_)t.push(g[_]);return this},remove(d){let g=ut(d)?r:e,b=et(d),_=b.length;for(let E=0;E<_;++E)g.push(b[E]);return this},modify(d,g,b){let _={field:g,value:Ke(b)};return ut(d)?(_.filter=d,a.push(_)):(_.tuple=d,n.push(_)),this},encode(d,g){return ut(d)?a.push({filter:d,field:g}):n.push({tuple:d,field:g}),this},clean(d){return s=d,this},reflow(){return h=!0,this},pulse(d,g){let b={},_={},E,I,R,z,P,rt;for(E=0,I=g.length;E<I;++E)b[qi(g[E])]=1;for(E=0,I=e.length;E<I;++E)P=e[E],b[qi(P)]=-1;for(E=0,I=r.length;E<I;++E)z=r[E],g.forEach(at=>{z(at)&&(b[qi(at)]=-1)});for(E=0,I=t.length;E<I;++E)P=t[E],rt=qi(P),b[rt]?b[rt]=1:d.add.push(Jo(t[E]));for(E=0,I=g.length;E<I;++E)P=g[E],b[qi(P)]<0&&d.rem.push(P);function ot(at,dt,ct){ct?at[dt]=ct(at):d.encode=dt,h||(_[qi(at)]=at)}for(E=0,I=n.length;E<I;++E)R=n[E],P=R.tuple,z=R.field,rt=b[qi(P)],rt>0&&(ot(P,z,R.value),d.modifies(z));for(E=0,I=a.length;E<I;++E)R=a[E],z=R.filter,g.forEach(at=>{z(at)&&b[qi(at)]>0&&ot(at,R.field,R.value)}),d.modifies(R.field);if(h)d.mod=e.length||r.length?g.filter(at=>b[qi(at)]>0):g.slice();else for(rt in _)d.mod.push(_[rt]);return(s||s==null&&(e.length||r.length))&&d.clean(!0),d}}}let Mw="_:mod:_";function Dw(){Object.defineProperty(this,Mw,{writable:!0,value:{}})}Dw.prototype={set(t,e,n,r){let a=this,s=a[t],h=a[Mw];return e!=null&&e>=0?(s[e]!==n||r)&&(s[e]=n,h[e+":"+t]=-1,h[t]=-1):(s!==n||r)&&(a[t]=n,h[t]=ni(n)?1+n.length:-1),a},modified(t,e){let n=this[Mw];if(!arguments.length){for(let r in n)if(n[r])return!0;return!1}if(ni(t)){for(let r=0;r<t.length;++r)if(n[t[r]])return!0;return!1}return e!=null&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){return this[Mw]={},this}};let Flt=0,RR=new Dw;function ts(t,e,n,r){this.id=++Flt,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}function pE(t){return function(e){let n=this.flags;return arguments.length===0?!!(n&t):(this.flags=e?n|t:n&~t,this)}}ts.prototype={targets(){return this._targets||(this._targets=Iw(ks))},set(t){return this.value!==t?(this.value=t,1):0},skip:pE(1),modified:pE(2),parameters(t,e,n){e=e!==!1;let r=this._argval=this._argval||new Dw,a=this._argops=this._argops||[],s=[],h,d,g,b,_=(E,I,R)=>{R instanceof ts?(R!==this&&(e&&R.targets().add(this),s.push(R)),a.push({op:R,name:E,index:I})):r.set(E,I,R)};for(h in t)if(d=t[h],h==="pulse")et(d).forEach(E=>{E instanceof ts?E!==this&&(E.targets().add(this),s.push(E)):Dn("Pulse parameters must be operator instances.")}),this.source=d;else if(ni(d))for(r.set(h,-1,Array(g=d.length)),b=0;b<g;++b)_(h,b,d[b]);else _(h,-1,d);return this.marshall().clear(),n&&(a.initonly=!0),s},marshall(t){let e=this._argval||RR,n=this._argops,r,a,s,h;if(n){let d=n.length;for(a=0;a<d;++a)r=n[a],s=r.op,h=s.modified()&&s.stamp===t,e.set(r.name,r.index,s.value,h);if(n.initonly){for(a=0;a<d;++a)r=n[a],r.op.targets().remove(this);this._argops=null,this._update=null}}return e},detach(){let t=this._argops,e,n,r,a;if(t)for(e=0,n=t.length;e<n;++e)r=t[e],a=r.op,a._targets&&a._targets.remove(this);this.pulse=null,this.source=null},evaluate(t){let e=this._update;if(e){let n=this.marshall(t.stamp),r=e.call(this,n,t);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return t.StopPropagation}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t}};let FR=0;function Rw(t,e,n){this.id=++FR,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function Mg(t,e,n){return new Rw(t,e,n)}Rw.prototype={_filter:an,_apply:Po,targets(){return this._targets||(this._targets=Iw(ks))},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume},receive(t){if(this._filter(t)){let e=this.value=this._apply(t),n=this._targets,r=n?n.length:0;for(let a=0;a<r;++a)n[a].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(t){let e=Mg(t);return this.targets().add(e),e},apply(t){let e=Mg(null,t);return this.targets().add(e),e},merge(){let t=Mg();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},throttle(t){let e=-1;return this.filter(()=>{let n=Date.now();return n-e>t?(e=n,1):0})},debounce(t){let e=Mg();return this.targets().add(Mg(null,null,Tn(t,n=>{let r=n.dataflow;e.receive(n),r&&r.run&&r.run()}))),e},between(t,e){let n=!1;return t.targets().add(Mg(null,null,()=>n=!0)),e.targets().add(Mg(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=an,this._targets=null}};let gH={skip:!0};function f0(t,e,n,r,a,s){let h=nn({},s,gH),d,g;ut(n)||(n=Ke(n)),r===void 0?d=b=>t.touch(n(b)):ut(r)?(g=new ts(null,r,a,!1),d=b=>{g.evaluate(b);let _=n(b),E=g.value;Tv(E)?t.pulse(_,E,s):t.update(_,E,h)}):d=b=>t.update(n(b),r,h),e.apply(d)}function Y5(t,e,n,r,a,s){if(r===void 0)e.targets().add(n);else{let h=s||{},d=new ts(null,function(g,b){return b=ut(b)?b:Ke(b),g?function(_,E){let I=b(_,E);return g.skip()||(g.skip(I!==this.value).value=I),I}:b}(n,r),a,!1);d.modified(h.force),d.rank=e.rank,e.targets().add(d),n&&(d.skip(!0),d.value=n.value,d.targets().add(n),t.connect(n,[d]))}}let Av={};function pm(t,e,n){this.dataflow=t,this.stamp=e??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Fw(t,e){let n=[];return r0(t,e,r=>n.push(r)),n}function mE(t,e){let n={};return t.visit(e,r=>{n[qi(r)]=1}),r=>n[qi(r)]?null:r}function p2(t,e){return t?(n,r)=>t(n,r)&&e(n,r):e}function q5(t,e,n,r){let a=this,s=0;this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n;for(let h of n)if(h.stamp===e){if(h.fields){let d=a.fields||(a.fields={});for(let g in h.fields)d[g]=1}h.changed(a.ADD)&&(s|=a.ADD),h.changed(a.REM)&&(s|=a.REM),h.changed(a.MOD)&&(s|=a.MOD)}this.changes=s}function X5(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}pm.prototype={StopPropagation:Av,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(t){return new pm(this.dataflow).init(this,t)},clone(){let t=this.fork(7);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(23)},addAll(){let t=this;return!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length||(t=new pm(this.dataflow).init(this),t.add=t.source,t.rem=[]),t},init(t,e){let n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||64&e||(n.fields=t.fields),1&e?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),2&e?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),4&e?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),32&e?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n},runAfter(t){this.dataflow.runAfter(t)},changed(t){let e=t||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length},reflow(t){if(t)return this.fork(7).reflow();let e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(4,mE(this,1))),this},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans},modifies(t){let e=this.fields||(this.fields={});return ni(t)?t.forEach(n=>e[n]=!0):e[t]=!0,this},modified(t,e){let n=this.fields;return!(!e&&!this.mod.length||!n)&&(arguments.length?ni(t)?t.some(r=>n[r]):n[t]:!!n)},filter(t,e){let n=this;return 1&t&&(n.addF=p2(n.addF,e)),2&t&&(n.remF=p2(n.remF,e)),4&t&&(n.modF=p2(n.modF,e)),16&t&&(n.srcF=p2(n.srcF,e)),n},materialize(t){let e=this;return 1&(t=t||7)&&e.addF&&(e.add=Fw(e.add,e.addF),e.addF=null),2&t&&e.remF&&(e.rem=Fw(e.rem,e.remF),e.remF=null),4&t&&e.modF&&(e.mod=Fw(e.mod,e.modF),e.modF=null),16&t&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},visit(t,e){let n=this,r=e;if(16&t)return r0(n.source,n.srcF,r),n;1&t&&r0(n.add,n.addF,r),2&t&&r0(n.rem,n.remF,r),4&t&&r0(n.mod,n.modF,r);let a=n.source;if(8&t&&a){let s=n.add.length+n.mod.length;s===a.length||r0(a,s?mE(n,5):n.srcF,r)}return n}},ur(q5,pm,{fork(t){let e=new pm(this.dataflow).init(this,t&this.NO_FIELDS);return t!==void 0&&(t&e.ADD&&this.visit(e.ADD,n=>e.add.push(n)),t&e.REM&&this.visit(e.REM,n=>e.rem.push(n)),t&e.MOD&&this.visit(e.MOD,n=>e.mod.push(n))),e},changed(t){return this.changes&t},modified(t){let e=this,n=e.fields;return n&&e.changes&e.MOD?ni(t)?t.some(r=>n[r]):n[t]:0},filter(){Dn("MultiPulse does not support filtering.")},materialize(){Dn("MultiPulse does not support materialization.")},visit(t,e){let n=this,r=n.pulses,a=r.length,s=0;if(t&n.SOURCE)for(;s<a;++s)r[s].visit(t,e);else for(;s<a;++s)r[s].stamp===n.stamp&&r[s].visit(t,e);return n}});let mm={skip:!1,force:!1};function Olt(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>(e.push(n),yH(e,0,e.length-1,t)),pop:()=>{let n=e.pop(),r;return e.length?(r=e[0],e[0]=n,function(a,s,h){let d=s,g=a.length,b=a[s],_,E=1+(s<<1);for(;E<g;)_=E+1,_<g&&h(a[E],a[_])>=0&&(E=_),a[s]=a[E],E=1+((s=E)<<1);a[s]=b,yH(a,d,s,h)}(e,0,t)):r=n,r}}}function yH(t,e,n,r){let a,s,h=t[n];for(;n>e&&(s=n-1>>1,a=t[s],r(h,a)<0);)t[n]=a,n=s;return t[n]=h}function Dg(){this.logger(function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:lu,r=t||Ul;return{level(a){return arguments.length?(r=+a,this):r},error(){return r>=Ou&&n("error","ERROR",arguments),this},warn(){return r>=Lu&&n("warn","WARN",arguments),this},info(){return r>=Ed&&n("log","INFO",arguments),this},debug(){return r>=Fc&&n("log","DEBUG",arguments),this}}}()),this.logLevel(Ou),this._clock=0,this._rank=0,this._locale=oH();try{this._loader=G5()}catch{}this._touched=Iw(ks),this._input={},this._pulse=null,this._heap=Olt((t,e)=>t.qrank-e.qrank),this._postrun=[]}function Iv(t){return function(){return this._log[t].apply(this,arguments)}}function ar(t,e){ts.call(this,t,null,e)}Dg.prototype={stamp(){return this._clock},loader(t){return arguments.length?(this._loader=t,this):this._loader},locale(t){return arguments.length?(this._locale=t,this):this._locale},logger(t){return arguments.length?(this._log=t,this):this._log},error:Iv("error"),warn:Iv("warn"),info:Iv("info"),debug:Iv("debug"),logLevel:Iv("level"),cleanThreshold:1e4,add:function(t,e,n,r){let a,s=1;return t instanceof ts?a=t:t&&t.prototype instanceof ts?a=new t:ut(t)?a=new ts(null,t):(s=0,a=new ts(t,e)),this.rank(a),s&&(r=n,n=e),n&&this.connect(a,a.parameters(n,r)),this.touch(a),a},connect:function(t,e){let n=t.rank,r=e.length;for(let a=0;a<r;++a)if(n<e[a].rank)return void this.rerank(t)},rank:function(t){t.rank=++this._rank},rerank:function(t){let e=[t],n,r,a;for(;e.length;)if(this.rank(n=e.pop()),r=n._targets)for(a=r.length;--a>=0;)e.push(n=r[a]),n===t&&Dn("Cycle detected in dataflow graph.")},pulse:function(t,e,n){this.touch(t,n||mm);let r=new pm(this,this._clock+(this._pulse?0:1)),a=t.pulse&&t.pulse.source||[];return r.target=t,this._input[t.id]=e.pulse(r,a),this},touch:function(t,e){let n=e||mm;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this},update:function(t,e,n){let r=n||mm;return(t.set(e)||r.force)&&this.touch(t,r),this},changeset:sp,ingest:function(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e))},parse:function(t,e){let n=this.locale();return MR(t,e,n.timeParse,n.utcParse)},preload:function(t,e,n){return ce(this,null,function*(){let r=this,a=r._pending||function(h){let d,g=new Promise(b=>d=b);return g.requests=0,g.done=()=>{--g.requests==0&&(h._pending=null,d(h))},h._pending=g}(r);a.requests+=1;let s=yield r.request(e,n);return r.pulse(t,r.changeset().remove(an).insert(s.data||[])),a.done(),s})},request:function(t,e){return ce(this,null,function*(){let n=this,r,a=0;try{r=yield n.loader().load(t,{context:"dataflow",response:NR(e&&e.type)});try{r=n.parse(r,e)}catch(s){a=-2,n.warn("Data ingestion failed",t,s)}}catch(s){a=-1,n.warn("Loading failed",t,s)}return{data:r,status:a}})},events:function(t,e,n,r){let a=this,s=Mg(n,r),h=function(b){b.dataflow=a;try{s.receive(b)}catch(_){a.error(_)}finally{a.run()}},d;d=typeof t=="string"&&typeof document<"u"?document.querySelectorAll(t):et(t);let g=d.length;for(let b=0;b<g;++b)d[b].addEventListener(e,h);return s},on:function(t,e,n,r,a){return(t instanceof ts?Y5:f0)(this,t,e,n,r,a),this},evaluate:function(t,e,n){return ce(this,null,function*(){let r=this,a=[];if(r._pulse)return X5(r);if(r._pending&&(yield r._pending),e&&(yield Nw(r,e)),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;let s=++r._clock;r._pulse=new pm(r,s,t),r._touched.forEach(_=>r._enqueue(_,!0)),r._touched=Iw(ks);let h,d,g,b=0;try{for(;r._heap.size()>0;)h=r._heap.pop(),h.rank===h.qrank?(d=h.run(r._getPulse(h,t)),d.then?d=yield d:d.async&&(a.push(d.async),d=Av),d!==Av&&h._targets&&h._targets.forEach(_=>r._enqueue(_)),++b):r._enqueue(h,!0)}catch(_){r._heap.clear(),g=_}if(r._input={},r._pulse=null,r.debug(`Pulse ${s}: ${b} operators`),g&&(r._postrun=[],r.error(g)),r._postrun.length){let _=r._postrun.sort((E,I)=>I.priority-E.priority);r._postrun=[];for(let E=0;E<_.length;++E)yield Nw(r,_[E].callback)}return n&&(yield Nw(r,n)),a.length&&Promise.all(a).then(_=>r.runAsync(null,()=>{_.forEach(E=>{try{E(r)}catch(I){r.error(I)}})})),r})},run:function(t,e,n){return this._pulse?X5(this):(this.evaluate(t,e,n),this)},runAsync:function(t,e,n){return ce(this,null,function*(){for(;this._running;)yield this._running;let r=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(r,r),this._running})},runAfter:function(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(r){this.error(r)}},_enqueue:function(t,e){let n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))},_getPulse:function(t,e){let n=t.source,r=this._clock;return n&&ni(n)?new q5(this,r,n.map(a=>a.pulse),e):this._input[t.id]||function(a,s){return s&&s.stamp===a.stamp?s:(a=a.fork(),s&&s!==Av&&(a.source=s.source),a)}(this._pulse,n&&n.pulse)}},ur(ar,ts,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then(n=>this.pulse=n):e!==t.StopPropagation&&(this.pulse=e),e},evaluate(t){let e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},transform(){}});let m2={};function gE(t){let e=yE(t);return e&&e.Definition||null}function yE(t){return t=t&&t.toLowerCase(),In(m2,t)?m2[t]:null}function Ow(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function vE(t,e){let n;for(let r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function bE(t,e){let n;for(let r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function OR(t=Ow){if(t===Ow)return wE;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{let r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function wE(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}function xE(t,e,n=0,r=1/0,a){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(a=a===void 0?wE:OR(a);r>n;){if(r-n>600){let g=r-n+1,b=e-n+1,_=Math.log(g),E=.5*Math.exp(2*_/3),I=.5*Math.sqrt(_*E*(g-E)/g)*(b-g/2<0?-1:1);xE(t,e,Math.max(n,Math.floor(e-b*E/g+I)),Math.min(r,Math.floor(e+(g-b)*E/g+I)),a)}let s=t[e],h=n,d=r;for(p0(t,n,e),a(t[r],s)>0&&p0(t,n,r);h<d;){for(p0(t,h,d),++h,--d;a(t[h],s)<0;)++h;for(;a(t[d],s)>0;)--d}a(t[n],s)===0?p0(t,n,d):(++d,p0(t,d,r)),d<=e&&(n=d+1),e<=d&&(r=d-1)}return t}function p0(t,e,n){let r=t[e];t[e]=t[n],t[n]=r}function LR(t){return t===null?NaN:+t}function K5(t,e,n){if(t=Float64Array.from(function*(d,g){for(let b of d)b!=null&&(b=+b)>=b&&(yield b)}(t)),(r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return bE(t);if(e>=1)return vE(t);var r,a=(r-1)*e,s=Math.floor(a),h=vE(xE(t,s).subarray(0,s+1));return h+(bE(t.subarray(s+1))-h)*(a-s)}}function $R(t,e){return K5(t,.5)}function*kE(t,e){if(e==null)for(let n of t)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function SE(t,e,n){let r=Float64Array.from(kE(t,n));return r.sort(Ow),e.map(a=>function(s,h,d=LR){if((g=s.length)&&!isNaN(h=+h)){if(h<=0||g<2)return+d(s[0],0,s);if(h>=1)return+d(s[g-1],g-1,s);var g,b=(g-1)*h,_=Math.floor(b),E=+d(s[_],_,s);return E+(+d(s[_+1],_+1,s)-E)*(b-_)}}(r,a))}function _E(t,e){return SE(t,[.25,.5,.75],e)}function Lw(t,e){let n=t.length,r=function(h,d){let g=function(b,_){let E,I=0,R=0,z=0;if(_===void 0)for(let P of b)P!=null&&(P=+P)>=P&&(E=P-R,R+=E/++I,z+=E*(P-R));else{let P=-1;for(let rt of b)(rt=_(rt,++P,b))!=null&&(rt=+rt)>=rt&&(E=rt-R,R+=E/++I,z+=E*(rt-R))}if(I>1)return z/(I-1)}(h,d);return g&&Math.sqrt(g)}(t,e),a=_E(t,e),s=(a[2]-a[0])/1.34;return 1.06*(Math.min(r,s)||r||Math.abs(a[0])||1)*Math.pow(n,-.2)}var m0=Math.random;function zR(t,e,n,r){r=r||(I=>I);let a=t.length,s=new Float64Array(a),h,d=0,g=1,b=r(t[0]),_=b,E=b+e;for(;g<a;++g){if(h=r(t[g]),h>=E){for(_=(b+_)/2;d<g;++d)s[d]=_;E=h+e,b=h}_=h}for(_=(b+_)/2;d<g;++d)s[d]=_;return n?function(I,R){let z=I.length,P,rt,ot=0,at=1;for(;I[ot]===I[at];)++at;for(;at<z;){for(P=at+1;I[at]===I[P];)++P;if(I[at]-I[at-1]<R){for(rt=at+(ot+P-at-at>>1);rt<at;)I[rt++]=I[at];for(;rt>at;)I[rt--]=I[ot]}ot=at,at=P}return I}(s,e+e/4):s}let CE=Math.sqrt(2*Math.PI),PR=Math.SQRT2,Rg=NaN;function BR(t,e){t=t||0,e=e??1;let n,r,a=0,s=0;if(Rg==Rg)a=Rg,Rg=NaN;else{do a=2*m0()-1,s=2*m0()-1,n=a*a+s*s;while(n===0||n>1);r=Math.sqrt(-2*Math.log(n)/n),a*=r,Rg=s*r}return t+a*e}function EE(t,e,n){let r=(t-(e||0))/(n=n??1);return Math.exp(-.5*r*r)/(n*CE)}function Z5(t,e,n){let r=(t-(e=e||0))/(n=n??1),a=Math.abs(r),s;if(a>37)s=0;else{let h=Math.exp(-a*a/2),d;a<7.07106781186547?(d=.0352624965998911*a+.700383064443688,d=d*a+6.37396220353165,d=d*a+33.912866078383,d=d*a+112.079291497871,d=d*a+221.213596169931,d=d*a+220.206867912376,s=h*d,d=.0883883476483184*a+1.75566716318264,d=d*a+16.064177579207,d=d*a+86.7807322029461,d=d*a+296.564248779674,d=d*a+637.333633378831,d=d*a+793.826512519948,d=d*a+440.413735824752,s/=d):(d=a+.65,d=a+4/d,d=a+3/d,d=a+2/d,d=a+1/d,s=h/d/2.506628274631)}return r>0?1-s:s}function Q5(t,e,n){return t<0||t>1?NaN:(e||0)+(n??1)*PR*function(r){let a,s=-Math.log((1-r)*(1+r));return s<6.25?(s-=3.125,a=-364441206401782e-35,a=a*s-16850591381820166e-35,a=128584807152564e-32+a*s,a=11157877678025181e-33+a*s,a=a*s-1333171662854621e-31,a=20972767875968562e-33+a*s,a=6637638134358324e-30+a*s,a=a*s-4054566272975207e-29,a=a*s-8151934197605472e-29,a=26335093153082323e-28+a*s,a=a*s-12975133253453532e-27,a=a*s-5415412054294628e-26,a=10512122733215323e-25+a*s,a=a*s-4112633980346984e-24,a=a*s-29070369957882005e-24,a=42347877827932404e-23+a*s,a=a*s-13654692000834679e-22,a=a*s-13882523362786469e-21,a=.00018673420803405714+a*s,a=a*s-.000740702534166267,a=a*s-.006033670871430149,a=.24015818242558962+a*s,a=1.6536545626831027+a*s):s<16?(s=Math.sqrt(s)-3.25,a=22137376921775787e-25,a=9075656193888539e-23+a*s,a=a*s-27517406297064545e-23,a=18239629214389228e-24+a*s,a=15027403968909828e-22+a*s,a=a*s-4013867526981546e-21,a=29234449089955446e-22+a*s,a=12475304481671779e-21+a*s,a=a*s-47318229009055734e-21,a=6828485145957318e-20+a*s,a=24031110387097894e-21+a*s,a=a*s-.0003550375203628475,a=.0009532893797373805+a*s,a=a*s-.0016882755560235047,a=.002491442096107851+a*s,a=a*s-.003751208507569241,a=.005370914553590064+a*s,a=1.0052589676941592+a*s,a=3.0838856104922208+a*s):Number.isFinite(s)?(s=Math.sqrt(s)-5,a=-27109920616438573e-27,a=a*s-2555641816996525e-25,a=15076572693500548e-25+a*s,a=a*s-3789465440126737e-24,a=761570120807834e-23+a*s,a=a*s-1496002662714924e-23,a=2914795345090108e-23+a*s,a=a*s-6771199775845234e-23,a=22900482228026655e-23+a*s,a=a*s-99298272942317e-20,a=4526062597223154e-21+a*s,a=a*s-1968177810553167e-20,a=7599527703001776e-20+a*s,a=a*s-.00021503011930044477,a=a*s-.00013871931833623122,a=1.0103004648645344+a*s,a=4.849906401408584+a*s):a=1/0,a*r}(2*t-1)}function J5(t,e){let n,r,a={mean(s){return arguments.length?(n=s||0,a):n},stdev(s){return arguments.length?(r=s??1,a):r},sample:()=>BR(n,r),pdf:s=>EE(s,n,r),cdf:s=>Z5(s,n,r),icdf:s=>Q5(s,n,r)};return a.mean(t).stdev(e)}function jR(t,e){let n=J5(),r=0,a={data(s){return arguments.length?(t=s,r=s?s.length:0,a.bandwidth(e)):t},bandwidth(s){return arguments.length?(!(e=s)&&t&&(e=Lw(t)),a):e},sample:()=>t[~~(m0()*r)]+e*n.sample(),pdf(s){let h=0,d=0;for(;d<r;++d)h+=n.pdf((s-t[d])/e);return h/e/r},cdf(s){let h=0,d=0;for(;d<r;++d)h+=n.cdf((s-t[d])/e);return h/r},icdf(){throw Error("KDE icdf not supported.")}};return a.data(t)}function UR(t,e){return t=t||0,e=e??1,Math.exp(t+BR()*e)}function TE(t,e,n){if(t<=0)return 0;e=e||0,n=n??1;let r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*CE*t)}function AE(t,e,n){return Z5(Math.log(t),e,n)}function WR(t,e,n){return Math.exp(Q5(t,e,n))}function IE(t,e){return e==null&&(e=t??1,t=0),t+(e-t)*m0()}function NE(t,e,n){return n==null&&(n=e??1,e=0),t>=e&&t<=n?1/(n-e):0}function VR(t,e,n){return n==null&&(n=e??1,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function ME(t,e,n){return n==null&&(n=e??1,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function Nv(t,e,n,r){let a=r-t*t,s=Math.abs(a)<1e-24?0:(n-t*e)/a;return[e-s*t,s]}function tS(t,e,n,r){t=t.filter(R=>{let z=e(R),P=n(R);return z!=null&&(z=+z)>=z&&P!=null&&(P=+P)>=P}),r&&t.sort((R,z)=>e(R)-e(z));let a=t.length,s=new Float64Array(a),h=new Float64Array(a),d,g,b,_=0,E=0,I=0;for(b of t)s[_]=d=+e(b),h[_]=g=+n(b),++_,E+=(d-E)/_,I+=(g-I)/_;for(_=0;_<a;++_)s[_]-=E,h[_]-=I;return[s,h,E,I]}function Mv(t,e,n,r){let a,s,h=-1;for(let d of t)a=e(d),s=n(d),a!=null&&(a=+a)>=a&&s!=null&&(s=+s)>=s&&r(a,s,++h)}function g2(t,e,n,r,a){let s=0,h=0;return Mv(t,e,n,(d,g)=>{let b=g-a(d),_=g-r;s+=b*b,h+=_*_}),1-s/h}function GR(t,e,n){let r=0,a=0,s=0,h=0,d=0;Mv(t,e,n,(_,E)=>{++d,r+=(_-r)/d,a+=(E-a)/d,s+=(_*E-s)/d,h+=(_*_-h)/d});let g=Nv(r,a,s,h),b=_=>g[0]+g[1]*_;return{coef:g,predict:b,rSquared:g2(t,e,n,a,b)}}function DE(t,e,n){let[r,a,s,h]=tS(t,e,n),d=r.length,g,b,_,E,I=0,R=0,z=0,P=0,rt=0;for(g=0;g<d;)b=r[g],_=a[g++],E=b*b,I+=(E-I)/g,R+=(E*b-R)/g,z+=(E*E-z)/g,P+=(b*_-P)/g,rt+=(E*_-rt)/g;let ot=z-I*I,at=I*ot-R*R,dt=(rt*I-P*R)/at,ct=(P*ot-rt*R)/at,Ct=-dt*I,Et=Rt=>dt*(Rt-=s)*Rt+ct*Rt+Ct+h;return{coef:[Ct-ct*s+dt*s*s+h,ct-2*dt*s,dt],predict:Et,rSquared:g2(t,e,n,h,Et)}}function HR(t,e,n,r){let a=Array(t),s,h,d,g;for(s=0;s<t;++s)a[s]=0;for(s=t-1;s>=0;--s)for(d=e[s],g=1,a[s]+=d,h=1;h<=s;++h)g*=(s+1-h)/h,a[s-h]+=d*Math.pow(n,h)*g;return a[0]+=r,a}function vH(t){return(t=1-t*t*t)*t*t}function YR(t,e,n){let r=t[e],a=n[0],s=n[1]+1;if(!(s>=t.length))for(;e>a&&t[s]-r<=r-t[a];)n[0]=++a,n[1]=s,++s}let qR=.5*Math.PI/180;function eS(t,e,n,r){n=n||25,r=Math.max(n,r||200);let a=P=>[P,t(P)],s=e[0],h=e[1],d=h-s,g=d/r,b=[a(s)],_=[];if(n===r){for(let P=1;P<r;++P)b.push(a(s+P/n*d));return b.push(a(h)),b}_.push(a(h));for(let P=n;--P>0;)_.push(a(s+P/n*d));let E=b[0],I=_[_.length-1],R=1/d,z=function(P,rt){let ot=P,at=P,dt=rt.length;for(let ct=0;ct<dt;++ct){let Ct=rt[ct][1];Ct<ot&&(ot=Ct),Ct>at&&(at=Ct)}return 1/(at-ot)}(E[1],_);for(;I;){let P=a((E[0]+I[0])/2);P[0]-E[0]>=g&&Llt(E,P,I,R,z)>qR?_.push(P):(E=I,b.push(I),_.pop()),I=_[_.length-1]}return b}function Llt(t,e,n,r,a){let s=Math.atan2(a*(n[1]-t[1]),r*(n[0]-t[0])),h=Math.atan2(a*(e[1]-t[1]),r*(e[0]-t[0]));return Math.abs(s-h)}function Dv(t,e){let n;if(e===void 0)for(let r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let a of t)(a=e(a,++r,t))!=null&&(n<a||n===void 0&&a>=a)&&(n=a)}return n}function nS(t,e){let n;if(e===void 0)for(let r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let a of t)(a=e(a,++r,t))!=null&&(n>a||n===void 0&&a>=a)&&(n=a)}return n}function y2(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function XR(t,e,n=0,r=t.length-1,a=y2){for(;r>n;){if(r-n>600){let g=r-n+1,b=e-n+1,_=Math.log(g),E=.5*Math.exp(2*_/3),I=.5*Math.sqrt(_*E*(g-E)/g)*(b-g/2<0?-1:1);XR(t,e,Math.max(n,Math.floor(e-b*E/g+I)),Math.min(r,Math.floor(e+(g-b)*E/g+I)),a)}let s=t[e],h=n,d=r;for(Rv(t,n,e),a(t[r],s)>0&&Rv(t,n,r);h<d;){for(Rv(t,h,d),++h,--d;a(t[h],s)<0;)++h;for(;a(t[d],s)>0;)--d}a(t[n],s)===0?Rv(t,n,d):(++d,Rv(t,d,r)),d<=e&&(n=d+1),e<=d&&(r=d-1)}return t}function Rv(t,e,n){let r=t[e];t[e]=t[n],t[n]=r}function bH(t){return t===null?NaN:+t}function KR(t,e,n){if(t=Float64Array.from(function*(d,g){if(g===void 0)for(let b of d)b!=null&&(b=+b)>=b&&(yield b);else{let b=-1;for(let _ of d)(_=g(_,++b,d))!=null&&(_=+_)>=_&&(yield _)}}(t,n)),r=t.length){if((e=+e)<=0||r<2)return nS(t);if(e>=1)return Dv(t);var r,a=(r-1)*e,s=Math.floor(a),h=Dv(XR(t,s).subarray(0,s+1));return h+(nS(t.subarray(s+1))-h)*(a-s)}}function ZR(t,e,n=bH){if(r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,a=(r-1)*e,s=Math.floor(a),h=+n(t[s],s,t);return h+(+n(t[s+1],s+1,t)-h)*(a-s)}}function RE(t,e){return KR(t,.5,e)}function wf(t,e,n){t=+t,e=+e,n=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((e-t)/n)),s=new Array(a);++r<a;)s[r]=t+r*n;return s}function rS(t){let e=t,n=t;function r(a,s,h,d){for(h==null&&(h=0),d==null&&(d=a.length);h<d;){let g=h+d>>>1;n(a[g],s)<0?h=g+1:d=g}return h}return t.length===1&&(e=(a,s)=>t(a)-s,n=function(a){return(s,h)=>y2(a(s),h)}(t)),{left:r,center:function(a,s,h,d){h==null&&(h=0),d==null&&(d=a.length);let g=r(a,s,h,d-1);return g>h&&e(a[g-1],s)>-e(a[g],s)?g-1:g},right:function(a,s,h,d){for(h==null&&(h=0),d==null&&(d=a.length);h<d;){let g=h+d>>>1;n(a[g],s)>0?d=g:h=g+1}return h}}}function QR(t){return t&&t.length?t.length===1?t[0]:(e=t,n=>{let r=e.length,a=1,s=String(e[0](n));for(;a<r;++a)s+="|"+e[a](n);return s}):function(){return""};var e}function wH(t,e,n){return n||t+(e?"_"+e:"")}let JR=()=>{},$lt={init:JR,add:JR,rem:JR,idx:0},iS={values:{init:t=>t.cell.store=!0,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.sum,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:void 0,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:void 0,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:void 0,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):void 0,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:void 0,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):void 0,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=void 0,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{(e<t.min||t.min===void 0)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)},req:["values"],idx:4},max:{init:t=>t.max=void 0,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{(e>t.max||t.max===void 0)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)},req:["values"],idx:4},argmin:{init:t=>t.argmin=void 0,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{e<t.min&&(t.argmin=n)},rem:(t,e)=>{e<=t.min&&(t.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=void 0,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{e>t.max&&(t.argmax=n)},rem:(t,e)=>{e>=t.max&&(t.argmax=void 0)},req:["max","values"],idx:3}},aS=Object.keys(iS);function xH(t,e){return iS[t](e)}function kH(t,e){return t.idx-e.idx}function zlt(){this.valid=0,this.missing=0,this._ops.forEach(t=>t.init(this))}function Plt(t,e){t!=null&&t!==""?t==t&&(++this.valid,this._ops.forEach(n=>n.add(this,t,e))):++this.missing}function Blt(t,e){t!=null&&t!==""?t==t&&(--this.valid,this._ops.forEach(n=>n.rem(this,t,e))):--this.missing}function jlt(t){return this._out.forEach(e=>t[e.out]=e.value(this)),t}function SH(t,e){let n=e||Po,r=function(h){let d={};h.forEach(b=>d[b.name]=b);let g=b=>{b.req&&b.req.forEach(_=>{d[_]||g(d[_]=iS[_]())})};return h.forEach(g),Object.values(d).sort(kH)}(t),a=t.slice().sort(kH);function s(h){this._ops=r,this._out=a,this.cell=h,this.init()}return s.prototype.init=zlt,s.prototype.add=Plt,s.prototype.rem=Blt,s.prototype.set=jlt,s.prototype.get=n,s.fields=t.map(h=>h.out),s}function tF(t){this._key=t?sa(t):qi,this.reset()}aS.forEach(t=>{iS[t]=function(e,n){return r=>nn({name:e,out:r||e},$lt,n)}(t,iS[t])});let Wc=tF.prototype;function Fg(t){ar.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Wc.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Wc.add=function(t){this._add.push(t)},Wc.rem=function(t){this._rem.push(t)},Wc.values=function(){if(this._get=null,this._rem.length===0)return this._add;let t=this._add,e=this._rem,n=this._key,r=t.length,a=e.length,s=Array(r-a),h={},d,g,b;for(d=0;d<a;++d)h[n(e[d])]=1;for(d=0,g=0;d<r;++d)h[n(b=t[d])]?h[n(b)]=0:s[g++]=b;return this._rem=[],this._add=s},Wc.distinct=function(t){let e=this.values(),n={},r,a=e.length,s=0;for(;--a>=0;)r=t(e[a])+"",In(n,r)||(n[r]=1,++s);return s},Wc.extent=function(t){if(this._get!==t||!this._ext){let e=this.values(),n=function(r,a){let s=r.length,h,d,g,b,_,E=-1;if(a==null){for(;++E<s;)if(d=r[E],d!=null&&d>=d){h=g=d;break}if(E===s)return[-1,-1];for(b=_=E;++E<s;)d=r[E],d!=null&&(h>d&&(h=d,b=E),g<d&&(g=d,_=E))}else{for(;++E<s;)if(d=a(r[E],E,r),d!=null&&d>=d){h=g=d;break}if(E===s)return[-1,-1];for(b=_=E;++E<s;)d=a(r[E],E,r),d!=null&&(h>d&&(h=d,b=E),g<d&&(g=d,_=E))}return[b,_]}(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext},Wc.argmin=function(t){return this.extent(t)[0]||{}},Wc.argmax=function(t){return this.extent(t)[1]||{}},Wc.min=function(t){let e=this.extent(t)[0];return e!=null?t(e):void 0},Wc.max=function(t){let e=this.extent(t)[1];return e!=null?t(e):void 0},Wc.quartile=function(t){return this._get===t&&this._q||(this._q=_E(this.values(),t),this._get=t),this._q},Wc.q1=function(t){return this.quartile(t)[0]},Wc.q2=function(t){return this.quartile(t)[1]},Wc.q3=function(t){return this.quartile(t)[2]},Wc.ci=function(t){return this._get===t&&this._ci||(this._ci=function(e,n,r,a){if(!e.length)return[void 0,void 0];let s=Float64Array.from(kE(e,a)),h=s.length,d=n,g,b,_,E;for(_=0,E=Array(d);_<d;++_){for(g=0,b=0;b<h;++b)g+=s[~~(m0()*h)];E[_]=g/h}return E.sort(Ow),[K5(E,r/2),K5(E,1-r/2)]}(this.values(),1e3,.05,t),this._get=t),this._ci},Wc.ci0=function(t){return this.ci(t)[0]},Wc.ci1=function(t){return this.ci(t)[1]},Fg.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:aS},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},ur(Fg,ar,{transform(t,e){let n=this,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),a=t.modified();return n.stamp=r.stamp,n.value&&(a||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=a?n.init(t):{},e.visit(e.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(t),e.visit(e.REM,s=>n.rem(s)),e.visit(e.ADD,s=>n.add(s))),r.modifies(n._outputs),n._drop=t.drop!==!1,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),e.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){let t=this,e=t.value,n=t._dnames,r=n.map(()=>({})),a=n.length;function s(h){let d,g,b,_;for(d in h)for(b=h[d].tuple,g=0;g<a;++g)r[g][_=b[n[g]]]=_}s(t._prev),s(e),function h(d,g,b){let _=n[b],E=r[b++];for(let I in E){let R=d?d+"|"+I:I;g[_]=E[I],b<a?h(R,g,b):e[R]||t.cell(R,g)}}("",{},0)},init(t){let e=this._inputs=[],n=this._outputs=[],r={};function a(rt){let ot=et(Ca(rt)),at=ot.length,dt,ct=0;for(;ct<at;++ct)r[dt=ot[ct]]||(r[dt]=1,e.push(dt))}this._dims=et(t.groupby),this._dnames=this._dims.map(rt=>{let ot=_a(rt);return a(rt),n.push(ot),ot}),this.cellkey=t.key?t.key:QR(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];let s=t.fields||[null],h=t.ops||["count"],d=t.as||[],g=s.length,b={},_,E,I,R,z,P;for(g!==h.length&&Dn("Unmatched number of fields and aggregate ops."),P=0;P<g;++P)_=s[P],E=h[P],_==null&&E!=="count"&&Dn("Null aggregate field specified."),R=_a(_),z=wH(E,R,d[P]),n.push(z),E!=="count"?(I=b[R],I||(a(_),I=b[R]=[],I.field=_,this._measures.push(I)),E!=="count"&&(this._countOnly=!1),I.push(xH(E,z))):this._counts.push(z);return this._measures=this._measures.map(rt=>SH(rt,rt.field)),{}},cellkey:QR(),cell(t,e){let n=this.value[t];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},newcell(t,e){let n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){let r=this._measures,a=r.length;n.agg=Array(a);for(let s=0;s<a;++s)n.agg[s]=new r[s](n)}return n.store&&(n.data=new tF),n},newtuple(t,e){let n=this._dnames,r=this._dims,a=r.length,s={};for(let h=0;h<a;++h)s[n[h]]=r[h](t);return e?H5(e.tuple,s):Jo(s)},clean(){let t=this.value;for(let e in t)t[e].num===0&&delete t[e]},add(t){let e=this.cellkey(t),n=this.cell(e,t);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(t);let r=n.agg;for(let a=0,s=r.length;a<s;++a)r[a].add(r[a].get(t),t)},rem(t){let e=this.cellkey(t),n=this.cell(e,t);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(t);let r=n.agg;for(let a=0,s=r.length;a<s;++a)r[a].rem(r[a].get(t),t)},celltuple(t){let e=t.tuple,n=this._counts;t.store&&t.data.values();for(let r=0,a=n.length;r<a;++r)e[n[r]]=t.num;if(!this._countOnly){let r=t.agg;for(let a=0,s=r.length;a<s;++a)r[a].set(e)}return e},changes(t){let e=this._adds,n=this._mods,r=this._prev,a=this._drop,s=t.add,h=t.rem,d=t.mod,g,b,_,E;if(r)for(b in r)g=r[b],a&&!g.num||h.push(g.tuple);for(_=0,E=this._alen;_<E;++_)s.push(this.celltuple(e[_])),e[_]=null;for(_=0,E=this._mlen;_<E;++_)g=n[_],(g.num===0&&a?h:d).push(this.celltuple(g)),n[_]=null;return this._alen=this._mlen=0,this._prev=null,t}});function eF(t){ar.call(this,null,t)}function _H(t,e,n){let r=t,a=e||[],s=n||[],h={},d=0;return{add:g=>s.push(g),remove:g=>h[r(g)]=++d,size:()=>a.length,data:(g,b)=>(d&&(a=a.filter(_=>!h[r(_)]),h={},d=0),b&&g&&a.sort(g),s.length&&(a=g?function(_,E,I,R){let z=E.length,P=I.length;if(!P)return E;if(!z)return I;let rt=R||new E.constructor(z+P),ot=0,at=0,dt=0;for(;ot<z&&at<P;++dt)rt[dt]=_(E[ot],I[at])>0?I[at++]:E[ot++];for(;ot<z;++ot,++dt)rt[dt]=E[ot];for(;at<P;++at,++dt)rt[dt]=I[at];return rt}(g,a,s.sort(g)):a.concat(s),s=[]),a)}}function nF(t){ar.call(this,[],t)}function CH(t){ts.call(this,null,Ult,t)}function Ult(t){return this.value&&!t.modified()?this.value:mt(t.fields,t.orders)}function rF(t){ar.call(this,null,t)}function iF(t){ar.call(this,null,t)}eF.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},ur(eF,ar,{transform(t,e){let n=t.interval!==!1,r=this._bins(t),a=r.start,s=r.step,h=t.as||["bin0","bin1"],d=h[0],g=h[1],b;return b=t.modified()?(e=e.reflow(!0)).SOURCE:e.modified(Ca(t.field))?e.ADD_MOD:e.ADD,e.visit(b,n?_=>{let E=r(_);_[d]=E,_[g]=E==null?null:a+s*(1+(E-a)/s)}:_=>_[d]=r(_)),e.modifies(n?h:d)},_bins(t){if(this.value&&!t.modified())return this.value;let e=t.field,n=function(b){let _=b.maxbins||20,E=b.base||10,I=Math.log(E),R=b.divide||[5,2],z,P,rt,ot,at,dt,ct=b.extent[0],Ct=b.extent[1],Et=b.span||Ct-ct||Math.abs(ct)||1;if(b.step)z=b.step;else if(b.steps){for(ot=Et/_,at=0,dt=b.steps.length;at<dt&&b.steps[at]<ot;++at);z=b.steps[Math.max(0,at-1)]}else{for(P=Math.ceil(Math.log(_)/I),rt=b.minstep||0,z=Math.max(rt,Math.pow(E,Math.round(Math.log(Et)/I)-P));Math.ceil(Et/z)>_;)z*=E;for(at=0,dt=R.length;at<dt;++at)ot=z/R[at],ot>=rt&&Et/ot<=_&&(z=ot)}ot=Math.log(z);let Rt=ot>=0?0:1+~~(-ot/I),Ot=Math.pow(E,-Rt-1);return(b.nice||b.nice===void 0)&&(ot=Math.floor(ct/z+Ot)*z,ct=ct<ot?ot-z:ot,Ct=Math.ceil(Ct/z)*z),{start:ct,stop:Ct===ct?ct+z:Ct,step:z}}(t),r=n.step,a,s,h=n.start,d=h+Math.ceil((n.stop-h)/r)*r;(a=t.anchor)!=null&&(s=a-(h+r*Math.floor((a-h)/r)),h+=s,d+=s);let g=function(b){let _=$s(e(b));return _==null?null:_<h?-1/0:_>d?1/0:(_=Math.max(h,Math.min(_,d-r)),h+r*Math.floor(1e-14+(_-h)/r))};return g.start=h,g.stop=n.stop,g.step=r,this.value=Wr(g,Ca(e),t.name||"bin_"+_a(e))}}),nF.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},ur(nF,ar,{transform(t,e){let n=e.fork(e.ALL),r=_H(qi,this.value,n.materialize(n.ADD).add),a=t.sort,s=e.changed()||a&&(t.modified("sort")||e.modified(a.fields));return n.visit(n.REM,r.remove),this.modified(s),this.value=n.source=r.data(op(a),s),e.source&&e.source.root&&(this.value.root=e.source.root),n}}),ur(CH,ts),rF.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},ur(rF,ar,{transform(t,e){let n=E=>I=>{for(var R,z=function(ot,at,dt){switch(at){case"upper":ot=ot.toUpperCase();break;case"lower":ot=ot.toLowerCase()}return ot.match(dt)}(d(I),t.case,s)||[],P=0,rt=z.length;P<rt;++P)h.test(R=z[P])||E(R)},r=this._parameterCheck(t,e),a=this._counts,s=this._match,h=this._stop,d=t.field,g=t.as||["text","count"],b=n(E=>a[E]=1+(a[E]||0)),_=n(E=>a[E]-=1);return r?e.visit(e.SOURCE,b):(e.visit(e.ADD,b),e.visit(e.REM,_)),this._finish(e,g)},_parameterCheck(t,e){let n=!1;return!t.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),!t.modified("pattern")&&this._match||(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(t,e){let n=this._counts,r=this._tuples||(this._tuples={}),a=e[0],s=e[1],h=t.fork(t.NO_SOURCE|t.NO_FIELDS),d,g,b;for(d in n)g=r[d],b=n[d]||0,!g&&b?(r[d]=g=Jo({}),g[a]=d,g[s]=b,h.add.push(g)):b===0?(g&&h.rem.push(g),n[d]=null,r[d]=null):g[s]!==b&&(g[s]=b,h.mod.push(g));return h.modifies(e)}}),iF.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},ur(iF,ar,{transform(t,e){let n=e.fork(e.NO_SOURCE),r=t.as||["a","b"],a=r[0],s=r[1],h=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter"),d=this.value;return h?(d&&(n.rem=d),d=e.materialize(e.SOURCE).source,n.add=this.value=function(g,b,_,E){for(var I,R,z=[],P={},rt=g.length,ot=0;ot<rt;++ot)for(P[b]=R=g[ot],I=0;I<rt;++I)P[_]=g[I],E(P)&&(z.push(Jo(P)),(P={})[b]=R);return z}(d,a,s,t.filter||an)):n.mod=d,n.source=this.value,n.modifies(r)}});let EH={kde:jR,mixture:function(t,e){let n,r=0,a={weights(s){return arguments.length?(n=function(h){let d=[],g,b=0;for(g=0;g<r;++g)b+=d[g]=h[g]==null?1:+h[g];for(g=0;g<r;++g)d[g]/=b;return d}(e=s||[]),a):e},distributions(s){return arguments.length?(s?(r=s.length,t=s):(r=0,t=[]),a.weights(e)):t},sample(){let s=m0(),h=t[r-1],d=n[0],g=0;for(;g<r-1;d+=n[++g])if(s<d){h=t[g];break}return h.sample()},pdf(s){let h=0,d=0;for(;d<r;++d)h+=n[d]*t[d].pdf(s);return h},cdf(s){let h=0,d=0;for(;d<r;++d)h+=n[d]*t[d].cdf(s);return h},icdf(){throw Error("Mixture icdf not supported.")}};return a.distributions(t).weights(e)},normal:J5,lognormal:function(t,e){let n,r,a={mean(s){return arguments.length?(n=s||0,a):n},stdev(s){return arguments.length?(r=s??1,a):r},sample:()=>UR(n,r),pdf:s=>TE(s,n,r),cdf:s=>AE(s,n,r),icdf:s=>WR(s,n,r)};return a.mean(t).stdev(e)},uniform:function(t,e){let n,r,a={min(s){return arguments.length?(n=s||0,a):n},max(s){return arguments.length?(r=s??1,a):r},sample:()=>IE(n,r),pdf:s=>NE(s,n,r),cdf:s=>VR(s,n,r),icdf:s=>ME(s,n,r)};return e==null&&(e=t??1,t=0),a.min(t).max(e)}},TH="function";function AH(t,e){let n=t[TH];In(EH,n)||Dn("Unknown distribution function: "+n);let r=EH[n]();for(let a in t)a==="field"?r.data((t.from||e()).map(t[a])):a==="distributions"?r[a](t[a].map(s=>AH(s,e))):typeof r[a]===TH&&r[a](t[a]);return r}function aF(t){ar.call(this,null,t)}let IH=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Wlt={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:IH},{name:"weights",type:"number",array:!0}]};function NH(t,e){return t?t.map((n,r)=>e[r]||_a(n)):null}function oF(t,e,n){let r=[],a=E=>E(g),s,h,d,g,b,_;if(e==null)r.push(t.map(n));else for(s={},h=0,d=t.length;h<d;++h)g=t[h],b=e.map(a),_=s[b],_||(s[b]=_=[],_.dims=b,r.push(_)),_.push(n(g));return r}aF.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:IH.concat(Wlt)},{name:"as",type:"string",array:!0,default:["value","density"]}]},ur(aF,ar,{transform(t,e){let n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){let r=AH(t.distribution,function(b){return()=>b.materialize(b.SOURCE).source}(e)),a=t.steps||t.minsteps||25,s=t.steps||t.maxsteps||200,h=t.method||"pdf";h!=="pdf"&&h!=="cdf"&&Dn("Invalid density method: "+h),t.extent||r.data||Dn("Missing density extent parameter."),h=r[h];let d=t.as||["value","density"],g=eS(h,t.extent||un(r.data()),a,s).map(b=>{let _={};return _[d[0]]=b[0],_[d[1]]=b[1],Jo(_)});this.value&&(n.rem=this.value),this.value=n.add=n.source=g}return n}});function sF(t){ar.call(this,null,t)}sF.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function MH(t){ts.call(this,null,uF,t),this.modified(!0)}function uF(t){let e=t.expr;return this.value&&!t.modified("expr")?this.value:Wr(n=>e(n,t),Ca(e),_a(e))}function lF(t){ar.call(this,[void 0,void 0],t)}function cF(t,e){ts.call(this,t),this.parent=e,this.count=0}function $w(t){ar.call(this,{},t),this._keys=oi();let e=this._targets=[];e.active=0,e.forEach=n=>{for(let r=0,a=e.active;r<a;++r)n(e[r],r,e)}}function DH(t){ts.call(this,null,Vlt,t)}function Vlt(t){return this.value&&!t.modified()?this.value:ni(t.name)?et(t.name).map(e=>sa(e)):sa(t.name,t.as)}function oS(t){ar.call(this,oi(),t)}function hF(t){ar.call(this,[],t)}function dF(t){ar.call(this,[],t)}function fF(t){ar.call(this,null,t)}function RH(t){ar.call(this,[],t)}ur(sF,ar,{transform(t,e){if(this.value&&!t.modified()&&!e.changed())return e;let n=e.materialize(e.SOURCE).source,r=oF(e.source,t.groupby,Po),a=t.smooth||!1,s=t.field,h=t.step||((z,P)=>zs(un(z,P))/30)(n,s),d=op((z,P)=>s(z)-s(P)),g=t.as||"bin",b=r.length,_,E=1/0,I=-1/0,R=0;for(;R<b;++R){let z=r[R].sort(d);_=-1;for(let P of zR(z,h,a,s))P<E&&(E=P),P>I&&(I=P),z[++_][g]=P}return this.value={start:E,stop:I,step:h},e.reflow(!0).modifies(g)}}),ur(MH,ts),lF.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},ur(lF,ar,{transform(t,e){let n=this.value,r=t.field,a=e.changed()||e.modified(r.fields)||t.modified("field"),s=n[0],h=n[1];if((a||s==null)&&(s=1/0,h=-1/0),e.visit(a?e.SOURCE:e.ADD,d=>{let g=$s(r(d));g!=null&&(g<s&&(s=g),g>h&&(h=g))}),!Number.isFinite(s)||!Number.isFinite(h)){let d=_a(r);d&&(d=` for field "${d}"`),e.dataflow.warn(`Infinite extent${d}: [${s}, ${h}]`),s=h=void 0}this.value=[s,h]}}),ur(cF,ts,{connect(t){return this.detachSubflow=t.detachSubflow,this.targets().add(t),t.source=this},add(t){this.count+=1,this.value.add.push(t)},rem(t){this.count-=1,this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}}),ur($w,ar,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,r){let a=this.value,s,h,d=In(a,t)&&a[t];return d?d.value.stamp<n.stamp&&(d.init(n),this.activate(d)):(h=r||(h=this._group[t])&&h.tuple,s=n.dataflow,d=new cF(n.fork(n.NO_SOURCE),this),s.add(d).connect(e(s,t,h)),a[t]=d,this.activate(d)),d},clean(){let t=this.value,e=0;for(let n in t)if(t[n].count===0){let r=t[n].detachSubflow;r&&r(),delete t[n],++e}if(e){let n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(t){let e=this._targets,n=e.length,r=t?t.length:0,a=0;for(;a<r;++a)e[a]=t[a];for(;a<n&&e[a]!=null;++a)e[a]=null;e.active=r},transform(t,e){let n=e.dataflow,r=t.key,a=t.subflow,s=this._keys,h=t.modified("key"),d=g=>this.subflow(g,a,e);return this._group=t.group||{},this.initTargets(),e.visit(e.REM,g=>{let b=qi(g),_=s.get(b);_!==void 0&&(s.delete(b),d(_).rem(g))}),e.visit(e.ADD,g=>{let b=r(g);s.set(qi(g),b),d(b).add(g)}),h||e.modified(r.fields)?e.visit(e.MOD,g=>{let b=qi(g),_=s.get(b),E=r(g);_===E?d(E).mod(g):(s.set(b,E),d(_).rem(g),d(E).add(g))}):e.changed(e.MOD)&&e.visit(e.MOD,g=>{d(s.get(qi(g))).mod(g)}),h&&e.visit(e.REFLOW,g=>{let b=qi(g),_=s.get(b),E=r(g);_!==E&&(s.set(b,E),d(_).rem(g),d(E).add(g))}),e.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),e}}),ur(DH,ts),oS.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},ur(oS,ar,{transform(t,e){let n=e.dataflow,r=this.value,a=e.fork(),s=a.add,h=a.rem,d=a.mod,g=t.expr,b=!0;function _(E){let I=qi(E),R=g(E,t),z=r.get(I);R&&z?(r.delete(I),s.push(E)):R||z?b&&R&&!z&&d.push(E):(r.set(I,1),h.push(E))}return e.visit(e.REM,E=>{let I=qi(E);r.has(I)?r.delete(I):h.push(E)}),e.visit(e.ADD,E=>{g(E,t)?s.push(E):r.set(qi(E),1)}),e.visit(e.MOD,_),t.modified()&&(b=!1,e.visit(e.REFLOW,_)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),a}}),hF.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},ur(hF,ar,{transform(t,e){let n=e.fork(e.NO_SOURCE),r=t.fields,a=NH(r,t.as||[]),s=t.index||null,h=a.length;return n.rem=this.value,e.visit(e.SOURCE,d=>{let g=r.map(z=>z(d)),b=g.reduce((z,P)=>Math.max(z,P.length),0),_,E,I,R=0;for(;R<b;++R){for(E=dE(d),_=0;_<h;++_)E[a[_]]=(I=g[_][R])==null?null:I;s&&(E[s]=R),n.add.push(E)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(a)}}),dF.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},ur(dF,ar,{transform(t,e){let n=e.fork(e.NO_SOURCE),r=t.fields,a=r.map(_a),s=t.as||["key","value"],h=s[0],d=s[1],g=r.length;return n.rem=this.value,e.visit(e.SOURCE,b=>{for(let _,E=0;E<g;++E)_=dE(b),_[h]=a[E],_[d]=r[E](b),n.add.push(_)}),this.value=n.source=n.add,n.modifies(s)}}),fF.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},ur(fF,ar,{transform(t,e){let n=t.expr,r=t.as,a=t.modified(),s=t.initonly?e.ADD:a?e.SOURCE:e.modified(n.fields)||e.modified(r)?e.ADD_MOD:e.ADD;return a&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(s,h=>h[r]=n(h,t))}}),ur(RH,ar,{transform(t,e){let n=e.fork(e.ALL),r=t.generator,a,s,h,d=this.value,g=t.size-d.length;if(g>0){for(a=[];--g>=0;)a.push(h=Jo(r(t))),d.push(h);n.add=n.add.length?n.materialize(n.ADD).add.concat(a):a}else s=d.slice(0,-g),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(s):s,d=d.slice(-g);return n.source=this.value=d,n}});let sS={value:"value",median:RE,mean:function(t,e){let n=0,r=0;if(e===void 0)for(let a of t)a!=null&&(a=+a)>=a&&(++n,r+=a);else{let a=-1;for(let s of t)(s=e(s,++a,t))!=null&&(s=+s)>=s&&(++n,r+=s)}if(n)return r/n},min:nS,max:Dv},FH=[];function FE(t){ar.call(this,[],t)}function OE(t){Fg.call(this,t)}function pF(t){ar.call(this,null,t)}function OH(t){ts.call(this,null,Glt,t)}function Glt(t){return this.value&&!t.modified()?this.value:cs(t.fields,t.flat)}function LH(t){ar.call(this,[],t),this._pending=null}function mF(t,e,n){n.forEach(Jo);let r=e.fork(e.NO_FIELDS&e.NO_SOURCE);return r.rem=t.value,t.value=r.source=r.add=n,t._pending=null,r.rem.length&&r.clean(!0),r}function gF(t){ar.call(this,{},t)}function $H(t){ts.call(this,null,Hlt,t)}function Hlt(t){if(this.value&&!t.modified())return this.value;let e=t.extents,n=e.length,r,a,s=1/0,h=-1/0;for(r=0;r<n;++r)a=e[r],a[0]<s&&(s=a[0]),a[1]>h&&(h=a[1]);return[s,h]}function zH(t){ts.call(this,null,Ylt,t)}function Ylt(t){return this.value&&!t.modified()?this.value:t.values.reduce((e,n)=>e.concat(n),[])}function PH(t){ar.call(this,null,t)}function yF(t){Fg.call(this,t)}function BH(t){$w.call(this,t)}function vF(t){ar.call(this,null,t)}function jH(t){ar.call(this,null,t)}function bF(t){ar.call(this,null,t)}FE.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},ur(FE,ar,{transform(t,e){var n,r,a,s,h,d,g,b,_,E,I=e.fork(e.ALL),R=function(Et){var Rt,Ot=Et.method||sS.value;if(sS[Ot]!=null)return Ot===sS.value?(Rt=Et.value!==void 0?Et.value:0,()=>Rt):sS[Ot];Dn("Unrecognized imputation method: "+Ot)}(t),z=function(Et){let Rt=Et.field;return Ot=>Ot?Rt(Ot):NaN}(t),P=_a(t.field),rt=_a(t.key),ot=(t.groupby||[]).map(_a),at=function(Et,Rt,Ot,Wt){var jt,Ht,Vt,fe,se,he,_e,Ve,gn=er=>er(Ve),$n=[],Gn=Wt?Wt.slice():[],qe={},tr={};for(Gn.forEach((er,An)=>qe[er]=An+1),fe=0,_e=Et.length;fe<_e;++fe)he=Ot(Ve=Et[fe]),se=qe[he]||(qe[he]=Gn.push(he)),(Vt=tr[Ht=(jt=Rt?Rt.map(gn):FH)+""])||(Vt=tr[Ht]=[],$n.push(Vt),Vt.values=jt),Vt[se-1]=Ve;return $n.domain=Gn,$n}(e.source,t.groupby,t.key,t.keyvals),dt=[],ct=this.value,Ct=at.domain.length;for(h=0,b=at.length;h<b;++h)for(a=(n=at[h]).values,r=NaN,g=0;g<Ct;++g)if(n[g]==null){for(s=at.domain[g],E={_impute:!0},d=0,_=a.length;d<_;++d)E[ot[d]]=a[d];E[rt]=s,E[P]=Number.isNaN(r)?r=R(n,z):r,dt.push(Jo(E))}return dt.length&&(I.add=I.materialize(I.ADD).add.concat(dt)),ct.length&&(I.rem=I.materialize(I.REM).rem.concat(ct)),this.value=dt,I}}),OE.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:aS},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},ur(OE,Fg,{transform(t,e){let n=this,r=t.modified(),a;return n.value&&(r||e.modified(n._inputs,!0))?(a=n.value=r?n.init(t):{},e.visit(e.SOURCE,s=>n.add(s))):(a=n.value=n.value||this.init(t),e.visit(e.REM,s=>n.rem(s)),e.visit(e.ADD,s=>n.add(s))),n.changes(),e.visit(e.SOURCE,s=>{nn(s,a[n.cellkey(s)].tuple)}),e.reflow(r).modifies(this._outputs)},changes(){let t=this._adds,e=this._mods,n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(t[n]),t[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(e[n]),e[n]=null;this._alen=this._mlen=0}}),pF.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},ur(pF,ar,{transform(t,e){let n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){let r=e.materialize(e.SOURCE).source,a=oF(r,t.groupby,t.field),s=(t.groupby||[]).map(_a),h=t.bandwidth,d=t.cumulative?"cdf":"pdf",g=t.as||["value","density"],b=[],_=t.extent,E=t.steps||t.minsteps||25,I=t.steps||t.maxsteps||200;d!=="pdf"&&d!=="cdf"&&Dn("Invalid density method: "+d),t.resolve==="shared"&&(_||(_=un(r,t.field)),E=I=t.steps||I),a.forEach(R=>{let z=jR(R,h)[d],P=t.counts?R.length:1;eS(z,_||un(R),E,I).forEach(rt=>{let ot={};for(let at=0;at<s.length;++at)ot[s[at]]=R.dims[at];ot[g[0]]=rt[0],ot[g[1]]=rt[1]*P,b.push(Jo(ot))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=b}return n}}),ur(OH,ts),ur(LH,ar,{transform(t,e){let n=e.dataflow;return this._pending?mF(this,e,this._pending):function(r){return r.modified("async")&&!(r.modified("values")||r.modified("url")||r.modified("format"))}(t)?e.StopPropagation:t.values?mF(this,e,n.parse(t.values,t.format)):t.async?{async:n.request(t.url,t.format).then(a=>(this._pending=et(a.data),s=>s.touch(this)))}:n.request(t.url,t.format).then(r=>mF(this,e,et(r.data)))}}),gF.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},ur(gF,ar,{transform(t,e){let n=t.fields,r=t.index,a=t.values,s=t.default==null?null:t.default,h=t.modified(),d=n.length,g,b,_,E=h?e.SOURCE:e.ADD,I=e,R=t.as;return a?(b=a.length,d>1&&!R&&Dn('Multi-field lookup requires explicit "as" parameter.'),R&&R.length!==d*b&&Dn('The "as" parameter has too few output field names.'),R=R||a.map(_a),g=function(z){for(var P,rt,ot=0,at=0;ot<d;++ot)if((rt=r.get(n[ot](z)))==null)for(P=0;P<b;++P,++at)z[R[at]]=s;else for(P=0;P<b;++P,++at)z[R[at]]=a[P](rt)}):(R||Dn("Missing output field names."),g=function(z){for(var P,rt=0;rt<d;++rt)P=r.get(n[rt](z)),z[R[rt]]=P??s}),h?I=e.reflow(!0):(_=n.some(z=>e.modified(z.fields)),E|=_?e.MOD:0),e.visit(E,g),I.modifies(R)}}),ur($H,ts),ur(zH,ts),ur(PH,ar,{transform(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),yF.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:aS,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},ur(yF,Fg,{_transform:Fg.prototype.transform,transform(t,e){return this._transform(function(n,r){let a=n.field,s=n.value,h=(n.op==="count"?"__count__":n.op)||"sum",d=Ca(a).concat(Ca(s)),g=function(b,_,E){let I={},R=[];return E.visit(E.SOURCE,z=>{let P=b(z);I[P]||(I[P]=1,R.push(P))}),R.sort(At),_?R.slice(0,_):R}(a,n.limit||0,r);return r.changed()&&n.set("__pivot__",null,null,!0),{key:n.key,groupby:n.groupby,ops:g.map(()=>h),fields:g.map(b=>function(_,E,I,R){return Wr(z=>E(z)===_?I(z):NaN,R,_+"")}(b,a,s,d)),as:g.map(b=>b+""),modified:n.modified.bind(n)}}(t,e),e)}}),ur(BH,$w,{transform(t,e){let n=t.subflow,r=t.field,a=s=>this.subflow(qi(s),n,e,s);return(t.modified("field")||r&&e.modified(Ca(r)))&&Dn("PreFacet does not support field modification."),this.initTargets(),r?(e.visit(e.MOD,s=>{let h=a(s);r(s).forEach(d=>h.mod(d))}),e.visit(e.ADD,s=>{let h=a(s);r(s).forEach(d=>h.add(Jo(d)))}),e.visit(e.REM,s=>{let h=a(s);r(s).forEach(d=>h.rem(d))})):(e.visit(e.MOD,s=>a(s).mod(s)),e.visit(e.ADD,s=>a(s).add(s)),e.visit(e.REM,s=>a(s).rem(s))),e.clean()&&e.runAfter(()=>this.clean()),e}}),vF.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},ur(vF,ar,{transform(t,e){let n=e.fork(e.NO_SOURCE),r=t.fields,a=NH(t.fields,t.as||[]),s=r?(d,g)=>function(b,_,E,I){for(let R=0,z=E.length;R<z;++R)_[I[R]]=E[R](b);return _}(d,g,r,a):fE,h;return this.value?h=this.value:(e=e.addAll(),h=this.value={}),e.visit(e.REM,d=>{let g=qi(d);n.rem.push(h[g]),h[g]=null}),e.visit(e.ADD,d=>{let g=s(d,Jo({}));h[qi(d)]=g,n.add.push(g)}),e.visit(e.MOD,d=>{n.mod.push(s(d,h[qi(d)]))}),n}}),ur(jH,ar,{transform(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}}),bF.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function UH(t){ar.call(this,null,t)}function wF(t){ar.call(this,[],t),this.count=0}function xF(t){ar.call(this,null,t)}function WH(t){ar.call(this,null,t),this.modified(!0)}function kF(t){ar.call(this,null,t)}ur(bF,ar,{transform(t,e){let n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed())return n.source=this.value,n;let a=oF(e.materialize(e.SOURCE).source,t.groupby,t.field),s=(t.groupby||[]).map(_a),h=[],d=t.step||.01,g=t.probs||wf(d/2,1-1e-14,d),b=g.length;return a.forEach(_=>{let E=SE(_,g);for(let I=0;I<b;++I){let R={};for(let z=0;z<s.length;++z)R[s[z]]=_.dims[z];R[r[0]]=g[I],R[r[1]]=E[I],h.push(Jo(R))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=h,n}}),ur(UH,ar,{transform(t,e){let n,r;return this.value?r=this.value:(n=e=e.addAll(),r=this.value={}),t.derive&&(n=e.fork(e.NO_SOURCE),e.visit(e.REM,a=>{let s=qi(a);n.rem.push(r[s]),r[s]=null}),e.visit(e.ADD,a=>{let s=dE(a);r[qi(a)]=s,n.add.push(s)}),e.visit(e.MOD,a=>{let s=r[qi(a)];for(let h in a)s[h]=a[h],n.modifies(h);n.mod.push(s)})),n}}),wF.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},ur(wF,ar,{transform(t,e){let n=e.fork(e.NO_SOURCE),r=t.modified("size"),a=t.size,s=this.value.reduce((_,E)=>(_[qi(E)]=1,_),{}),h=this.value,d=this.count,g=0;function b(_){let E,I;h.length<a?h.push(_):(I=~~((d+1)*m0()),I<h.length&&I>=g&&(E=h[I],s[qi(E)]&&n.rem.push(E),h[I]=_)),++d}if(e.rem.length&&(e.visit(e.REM,_=>{let E=qi(_);s[E]&&(s[E]=-1,n.rem.push(_)),--d}),h=h.filter(_=>s[qi(_)]!==-1)),(e.rem.length||r)&&h.length<a&&e.source&&(g=d=h.length,e.visit(e.SOURCE,_=>{s[qi(_)]||b(_)}),g=-1),r&&h.length>a){let _=h.length-a;for(let E=0;E<_;++E)s[qi(h[E])]=-1,n.rem.push(h[E]);h=h.slice(_)}return e.mod.length&&e.visit(e.MOD,_=>{s[qi(_)]&&n.mod.push(_)}),e.add.length&&e.visit(e.ADD,b),(e.add.length||g<0)&&(n.add=h.filter(_=>!s[qi(_)])),this.count=d,this.value=n.source=h,n}}),xF.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},ur(xF,ar,{transform(t,e){if(this.value&&!t.modified())return;let n=e.materialize().fork(e.MOD),r=t.as||"data";return n.rem=this.value?e.rem.concat(this.value):e.rem,this.value=wf(t.start,t.stop,t.step||1).map(a=>{let s={};return s[r]=a,Jo(s)}),n.add=e.add.concat(this.value),n}}),ur(WH,ar,{transform(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});let VH=["unit0","unit1"];function GH(t){ar.call(this,oi(),t)}function HH(t){ar.call(this,null,t)}kF.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:ci,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:VH}]},ur(kF,ar,{transform(t,e){let n=t.field,r=t.interval!==!1,a=t.timezone==="utc",s=this._floor(t,e),h=(a?F5:Sw)(s.unit).offset,d=t.as||VH,g=d[0],b=d[1],_=s.step,E=s.start||1/0,I=s.stop||-1/0,R=e.ADD;return(t.modified()||e.modified(Ca(n)))&&(R=(e=e.reflow(!0)).SOURCE,E=1/0,I=-1/0),e.visit(R,z=>{let P=n(z),rt,ot;P==null?(z[g]=null,r&&(z[b]=null)):(z[g]=rt=ot=s(P),r&&(z[b]=ot=h(rt,_)),rt<E&&(E=rt),ot>I&&(I=ot))}),s.start=E,s.stop=I,e.modifies(r?d:g)},_floor(t,e){let n=t.timezone==="utc",{units:r,step:a}=t.units?{units:t.units,step:t.step||1}:Slt({extent:t.extent||un(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins}),s=Ha(r),h=this.value||{},d=(n?X8:ap)(s,a);return d.unit=Ba(s),d.units=s,d.step=a,d.start=h.start,d.stop=h.stop,this.value=d}}),ur(GH,ar,{transform(t,e){let n=e.dataflow,r=t.field,a=this.value,s=d=>a.set(r(d),d),h=!0;return t.modified("field")||e.modified(r.fields)?(a.clear(),e.visit(e.SOURCE,s)):e.changed()?(e.visit(e.REM,d=>a.delete(r(d))),e.visit(e.ADD,s)):h=!1,this.modified(h),a.empty>n.cleanThreshold&&n.runAfter(a.clean),e.fork()}}),ur(HH,ar,{transform(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(op(t.sort)):e.source).map(t.field))}});let uS={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{let n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{let n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){let t=uS.rank(),e=t.next;return{init:t.init,next:n=>(e(n)-1)/(n.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{let n=e.data,r=e.compare,a=e.index;if(t<a){for(;a+1<n.length&&!r(n[a],n[a+1]);)++a;t=a}return(1+t)/n.length}}},ntile:function(t,e){(e=+e)>0||Dn("ntile num must be greater than zero.");let n=uS.cume_dist(),r=n.next;return{init:n.init,next:a=>Math.ceil(e*r(a))}},lag:function(t,e){return e=+e||1,{next:n=>{let r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:n=>{let r=n.index+e,a=n.data;return r<a.length?t(a[r]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){return(e=+e)>0||Dn("nth_value nth must be greater than zero."),{next:n=>{let r=n.i0+(e-1);return r<n.i1?t(n.data[r]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{let r=t(n.data[n.index]);return r!=null?e=r:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:r=>{let a=r.data;return r.index<=n?e:(n=function(s,h,d){for(let g=h.length;d<g;++d)if(s(h[d])!=null)return d;return-1}(t,a,r.index))<0?(n=a.length,e=null):e=t(a[n])}}}},qlt=Object.keys(uS);function YH(t){let e=et(t.ops),n=et(t.fields),r=et(t.params),a=et(t.as),s=this.outputs=[],h=this.windows=[],d={},g={},b=[],_=[],E=!0;function I(R){et(Ca(R)).forEach(z=>d[z]=1)}I(t.sort),e.forEach((R,z)=>{let P=n[z],rt=_a(P),ot=wH(R,rt,a[z]);if(I(P),s.push(ot),In(uS,R))h.push(function(at,dt,ct,Ct){let Et=uS[at](dt,ct);return{init:Et.init||ku,update:function(Rt,Ot){Ot[Ct]=Et.next(Rt)}}}(R,n[z],r[z],ot));else{if(P==null&&R!=="count"&&Dn("Null aggregate field specified."),R==="count")return void b.push(ot);E=!1;let at=g[rt];at||(at=g[rt]=[],at.field=P,_.push(at)),at.push(xH(R,ot))}}),(b.length||_.length)&&(this.cell=function(R,z,P){R=R.map(Ct=>SH(Ct,Ct.field));let rt={num:0,agg:null,store:!1,count:z};if(!P)for(var ot=R.length,at=rt.agg=Array(ot),dt=0;dt<ot;++dt)at[dt]=new R[dt](rt);if(rt.store)var ct=rt.data=new tF;return rt.add=function(Ct){if(rt.num+=1,!P){ct&&ct.add(Ct);for(let Et=0;Et<ot;++Et)at[Et].add(at[Et].get(Ct),Ct)}},rt.rem=function(Ct){if(rt.num-=1,!P){ct&&ct.rem(Ct);for(let Et=0;Et<ot;++Et)at[Et].rem(at[Et].get(Ct),Ct)}},rt.set=function(Ct){let Et,Rt;for(ct&&ct.values(),Et=0,Rt=z.length;Et<Rt;++Et)Ct[z[Et]]=rt.num;if(!P)for(Et=0,Rt=at.length;Et<Rt;++Et)at[Et].set(Ct)},rt.init=function(){rt.num=0,ct&&ct.reset();for(let Ct=0;Ct<ot;++Ct)at[Ct].init()},rt}(_,b,E)),this.inputs=Object.keys(d)}let qH=YH.prototype;function SF(t){ar.call(this,{},t),this._mlen=0,this._mods=[]}function Xlt(t,e,n,r){let a=r.sort,s=a&&!r.ignorePeers,h=r.frame||[null,0],d=t.data(n),g=d.length,b=s?rS(a):null,_={i0:0,i1:0,p0:0,p1:0,index:0,data:d,compare:a||Ke(-1)};e.init();for(let E=0;E<g;++E)Klt(_,h,E,g),s&&Zlt(_,b),e.update(_,d[E])}function Klt(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=e[0]==null?0:Math.max(0,n-Math.abs(e[0])),t.i1=e[1]==null?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function Zlt(t,e){let n=t.i0,r=t.i1-1,a=t.compare,s=t.data,h=s.length-1;n>0&&!a(s[n],s[n-1])&&(t.i0=e.left(s,s[n])),r<h&&!a(s[r],s[r+1])&&(t.i1=e.right(s,s[r]))}function LE(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function $E(t){this._context=t}function XH(t){return new $E(t)}function v2(){}function KH(t){this._context=t}function ZH(t){return new KH(t)}function QH(t){this._context=t}function JH(t){return new QH(t)}function tY(t,e){this._basis=new $E(t),this._beta=e}qH.init=function(){this.windows.forEach(t=>t.init()),this.cell&&this.cell.init()},qH.update=function(t,e){let n=this.cell,r=this.windows,a=t.data,s=r&&r.length,h;if(n){for(h=t.p0;h<t.i0;++h)n.rem(a[h]);for(h=t.p1;h<t.i1;++h)n.add(a[h]);n.set(e)}for(h=0;h<s;++h)r[h].update(t,e)},SF.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:qlt.concat(aS)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},ur(SF,ar,{transform(t,e){this.stamp=e.stamp;let n=t.modified(),r=op(t.sort),a=QR(t.groupby),s=d=>this.group(a(d)),h=this.state;h&&!n||(h=this.state=new YH(t)),n||e.modified(h.inputs)?(this.value={},e.visit(e.SOURCE,d=>s(d).add(d))):(e.visit(e.REM,d=>s(d).remove(d)),e.visit(e.ADD,d=>s(d).add(d)));for(let d=0,g=this._mlen;d<g;++d)Xlt(this._mods[d],h,r,t);return this._mlen=0,this._mods=[],e.reflow(n).modifies(h.outputs)},group(t){let e=this.value[t];return e||(e=this.value[t]=_H(qi),e.stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e}}),$E.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:LE(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:LE(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},KH.prototype={areaStart:v2,areaEnd:v2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:LE(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},QH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:LE(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},tY.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,a=t[0],s=e[0],h=t[n]-a,d=e[n]-s,g=-1;++g<=n;)r=g/n,this._basis.point(this._beta*t[g]+(1-this._beta)*(a+r*h),this._beta*e[g]+(1-this._beta)*(s+r*d));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};let eY=function t(e){function n(r){return e===1?new $E(r):new tY(r,e)}return n.beta=function(r){return t(+r)},n}(.85);function zE(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function _F(t,e){this._context=t,this._k=(1-e)/6}_F.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:zE(this,this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:zE(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};let nY=function t(e){function n(r){return new _F(r,e)}return n.tension=function(r){return t(+r)},n}(0);function PE(t,e){this._context=t,this._k=(1-e)/6}PE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:zE(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};let lS=function t(e){function n(r){return new PE(r,e)}return n.tension=function(r){return t(+r)},n}(0);function CF(t,e){this._context=t,this._k=(1-e)/6}CF.prototype={areaStart:v2,areaEnd:v2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:zE(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};let EF=function t(e){function n(r){return new CF(r,e)}return n.tension=function(r){return t(+r)},n}(0),rY=Math.abs,_s=Math.atan2,Ir=Math.cos,iY=Math.max,cS=Math.min,gm=Math.sin,b2=Math.sqrt,yh=1e-12,Yt=Math.PI,pl=Yt/2,TF=2*Yt;function ym(t){return t>=1?pl:t<=-1?-pl:Math.asin(t)}function zw(t,e,n){var r=t._x1,a=t._y1,s=t._x2,h=t._y2;if(t._l01_a>yh){var d=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,g=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*d-t._x0*t._l12_2a+t._x2*t._l01_2a)/g,a=(a*d-t._y0*t._l12_2a+t._y2*t._l01_2a)/g}if(t._l23_a>yh){var b=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,_=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*b+t._x1*t._l23_2a-e*t._l12_2a)/_,h=(h*b+t._y1*t._l23_2a-n*t._l12_2a)/_}t._context.bezierCurveTo(r,a,s,h,t._x2,t._y2)}function Jh(t,e){this._context=t,this._alpha=e}Jh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:zw(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};let hS=function t(e){function n(r){return e?new Jh(r,e):new _F(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function Og(t,e){this._context=t,this._alpha=e}Og.prototype={areaStart:v2,areaEnd:v2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:zw(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};let aY=function t(e){function n(r){return e?new Og(r,e):new CF(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function oY(t,e){this._context=t,this._alpha=e}oY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:zw(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};let sY=function t(e){function n(r){return e?new oY(r,e):new PE(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function uY(t){this._context=t}function BE(t){return new uY(t)}function lY(t){this._context=t}function cY(t){return new lY(t)}function hY(t){return t<0?-1:1}function dY(t,e,n){var r=t._x1-t._x0,a=e-t._x1,s=(t._y1-t._y0)/(r||a<0&&-0),h=(n-t._y1)/(a||r<0&&-0),d=(s*a+h*r)/(r+a);return(hY(s)+hY(h))*Math.min(Math.abs(s),Math.abs(h),.5*Math.abs(d))||0}function fY(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function AF(t,e,n){var r=t._x0,a=t._y0,s=t._x1,h=t._y1,d=(s-r)/3;t._context.bezierCurveTo(r+d,a+d*e,s-d,h-d*n,s,h)}function jE(t){this._context=t}function pY(t){this._context=new mY(t)}function mY(t){this._context=t}function gY(t){return new jE(t)}function yY(t){return new pY(t)}function vY(t){this._context=t}function bY(t){var e,n,r=t.length-1,a=new Array(r),s=new Array(r),h=new Array(r);for(a[0]=0,s[0]=2,h[0]=t[0]+2*t[1],e=1;e<r-1;++e)a[e]=1,s[e]=4,h[e]=4*t[e]+2*t[e+1];for(a[r-1]=2,s[r-1]=7,h[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=a[e]/s[e-1],s[e]-=n,h[e]-=n*h[e-1];for(a[r-1]=h[r-1]/s[r-1],e=r-2;e>=0;--e)a[e]=(h[e]-a[e+1])/s[e];for(s[r-1]=(t[r]+a[r-1])/2,e=0;e<r-1;++e)s[e]=2*t[e+1]-a[e+1];return[a,s]}function wY(t){return new vY(t)}function dS(t,e){this._context=t,this._t=e}function IF(t){return new dS(t,.5)}function UE(t){return new dS(t,0)}function WE(t){return new dS(t,1)}function es(t){return function(){return t}}uY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},lY.prototype={areaStart:v2,areaEnd:v2,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},jE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:AF(this,this._t0,fY(this,this._t0))}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,AF(this,fY(this,n=dY(this,t,e)),n);break;default:AF(this,this._t0,n=dY(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(pY.prototype=Object.create(jE.prototype)).point=function(t,e){jE.prototype.point.call(this,e,t)},mY.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,a,s){this._context.bezierCurveTo(e,t,r,n,s,a)}},vY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var r=bY(t),a=bY(e),s=0,h=1;h<n;++s,++h)this._context.bezierCurveTo(r[0][s],a[0][s],r[1][s],a[1][s],t[h],e[h]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},dS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};let fS=Math.PI,VE=2*fS,Lg=1e-6,NF=VE-Lg;function MF(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class pS{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?MF:function(n){let r=Math.floor(n);if(!(r>=0))throw new Error(`invalid digits: ${n}`);if(r>15)return MF;let a=10**r;return function(s){this._+=s[0];for(let h=1,d=s.length;h<d;++h)this._+=Math.round(arguments[h]*a)/a+s[h]}}(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,a){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+a}`}bezierCurveTo(e,n,r,a,s,h){this._append`C${+e},${+n},${+r},${+a},${this._x1=+s},${this._y1=+h}`}arcTo(e,n,r,a,s){if(e=+e,n=+n,r=+r,a=+a,(s=+s)<0)throw new Error(`negative radius: ${s}`);let h=this._x1,d=this._y1,g=r-e,b=a-n,_=h-e,E=d-n,I=_*_+E*E;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(I>Lg)if(Math.abs(E*g-b*_)>Lg&&s){let R=r-h,z=a-d,P=g*g+b*b,rt=R*R+z*z,ot=Math.sqrt(P),at=Math.sqrt(I),dt=s*Math.tan((fS-Math.acos((P+I-rt)/(2*ot*at)))/2),ct=dt/at,Ct=dt/ot;Math.abs(ct-1)>Lg&&this._append`L${e+ct*_},${n+ct*E}`,this._append`A${s},${s},0,0,${+(E*R>_*z)},${this._x1=e+Ct*g},${this._y1=n+Ct*b}`}else this._append`L${this._x1=e},${this._y1=n}`}arc(e,n,r,a,s,h){if(e=+e,n=+n,h=!!h,(r=+r)<0)throw new Error(`negative radius: ${r}`);let d=r*Math.cos(a),g=r*Math.sin(a),b=e+d,_=n+g,E=1^h,I=h?a-s:s-a;this._x1===null?this._append`M${b},${_}`:(Math.abs(this._x1-b)>Lg||Math.abs(this._y1-_)>Lg)&&this._append`L${b},${_}`,r&&(I<0&&(I=I%VE+VE),I>NF?this._append`A${r},${r},0,1,${E},${e-d},${n-g}A${r},${r},0,1,${E},${this._x1=b},${this._y1=_}`:I>Lg&&this._append`A${r},${r},0,${+(I>=fS)},${E},${this._x1=e+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(e,n,r,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+a}h${-r}Z`}toString(){return this._}}function Fv(){return new pS}function Pw(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{let r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new pS(e)}function DF(t){return t.innerRadius}function RF(t){return t.outerRadius}function Qlt(t){return t.startAngle}function pn(t){return t.endAngle}function up(t){return t&&t.padAngle}function mS(t,e,n,r,a,s,h){var d=t-n,g=e-r,b=(h?s:-s)/b2(d*d+g*g),_=b*g,E=-b*d,I=t+_,R=e+E,z=n+_,P=r+E,rt=(I+z)/2,ot=(R+P)/2,at=z-I,dt=P-R,ct=at*at+dt*dt,Ct=a-s,Et=I*P-z*R,Rt=(dt<0?-1:1)*b2(iY(0,Ct*Ct*ct-Et*Et)),Ot=(Et*dt-at*Rt)/ct,Wt=(-Et*at-dt*Rt)/ct,jt=(Et*dt+at*Rt)/ct,Ht=(-Et*at+dt*Rt)/ct,Vt=Ot-rt,fe=Wt-ot,se=jt-rt,he=Ht-ot;return Vt*Vt+fe*fe>se*se+he*he&&(Ot=jt,Wt=Ht),{cx:Ot,cy:Wt,x01:-_,y01:-E,x11:Ot*(a/Ct-1),y11:Wt*(a/Ct-1)}}function Bw(){var t=DF,e=RF,n=es(0),r=null,a=Qlt,s=pn,h=up,d=null,g=Pw(b);function b(){var _,E,I=+t.apply(this,arguments),R=+e.apply(this,arguments),z=a.apply(this,arguments)-pl,P=s.apply(this,arguments)-pl,rt=rY(P-z),ot=P>z;if(d||(d=_=g()),R<I&&(E=R,R=I,I=E),R>yh)if(rt>TF-yh)d.moveTo(R*Ir(z),R*gm(z)),d.arc(0,0,R,z,P,!ot),I>yh&&(d.moveTo(I*Ir(P),I*gm(P)),d.arc(0,0,I,P,z,ot));else{var at,dt,ct=z,Ct=P,Et=z,Rt=P,Ot=rt,Wt=rt,jt=h.apply(this,arguments)/2,Ht=jt>yh&&(r?+r.apply(this,arguments):b2(I*I+R*R)),Vt=cS(rY(R-I)/2,+n.apply(this,arguments)),fe=Vt,se=Vt;if(Ht>yh){var he=ym(Ht/I*gm(jt)),_e=ym(Ht/R*gm(jt));(Ot-=2*he)>yh?(Et+=he*=ot?1:-1,Rt-=he):(Ot=0,Et=Rt=(z+P)/2),(Wt-=2*_e)>yh?(ct+=_e*=ot?1:-1,Ct-=_e):(Wt=0,ct=Ct=(z+P)/2)}var Ve=R*Ir(ct),gn=R*gm(ct),$n=I*Ir(Rt),Gn=I*gm(Rt);if(Vt>yh){var qe,tr=R*Ir(Ct),er=R*gm(Ct),An=I*Ir(Et),dn=I*gm(Et);if(rt<Yt)if(qe=function(si,Ei,ki,Xi,Fi,Go,gd,Uh){var rc=ki-si,Do=Xi-Ei,us=gd-Fi,Io=Uh-Go,ou=Io*rc-us*Do;if(!(ou*ou<yh))return[si+(ou=(us*(Ei-Go)-Io*(si-Fi))/ou)*rc,Ei+ou*Do]}(Ve,gn,An,dn,tr,er,$n,Gn)){var nr=Ve-qe[0],Qn=gn-qe[1],wr=tr-qe[0],yi=er-qe[1],ha=1/gm(function(si){return si>1?0:si<-1?Yt:Math.acos(si)}((nr*wr+Qn*yi)/(b2(nr*nr+Qn*Qn)*b2(wr*wr+yi*yi)))/2),mi=b2(qe[0]*qe[0]+qe[1]*qe[1]);fe=cS(Vt,(I-mi)/(ha-1)),se=cS(Vt,(R-mi)/(ha+1))}else fe=se=0}Wt>yh?se>yh?(at=mS(An,dn,Ve,gn,R,se,ot),dt=mS(tr,er,$n,Gn,R,se,ot),d.moveTo(at.cx+at.x01,at.cy+at.y01),se<Vt?d.arc(at.cx,at.cy,se,_s(at.y01,at.x01),_s(dt.y01,dt.x01),!ot):(d.arc(at.cx,at.cy,se,_s(at.y01,at.x01),_s(at.y11,at.x11),!ot),d.arc(0,0,R,_s(at.cy+at.y11,at.cx+at.x11),_s(dt.cy+dt.y11,dt.cx+dt.x11),!ot),d.arc(dt.cx,dt.cy,se,_s(dt.y11,dt.x11),_s(dt.y01,dt.x01),!ot))):(d.moveTo(Ve,gn),d.arc(0,0,R,ct,Ct,!ot)):d.moveTo(Ve,gn),I>yh&&Ot>yh?fe>yh?(at=mS($n,Gn,tr,er,I,-fe,ot),dt=mS(Ve,gn,An,dn,I,-fe,ot),d.lineTo(at.cx+at.x01,at.cy+at.y01),fe<Vt?d.arc(at.cx,at.cy,fe,_s(at.y01,at.x01),_s(dt.y01,dt.x01),!ot):(d.arc(at.cx,at.cy,fe,_s(at.y01,at.x01),_s(at.y11,at.x11),!ot),d.arc(0,0,I,_s(at.cy+at.y11,at.cx+at.x11),_s(dt.cy+dt.y11,dt.cx+dt.x11),ot),d.arc(dt.cx,dt.cy,fe,_s(dt.y11,dt.x11),_s(dt.y01,dt.x01),!ot))):d.arc(0,0,I,Rt,Et,ot):d.lineTo($n,Gn)}else d.moveTo(0,0);if(d.closePath(),_)return d=null,_+""||null}return b.centroid=function(){var _=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,E=(+a.apply(this,arguments)+ +s.apply(this,arguments))/2-Yt/2;return[Ir(E)*_,gm(E)*_]},b.innerRadius=function(_){return arguments.length?(t=typeof _=="function"?_:es(+_),b):t},b.outerRadius=function(_){return arguments.length?(e=typeof _=="function"?_:es(+_),b):e},b.cornerRadius=function(_){return arguments.length?(n=typeof _=="function"?_:es(+_),b):n},b.padRadius=function(_){return arguments.length?(r=_==null?null:typeof _=="function"?_:es(+_),b):r},b.startAngle=function(_){return arguments.length?(a=typeof _=="function"?_:es(+_),b):a},b.endAngle=function(_){return arguments.length?(s=typeof _=="function"?_:es(+_),b):s},b.padAngle=function(_){return arguments.length?(h=typeof _=="function"?_:es(+_),b):h},b.context=function(_){return arguments.length?(d=_??null,b):d},b}Fv.prototype=pS.prototype;function GE(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function xY(t){return t[0]}function w2(t){return t[1]}function FF(t,e){var n=es(!0),r=null,a=BE,s=null,h=Pw(d);function d(g){var b,_,E,I=(g=GE(g)).length,R=!1;for(r==null&&(s=a(E=h())),b=0;b<=I;++b)!(b<I&&n(_=g[b],b,g))===R&&((R=!R)?s.lineStart():s.lineEnd()),R&&s.point(+t(_,b,g),+e(_,b,g));if(E)return s=null,E+""||null}return t=typeof t=="function"?t:t===void 0?xY:es(t),e=typeof e=="function"?e:e===void 0?w2:es(e),d.x=function(g){return arguments.length?(t=typeof g=="function"?g:es(+g),d):t},d.y=function(g){return arguments.length?(e=typeof g=="function"?g:es(+g),d):e},d.defined=function(g){return arguments.length?(n=typeof g=="function"?g:es(!!g),d):n},d.curve=function(g){return arguments.length?(a=g,r!=null&&(s=a(r)),d):a},d.context=function(g){return arguments.length?(g==null?r=s=null:s=a(r=g),d):r},d}function gS(t,e,n){var r=null,a=es(!0),s=null,h=BE,d=null,g=Pw(b);function b(E){var I,R,z,P,rt,ot=(E=GE(E)).length,at=!1,dt=new Array(ot),ct=new Array(ot);for(s==null&&(d=h(rt=g())),I=0;I<=ot;++I){if(!(I<ot&&a(P=E[I],I,E))===at)if(at=!at)R=I,d.areaStart(),d.lineStart();else{for(d.lineEnd(),d.lineStart(),z=I-1;z>=R;--z)d.point(dt[z],ct[z]);d.lineEnd(),d.areaEnd()}at&&(dt[I]=+t(P,I,E),ct[I]=+e(P,I,E),d.point(r?+r(P,I,E):dt[I],n?+n(P,I,E):ct[I]))}if(rt)return d=null,rt+""||null}function _(){return FF().defined(a).curve(h).context(s)}return t=typeof t=="function"?t:t===void 0?xY:es(+t),e=typeof e=="function"?e:es(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?w2:es(+n),b.x=function(E){return arguments.length?(t=typeof E=="function"?E:es(+E),r=null,b):t},b.x0=function(E){return arguments.length?(t=typeof E=="function"?E:es(+E),b):t},b.x1=function(E){return arguments.length?(r=E==null?null:typeof E=="function"?E:es(+E),b):r},b.y=function(E){return arguments.length?(e=typeof E=="function"?E:es(+E),n=null,b):e},b.y0=function(E){return arguments.length?(e=typeof E=="function"?E:es(+E),b):e},b.y1=function(E){return arguments.length?(n=E==null?null:typeof E=="function"?E:es(+E),b):n},b.lineX0=b.lineY0=function(){return _().x(t).y(e)},b.lineY1=function(){return _().x(t).y(n)},b.lineX1=function(){return _().x(r).y(e)},b.defined=function(E){return arguments.length?(a=typeof E=="function"?E:es(!!E),b):a},b.curve=function(E){return arguments.length?(h=E,s!=null&&(d=h(s)),b):h},b.context=function(E){return arguments.length?(E==null?s=d=null:d=h(s=E),b):s},b}let OF={draw(t,e){let n=b2(e/Yt);t.moveTo(n,0),t.arc(0,0,n,0,TF)}};function kY(t,e){let n=null,r=Pw(a);function a(){let s;if(n||(n=s=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),s)return n=null,s+""||null}return t=typeof t=="function"?t:es(t||OF),e=typeof e=="function"?e:es(e===void 0?64:+e),a.type=function(s){return arguments.length?(t=typeof s=="function"?s:es(s),a):t},a.size=function(s){return arguments.length?(e=typeof s=="function"?s:es(+s),a):e},a.context=function(s){return arguments.length?(n=s??null,a):n},a}function lp(t,e){if(typeof document<"u"&&document.createElement){let n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}let LF=()=>typeof Image<"u"?Image:null;function yS(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Jlt(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function vS(t){let e,n,r;function a(s,h,d=0,g=s.length){if(d<g){if(e(h,h)!==0)return g;do{let b=d+g>>>1;n(s[b],h)<0?d=b+1:g=b}while(d<g)}return d}return t.length!==2?(e=yS,n=(s,h)=>yS(t(s),h),r=(s,h)=>t(s)-h):(e=t===yS||t===Jlt?t:tct,n=t,r=t),{left:a,center:function(s,h,d=0,g=s.length){let b=a(s,h,d,g-1);return b>d&&r(s[b-1],h)>-r(s[b],h)?b-1:b},right:function(s,h,d=0,g=s.length){if(d<g){if(e(h,h)!==0)return g;do{let b=d+g>>>1;n(s[b],h)<=0?d=b+1:g=b}while(d<g)}return d}}}function tct(){return 0}let ect=vS(yS),$F=ect.right,Ov=(vS(function(t){return t===null?NaN:+t}).center,$F),nct=Math.sqrt(50),rct=Math.sqrt(10),HE=Math.sqrt(2);function YE(t,e,n){let r=(e-t)/Math.max(0,n),a=Math.floor(Math.log10(r)),s=r/Math.pow(10,a),h=s>=nct?10:s>=rct?5:s>=HE?2:1,d,g,b;return a<0?(b=Math.pow(10,-a)/h,d=Math.round(t*b),g=Math.round(e*b),d/b<t&&++d,g/b>e&&--g,b=-b):(b=Math.pow(10,a)*h,d=Math.round(t/b),g=Math.round(e/b),d*b<t&&++d,g*b>e&&--g),g<d&&.5<=n&&n<2?YE(t,e,2*n):[d,g,b]}function zF(t,e,n){if(!((n=+n)>0))return[];if((t=+t)==(e=+e))return[t];let r=e<t,[a,s,h]=r?YE(e,t,n):YE(t,e,n);if(!(s>=a))return[];let d=s-a+1,g=new Array(d);if(r)if(h<0)for(let b=0;b<d;++b)g[b]=(s-b)/-h;else for(let b=0;b<d;++b)g[b]=(s-b)*h;else if(h<0)for(let b=0;b<d;++b)g[b]=(a+b)/-h;else for(let b=0;b<d;++b)g[b]=(a+b)*h;return g}function PF(t,e,n){return YE(t=+t,e=+e,n=+n)[2]}function bS(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function BF(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Vc(t){let e,n,r;function a(s,h,d=0,g=s.length){if(d<g){if(e(h,h)!==0)return g;do{let b=d+g>>>1;n(s[b],h)<0?d=b+1:g=b}while(d<g)}return d}return t.length!==2?(e=bS,n=(s,h)=>bS(t(s),h),r=(s,h)=>t(s)-h):(e=t===bS||t===BF?t:ict,n=t,r=t),{left:a,center:function(s,h,d=0,g=s.length){let b=a(s,h,d,g-1);return b>d&&r(s[b-1],h)>-r(s[b],h)?b-1:b},right:function(s,h,d=0,g=s.length){if(d<g){if(e(h,h)!==0)return g;do{let b=d+g>>>1;n(s[b],h)<=0?d=b+1:g=b}while(d<g)}return d}}}function ict(){return 0}function jF(t){return t===null?NaN:+t}let Lv=Vc(bS),jw=Lv.right,Uw=(Vc(jF).center,jw);function Ww(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function SY(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Vw(){}var Gw=.7,wS=1/Gw,g0="\\s*([+-]?\\d+)\\s*",xS="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",vm="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_Y=/^#([0-9a-f]{3,8})$/,qE=new RegExp(`^rgb\\(${g0},${g0},${g0}\\)$`),CY=new RegExp(`^rgb\\(${vm},${vm},${vm}\\)$`),UF=new RegExp(`^rgba\\(${g0},${g0},${g0},${xS}\\)$`),act=new RegExp(`^rgba\\(${vm},${vm},${vm},${xS}\\)$`),Yl=new RegExp(`^hsl\\(${xS},${vm},${vm}\\)$`),oct=new RegExp(`^hsla\\(${xS},${vm},${vm},${xS}\\)$`),EY={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function TY(){return this.rgb().formatHex()}function AY(){return this.rgb().formatRgb()}function kS(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=_Y.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?IY(e):n===3?new Rd(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):n===8?XE(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):n===4?XE(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=qE.exec(t))?new Rd(e[1],e[2],e[3],1):(e=CY.exec(t))?new Rd(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=UF.exec(t))?XE(e[1],e[2],e[3],e[4]):(e=act.exec(t))?XE(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Yl.exec(t))?GF(e[1],e[2]/100,e[3]/100,1):(e=oct.exec(t))?GF(e[1],e[2]/100,e[3]/100,e[4]):EY.hasOwnProperty(t)?IY(EY[t]):t==="transparent"?new Rd(NaN,NaN,NaN,0):null}function IY(t){return new Rd(t>>16&255,t>>8&255,255&t,1)}function XE(t,e,n,r){return r<=0&&(t=e=n=NaN),new Rd(t,e,n,r)}function WF(t,e,n,r){return arguments.length===1?((a=t)instanceof Vw||(a=kS(a)),a?new Rd((a=a.rgb()).r,a.g,a.b,a.opacity):new Rd):new Rd(t,e,n,r??1);var a}function Rd(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function VF(){return`#${$v(this.r)}${$v(this.g)}${$v(this.b)}`}function KE(){let t=ZE(this.opacity);return`${t===1?"rgb(":"rgba("}${x2(this.r)}, ${x2(this.g)}, ${x2(this.b)}${t===1?")":`, ${t})`}`}function ZE(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function x2(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function $v(t){return((t=x2(t))<16?"0":"")+t.toString(16)}function GF(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new vh(t,e,n,r)}function NY(t){if(t instanceof vh)return new vh(t.h,t.s,t.l,t.opacity);if(t instanceof Vw||(t=kS(t)),!t)return new vh;if(t instanceof vh)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),s=Math.max(e,n,r),h=NaN,d=s-a,g=(s+a)/2;return d?(h=e===s?(n-r)/d+6*(n<r):n===s?(r-e)/d+2:(e-n)/d+4,d/=g<.5?s+a:2-s-a,h*=60):d=g>0&&g<1?0:h,new vh(h,d,g,t.opacity)}function vh(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function td(t){return(t=(t||0)%360)<0?t+360:t}function k2(t){return Math.max(0,Math.min(1,t||0))}function SS(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Ww(Vw,kS,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:TY,formatHex:TY,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return NY(this).formatHsl()},formatRgb:AY,toString:AY}),Ww(Rd,WF,SY(Vw,{brighter(t){return t=t==null?wS:Math.pow(wS,t),new Rd(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Gw:Math.pow(Gw,t),new Rd(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Rd(x2(this.r),x2(this.g),x2(this.b),ZE(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:VF,formatHex:VF,formatHex8:function(){return`#${$v(this.r)}${$v(this.g)}${$v(this.b)}${$v(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:KE,toString:KE})),Ww(vh,function(t,e,n,r){return arguments.length===1?NY(t):new vh(t,e,n,r??1)},SY(Vw,{brighter(t){return t=t==null?wS:Math.pow(wS,t),new vh(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Gw:Math.pow(Gw,t),new vh(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,a=2*n-r;return new Rd(SS(t>=240?t-240:t+120,a,r),SS(t,a,r),SS(t<120?t+240:t-120,a,r),this.opacity)},clamp(){return new vh(td(this.h),k2(this.s),k2(this.l),ZE(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=ZE(this.opacity);return`${t===1?"hsl(":"hsla("}${td(this.h)}, ${100*k2(this.s)}%, ${100*k2(this.l)}%${t===1?")":`, ${t})`}`}}));let HF=t=>()=>t;function MY(t,e){return function(n){return t+n*e}}function QE(t){return(t=+t)==1?Hw:function(e,n){return n-e?function(r,a,s){return r=Math.pow(r,s),a=Math.pow(a,s)-r,s=1/s,function(h){return Math.pow(r+h*a,s)}}(e,n,t):HF(isNaN(e)?n:e)}}function Hw(t,e){var n=e-t;return n?MY(t,n):HF(isNaN(t)?e:t)}let YF=function t(e){var n=QE(e);function r(a,s){var h=n((a=WF(a)).r,(s=WF(s)).r),d=n(a.g,s.g),g=n(a.b,s.b),b=Hw(a.opacity,s.opacity);return function(_){return a.r=h(_),a.g=d(_),a.b=g(_),a.opacity=b(_),a+""}}return r.gamma=t,r}(1);function JE(t,e){var n,r=e?e.length:0,a=t?Math.min(r,t.length):0,s=new Array(a),h=new Array(r);for(n=0;n<a;++n)s[n]=Yw(t[n],e[n]);for(;n<r;++n)h[n]=e[n];return function(d){for(n=0;n<a;++n)h[n]=s[n](d);return h}}function qF(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function _S(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function DY(t,e){var n,r={},a={};for(n in t!==null&&typeof t=="object"||(t={}),e!==null&&typeof e=="object"||(e={}),e)n in t?r[n]=Yw(t[n],e[n]):a[n]=e[n];return function(s){for(n in r)a[n]=r[n](s);return a}}var CS=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ES=new RegExp(CS.source,"g");function RY(t,e){var n,r,a,s=CS.lastIndex=ES.lastIndex=0,h=-1,d=[],g=[];for(t+="",e+="";(n=CS.exec(t))&&(r=ES.exec(e));)(a=r.index)>s&&(a=e.slice(s,a),d[h]?d[h]+=a:d[++h]=a),(n=n[0])===(r=r[0])?d[h]?d[h]+=r:d[++h]=r:(d[++h]=null,g.push({i:h,x:_S(n,r)})),s=ES.lastIndex;return s<e.length&&(a=e.slice(s),d[h]?d[h]+=a:d[++h]=a),d.length<2?g[0]?function(b){return function(_){return b(_)+""}}(g[0].x):function(b){return function(){return b}}(e):(e=g.length,function(b){for(var _,E=0;E<e;++E)d[(_=g[E]).i]=_.x(b);return d.join("")})}function FY(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,a=e.slice();return function(s){for(n=0;n<r;++n)a[n]=t[n]*(1-s)+e[n]*s;return a}}function Yw(t,e){var n,r=typeof e;return e==null||r==="boolean"?HF(e):(r==="number"?_S:r==="string"?(n=kS(e))?(e=n,YF):RY:e instanceof kS?YF:e instanceof Date?qF:function(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}(e)?FY:Array.isArray(e)?JE:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?DY:_S)(t,e)}function XF(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function KF(t){return+t}var OY=[0,1];function Fd(t){return t}function tT(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(n){return function(){return n}}(isNaN(e)?NaN:.5)}function sct(t,e,n){var r=t[0],a=t[1],s=e[0],h=e[1];return a<r?(r=tT(a,r),s=n(h,s)):(r=tT(r,a),s=n(s,h)),function(d){return s(r(d))}}function LY(t,e,n){var r=Math.min(t.length,e.length)-1,a=new Array(r),s=new Array(r),h=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++h<r;)a[h]=tT(t[h],t[h+1]),s[h]=n(e[h],e[h+1]);return function(d){var g=Uw(t,d,1,r)-1;return s[g](a[g](d))}}function qw(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function TS(){var t,e,n,r,a,s,h=OY,d=OY,g=Yw,b=Fd;function _(){var I=Math.min(h.length,d.length);return b!==Fd&&(b=function(R,z){var P;return R>z&&(P=R,R=z,z=P),function(rt){return Math.max(R,Math.min(z,rt))}}(h[0],h[I-1])),r=I>2?LY:sct,a=s=null,E}function E(I){return I==null||isNaN(I=+I)?n:(a||(a=r(h.map(t),d,g)))(t(b(I)))}return E.invert=function(I){return b(e((s||(s=r(d,h.map(t),_S)))(I)))},E.domain=function(I){return arguments.length?(h=Array.from(I,KF),_()):h.slice()},E.range=function(I){return arguments.length?(d=Array.from(I),_()):d.slice()},E.rangeRound=function(I){return d=Array.from(I),g=XF,_()},E.clamp=function(I){return arguments.length?(b=!!I||Fd,_()):b!==Fd},E.interpolate=function(I){return arguments.length?(g=I,_()):g},E.unknown=function(I){return arguments.length?(n=I,E):n},function(I,R){return t=I,e=R,_()}}function ZF(){return TS()(Fd,Fd)}function bm(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function S2(t,e){switch(arguments.length){case 0:break;case 1:typeof t=="function"?this.interpolator(t):this.range(t);break;default:this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e)}return this}function eT(t,e,n,r){var a,s=function(d,g,b){b=+b;let _=(g=+g)<(d=+d),E=_?PF(g,d,b):PF(d,g,b);return(_?-1:1)*(E<0?1/-E:E)}(t,e,n);switch((r=pr(r??",f")).type){case"s":var h=Math.max(Math.abs(t),Math.abs(e));return r.precision!=null||isNaN(a=ma(s,h))||(r.precision=a),xv(r,h);case"":case"e":case"g":case"p":case"r":r.precision!=null||isNaN(a=ca(s,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=a-(r.type==="e"));break;case"f":case"%":r.precision!=null||isNaN(a=uo(s))||(r.precision=a-2*(r.type==="%"))}return Pc(r)}function zv(t){var e=t.domain;return t.ticks=function(n){var r=e();return zF(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var a=e();return eT(a[0],a[a.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r,a,s=e(),h=0,d=s.length-1,g=s[h],b=s[d],_=10;for(b<g&&(a=g,g=b,b=a,a=h,h=d,d=a);_-- >0;){if((a=PF(g,b,n))===r)return s[h]=g,s[d]=b,e(s);if(a>0)g=Math.floor(g/a)*a,b=Math.ceil(b/a)*a;else{if(!(a<0))break;g=Math.ceil(g*a)/a,b=Math.floor(b*a)/a}r=a}return t},t}function AS(){var t=ZF();return t.copy=function(){return qw(t,AS())},bm.apply(t,arguments),zv(t)}function Ii(t){var e;function n(r){return r==null||isNaN(r=+r)?e:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(t=Array.from(r,KF),n):t.slice()},n.unknown=function(r){return arguments.length?(e=r,n):e},n.copy=function(){return Ii(t).unknown(e)},t=arguments.length?Array.from(t,KF):[0,1],zv(n)}function $Y(t,e){var n,r=0,a=(t=t.slice()).length-1,s=t[r],h=t[a];return h<s&&(n=r,r=a,a=n,n=s,s=h,h=n),t[r]=e.floor(s),t[a]=e.ceil(h),t}function Xw(t){return Math.log(t)}function QF(t){return Math.exp(t)}function uct(t){return-Math.log(-t)}function nl(t){return-Math.exp(-t)}function Od(t){return isFinite(t)?+("1e"+t):t<0?0:t}function zY(t){return(e,n)=>-t(-e,n)}function Kw(t){let e=t(Xw,QF),n=e.domain,r,a,s=10;function h(){return r=function(d){return d===Math.E?Math.log:d===10&&Math.log10||d===2&&Math.log2||(d=Math.log(d),g=>Math.log(g)/d)}(s),a=function(d){return d===10?Od:d===Math.E?Math.exp:g=>Math.pow(d,g)}(s),n()[0]<0?(r=zY(r),a=zY(a),t(uct,nl)):t(Xw,QF),e}return e.base=function(d){return arguments.length?(s=+d,h()):s},e.domain=function(d){return arguments.length?(n(d),h()):n()},e.ticks=d=>{let g=n(),b=g[0],_=g[g.length-1],E=_<b;E&&([b,_]=[_,b]);let I,R,z=r(b),P=r(_),rt=d==null?10:+d,ot=[];if(!(s%1)&&P-z<rt){if(z=Math.floor(z),P=Math.ceil(P),b>0){for(;z<=P;++z)for(I=1;I<s;++I)if(R=z<0?I/a(-z):I*a(z),!(R<b)){if(R>_)break;ot.push(R)}}else for(;z<=P;++z)for(I=s-1;I>=1;--I)if(R=z>0?I/a(-z):I*a(z),!(R<b)){if(R>_)break;ot.push(R)}2*ot.length<rt&&(ot=zF(b,_,rt))}else ot=zF(z,P,Math.min(P-z,rt)).map(a);return E?ot.reverse():ot},e.tickFormat=(d,g)=>{if(d==null&&(d=10),g==null&&(g=s===10?"s":","),typeof g!="function"&&(s%1||(g=pr(g)).precision!=null||(g.trim=!0),g=Pc(g)),d===1/0)return g;let b=Math.max(1,s*d/e.ticks().length);return _=>{let E=_/a(Math.round(r(_)));return E*s<s-.5&&(E*=s),E<=b?g(_):""}},e.nice=()=>n($Y(n(),{floor:d=>a(Math.floor(r(d))),ceil:d=>a(Math.ceil(r(d)))})),e}function xf(){let t=Kw(TS()).domain([1,10]);return t.copy=()=>qw(t,xf()).base(t.base()),bm.apply(t,arguments),t}function PY(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Pv(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function lct(t){return t<0?-t*t:t*t}function nT(t){var e=t(Fd,Fd),n=1;return e.exponent=function(r){return arguments.length?(n=+r)==1?t(Fd,Fd):n===.5?t(Pv,lct):t(PY(n),PY(1/n)):n},zv(e)}function cp(){var t=nT(TS());return t.copy=function(){return qw(t,cp()).exponent(t.exponent())},bm.apply(t,arguments),t}function JF(){return cp.apply(null,arguments).exponent(.5)}function ml(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function rT(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function iT(t){var e=1,n=t(ml(e),rT(e));return n.constant=function(r){return arguments.length?t(ml(e=+r),rT(e)):e},zv(n)}function aT(){var t=iT(TS());return t.copy=function(){return qw(t,aT()).constant(t.constant())},bm.apply(t,arguments)}function _2(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function cct(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function tO(){return 0}let BY=Math.sqrt(50),jY=Math.sqrt(10),hct=Math.sqrt(2);function UY(t,e,n){let r=(e-t)/Math.max(0,n),a=Math.floor(Math.log10(r)),s=r/Math.pow(10,a),h=s>=BY?10:s>=jY?5:s>=hct?2:1,d,g,b;return a<0?(b=Math.pow(10,-a)/h,d=Math.round(t*b),g=Math.round(e*b),d/b<t&&++d,g/b>e&&--g,b=-b):(b=Math.pow(10,a)*h,d=Math.round(t/b),g=Math.round(e/b),d*b<t&&++d,g*b>e&&--g),g<d&&.5<=n&&n<2?UY(t,e,2*n):[d,g,b]}function y0(t,e,n){return UY(t=+t,e=+e,n=+n)[2]}function ns(t,e,n){n=+n;let r=(e=+e)<(t=+t),a=r?y0(e,t,n):y0(t,e,n);return(r?-1:1)*(a<0?1/-a:a)}function $g(t,e,n,r,a,s){let h=[[Il,1,yf],[Il,5,5e3],[Il,15,15e3],[Il,30,3e4],[s,1,o0],[s,5,3e5],[s,15,9e5],[s,30,18e5],[a,1,l2],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,kv],[r,2,1728e5],[n,1,xw],[e,1,lm],[e,3,7776e6],[t,1,cm]];function d(g,b,_){let E=Math.abs(b-g)/_,I=function(P){let rt,ot,at;function dt(ct,Ct,Et=0,Rt=ct.length){if(Et<Rt){if(rt(Ct,Ct)!==0)return Rt;do{let Ot=Et+Rt>>>1;ot(ct[Ot],Ct)<0?Et=Ot+1:Rt=Ot}while(Et<Rt)}return Et}return P.length!==2?(rt=_2,ot=(ct,Ct)=>_2(P(ct),Ct),at=(ct,Ct)=>P(ct)-Ct):(rt=P===_2||P===cct?P:tO,ot=P,at=P),{left:dt,center:function(ct,Ct,Et=0,Rt=ct.length){let Ot=dt(ct,Ct,Et,Rt-1);return Ot>Et&&at(ct[Ot-1],Ct)>-at(ct[Ot],Ct)?Ot-1:Ot},right:function(ct,Ct,Et=0,Rt=ct.length){if(Et<Rt){if(rt(Ct,Ct)!==0)return Rt;do{let Ot=Et+Rt>>>1;ot(ct[Ot],Ct)<=0?Et=Ot+1:Rt=Ot}while(Et<Rt)}return Et}}}(([,,P])=>P).right(h,E);if(I===h.length)return t.every(ns(g/cm,b/cm,_));if(I===0)return bf.every(Math.max(ns(g,b,_),1));let[R,z]=h[E/h[I-1][2]<h[I][2]/E?I-1:I];return R.every(z)}return[function(g,b,_){let E=b<g;E&&([g,b]=[b,g]);let I=_&&typeof _.range=="function"?_:d(g,b,_),R=I?I.range(g,+b+1):[];return E?R.reverse():R},d]}let[WY,dct]=$g(Uc,Kh,Td,jc,hm,Ag),[fct,VY]=$g(gh,tl,Hl,Ds,ip,lc);function GY(t){return new Date(t)}function HY(t){return t instanceof Date?+t:+new Date(+t)}function eO(t,e,n,r,a,s,h,d,g,b){var _=ZF(),E=_.invert,I=_.domain,R=b(".%L"),z=b(":%S"),P=b("%I:%M"),rt=b("%I %p"),ot=b("%a %d"),at=b("%b %d"),dt=b("%B"),ct=b("%Y");function Ct(Et){return(g(Et)<Et?R:d(Et)<Et?z:h(Et)<Et?P:s(Et)<Et?rt:r(Et)<Et?a(Et)<Et?ot:at:n(Et)<Et?dt:ct)(Et)}return _.invert=function(Et){return new Date(E(Et))},_.domain=function(Et){return arguments.length?I(Array.from(Et,HY)):I().map(GY)},_.ticks=function(Et){var Rt=I();return t(Rt[0],Rt[Rt.length-1],Et??10)},_.tickFormat=function(Et,Rt){return Rt==null?Ct:b(Rt)},_.nice=function(Et){var Rt=I();return Et&&typeof Et.range=="function"||(Et=e(Rt[0],Rt[Rt.length-1],Et??10)),Et?I($Y(Rt,Et)):_},_.copy=function(){return qw(_,eO(t,e,n,r,a,s,h,d,g,b))},_}function oT(){return bm.apply(eO(fct,VY,gh,tl,Hl,Ds,ip,lc,Il,Z8).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function sT(){return bm.apply(eO(WY,dct,Uc,Kh,Td,Ss,hm,Ag,Il,Q8).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function uT(){var t,e,n,r,a,s=0,h=1,d=Fd,g=!1;function b(E){return E==null||isNaN(E=+E)?a:d(n===0?.5:(E=(r(E)-t)*n,g?Math.max(0,Math.min(1,E)):E))}function _(E){return function(I){var R,z;return arguments.length?([R,z]=I,d=E(R,z),b):[d(0),d(1)]}}return b.domain=function(E){return arguments.length?([s,h]=E,t=r(s=+s),e=r(h=+h),n=t===e?0:1/(e-t),b):[s,h]},b.clamp=function(E){return arguments.length?(g=!!E,b):g},b.interpolator=function(E){return arguments.length?(d=E,b):d},b.range=_(Yw),b.rangeRound=_(XF),b.unknown=function(E){return arguments.length?(a=E,b):a},function(E){return r=E,t=E(s),e=E(h),n=t===e?0:1/(e-t),b}}function zg(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Bv(){var t=zv(uT()(Fd));return t.copy=function(){return zg(t,Bv())},S2.apply(t,arguments)}function lT(){var t=Kw(uT()).domain([1,10]);return t.copy=function(){return zg(t,lT()).base(t.base())},S2.apply(t,arguments)}function IS(){var t=iT(uT());return t.copy=function(){return zg(t,IS()).constant(t.constant())},S2.apply(t,arguments)}function NS(){var t=nT(uT());return t.copy=function(){return zg(t,NS()).exponent(t.exponent())},S2.apply(t,arguments)}function nO(){return NS.apply(null,arguments).exponent(.5)}function MS(){var t,e,n,r,a,s,h,d=0,g=.5,b=1,_=1,E=Fd,I=!1;function R(P){return isNaN(P=+P)?h:(P=.5+((P=+s(P))-e)*(_*P<_*e?r:a),E(I?Math.max(0,Math.min(1,P)):P))}function z(P){return function(rt){var ot,at,dt;return arguments.length?([ot,at,dt]=rt,E=function(ct,Ct){Ct===void 0&&(Ct=ct,ct=Yw);for(var Et=0,Rt=Ct.length-1,Ot=Ct[0],Wt=new Array(Rt<0?0:Rt);Et<Rt;)Wt[Et]=ct(Ot,Ot=Ct[++Et]);return function(jt){var Ht=Math.max(0,Math.min(Rt-1,Math.floor(jt*=Rt)));return Wt[Ht](jt-Ht)}}(P,[ot,at,dt]),R):[E(0),E(.5),E(1)]}}return R.domain=function(P){return arguments.length?([d,g,b]=P,t=s(d=+d),e=s(g=+g),n=s(b=+b),r=t===e?0:.5/(e-t),a=e===n?0:.5/(n-e),_=e<t?-1:1,R):[d,g,b]},R.clamp=function(P){return arguments.length?(I=!!P,R):I},R.interpolator=function(P){return arguments.length?(E=P,R):E},R.range=z(Yw),R.rangeRound=z(XF),R.unknown=function(P){return arguments.length?(h=P,R):h},function(P){return s=P,t=P(d),e=P(g),n=P(b),r=t===e?0:.5/(e-t),a=e===n?0:.5/(n-e),_=e<t?-1:1,R}}function cT(){var t=zv(MS()(Fd));return t.copy=function(){return zg(t,cT())},S2.apply(t,arguments)}function hT(){var t=Kw(MS()).domain([.1,1,10]);return t.copy=function(){return zg(t,hT()).base(t.base())},S2.apply(t,arguments)}function DS(){var t=iT(MS());return t.copy=function(){return zg(t,DS()).constant(t.constant())},S2.apply(t,arguments)}function Zw(){var t=nT(MS());return t.copy=function(){return zg(t,Zw()).exponent(t.exponent())},S2.apply(t,arguments)}function dT(){return Zw.apply(null,arguments).exponent(.5)}function pct(t,e,n=jF){if((r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,a=(r-1)*e,s=Math.floor(a),h=+n(t[s],s,t);return h+(+n(t[s+1],s+1,t)-h)*(a-s)}}function fT(){var t,e=[],n=[],r=[];function a(){var h=0,d=Math.max(1,n.length);for(r=new Array(d-1);++h<d;)r[h-1]=pct(e,h/d);return s}function s(h){return h==null||isNaN(h=+h)?t:n[Uw(r,h)]}return s.invertExtent=function(h){var d=n.indexOf(h);return d<0?[NaN,NaN]:[d>0?r[d-1]:e[0],d<r.length?r[d]:e[e.length-1]]},s.domain=function(h){if(!arguments.length)return e.slice();e=[];for(let d of h)d==null||isNaN(d=+d)||e.push(d);return e.sort(bS),a()},s.range=function(h){return arguments.length?(n=Array.from(h),a()):n.slice()},s.unknown=function(h){return arguments.length?(t=h,s):t},s.quantiles=function(){return r.slice()},s.copy=function(){return fT().domain(e).range(n).unknown(t)},bm.apply(s,arguments)}function RS(){var t,e=0,n=1,r=1,a=[.5],s=[0,1];function h(g){return g!=null&&g<=g?s[Uw(a,g,0,r)]:t}function d(){var g=-1;for(a=new Array(r);++g<r;)a[g]=((g+1)*n-(g-r)*e)/(r+1);return h}return h.domain=function(g){return arguments.length?([e,n]=g,e=+e,n=+n,d()):[e,n]},h.range=function(g){return arguments.length?(r=(s=Array.from(g)).length-1,d()):s.slice()},h.invertExtent=function(g){var b=s.indexOf(g);return b<0?[NaN,NaN]:b<1?[e,a[0]]:b>=r?[a[r-1],n]:[a[b-1],a[b]]},h.unknown=function(g){return arguments.length&&(t=g),h},h.thresholds=function(){return a.slice()},h.copy=function(){return RS().domain([e,n]).range(s).unknown(t)},bm.apply(zv(h),arguments)}function pT(){var t,e=[.5],n=[0,1],r=1;function a(s){return s!=null&&s<=s?n[Uw(e,s,0,r)]:t}return a.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,n.length-1),a):e.slice()},a.range=function(s){return arguments.length?(n=Array.from(s),r=Math.min(e.length,n.length-1),a):n.slice()},a.invertExtent=function(s){var h=n.indexOf(s);return[e[h-1],e[h]]},a.unknown=function(s){return arguments.length?(t=s,a):t},a.copy=function(){return pT().domain(e).range(n).unknown(t)},bm.apply(a,arguments)}class YY extends Map{constructor(e,n=qY){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(let[r,a]of e)this.set(r,a)}get(e){return super.get(rO(this,e))}has(e){return super.has(rO(this,e))}set(e,n){return super.set(mct(this,e),n)}delete(e){return super.delete(gct(this,e))}}function rO({_intern:t,_key:e},n){let r=e(n);return t.has(r)?t.get(r):n}function mct({_intern:t,_key:e},n){let r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function gct({_intern:t,_key:e},n){let r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function qY(t){return t!==null&&typeof t=="object"?t.valueOf():t}let iO=Symbol("implicit");function jv(){var t=new YY,e=[],n=[],r=iO;function a(s){let h=t.get(s);if(h===void 0){if(r!==iO)return r;t.set(s,h=e.push(s)-1)}return n[h%n.length]}return a.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new YY;for(let h of s)t.has(h)||t.set(h,e.push(h)-1);return a},a.range=function(s){return arguments.length?(n=Array.from(s),a):n.slice()},a.unknown=function(s){return arguments.length?(r=s,a):r},a.copy=function(){return jv(e,n).unknown(r)},bm.apply(a,arguments),a}function Uv(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Qw(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function C2(){}var Wv=.7,Vv=1/Wv,Gv="\\s*([+-]?\\d+)\\s*",FS="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",wm="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",XY=/^#([0-9a-f]{3,8})$/,yct=new RegExp(`^rgb\\(${Gv},${Gv},${Gv}\\)$`),vct=new RegExp(`^rgb\\(${wm},${wm},${wm}\\)$`),aO=new RegExp(`^rgba\\(${Gv},${Gv},${Gv},${FS}\\)$`),bct=new RegExp(`^rgba\\(${wm},${wm},${wm},${FS}\\)$`),mT=new RegExp(`^hsl\\(${FS},${wm},${wm}\\)$`),wct=new RegExp(`^hsla\\(${FS},${wm},${wm},${FS}\\)$`),oO={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function KY(){return this.rgb().formatHex()}function sO(){return this.rgb().formatRgb()}function OS(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=XY.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?ZY(e):n===3?new ql(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):n===8?Jw(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):n===4?Jw(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=yct.exec(t))?new ql(e[1],e[2],e[3],1):(e=vct.exec(t))?new ql(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=aO.exec(t))?Jw(e[1],e[2],e[3],e[4]):(e=bct.exec(t))?Jw(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=mT.exec(t))?uO(e[1],e[2]/100,e[3]/100,1):(e=wct.exec(t))?uO(e[1],e[2]/100,e[3]/100,e[4]):oO.hasOwnProperty(t)?ZY(oO[t]):t==="transparent"?new ql(NaN,NaN,NaN,0):null}function ZY(t){return new ql(t>>16&255,t>>8&255,255&t,1)}function Jw(t,e,n,r){return r<=0&&(t=e=n=NaN),new ql(t,e,n,r)}function Gc(t){return t instanceof C2||(t=OS(t)),t?new ql((t=t.rgb()).r,t.g,t.b,t.opacity):new ql}function gT(t,e,n,r){return arguments.length===1?Gc(t):new ql(t,e,n,r??1)}function ql(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function QY(){return`#${E2(this.r)}${E2(this.g)}${E2(this.b)}`}function JY(){let t=LS(this.opacity);return`${t===1?"rgb(":"rgba("}${Hv(this.r)}, ${Hv(this.g)}, ${Hv(this.b)}${t===1?")":`, ${t})`}`}function LS(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Hv(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function E2(t){return((t=Hv(t))<16?"0":"")+t.toString(16)}function uO(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new $d(t,e,n,r)}function lO(t){if(t instanceof $d)return new $d(t.h,t.s,t.l,t.opacity);if(t instanceof C2||(t=OS(t)),!t)return new $d;if(t instanceof $d)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),s=Math.max(e,n,r),h=NaN,d=s-a,g=(s+a)/2;return d?(h=e===s?(n-r)/d+6*(n<r):n===s?(r-e)/d+2:(e-n)/d+4,d/=g<.5?s+a:2-s-a,h*=60):d=g>0&&g<1?0:h,new $d(h,d,g,t.opacity)}function Ld(t,e,n,r){return arguments.length===1?lO(t):new $d(t,e,n,r??1)}function $d(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function cO(t){return(t=(t||0)%360)<0?t+360:t}function $S(t){return Math.max(0,Math.min(1,t||0))}function yT(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function hO(t,e,n,r,a){var s=t*t,h=s*t;return((1-3*t+3*s-h)*e+(4-6*s+3*h)*n+(1+3*t+3*s-3*h)*r+h*a)/6}function dO(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),a=t[r],s=t[r+1],h=r>0?t[r-1]:2*a-s,d=r<e-1?t[r+2]:2*s-a;return hO((n-r/e)*e,h,a,s,d)}}function tq(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),a=t[(r+e-1)%e],s=t[r%e],h=t[(r+1)%e],d=t[(r+2)%e];return hO((n-r/e)*e,a,s,h,d)}}Uv(C2,OS,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:KY,formatHex:KY,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return lO(this).formatHsl()},formatRgb:sO,toString:sO}),Uv(ql,gT,Qw(C2,{brighter(t){return t=t==null?Vv:Math.pow(Vv,t),new ql(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Wv:Math.pow(Wv,t),new ql(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ql(Hv(this.r),Hv(this.g),Hv(this.b),LS(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:QY,formatHex:QY,formatHex8:function(){return`#${E2(this.r)}${E2(this.g)}${E2(this.b)}${E2(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:JY,toString:JY})),Uv($d,Ld,Qw(C2,{brighter(t){return t=t==null?Vv:Math.pow(Vv,t),new $d(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Wv:Math.pow(Wv,t),new $d(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,a=2*n-r;return new ql(yT(t>=240?t-240:t+120,a,r),yT(t,a,r),yT(t<120?t+240:t-120,a,r),this.opacity)},clamp(){return new $d(cO(this.h),$S(this.s),$S(this.l),LS(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=LS(this.opacity);return`${t===1?"hsl(":"hsla("}${cO(this.h)}, ${100*$S(this.s)}%, ${100*$S(this.l)}%${t===1?")":`, ${t})`}`}}));let vT=t=>()=>t;function T2(t,e){return function(n){return t+n*e}}function bT(t,e){var n=e-t;return n?T2(t,n>180||n<-180?n-360*Math.round(n/360):n):vT(isNaN(t)?e:t)}function eq(t){return(t=+t)==1?dc:function(e,n){return n-e?function(r,a,s){return r=Math.pow(r,s),a=Math.pow(a,s)-r,s=1/s,function(h){return Math.pow(r+h*a,s)}}(e,n,t):vT(isNaN(e)?n:e)}}function dc(t,e){var n=e-t;return n?T2(t,n):vT(isNaN(t)?e:t)}let wT=function t(e){var n=eq(e);function r(a,s){var h=n((a=gT(a)).r,(s=gT(s)).r),d=n(a.g,s.g),g=n(a.b,s.b),b=dc(a.opacity,s.opacity);return function(_){return a.r=h(_),a.g=d(_),a.b=g(_),a.opacity=b(_),a+""}}return r.gamma=t,r}(1);function A2(t){return function(e){var n,r,a=e.length,s=new Array(a),h=new Array(a),d=new Array(a);for(n=0;n<a;++n)r=gT(e[n]),s[n]=r.r||0,h[n]=r.g||0,d[n]=r.b||0;return s=t(s),h=t(h),d=t(d),r.opacity=1,function(g){return r.r=s(g),r.g=h(g),r.b=d(g),r+""}}}var xct=A2(dO),nq=A2(tq);function xT(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,a=e.slice();return function(s){for(n=0;n<r;++n)a[n]=t[n]*(1-s)+e[n]*s;return a}}function kT(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function kct(t,e){return(kT(e)?xT:rq)(t,e)}function rq(t,e){var n,r=e?e.length:0,a=t?Math.min(r,t.length):0,s=new Array(a),h=new Array(r);for(n=0;n<a;++n)s[n]=_T(t[n],e[n]);for(;n<r;++n)h[n]=e[n];return function(d){for(n=0;n<a;++n)h[n]=s[n](d);return h}}function iq(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function v0(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function aq(t,e){var n,r={},a={};for(n in t!==null&&typeof t=="object"||(t={}),e!==null&&typeof e=="object"||(e={}),e)n in t?r[n]=_T(t[n],e[n]):a[n]=e[n];return function(s){for(n in r)a[n]=r[n](s);return a}}var fO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ST=new RegExp(fO.source,"g");function oq(t,e){var n,r,a,s=fO.lastIndex=ST.lastIndex=0,h=-1,d=[],g=[];for(t+="",e+="";(n=fO.exec(t))&&(r=ST.exec(e));)(a=r.index)>s&&(a=e.slice(s,a),d[h]?d[h]+=a:d[++h]=a),(n=n[0])===(r=r[0])?d[h]?d[h]+=r:d[++h]=r:(d[++h]=null,g.push({i:h,x:v0(n,r)})),s=ST.lastIndex;return s<e.length&&(a=e.slice(s),d[h]?d[h]+=a:d[++h]=a),d.length<2?g[0]?function(b){return function(_){return b(_)+""}}(g[0].x):function(b){return function(){return b}}(e):(e=g.length,function(b){for(var _,E=0;E<e;++E)d[(_=g[E]).i]=_.x(b);return d.join("")})}function _T(t,e){var n,r=typeof e;return e==null||r==="boolean"?vT(e):(r==="number"?v0:r==="string"?(n=OS(e))?(e=n,wT):oq:e instanceof OS?wT:e instanceof Date?iq:kT(e)?xT:Array.isArray(e)?rq:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?aq:v0)(t,e)}function pO(t,e){e===void 0&&(e=t,t=_T);for(var n=0,r=e.length-1,a=e[0],s=new Array(r<0?0:r);n<r;)s[n]=t(a,a=e[++n]);return function(h){var d=Math.max(0,Math.min(r-1,Math.floor(h*=r)));return s[d](h-d)}}function Sct(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function sq(t,e){var n=bT(+t,+e);return function(r){var a=n(r);return a-360*Math.floor(a/360)}}function _ct(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var zS,mO=180/Math.PI,CT={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function uq(t,e,n,r,a,s){var h,d,g;return(h=Math.sqrt(t*t+e*e))&&(t/=h,e/=h),(g=t*n+e*r)&&(n-=t*g,r-=e*g),(d=Math.sqrt(n*n+r*r))&&(n/=d,r/=d,g/=d),t*r<e*n&&(t=-t,e=-e,g=-g,h=-h),{translateX:a,translateY:s,rotate:Math.atan2(e,t)*mO,skewX:Math.atan(g)*mO,scaleX:h,scaleY:d}}function ET(t,e,n,r){function a(s){return s.length?s.pop()+" ":""}return function(s,h){var d=[],g=[];return s=t(s),h=t(h),function(b,_,E,I,R,z){if(b!==E||_!==I){var P=R.push("translate(",null,e,null,n);z.push({i:P-4,x:v0(b,E)},{i:P-2,x:v0(_,I)})}else(E||I)&&R.push("translate("+E+e+I+n)}(s.translateX,s.translateY,h.translateX,h.translateY,d,g),function(b,_,E,I){b!==_?(b-_>180?_+=360:_-b>180&&(b+=360),I.push({i:E.push(a(E)+"rotate(",null,r)-2,x:v0(b,_)})):_&&E.push(a(E)+"rotate("+_+r)}(s.rotate,h.rotate,d,g),function(b,_,E,I){b!==_?I.push({i:E.push(a(E)+"skewX(",null,r)-2,x:v0(b,_)}):_&&E.push(a(E)+"skewX("+_+r)}(s.skewX,h.skewX,d,g),function(b,_,E,I,R,z){if(b!==E||_!==I){var P=R.push(a(R)+"scale(",null,",",null,")");z.push({i:P-4,x:v0(b,E)},{i:P-2,x:v0(_,I)})}else E===1&&I===1||R.push(a(R)+"scale("+E+","+I+")")}(s.scaleX,s.scaleY,h.scaleX,h.scaleY,d,g),s=h=null,function(b){for(var _,E=-1,I=g.length;++E<I;)d[(_=g[E]).i]=_.x(b);return d.join("")}}}var Cct=ET(function(t){let e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?CT:uq(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),lq=ET(function(t){return t==null?CT:(zS||(zS=document.createElementNS("http://www.w3.org/2000/svg","g")),zS.setAttribute("transform",t),(t=zS.transform.baseVal.consolidate())?uq((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):CT)},", ",")",")");function tx(t){return((t=Math.exp(t))+1/t)/2}let cq=function t(e,n,r){function a(s,h){var d,g,b=s[0],_=s[1],E=s[2],I=h[0],R=h[1],z=h[2],P=I-b,rt=R-_,ot=P*P+rt*rt;if(ot<1e-12)g=Math.log(z/E)/e,d=function(Rt){return[b+Rt*P,_+Rt*rt,E*Math.exp(e*Rt*g)]};else{var at=Math.sqrt(ot),dt=(z*z-E*E+r*ot)/(2*E*n*at),ct=(z*z-E*E-r*ot)/(2*z*n*at),Ct=Math.log(Math.sqrt(dt*dt+1)-dt),Et=Math.log(Math.sqrt(ct*ct+1)-ct);g=(Et-Ct)/e,d=function(Rt){var Ot=Rt*g,Wt=tx(Ct),jt=E/(n*at)*(Wt*function(Ht){return((Ht=Math.exp(2*Ht))-1)/(Ht+1)}(e*Ot+Ct)-function(Ht){return((Ht=Math.exp(Ht))-1/Ht)/2}(Ct));return[b+jt*P,_+jt*rt,E*Wt/tx(e*Ot+Ct)]}}return d.duration=1e3*g*e/Math.SQRT2,d}return a.rho=function(s){var h=Math.max(.001,+s),d=h*h;return t(h,d,d*d)},a}(Math.SQRT2,2,4);function gO(t){return function(e,n){var r=t((e=Ld(e)).h,(n=Ld(n)).h),a=dc(e.s,n.s),s=dc(e.l,n.l),h=dc(e.opacity,n.opacity);return function(d){return e.h=r(d),e.s=a(d),e.l=s(d),e.opacity=h(d),e+""}}}let hq=gO(bT);var dq=gO(dc);let yO=Math.PI/180,fq=180/Math.PI,vO=.96422,pq=1,mq=.82521,bO=4/29,wO=6/29,xO=3*wO*wO,Ect=.008856451679035631;function kO(t){if(t instanceof kf)return new kf(t.l,t.a,t.b,t.opacity);if(t instanceof Pg)return gq(t);t instanceof ql||(t=Gc(t));var e,n,r=CO(t.r),a=CO(t.g),s=CO(t.b),h=Cs((.2225045*r+.7168786*a+.0606169*s)/pq);return r===a&&a===s?e=n=h:(e=Cs((.4360747*r+.3850649*a+.1430804*s)/vO),n=Cs((.0139322*r+.0971045*a+.7141733*s)/mq)),new kf(116*h-16,500*(e-h),200*(h-n),t.opacity)}function SO(t,e,n,r){return arguments.length===1?kO(t):new kf(t,e,n,r??1)}function kf(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Cs(t){return t>Ect?Math.pow(t,.3333333333333333):t/xO+bO}function _O(t){return t>wO?t*t*t:xO*(t-bO)}function TT(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,.4166666666666667)-.055)}function CO(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Tct(t){if(t instanceof Pg)return new Pg(t.h,t.c,t.l,t.opacity);if(t instanceof kf||(t=kO(t)),t.a===0&&t.b===0)return new Pg(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*fq;return new Pg(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function EO(t,e,n,r){return arguments.length===1?Tct(t):new Pg(t,e,n,r??1)}function Pg(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function gq(t){if(isNaN(t.h))return new kf(t.l,0,0,t.opacity);var e=t.h*yO;return new kf(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function Act(t,e){var n=dc((t=SO(t)).l,(e=SO(e)).l),r=dc(t.a,e.a),a=dc(t.b,e.b),s=dc(t.opacity,e.opacity);return function(h){return t.l=n(h),t.a=r(h),t.b=a(h),t.opacity=s(h),t+""}}function yq(t){return function(e,n){var r=t((e=EO(e)).h,(n=EO(n)).h),a=dc(e.c,n.c),s=dc(e.l,n.l),h=dc(e.opacity,n.opacity);return function(d){return e.h=r(d),e.c=a(d),e.l=s(d),e.opacity=h(d),e+""}}}Uv(kf,SO,Qw(C2,{brighter(t){return new kf(this.l+18*(t??1),this.a,this.b,this.opacity)},darker(t){return new kf(this.l-18*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new ql(TT(3.1338561*(e=vO*_O(e))-1.6168667*(t=pq*_O(t))-.4906146*(n=mq*_O(n))),TT(-.9787684*e+1.9161415*t+.033454*n),TT(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Uv(Pg,EO,Qw(C2,{brighter(t){return new Pg(this.h,this.c,this.l+18*(t??1),this.opacity)},darker(t){return new Pg(this.h,this.c,this.l-18*(t??1),this.opacity)},rgb(){return gq(this).rgb()}}));let Ict=yq(bT);var Nct=yq(dc),vq=-.14861,TO=1.78277,AO=-.29227,AT=-.90649,PS=1.97294,bq=PS*AT,wq=PS*TO,xq=TO*AO-AT*vq;function IO(t,e,n,r){return arguments.length===1?function(a){if(a instanceof Yv)return new Yv(a.h,a.s,a.l,a.opacity);a instanceof ql||(a=Gc(a));var s=a.r/255,h=a.g/255,d=a.b/255,g=(xq*d+bq*s-wq*h)/(xq+bq-wq),b=d-g,_=(PS*(h-g)-AO*b)/AT,E=Math.sqrt(_*_+b*b)/(PS*g*(1-g)),I=E?Math.atan2(_,b)*fq-120:NaN;return new Yv(I<0?I+360:I,E,g,a.opacity)}(t):new Yv(t,e,n,r??1)}function Yv(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function kq(t){return function e(n){function r(a,s){var h=t((a=IO(a)).h,(s=IO(s)).h),d=dc(a.s,s.s),g=dc(a.l,s.l),b=dc(a.opacity,s.opacity);return function(_){return a.h=h(_),a.s=d(_),a.l=g(Math.pow(_,n)),a.opacity=b(_),a+""}}return n=+n,r.gamma=e,r}(1)}Uv(Yv,IO,Qw(C2,{brighter(t){return t=t==null?Vv:Math.pow(Vv,t),new Yv(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Wv:Math.pow(Wv,t),new Yv(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*yO,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),a=Math.sin(t);return new ql(255*(e+n*(vq*r+TO*a)),255*(e+n*(AO*r+AT*a)),255*(e+n*(PS*r)),this.opacity)}}));let Mct=kq(bT);var Dct=kq(dc);function NO(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}function b0(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}let IT=b0("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),MO=b0("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),DO=b0("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),RO=b0("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),FO=b0("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),OO=b0("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),LO=b0("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),$O=b0("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),zO=b0("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),PO=b0("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function BO(t,e,n){let r=t-e+2*n;return t?r>0?r:1:0}let ex="linear",zd="log",BS="pow",xm="sqrt",NT="symlog",I2="time",qv="utc",km="sequential",nx="diverging",rx="quantile",MT="quantize",DT="threshold",jO="ordinal",UO="point",Sq="band",WO="bin-ordinal",Xl="continuous",jS="discrete",US="discretizing",hp="interpolating",VO="temporal";function RT(){let t=jv().unknown(void 0),e=t.domain,n=t.range,r,a,s=[0,1],h=!1,d=0,g=0,b=.5;function _(){let E=e().length,I=s[1]<s[0],R=s[1-I],z=BO(E,d,g),P=s[I-0];r=(R-P)/(z||1),h&&(r=Math.floor(r)),P+=(R-P-r*(E-d))*b,a=r*(1-d),h&&(P=Math.round(P),a=Math.round(a));let rt=function(ot,at,dt){ot=+ot,at=+at,dt=(Ct=arguments.length)<2?(at=ot,ot=0,1):Ct<3?1:+dt;for(var ct=-1,Ct=0|Math.max(0,Math.ceil((at-ot)/dt)),Et=new Array(Ct);++ct<Ct;)Et[ct]=ot+ct*dt;return Et}(E).map(ot=>P+r*ot);return n(I?rt.reverse():rt)}return delete t.unknown,t.domain=function(E){return arguments.length?(e(E),_()):e()},t.range=function(E){return arguments.length?(s=[+E[0],+E[1]],_()):s.slice()},t.rangeRound=function(E){return s=[+E[0],+E[1]],h=!0,_()},t.bandwidth=function(){return a},t.step=function(){return r},t.round=function(E){return arguments.length?(h=!!E,_()):h},t.padding=function(E){return arguments.length?(g=Math.max(0,Math.min(1,E)),d=g,_()):d},t.paddingInner=function(E){return arguments.length?(d=Math.max(0,Math.min(1,E)),_()):d},t.paddingOuter=function(E){return arguments.length?(g=Math.max(0,Math.min(1,E)),_()):g},t.align=function(E){return arguments.length?(b=Math.max(0,Math.min(1,E)),_()):b},t.invertRange=function(E){if(E[0]==null||E[1]==null)return;let I=s[1]<s[0],R=I?n().reverse():n(),z=R.length-1,P,rt,ot,at=+E[0],dt=+E[1];return at!=at||dt!=dt||(dt<at&&(ot=at,at=dt,dt=ot),dt<R[0]||at>s[1-I])?void 0:(P=Math.max(0,$F(R,at)-1),rt=at===dt?P:$F(R,dt)-1,at-R[P]>a+1e-10&&++P,I&&(ot=P,P=z-rt,rt=z-ot),P>rt?void 0:e().slice(P,rt+1))},t.invert=function(E){let I=t.invertRange([E,E]);return I&&I[0]},t.copy=function(){return RT().domain(e()).range(s).round(h).paddingInner(d).paddingOuter(g).align(b)},_()}function _q(t){let e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return _q(e())},t}var Rct=Array.prototype.map;let Fct=Array.prototype.slice,FT=new Map,Cq=Symbol("vega_scale");function Eq(t){return t[Cq]=!0,t}function rs(t,e,n){return arguments.length>1?(FT.set(t,function(r,a,s){let h=function(){let d=a();return d.invertRange||(d.invertRange=d.invert?function(g){return function(b){let _,E=b[0],I=b[1];return I<E&&(_=E,E=I,I=_),[g.invert(E),g.invert(I)]}}(d):d.invertExtent?function(g){return function(b){let _=g.range(),E,I,R,z,P=b[0],rt=b[1],ot=-1;for(rt<P&&(I=P,P=rt,rt=I),R=0,z=_.length;R<z;++R)_[R]>=P&&_[R]<=rt&&(ot<0&&(ot=R),E=R);if(!(ot<0))return P=g.invertExtent(_[ot]),rt=g.invertExtent(_[E]),[P[0]===void 0?P[1]:P[0],rt[1]===void 0?rt[0]:rt[1]]}}(d):void 0),d.type=r,Eq(d)};return h.metadata=zc(et(s)),h}(t,e,n)),this):Tq(t)?FT.get(t):void 0}function Tq(t){return FT.has(t)}function w0(t,e){let n=FT.get(t);return n&&n.metadata[e]}function GO(t){return w0(t,Xl)}function ix(t){return w0(t,jS)}function HO(t){return w0(t,US)}function Aq(t){return w0(t,zd)}function Iq(t){return w0(t,hp)}function Nq(t){return w0(t,rx)}rs("identity",Ii),rs(ex,AS,Xl),rs(zd,xf,[Xl,zd]),rs(BS,cp,Xl),rs(xm,JF,Xl),rs(NT,aT,Xl),rs(I2,oT,[Xl,VO]),rs(qv,sT,[Xl,VO]),rs(km,Bv,[Xl,hp]),rs(`${km}-${ex}`,Bv,[Xl,hp]),rs(`${km}-${zd}`,lT,[Xl,hp,zd]),rs(`${km}-${BS}`,NS,[Xl,hp]),rs(`${km}-${xm}`,nO,[Xl,hp]),rs(`${km}-${NT}`,IS,[Xl,hp]),rs(`${nx}-${ex}`,cT,[Xl,hp]),rs(`${nx}-${zd}`,hT,[Xl,hp,zd]),rs(`${nx}-${BS}`,Zw,[Xl,hp]),rs(`${nx}-${xm}`,dT,[Xl,hp]),rs(`${nx}-${NT}`,DS,[Xl,hp]),rs(rx,fT,[US,rx]),rs(MT,RS,US),rs(DT,pT,US),rs(WO,function t(){let e=[],n=[];function r(a){return a==null||a!=a?void 0:n[(Ov(e,a)-1)%n.length]}return r.domain=function(a){return arguments.length?(e=function(s){return Rct.call(s,$s)}(a),r):e.slice()},r.range=function(a){return arguments.length?(n=Fct.call(a),r):n.slice()},r.tickFormat=function(a,s){return eT(e[0],Ba(e),a??10,s)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r},[jS,US]),rs(jO,jv,jS),rs(Sq,RT,jS),rs(UO,function(){return _q(RT().paddingInner(1))},jS);let Oct=["clamp","base","constant","exponent"];function YO(t,e,n){return pO(Dq(e||"rgb",n),t)}function Mq(t,e,n){let r=n-e,a,s,h;return r&&Number.isFinite(r)?(a=(s=t.type).indexOf("-"),s=a<0?s:s.slice(a+1),h=rs(s)().domain([e,n]).range([0,1]),Oct.forEach(d=>t[d]?h[d](t[d]()):0),h):Ke(.5)}function Dq(t,e){let n=Z[function(r){return"interpolate"+r.toLowerCase().split("-").map(a=>a[0].toUpperCase()+a.slice(1)).join("")}(t)];return e!=null&&n&&n.gamma?n.gamma(e):n}function Rq(t){if(ni(t))return t;let e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function WS(t,e){for(let n in t)Oq(n,e(t[n]))}let Fq={};function Oq(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(Fq[t]=e,this):Fq[t]}WS({accent:IT,category10:MO,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:DO,observable10:RO,paired:FO,pastel1:OO,pastel2:LO,set1:$O,set2:zO,set3:PO,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"},Rq),WS({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},t=>YO(Rq(t)));let ax="symbol",qO=t=>ni(t)?t.map(e=>String(e)):String(t),Lq=(t,e)=>t[1]-e[1],Lct=(t,e)=>e[1]-t[1];function VS(t,e,n){let r;return Lr(e)&&(t.bins&&(e=Math.max(e,t.bins.length)),n!=null&&(e=Math.min(e,Math.floor(zs(t.domain())/n||1)+1))),Zr(e)&&(r=e.step,e=e.interval),wi(e)&&(e=t.type===I2?Sw(e):t.type==qv?F5(e):Dn("Only time and utc scales accept interval strings."),r&&(e=e.every(r))),e}function $q(t,e,n){let r=t.range(),a=r[0],s=Ba(r),h=Lq;if(a>s&&(r=s,s=a,a=r,h=Lct),a=Math.floor(a),s=Math.ceil(s),e=e.map(d=>[d,t(d)]).filter(d=>a<=d[1]&&d[1]<=s).sort(h).map(d=>d[0]),n>0&&e.length>1){let d=[e[0],Ba(e)];for(;e.length>n&&e.length>=3;)e=e.filter((g,b)=>!(b%2));e.length<3&&(e=d)}return e}function GS(t,e){return t.bins?$q(t,t.bins,e):t.ticks?t.ticks(e):t.domain()}function zq(t,e,n,r,a,s){let h=e.type,d=qO;if(h===I2||a===I2)d=t.timeFormat(r);else if(h===qv||a===qv)d=t.utcFormat(r);else if(Aq(h)){let g=t.formatFloat(r);if(s||e.bins)d=g;else{let b=Pq(e,n,!1);d=_=>b(_)?g(_):""}}else if(e.tickFormat){let g=e.domain();d=t.formatSpan(g[0],g[g.length-1],n,r)}else r&&(d=t.format(r));return d}function Pq(t,e,n){let r=GS(t,e),a=t.base(),s=Math.log(a),h=Math.max(1,a*e/r.length),d=g=>{let b=g/Math.pow(a,Math.round(Math.log(g)/s));return b*a<a-.5&&(b*=a),b<=h};return n?r.filter(d):d}let XO={[rx]:"quantiles",[MT]:"thresholds",[DT]:"domain"},Bq={[rx]:"quantiles",[MT]:"domain"};function jq(t,e){return t.bins?function(n){let r=n.slice(0,-1);return r.max=Ba(n),r}(t.bins):t.type===zd?Pq(t,e,!0):XO[t.type]?function(n){let r=[-1/0].concat(n);return r.max=1/0,r}(t[XO[t.type]]()):GS(t,e)}function Uq(t,e,n,r,a,s,h){let d=Bq[e.type]&&s!==I2&&s!==qv?function(g,b,_){let E=b[Bq[b.type]](),I=E.length,R,z=I>1?E[1]-E[0]:E[0];for(R=1;R<I;++R)z=Math.min(z,E[R]-E[R-1]);return g.formatSpan(0,z,30,_)}(t,e,a):zq(t,e,n,a,s,h);return r===ax&&(g=>XO[g.type]||g.bins)(e)?$ct(d):r==="discrete"?zct(d):Pct(d)}let $ct=t=>(e,n,r)=>{let a=Wq(r[n+1],Wq(r.max,1/0)),s=Vq(e,t),h=Vq(a,t);return s&&h?s+" \u2013 "+h:h?"< "+h:"\u2265 "+s},Wq=(t,e)=>t??e,zct=t=>(e,n)=>n?t(e):null,Pct=t=>e=>t(e),Vq=(t,e)=>Number.isFinite(t)?e(t):null;function Bct(t,e,n,r){let a=r||e.type;return wi(n)&&function(s){return w0(s,VO)}(a)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||a!==I2?n||a!==qv?Uq(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function Gq(t,e,n){n=n||{};let r=Math.max(3,n.maxlen||7),a=Bct(t,e,n.format,n.formatType);if(HO(e.type)){let s=jq(e).slice(1).map(a),h=s.length;return`${h} boundar${h===1?"y":"ies"}: ${s.join(", ")}`}if(ix(e.type)){let s=e.domain(),h=s.length;return`${h} value${h===1?"":"s"}: ${h>r?s.slice(0,r-2).map(a).join(", ")+", ending with "+s.slice(-1).map(a):s.map(a).join(", ")}`}{let s=e.domain();return`values from ${a(s[0])} to ${a(Ba(s))}`}}let jct=0,OT="p_";function KO(t){return t&&t.gradient}function Hq(t,e,n){let r=t.gradient,a=t.id,s=r==="radial"?OT:"";return a||(a=t.id="gradient_"+jct++,r==="radial"?(t.x1=Sm(t.x1,.5),t.y1=Sm(t.y1,.5),t.r1=Sm(t.r1,0),t.x2=Sm(t.x2,.5),t.y2=Sm(t.y2,.5),t.r2=Sm(t.r2,.5),s=OT):(t.x1=Sm(t.x1,0),t.y1=Sm(t.y1,0),t.x2=Sm(t.x2,1),t.y2=Sm(t.y2,0))),e[a]=t,"url("+(n||"")+"#"+s+a+")"}function Sm(t,e){return t??e}let Yq={basis:{curve:XH},"basis-closed":{curve:ZH},"basis-open":{curve:JH},bundle:{curve:eY,tension:"beta",value:.85},cardinal:{curve:nY,tension:"tension",value:0},"cardinal-open":{curve:lS,tension:"tension",value:0},"cardinal-closed":{curve:EF,tension:"tension",value:0},"catmull-rom":{curve:hS,tension:"alpha",value:.5},"catmull-rom-closed":{curve:aY,tension:"alpha",value:.5},"catmull-rom-open":{curve:sY,tension:"alpha",value:.5},linear:{curve:BE},"linear-closed":{curve:cY},monotone:{horizontal:yY,vertical:gY},natural:{curve:wY},step:{curve:IF},"step-after":{curve:WE},"step-before":{curve:UE}};function qq(t,e,n){var r=In(Yq,t)&&Yq[t],a=null;return r&&(a=r.curve||r[e||"vertical"],r.tension&&n!=null&&(a=a[r.tension](n))),a}let Uct={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},Wct=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,Vct=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,Gct=/^((\s+,?\s*)|(,\s*))/,Hct=/^[01]/;function ZO(t){let e=[];return(t.match(Wct)||[]).forEach(n=>{let r=n[0],a=r.toLowerCase(),s=Uct[a],h=function(g,b,_){let E=[];for(let I=0;b&&I<_.length;)for(let R=0;R<b;++R){let z=g!=="a"||R!==3&&R!==4?Vct:Hct,P=_.slice(I).match(z);if(P===null)throw Error("Invalid SVG path, incorrect parameter type");I+=P[0].length,E.push(+P[0]);let rt=_.slice(I).match(Gct);rt!==null&&(I+=rt[0].length)}return E}(a,s,n.slice(1).trim()),d=h.length;if(d<s||d&&d%s!=0)throw Error("Invalid SVG path, incorrect parameter count");if(e.push([r,...h.slice(0,s)]),d!==s){a==="m"&&(r=r==="M"?"L":"l");for(let g=s;g<d;g+=s)e.push([r,...h.slice(g,g+s)])}}),e}let Bg=Math.PI/180,Xv=Math.PI/2,_m=2*Math.PI,ox=Math.sqrt(3)/2;var QO={},JO={},Xq=[].join;function Yct(t){let e=Xq.call(t);if(JO[e])return JO[e];var n=t[0],r=t[1],a=t[2],s=t[3],h=t[4],d=t[5],g=t[6],b=t[7];let _=b*h,E=-g*d,I=g*h,R=b*d,z=Math.cos(a),P=Math.sin(a),rt=Math.cos(s),ot=Math.sin(s),at=.5*(s-a),dt=Math.sin(.5*at),ct=8/3*dt*dt/Math.sin(at),Ct=n+z-ct*P,Et=r+P+ct*z,Rt=n+rt,Ot=r+ot,Wt=Rt+ct*ot,jt=Ot-ct*rt;return JO[e]=[_*Ct+E*Et,I*Ct+R*Et,_*Wt+E*jt,I*Wt+R*jt,_*Rt+E*Ot,I*Rt+R*Ot]}let dp=["l",0,0,0,0,0,0,0];function qct(t,e,n){let r=dp[0]=t[0];if(r==="a"||r==="A")dp[1]=e*t[1],dp[2]=n*t[2],dp[3]=t[3],dp[4]=t[4],dp[5]=t[5],dp[6]=e*t[6],dp[7]=n*t[7];else if(r==="h"||r==="H")dp[1]=e*t[1];else if(r==="v"||r==="V")dp[1]=n*t[1];else for(var a=1,s=t.length;a<s;++a)dp[a]=(a%2==1?e:n)*t[a];return dp}function LT(t,e,n,r,a,s){var h,d,g,b,_,E=null,I=0,R=0,z=0,P=0,rt=0,ot=0;n==null&&(n=0),r==null&&(r=0),a==null&&(a=1),s==null&&(s=a),t.beginPath&&t.beginPath();for(var at=0,dt=e.length;at<dt;++at){switch(h=e[at],a===1&&s===1||(h=qct(h,a,s)),h[0]){case"l":I+=h[1],R+=h[2],t.lineTo(I+n,R+r);break;case"L":I=h[1],R=h[2],t.lineTo(I+n,R+r);break;case"h":I+=h[1],t.lineTo(I+n,R+r);break;case"H":I=h[1],t.lineTo(I+n,R+r);break;case"v":R+=h[1],t.lineTo(I+n,R+r);break;case"V":R=h[1],t.lineTo(I+n,R+r);break;case"m":rt=I+=h[1],ot=R+=h[2],t.moveTo(I+n,R+r);break;case"M":rt=I=h[1],ot=R=h[2],t.moveTo(I+n,R+r);break;case"c":d=I+h[5],g=R+h[6],z=I+h[3],P=R+h[4],t.bezierCurveTo(I+h[1]+n,R+h[2]+r,z+n,P+r,d+n,g+r),I=d,R=g;break;case"C":I=h[5],R=h[6],z=h[3],P=h[4],t.bezierCurveTo(h[1]+n,h[2]+r,z+n,P+r,I+n,R+r);break;case"s":d=I+h[3],g=R+h[4],z=2*I-z,P=2*R-P,t.bezierCurveTo(z+n,P+r,I+h[1]+n,R+h[2]+r,d+n,g+r),z=I+h[1],P=R+h[2],I=d,R=g;break;case"S":d=h[3],g=h[4],z=2*I-z,P=2*R-P,t.bezierCurveTo(z+n,P+r,h[1]+n,h[2]+r,d+n,g+r),I=d,R=g,z=h[1],P=h[2];break;case"q":d=I+h[3],g=R+h[4],z=I+h[1],P=R+h[2],t.quadraticCurveTo(z+n,P+r,d+n,g+r),I=d,R=g;break;case"Q":d=h[3],g=h[4],t.quadraticCurveTo(h[1]+n,h[2]+r,d+n,g+r),I=d,R=g,z=h[1],P=h[2];break;case"t":d=I+h[1],g=R+h[2],E[0].match(/[QqTt]/)===null?(z=I,P=R):E[0]==="t"?(z=2*I-b,P=2*R-_):E[0]==="q"&&(z=2*I-z,P=2*R-P),b=z,_=P,t.quadraticCurveTo(z+n,P+r,d+n,g+r),R=g,z=(I=d)+h[1],P=R+h[2];break;case"T":d=h[1],g=h[2],z=2*I-z,P=2*R-P,t.quadraticCurveTo(z+n,P+r,d+n,g+r),I=d,R=g;break;case"a":Kq(t,I+n,R+r,[h[1],h[2],h[3],h[4],h[5],h[6]+I+n,h[7]+R+r]),I+=h[6],R+=h[7];break;case"A":Kq(t,I+n,R+r,[h[1],h[2],h[3],h[4],h[5],h[6]+n,h[7]+r]),I=h[6],R=h[7];break;case"z":case"Z":I=rt,R=ot,t.closePath()}E=h}}function Kq(t,e,n,r){let a=function(s,h,d,g,b,_,E,I,R){let z=Xq.call(arguments);if(QO[z])return QO[z];let P=E*Bg,rt=Math.sin(P),ot=Math.cos(P),at=ot*(I-s)*.5+rt*(R-h)*.5,dt=ot*(R-h)*.5-rt*(I-s)*.5,ct=at*at/((d=Math.abs(d))*d)+dt*dt/((g=Math.abs(g))*g);ct>1&&(ct=Math.sqrt(ct),d*=ct,g*=ct);let Ct=ot/d,Et=rt/d,Rt=-rt/g,Ot=ot/g,Wt=Ct*I+Et*R,jt=Rt*I+Ot*R,Ht=Ct*s+Et*h,Vt=Rt*s+Ot*h,fe=1/((Ht-Wt)*(Ht-Wt)+(Vt-jt)*(Vt-jt))-.25;fe<0&&(fe=0);let se=Math.sqrt(fe);_==b&&(se=-se);let he=.5*(Wt+Ht)-se*(Vt-jt),_e=.5*(jt+Vt)+se*(Ht-Wt),Ve=Math.atan2(jt-_e,Wt-he),gn=Math.atan2(Vt-_e,Ht-he)-Ve;gn<0&&_===1?gn+=_m:gn>0&&_===0&&(gn-=_m);let $n=Math.ceil(Math.abs(gn/(Xv+.001))),Gn=[];for(let qe=0;qe<$n;++qe){let tr=Ve+qe*gn/$n,er=Ve+(qe+1)*gn/$n;Gn[qe]=[he,_e,tr,er,d,g,rt,ot]}return QO[z]=Gn}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let s=0;s<a.length;++s){let h=Yct(a[s]);t.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5])}}let Zq=.5773502691896257,tL={circle:{draw:function(t,e){let n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,_m)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){let n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,a=n/2.5,s=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-s),t.lineTo(a,-s),t.lineTo(0,-n),t.lineTo(-a,-s),t.lineTo(-r,-s),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=ox*n,a=r-n*Zq,s=n/4;t.moveTo(0,-r-a),t.lineTo(-s,r-a),t.lineTo(s,r-a),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=ox*n,a=r-n*Zq;t.moveTo(0,-r-a),t.lineTo(-n,r-a),t.lineTo(n,r-a),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=ox*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=ox*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=ox*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=ox*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){let n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function Xct(t){return In(tL,t)?tL[t]:function(e){if(!In(eL,e)){let n=ZO(e);eL[e]={draw:function(r,a){LT(r,n,0,0,Math.sqrt(a)/2)}}}return eL[e]}(t)}var eL={};let N2=.448084975506;function Kct(t){return t.x}function Zct(t){return t.y}function Qct(t){return t.width}function Jct(t){return t.height}function jg(t){return typeof t=="function"?t:()=>+t}function $T(t,e,n){return Math.max(e,Math.min(t,n))}function M2(t,e){return t??e}let HS=t=>t.x||0,YS=t=>t.y||0,qS=t=>t.defined!==!1,tht=Bw().startAngle(t=>t.startAngle||0).endAngle(t=>t.endAngle||0).padAngle(t=>t.padAngle||0).innerRadius(t=>t.innerRadius||0).outerRadius(t=>t.outerRadius||0).cornerRadius(t=>t.cornerRadius||0),Qq=gS().x(HS).y1(YS).y0(t=>(t.y||0)+(t.height||0)).defined(qS),eht=gS().y(YS).x1(HS).x0(t=>(t.x||0)+(t.width||0)).defined(qS),nht=FF().x(HS).y(YS).defined(qS),rht=function(){var t=Kct,e=Zct,n=Qct,r=Jct,a=jg(0),s=a,h=a,d=a,g=null;function b(_,E,I){var R,z=E??+t.call(this,_),P=I??+e.call(this,_),rt=+n.call(this,_),ot=+r.call(this,_),at=Math.min(rt,ot)/2,dt=$T(+a.call(this,_),0,at),ct=$T(+s.call(this,_),0,at),Ct=$T(+h.call(this,_),0,at),Et=$T(+d.call(this,_),0,at);if(g||(g=R=Fv()),dt<=0&&ct<=0&&Ct<=0&&Et<=0)g.rect(z,P,rt,ot);else{var Rt=z+rt,Ot=P+ot;g.moveTo(z+dt,P),g.lineTo(Rt-ct,P),g.bezierCurveTo(Rt-N2*ct,P,Rt,P+N2*ct,Rt,P+ct),g.lineTo(Rt,Ot-Et),g.bezierCurveTo(Rt,Ot-N2*Et,Rt-N2*Et,Ot,Rt-Et,Ot),g.lineTo(z+Ct,Ot),g.bezierCurveTo(z+N2*Ct,Ot,z,Ot-N2*Ct,z,Ot-Ct),g.lineTo(z,P+dt),g.bezierCurveTo(z,P+N2*dt,z+N2*dt,P,z+dt,P),g.closePath()}if(R)return g=null,R+""||null}return b.x=function(_){return arguments.length?(t=jg(_),b):t},b.y=function(_){return arguments.length?(e=jg(_),b):e},b.width=function(_){return arguments.length?(n=jg(_),b):n},b.height=function(_){return arguments.length?(r=jg(_),b):r},b.cornerRadius=function(_,E,I,R){return arguments.length?(a=jg(_),s=E!=null?jg(E):a,d=I!=null?jg(I):a,h=R!=null?jg(R):s,b):a},b.context=function(_){return arguments.length?(g=_??null,b):g},b}().x(HS).y(YS).width(t=>t.width||0).height(t=>t.height||0).cornerRadius(t=>M2(t.cornerRadiusTopLeft,t.cornerRadius)||0,t=>M2(t.cornerRadiusTopRight,t.cornerRadius)||0,t=>M2(t.cornerRadiusBottomRight,t.cornerRadius)||0,t=>M2(t.cornerRadiusBottomLeft,t.cornerRadius)||0),iht=kY().type(t=>Xct(t.shape||"circle")).size(t=>M2(t.size,64)),aht=function(){var t,e,n,r,a,s,h,d,g=null;function b(E,I,R){let z=R/2;if(a){var P=h-I,rt=E-s;if(P||rt){var ot=Math.hypot(P,rt),at=(P/=ot)*d,dt=(rt/=ot)*d,ct=Math.atan2(rt,P);g.moveTo(s-at,h-dt),g.lineTo(E-P*z,I-rt*z),g.arc(E,I,z,ct-Math.PI,ct),g.lineTo(s+at,h+dt),g.arc(s,h,d,ct,ct+Math.PI)}else g.arc(E,I,z,0,_m);g.closePath()}else a=1;s=E,h=I,d=z}function _(E){var I,R,z,P=E.length,rt=!1;for(g==null&&(g=z=Fv()),I=0;I<=P;++I)!(I<P&&r(R=E[I],I,E))===rt&&(rt=!rt)&&(a=0),rt&&b(+t(R,I,E),+e(R,I,E),+n(R,I,E));if(z)return g=null,z+""||null}return _.x=function(E){return arguments.length?(t=E,_):t},_.y=function(E){return arguments.length?(e=E,_):e},_.size=function(E){return arguments.length?(n=E,_):n},_.defined=function(E){return arguments.length?(r=E,_):r},_.context=function(E){return arguments.length?(g=E??null,_):g},_}().x(HS).y(YS).defined(qS).size(t=>t.size||1);function nL(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function sx(t,e,n,r){return rht.context(t)(e,n,r)}var oht=1;function rL(t,e,n){var r=e.clip,a=t._defs,s=e.clip_id||(e.clip_id="clip"+oht++),h=a.clipping[s]||(a.clipping[s]={id:s});return ut(r)?h.path=r(null):nL(n)?h.path=sx(null,n,0,0):(h.width=n.width||0,h.height=n.height||0),"url(#"+s+")"}function Kl(t){this.clear(),t&&this.union(t)}function iL(t){this.mark=t,this.bounds=this.bounds||new Kl}function aL(t){iL.call(this,t),this.items=this.items||[]}Kl.prototype={clone(){return new Kl(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){let r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:a,x2:s,y2:h}=this,d=Math.cos(t),g=Math.sin(t),b=e-e*d+n*g,_=n-e*g-n*d;return[d*r-g*a+b,g*r+d*a+_,d*r-g*h+b,g*r+d*h+_,d*s-g*a+b,g*s+d*a+_,d*s-g*h+b,g*s+d*h+_]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},ur(aL,iL);class sht{constructor(e){this._pending=0,this._loader=e||G5()}pending(){return this._pending}sanitizeURL(e){let n=this;return Jq(n),n._loader.sanitize(e,{context:"href"}).then(r=>(XS(n),r)).catch(()=>(XS(n),null))}loadImage(e){let n=this,r=LF();return Jq(n),n._loader.sanitize(e,{context:"image"}).then(a=>{let s=a.href;if(!s||!r)throw{url:s};let h=new r,d=In(a,"crossOrigin")?a.crossOrigin:"anonymous";return d!=null&&(h.crossOrigin=d),h.onload=()=>XS(n),h.onerror=()=>XS(n),h.src=s,h}).catch(a=>(XS(n),{complete:!1,width:0,height:0,src:a&&a.url||""}))}ready(){let e=this;return new Promise(n=>{(function r(a){e.pending()?setTimeout(()=>{r(!0)},10):n(a)})(!1)})}}function Jq(t){t._pending+=1}function XS(t){t._pending-=1}function D2(t,e,n){if(e.stroke&&e.opacity!==0&&e.strokeOpacity!==0){let r=e.strokeWidth!=null?+e.strokeWidth:1;t.expand(r+(n?function(a,s){return a.strokeJoin&&a.strokeJoin!=="miter"?0:s}(e,r):0))}return t}let uht=_m-1e-8,zT,PT,BT,Kv,oL,jT,sL,uL,R2=(t,e)=>zT.add(t,e),UT=(t,e)=>R2(PT=t,BT=e),tX=t=>R2(t,zT.y1),eX=t=>R2(zT.x1,t),Zv=(t,e)=>oL*t+sL*e,Qv=(t,e)=>jT*t+uL*e,lL=(t,e)=>R2(Zv(t,e),Qv(t,e)),WT=(t,e)=>UT(Zv(t,e),Qv(t,e));function VT(t,e){return zT=t,e?(Kv=e*Bg,oL=uL=Math.cos(Kv),jT=Math.sin(Kv),sL=-jT):(oL=uL=1,Kv=jT=sL=0),lht}let lht={beginPath(){},closePath(){},moveTo:WT,lineTo:WT,rect(t,e,n,r){Kv?(lL(t+n,e),lL(t+n,e+r),lL(t,e+r),WT(t,e)):(R2(t+n,e+r),UT(t,e))},quadraticCurveTo(t,e,n,r){let a=Zv(t,e),s=Qv(t,e),h=Zv(n,r),d=Qv(n,r);nX(PT,a,h,tX),nX(BT,s,d,eX),UT(h,d)},bezierCurveTo(t,e,n,r,a,s){let h=Zv(t,e),d=Qv(t,e),g=Zv(n,r),b=Qv(n,r),_=Zv(a,s),E=Qv(a,s);rX(PT,h,g,_,tX),rX(BT,d,b,E,eX),UT(_,E)},arc(t,e,n,r,a,s){if(r+=Kv,a+=Kv,PT=n*Math.cos(a)+t,BT=n*Math.sin(a)+e,Math.abs(a-r)>uht)R2(t-n,e-n),R2(t+n,e+n);else{let h=b=>R2(n*Math.cos(b)+t,n*Math.sin(b)+e),d,g;if(h(r),h(a),a!==r)if((r%=_m)<0&&(r+=_m),(a%=_m)<0&&(a+=_m),a<r&&(s=!s,d=r,r=a,a=d),s)for(a-=_m,d=r-r%Xv,g=0;g<4&&d>a;++g,d-=Xv)h(d);else for(d=r-r%Xv+Xv,g=0;g<4&&d<a;++g,d+=Xv)h(d)}}};function nX(t,e,n,r){let a=(t-e)/(t+n-2*e);0<a&&a<1&&r(t+(e-t)*a)}function rX(t,e,n,r,a){let s=r-t+3*e-3*n,h=t+n-2*e,d=t-e,g,b=0,_=0;Math.abs(s)>1e-14?(g=h*h+d*s,g>=0&&(g=Math.sqrt(g),b=(-h+g)/s,_=(-h-g)/s)):b=.5*d/h,0<b&&b<1&&a(iX(b,t,e,n,r)),0<_&&_<1&&a(iX(_,t,e,n,r))}function iX(t,e,n,r,a){let s=1-t,h=s*s,d=t*t;return h*s*e+3*h*t*n+3*s*d*r+d*t*a}var F2=(F2=lp(1,1))?F2.getContext("2d"):null;let cL=new Kl;function aX(t){return function(e,n){if(!F2)return!0;t(F2,e),cL.clear().union(e.bounds).intersect(n).round();let{x1:r,y1:a,x2:s,y2:h}=cL;for(let d=a;d<=h;++d)for(let g=r;g<=s;++g)if(F2.isPointInPath(g,d))return!0;return!1}}function oX(t,e){return e.contains(t.x||0,t.y||0)}function sX(t,e){let n=t.x||0,r=t.y||0,a=t.width||0,s=t.height||0;return e.intersects(cL.set(n,r,n+a,r+s))}function KS(t,e,n,r,a){let{x1:s,y1:h,x2:d,y2:g}=t,b=r-e,_=a-n,E,I,R,z,P=0,rt=1;for(z=0;z<4;++z){if(z===0&&(E=-b,I=-(s-e)),z===1&&(E=b,I=d-e),z===2&&(E=-_,I=-(h-n)),z===3&&(E=_,I=g-n),Math.abs(E)<1e-10&&I<0)return!1;if(R=I/E,E<0){if(R>rt)return!1;R>P&&(P=R)}else if(E>0){if(R<P)return!1;R<rt&&(rt=R)}}return!0}function ux(t,e){t.globalCompositeOperation=e.blend||"source-over"}function x0(t,e){return t??e}function uX(t,e){let n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function lX(t,e,n){return KO(n)?function(r,a,s){let h=s.width(),d=s.height(),g;if(a.gradient==="radial")g=r.createRadialGradient(s.x1+x0(a.x1,.5)*h,s.y1+x0(a.y1,.5)*d,Math.max(h,d)*x0(a.r1,0),s.x1+x0(a.x2,.5)*h,s.y1+x0(a.y2,.5)*d,Math.max(h,d)*x0(a.r2,.5));else{let b=x0(a.x1,0),_=x0(a.y1,0),E=x0(a.x2,1),I=x0(a.y2,0);if(b!==E&&_!==I&&h!==d){let R=lp(Math.ceil(h),Math.ceil(d)),z=R.getContext("2d");return z.scale(h,d),z.fillStyle=uX(z.createLinearGradient(b,_,E,I),a.stops),z.fillRect(0,0,h,d),r.createPattern(R,"no-repeat")}g=r.createLinearGradient(s.x1+b*h,s.y1+_*d,s.x1+E*h,s.y1+I*d)}return uX(g,a.stops)}(t,n,e.bounds):n}function GT(t,e,n){return(n*=e.fillOpacity==null?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=lX(t,e,e.fill),!0)}var cht=[];function lx(t,e,n){var r=(r=e.strokeWidth)!=null?r:1;return!(r<=0)&&(n*=e.strokeOpacity==null?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=lX(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||cht),t.lineDashOffset=e.strokeDashOffset||0),!0)}function hht(t,e){return t.zindex-e.zindex||t.index-e.index}function cX(t){if(!t.zdirty)return t.zitems;var e,n,r,a=t.items,s=[];for(n=0,r=a.length;n<r;++n)(e=a[n]).index=n,e.zindex&&s.push(e);return t.zdirty=!1,t.zitems=s.sort(hht)}function Cm(t,e){var n,r,a=t.items;if(!a||!a.length)return;let s=cX(t);if(s&&s.length){for(n=0,r=a.length;n<r;++n)a[n].zindex||e(a[n]);a=s}for(n=0,r=a.length;n<r;++n)e(a[n])}function hL(t,e){var n,r,a=t.items;if(!a||!a.length)return null;let s=cX(t);for(s&&s.length&&(a=s),r=a.length;--r>=0;)if(n=e(a[r]))return n;if(a===s){for(r=(a=t.items).length;--r>=0;)if(!a[r].zindex&&(n=e(a[r])))return n}return null}function dL(t){return function(e,n,r){Cm(n,a=>{r&&!r.intersects(a.bounds)||fL(t,e,a,a)})}}function dht(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||fL(t,e,n.items[0],n.items)}}function fL(t,e,n,r){var a=n.opacity==null?1:n.opacity;a!==0&&(t(e,r)||(ux(e,n),n.fill&&GT(e,n,a)&&e.fill(),n.stroke&&lx(e,n,a)&&e.stroke()))}function O2(t){return t=t||an,function(e,n,r,a,s,h){return r*=e.pixelRatio,a*=e.pixelRatio,hL(n,d=>{let g=d.bounds;if((!g||g.contains(s,h))&&g)return t(e,d,r,a,s,h)?d:void 0})}}function ZS(t,e){return function(n,r,a,s){var h,d,g=Array.isArray(r)?r[0]:r,b=e??g.fill,_=g.stroke&&n.isPointInStroke;return _&&(h=g.strokeWidth,d=g.strokeCap,n.lineWidth=h??1,n.lineCap=d??"butt"),!t(n,r)&&(b&&n.isPointInPath(a,s)||_&&n.isPointInStroke(a,s))}}function pL(t){return O2(ZS(t))}function Jv(t,e){return"translate("+t+","+e+")"}function mL(t){return"rotate("+t+")"}function hX(t){return Jv(t.x||0,t.y||0)}function gL(t,e,n){function r(a,s){var h=s.x||0,d=s.y||0,g=s.angle||0;a.translate(h,d),g&&a.rotate(g*=Bg),a.beginPath(),e(a,s),g&&a.rotate(-g),a.translate(-h,-d)}return{type:t,tag:"path",nested:!1,attr:function(a,s){a("transform",function(h){return Jv(h.x||0,h.y||0)+(h.angle?" "+mL(h.angle):"")}(s)),a("d",e(null,s))},bound:function(a,s){return e(VT(a,s.angle),s),D2(a,s).translate(s.x||0,s.y||0)},draw:dL(r),pick:pL(r),isect:n||aX(r)}}var tb=gL("arc",function(t,e){return tht.context(t)(e)});function cx(t,e,n){function r(s,h){s.beginPath(),e(s,h)}let a=ZS(r);return{type:t,tag:"path",nested:!0,attr:function(s,h){var d=h.mark.items;d.length&&s("d",e(null,d))},bound:function(s,h){var d=h.items;return d.length===0?s:(e(VT(s),d),D2(s,d[0]))},draw:dht(r),pick:function(s,h,d,g,b,_){var E=h.items,I=h.bounds;return!E||!E.length||I&&!I.contains(b,_)?null:(d*=s.pixelRatio,g*=s.pixelRatio,a(s,E,d,g)?E[0]:null)},isect:oX,tip:n}}var dX=cx("area",function(t,e){let n=e[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?eht:Qq).curve(qq(r,n.orient,n.tension)).context(t)(e)},function(t,e){for(var n,r,a=t[0].orient==="horizontal"?e[1]:e[0],s=t[0].orient==="horizontal"?"y":"x",h=t.length,d=1/0;--h>=0;)t[h].defined!==!1&&(r=Math.abs(t[h][s]-a))<d&&(d=r,n=t[h]);return n});function fp(t,e){t.beginPath(),nL(e)?sx(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function hx(t){let e=x0(t.strokeWidth,1);return t.strokeOffset!=null?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function QS(t,e){let n=hx(e);t("d",sx(null,e,n,n))}function Hc(t,e,n,r){let a=hx(e);t.beginPath(),sx(t,e,(n||0)+a,(r||0)+a)}let L2=ZS(Hc),fc=ZS(Hc,!1),Em=ZS(Hc,!0);var JS={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",hX(e))},bound:function(t,e){if(!e.clip&&e.items){let n=e.items,r=n.length;for(let a=0;a<r;++a)t.union(n[a].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),D2(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n,r){Cm(e,a=>{let s=a.x||0,h=a.y||0,d=a.strokeForeground,g=a.opacity==null?1:a.opacity;(a.stroke||a.fill)&&g&&(Hc(t,a,s,h),ux(t,a),a.fill&&GT(t,a,g)&&t.fill(),a.stroke&&!d&&lx(t,a,g)&&t.stroke()),t.save(),t.translate(s,h),a.clip&&fp(t,a),n&&n.translate(-s,-h),Cm(a,b=>{(b.marktype==="group"||r==null||r.includes(b.marktype))&&this.draw(t,b,n,r)}),n&&n.translate(s,h),t.restore(),d&&a.stroke&&g&&(Hc(t,a,s,h),ux(t,a),lx(t,a,g)&&t.stroke())})},pick:function(t,e,n,r,a,s){if(e.bounds&&!e.bounds.contains(a,s)||!e.items)return null;let h=n*t.pixelRatio,d=r*t.pixelRatio;return hL(e,g=>{let b,_,E,I=g.bounds;if(I&&!I.contains(a,s))return;_=g.x||0,E=g.y||0;let R=_+(g.width||0),z=E+(g.height||0),P=g.clip;if(P&&(a<_||a>R||s<E||s>z))return;if(t.save(),t.translate(_,E),_=a-_,E=s-E,P&&nL(g)&&!Em(t,g,h,d))return t.restore(),null;let rt=g.strokeForeground,ot=e.interactive!==!1;return ot&&rt&&g.stroke&&fc(t,g,h,d)?(t.restore(),g):(b=hL(g,at=>function(dt,ct,Ct){return(dt.interactive!==!1||dt.marktype==="group")&&dt.bounds&&dt.bounds.contains(ct,Ct)}(at,_,E)?this.pick(at,n,r,_,E):null),!b&&ot&&(g.fill||!rt&&g.stroke)&&L2(t,g,h,d)&&(b=g),t.restore(),b||null)})},isect:sX,content:function(t,e,n){t("clip-path",e.clip?rL(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),QS(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?QS(t,e):t("d","")}},$2={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function z2(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(r=>{t.image=r,t.image.url=t.url})),n}function t_(t,e){return t.width!=null?t.width:e&&e.width?t.aspect!==!1&&t.height?t.height*e.width/e.height:e.width:0}function ti(t,e){return t.height!=null?t.height:e&&e.height?t.aspect!==!1&&t.width?t.width*e.height/e.width:e.height:0}function HT(t,e){return t==="center"?e/2:t==="right"?e:0}function YT(t,e){return t==="middle"?e/2:t==="bottom"?e:0}var fX={type:"image",tag:"image",nested:!1,attr:function(t,e,n){let r=z2(e,n),a=t_(e,r),s=ti(e,r),h=(e.x||0)-HT(e.align,a),d=(e.y||0)-YT(e.baseline,s);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",$2["xmlns:xlink"],"xlink:href"),t("transform",Jv(h,d)),t("width",a),t("height",s),t("preserveAspectRatio",e.aspect===!1?"none":"xMidYMid")},bound:function(t,e){let n=e.image,r=t_(e,n),a=ti(e,n),s=(e.x||0)-HT(e.align,r),h=(e.y||0)-YT(e.baseline,a);return t.set(s,h,s+r,h+a)},draw:function(t,e,n){Cm(e,r=>{if(n&&!n.intersects(r.bounds))return;let a=z2(r,this),s=t_(r,a),h=ti(r,a);if(s===0||h===0)return;let d,g,b,_,E=(r.x||0)-HT(r.align,s),I=(r.y||0)-YT(r.baseline,h);r.aspect!==!1&&(g=a.width/a.height,b=r.width/r.height,g==g&&b==b&&g!==b&&(b<g?(_=s/g,I+=(h-_)/2,h=_):(_=h*g,E+=(s-_)/2,s=_))),(a.complete||a.toDataURL)&&(ux(t,r),t.globalAlpha=(d=r.opacity)!=null?d:1,t.imageSmoothingEnabled=r.smooth!==!1,t.drawImage(a,E,I,s,h))})},pick:O2(),isect:an,get:z2,xOffset:HT,yOffset:YT},pX=cx("line",function(t,e){let n=e[0],r=n.interpolate||"linear";return nht.curve(qq(r,n.orient,n.tension)).context(t)(e)},function(t,e){for(var n,r,a=Math.pow(t[0].strokeWidth||1,2),s=t.length;--s>=0;)if(t[s].defined!==!1&&(n=t[s].x-e[0])*n+(r=t[s].y-e[1])*r<a)return t[s];return null});function P2(t,e){var n=e.path;if(n==null)return!0;var r=e.x||0,a=e.y||0,s=e.scaleX||1,h=e.scaleY||1,d=(e.angle||0)*Bg,g=e.pathCache;g&&g.path===n||((e.pathCache=g=ZO(n)).path=n),d&&t.rotate&&t.translate?(t.translate(r,a),t.rotate(d),LT(t,g,0,0,s,h),t.rotate(-d),t.translate(-r,-a)):LT(t,g,r,a,s,h)}var mX={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;n===1&&r===1||t("vector-effect","non-scaling-stroke"),t("transform",function(a){return Jv(a.x||0,a.y||0)+(a.angle?" "+mL(a.angle):"")+(a.scaleX||a.scaleY?" "+function(s,h){return"scale("+s+","+h+")"}(a.scaleX||1,a.scaleY||1):"")}(e)),t("d",e.path)},bound:function(t,e){return P2(VT(t,e.angle),e)?t.set(0,0,0,0):D2(t,e,!0)},draw:dL(P2),pick:pL(P2),isect:aX(P2)};function yL(t,e){t.beginPath(),sx(t,e)}var fht={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",sx(null,e))},bound:function(t,e){var n,r;return D2(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:dL(yL),pick:pL(yL),isect:sX};function qT(t,e,n){var r,a,s,h;return!(!e.stroke||!lx(t,e,n))&&(r=e.x||0,a=e.y||0,s=e.x2!=null?e.x2:r,h=e.y2!=null?e.y2:a,t.beginPath(),t.moveTo(r,a),t.lineTo(s,h),!0)}var gX={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",hX(e)),t("x2",e.x2!=null?e.x2-(e.x||0):0),t("y2",e.y2!=null?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return D2(t.set(n=e.x||0,r=e.y||0,e.x2!=null?e.x2:n,e.y2!=null?e.y2:r),e)},draw:function(t,e,n){Cm(e,r=>{if(!n||n.intersects(r.bounds)){var a=r.opacity==null?1:r.opacity;a&&qT(t,r,a)&&(ux(t,r),t.stroke())}})},pick:O2(function(t,e,n,r){return!!t.isPointInStroke&&qT(t,e,1)&&t.isPointInStroke(n,r)}),isect:function(t,e){let n=t.x||0,r=t.y||0;return KS(e,n,r,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r)}},yX=gL("shape",function(t,e){return(e.mark.shape||e.shape).context(t)(e)}),XT=gL("symbol",function(t,e){return iht.context(t)(e)},oX);let vL=function(t){let e,n,r;t=+t||1e4;let a=()=>{e={},n={},r=0},s=(h,d)=>(++r>t&&(n=e,e={},r=1),e[h]=d);return a(),{clear:a,has:h=>In(e,h)||In(n,h),get:h=>In(e,h)?e[h]:In(n,h)?s(h,n[h]):void 0,set:(h,d)=>In(e,h)?e[h]=d:s(h,d)}}();var pp={height:Tm,measureWidth:KT,estimateWidth:e_,width:e_,canvas:vX};function vX(t){pp.width=t&&F2?KT:e_}function e_(t,e){return bL(Ug(t,e),Tm(t))}function bL(t,e){return~~(.8*t.length*e)}function KT(t,e){return Tm(t)<=0||!(e=Ug(t,e))?0:ZT(e,fx(t))}function ZT(t,e){let n=`(${e}) ${t}`,r=vL.get(n);return r===void 0&&(F2.font=e,r=F2.measureText(t).width,vL.set(n,r)),r}function Tm(t){return t.fontSize!=null?+t.fontSize||0:11}function eb(t){return t.lineHeight!=null?t.lineHeight:Tm(t)+2}function dx(t){return e=t.lineBreak&&t.text&&!ni(t.text)?t.text.split(t.lineBreak):t.text,ni(e)?e.length>1?e:e[0]:e;var e}function wL(t){let e=dx(t);return(ni(e)?e.length-1:0)*eb(t)}function Ug(t,e){let n=e==null?"":(e+"").trim();return t.limit>0&&n.length?function(r,a){var s=+r.limit,h=function(I){if(pp.width===KT){let R=fx(I);return z=>ZT(z,R)}if(pp.width===e_){let R=Tm(I);return z=>bL(z,R)}return R=>pp.width(I,R)}(r);if(h(a)<s)return a;var d,g=r.ellipsis||"\u2026",b=r.dir==="rtl",_=0,E=a.length;if(s-=h(g),b){for(;_<E;)d=_+E>>>1,h(a.slice(d))>s?_=d+1:E=d;return g+a.slice(_)}for(;_<E;)d=1+(_+E>>>1),h(a.slice(0,d))<s?_=d:E=d-1;return a.slice(0,_)+g}(t,n):n}function QT(t,e){var n=t.font;return n||"sans-serif"}function fx(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Tm(t)+"px "+QT(t)}function n_(t){var e=t.baseline,n=Tm(t);return Math.round(e==="top"?.79*n:e==="middle"?.3*n:e==="bottom"?-.21*n:e==="line-top"?.29*n+.5*eb(t):e==="line-bottom"?.29*n-.5*eb(t):0)}vX(!0);let r_={left:"start",center:"middle",right:"end"},px=new Kl;function mp(t){var e,n=t.x||0,r=t.y||0,a=t.radius||0;return a&&(e=(t.theta||0)-Xv,n+=a*Math.cos(e),r+=a*Math.sin(e)),px.x1=n,px.y1=r,px}function JT(t,e,n){var r,a=pp.height(e),s=e.align,h=mp(e),d=h.x1,g=h.y1,b=e.dx||0,_=(e.dy||0)+n_(e)-Math.round(.8*a),E=dx(e);if(ni(E)?(a+=eb(e)*(E.length-1),r=E.reduce((I,R)=>Math.max(I,pp.width(e,R)),0)):r=pp.width(e,E),s==="center"?b-=r/2:s==="right"&&(b-=r),t.set(b+=d,_+=g,b+r,_+a),e.angle&&!n)t.rotate(e.angle*Bg,d,g);else if(n===2)return t.rotatedPoints(e.angle*Bg,d,g);return t}var nb={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,a=(e.dy||0)+n_(e),s=mp(e),h=s.x1,d=s.y1,g=e.angle||0;t("text-anchor",r_[e.align]||"start"),g?(n=Jv(h,d)+" "+mL(g),(r||a)&&(n+=" "+Jv(r,a))):n=Jv(h+r,d+a),t("transform",n)},bound:JT,draw:function(t,e,n){Cm(e,r=>{var a,s,h,d,g,b,_,E=r.opacity==null?1:r.opacity;if(!(n&&!n.intersects(r.bounds)||E===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(t.font=fx(r),t.textAlign=r.align||"left",s=(a=mp(r)).x1,h=a.y1,r.angle&&(t.save(),t.translate(s,h),t.rotate(r.angle*Bg),s=h=0),s+=r.dx||0,h+=(r.dy||0)+n_(r),b=dx(r),ux(t,r),ni(b))for(g=eb(r),d=0;d<b.length;++d)_=Ug(r,b[d]),r.fill&&GT(t,r,E)&&t.fillText(_,s,h),r.stroke&&lx(t,r,E)&&t.strokeText(_,s,h),h+=g;else _=Ug(r,b),r.fill&&GT(t,r,E)&&t.fillText(_,s,h),r.stroke&&lx(t,r,E)&&t.strokeText(_,s,h);r.angle&&t.restore()}})},pick:O2(function(t,e,n,r,a,s){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var h=mp(e),d=h.x1,g=h.y1,b=JT(px,e,1),_=-e.angle*Bg,E=Math.cos(_),I=Math.sin(_),R=E*a-I*s+(d-E*d+I*g),z=I*a+E*s+(g-I*d-E*g);return b.contains(R,z)}),isect:function(t,e){let n=JT(px,t,2);return KS(e,n[0],n[1],n[2],n[3])||KS(e,n[0],n[1],n[4],n[5])||KS(e,n[4],n[5],n[6],n[7])||KS(e,n[2],n[3],n[6],n[7])}},rb=cx("trail",function(t,e){return aht.context(t)(e)},function(t,e){for(var n,r,a=t.length;--a>=0;)if(t[a].defined!==!1&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<(n=t[a].size||1)*n)return t[a];return null}),bh={arc:tb,area:dX,group:JS,image:fX,line:pX,path:mX,rect:fht,rule:gX,shape:yX,symbol:XT,text:nb,trail:rb};function xL(t,e,n){var r=bh[t.mark.marktype],a=e||r.bound;return r.nested&&(t=t.mark),a(t.bounds||(t.bounds=new Kl),t,n)}var i_={mark:null};let a_=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function tA(t){return o_(typeof t=="string"?JSON.parse(t):t)}function o_(t){var e,n,r,a=t.marktype,s=t.items;if(s)for(n=0,r=s.length;n<r;++n)e=a?"mark":"group",s[n][e]=t,s[n].zindex&&(s[n][e].zdirty=!0),(a||e)==="group"&&o_(s[n]);return a&&function(h,d,g){var b,_,E,I,R=bh[h.marktype],z=R.bound,P=h.items,rt=P&&P.length;if(R.nested)return rt?E=P[0]:(i_.mark=h,E=i_),I=xL(E,z,g),d&&d.union(I)||I;if(d=d||h.bounds&&h.bounds.clear()||new Kl,rt)for(b=0,_=P.length;b<_;++b)d.union(xL(P[b],z,g));h.bounds=d}(t),t}class bX{constructor(e){arguments.length?this.root=tA(e):(this.root=wX({marktype:"group",name:"root",role:"frame"}),this.root.items=[new aL(this.root)])}toJSON(e){return function(n,r){return JSON.stringify(n,a_,r)}(this.root,e||0)}mark(e,n,r){let a=wX(e,n=n||this.root.items[0]);return n.items[r]=a,a.zindex&&(a.group.zdirty=!0),a}}function wX(t,e){let n={bounds:new Kl,clip:!!t.clip,group:e,interactive:t.interactive!==!1,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return t.aria!=null&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function ib(t,e,n){return!t&&typeof document<"u"&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function kL(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,a=n.length;r<a;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function Zl(t,e,n,r){var a,s=t.childNodes[e];return s&&s.tagName.toLowerCase()===n.toLowerCase()||(a=s||null,s=ib(t.ownerDocument,n,r),t.insertBefore(s,a)),s}function zu(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function eA(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function nA(t,e){let n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}class SL{constructor(e,n){this._active=null,this._handlers={},this._loader=e||G5(),this._tooltip=n||_L}initialize(e,n,r){return this._el=e,this._obj=r||null,this.origin(n)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()}scene(e){return arguments.length?(this._scene=e,this):this._scene}on(){}off(){}_handlerIndex(e,n,r){for(let a=e?e.length:0;--a>=0;)if(e[a].type===n&&(!r||e[a].handler===r))return a;return-1}handlers(e){let n=this._handlers,r=[];if(e)r.push(...n[this.eventName(e)]);else for(let a in n)r.push(...n[a]);return r}eventName(e){let n=e.indexOf(".");return n<0?e:e.slice(0,n)}handleHref(e,n,r){this._loader.sanitize(r,{context:"href"}).then(a=>{let s=new MouseEvent(e.type,e),h=ib(null,"a");for(let d in a)h.setAttribute(d,a[d]);h.dispatchEvent(s)}).catch(()=>{})}handleTooltip(e,n,r){if(n&&n.tooltip!=null){n=function(s,h,d,g){var b,_,E=s&&s.mark;if(E&&(b=bh[E.marktype]).tip){for((_=nA(h,d))[0]-=g[0],_[1]-=g[1];s=s.mark.group;)_[0]-=s.x||0,_[1]-=s.y||0;s=b.tip(E.items,_)}return s}(n,e,this.canvas(),this._origin);let a=r&&n&&n.tooltip||null;this._tooltip.call(this._obj,this,e,n,a)}}getItemBoundingClientRect(e){let n=this.canvas();if(!n)return;let r=n.getBoundingClientRect(),a=this._origin,s=e.bounds,h=s.width(),d=s.height(),g=s.x1+a[0]+r.left,b=s.y1+a[1]+r.top;for(;e.mark&&(e=e.mark.group);)g+=e.x||0,b+=e.y||0;return{x:g,y:b,width:h,height:d,left:g,top:b,right:g+h,bottom:b+d}}}function _L(t,e,n,r){t.element().setAttribute("title",r||"")}class s_{constructor(e){this._el=null,this._bgcolor=null,this._loader=new sht(e)}initialize(e,n,r,a,s){return this._el=e,this.resize(n,r,a,s)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)}resize(e,n,r,a){return this._width=e,this._height=n,this._origin=r||[0,0],this._scale=a||1,this}dirty(){}render(e,n){let r=this;return r._call=function(){r._render(e,n)},r._call(),r._call=null,r}_render(){}renderAsync(e,n){let r=this.render(e,n);return this._ready?this._ready.then(()=>r):Promise.resolve(r)}_load(e,n){var r=this,a=r._loader[e](n);if(!r._ready){let s=r._call;r._ready=r._loader.ready().then(h=>{h&&s(),r._ready=null})}return a}sanitizeURL(e){return this._load("sanitizeURL",e)}loadImage(e){return this._load("loadImage",e)}}let ab="dragenter",Ri="dragleave",Yc="dragover",Wg="pointerdown",ob="pointermove",rA="pointerout",iA="pointerover",aA="mousedown",CL="mousemove",oA="mouseout",sb="mouseover",u_="click",xX="mousewheel",sA="touchstart",uA="touchmove",lA="touchend",kX=["keydown","keypress","keyup",ab,Ri,Yc,Wg,"pointerup",ob,rA,iA,aA,"mouseup",CL,oA,sb,u_,"dblclick","wheel",xX,sA,uA,lA],Vg=ob,Am=oA,is=u_;class mx extends SL{constructor(e,n){super(e,n),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=kX,this.pointermove=EL([ob,CL],[iA,sb],[rA,oA]),this.dragover=EL([Yc],[ab],[Ri]),this.pointerout=pc([rA,oA]),this.dragleave=pc([Ri])}initialize(e,n,r){return this._canvas=e&&kL(e,"canvas"),[u_,aA,Wg,ob,rA,Ri].forEach(a=>ub(this,a)),super.initialize(e,n,r)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(e){this.fire(xX,e)}pointerdown(e){this._down=this._active,this.fire(Wg,e)}mousedown(e){this._down=this._active,this.fire(aA,e)}click(e){this._down===this._active&&(this.fire(u_,e),this._down=null)}touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(sA,e,!0)}touchmove(e){this.fire(uA,e,!0)}touchend(e){this.fire(lA,e,!0),this._touch=null}fire(e,n,r){let a=r?this._touch:this._active,s=this._handlers[e];if(n.vegaType=e,e===is&&a&&a.href?this.handleHref(n,a,a.href):e!==Vg&&e!==Am||this.handleTooltip(n,a,e!==Am),s)for(let h=0,d=s.length;h<d;++h)s[h].handler.call(this._obj,n,a)}on(e,n){let r=this.eventName(e),a=this._handlers;return this._handlerIndex(a[r],e,n)<0&&(ub(this,e),(a[r]||(a[r]=[])).push({type:e,handler:n})),this}off(e,n){let r=this.eventName(e),a=this._handlers[r],s=this._handlerIndex(a,e,n);return s>=0&&a.splice(s,1),this}pickEvent(e){let n=nA(e,this._canvas),r=this._origin;return this.pick(this._scene,n[0],n[1],n[0]-r[0],n[1]-r[1])}pick(e,n,r,a,s){let h=this.context();return bh[e.marktype].pick.call(this,h,e,n,r,a,s)}}let gx=t=>t===sA||t===uA||t===lA?[sA,uA,lA]:[t];function ub(t,e){gx(e).forEach(n=>function(r,a){let s=r.canvas();s&&!r._events[a]&&(r._events[a]=1,s.addEventListener(a,r[a]?h=>r[a](h):h=>r.fire(a,h)))}(t,n))}function l_(t,e,n){e.forEach(r=>t.fire(r,n))}function EL(t,e,n){return function(r){let a=this._active,s=this.pickEvent(r);s===a||(a&&a.exit||l_(this,n,r),this._active=s,l_(this,e,r)),l_(this,t,r)}}function pc(t){return function(e){l_(this,t,e),this._active=null}}function pht(t,e,n,r,a,s){let h=typeof HTMLElement<"u"&&t instanceof HTMLElement&&t.parentNode!=null,d=t.getContext("2d"),g=h?typeof window<"u"&&window.devicePixelRatio||1:a;t.width=e*g,t.height=n*g;for(let b in s)d[b]=s[b];return h&&g!==1&&(t.style.width=e+"px",t.style.height=n+"px"),d.pixelRatio=g,d.setTransform(g,0,0,g,g*r[0],g*r[1]),t}class TL extends s_{constructor(e){super(e),this._options={},this._redraw=!1,this._dirty=new Kl,this._tempb=new Kl}initialize(e,n,r,a,s,h){return this._options=h||{},this._canvas=this._options.externalContext?null:lp(1,1),e&&this._canvas&&(zu(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(e,n,r,a,s)}resize(e,n,r,a){if(super.resize(e,n,r,a),this._canvas)pht(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{let s=this._options.externalContext;s||Dn("CanvasRenderer is missing a valid canvas or context"),s.scale(this._scale,this._scale),s.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(e){let n=this._tempb.clear().union(e.bounds),r=e.mark.group;for(;r;)n.translate(r.x||0,r.y||0),r=r.mark.group;this._dirty.union(n)}_render(e,n){let r=this.context(),a=this._origin,s=this._width,h=this._height,d=this._dirty,g=mht(a,s,h);r.save();let b=this._redraw||d.empty()?(this._redraw=!1,g.expand(1)):function(_,E,I){return E.expand(1).round(),_.pixelRatio%1&&E.scale(_.pixelRatio).round().scale(1/_.pixelRatio),E.translate(-I[0]%1,-I[1]%1),_.beginPath(),_.rect(E.x1,E.y1,E.width(),E.height()),_.clip(),E}(r,g.intersect(d),a);return this.clear(-a[0],-a[1],s,h),this.draw(r,e,b,n),r.restore(),d.clear(),this}draw(e,n,r,a){if(n.marktype!=="group"&&a!=null&&!a.includes(n.marktype))return;let s=bh[n.marktype];n.clip&&function(h,d){var g=d.clip;h.save(),ut(g)?(h.beginPath(),g(h),h.clip()):fp(h,d.group)}(e,n),s.draw.call(this,e,n,r,a),n.clip&&e.restore()}clear(e,n,r,a){let s=this._options,h=this.context();s.type==="pdf"||s.externalContext||h.clearRect(e,n,r,a),this._bgcolor!=null&&(h.fillStyle=this._bgcolor,h.fillRect(e,n,r,a))}}let mht=(t,e,n)=>new Kl().set(0,0,e,n).translate(-t[0],-t[1]),AL=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)},SX="aria-hidden",cA="aria-label",IL="role",hA="aria-roledescription",NL="graphics-object",dA="graphics-symbol",yx=(t,e,n)=>({[IL]:t,[hA]:e,[cA]:n||void 0}),ML=zc(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),DL={axis:{desc:"axis",caption:function(t){let e=t.datum,n=t.orient,r=e.title?mA(t):null,a=t.context,s=a.scales[e.scale].value,h=a.dataflow.locale(),d=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${ix(d)?"discrete":d} scale with ${Gq(h,s,t)}`}},legend:{desc:"legend",caption:function(t){let e=t.datum,n=e.title?mA(t):null,r=`${e.type||""} legend`.trim(),a=e.scales,s=Object.keys(a),h=t.context,d=h.scales[a[s[0]]].value,g=h.dataflow.locale();return function(b){return b.length?b[0].toUpperCase()+b.slice(1):b}(r)+(n?` titled '${n}'`:"")+` for ${function(b){return b=b.map(_=>_+(_==="fill"||_==="stroke"?" color":"")),b.length<2?b[0]:b.slice(0,-1).join(", ")+" and "+Ba(b)}(s)} with ${Gq(g,d,t)}`}},"title-text":{desc:"title",caption:t=>`Title text '${FL(t)}'`},"title-subtitle":{desc:"subtitle",caption:t=>`Subtitle text '${FL(t)}'`}},fA={ariaRole:IL,ariaRoleDescription:hA,description:cA};function RL(t,e){let n=e.aria===!1;if(t(SX,n||void 0),n||e.description==null)for(let r in fA)t(fA[r],void 0);else{let r=e.mark.marktype;t(cA,e.description),t(IL,e.ariaRole||(r==="group"?NL:dA)),t(hA,e.ariaRoleDescription||`${r} mark`)}}function pA(t){return t.aria===!1?{[SX]:!0}:ML[t.role]?null:DL[t.role]?function(e,n){try{let r=e.items[0],a=n.caption||(()=>"");return yx(n.role||dA,n.desc,r.description||a(r))}catch{return null}}(t,DL[t.role]):function(e){let n=e.marktype,r=n==="group"||n==="text"||e.items.some(a=>a.description!=null&&a.aria!==!1);return yx(r?NL:dA,`${n} mark container`,e.description)}(t)}function FL(t){return et(t.text).join(" ")}function mA(t){try{return et(Ba(t.items).items[0].text).join(" ")}catch{return null}}let OL=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function gA(){let t="",e="",n="",r=[],a=()=>e=n="",s=(d,g)=>{var b;return g!=null&&(e+=` ${d}="${b=g,OL(b).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")}"`),h},h={open(d){(E=>{e&&(t+=`${e}>${n}`,a()),r.push(E)})(d),e="<"+d;for(var g=arguments.length,b=new Array(g>1?g-1:0),_=1;_<g;_++)b[_-1]=arguments[_];for(let E of b)for(let I in E)s(I,E[I]);return h},close(){let d=r.pop();return t+=e?e+(n?`>${n}</${d}>`:"/>"):`</${d}>`,a(),h},attr:s,text:d=>(n+=OL(d),h),toString:()=>t};return h}let _X=t=>LL(gA(),t)+"";function LL(t,e){if(t.open(e.tagName),e.hasAttributes()){let n=e.attributes,r=n.length;for(let a=0;a<r;++a)t.attr(n[a].name,n[a].value)}if(e.hasChildNodes()){let n=e.childNodes;for(let r of n)r.nodeType===3?t.text(r.nodeValue):LL(t,r)}return t.close()}let c_={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},h_={blend:"mix-blend-mode"},$L={fill:"none","stroke-miterlimit":10},zL="http://www.w3.org/2000/xmlns/",Ml=$2.xmlns;class PL extends s_{constructor(e){super(e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(e,n,r,a,s){return this._defs={},this._clearDefs(),e&&(this._svg=Zl(e,0,"svg",Ml),this._svg.setAttributeNS(zL,"xmlns",Ml),this._svg.setAttributeNS(zL,"xmlns:xlink",$2["xmlns:xlink"]),this._svg.setAttribute("version",$2.version),this._svg.setAttribute("class","marks"),zu(e,1),this._root=Zl(this._svg,0,"g",Ml),B2(this._root,$L),zu(this._svg,1)),this.background(this._bgcolor),super.initialize(e,n,r,a,s)}background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),super.background(...arguments)}resize(e,n,r,a){return super.resize(e,n,r,a),this._svg&&(B2(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){let e=this._svg,n=this._bgcolor;if(!e)return null;let r;n&&(e.removeAttribute("style"),r=Zl(e,0,"rect",Ml),B2(r,{width:this._width,height:this._height,fill:n}));let a=_X(e);return n&&(e.removeChild(r),this._svg.style.setProperty("background-color",n)),a}_render(e,n){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e,void 0,n),zu(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))}isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;let e=this._dirty;if(!e.length||!this._dirtyID)return!0;let n=++this._dirtyID,r,a,s,h,d,g,b;for(d=0,g=e.length;d<g;++d)r=e[d],a=r.mark,a.marktype!==s&&(s=a.marktype,h=bh[s]),a.zdirty&&a.dirty!==n&&(this._dirtyAll=!1,BL(r,n),a.items.forEach(_=>{_.dirty=n})),a.zdirty||(r.exit?(h.nested&&a.items.length?(b=a.items[0],b._svg&&this._update(h,b._svg,b)):r._svg&&(b=r._svg.parentNode,b&&b.removeChild(r._svg)),r._svg=null):(r=h.nested?a.items[0]:r,r._update!==n&&(r._svg&&r._svg.ownerSVGElement?this._update(h,r._svg,r):(this._dirtyAll=!1,BL(r,n)),r._update=n)));return!this._dirtyAll}mark(e,n,r,a){if(!this.isDirty(n))return n._svg;let s=this._svg,h=n.marktype,d=bh[h],g=n.interactive===!1?"none":null,b=d.tag==="g",_=jL(n,e,r,"g",s);if(h!=="group"&&a!=null&&!a.includes(h))return zu(_,0),n._svg;_.setAttribute("class",eA(n));let E=pA(n);for(let P in E)ed(_,P,E[P]);b||ed(_,"pointer-events",g),ed(_,"clip-path",n.clip?rL(this,n,n.group):null);let I=null,R=0,z=P=>{let rt=this.isDirty(P),ot=jL(P,_,I,d.tag,s);rt&&(this._update(d,ot,P),b&&function(at,dt,ct,Ct){dt=dt.lastChild.previousSibling;let Et,Rt=0;Cm(ct,Ot=>{Et=at.mark(dt,Ot,Et,Ct),++Rt}),zu(dt,1+Rt)}(this,ot,P,a)),I=ot,++R};return d.nested?n.items.length&&z(n.items[0]):Cm(n,z),zu(_,R),_}_update(e,n,r){Gg=n,wh=n.__values__,RL(d_,r),e.attr(d_,r,this);let a=yht[e.type];a&&a.call(this,e,n,r),Gg&&this.style(Gg,r)}style(e,n){if(n!=null){for(let r in c_){let a=r==="font"?QT(n):n[r];if(a===wh[r])continue;let s=c_[r];a==null?e.removeAttribute(s):(KO(a)&&(a=Hq(a,this._defs.gradient,CX())),e.setAttribute(s,a+"")),wh[r]=a}for(let r in h_)vA(e,h_[r],n[r])}}defs(){let e=this._svg,n=this._defs,r=n.el,a=0;for(let s in n.gradient)r||(n.el=r=Zl(e,1,"defs",Ml)),a=yA(r,n.gradient[s],a);for(let s in n.clipping)r||(n.el=r=Zl(e,1,"defs",Ml)),a=ght(r,n.clipping[s],a);r&&(a===0?(e.removeChild(r),n.el=null):zu(r,a))}_clearDefs(){let e=this._defs;e.gradient={},e.clipping={}}}function BL(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function yA(t,e,n){let r,a,s;if(e.gradient==="radial"){let h=Zl(t,n++,"pattern",Ml);B2(h,{id:OT+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),h=Zl(h,0,"rect",Ml),B2(h,{width:1,height:1,fill:`url(${CX()}#${e.id})`}),B2(t=Zl(t,n++,"radialGradient",Ml),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else B2(t=Zl(t,n++,"linearGradient",Ml),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,a=e.stops.length;r<a;++r)s=Zl(t,r,"stop",Ml),s.setAttribute("offset",e.stops[r].offset),s.setAttribute("stop-color",e.stops[r].color);return zu(t,r),n}function ght(t,e,n){let r;return(t=Zl(t,n,"clipPath",Ml)).setAttribute("id",e.id),e.path?(r=Zl(t,0,"path",Ml),r.setAttribute("d",e.path)):(r=Zl(t,0,"rect",Ml),B2(r,{x:0,y:0,width:e.width,height:e.height})),zu(t,1),n+1}function jL(t,e,n,r,a){let s,h=t._svg;if(!h&&(s=e.ownerDocument,h=ib(s,r,Ml),t._svg=h,t.mark&&(h.__data__=t,h.__values__={fill:"default"},r==="g"))){let d=ib(s,"path",Ml);h.appendChild(d),d.__data__=t;let g=ib(s,"g",Ml);h.appendChild(g),g.__data__=t;let b=ib(s,"path",Ml);h.appendChild(b),b.__data__=t,b.__values__={fill:"default"}}return(h.ownerSVGElement!==a||function(d,g){return d.parentNode&&d.parentNode.childNodes.length>1&&d.previousSibling!=g}(h,n))&&e.insertBefore(h,n?n.nextSibling:e.firstChild),h}let Gg=null,wh=null,yht={group(t,e,n){let r=Gg=e.childNodes[2];wh=r.__values__,t.foreground(d_,n,this),wh=e.__values__,Gg=e.childNodes[1],t.content(d_,n,this);let a=Gg=e.childNodes[0];t.background(d_,n,this);let s=n.mark.interactive===!1?"none":null;if(s!==wh.events&&(ed(r,"pointer-events",s),ed(a,"pointer-events",s),wh.events=s),n.strokeForeground&&n.stroke){let h=n.fill;ed(r,"display",null),this.style(a,n),ed(a,"stroke",null),h&&(n.fill=null),wh=r.__values__,this.style(r,n),h&&(n.fill=h),Gg=null}else ed(r,"display","none")},image(t,e,n){n.smooth===!1?(vA(e,"image-rendering","optimizeSpeed"),vA(e,"image-rendering","pixelated")):vA(e,"image-rendering",null)},text(t,e,n){let r=dx(n),a,s,h,d;ni(r)?(s=r.map(g=>Ug(n,g)),a=s.join(`
`),a!==wh.text&&(zu(e,0),h=e.ownerDocument,d=eb(n),s.forEach((g,b)=>{let _=ib(h,"tspan",Ml);_.__data__=n,_.textContent=g,b&&(_.setAttribute("x",0),_.setAttribute("dy",d)),e.appendChild(_)}),wh.text=a)):(s=Ug(n,r),s!==wh.text&&(e.textContent=s,wh.text=s)),ed(e,"font-family",QT(n)),ed(e,"font-size",Tm(n)+"px"),ed(e,"font-style",n.fontStyle),ed(e,"font-variant",n.fontVariant),ed(e,"font-weight",n.fontWeight)}};function d_(t,e,n){e!==wh[t]&&(n?function(r,a,s,h){s!=null?r.setAttributeNS(h,a,s):r.removeAttributeNS(h,a)}(Gg,t,e,n):ed(Gg,t,e),wh[t]=e)}function vA(t,e,n){n!==wh[e]&&(n==null?t.style.removeProperty(e):t.style.setProperty(e,n+""),wh[e]=n)}function B2(t,e){for(let n in e)ed(t,n,e[n])}function ed(t,e,n){n!=null?t.setAttribute(e,n):t.removeAttribute(e)}function CX(){let t;return typeof window>"u"?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}let UL={svgMarkTypes:["text"]};class EX extends s_{constructor(e){super(e),this._svgRenderer=new PL(e),this._canvasRenderer=new TL(e)}initialize(e,n,r,a,s){this._root_el=Zl(e,0,"div");let h=Zl(this._root_el,0,"div"),d=Zl(this._root_el,1,"div");return this._root_el.style.position="relative",h.style.height="100%",d.style.position="absolute",d.style.top="0",d.style.left="0",d.style.height="100%",d.style.width="100%",this._svgEl=d,this._canvasEl=h,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,n,r,a,s),this._svgRenderer.initialize(this._svgEl,n,r,a,s),super.initialize(e,n,r,a,s)}dirty(e){return UL.svgMarkTypes.includes(e.mark.marktype)?this._svgRenderer.dirty(e):this._canvasRenderer.dirty(e),this}_render(e,n){let r=(n??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(a=>!UL.svgMarkTypes.includes(a));this._svgRenderer.render(e,UL.svgMarkTypes),this._canvasRenderer.render(e,r)}resize(e,n,r,a){return super.resize(e,n,r,a),this._svgRenderer.resize(e,n,r,a),this._canvasRenderer.resize(e,n,r,a),this}background(e){return this._canvasRenderer.background(e),this}}let TX="canvas",vht="hybrid",bht="none",lb={Canvas:TX,PNG:"png",SVG:"svg"},cb={};function WL(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(cb[t]=e,this):cb[t]}function AX(t,e,n,r){if(function(a,s,h){return a.bounds&&s.intersects(a.bounds)&&(a.marktype==="group"||a.interactive!==!1&&(!h||h(a)))}(t,e,n)){let a=t.items,s=t.marktype,h=a.length,d=0;if(s==="group")for(;d<h;++d)IX(a[d],e,n,r);else for(let g=bh[s].isect;d<h;++d){let b=a[d];NX(b,e,g)&&r.push(b)}}return r}function IX(t,e,n,r){n&&n(t.mark)&&NX(t,e,bh.group.isect)&&r.push(t);let a=t.items,s=a&&a.length;if(s){let h=t.x||0,d=t.y||0;e.translate(-h,-d);for(let g=0;g<s;++g)AX(a[g],e,n,r);e.translate(h,d)}return r}function NX(t,e,n){let r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}cb[TX]=cb.png={renderer:TL,headless:TL,handler:mx},cb.svg={renderer:PL,headless:class extends s_{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(t){let e=gA();e.open("svg",nn({},$2,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));let n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",$L,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this}mark(t,e){let n=bh[e.marktype],r=n.tag,a=[RL,n.attr];t.open("g",{class:eA(e),"clip-path":e.clip?rL(this,e,e.group):null},pA(e),{"pointer-events":r!=="g"&&e.interactive===!1?"none":null});let s=h=>{let d=this.href(h);if(d&&t.open("a",d),t.open(r,this.attr(e,h,a,r!=="g"?r:null)),r==="text"){let g=dx(h);if(ni(g)){let b={x:0,dy:eb(h)};for(let _=0;_<g.length;++_)t.open("tspan",_?b:null).text(Ug(h,g[_])).close()}else t.text(Ug(h,g))}else if(r==="g"){let g=h.strokeForeground,b=h.fill,_=h.stroke;g&&_&&(h.stroke=null),t.open("path",this.attr(e,h,n.background,"bgrect")).close(),t.open("g",this.attr(e,h,n.content)),Cm(h,E=>this.mark(t,E)),t.close(),g&&_?(b&&(h.fill=null),h.stroke=_,t.open("path",this.attr(e,h,n.foreground,"bgrect")).close(),b&&(h.fill=b)):t.open("path",this.attr(e,h,n.foreground,"bgfore")).close()}t.close(),d&&t.close()};return n.nested?e.items&&e.items.length&&s(e.items[0]):Cm(e,s),t.close()}href(t){let e=t.href,n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[e]=r})}return null}attr(t,e,n,r){let a={},s=(h,d,g,b)=>{a[b||h]=d};return Array.isArray(n)?n.forEach(h=>h(s,e,this)):n(s,e,this),r&&function(h,d,g,b,_){let E;if(d==null||(b==="bgrect"&&g.interactive===!1&&(h["pointer-events"]="none"),b==="bgfore"&&(g.interactive===!1&&(h["pointer-events"]="none"),h.display="none",d.fill!==null)))return h;b==="image"&&d.smooth===!1&&(E=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),b==="text"&&(h["font-family"]=QT(d),h["font-size"]=Tm(d)+"px",h["font-style"]=d.fontStyle,h["font-variant"]=d.fontVariant,h["font-weight"]=d.fontWeight);for(let I in c_){let R=d[I],z=c_[I];(R!=="transparent"||z!=="fill"&&z!=="stroke")&&R!=null&&(KO(R)&&(R=Hq(R,_.gradient,"")),h[z]=R)}for(let I in h_){let R=d[I];R!=null&&(E=E||[],E.push(`${h_[I]}: ${R};`))}E&&(h.style=E.join(" "))}(a,e,t,r,this._defs),a}defs(t){let e=this._defs.gradient,n=this._defs.clipping;if(Object.keys(e).length+Object.keys(n).length!==0){t.open("defs");for(let r in e){let a=e[r],s=a.stops;a.gradient==="radial"?(t.open("pattern",{id:OT+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),t.close(),t.open("radialGradient",{id:r,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):t.open("linearGradient",{id:r,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(let h=0;h<s.length;++h)t.open("stop",{offset:s[h].offset,"stop-color":s[h].color}).close();t.close()}for(let r in n){let a=n[r];t.open("clipPath",{id:r}),a.path?t.open("path",{d:a.path}).close():t.open("rect",{x:0,y:0,width:a.width,height:a.height}).close(),t.close()}t.close()}}},handler:class extends SL{constructor(t,e){super(t,e);let n=this;n._hrefHandler=AL(n,(r,a)=>{a&&a.href&&n.handleHref(r,a,a.href)}),n._tooltipHandler=AL(n,(r,a)=>{n.handleTooltip(r,a,r.type!==Am)})}initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(is,this._hrefHandler),r.removeEventListener(Vg,this._tooltipHandler),r.removeEventListener(Am,this._tooltipHandler)),this._svg=r=t&&kL(t,"svg"),r&&(r.addEventListener(is,this._hrefHandler),r.addEventListener(Vg,this._tooltipHandler),r.addEventListener(Am,this._tooltipHandler)),super.initialize(t,e,n)}canvas(){return this._svg}on(t,e){let n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){let a={type:t,handler:e,listener:AL(this,e)};(r[n]||(r[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this}off(t,e){let n=this.eventName(t),r=this._handlers[n],a=this._handlerIndex(r,t,e);return a>=0&&(this._svg&&this._svg.removeEventListener(n,r[a].listener),r.splice(a,1)),this}}},cb[vht]={renderer:EX,headless:EX,handler:class extends mx{constructor(t,e){super(t,e)}initialize(t,e,n){let r=Zl(Zl(t,0,"div"),0,"div");return super.initialize(r,e,n)}}},cb[bht]={};let VL=new Kl,vx="top",k0="left",S0="right",j2="bottom",GL="start",HL="middle",nd="end",bA="group",YL="axis",qL="title",wht="frame",MX="scope",XL="legend",DX="row-header",RX="row-footer",KL="row-title",FX="column-header",OX="column-footer",LX="column-title",xht="padding",$X="fit",zX="fit-x",PX="fit-y",ZL="none",wA="all",f_="each",QL="flush",Hg="column",Pu="row";function BX(t){ar.call(this,null,t)}function p_(t,e,n){return e(t.bounds.clear(),t,n)}ur(BX,ar,{transform(t,e){let n=e.dataflow,r=t.mark,a=r.marktype,s=bh[a],h=s.bound,d,g=r.bounds;if(s.nested)r.items.length&&n.dirty(r.items[0]),g=p_(r,h),r.items.forEach(b=>{b.bounds.clear().union(g)});else if(a===bA||t.modified())switch(e.visit(e.MOD,b=>n.dirty(b)),g.clear(),r.items.forEach(b=>g.union(p_(b,h))),r.role){case YL:case XL:case qL:e.reflow()}else d=e.changed(e.REM),e.visit(e.ADD,b=>{g.union(p_(b,h))}),e.visit(e.MOD,b=>{d=d||g.alignsWith(b.bounds),n.dirty(b),g.union(p_(b,h))}),d&&(g.clear(),r.items.forEach(b=>g.union(b.bounds)));return function(b){let _=b.clip;if(ut(_))_(VT(VL.clear()));else{if(!_)return;VL.set(0,0,b.group.width,b.group.height)}b.bounds.intersect(VL)}(r),e.modifies("bounds")}});let jX=":vega_identifier:";function xA(t){ar.call(this,0,t)}function JL(t){ar.call(this,null,t)}function t$(t){ar.call(this,null,t)}xA.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},ur(xA,ar,{transform(t,e){let n=(a=e.dataflow)._signals[jX]||(a._signals[jX]=a.add(0)),r=t.as;var a;let s=n.value;return e.visit(e.ADD,h=>h[r]=h[r]||++s),n.set(this.value=s),e}}),ur(JL,ar,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,function(a){let s=a.groups,h=a.parent;return s&&s.size===1?s.get(Object.keys(s.object)[0]):s&&h?s.lookup(h):null}(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);let r=n.marktype===bA?aL:iL;return e.visit(e.ADD,a=>r.call(a,n)),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e}});let _0={parity:t=>t.filter((e,n)=>n%2?e.opacity=0:1),greedy:(t,e)=>{let n;return t.filter((r,a)=>a&&Sf(n.bounds,r.bounds,e)?r.opacity=0:(n=r,1))}},Sf=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),e$=(t,e)=>{for(var n,r=1,a=t.length,s=t[0].bounds;r<a;s=n,++r)if(Sf(s,n=t[r].bounds,e))return!0},kht=t=>{let e=t.bounds;return e.width()>1&&e.height()>1},UX=t=>(t.forEach(e=>e.opacity=1),t),Yg=(t,e)=>t.reflow(e.modified()).modifies("opacity");function qg(t){ar.call(this,null,t)}ur(t$,ar,{transform(t,e){let n=_0[t.method]||_0.parity,r=t.separation||0,a,s,h=e.materialize(e.SOURCE).source;if(!h||!h.length)return;if(!t.method)return t.modified("method")&&(UX(h),e=Yg(e,t)),e;if(h=h.filter(kht),!h.length)return;if(t.sort&&(h=h.slice().sort(t.sort)),a=UX(h),e=Yg(e,t),a.length>=3&&e$(a,r)){do a=n(a,r);while(a.length>=3&&e$(a,r));a.length<3&&!Ba(h).opacity&&(a.length>1&&(Ba(a).opacity=0),Ba(h).opacity=1)}t.boundScale&&t.boundTolerance>=0&&(s=((g,b,_)=>{var E=g.range(),I=new Kl;return b===vx||b===j2?I.set(E[0],-1/0,E[1],1/0):I.set(-1/0,E[0],1/0,E[1]),I.expand(_||1),R=>I.encloses(R.bounds)})(t.boundScale,t.boundOrient,+t.boundTolerance),h.forEach(g=>{s(g)||(g.opacity=0)}));let d=a[0].mark.bounds.clear();return h.forEach(g=>{g.opacity&&d.union(g.bounds)}),e}}),ur(qg,ar,{transform(t,e){let n=e.dataflow;if(e.visit(e.ALL,r=>n.dirty(r)),e.fields&&e.fields.zindex){let r=e.source&&e.source[0];r&&(r.mark.zdirty=!0)}}});let xh=new Kl;function bx(t,e,n){return t[e]===n?0:(t[e]=n,1)}function n$(t){var e=t.items[0].orient;return e===k0||e===S0}function Sht(t,e,n,r){var a,s,h=e.items[0],d=h.datum,g=h.translate!=null?h.translate:.5,b=h.orient,_=function(Et){let Rt=+Et.grid;return[Et.ticks?Rt++:-1,Et.labels?Rt++:-1,Rt+ +Et.domain]}(d),E=h.range,I=h.offset,R=h.position,z=h.minExtent,P=h.maxExtent,rt=d.title&&h.items[_[2]].items[0],ot=h.titlePadding,at=h.bounds,dt=rt&&wL(rt),ct=0,Ct=0;switch(xh.clear().union(at),at.clear(),(a=_[0])>-1&&at.union(h.items[a].bounds),(a=_[1])>-1&&at.union(h.items[a].bounds),b){case vx:ct=R||0,Ct=-I,s=Math.max(z,Math.min(P,-at.y1)),at.add(0,-s).add(E,0),rt&&m_(t,rt,s,ot,dt,0,-1,at);break;case k0:ct=-I,Ct=R||0,s=Math.max(z,Math.min(P,-at.x1)),at.add(-s,0).add(0,E),rt&&m_(t,rt,s,ot,dt,1,-1,at);break;case S0:ct=n+I,Ct=R||0,s=Math.max(z,Math.min(P,at.x2)),at.add(0,0).add(s,E),rt&&m_(t,rt,s,ot,dt,1,1,at);break;case j2:ct=R||0,Ct=r+I,s=Math.max(z,Math.min(P,at.y2)),at.add(0,0).add(E,s),rt&&m_(t,rt,s,ot,0,0,1,at);break;default:ct=h.x,Ct=h.y}return D2(at.translate(ct,Ct),h),bx(h,"x",ct+g)|bx(h,"y",Ct+g)&&(h.bounds=xh,t.dirty(h),h.bounds=at,t.dirty(h)),h.mark.bounds.clear().union(at)}function m_(t,e,n,r,a,s,h,d){let g=e.bounds;if(e.auto){let b=h*(n+a+r),_=0,E=0;t.dirty(e),s?_=(e.x||0)-(e.x=b):E=(e.y||0)-(e.y=b),e.mark.bounds.clear().union(g.translate(-_,-E)),t.dirty(e)}d.union(g)}let r$=(t,e)=>Math.floor(Math.min(t,e)),i$=(t,e)=>Math.ceil(Math.max(t,e));function _ht(t){return new Kl().set(0,0,t.width||0,t.height||0)}function a$(t){let e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function hs(t,e,n){let r=Zr(t)?t[e]:t;return r??(n!==void 0?n:0)}function U2(t){return t<0?Math.ceil(-t):0}function hb(t,e,n){var r,a,s,h,d,g,b,_,E,I,R,z=!n.nodirty,P=n.bounds===QL?_ht:a$,rt=xh.set(0,0,0,0),ot=hs(n.align,Hg),at=hs(n.align,Pu),dt=hs(n.padding,Hg),ct=hs(n.padding,Pu),Ct=n.columns||e.length,Et=Ct<=0?1:Math.ceil(e.length/Ct),Rt=e.length,Ot=Array(Rt),Wt=Array(Ct),jt=0,Ht=Array(Rt),Vt=Array(Et),fe=0,se=Array(Rt),he=Array(Rt),_e=Array(Rt);for(a=0;a<Ct;++a)Wt[a]=0;for(a=0;a<Et;++a)Vt[a]=0;for(a=0;a<Rt;++a)g=e[a],d=_e[a]=P(g),g.x=g.x||0,se[a]=0,g.y=g.y||0,he[a]=0,s=a%Ct,h=~~(a/Ct),jt=Math.max(jt,b=Math.ceil(d.x2)),fe=Math.max(fe,_=Math.ceil(d.y2)),Wt[s]=Math.max(Wt[s],b),Vt[h]=Math.max(Vt[h],_),Ot[a]=dt+U2(d.x1),Ht[a]=ct+U2(d.y1),z&&t.dirty(e[a]);for(a=0;a<Rt;++a)a%Ct==0&&(Ot[a]=0),a<Ct&&(Ht[a]=0);if(ot===f_)for(s=1;s<Ct;++s){for(R=0,a=s;a<Rt;a+=Ct)R<Ot[a]&&(R=Ot[a]);for(a=s;a<Rt;a+=Ct)Ot[a]=R+Wt[s-1]}else if(ot===wA){for(R=0,a=0;a<Rt;++a)a%Ct&&R<Ot[a]&&(R=Ot[a]);for(a=0;a<Rt;++a)a%Ct&&(Ot[a]=R+jt)}else for(ot=!1,s=1;s<Ct;++s)for(a=s;a<Rt;a+=Ct)Ot[a]+=Wt[s-1];if(at===f_)for(h=1;h<Et;++h){for(R=0,r=(a=h*Ct)+Ct;a<r;++a)R<Ht[a]&&(R=Ht[a]);for(a=h*Ct;a<r;++a)Ht[a]=R+Vt[h-1]}else if(at===wA){for(R=0,a=Ct;a<Rt;++a)R<Ht[a]&&(R=Ht[a]);for(a=Ct;a<Rt;++a)Ht[a]=R+fe}else for(at=!1,h=1;h<Et;++h)for(r=(a=h*Ct)+Ct;a<r;++a)Ht[a]+=Vt[h-1];for(E=0,a=0;a<Rt;++a)E=Ot[a]+(a%Ct?E:0),se[a]+=E-e[a].x;for(s=0;s<Ct;++s)for(I=0,a=s;a<Rt;a+=Ct)I+=Ht[a],he[a]+=I-e[a].y;if(ot&&hs(n.center,Hg)&&Et>1)for(a=0;a<Rt;++a)(E=(d=ot===wA?jt:Wt[a%Ct])-_e[a].x2-e[a].x-se[a])>0&&(se[a]+=E/2);if(at&&hs(n.center,Pu)&&Ct!==1)for(a=0;a<Rt;++a)(I=(d=at===wA?fe:Vt[~~(a/Ct)])-_e[a].y2-e[a].y-he[a])>0&&(he[a]+=I/2);for(a=0;a<Rt;++a)rt.union(_e[a].translate(se[a],he[a]));switch(E=hs(n.anchor,"x"),I=hs(n.anchor,"y"),hs(n.anchor,Hg)){case nd:E-=rt.width();break;case HL:E-=rt.width()/2}switch(hs(n.anchor,Pu)){case nd:I-=rt.height();break;case HL:I-=rt.height()/2}for(E=Math.round(E),I=Math.round(I),rt.clear(),a=0;a<Rt;++a)e[a].mark.bounds.clear();for(a=0;a<Rt;++a)(g=e[a]).x+=se[a]+=E,g.y+=he[a]+=I,rt.union(g.mark.bounds.union(g.bounds.translate(se[a],he[a]))),z&&t.dirty(g);return rt}function Pd(t,e,n){var r,a,s,h,d,g,b,_=function(at){var dt,ct,Ct=at.items,Et=Ct.length,Rt=0;let Ot={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;Rt<Et;++Rt)if(ct=(dt=Ct[Rt]).items,dt.marktype===bA)switch(dt.role){case YL:case XL:case qL:break;case DX:Ot.rowheaders.push(...ct);break;case RX:Ot.rowfooters.push(...ct);break;case FX:Ot.colheaders.push(...ct);break;case OX:Ot.colfooters.push(...ct);break;case KL:Ot.rowtitle=ct[0];break;case LX:Ot.coltitle=ct[0];break;default:Ot.marks.push(...ct)}return Ot}(e),E=_.marks,I=n.bounds===QL?Cht:W2,R=n.offset,z=n.columns||E.length,P=z<=0?1:Math.ceil(E.length/z),rt=P*z;let ot=hb(t,E,n);ot.empty()&&ot.set(0,0,0,0),_.rowheaders&&(g=hs(n.headerBand,Pu,null),r=kA(t,_.rowheaders,E,z,P,-hs(R,"rowHeader"),r$,0,I,"x1",0,z,1,g)),_.colheaders&&(g=hs(n.headerBand,Hg,null),a=kA(t,_.colheaders,E,z,z,-hs(R,"columnHeader"),r$,1,I,"y1",0,1,z,g)),_.rowfooters&&(g=hs(n.footerBand,Pu,null),s=kA(t,_.rowfooters,E,z,P,hs(R,"rowFooter"),i$,0,I,"x2",z-1,z,1,g)),_.colfooters&&(g=hs(n.footerBand,Hg,null),h=kA(t,_.colfooters,E,z,z,hs(R,"columnFooter"),i$,1,I,"y2",rt-z,1,z,g)),_.rowtitle&&(d=hs(n.titleAnchor,Pu),b=hs(R,"rowTitle"),b=d===nd?s+b:r-b,g=hs(n.titleBand,Pu,.5),o$(t,_.rowtitle,b,0,ot,g)),_.coltitle&&(d=hs(n.titleAnchor,Hg),b=hs(R,"columnTitle"),b=d===nd?h+b:a-b,g=hs(n.titleBand,Hg,.5),o$(t,_.coltitle,b,1,ot,g))}function Cht(t,e){return e==="x1"?t.x||0:e==="y1"?t.y||0:e==="x2"?(t.x||0)+(t.width||0):e==="y2"?(t.y||0)+(t.height||0):void 0}function W2(t,e){return t.bounds[e]}function kA(t,e,n,r,a,s,h,d,g,b,_,E,I,R){var z,P,rt,ot,at,dt,ct,Ct,Et,Rt=n.length,Ot=0,Wt=0;if(!Rt)return Ot;for(z=_;z<Rt;z+=E)n[z]&&(Ot=h(Ot,g(n[z],b)));if(!e.length)return Ot;for(e.length>a&&(t.warn("Grid headers exceed limit: "+a),e=e.slice(0,a)),Ot+=s,P=0,ot=e.length;P<ot;++P)t.dirty(e[P]),e[P].mark.bounds.clear();for(z=_,P=0,ot=e.length;P<ot;++P,z+=E){for(at=(dt=e[P]).mark.bounds,rt=z;rt>=0&&(ct=n[rt])==null;rt-=I);d?(Ct=R==null?ct.x:Math.round(ct.bounds.x1+R*ct.bounds.width()),Et=Ot):(Ct=Ot,Et=R==null?ct.y:Math.round(ct.bounds.y1+R*ct.bounds.height())),at.union(dt.bounds.translate(Ct-(dt.x||0),Et-(dt.y||0))),dt.x=Ct,dt.y=Et,t.dirty(dt),Wt=h(Wt,at[b])}return Wt}function o$(t,e,n,r,a,s){if(e){t.dirty(e);var h=n,d=n;r?h=Math.round(a.x1+s*a.width()):d=Math.round(a.y1+s*a.height()),e.bounds.translate(h-(e.x||0),d-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=h,e.y=d,t.dirty(e)}}function WX(t,e,n,r,a,s,h){let d=function(I,R){let z=I[R]||{};return(P,rt)=>z[P]!=null?z[P]:I[P]!=null?I[P]:rt}(n,e),g=function(I,R){let z=-1/0;return I.forEach(P=>{P.offset!=null&&(z=Math.max(z,P.offset))}),z>-1/0?z:R}(t,d("offset",0)),b=d("anchor",GL),_=b===nd?1:b===HL?.5:0,E={align:f_,bounds:d("bounds",QL),columns:d("direction")==="vertical"?1:t.length,padding:d("margin",8),center:d("center"),nodirty:!0};switch(e){case k0:E.anchor={x:Math.floor(r.x1)-g,column:nd,y:_*(h||r.height()+2*r.y1),row:b};break;case S0:E.anchor={x:Math.ceil(r.x2)+g,y:_*(h||r.height()+2*r.y1),row:b};break;case vx:E.anchor={y:Math.floor(a.y1)-g,row:nd,x:_*(s||a.width()+2*a.x1),column:b};break;case j2:E.anchor={y:Math.ceil(a.y2)+g,x:_*(s||a.width()+2*a.x1),column:b};break;case"top-left":E.anchor={x:g,y:g};break;case"top-right":E.anchor={x:s-g,y:g,column:nd};break;case"bottom-left":E.anchor={x:g,y:h-g,row:nd};break;case"bottom-right":E.anchor={x:s-g,y:h-g,column:nd,row:nd}}return E}function Eht(t,e){var n,r,a=e.items[0],s=a.datum,h=a.orient,d=a.bounds,g=a.x,b=a.y;return a._bounds?a._bounds.clear().union(d):a._bounds=d.clone(),d.clear(),function(_,E,I){var R=E.padding,z=R-I.x,P=R-I.y;if(E.datum.title){var rt=E.items[1].items[0],ot=rt.anchor,at=E.titlePadding||0,dt=R-rt.x,ct=R-rt.y;switch(rt.orient){case k0:z+=Math.ceil(rt.bounds.width())+at;break;case S0:case j2:break;default:P+=rt.bounds.height()+at}switch((z||P)&&wx(_,I,z,P),rt.orient){case k0:ct+=db(E,I,rt,ot,1,1);break;case S0:dt+=db(E,I,rt,nd,0,0)+at,ct+=db(E,I,rt,ot,1,1);break;case j2:dt+=db(E,I,rt,ot,0,0),ct+=db(E,I,rt,nd,-1,0,1)+at;break;default:dt+=db(E,I,rt,ot,0,0)}(dt||ct)&&wx(_,rt,dt,ct),(dt=Math.round(rt.bounds.x1-R))<0&&(wx(_,I,-dt,0),wx(_,rt,-dt,0))}else(z||P)&&wx(_,I,z,P)}(t,a,a.items[0].items[0]),d=function(_,E){return _.items.forEach(I=>E.union(I.bounds)),E.x1=_.padding,E.y1=_.padding,E}(a,d),n=2*a.padding,r=2*a.padding,d.empty()||(n=Math.ceil(d.width()+n),r=Math.ceil(d.height()+r)),s.type==="symbol"&&function(_){let E=_.reduce((I,R)=>(I[R.column]=Math.max(R.bounds.x2-R.x,I[R.column]||0),I),{});_.forEach(I=>{I.width=E[I.column],I.height=I.bounds.y2-I.y})}(a.items[0].items[0].items[0].items),h!==ZL&&(a.x=g=0,a.y=b=0),a.width=n,a.height=r,D2(d.set(g,b,g+n,b+r),a),a.mark.bounds.clear().union(d),a}function db(t,e,n,r,a,s,h){let d=t.datum.type!=="symbol",g=n.datum.vgrad,b=(!d||!s&&g||h?e:e.items[0]).bounds[a?"y2":"x2"]-t.padding,_=g&&s?b:0,E=g&&s?0:b,I=a<=0?0:wL(n);return Math.round(r===GL?_:r===nd?E-I:.5*(b-I))}function wx(t,e,n,r){e.x+=n,e.y+=r,e.bounds.translate(n,r),e.mark.bounds.translate(n,r),t.dirty(e)}function VX(t){ar.call(this,null,t)}function fb(t,e){let n=0;for(let r of t)(r=+r)&&(n+=r);return n}function lo(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Bu(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Xg(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Kg(){}ur(VX,ar,{transform(t,e){let n=e.dataflow;return t.mark.items.forEach(r=>{t.layout&&Pd(n,r,t.layout),function(a,s,h){var d,g,b,_,E,I=s.items,R=Math.max(0,s.width||0),z=Math.max(0,s.height||0),P=new Kl().set(0,0,R,z),rt=P.clone(),ot=P.clone(),at=[];for(_=0,E=I.length;_<E;++_)switch((g=I[_]).role){case YL:(n$(g)?rt:ot).union(Sht(a,g,R,z));break;case qL:d=g;break;case XL:at.push(Eht(a,g));break;case wht:case MX:case DX:case RX:case KL:case FX:case OX:case LX:rt.union(g.bounds),ot.union(g.bounds);break;default:P.union(g.bounds)}if(at.length){let dt={};at.forEach(ct=>{(b=ct.orient||S0)!==ZL&&(dt[b]||(dt[b]=[])).push(ct)});for(let ct in dt){let Ct=dt[ct];hb(a,Ct,WX(Ct,ct,h.legends,rt,ot,R,z))}at.forEach(ct=>{let Ct=ct.bounds;if(Ct.equals(ct._bounds)||(ct.bounds=ct._bounds,a.dirty(ct),ct.bounds=Ct,a.dirty(ct)),!h.autosize||h.autosize.type!==$X&&h.autosize.type!==zX&&h.autosize.type!==PX)P.union(Ct);else switch(ct.orient){case k0:case S0:P.add(Ct.x1,0).add(Ct.x2,0);break;case vx:case j2:P.add(0,Ct.y1).add(0,Ct.y2)}})}P.union(rt).union(ot),d&&P.union(function(dt,ct,Ct,Et,Rt){var Ot,Wt=ct.items[0],jt=Wt.frame,Ht=Wt.orient,Vt=Wt.anchor,fe=Wt.offset,se=Wt.padding,he=Wt.items[0].items[0],_e=Wt.items[1]&&Wt.items[1].items[0],Ve=Ht===k0||Ht===S0?Et:Ct,gn=0,$n=0,Gn=0,qe=0,tr=0;if(jt!==bA?Ht===k0?(gn=Rt.y2,Ve=Rt.y1):Ht===S0?(gn=Rt.y1,Ve=Rt.y2):(gn=Rt.x1,Ve=Rt.x2):Ht===k0&&(gn=Et,Ve=0),Ot=Vt===GL?gn:Vt===nd?Ve:(gn+Ve)/2,_e&&_e.text){switch(Ht){case vx:case j2:tr=he.bounds.height()+se;break;case k0:qe=he.bounds.width()+se;break;case S0:qe=-he.bounds.width()-se}xh.clear().union(_e.bounds),xh.translate(qe-(_e.x||0),tr-(_e.y||0)),bx(_e,"x",qe)|bx(_e,"y",tr)&&(dt.dirty(_e),_e.bounds.clear().union(xh),_e.mark.bounds.clear().union(xh),dt.dirty(_e)),xh.clear().union(_e.bounds)}else xh.clear();switch(xh.union(he.bounds),Ht){case vx:$n=Ot,Gn=Rt.y1-xh.height()-fe;break;case k0:$n=Rt.x1-xh.width()-fe,Gn=Ot;break;case S0:$n=Rt.x2+xh.width()+fe,Gn=Ot;break;case j2:$n=Ot,Gn=Rt.y2+fe;break;default:$n=Wt.x,Gn=Wt.y}return bx(Wt,"x",$n)|bx(Wt,"y",Gn)&&(xh.translate($n,Gn),dt.dirty(Wt),Wt.bounds.clear().union(xh),ct.bounds.clear().union(xh),dt.dirty(Wt)),Wt.bounds}(a,d,R,z,P)),s.clip&&P.set(0,0,s.width||0,s.height||0),function(dt,ct,Ct,Et){let Rt=Et.autosize||{},Ot=Rt.type;if(dt._autosize<1||!Ot)return;let Wt=dt._width,jt=dt._height,Ht=Math.max(0,ct.width||0),Vt=Math.max(0,Math.ceil(-Ct.x1)),fe=Math.max(0,ct.height||0),se=Math.max(0,Math.ceil(-Ct.y1)),he=Math.max(0,Math.ceil(Ct.x2-Ht)),_e=Math.max(0,Math.ceil(Ct.y2-fe));if(Rt.contains===xht){let Ve=dt.padding();Wt-=Ve.left+Ve.right,jt-=Ve.top+Ve.bottom}Ot===ZL?(Vt=0,se=0,Ht=Wt,fe=jt):Ot===$X?(Ht=Math.max(0,Wt-Vt-he),fe=Math.max(0,jt-se-_e)):Ot===zX?(Ht=Math.max(0,Wt-Vt-he),jt=fe+se+_e):Ot===PX?(Wt=Ht+Vt+he,fe=Math.max(0,jt-se-_e)):Ot==="pad"&&(Wt=Ht+Vt+he,jt=fe+se+_e),dt._resizeView(Wt,jt,Ht,fe,[Vt,se],Rt.resize)}(a,s,P,h)}(n,r,t)}),function(r){return r&&r.mark.role!=="legend-entry"}(t.mark.group)?e.reflow():e}});var xx=.7,kx=1.4285714285714286,pb="\\s*([+-]?\\d+)\\s*",Sx="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",gp="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Tht=/^#([0-9a-f]{3,8})$/,ri=new RegExp("^rgb\\("+[pb,pb,pb]+"\\)$"),Aht=new RegExp("^rgb\\("+[gp,gp,gp]+"\\)$"),GX=new RegExp("^rgba\\("+[pb,pb,pb,Sx]+"\\)$"),Iht=new RegExp("^rgba\\("+[gp,gp,gp,Sx]+"\\)$"),mb=new RegExp("^hsl\\("+[Sx,gp,gp]+"\\)$"),Nht=new RegExp("^hsla\\("+[Sx,gp,gp,Sx]+"\\)$"),HX={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function g_(){return this.rgb().formatHex()}function y_(){return this.rgb().formatRgb()}function v_(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Tht.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?qc(e):n===3?new mc(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):n===8?SA(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):n===4?SA(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=ri.exec(t))?new mc(e[1],e[2],e[3],1):(e=Aht.exec(t))?new mc(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=GX.exec(t))?SA(e[1],e[2],e[3],e[4]):(e=Iht.exec(t))?SA(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=mb.exec(t))?XX(e[1],e[2]/100,e[3]/100,1):(e=Nht.exec(t))?XX(e[1],e[2]/100,e[3]/100,e[4]):HX.hasOwnProperty(t)?qc(HX[t]):t==="transparent"?new mc(NaN,NaN,NaN,0):null}function qc(t){return new mc(t>>16&255,t>>8&255,255&t,1)}function SA(t,e,n,r){return r<=0&&(t=e=n=NaN),new mc(t,e,n,r)}function _x(t){return t instanceof Kg||(t=v_(t)),t?new mc((t=t.rgb()).r,t.g,t.b,t.opacity):new mc}function V2(t,e,n,r){return arguments.length===1?_x(t):new mc(t,e,n,r??1)}function mc(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function YX(){return"#"+s$(this.r)+s$(this.g)+s$(this.b)}function qX(){var t=this.opacity;return((t=isNaN(t)?1:Math.max(0,Math.min(1,t)))===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function s$(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function XX(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Im(t,e,n,r)}function KX(t){if(t instanceof Im)return new Im(t.h,t.s,t.l,t.opacity);if(t instanceof Kg||(t=v_(t)),!t)return new Im;if(t instanceof Im)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),s=Math.max(e,n,r),h=NaN,d=s-a,g=(s+a)/2;return d?(h=e===s?(n-r)/d+6*(n<r):n===s?(r-e)/d+2:(e-n)/d+4,d/=g<.5?s+a:2-s-a,h*=60):d=g>0&&g<1?0:h,new Im(h,d,g,t.opacity)}function b_(t,e,n,r){return arguments.length===1?KX(t):new Im(t,e,n,r??1)}function Im(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function u$(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function ZX(t,e,n,r,a){var s=t*t,h=s*t;return((1-3*t+3*s-h)*e+(4-6*s+3*h)*n+(1+3*t+3*s-3*h)*r+h*a)/6}function QX(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),a=t[r],s=t[r+1],h=r>0?t[r-1]:2*a-s,d=r<e-1?t[r+2]:2*s-a;return ZX((n-r/e)*e,h,a,s,d)}}function JX(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),a=t[(r+e-1)%e],s=t[r%e],h=t[(r+1)%e],d=t[(r+2)%e];return ZX((n-r/e)*e,a,s,h,d)}}Bu(Kg,v_,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:g_,formatHex:g_,formatHsl:function(){return KX(this).formatHsl()},formatRgb:y_,toString:y_}),Bu(mc,V2,Xg(Kg,{brighter:function(t){return t=t==null?kx:Math.pow(kx,t),new mc(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?xx:Math.pow(xx,t),new mc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:YX,formatHex:YX,formatRgb:qX,toString:qX})),Bu(Im,b_,Xg(Kg,{brighter:function(t){return t=t==null?kx:Math.pow(kx,t),new Im(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?xx:Math.pow(xx,t),new Im(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,a=2*n-r;return new mc(u$(t>=240?t-240:t+120,a,r),u$(t,a,r),u$(t<120?t+240:t-120,a,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return((t=isNaN(t)?1:Math.max(0,Math.min(1,t)))===1?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(t===1?")":", "+t+")")}}));let _A=t=>()=>t;function tK(t,e){return function(n){return t+n*e}}function CA(t,e){var n=e-t;return n?tK(t,n>180||n<-180?n-360*Math.round(n/360):n):_A(isNaN(t)?e:t)}function Mht(t){return(t=+t)==1?Ql:function(e,n){return n-e?function(r,a,s){return r=Math.pow(r,s),a=Math.pow(a,s)-r,s=1/s,function(h){return Math.pow(r+h*a,s)}}(e,n,t):_A(isNaN(e)?n:e)}}function Ql(t,e){var n=e-t;return n?tK(t,n):_A(isNaN(t)?e:t)}let EA=function t(e){var n=Mht(e);function r(a,s){var h=n((a=V2(a)).r,(s=V2(s)).r),d=n(a.g,s.g),g=n(a.b,s.b),b=Ql(a.opacity,s.opacity);return function(_){return a.r=h(_),a.g=d(_),a.b=g(_),a.opacity=b(_),a+""}}return r.gamma=t,r}(1);function l$(t){return function(e){var n,r,a=e.length,s=new Array(a),h=new Array(a),d=new Array(a);for(n=0;n<a;++n)r=V2(e[n]),s[n]=r.r||0,h[n]=r.g||0,d[n]=r.b||0;return s=t(s),h=t(h),d=t(d),r.opacity=1,function(g){return r.r=s(g),r.g=h(g),r.b=d(g),r+""}}}var Dht=l$(QX),Rht=l$(JX);function c$(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,a=e.slice();return function(s){for(n=0;n<r;++n)a[n]=t[n]*(1-s)+e[n]*s;return a}}function eK(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Fht(t,e){return(eK(e)?c$:nK)(t,e)}function nK(t,e){var n,r=e?e.length:0,a=t?Math.min(r,t.length):0,s=new Array(a),h=new Array(r);for(n=0;n<a;++n)s[n]=yp(t[n],e[n]);for(;n<r;++n)h[n]=e[n];return function(d){for(n=0;n<a;++n)h[n]=s[n](d);return h}}function rK(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function C0(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function iK(t,e){var n,r={},a={};for(n in t!==null&&typeof t=="object"||(t={}),e!==null&&typeof e=="object"||(e={}),e)n in t?r[n]=yp(t[n],e[n]):a[n]=e[n];return function(s){for(n in r)a[n]=r[n](s);return a}}var h$=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,d$=new RegExp(h$.source,"g");function aK(t,e){var n,r,a,s=h$.lastIndex=d$.lastIndex=0,h=-1,d=[],g=[];for(t+="",e+="";(n=h$.exec(t))&&(r=d$.exec(e));)(a=r.index)>s&&(a=e.slice(s,a),d[h]?d[h]+=a:d[++h]=a),(n=n[0])===(r=r[0])?d[h]?d[h]+=r:d[++h]=r:(d[++h]=null,g.push({i:h,x:C0(n,r)})),s=d$.lastIndex;return s<e.length&&(a=e.slice(s),d[h]?d[h]+=a:d[++h]=a),d.length<2?g[0]?function(b){return function(_){return b(_)+""}}(g[0].x):function(b){return function(){return b}}(e):(e=g.length,function(b){for(var _,E=0;E<e;++E)d[(_=g[E]).i]=_.x(b);return d.join("")})}function yp(t,e){var n,r=typeof e;return e==null||r==="boolean"?_A(e):(r==="number"?C0:r==="string"?(n=v_(e))?(e=n,EA):aK:e instanceof v_?EA:e instanceof Date?rK:eK(e)?c$:Array.isArray(e)?nK:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?iK:C0)(t,e)}function TA(t){ar.call(this,null,t)}function oK(t){ar.call(this,null,t)}function Oht(){return Jo({})}function sK(t){ar.call(this,null,t)}function uK(t){ar.call(this,[],t)}ur(TA,ar,{transform(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),r=e.fork(e.NO_SOURCE|e.NO_FIELDS),a=this.value,s=t.scale,h=VS(s,t.count==null?t.values?t.values.length:10:t.count,t.minstep),d=t.format||zq(n,s,h,t.formatSpecifier,t.formatType,!!t.values),g=t.values?$q(s,t.values,h):GS(s,h);return a&&(r.rem=a),a=g.map((b,_)=>Jo({index:_/(g.length-1||1),value:b,label:d(b)})),t.extra&&a.length&&a.push(Jo({index:-1,extra:{value:a[0].value},label:""})),r.source=a,r.add=a,this.value=a,r}}),ur(oK,ar,{transform(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),a=t.item||Oht,s=t.key||qi,h=this.value;return ni(r.encode)&&(r.encode=null),h&&(t.modified("key")||e.modified(s))&&Dn("DataJoin does not support modified key function or fields."),h||(e=e.addAll(),this.value=h=function(d){let g=oi().test(b=>b.exit);return g.lookup=b=>g.get(d(b)),g}(s)),e.visit(e.ADD,d=>{let g=s(d),b=h.get(g);b?b.exit?(h.empty--,r.add.push(b)):r.mod.push(b):(b=a(d),h.set(g,b),r.add.push(b)),b.datum=d,b.exit=!1}),e.visit(e.MOD,d=>{let g=s(d),b=h.get(g);b&&(b.datum=d,r.mod.push(b))}),e.visit(e.REM,d=>{let g=s(d),b=h.get(g);d!==b.datum||b.exit||(r.rem.push(b),b.exit=!0,++h.empty)}),e.changed(e.ADD_MOD)&&r.modifies("datum"),(e.clean()||t.clean&&h.empty>n.cleanThreshold)&&n.runAfter(h.clean),r}}),ur(sK,ar,{transform(t,e){var n=e.fork(e.ADD_REM),r=t.mod||!1,a=t.encoders,s=e.encode;if(ni(s)){if(!n.changed()&&!s.every(E=>a[E]))return e.StopPropagation;s=s[0],n.encode=null}var h=s==="enter",d=a.update||Ms,g=a.enter||Ms,b=a.exit||Ms,_=(s&&!h?a[s]:d)||Ms;if(e.changed(e.ADD)&&(e.visit(e.ADD,E=>{g(E,t),d(E,t)}),n.modifies(g.output),n.modifies(d.output),_!==Ms&&_!==d&&(e.visit(e.ADD,E=>{_(E,t)}),n.modifies(_.output))),e.changed(e.REM)&&b!==Ms&&(e.visit(e.REM,E=>{b(E,t)}),n.modifies(b.output)),h||_!==Ms){let E=e.MOD|(t.modified()?e.REFLOW:0);h?(e.visit(E,I=>{let R=g(I,t)||r;(_(I,t)||R)&&n.mod.push(I)}),n.mod.length&&n.modifies(g.output)):e.visit(E,I=>{(_(I,t)||r)&&n.mod.push(I)}),n.mod.length&&n.modifies(_.output)}return n.changed()?n:e.StopPropagation}}),ur(uK,ar,{transform(t,e){if(this.value!=null&&!t.modified())return e.StopPropagation;var n,r,a,s,h,d=e.dataflow.locale(),g=e.fork(e.NO_SOURCE|e.NO_FIELDS),b=this.value,_=t.type||ax,E=t.scale,I=+t.limit,R=VS(E,t.count==null?5:t.count,t.minstep),z=!!t.values||_===ax,P=t.format||Uq(d,E,R,_,t.formatSpecifier,t.formatType,z),rt=t.values||jq(E,R);return b&&(g.rem=b),_===ax?(I&&rt.length>I?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),b=rt.slice(0,I-1),h=!0):b=rt,ut(a=t.size)?(t.values||E(b[0])!==0||(b=b.slice(1)),s=b.reduce((ot,at)=>Math.max(ot,a(at,t)),0)):a=Ke(s=a||8),b=b.map((ot,at)=>Jo({index:at,label:P(ot,at,b),value:ot,offset:s,size:a(ot,t)})),h&&(h=rt[b.length],b.push(Jo({index:b.length,label:"\u2026".concat(rt.length-b.length," entries"),value:h,offset:s,size:a(h,t)})))):_==="gradient"?(n=E.domain(),r=Mq(E,n[0],Ba(n)),rt.length<3&&!t.values&&n[0]!==Ba(n)&&(rt=[n[0],Ba(n)]),b=rt.map((ot,at)=>Jo({index:at,label:P(ot,at,rt),value:ot,perc:r(ot)}))):(a=rt.length-1,r=function(ot){let at=ot.domain(),dt=at.length-1,ct=+at[0],Ct=+Ba(at),Et=Ct-ct;if(ot.type===DT){let Rt=dt?Et/dt:.1;ct-=Rt,Ct+=Rt,Et=Ct-ct}return Rt=>(Rt-ct)/Et}(E),b=rt.map((ot,at)=>Jo({index:at,label:P(ot,at,rt),value:ot,perc:at?r(ot):0,perc2:at===a?1:r(rt[at+1])}))),g.source=b,g.add=b,this.value=b,g}});let Lht=t=>t.source.x,$ht=t=>t.source.y,zht=t=>t.target.x,Pht=t=>t.target.y;function f$(t){ar.call(this,{},t)}f$.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},ur(f$,ar,{transform(t,e){var n=t.sourceX||Lht,r=t.sourceY||$ht,a=t.targetX||zht,s=t.targetY||Pht,h=t.as||"path",d=t.orient||"vertical",g=t.shape||"line",b=hK.get(g+"-"+d)||hK.get(g);return b||Dn("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,_=>{_[h]=b(n(_),r(_),a(_),s(_))}),e.reflow(t.modified()).modifies(h)}});let lK=(t,e,n,r)=>"M"+t+","+e+"L"+n+","+r,cK=(t,e,n,r)=>{var a=n-t,s=r-e,h=Math.sqrt(a*a+s*s)/2;return"M"+t+","+e+"A"+h+","+h+" "+180*Math.atan2(s,a)/Math.PI+" 0 1 "+n+","+r},AA=(t,e,n,r)=>{let a=n-t,s=r-e,h=.2*(a+s),d=.2*(s-a);return"M"+t+","+e+"C"+(t+h)+","+(e+d)+" "+(n+d)+","+(r-h)+" "+n+","+r},hK=oi({line:lK,"line-radial":(t,e,n,r)=>lK(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),arc:cK,"arc-radial":(t,e,n,r)=>cK(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),curve:AA,"curve-radial":(t,e,n,r)=>AA(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(t,e,n,r)=>"M"+t+","+e+"V"+r+"H"+n,"orthogonal-vertical":(t,e,n,r)=>"M"+t+","+e+"H"+n+"V"+r,"orthogonal-radial":(t,e,n,r)=>{let a=Math.cos(t),s=Math.sin(t),h=Math.cos(n),d=Math.sin(n);return"M"+e*a+","+e*s+"A"+e+","+e+" 0 0,"+((Math.abs(n-t)>Math.PI?n<=t:n>t)?1:0)+" "+e*h+","+e*d+"L"+r*h+","+r*d},"diagonal-horizontal":(t,e,n,r)=>{let a=(t+n)/2;return"M"+t+","+e+"C"+a+","+e+" "+a+","+r+" "+n+","+r},"diagonal-vertical":(t,e,n,r)=>{let a=(e+r)/2;return"M"+t+","+e+"C"+t+","+a+" "+n+","+a+" "+n+","+r},"diagonal-radial":(t,e,n,r)=>{let a=Math.cos(t),s=Math.sin(t),h=Math.cos(n),d=Math.sin(n),g=(e+r)/2;return"M"+e*a+","+e*s+"C"+g*a+","+g*s+" "+g*h+","+g*d+" "+r*h+","+r*d}});function G2(t){ar.call(this,null,t)}G2.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},ur(G2,ar,{transform(t,e){var n,r,a,s=t.as||["startAngle","endAngle"],h=s[0],d=s[1],g=t.field||io,b=t.startAngle||0,_=t.endAngle!=null?t.endAngle:2*Math.PI,E=e.source,I=E.map(g),R=I.length,z=b,P=(_-b)/fb(I),rt=wf(R);for(t.sort&&rt.sort((ot,at)=>I[ot]-I[at]),n=0;n<R;++n)a=I[rt[n]],(r=E[rt[n]])[h]=z,r[d]=z+=a*P;return this.value=I,e.reflow(t.modified()).modifies(s)}});function dK(t){return GO(t)&&t!==km}let Bht=zc(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function fK(t){ar.call(this,null,t),this.modified(!0)}function pK(t,e,n){return Aq(t)&&Math.abs(e.reduce((r,a)=>r+(a<0?-1:a>0?1:0),0))!==e.length&&n.warn("Log scale domain includes zero: "+pi(e)),e}function mK(t,e,n){return ut(t)&&(e||n)?function(r,a){let s=a[0],h=Ba(a)-s;return function(d){return r(s+d*h)}}(t,IA(e||[0,1],n)):t}function IA(t,e){return e?t.slice().reverse():t}function gK(t){ar.call(this,null,t)}ur(fK,ar,{transform(t,e){var n=e.dataflow,r=this.value,a=function(s){var h,d=s.type,g="";return d===km?km+"-"+ex:(function(b){let _=b.type;return GO(_)&&_!==I2&&_!==qv&&(b.scheme||b.range&&b.range.length&&b.range.every(wi))}(s)&&(g=(h=s.rawDomain?s.rawDomain.length:s.domain?s.domain.length+ +(s.domainMid!=null):0)===2?km+"-":h===3?nx+"-":""),(g+d||ex).toLowerCase())}(t);for(a in r&&a===r.type||(this.value=r=rs(a)()),t)if(!Bht[a]){if(a==="padding"&&dK(r.type))continue;ut(r[a])?r[a](t[a]):n.warn("Unsupported scale property: "+a)}return function(s,h,d){var g=s.type,b=h.round||!1,_=h.range;if(h.rangeStep!=null)_=function(E,I,R){E!==Sq&&E!==UO&&Dn("Only band and point scales support rangeStep.");var z=(I.paddingOuter!=null?I.paddingOuter:I.padding)||0,P=E===UO?1:(I.paddingInner!=null?I.paddingInner:I.padding)||0;return[0,I.rangeStep*BO(R,P,z)]}(g,h,d);else if(h.scheme&&(_=function(E,I,R){var z,P=I.schemeExtent;return ni(I.scheme)?z=YO(I.scheme,I.interpolate,I.interpolateGamma):(z=Oq(I.scheme.toLowerCase()))||Dn("Unrecognized scheme name: ".concat(I.scheme)),R=E===DT?R+1:E===WO?R-1:E===rx||E===MT?+I.schemeCount||5:R,Iq(E)?mK(z,P,I.reverse):ut(z)?function(rt,ot){let at=new Array(ot),dt=ot+1;for(let ct=0;ct<ot;)at[ct]=rt(++ct/dt);return at}(mK(z,P),R):E===jO?z:z.slice(0,R)}(g,h,d),ut(_))){if(s.interpolator)return s.interpolator(_);Dn("Scale type ".concat(g," does not support interpolating color schemes."))}if(_&&Iq(g))return s.interpolator(YO(IA(_,h.reverse),h.interpolate,h.interpolateGamma));_&&h.interpolate&&s.interpolate?s.interpolate(Dq(h.interpolate,h.interpolateGamma)):ut(s.round)?s.round(b):ut(s.rangeRound)&&s.interpolate(b?lo:yp),_&&s.range(IA(_,h.reverse))}(r,t,function(s,h,d){let g=h.bins;if(g&&!ni(g)){let b=s.domain(),_=b[0],E=Ba(b),I=g.step,R=g.start==null?_:g.start,z=g.stop==null?E:g.stop;I||Dn("Scale bins parameter missing step property."),R<_&&(R=I*Math.ceil(_/I)),z>E&&(z=I*Math.floor(E/I)),g=wf(R,z+I/2,I)}return g?s.bins=g:s.bins&&delete s.bins,s.type===WO&&(g?h.domain||h.domainRaw||(s.domain(g),d=g.length):s.bins=s.domain()),d}(r,t,function(s,h,d){let g=function(z,P,rt){return P?(z.domain(pK(z.type,P,rt)),P.length):-1}(s,h.domainRaw,d);if(g>-1)return g;var b,_,E=h.domain,I=s.type,R=h.zero||h.zero===void 0&&function(z){let P=z.type;return!z.bins&&(P===ex||P===BS||P===xm)}(s);if(!E)return 0;if(dK(I)&&h.padding&&E[0]!==Ba(E)&&(E=function(z,P,rt,ot,at,dt){var ct=Math.abs(Ba(rt)-rt[0]),Ct=ct/(ct-2*ot),Et=z===zd?yt(P,null,Ct):z===xm?D(P,null,Ct,.5):z===BS?D(P,null,Ct,at||1):z===NT?U(P,null,Ct,dt||1):uc(P,null,Ct);return P=P.slice(),P[0]=Et[0],P[P.length-1]=Et[1],P}(I,E,h.range,h.padding,h.exponent,h.constant)),(R||h.domainMin!=null||h.domainMax!=null||h.domainMid!=null)&&(b=(E=E.slice()).length-1||1,R&&(E[0]>0&&(E[0]=0),E[b]<0&&(E[b]=0)),h.domainMin!=null&&(E[0]=h.domainMin),h.domainMax!=null&&(E[b]=h.domainMax),h.domainMid!=null)){let z=(_=h.domainMid)>E[b]?b+1:_<E[0]?0:b;z!==b&&d.warn("Scale domainMid exceeds domain min or max.",_),E.splice(z,0,_)}return s.domain(pK(I,E,d)),I===jO&&s.unknown(h.domainImplicit?iO:void 0),h.nice&&s.nice&&s.nice(h.nice!==!0&&VS(s,h.nice)||null),E.length}(r,t,n))),e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),ur(gK,ar,{transform(t,e){let n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(op(t.sort)),this.modified(n),e}});let Cx="zero",yK="center",vK="normalize",p$=["y0","y1"];function m$(t){ar.call(this,null,t)}function jht(t,e,n,r,a){for(var s,h=(e-t.sum)/2,d=t.length,g=0;g<d;++g)(s=t[g])[r]=h,s[a]=h+=Math.abs(n(s))}function Uht(t,e,n,r,a){for(var s,h=1/t.sum,d=0,g=t.length,b=0,_=0;b<g;++b)(s=t[b])[r]=d,s[a]=d=h*(_+=Math.abs(n(s)))}function Wht(t,e,n,r,a){for(var s,h,d=0,g=0,b=t.length,_=0;_<b;++_)(s=+n(h=t[_]))<0?(h[r]=g,h[a]=g+=s):(h[r]=d,h[a]=d+=s)}m$.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:Cx,values:[Cx,yK,vK]},{name:"as",type:"string",array:!0,length:2,default:p$}]},ur(m$,ar,{transform(t,e){var n,r,a,s,h=t.as||p$,d=h[0],g=h[1],b=op(t.sort),_=t.field||io,E=t.offset===yK?jht:t.offset===vK?Uht:Wht;for(n=function(I,R,z,P){var rt,ot,at,dt,ct,Ct,Et,Rt,Ot,Wt=[],jt=Ht=>Ht(ct);if(R==null)Wt.push(I.slice());else for(rt={},ot=0,at=I.length;ot<at;++ot)ct=I[ot],(Et=rt[Ct=R.map(jt)])||(rt[Ct]=Et=[],Wt.push(Et)),Et.push(ct);for(Ct=0,Ot=0,dt=Wt.length;Ct<dt;++Ct){for(ot=0,Rt=0,at=(Et=Wt[Ct]).length;ot<at;++ot)Rt+=Math.abs(P(Et[ot]));Et.sum=Rt,Rt>Ot&&(Ot=Rt),z&&Et.sort(z)}return Wt.max=Ot,Wt}(e.source,t.groupby,b,_),r=0,a=n.length,s=n.max;r<a;++r)E(n[r],s,_,d,g);return e.reflow(t.modified()).modifies(h)}});var g$=Math.sqrt(50),y$=Math.sqrt(10),NA=Math.sqrt(2);function v$(t,e,n){var r,a,s,h,d=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(a=t,t=e,e=a),(h=bK(t,e,n))===0||!isFinite(h))return[];if(h>0){let g=Math.round(t/h),b=Math.round(e/h);for(g*h<t&&++g,b*h>e&&--b,s=new Array(a=b-g+1);++d<a;)s[d]=(g+d)*h}else{h=-h;let g=Math.round(t*h),b=Math.round(e*h);for(g/h<t&&++g,b/h>e&&--b,s=new Array(a=b-g+1);++d<a;)s[d]=(g+d)/h}return r&&s.reverse(),s}function bK(t,e,n){var r=(e-t)/Math.max(0,n),a=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,a);return a>=0?(s>=g$?10:s>=y$?5:s>=NA?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(s>=g$?10:s>=y$?5:s>=NA?2:1)}function H2(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/a;return s>=g$?a*=10:s>=y$?a*=5:s>=NA&&(a*=2),e<t?-a:a}let Y2=t=>t;function gb(t,e){t&&Ex.hasOwnProperty(t.type)&&Ex[t.type](t,e)}var wK={Feature:function(t,e){gb(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,a=n.length;++r<a;)gb(n[r].geometry,e)}},Ex={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){MA(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)MA(n[r],e,0)},Polygon:function(t,e){xK(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)xK(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,a=n.length;++r<a;)gb(n[r],e)}};function MA(t,e,n){var r,a=-1,s=t.length-n;for(e.lineStart();++a<s;)r=t[a],e.point(r[0],r[1],r[2]);e.lineEnd()}function xK(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)MA(t[n],e,1);e.polygonEnd()}function yb(t,e){t&&wK.hasOwnProperty(t.type)?wK[t.type](t,e):gb(t,e)}class vb{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){let n=this._partials,r=0;for(let a=0;a<this._n&&a<32;a++){let s=n[a],h=e+s,d=Math.abs(e)<Math.abs(s)?e-(h-s):s-(h-e);d&&(n[r++]=d),e=h}return n[r]=e,this._n=r+1,this}valueOf(){let e=this._partials,n,r,a,s=this._n,h=0;if(s>0){for(h=e[--s];s>0&&(n=h,r=e[--s],h=n+r,a=r-(h-n),!a););s>0&&(a<0&&e[s-1]<0||a>0&&e[s-1]>0)&&(r=2*a,n=h+r,r==n-h&&(h=n))}return h}}var ao=1e-6,fo=Math.PI,fu=fo/2,b$=fo/4,Bd=2*fo,kh=180/fo,ju=fo/180,ds=Math.abs,Tx=Math.atan,Zg=Math.atan2,oo=Math.cos,kK=Math.exp,DA=Math.log,w$=Math.pow,qa=Math.sin,vp=Math.sign||function(t){return t>0?1:t<0?-1:0},jd=Math.sqrt,x$=Math.tan;function SK(t){return t>1?0:t<-1?fo:Math.acos(t)}function bp(t){return t>1?fu:t<-1?-fu:Math.asin(t)}function wp(){}var _K,Ax,RA,FA,OA=new vb,LA=new vb,Qg={point:wp,lineStart:wp,lineEnd:wp,polygonStart:function(){Qg.lineStart=Vht,Qg.lineEnd=Hht},polygonEnd:function(){Qg.lineStart=Qg.lineEnd=Qg.point=wp,OA.add(ds(LA)),LA=new vb},result:function(){var t=OA/2;return OA=new vb,t}};function Vht(){Qg.point=Ght}function Ght(t,e){Qg.point=CK,_K=RA=t,Ax=FA=e}function CK(t,e){LA.add(FA*t-RA*e),RA=t,FA=e}function Hht(){CK(_K,Ax)}let EK=Qg;var bb=1/0,w_=bb,x_=-bb,$A=x_,Yht={point:function(t,e){t<bb&&(bb=t),t>x_&&(x_=t),e<w_&&(w_=e),e>$A&&($A=e)},lineStart:wp,lineEnd:wp,polygonStart:wp,polygonEnd:wp,result:function(){var t=[[bb,w_],[x_,$A]];return x_=$A=-(w_=bb=1/0),t}};let zA=Yht;var TK,AK,Nm,Mm,k$=0,S$=0,k_=0,PA=0,BA=0,Ix=0,_$=0,C$=0,S_=0,xp={point:wb,lineStart:jA,lineEnd:NK,polygonStart:function(){xp.lineStart=Xht,xp.lineEnd=MK},polygonEnd:function(){xp.point=wb,xp.lineStart=jA,xp.lineEnd=NK},result:function(){var t=S_?[_$/S_,C$/S_]:Ix?[PA/Ix,BA/Ix]:k_?[k$/k_,S$/k_]:[NaN,NaN];return k$=S$=k_=PA=BA=Ix=_$=C$=S_=0,t}};function wb(t,e){k$+=t,S$+=e,++k_}function jA(){xp.point=qht}function qht(t,e){xp.point=IK,wb(Nm=t,Mm=e)}function IK(t,e){var n=t-Nm,r=e-Mm,a=jd(n*n+r*r);PA+=a*(Nm+t)/2,BA+=a*(Mm+e)/2,Ix+=a,wb(Nm=t,Mm=e)}function NK(){xp.point=wb}function Xht(){xp.point=DK}function MK(){RK(TK,AK)}function DK(t,e){xp.point=RK,wb(TK=Nm=t,AK=Mm=e)}function RK(t,e){var n=t-Nm,r=e-Mm,a=jd(n*n+r*r);PA+=a*(Nm+t)/2,BA+=a*(Mm+e)/2,Ix+=a,_$+=(a=Mm*t-Nm*e)*(Nm+t),C$+=a*(Mm+e),S_+=3*a,wb(Nm=t,Mm=e)}let FK=xp;function Nx(t){this._context=t}Nx.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Bd)}},result:wp};var E$,OK,LK,Mx,__,T$=new vb,UA={point:wp,lineStart:function(){UA.point=Kht},lineEnd:function(){E$&&$K(OK,LK),UA.point=wp},polygonStart:function(){E$=!0},polygonEnd:function(){E$=null},result:function(){var t=+T$;return T$=new vb,t}};function Kht(t,e){UA.point=$K,OK=Mx=t,LK=__=e}function $K(t,e){Mx-=t,__-=e,T$.add(jd(Mx*Mx+__*__)),Mx=t,__=e}let zK=UA,PK,Jg,WA,BK;class jK{constructor(e){this._append=e==null?UK:function(n){let r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);if(r>15)return UK;if(r!==PK){let a=10**r;PK=r,Jg=function(s){let h=1;this._+=s[0];for(let d=s.length;h<d;++h)this._+=Math.round(arguments[h]*a)/a+s[h]}}return Jg}(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(e,n){switch(this._point){case 0:this._append`M${e},${n}`,this._point=1;break;case 1:this._append`L${e},${n}`;break;default:if(this._append`M${e},${n}`,this._radius!==WA||this._append!==Jg){let r=this._radius,a=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,WA=r,Jg=this._append,BK=this._,this._=a}this._+=BK}}result(){let e=this._;return this._="",e.length?e:null}}function UK(t){let e=1;this._+=t[0];for(let n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function WK(t,e){let n,r,a=3,s=4.5;function h(d){return d&&(typeof s=="function"&&r.pointRadius(+s.apply(this,arguments)),yb(d,n(r))),r.result()}return h.area=function(d){return yb(d,n(EK)),EK.result()},h.measure=function(d){return yb(d,n(zK)),zK.result()},h.bounds=function(d){return yb(d,n(zA)),zA.result()},h.centroid=function(d){return yb(d,n(FK)),FK.result()},h.projection=function(d){return arguments.length?(n=d==null?(t=null,Y2):(t=d).stream,h):t},h.context=function(d){return arguments.length?(r=d==null?(e=null,new jK(a)):new Nx(e=d),typeof s!="function"&&r.pointRadius(s),h):e},h.pointRadius=function(d){return arguments.length?(s=typeof d=="function"?d:(r.pointRadius(+d),+d),h):s},h.digits=function(d){if(!arguments.length)return a;if(d==null)a=null;else{let g=Math.floor(d);if(!(g>=0))throw new RangeError(`invalid digits: ${d}`);a=g}return e===null&&(r=new jK(a)),h},h.projection(t).digits(a).context(e)}function VK(){var t,e=[];return{point:function(n,r,a){t.push([n,r,a])},lineStart:function(){e.push(t=[])},lineEnd:wp,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function C_(t,e){return ds(t[0]-e[0])<ao&&ds(t[1]-e[1])<ao}function VA(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function GK(t,e,n,r,a){var s,h,d=[],g=[];if(t.forEach(function(z){if(!((P=z.length-1)<=0)){var P,rt,ot=z[0],at=z[P];if(C_(ot,at)){if(!ot[2]&&!at[2]){for(a.lineStart(),s=0;s<P;++s)a.point((ot=z[s])[0],ot[1]);return void a.lineEnd()}at[0]+=2e-6}d.push(rt=new VA(ot,z,null,!0)),g.push(rt.o=new VA(ot,null,rt,!1)),d.push(rt=new VA(at,z,null,!1)),g.push(rt.o=new VA(at,null,rt,!0))}}),d.length){for(g.sort(e),HK(d),HK(g),s=0,h=g.length;s<h;++s)g[s].e=n=!n;for(var b,_,E=d[0];;){for(var I=E,R=!0;I.v;)if((I=I.n)===E)return;b=I.z,a.lineStart();do{if(I.v=I.o.v=!0,I.e){if(R)for(s=0,h=b.length;s<h;++s)a.point((_=b[s])[0],_[1]);else r(I.x,I.n.x,1,a);I=I.n}else{if(R)for(b=I.p.z,s=b.length-1;s>=0;--s)a.point((_=b[s])[0],_[1]);else r(I.x,I.p.x,-1,a);I=I.p}b=(I=I.o).z,R=!R}while(!I.v);a.lineEnd()}}}function HK(t){if(e=t.length){for(var e,n,r=0,a=t[0];++r<e;)a.n=n=t[r],n.p=a,a=n;a.n=n=t[0],n.p=a}}function A$(t){return[Zg(t[1],t[0]),bp(t[2])]}function Dx(t){var e=t[0],n=t[1],r=oo(n);return[r*oo(e),r*qa(e),qa(n)]}function GA(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function HA(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function I$(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function YA(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function N$(t){var e=jd(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function M$(t){return ds(t[0])<=fo?t[0]:vp(t[0])*((ds(t[0])+fo)%Bd-fo)}function YK(t){return Array.from(function*(e){for(let n of e)yield*OM(n)}(t))}function qK(t,e,n,r){return function(a){var s,h,d,g=e(a),b=VK(),_=e(b),E=!1,I={point:R,lineStart:P,lineEnd:rt,polygonStart:function(){I.point=ot,I.lineStart=at,I.lineEnd=dt,h=[],s=[]},polygonEnd:function(){I.point=R,I.lineStart=P,I.lineEnd=rt,h=YK(h);var ct=function(Ct,Et){var Rt=M$(Et),Ot=Et[1],Wt=qa(Ot),jt=[qa(Rt),-oo(Rt),0],Ht=0,Vt=0,fe=new vb;Wt===1?Ot=fu+ao:Wt===-1&&(Ot=-fu-ao);for(var se=0,he=Ct.length;se<he;++se)if(Ve=(_e=Ct[se]).length)for(var _e,Ve,gn=_e[Ve-1],$n=M$(gn),Gn=gn[1]/2+b$,qe=qa(Gn),tr=oo(Gn),er=0;er<Ve;++er,$n=dn,qe=Qn,tr=wr,gn=An){var An=_e[er],dn=M$(An),nr=An[1]/2+b$,Qn=qa(nr),wr=oo(nr),yi=dn-$n,ha=yi>=0?1:-1,mi=ha*yi,si=mi>fo,Ei=qe*Qn;if(fe.add(Zg(Ei*ha*qa(mi),tr*wr+Ei*oo(mi))),Ht+=si?yi+ha*Bd:yi,si^$n>=Rt^dn>=Rt){var ki=HA(Dx(gn),Dx(An));N$(ki);var Xi=HA(jt,ki);N$(Xi);var Fi=(si^yi>=0?-1:1)*bp(Xi[2]);(Ot>Fi||Ot===Fi&&(ki[0]||ki[1]))&&(Vt+=si^yi>=0?1:-1)}}return(Ht<-1e-6||Ht<ao&&fe<-1e-12)^1&Vt}(s,r);h.length?(E||(a.polygonStart(),E=!0),GK(h,Qht,ct,n,a)):ct&&(E||(a.polygonStart(),E=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),E&&(a.polygonEnd(),E=!1),h=s=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function R(ct,Ct){t(ct,Ct)&&a.point(ct,Ct)}function z(ct,Ct){g.point(ct,Ct)}function P(){I.point=z,g.lineStart()}function rt(){I.point=R,g.lineEnd()}function ot(ct,Ct){d.push([ct,Ct]),_.point(ct,Ct)}function at(){_.lineStart(),d=[]}function dt(){ot(d[0][0],d[0][1]),_.lineEnd();var ct,Ct,Et,Rt,Ot=_.clean(),Wt=b.result(),jt=Wt.length;if(d.pop(),s.push(d),d=null,jt)if(1&Ot){if((Ct=(Et=Wt[0]).length-1)>0){for(E||(a.polygonStart(),E=!0),a.lineStart(),ct=0;ct<Ct;++ct)a.point((Rt=Et[ct])[0],Rt[1]);a.lineEnd()}}else jt>1&&2&Ot&&Wt.push(Wt.pop().concat(Wt.shift())),h.push(Wt.filter(Zht))}return I}}function Zht(t){return t.length>1}function Qht(t,e){return((t=t.x)[0]<0?t[1]-fu-ao:fu-t[1])-((e=e.x)[0]<0?e[1]-fu-ao:fu-e[1])}let XK=qK(function(){return!0},function(t){var e,n=NaN,r=NaN,a=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(s,h){var d=s>0?fo:-fo,g=ds(s-n);ds(g-fo)<ao?(t.point(n,r=(r+h)/2>0?fu:-fu),t.point(a,r),t.lineEnd(),t.lineStart(),t.point(d,r),t.point(s,r),e=0):a!==d&&g>=fo&&(ds(n-a)<ao&&(n-=a*ao),ds(s-d)<ao&&(s-=d*ao),r=function(b,_,E,I){var R,z,P=qa(b-E);return ds(P)>ao?Tx((qa(_)*(z=oo(I))*qa(E)-qa(I)*(R=oo(_))*qa(b))/(R*z*P)):(_+I)/2}(n,r,s,h),t.point(a,r),t.lineEnd(),t.lineStart(),t.point(d,r),e=0),t.point(n=s,r=h),a=d},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}},function(t,e,n,r){var a;if(t==null)a=n*fu,r.point(-fo,a),r.point(0,a),r.point(fo,a),r.point(fo,0),r.point(fo,-a),r.point(0,-a),r.point(-fo,-a),r.point(-fo,0),r.point(-fo,a);else if(ds(t[0]-e[0])>ao){var s=t[0]<e[0]?fo:-fo;a=n*s/2,r.point(-s,a),r.point(0,a),r.point(s,a)}else r.point(e[0],e[1])},[-fo,-fu]);function Jht(t,e,n,r,a,s){if(n){var h=oo(e),d=qa(e),g=r*n;a==null?(a=e+r*Bd,s=e-g/2):(a=KK(h,a),s=KK(h,s),(r>0?a<s:a>s)&&(a+=r*Bd));for(var b,_=a;r>0?_>s:_<s;_-=g)b=A$([h,-d*oo(_),-d*qa(_)]),t.point(b[0],b[1])}}function KK(t,e){(e=Dx(e))[0]-=t,N$(e);var n=SK(-e[1]);return((-e[2]<0?-n:n)+Bd-ao)%Bd}var qA=1e9,XA=-1e9;function ZK(t,e,n,r){function a(b,_){return t<=b&&b<=n&&e<=_&&_<=r}function s(b,_,E,I){var R=0,z=0;if(b==null||(R=h(b,E))!==(z=h(_,E))||g(b,_)<0^E>0)do I.point(R===0||R===3?t:n,R>1?r:e);while((R=(R+E+4)%4)!==z);else I.point(_[0],_[1])}function h(b,_){return ds(b[0]-t)<ao?_>0?0:3:ds(b[0]-n)<ao?_>0?2:1:ds(b[1]-e)<ao?_>0?1:0:_>0?3:2}function d(b,_){return g(b.x,_.x)}function g(b,_){var E=h(b,1),I=h(_,1);return E!==I?E-I:E===0?_[1]-b[1]:E===1?b[0]-_[0]:E===2?b[1]-_[1]:_[0]-b[0]}return function(b){var _,E,I,R,z,P,rt,ot,at,dt,ct,Ct=b,Et=VK(),Rt={point:Ot,lineStart:function(){Rt.point=Wt,E&&E.push(I=[]),dt=!0,at=!1,rt=ot=NaN},lineEnd:function(){_&&(Wt(R,z),P&&at&&Et.rejoin(),_.push(Et.result())),Rt.point=Ot,at&&Ct.lineEnd()},polygonStart:function(){Ct=Et,_=[],E=[],ct=!0},polygonEnd:function(){var jt=function(){for(var fe=0,se=0,he=E.length;se<he;++se)for(var _e,Ve,gn=E[se],$n=1,Gn=gn.length,qe=gn[0],tr=qe[0],er=qe[1];$n<Gn;++$n)_e=tr,Ve=er,tr=(qe=gn[$n])[0],er=qe[1],Ve<=r?er>r&&(tr-_e)*(r-Ve)>(er-Ve)*(t-_e)&&++fe:er<=r&&(tr-_e)*(r-Ve)<(er-Ve)*(t-_e)&&--fe;return fe}(),Ht=ct&&jt,Vt=(_=YK(_)).length;(Ht||Vt)&&(b.polygonStart(),Ht&&(b.lineStart(),s(null,null,1,b),b.lineEnd()),Vt&&GK(_,d,jt,s,b),b.polygonEnd()),Ct=b,_=E=I=null}};function Ot(jt,Ht){a(jt,Ht)&&Ct.point(jt,Ht)}function Wt(jt,Ht){var Vt=a(jt,Ht);if(E&&I.push([jt,Ht]),dt)R=jt,z=Ht,P=Vt,dt=!1,Vt&&(Ct.lineStart(),Ct.point(jt,Ht));else if(Vt&&at)Ct.point(jt,Ht);else{var fe=[rt=Math.max(XA,Math.min(qA,rt)),ot=Math.max(XA,Math.min(qA,ot))],se=[jt=Math.max(XA,Math.min(qA,jt)),Ht=Math.max(XA,Math.min(qA,Ht))];(function(he,_e,Ve,gn,$n,Gn){var qe,tr=he[0],er=he[1],An=0,dn=1,nr=_e[0]-tr,Qn=_e[1]-er;if(qe=Ve-tr,nr||!(qe>0)){if(qe/=nr,nr<0){if(qe<An)return;qe<dn&&(dn=qe)}else if(nr>0){if(qe>dn)return;qe>An&&(An=qe)}if(qe=$n-tr,nr||!(qe<0)){if(qe/=nr,nr<0){if(qe>dn)return;qe>An&&(An=qe)}else if(nr>0){if(qe<An)return;qe<dn&&(dn=qe)}if(qe=gn-er,Qn||!(qe>0)){if(qe/=Qn,Qn<0){if(qe<An)return;qe<dn&&(dn=qe)}else if(Qn>0){if(qe>dn)return;qe>An&&(An=qe)}if(qe=Gn-er,Qn||!(qe<0)){if(qe/=Qn,Qn<0){if(qe>dn)return;qe>An&&(An=qe)}else if(Qn>0){if(qe<An)return;qe<dn&&(dn=qe)}return An>0&&(he[0]=tr+An*nr,he[1]=er+An*Qn),dn<1&&(_e[0]=tr+dn*nr,_e[1]=er+dn*Qn),!0}}}}})(fe,se,t,e,n,r)?(at||(Ct.lineStart(),Ct.point(fe[0],fe[1])),Ct.point(se[0],se[1]),Vt||Ct.lineEnd(),ct=!1):Vt&&(Ct.lineStart(),Ct.point(jt,Ht),ct=!1)}rt=jt,ot=Ht,at=Vt}return Rt}}function D$(t,e){function n(r,a){return r=t(r,a),e(r[0],r[1])}return t.invert&&e.invert&&(n.invert=function(r,a){return(r=e.invert(r,a))&&t.invert(r[0],r[1])}),n}function R$(t,e){return ds(t)>fo&&(t-=Math.round(t/Bd)*Bd),[t,e]}function QK(t,e,n){return(t%=Bd)?e||n?D$(tZ(t),eZ(e,n)):tZ(t):e||n?eZ(e,n):R$}function JK(t){return function(e,n){return ds(e+=t)>fo&&(e-=Math.round(e/Bd)*Bd),[e,n]}}function tZ(t){var e=JK(t);return e.invert=JK(-t),e}function eZ(t,e){var n=oo(t),r=qa(t),a=oo(e),s=qa(e);function h(d,g){var b=oo(g),_=oo(d)*b,E=qa(d)*b,I=qa(g),R=I*n+_*r;return[Zg(E*a-R*s,_*n-I*r),bp(R*a+E*s)]}return h.invert=function(d,g){var b=oo(g),_=oo(d)*b,E=qa(d)*b,I=qa(g),R=I*a-E*s;return[Zg(E*a+I*s,_*n+R*r),bp(R*n-_*r)]},h}function KA(t){return function(e){var n=new F$;for(var r in t)n[r]=t[r];return n.stream=e,n}}function F$(){}function O$(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),r!=null&&t.clipExtent(null),yb(n,t.stream(zA)),e(zA.result()),r!=null&&t.clipExtent(r),t}function ZA(t,e,n){return O$(t,function(r){var a=e[1][0]-e[0][0],s=e[1][1]-e[0][1],h=Math.min(a/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),d=+e[0][0]+(a-h*(r[1][0]+r[0][0]))/2,g=+e[0][1]+(s-h*(r[1][1]+r[0][1]))/2;t.scale(150*h).translate([d,g])},n)}function L$(t,e,n){return ZA(t,[[0,0],e],n)}function QA(t,e,n){return O$(t,function(r){var a=+e,s=a/(r[1][0]-r[0][0]),h=(a-s*(r[1][0]+r[0][0]))/2,d=-s*r[0][1];t.scale(150*s).translate([h,d])},n)}function $$(t,e,n){return O$(t,function(r){var a=+e,s=a/(r[1][1]-r[0][1]),h=-s*r[0][0],d=(a-s*(r[1][1]+r[0][1]))/2;t.scale(150*s).translate([h,d])},n)}R$.invert=R$,F$.prototype={constructor:F$,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var tdt=oo(30*ju);function nZ(t,e){return+e?function(n,r){function a(s,h,d,g,b,_,E,I,R,z,P,rt,ot,at){var dt=E-s,ct=I-h,Ct=dt*dt+ct*ct;if(Ct>4*r&&ot--){var Et=g+z,Rt=b+P,Ot=_+rt,Wt=jd(Et*Et+Rt*Rt+Ot*Ot),jt=bp(Ot/=Wt),Ht=ds(ds(Ot)-1)<ao||ds(d-R)<ao?(d+R)/2:Zg(Rt,Et),Vt=n(Ht,jt),fe=Vt[0],se=Vt[1],he=fe-s,_e=se-h,Ve=ct*he-dt*_e;(Ve*Ve/Ct>r||ds((dt*he+ct*_e)/Ct-.5)>.3||g*z+b*P+_*rt<tdt)&&(a(s,h,d,g,b,_,fe,se,Ht,Et/=Wt,Rt/=Wt,Ot,ot,at),at.point(fe,se),a(fe,se,Ht,Et,Rt,Ot,E,I,R,z,P,rt,ot,at))}}return function(s){var h,d,g,b,_,E,I,R,z,P,rt,ot,at={point:dt,lineStart:ct,lineEnd:Et,polygonStart:function(){s.polygonStart(),at.lineStart=Rt},polygonEnd:function(){s.polygonEnd(),at.lineStart=ct}};function dt(jt,Ht){jt=n(jt,Ht),s.point(jt[0],jt[1])}function ct(){R=NaN,at.point=Ct,s.lineStart()}function Ct(jt,Ht){var Vt=Dx([jt,Ht]),fe=n(jt,Ht);a(R,z,I,P,rt,ot,R=fe[0],z=fe[1],I=jt,P=Vt[0],rt=Vt[1],ot=Vt[2],16,s),s.point(R,z)}function Et(){at.point=dt,s.lineEnd()}function Rt(){ct(),at.point=Ot,at.lineEnd=Wt}function Ot(jt,Ht){Ct(h=jt,Ht),d=R,g=z,b=P,_=rt,E=ot,at.point=Ct}function Wt(){a(R,z,I,P,rt,ot,d,g,h,b,_,E,16,s),at.lineEnd=Et,Et()}return at}}(t,e):function(n){return KA({point:function(r,a){r=n(r,a),this.stream.point(r[0],r[1])}})}(t)}var edt=KA({point:function(t,e){this.stream.point(t*ju,e*ju)}});function rZ(t,e,n,r,a,s){if(!s)return function(P,rt,ot,at,dt){function ct(Ct,Et){return[rt+P*(Ct*=at),ot-P*(Et*=dt)]}return ct.invert=function(Ct,Et){return[(Ct-rt)/P*at,(ot-Et)/P*dt]},ct}(t,e,n,r,a);var h=oo(s),d=qa(s),g=h*t,b=d*t,_=h/t,E=d/t,I=(d*n-h*e)/t,R=(d*e+h*n)/t;function z(P,rt){return[g*(P*=r)-b*(rt*=a)+e,n-b*P-g*rt]}return z.invert=function(P,rt){return[r*(_*P-E*rt+I),a*(R-E*P-_*rt)]},z}function t1(t){return iZ(function(){return t})()}function iZ(t){var e,n,r,a,s,h,d,g,b,_,E=150,I=480,R=250,z=0,P=0,rt=0,ot=0,at=0,dt=0,ct=1,Ct=1,Et=null,Rt=XK,Ot=null,Wt=Y2,jt=.5;function Ht(he){return g(he[0]*ju,he[1]*ju)}function Vt(he){return(he=g.invert(he[0],he[1]))&&[he[0]*kh,he[1]*kh]}function fe(){var he=rZ(E,0,0,ct,Ct,dt).apply(null,e(z,P)),_e=rZ(E,I-he[0],R-he[1],ct,Ct,dt);return n=QK(rt,ot,at),d=D$(e,_e),g=D$(n,d),h=nZ(d,jt),se()}function se(){return b=_=null,Ht}return Ht.stream=function(he){return b&&_===he?b:b=edt(function(_e){return KA({point:function(Ve,gn){var $n=_e(Ve,gn);return this.stream.point($n[0],$n[1])}})}(n)(Rt(h(Wt(_=he)))))},Ht.preclip=function(he){return arguments.length?(Rt=he,Et=void 0,se()):Rt},Ht.postclip=function(he){return arguments.length?(Wt=he,Ot=r=a=s=null,se()):Wt},Ht.clipAngle=function(he){return arguments.length?(Rt=+he?function(_e){var Ve=oo(_e),gn=2*ju,$n=Ve>0,Gn=ds(Ve)>ao;function qe(An,dn){return oo(An)*oo(dn)>Ve}function tr(An,dn,nr){var Qn=[1,0,0],wr=HA(Dx(An),Dx(dn)),yi=GA(wr,wr),ha=wr[0],mi=yi-ha*ha;if(!mi)return!nr&&An;var si=Ve*yi/mi,Ei=-Ve*ha/mi,ki=HA(Qn,wr),Xi=YA(Qn,si);I$(Xi,YA(wr,Ei));var Fi=ki,Go=GA(Xi,Fi),gd=GA(Fi,Fi),Uh=Go*Go-gd*(GA(Xi,Xi)-1);if(!(Uh<0)){var rc=jd(Uh),Do=YA(Fi,(-Go-rc)/gd);if(I$(Do,Xi),Do=A$(Do),!nr)return Do;var us,Io=An[0],ou=dn[0],uh=An[1],Ac=dn[1];ou<Io&&(us=Io,Io=ou,ou=us);var Zp=ou-Io,G1=ds(Zp-fo)<ao;if(!G1&&Ac<uh&&(us=uh,uh=Ac,Ac=us),G1||Zp<ao?G1?uh+Ac>0^Do[1]<(ds(Do[0]-Io)<ao?uh:Ac):uh<=Do[1]&&Do[1]<=Ac:Zp>fo^(Io<=Do[0]&&Do[0]<=ou)){var W3=YA(Fi,(-Go+rc)/gd);return I$(W3,Xi),[Do,A$(W3)]}}}function er(An,dn){var nr=$n?_e:fo-_e,Qn=0;return An<-nr?Qn|=1:An>nr&&(Qn|=2),dn<-nr?Qn|=4:dn>nr&&(Qn|=8),Qn}return qK(qe,function(An){var dn,nr,Qn,wr,yi;return{lineStart:function(){wr=Qn=!1,yi=1},point:function(ha,mi){var si,Ei=[ha,mi],ki=qe(ha,mi),Xi=$n?ki?0:er(ha,mi):ki?er(ha+(ha<0?fo:-fo),mi):0;if(!dn&&(wr=Qn=ki)&&An.lineStart(),ki!==Qn&&(!(si=tr(dn,Ei))||C_(dn,si)||C_(Ei,si))&&(Ei[2]=1),ki!==Qn)yi=0,ki?(An.lineStart(),si=tr(Ei,dn),An.point(si[0],si[1])):(si=tr(dn,Ei),An.point(si[0],si[1],2),An.lineEnd()),dn=si;else if(Gn&&dn&&$n^ki){var Fi;Xi&nr||!(Fi=tr(Ei,dn,!0))||(yi=0,$n?(An.lineStart(),An.point(Fi[0][0],Fi[0][1]),An.point(Fi[1][0],Fi[1][1]),An.lineEnd()):(An.point(Fi[1][0],Fi[1][1]),An.lineEnd(),An.lineStart(),An.point(Fi[0][0],Fi[0][1],3)))}!ki||dn&&C_(dn,Ei)||An.point(Ei[0],Ei[1]),dn=Ei,Qn=ki,nr=Xi},lineEnd:function(){Qn&&An.lineEnd(),dn=null},clean:function(){return yi|(wr&&Qn)<<1}}},function(An,dn,nr,Qn){Jht(Qn,_e,gn,nr,An,dn)},$n?[0,-_e]:[-fo,_e-fo])}(Et=he*ju):(Et=null,XK),se()):Et*kh},Ht.clipExtent=function(he){return arguments.length?(Wt=he==null?(Ot=r=a=s=null,Y2):ZK(Ot=+he[0][0],r=+he[0][1],a=+he[1][0],s=+he[1][1]),se()):Ot==null?null:[[Ot,r],[a,s]]},Ht.scale=function(he){return arguments.length?(E=+he,fe()):E},Ht.translate=function(he){return arguments.length?(I=+he[0],R=+he[1],fe()):[I,R]},Ht.center=function(he){return arguments.length?(z=he[0]%360*ju,P=he[1]%360*ju,fe()):[z*kh,P*kh]},Ht.rotate=function(he){return arguments.length?(rt=he[0]%360*ju,ot=he[1]%360*ju,at=he.length>2?he[2]%360*ju:0,fe()):[rt*kh,ot*kh,at*kh]},Ht.angle=function(he){return arguments.length?(dt=he%360*ju,fe()):dt*kh},Ht.reflectX=function(he){return arguments.length?(ct=he?-1:1,fe()):ct<0},Ht.reflectY=function(he){return arguments.length?(Ct=he?-1:1,fe()):Ct<0},Ht.precision=function(he){return arguments.length?(h=nZ(d,jt=he*he),se()):jd(jt)},Ht.fitExtent=function(he,_e){return ZA(Ht,he,_e)},Ht.fitSize=function(he,_e){return L$(Ht,he,_e)},Ht.fitWidth=function(he,_e){return QA(Ht,he,_e)},Ht.fitHeight=function(he,_e){return $$(Ht,he,_e)},function(){return e=t.apply(this,arguments),Ht.invert=e.invert&&Vt,fe()}}function z$(t){var e=0,n=fo/3,r=iZ(t),a=r(e,n);return a.parallels=function(s){return arguments.length?r(e=s[0]*ju,n=s[1]*ju):[e*kh,n*kh]},a}function ndt(t,e){var n=qa(t),r=(n+qa(e))/2;if(ds(r)<ao)return function(d){var g=oo(d);function b(_,E){return[_*g,qa(E)/g]}return b.invert=function(_,E){return[_/g,bp(E*g)]},b}(t);var a=1+n*(2*r-n),s=jd(a)/r;function h(d,g){var b=jd(a-2*r*qa(g))/r;return[b*qa(d*=r),s-b*oo(d)]}return h.invert=function(d,g){var b=s-g,_=Zg(d,ds(b))*vp(b);return b*r<0&&(_-=fo*vp(d)*vp(b)),[_/r,bp((a-(d*d+b*b)*r*r)/(2*r))]},h}function JA(){return z$(ndt).scale(155.424).center([0,33.6442])}function aZ(){return JA().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function oZ(t){return function(e,n){var r=oo(e),a=oo(n),s=t(r*a);return s===1/0?[2,0]:[s*a*qa(e),s*qa(n)]}}function E_(t){return function(e,n){var r=jd(e*e+n*n),a=t(r),s=qa(a),h=oo(a);return[Zg(e*s,r*h),bp(r&&n*s/r)]}}var sZ=oZ(function(t){return jd(2/(1+t))});sZ.invert=E_(function(t){return 2*bp(t/2)});var uZ=oZ(function(t){return(t=SK(t))&&t/qa(t)});function tI(t,e){return[t,DA(x$((fu+e)/2))]}function lZ(t){var e,n,r,a=t1(t),s=a.center,h=a.scale,d=a.translate,g=a.clipExtent,b=null;function _(){var E=fo*h(),I=a(function(R){function z(P){return(P=R(P[0]*ju,P[1]*ju))[0]*=kh,P[1]*=kh,P}return R=QK(R[0]*ju,R[1]*ju,R.length>2?R[2]*ju:0),z.invert=function(P){return(P=R.invert(P[0]*ju,P[1]*ju))[0]*=kh,P[1]*=kh,P},z}(a.rotate()).invert([0,0]));return g(b==null?[[I[0]-E,I[1]-E],[I[0]+E,I[1]+E]]:t===tI?[[Math.max(I[0]-E,b),e],[Math.min(I[0]+E,n),r]]:[[b,Math.max(I[1]-E,e)],[n,Math.min(I[1]+E,r)]])}return a.scale=function(E){return arguments.length?(h(E),_()):h()},a.translate=function(E){return arguments.length?(d(E),_()):d()},a.center=function(E){return arguments.length?(s(E),_()):s()},a.clipExtent=function(E){return arguments.length?(E==null?b=e=n=r=null:(b=+E[0][0],e=+E[0][1],n=+E[1][0],r=+E[1][1]),_()):b==null?null:[[b,e],[n,r]]},_()}function eI(t){return x$((fu+t)/2)}function rdt(t,e){var n=oo(t),r=t===e?qa(t):DA(n/oo(e))/DA(eI(e)/eI(t)),a=n*w$(eI(t),r)/r;if(!r)return tI;function s(h,d){a>0?d<-fu+ao&&(d=-fu+ao):d>fu-ao&&(d=fu-ao);var g=a/w$(eI(d),r);return[g*qa(r*h),a-g*oo(r*h)]}return s.invert=function(h,d){var g=a-d,b=vp(r)*jd(h*h+g*g),_=Zg(h,ds(g))*vp(g);return g*r<0&&(_-=fo*vp(h)*vp(g)),[_/r,2*Tx(w$(a/b,1/r))-fu]},s}function nI(t,e){return[t,e]}function cZ(t,e){var n=oo(t),r=t===e?qa(t):(n-oo(e))/(e-t),a=n/r+t;if(ds(r)<ao)return nI;function s(h,d){var g=a-d,b=r*h;return[g*qa(b),a-g*oo(b)]}return s.invert=function(h,d){var g=a-d,b=Zg(h,ds(g))*vp(g);return g*r<0&&(b-=fo*vp(h)*vp(g)),[b/r,a-vp(r)*jd(h*h+g*g)]},s}uZ.invert=E_(function(t){return t}),tI.invert=function(t,e){return[t,2*Tx(kK(e))-fu]},nI.invert=nI;var T_=1.340264,Rx=-.081106,Fx=893e-6,A_=.003796,I_=jd(3)/2;function hZ(t,e){var n=bp(I_*qa(e)),r=n*n,a=r*r*r;return[t*oo(n)/(I_*(T_+3*Rx*r+a*(7*Fx+9*A_*r))),n*(T_+Rx*r+a*(Fx+A_*r))]}function dZ(t,e){var n=oo(e),r=oo(t)*n;return[n*qa(t)/r,qa(e)/r]}function fZ(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function pZ(t,e){return[oo(e)*qa(t),qa(e)]}function mZ(t,e){var n=oo(e),r=1+oo(t)*n;return[n*qa(t)/r,qa(e)/r]}function gZ(t,e){return[DA(x$((fu+e)/2)),-t]}function N_(){}function yZ(){var t,e=[];return{point:function(n,r,a){t.push([n,r,a])},lineStart:function(){e.push(t=[])},lineEnd:N_,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}hZ.invert=function(t,e){for(var n,r=e,a=r*r,s=a*a*a,h=0;h<12&&(s=(a=(r-=n=(r*(T_+Rx*a+s*(Fx+A_*a))-e)/(T_+3*Rx*a+s*(7*Fx+9*A_*a)))*r)*a*a,!(ds(n)<1e-12));++h);return[I_*t*(T_+3*Rx*a+s*(7*Fx+9*A_*a))/oo(r),bp(qa(r)/I_)]},dZ.invert=E_(Tx),fZ.invert=function(t,e){var n,r=e,a=25;do{var s=r*r,h=s*s;r-=n=(r*(1.007226+s*(.015085+h*(.028874*s-.044475-.005916*h)))-e)/(1.007226+s*(.045255+h*(.259866*s-.311325-.06507600000000001*h)))}while(ds(n)>ao&&--a>0);return[t/(.8707+(s=r*r)*(s*(s*s*s*(.003971-.001529*s)-.013791)-.131979)),r]},pZ.invert=E_(bp),mZ.invert=E_(function(t){return 2*Tx(t)}),gZ.invert=function(t,e){return[-e,2*Tx(kK(t))-fu]};var _u=1e-6,Lo=Math.PI,kp=Lo/2,vZ=Lo/4,Ud=2*Lo,e1=180/Lo,_f=Lo/180,rl=Math.abs,idt=Math.atan,M_=Math.atan2,il=Math.cos,gl=Math.sin,adt=Math.sign||function(t){return t>0?1:t<0?-1:0},rI=Math.sqrt;function D_(t){return t>1?kp:t<-1?-kp:Math.asin(t)}function iI(t,e){return rl(t[0]-e[0])<_u&&rl(t[1]-e[1])<_u}function aI(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function bZ(t,e,n,r,a){var s,h,d=[],g=[];if(t.forEach(function(z){if(!((P=z.length-1)<=0)){var P,rt,ot=z[0],at=z[P];if(iI(ot,at)){if(!ot[2]&&!at[2]){for(a.lineStart(),s=0;s<P;++s)a.point((ot=z[s])[0],ot[1]);return void a.lineEnd()}at[0]+=2e-6}d.push(rt=new aI(ot,z,null,!0)),g.push(rt.o=new aI(ot,null,rt,!1)),d.push(rt=new aI(at,z,null,!1)),g.push(rt.o=new aI(at,null,rt,!0))}}),d.length){for(g.sort(e),P$(d),P$(g),s=0,h=g.length;s<h;++s)g[s].e=n=!n;for(var b,_,E=d[0];;){for(var I=E,R=!0;I.v;)if((I=I.n)===E)return;b=I.z,a.lineStart();do{if(I.v=I.o.v=!0,I.e){if(R)for(s=0,h=b.length;s<h;++s)a.point((_=b[s])[0],_[1]);else r(I.x,I.n.x,1,a);I=I.n}else{if(R)for(b=I.p.z,s=b.length-1;s>=0;--s)a.point((_=b[s])[0],_[1]);else r(I.x,I.p.x,-1,a);I=I.p}b=(I=I.o).z,R=!R}while(!I.v);a.lineEnd()}}}function P$(t){if(e=t.length){for(var e,n,r=0,a=t[0];++r<e;)a.n=n=t[r],n.p=a,a=n;a.n=n=t[0],n.p=a}}class odt{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){let n=this._partials,r=0;for(let a=0;a<this._n&&a<32;a++){let s=n[a],h=e+s,d=Math.abs(e)<Math.abs(s)?e-(h-s):s-(h-e);d&&(n[r++]=d),e=h}return n[r]=e,this._n=r+1,this}valueOf(){let e=this._partials,n,r,a,s=this._n,h=0;if(s>0){for(h=e[--s];s>0&&(n=h,r=e[--s],h=n+r,a=r-(h-n),!a););s>0&&(a<0&&e[s-1]<0||a>0&&e[s-1]>0)&&(r=2*a,n=h+r,r==n-h&&(h=n))}return h}}function B$(t){return[M_(t[1],t[0]),D_(t[2])]}function Ox(t){var e=t[0],n=t[1],r=il(n);return[r*il(e),r*gl(e),gl(n)]}function oI(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function sI(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function j$(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function uI(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function U$(t){var e=rI(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function W$(t){return rl(t[0])<=Lo?t[0]:adt(t[0])*((rl(t[0])+Lo)%Ud-Lo)}function wZ(t){return Array.from(function*(e){for(let n of e)yield*OM(n)}(t))}function xZ(t,e,n,r){return function(a){var s,h,d,g=e(a),b=yZ(),_=e(b),E=!1,I={point:R,lineStart:P,lineEnd:rt,polygonStart:function(){I.point=ot,I.lineStart=at,I.lineEnd=dt,h=[],s=[]},polygonEnd:function(){I.point=R,I.lineStart=P,I.lineEnd=rt,h=wZ(h);var ct=function(Ct,Et){var Rt=W$(Et),Ot=Et[1],Wt=gl(Ot),jt=[gl(Rt),-il(Rt),0],Ht=0,Vt=0,fe=new odt;Wt===1?Ot=kp+_u:Wt===-1&&(Ot=-kp-_u);for(var se=0,he=Ct.length;se<he;++se)if(Ve=(_e=Ct[se]).length)for(var _e,Ve,gn=_e[Ve-1],$n=W$(gn),Gn=gn[1]/2+vZ,qe=gl(Gn),tr=il(Gn),er=0;er<Ve;++er,$n=dn,qe=Qn,tr=wr,gn=An){var An=_e[er],dn=W$(An),nr=An[1]/2+vZ,Qn=gl(nr),wr=il(nr),yi=dn-$n,ha=yi>=0?1:-1,mi=ha*yi,si=mi>Lo,Ei=qe*Qn;if(fe.add(M_(Ei*ha*gl(mi),tr*wr+Ei*il(mi))),Ht+=si?yi+ha*Ud:yi,si^$n>=Rt^dn>=Rt){var ki=sI(Ox(gn),Ox(An));U$(ki);var Xi=sI(jt,ki);U$(Xi);var Fi=(si^yi>=0?-1:1)*D_(Xi[2]);(Ot>Fi||Ot===Fi&&(ki[0]||ki[1]))&&(Vt+=si^yi>=0?1:-1)}}return(Ht<-1e-6||Ht<_u&&fe<-1e-12)^1&Vt}(s,r);h.length?(E||(a.polygonStart(),E=!0),bZ(h,udt,ct,n,a)):ct&&(E||(a.polygonStart(),E=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),E&&(a.polygonEnd(),E=!1),h=s=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function R(ct,Ct){t(ct,Ct)&&a.point(ct,Ct)}function z(ct,Ct){g.point(ct,Ct)}function P(){I.point=z,g.lineStart()}function rt(){I.point=R,g.lineEnd()}function ot(ct,Ct){d.push([ct,Ct]),_.point(ct,Ct)}function at(){_.lineStart(),d=[]}function dt(){ot(d[0][0],d[0][1]),_.lineEnd();var ct,Ct,Et,Rt,Ot=_.clean(),Wt=b.result(),jt=Wt.length;if(d.pop(),s.push(d),d=null,jt)if(1&Ot){if((Ct=(Et=Wt[0]).length-1)>0){for(E||(a.polygonStart(),E=!0),a.lineStart(),ct=0;ct<Ct;++ct)a.point((Rt=Et[ct])[0],Rt[1]);a.lineEnd()}}else jt>1&&2&Ot&&Wt.push(Wt.pop().concat(Wt.shift())),h.push(Wt.filter(sdt))}return I}}function sdt(t){return t.length>1}function udt(t,e){return((t=t.x)[0]<0?t[1]-kp-_u:kp-t[1])-((e=e.x)[0]<0?e[1]-kp-_u:kp-e[1])}let kZ=xZ(function(){return!0},function(t){var e,n=NaN,r=NaN,a=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(s,h){var d=s>0?Lo:-Lo,g=rl(s-n);rl(g-Lo)<_u?(t.point(n,r=(r+h)/2>0?kp:-kp),t.point(a,r),t.lineEnd(),t.lineStart(),t.point(d,r),t.point(s,r),e=0):a!==d&&g>=Lo&&(rl(n-a)<_u&&(n-=a*_u),rl(s-d)<_u&&(s-=d*_u),r=function(b,_,E,I){var R,z,P=gl(b-E);return rl(P)>_u?idt((gl(_)*(z=il(I))*gl(E)-gl(I)*(R=il(_))*gl(b))/(R*z*P)):(_+I)/2}(n,r,s,h),t.point(a,r),t.lineEnd(),t.lineStart(),t.point(d,r),e=0),t.point(n=s,r=h),a=d},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}},function(t,e,n,r){var a;if(t==null)a=n*kp,r.point(-Lo,a),r.point(0,a),r.point(Lo,a),r.point(Lo,0),r.point(Lo,-a),r.point(0,-a),r.point(-Lo,-a),r.point(-Lo,0),r.point(-Lo,a);else if(rl(t[0]-e[0])>_u){var s=t[0]<e[0]?Lo:-Lo;a=n*s/2,r.point(-s,a),r.point(0,a),r.point(s,a)}else r.point(e[0],e[1])},[-Lo,-kp]);function ldt(t,e,n,r,a,s){if(n){var h=il(e),d=gl(e),g=r*n;a==null?(a=e+r*Ud,s=e-g/2):(a=SZ(h,a),s=SZ(h,s),(r>0?a<s:a>s)&&(a+=r*Ud));for(var b,_=a;r>0?_>s:_<s;_-=g)b=B$([h,-d*il(_),-d*gl(_)]),t.point(b[0],b[1])}}function SZ(t,e){(e=Ox(e))[0]-=t,U$(e);var n=function(r){return r>1?0:r<-1?Lo:Math.acos(r)}(-e[1]);return((-e[2]<0?-n:n)+Ud-_u)%Ud}var lI=1e9,cI=-1e9;function cdt(t,e,n,r){function a(b,_){return t<=b&&b<=n&&e<=_&&_<=r}function s(b,_,E,I){var R=0,z=0;if(b==null||(R=h(b,E))!==(z=h(_,E))||g(b,_)<0^E>0)do I.point(R===0||R===3?t:n,R>1?r:e);while((R=(R+E+4)%4)!==z);else I.point(_[0],_[1])}function h(b,_){return rl(b[0]-t)<_u?_>0?0:3:rl(b[0]-n)<_u?_>0?2:1:rl(b[1]-e)<_u?_>0?1:0:_>0?3:2}function d(b,_){return g(b.x,_.x)}function g(b,_){var E=h(b,1),I=h(_,1);return E!==I?E-I:E===0?_[1]-b[1]:E===1?b[0]-_[0]:E===2?b[1]-_[1]:_[0]-b[0]}return function(b){var _,E,I,R,z,P,rt,ot,at,dt,ct,Ct=b,Et=yZ(),Rt={point:Ot,lineStart:function(){Rt.point=Wt,E&&E.push(I=[]),dt=!0,at=!1,rt=ot=NaN},lineEnd:function(){_&&(Wt(R,z),P&&at&&Et.rejoin(),_.push(Et.result())),Rt.point=Ot,at&&Ct.lineEnd()},polygonStart:function(){Ct=Et,_=[],E=[],ct=!0},polygonEnd:function(){var jt=function(){for(var fe=0,se=0,he=E.length;se<he;++se)for(var _e,Ve,gn=E[se],$n=1,Gn=gn.length,qe=gn[0],tr=qe[0],er=qe[1];$n<Gn;++$n)_e=tr,Ve=er,tr=(qe=gn[$n])[0],er=qe[1],Ve<=r?er>r&&(tr-_e)*(r-Ve)>(er-Ve)*(t-_e)&&++fe:er<=r&&(tr-_e)*(r-Ve)<(er-Ve)*(t-_e)&&--fe;return fe}(),Ht=ct&&jt,Vt=(_=wZ(_)).length;(Ht||Vt)&&(b.polygonStart(),Ht&&(b.lineStart(),s(null,null,1,b),b.lineEnd()),Vt&&bZ(_,d,jt,s,b),b.polygonEnd()),Ct=b,_=E=I=null}};function Ot(jt,Ht){a(jt,Ht)&&Ct.point(jt,Ht)}function Wt(jt,Ht){var Vt=a(jt,Ht);if(E&&I.push([jt,Ht]),dt)R=jt,z=Ht,P=Vt,dt=!1,Vt&&(Ct.lineStart(),Ct.point(jt,Ht));else if(Vt&&at)Ct.point(jt,Ht);else{var fe=[rt=Math.max(cI,Math.min(lI,rt)),ot=Math.max(cI,Math.min(lI,ot))],se=[jt=Math.max(cI,Math.min(lI,jt)),Ht=Math.max(cI,Math.min(lI,Ht))];(function(he,_e,Ve,gn,$n,Gn){var qe,tr=he[0],er=he[1],An=0,dn=1,nr=_e[0]-tr,Qn=_e[1]-er;if(qe=Ve-tr,nr||!(qe>0)){if(qe/=nr,nr<0){if(qe<An)return;qe<dn&&(dn=qe)}else if(nr>0){if(qe>dn)return;qe>An&&(An=qe)}if(qe=$n-tr,nr||!(qe<0)){if(qe/=nr,nr<0){if(qe>dn)return;qe>An&&(An=qe)}else if(nr>0){if(qe<An)return;qe<dn&&(dn=qe)}if(qe=gn-er,Qn||!(qe>0)){if(qe/=Qn,Qn<0){if(qe<An)return;qe<dn&&(dn=qe)}else if(Qn>0){if(qe>dn)return;qe>An&&(An=qe)}if(qe=Gn-er,Qn||!(qe<0)){if(qe/=Qn,Qn<0){if(qe>dn)return;qe>An&&(An=qe)}else if(Qn>0){if(qe<An)return;qe<dn&&(dn=qe)}return An>0&&(he[0]=tr+An*nr,he[1]=er+An*Qn),dn<1&&(_e[0]=tr+dn*nr,_e[1]=er+dn*Qn),!0}}}}})(fe,se,t,e,n,r)?(at||(Ct.lineStart(),Ct.point(fe[0],fe[1])),Ct.point(se[0],se[1]),Vt||Ct.lineEnd(),ct=!1):Vt&&(Ct.lineStart(),Ct.point(jt,Ht),ct=!1)}rt=jt,ot=Ht,at=Vt}return Rt}}function V$(t,e){function n(r,a){return r=t(r,a),e(r[0],r[1])}return t.invert&&e.invert&&(n.invert=function(r,a){return(r=e.invert(r,a))&&t.invert(r[0],r[1])}),n}let _Z=t=>t;function G$(t,e){return rl(t)>Lo&&(t-=Math.round(t/Ud)*Ud),[t,e]}function hdt(t,e,n){return(t%=Ud)?e||n?V$(EZ(t),TZ(e,n)):EZ(t):e||n?TZ(e,n):G$}function CZ(t){return function(e,n){return rl(e+=t)>Lo&&(e-=Math.round(e/Ud)*Ud),[e,n]}}function EZ(t){var e=CZ(t);return e.invert=CZ(-t),e}function TZ(t,e){var n=il(t),r=gl(t),a=il(e),s=gl(e);function h(d,g){var b=il(g),_=il(d)*b,E=gl(d)*b,I=gl(g),R=I*n+_*r;return[M_(E*a-R*s,_*n-I*r),D_(R*a+E*s)]}return h.invert=function(d,g){var b=il(g),_=il(d)*b,E=gl(d)*b,I=gl(g),R=I*a-E*s;return[M_(E*a+I*s,_*n+R*r),D_(R*n-_*r)]},h}function R_(t){return function(e){var n=new H$;for(var r in t)n[r]=t[r];return n.stream=e,n}}function H$(){}function hI(t,e){t&&IZ.hasOwnProperty(t.type)&&IZ[t.type](t,e)}G$.invert=G$,H$.prototype={constructor:H$,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var AZ={Feature:function(t,e){hI(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,a=n.length;++r<a;)hI(n[r].geometry,e)}},IZ={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){Y$(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)Y$(n[r],e,0)},Polygon:function(t,e){NZ(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)NZ(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,a=n.length;++r<a;)hI(n[r],e)}};function Y$(t,e,n){var r,a=-1,s=t.length-n;for(e.lineStart();++a<s;)r=t[a],e.point(r[0],r[1],r[2]);e.lineEnd()}function NZ(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)Y$(t[n],e,1);e.polygonEnd()}var Lx=1/0,dI=Lx,F_=-Lx,fI=F_,ddt={point:function(t,e){t<Lx&&(Lx=t),t>F_&&(F_=t),e<dI&&(dI=e),e>fI&&(fI=e)},lineStart:N_,lineEnd:N_,polygonStart:N_,polygonEnd:N_,result:function(){var t=[[Lx,dI],[F_,fI]];return F_=fI=-(dI=Lx=1/0),t}};let MZ=ddt;function q$(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),r!=null&&t.clipExtent(null),function(a,s){a&&AZ.hasOwnProperty(a.type)?AZ[a.type](a,s):hI(a,s)}(n,t.stream(MZ)),e(MZ.result()),r!=null&&t.clipExtent(r),t}function DZ(t,e,n){return q$(t,function(r){var a=e[1][0]-e[0][0],s=e[1][1]-e[0][1],h=Math.min(a/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),d=+e[0][0]+(a-h*(r[1][0]+r[0][0]))/2,g=+e[0][1]+(s-h*(r[1][1]+r[0][1]))/2;t.scale(150*h).translate([d,g])},n)}var fdt=il(30*_f);function RZ(t,e){return+e?function(n,r){function a(s,h,d,g,b,_,E,I,R,z,P,rt,ot,at){var dt=E-s,ct=I-h,Ct=dt*dt+ct*ct;if(Ct>4*r&&ot--){var Et=g+z,Rt=b+P,Ot=_+rt,Wt=rI(Et*Et+Rt*Rt+Ot*Ot),jt=D_(Ot/=Wt),Ht=rl(rl(Ot)-1)<_u||rl(d-R)<_u?(d+R)/2:M_(Rt,Et),Vt=n(Ht,jt),fe=Vt[0],se=Vt[1],he=fe-s,_e=se-h,Ve=ct*he-dt*_e;(Ve*Ve/Ct>r||rl((dt*he+ct*_e)/Ct-.5)>.3||g*z+b*P+_*rt<fdt)&&(a(s,h,d,g,b,_,fe,se,Ht,Et/=Wt,Rt/=Wt,Ot,ot,at),at.point(fe,se),a(fe,se,Ht,Et,Rt,Ot,E,I,R,z,P,rt,ot,at))}}return function(s){var h,d,g,b,_,E,I,R,z,P,rt,ot,at={point:dt,lineStart:ct,lineEnd:Et,polygonStart:function(){s.polygonStart(),at.lineStart=Rt},polygonEnd:function(){s.polygonEnd(),at.lineStart=ct}};function dt(jt,Ht){jt=n(jt,Ht),s.point(jt[0],jt[1])}function ct(){R=NaN,at.point=Ct,s.lineStart()}function Ct(jt,Ht){var Vt=Ox([jt,Ht]),fe=n(jt,Ht);a(R,z,I,P,rt,ot,R=fe[0],z=fe[1],I=jt,P=Vt[0],rt=Vt[1],ot=Vt[2],16,s),s.point(R,z)}function Et(){at.point=dt,s.lineEnd()}function Rt(){ct(),at.point=Ot,at.lineEnd=Wt}function Ot(jt,Ht){Ct(h=jt,Ht),d=R,g=z,b=P,_=rt,E=ot,at.point=Ct}function Wt(){a(R,z,I,P,rt,ot,d,g,h,b,_,E,16,s),at.lineEnd=Et,Et()}return at}}(t,e):function(n){return R_({point:function(r,a){r=n(r,a),this.stream.point(r[0],r[1])}})}(t)}var pdt=R_({point:function(t,e){this.stream.point(t*_f,e*_f)}});function FZ(t,e,n,r,a,s){if(!s)return function(P,rt,ot,at,dt){function ct(Ct,Et){return[rt+P*(Ct*=at),ot-P*(Et*=dt)]}return ct.invert=function(Ct,Et){return[(Ct-rt)/P*at,(ot-Et)/P*dt]},ct}(t,e,n,r,a);var h=il(s),d=gl(s),g=h*t,b=d*t,_=h/t,E=d/t,I=(d*n-h*e)/t,R=(d*e+h*n)/t;function z(P,rt){return[g*(P*=r)-b*(rt*=a)+e,n-b*P-g*rt]}return z.invert=function(P,rt){return[r*(_*P-E*rt+I),a*(R-E*P-_*rt)]},z}function mdt(t){return function(e){var n,r,a,s,h,d,g,b,_,E,I=150,R=480,z=250,P=0,rt=0,ot=0,at=0,dt=0,ct=0,Ct=1,Et=1,Rt=null,Ot=kZ,Wt=null,jt=_Z,Ht=.5;function Vt(_e){return b(_e[0]*_f,_e[1]*_f)}function fe(_e){return(_e=b.invert(_e[0],_e[1]))&&[_e[0]*e1,_e[1]*e1]}function se(){var _e=FZ(I,0,0,Ct,Et,ct).apply(null,n(P,rt)),Ve=FZ(I,R-_e[0],z-_e[1],Ct,Et,ct);return r=hdt(ot,at,dt),g=V$(n,Ve),b=V$(r,g),d=RZ(g,Ht),he()}function he(){return _=E=null,Vt}return Vt.stream=function(_e){return _&&E===_e?_:_=pdt(function(Ve){return R_({point:function(gn,$n){var Gn=Ve(gn,$n);return this.stream.point(Gn[0],Gn[1])}})}(r)(Ot(d(jt(E=_e)))))},Vt.preclip=function(_e){return arguments.length?(Ot=_e,Rt=void 0,he()):Ot},Vt.postclip=function(_e){return arguments.length?(jt=_e,Wt=a=s=h=null,he()):jt},Vt.clipAngle=function(_e){return arguments.length?(Ot=+_e?function(Ve){var gn=il(Ve),$n=2*_f,Gn=gn>0,qe=rl(gn)>_u;function tr(dn,nr){return il(dn)*il(nr)>gn}function er(dn,nr,Qn){var wr=[1,0,0],yi=sI(Ox(dn),Ox(nr)),ha=oI(yi,yi),mi=yi[0],si=ha-mi*mi;if(!si)return!Qn&&dn;var Ei=gn*ha/si,ki=-gn*mi/si,Xi=sI(wr,yi),Fi=uI(wr,Ei);j$(Fi,uI(yi,ki));var Go=Xi,gd=oI(Fi,Go),Uh=oI(Go,Go),rc=gd*gd-Uh*(oI(Fi,Fi)-1);if(!(rc<0)){var Do=rI(rc),us=uI(Go,(-gd-Do)/Uh);if(j$(us,Fi),us=B$(us),!Qn)return us;var Io,ou=dn[0],uh=nr[0],Ac=dn[1],Zp=nr[1];uh<ou&&(Io=ou,ou=uh,uh=Io);var G1=uh-ou,W3=rl(G1-Lo)<_u;if(!W3&&Zp<Ac&&(Io=Ac,Ac=Zp,Zp=Io),W3||G1<_u?W3?Ac+Zp>0^us[1]<(rl(us[0]-ou)<_u?Ac:Zp):Ac<=us[1]&&us[1]<=Zp:G1>Lo^(ou<=us[0]&&us[0]<=uh)){var INt=uI(Go,(-gd+Do)/Uh);return j$(INt,Fi),[us,B$(INt)]}}}function An(dn,nr){var Qn=Gn?Ve:Lo-Ve,wr=0;return dn<-Qn?wr|=1:dn>Qn&&(wr|=2),nr<-Qn?wr|=4:nr>Qn&&(wr|=8),wr}return xZ(tr,function(dn){var nr,Qn,wr,yi,ha;return{lineStart:function(){yi=wr=!1,ha=1},point:function(mi,si){var Ei,ki=[mi,si],Xi=tr(mi,si),Fi=Gn?Xi?0:An(mi,si):Xi?An(mi+(mi<0?Lo:-Lo),si):0;if(!nr&&(yi=wr=Xi)&&dn.lineStart(),Xi!==wr&&(!(Ei=er(nr,ki))||iI(nr,Ei)||iI(ki,Ei))&&(ki[2]=1),Xi!==wr)ha=0,Xi?(dn.lineStart(),Ei=er(ki,nr),dn.point(Ei[0],Ei[1])):(Ei=er(nr,ki),dn.point(Ei[0],Ei[1],2),dn.lineEnd()),nr=Ei;else if(qe&&nr&&Gn^Xi){var Go;Fi&Qn||!(Go=er(ki,nr,!0))||(ha=0,Gn?(dn.lineStart(),dn.point(Go[0][0],Go[0][1]),dn.point(Go[1][0],Go[1][1]),dn.lineEnd()):(dn.point(Go[1][0],Go[1][1]),dn.lineEnd(),dn.lineStart(),dn.point(Go[0][0],Go[0][1],3)))}!Xi||nr&&iI(nr,ki)||dn.point(ki[0],ki[1]),nr=ki,wr=Xi,Qn=Fi},lineEnd:function(){wr&&dn.lineEnd(),nr=null},clean:function(){return ha|(yi&&wr)<<1}}},function(dn,nr,Qn,wr){ldt(wr,Ve,$n,Qn,dn,nr)},Gn?[0,-Ve]:[-Lo,Ve-Lo])}(Rt=_e*_f):(Rt=null,kZ),he()):Rt*e1},Vt.clipExtent=function(_e){return arguments.length?(jt=_e==null?(Wt=a=s=h=null,_Z):cdt(Wt=+_e[0][0],a=+_e[0][1],s=+_e[1][0],h=+_e[1][1]),he()):Wt==null?null:[[Wt,a],[s,h]]},Vt.scale=function(_e){return arguments.length?(I=+_e,se()):I},Vt.translate=function(_e){return arguments.length?(R=+_e[0],z=+_e[1],se()):[R,z]},Vt.center=function(_e){return arguments.length?(P=_e[0]%360*_f,rt=_e[1]%360*_f,se()):[P*e1,rt*e1]},Vt.rotate=function(_e){return arguments.length?(ot=_e[0]%360*_f,at=_e[1]%360*_f,dt=_e.length>2?_e[2]%360*_f:0,se()):[ot*e1,at*e1,dt*e1]},Vt.angle=function(_e){return arguments.length?(ct=_e%360*_f,se()):ct*e1},Vt.reflectX=function(_e){return arguments.length?(Ct=_e?-1:1,se()):Ct<0},Vt.reflectY=function(_e){return arguments.length?(Et=_e?-1:1,se()):Et<0},Vt.precision=function(_e){return arguments.length?(d=RZ(g,Ht=_e*_e),he()):rI(Ht)},Vt.fitExtent=function(_e,Ve){return DZ(Vt,_e,Ve)},Vt.fitSize=function(_e,Ve){return function(gn,$n,Gn){return DZ(gn,[[0,0],$n],Gn)}(Vt,_e,Ve)},Vt.fitWidth=function(_e,Ve){return function(gn,$n,Gn){return q$(gn,function(qe){var tr=+$n,er=tr/(qe[1][0]-qe[0][0]),An=(tr-er*(qe[1][0]+qe[0][0]))/2,dn=-er*qe[0][1];gn.scale(150*er).translate([An,dn])},Gn)}(Vt,_e,Ve)},Vt.fitHeight=function(_e,Ve){return function(gn,$n,Gn){return q$(gn,function(qe){var tr=+$n,er=tr/(qe[1][1]-qe[0][1]),An=-er*qe[0][0],dn=(tr-er*(qe[1][1]+qe[0][1]))/2;gn.scale(150*er).translate([An,dn])},Gn)}(Vt,_e,Ve)},function(){return n=e.apply(this,arguments),Vt.invert=n.invert&&fe,se()}}(function(){return t})()}var gdt=Math.abs,X$=Math.cos,pI=Math.sin,OZ=Math.PI,K$=OZ/2,LZ=ydt(2);function Z$(t){return t>1?K$:t<-1?-K$:Math.asin(t)}function ydt(t){return t>0?Math.sqrt(t):0}function vdt(t,e){var n,r=t*pI(e),a=30;do e-=n=(e+pI(e)-r)/(1+X$(e));while(gdt(n)>1e-6&&--a>0);return e/2}var bdt=function(t,e,n){function r(a,s){return[t*a*X$(s=vdt(n,s)),e*pI(s)]}return r.invert=function(a,s){return s=Z$(s/e),[a/(t*X$(s)),Z$((2*s+pI(2*s))/n)]},r}(LZ/K$,LZ,OZ);let wdt=WK(),mI=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function $Z(t,e){if(!t||typeof t!="string")throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(gI[t]=function(n,r){return function a(){let s=r();return s.type=n,s.path=WK().projection(s),s.copy=s.copy||function(){let h=a();return mI.forEach(d=>{s[d]&&h[d](s[d]())}),h.path.pointRadius(s.path.pointRadius()),h},Eq(s)}}(t,e),this):gI[t]||null}function zZ(t){return t&&t.path||wdt}let gI={albers:aZ,albersusa:function(){var t,e,n,r,a,s,h=aZ(),d=JA().rotate([154,0]).center([-2,58.5]).parallels([55,65]),g=JA().rotate([157,0]).center([-3,19.9]).parallels([8,18]),b={point:function(I,R){s=[I,R]}};function _(I){var R=I[0],z=I[1];return s=null,n.point(R,z),s||(r.point(R,z),s)||(a.point(R,z),s)}function E(){return t=e=null,_}return _.invert=function(I){var R=h.scale(),z=h.translate(),P=(I[0]-z[0])/R,rt=(I[1]-z[1])/R;return(rt>=.12&&rt<.234&&P>=-.425&&P<-.214?d:rt>=.166&&rt<.234&&P>=-.214&&P<-.115?g:h).invert(I)},_.stream=function(I){return t&&e===I?t:t=function(R){var z=R.length;return{point:function(P,rt){for(var ot=-1;++ot<z;)R[ot].point(P,rt)},sphere:function(){for(var P=-1;++P<z;)R[P].sphere()},lineStart:function(){for(var P=-1;++P<z;)R[P].lineStart()},lineEnd:function(){for(var P=-1;++P<z;)R[P].lineEnd()},polygonStart:function(){for(var P=-1;++P<z;)R[P].polygonStart()},polygonEnd:function(){for(var P=-1;++P<z;)R[P].polygonEnd()}}}([h.stream(e=I),d.stream(I),g.stream(I)])},_.precision=function(I){return arguments.length?(h.precision(I),d.precision(I),g.precision(I),E()):h.precision()},_.scale=function(I){return arguments.length?(h.scale(I),d.scale(.35*I),g.scale(I),_.translate(h.translate())):h.scale()},_.translate=function(I){if(!arguments.length)return h.translate();var R=h.scale(),z=+I[0],P=+I[1];return n=h.translate(I).clipExtent([[z-.455*R,P-.238*R],[z+.455*R,P+.238*R]]).stream(b),r=d.translate([z-.307*R,P+.201*R]).clipExtent([[z-.425*R+ao,P+.12*R+ao],[z-.214*R-ao,P+.234*R-ao]]).stream(b),a=g.translate([z-.205*R,P+.212*R]).clipExtent([[z-.214*R+ao,P+.166*R+ao],[z-.115*R-ao,P+.234*R-ao]]).stream(b),E()},_.fitExtent=function(I,R){return ZA(_,I,R)},_.fitSize=function(I,R){return L$(_,I,R)},_.fitWidth=function(I,R){return QA(_,I,R)},_.fitHeight=function(I,R){return $$(_,I,R)},_.scale(1070)},azimuthalequalarea:function(){return t1(sZ).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return t1(uZ).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return z$(rdt).scale(109.5).parallels([30,30])},conicequalarea:JA,conicequidistant:function(){return z$(cZ).scale(131.154).center([0,13.9389])},equalEarth:function(){return t1(hZ).scale(177.158)},equirectangular:function(){return t1(nI).scale(152.63)},gnomonic:function(){return t1(dZ).scale(144.049).clipAngle(60)},identity:function(){var t,e,n,r,a,s,h,d=1,g=0,b=0,_=1,E=1,I=0,R=null,z=1,P=1,rt=KA({point:function(ct,Ct){var Et=dt([ct,Ct]);this.stream.point(Et[0],Et[1])}}),ot=Y2;function at(){return z=d*_,P=d*E,s=h=null,dt}function dt(ct){var Ct=ct[0]*z,Et=ct[1]*P;if(I){var Rt=Et*t-Ct*e;Ct=Ct*t+Et*e,Et=Rt}return[Ct+g,Et+b]}return dt.invert=function(ct){var Ct=ct[0]-g,Et=ct[1]-b;if(I){var Rt=Et*t+Ct*e;Ct=Ct*t-Et*e,Et=Rt}return[Ct/z,Et/P]},dt.stream=function(ct){return s&&h===ct?s:s=rt(ot(h=ct))},dt.postclip=function(ct){return arguments.length?(ot=ct,R=n=r=a=null,at()):ot},dt.clipExtent=function(ct){return arguments.length?(ot=ct==null?(R=n=r=a=null,Y2):ZK(R=+ct[0][0],n=+ct[0][1],r=+ct[1][0],a=+ct[1][1]),at()):R==null?null:[[R,n],[r,a]]},dt.scale=function(ct){return arguments.length?(d=+ct,at()):d},dt.translate=function(ct){return arguments.length?(g=+ct[0],b=+ct[1],at()):[g,b]},dt.angle=function(ct){return arguments.length?(e=qa(I=ct%360*ju),t=oo(I),at()):I*kh},dt.reflectX=function(ct){return arguments.length?(_=ct?-1:1,at()):_<0},dt.reflectY=function(ct){return arguments.length?(E=ct?-1:1,at()):E<0},dt.fitExtent=function(ct,Ct){return ZA(dt,ct,Ct)},dt.fitSize=function(ct,Ct){return L$(dt,ct,Ct)},dt.fitWidth=function(ct,Ct){return QA(dt,ct,Ct)},dt.fitHeight=function(ct,Ct){return $$(dt,ct,Ct)},dt},mercator:function(){return lZ(tI).scale(961/Bd)},mollweide:function(){return mdt(bdt).scale(169.529)},naturalEarth1:function(){return t1(fZ).scale(175.295)},orthographic:function(){return t1(pZ).scale(249.5).clipAngle(90.000001)},stereographic:function(){return t1(mZ).scale(250).clipAngle(142)},transversemercator:function(){var t=lZ(gZ),e=t.center,n=t.rotate;return t.center=function(r){return arguments.length?e([-r[1],r[0]]):[(r=e())[1],-r[0]]},t.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):[(r=n())[0],r[1],r[2]-90]},n([0,0,90]).scale(159.155)}};for(let t in gI)$Z(t,gI[t]);var ba=1e-6,Q$=1e-12,co=Math.PI,al=co/2,yI=co/4,rd=2*co,yl=180/co,ho=co/180,No=Math.abs,$x=Math.atan,Sp=Math.atan2,ga=Math.cos,O_=Math.ceil,PZ=Math.exp,J$=Math.hypot,vI=Math.log,n1=Math.pow,ia=Math.sin,_p=Math.sign||function(t){return t>0?1:t<0?-1:0},id=Math.sqrt,tz=Math.tan;function BZ(t){return t>1?0:t<-1?co:Math.acos(t)}function Wd(t){return t>1?al:t<-1?-al:Math.asin(t)}function jZ(t,e,n){var r=wf(t,e-ba,n).concat(e);return function(a){return r.map(function(s){return[a,s]})}}function UZ(t,e,n){var r=wf(t,e-ba,n).concat(e);return function(a){return r.map(function(s){return[s,a]})}}function xdt(){var t,e,n,r,a,s,h,d,g,b,_,E,I=10,R=I,z=90,P=360,rt=2.5;function ot(){return{type:"MultiLineString",coordinates:at()}}function at(){return wf(O_(r/z)*z,n,z).map(_).concat(wf(O_(d/P)*P,h,P).map(E)).concat(wf(O_(e/I)*I,t,I).filter(function(dt){return No(dt%z)>ba}).map(g)).concat(wf(O_(s/R)*R,a,R).filter(function(dt){return No(dt%P)>ba}).map(b))}return ot.lines=function(){return at().map(function(dt){return{type:"LineString",coordinates:dt}})},ot.outline=function(){return{type:"Polygon",coordinates:[_(r).concat(E(h).slice(1),_(n).reverse().slice(1),E(d).reverse().slice(1))]}},ot.extent=function(dt){return arguments.length?ot.extentMajor(dt).extentMinor(dt):ot.extentMinor()},ot.extentMajor=function(dt){return arguments.length?(r=+dt[0][0],n=+dt[1][0],d=+dt[0][1],h=+dt[1][1],r>n&&(dt=r,r=n,n=dt),d>h&&(dt=d,d=h,h=dt),ot.precision(rt)):[[r,d],[n,h]]},ot.extentMinor=function(dt){return arguments.length?(e=+dt[0][0],t=+dt[1][0],s=+dt[0][1],a=+dt[1][1],e>t&&(dt=e,e=t,t=dt),s>a&&(dt=s,s=a,a=dt),ot.precision(rt)):[[e,s],[t,a]]},ot.step=function(dt){return arguments.length?ot.stepMajor(dt).stepMinor(dt):ot.stepMinor()},ot.stepMajor=function(dt){return arguments.length?(z=+dt[0],P=+dt[1],ot):[z,P]},ot.stepMinor=function(dt){return arguments.length?(I=+dt[0],R=+dt[1],ot):[I,R]},ot.precision=function(dt){return arguments.length?(rt=+dt,g=jZ(s,a,90),b=UZ(e,t,rt),_=jZ(d,h,90),E=UZ(r,n,rt),ot):rt},ot.extentMajor([[-180,-90+ba],[180,90-ba]]).extentMinor([[-180,-80-ba],[180,80+ba]])}function kdt(){}let Ws=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function zx(){var t=1,e=1,n=h;function r(d,g){return g.map(b=>a(d,b))}function a(d,g){var b=[],_=[];return function(E,I,R){var z,P,rt,ot,at,dt,ct=new Array,Ct=new Array;for(z=P=-1,ot=E[0]>=I,Ws[ot<<1].forEach(Et);++z<t-1;)rt=ot,ot=E[z+1]>=I,Ws[rt|ot<<1].forEach(Et);for(Ws[ot|0].forEach(Et);++P<e-1;){for(z=-1,ot=E[P*t+t]>=I,at=E[P*t]>=I,Ws[ot<<1|at<<2].forEach(Et);++z<t-1;)rt=ot,ot=E[P*t+t+z+1]>=I,dt=at,at=E[P*t+z+1]>=I,Ws[rt|ot<<1|at<<2|dt<<3].forEach(Et);Ws[ot|at<<3].forEach(Et)}for(z=-1,at=E[P*t]>=I,Ws[at<<2].forEach(Et);++z<t-1;)dt=at,at=E[P*t+z+1]>=I,Ws[at<<2|dt<<3].forEach(Et);function Et(Rt){var Ot,Wt,jt=[Rt[0][0]+z,Rt[0][1]+P],Ht=[Rt[1][0]+z,Rt[1][1]+P],Vt=s(jt),fe=s(Ht);(Ot=Ct[Vt])?(Wt=ct[fe])?(delete Ct[Ot.end],delete ct[Wt.start],Ot===Wt?(Ot.ring.push(Ht),R(Ot.ring)):ct[Ot.start]=Ct[Wt.end]={start:Ot.start,end:Wt.end,ring:Ot.ring.concat(Wt.ring)}):(delete Ct[Ot.end],Ot.ring.push(Ht),Ct[Ot.end=fe]=Ot):(Ot=ct[fe])?(Wt=Ct[Vt])?(delete ct[Ot.start],delete Ct[Wt.end],Ot===Wt?(Ot.ring.push(Ht),R(Ot.ring)):ct[Wt.start]=Ct[Ot.end]={start:Wt.start,end:Ot.end,ring:Wt.ring.concat(Ot.ring)}):(delete ct[Ot.start],Ot.ring.unshift(jt),ct[Ot.start=Vt]=Ot):ct[Vt]=Ct[fe]={start:Vt,end:fe,ring:[jt,Ht]}}Ws[at<<3].forEach(Et)}(d,g,E=>{n(E,d,g),function(I){for(var R=0,z=I.length,P=I[z-1][1]*I[0][0]-I[z-1][0]*I[0][1];++R<z;)P+=I[R-1][1]*I[R][0]-I[R-1][0]*I[R][1];return P}(E)>0?b.push([E]):_.push(E)}),_.forEach(E=>{for(var I,R=0,z=b.length;R<z;++R)if(WZ((I=b[R])[0],E)!==-1)return void I.push(E)}),{type:"MultiPolygon",value:g,coordinates:b}}function s(d){return 2*d[0]+d[1]*(t+1)*4}function h(d,g,b){d.forEach(_=>{var E,I=_[0],R=_[1],z=0|I,P=0|R,rt=g[P*t+z];I>0&&I<t&&z===I&&(E=g[P*t+z-1],_[0]=I+(b-E)/(rt-E)-.5),R>0&&R<e&&P===R&&(E=g[(P-1)*t+z],_[1]=R+(b-E)/(rt-E)-.5)})}return r.contour=a,r.size=function(d){if(!arguments.length)return[t,e];var g=Math.floor(d[0]),b=Math.floor(d[1]);return g>=0&&b>=0||Dn("invalid size"),t=g,e=b,r},r.smooth=function(d){return arguments.length?(n=d?h:kdt,r):n===h},r}function WZ(t,e){for(var n,r=-1,a=e.length;++r<a;)if(n=VZ(t,e[r]))return n;return 0}function VZ(t,e){for(var n=e[0],r=e[1],a=-1,s=0,h=t.length,d=h-1;s<h;d=s++){var g=t[s],b=g[0],_=g[1],E=t[d],I=E[0],R=E[1];if(GZ(g,E,e))return 0;_>r!=R>r&&n<(I-b)*(r-_)/(R-_)+b&&(a=-a)}return a}function GZ(t,e,n){var r,a,s,h;return function(d,g,b){return(g[0]-d[0])*(b[1]-d[1])==(b[0]-d[0])*(g[1]-d[1])}(t,e,n)&&(a=t[r=+(t[0]===e[0])],s=n[r],h=e[r],a<=s&&s<=h||h<=s&&s<=a)}function L_(t,e,n){return function(r){var a=un(r),s=n?Math.min(a[0],0):a[0],h=a[1],d=h-s,g=e?H2(s,h,t):d/(t+1);return wf(s+g,h,g)}}function Px(t){ar.call(this,null,t)}function ez(t,e,n,r,a){let s=t.x1||0,h=t.y1||0,d=e*n<0;function g(E){E.forEach(b)}function b(E){d&&E.reverse(),E.forEach(_)}function _(E){E[0]=(E[0]-s)*e+r,E[1]=(E[1]-h)*n+a}return function(E){return E.coordinates.forEach(g),E}}function HZ(t,e,n){let r=t>=0?t:Lw(e,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function Uu(t){return ut(t)?t:Ke(+t)}function nz(){var t=g=>g[0],e=g=>g[1],n=io,r=[-1,-1],a=960,s=500,h=2;function d(g,b){let _=HZ(r[0],g,t)>>h,E=HZ(r[1],g,e)>>h,I=_?_+2:0,R=E?E+2:0,z=2*I+(a>>h),P=2*R+(s>>h),rt=new Float32Array(z*P),ot=new Float32Array(z*P),at=rt;g.forEach(ct=>{let Ct=I+(+t(ct)>>h),Et=R+(+e(ct)>>h);Ct>=0&&Ct<z&&Et>=0&&Et<P&&(rt[Ct+Et*z]+=+n(ct))}),_>0&&E>0?(r1(z,P,rt,ot,_),Bx(z,P,ot,rt,E),r1(z,P,rt,ot,_),Bx(z,P,ot,rt,E),r1(z,P,rt,ot,_),Bx(z,P,ot,rt,E)):_>0?(r1(z,P,rt,ot,_),r1(z,P,ot,rt,_),r1(z,P,rt,ot,_),at=ot):E>0&&(Bx(z,P,rt,ot,E),Bx(z,P,ot,rt,E),Bx(z,P,rt,ot,E),at=ot);let dt=b?Math.pow(2,-2*h):1/fb(at);for(let ct=0,Ct=z*P;ct<Ct;++ct)at[ct]*=dt;return{values:at,scale:1<<h,width:z,height:P,x1:I,y1:R,x2:I+(a>>h),y2:R+(s>>h)}}return d.x=function(g){return arguments.length?(t=Uu(g),d):t},d.y=function(g){return arguments.length?(e=Uu(g),d):e},d.weight=function(g){return arguments.length?(n=Uu(g),d):n},d.size=function(g){if(!arguments.length)return[a,s];var b=+g[0],_=+g[1];return b>=0&&_>=0||Dn("invalid size"),a=b,s=_,d},d.cellSize=function(g){return arguments.length?((g=+g)>=1||Dn("invalid cell size"),h=Math.floor(Math.log(g)/Math.LN2),d):1<<h},d.bandwidth=function(g){return arguments.length?((g=et(g)).length===1&&(g=[+g[0],+g[0]]),g.length!==2&&Dn("invalid bandwidth"),r=g,d):r},d}function r1(t,e,n,r,a){let s=1+(a<<1);for(let h=0;h<e;++h)for(let d=0,g=0;d<t+a;++d)d<t&&(g+=n[d+h*t]),d>=a&&(d>=s&&(g-=n[d-s+h*t]),r[d-a+h*t]=g/Math.min(d+1,t-1+s-d,s))}function Bx(t,e,n,r,a){let s=1+(a<<1);for(let h=0;h<t;++h)for(let d=0,g=0;d<e+a;++d)d<e&&(g+=n[h+d*t]),d>=a&&(d>=s&&(g-=n[h+(d-s)*t]),r[h+(d-a)*t]=g/Math.min(d+1,e-1+s-d,s))}function rz(t){ar.call(this,null,t)}Px.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},ur(Px,ar,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,a=t.field||Po,s=zx().smooth(t.smooth!==!1),h=t.thresholds||function(b,_,E){let I=L_(E.levels||10,E.nice,E.zero!==!1);return E.resolve!=="shared"?I:I(b.map(R=>Dv(_(R).values)))}(r,a,t),d=t.as===null?null:t.as||"contour",g=[];return r.forEach(b=>{let _=a(b),E=s.size([_.width,_.height])(_.values,ni(h)?h:h(_.values));(function(I,R,z,P){let rt=P.scale||R.scale,ot=P.translate||R.translate;if(ut(rt)&&(rt=rt(z,P)),ut(ot)&&(ot=ot(z,P)),(rt===1||rt==null)&&!ot)return;let at=(Lr(rt)?rt:rt[0])||1,dt=(Lr(rt)?rt:rt[1])||1,ct=ot&&ot[0]||0,Ct=ot&&ot[1]||0;I.forEach(ez(R,at,dt,ct,Ct))})(E,_,b,t),E.forEach(I=>{g.push(fE(b,Jo(d!=null?{[d]:I}:I)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=g,n}}),rz.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};let iz=["x","y","weight","size","cellSize","bandwidth"];function E0(t,e){return iz.forEach(n=>e[n]!=null?t[n](e[n]):0),t}function jx(t){ar.call(this,null,t)}ur(rz,ar,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),a=function(g,b){var _,E,I,R,z,P,rt=[],ot=at=>at(R);if(b==null)rt.push(g);else for(_={},E=0,I=g.length;E<I;++E)R=g[E],(P=_[z=b.map(ot)])||(_[z]=P=[],P.dims=z,rt.push(P)),P.push(R);return rt}(e.materialize(e.SOURCE).source,t.groupby),s=(t.groupby||[]).map(_a),h=E0(nz(),t),d=t.as||"grid";return n=a.map(g=>Jo(function(b,_){for(let E=0;E<s.length;++E)b[s[E]]=_[E];return b}({[d]:h(g,t.counts)},g.dims))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),jx.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},ur(jx,ar,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r,a=e.fork(e.NO_SOURCE|e.NO_FIELDS),s=zx().smooth(t.smooth!==!1),h=t.values,d=t.thresholds||L_(t.count||10,t.nice,!!h),g=t.size;return h||(h=e.materialize(e.SOURCE).source,r=ez(n=E0(nz(),t)(h,!0),n.scale||1,n.scale||1,0,0),g=[n.width,n.height],h=n.values),d=ni(d)?d:d(h),h=s.size(g)(h,d),r&&h.forEach(r),this.value&&(a.rem=this.value),this.value=a.source=a.add=(h||[]).map(Jo),a}});let bI="Feature",az="FeatureCollection";function oz(t){ar.call(this,null,t)}function wI(t){ar.call(this,null,t)}function sz(t){ar.call(this,null,t)}function $_(t){ar.call(this,null,t)}function Ux(t){ar.call(this,[],t),this.generator=xdt()}function z_(t){ar.call(this,null,t)}function Cp(t){if(!ut(t))return!1;let e=zc(Ca(t));return e.$x||e.$y||e.$value||e.$max}function P_(t){ar.call(this,null,t),this.modified(!0)}function xb(t,e,n){ut(t[e])&&t[e](n)}function Wx(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var a,s,h,d,g,b,_,E,I,R=t._root,z={data:r},P=t._x0,rt=t._y0,ot=t._x1,at=t._y1;if(!R)return t._root=z,t;for(;R.length;)if((b=e>=(s=(P+ot)/2))?P=s:ot=s,(_=n>=(h=(rt+at)/2))?rt=h:at=h,a=R,!(R=R[E=_<<1|b]))return a[E]=z,t;if(d=+t._x.call(null,R.data),g=+t._y.call(null,R.data),e===d&&n===g)return z.next=R,a?a[E]=z:t._root=z,t;do a=a?a[E]=new Array(4):t._root=new Array(4),(b=e>=(s=(P+ot)/2))?P=s:ot=s,(_=n>=(h=(rt+at)/2))?rt=h:at=h;while((E=_<<1|b)==(I=(g>=h)<<1|d>=s));return a[I]=R,a[E]=z,t}function Sh(t,e,n,r,a){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=a}function Sdt(t){return t[0]}function Cf(t){return t[1]}function xI(t,e,n){var r=new Vx(e??Sdt,n??Cf,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function Vx(t,e,n,r,a,s){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=a,this._y1=s,this._root=void 0}function B_(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}oz.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},ur(oz,ar,{transform(t,e){var n,r=this._features,a=this._points,s=t.fields,h=s&&s[0],d=s&&s[1],g=t.geojson||!s&&Po,b=e.ADD;n=t.modified()||e.changed(e.REM)||e.modified(Ca(g))||h&&e.modified(Ca(h))||d&&e.modified(Ca(d)),this.value&&!n||(b=e.SOURCE,this._features=r=[],this._points=a=[]),g&&e.visit(b,_=>r.push(g(_))),h&&d&&(e.visit(b,_=>{var E=h(_),I=d(_);E!=null&&I!=null&&(E=+E)===E&&(I=+I)===I&&a.push([E,I])}),r=r.concat({type:bI,geometry:{type:"MultiPoint",coordinates:a}})),this.value={type:az,features:r}}}),wI.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},ur(wI,ar,{transform(t,e){var n=e.fork(e.ALL),r=this.value,a=t.field||Po,s=t.as||"path",h=n.SOURCE;!r||t.modified()?(this.value=r=zZ(t.projection),n.materialize().reflow()):h=a===Po||e.modified(a.fields)?n.ADD_MOD:n.ADD;let d=function(g,b){let _=g.pointRadius();return g.context(null),b!=null&&g.pointRadius(b),_}(r,t.pointRadius);return n.visit(h,g=>g[s]=r(a(g))),r.pointRadius(d),n.modifies(s)}}),sz.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},ur(sz,ar,{transform(t,e){var n,r=t.projection,a=t.fields[0],s=t.fields[1],h=t.as||["x","y"],d=h[0],g=h[1];function b(_){let E=r([a(_),s(_)]);E?(_[d]=E[0],_[g]=E[1]):(_[d]=void 0,_[g]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,b):(n=e.modified(a.fields)||e.modified(s.fields),e.visit(n?e.ADD_MOD:e.ADD,b)),e.modifies(h)}}),$_.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},ur($_,ar,{transform(t,e){var n=e.fork(e.ALL),r=this.value,a=t.as||"shape",s=n.ADD;return r&&!t.modified()||(this.value=r=function(h,d,g){let b=g==null?_=>h(d(_)):_=>{var E=h.pointRadius(),I=h.pointRadius(g)(d(_));return h.pointRadius(E),I};return b.context=_=>(h.context(_),b),b}(zZ(t.projection),t.field||sa("datum"),t.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,h=>h[a]=r),n.modifies(a)}}),Ux.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},ur(Ux,ar,{transform(t,e){var n,r=this.value,a=this.generator;if(!r.length||t.modified())for(let s in t)ut(a[s])&&a[s](t[s]);return n=a(),r.length?e.mod.push(H5(r[0],n)):e.add.push(Jo(n)),r[0]=n,e}}),z_.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},ur(z_,ar,{transform(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var n=e.materialize(e.SOURCE).source,r=t.resolve==="shared",a=t.field||Po,s=function(b,_){let E;return ut(b)?(E=I=>b(I,_),E.dep=Cp(b)):b?E=Ke(b):(E=I=>I.$value/I.$max||0,E.dep=!0),E}(t.opacity,t),h=function(b,_){let E;return ut(b)?(E=I=>V2(b(I,_)),E.dep=Cp(b)):E=Ke(V2(b||"#888")),E}(t.color,t),d=t.as||"image",g={$x:0,$y:0,$value:0,$max:r?Dv(n.map(b=>Dv(a(b).values))):0};return n.forEach(b=>{let _=a(b),E=nn({},b,g);r||(E.$max=Dv(_.values||[])),b[d]=function(I,R,z,P){let rt=I.width,ot=I.height,at=I.x1||0,dt=I.y1||0,ct=I.x2||rt,Ct=I.y2||ot,Et=I.values,Rt=Et?Vt=>Et[Vt]:ku,Ot=lp(ct-at,Ct-dt),Wt=Ot.getContext("2d"),jt=Wt.getImageData(0,0,ct-at,Ct-dt),Ht=jt.data;for(let Vt=dt,fe=0;Vt<Ct;++Vt){R.$y=Vt-dt;for(let se=at,he=Vt*rt;se<ct;++se,fe+=4){R.$x=se-at,R.$value=Rt(se+he);let _e=z(R);Ht[fe+0]=_e.r,Ht[fe+1]=_e.g,Ht[fe+2]=_e.b,Ht[fe+3]=~~(255*P(R))}}return Wt.putImageData(jt,0,0),Ot}(_,E,h.dep?h:Ke(h(E)),s.dep?s:Ke(s(E)))}),e.reflow(!0).modifies(d)}}),ur(P_,ar,{transform(t,e){let n=this.value;return!n||t.modified("type")?(this.value=n=function(r){let a=$Z((r||"mercator").toLowerCase());return a||Dn("Unrecognized projection type: "+r),a()}(t.type),mI.forEach(r=>{t[r]!=null&&xb(n,r,t[r])})):mI.forEach(r=>{t.modified(r)&&xb(n,r,t[r])}),t.pointRadius!=null&&n.path.pointRadius(t.pointRadius),t.fit&&function(r,a){let s=function(h){return h=et(h),h.length===1?h[0]:{type:az,features:h.reduce((d,g)=>d.concat(function(b){return b.type===az?b.features:et(b).filter(_=>_!=null).map(_=>_.type===bI?_:{type:bI,geometry:_})}(g)),[])}}(a.fit);a.extent?r.fitExtent(a.extent,s):a.size&&r.fitSize(a.size,s)}(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});var ad=xI.prototype=Vx.prototype;function od(t){return function(){return t}}function q2(t){return 1e-6*(t()-.5)}function _dt(t){return t.x+t.vx}function Cdt(t){return t.y+t.vy}ad.copy=function(){var t,e,n=new Vx(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=B_(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var a=0;a<4;++a)(e=r.source[a])&&(e.length?t.push({source:e,target:r.target[a]=new Array(4)}):r.target[a]=B_(e));return n},ad.add=function(t){let e=+this._x.call(null,t),n=+this._y.call(null,t);return Wx(this.cover(e,n),e,n,t)},ad.addAll=function(t){var e,n,r,a,s=t.length,h=new Array(s),d=new Array(s),g=1/0,b=1/0,_=-1/0,E=-1/0;for(n=0;n<s;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e))||(h[n]=r,d[n]=a,r<g&&(g=r),r>_&&(_=r),a<b&&(b=a),a>E&&(E=a));if(g>_||b>E)return this;for(this.cover(g,b).cover(_,E),n=0;n<s;++n)Wx(this,h[n],d[n],t[n]);return this},ad.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,a=this._x1,s=this._y1;if(isNaN(n))a=(n=Math.floor(t))+1,s=(r=Math.floor(e))+1;else{for(var h,d,g=a-n||1,b=this._root;n>t||t>=a||r>e||e>=s;)switch(d=(e<r)<<1|t<n,(h=new Array(4))[d]=b,b=h,g*=2,d){case 0:a=n+g,s=r+g;break;case 1:n=a-g,s=r+g;break;case 2:a=n+g,r=s-g;break;case 3:n=a-g,r=s-g}this._root&&this._root.length&&(this._root=b)}return this._x0=n,this._y0=r,this._x1=a,this._y1=s,this},ad.data=function(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t},ad.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},ad.find=function(t,e,n){var r,a,s,h,d,g,b,_=this._x0,E=this._y0,I=this._x1,R=this._y1,z=[],P=this._root;for(P&&z.push(new Sh(P,_,E,I,R)),n==null?n=1/0:(_=t-n,E=e-n,I=t+n,R=e+n,n*=n);g=z.pop();)if(!(!(P=g.node)||(a=g.x0)>I||(s=g.y0)>R||(h=g.x1)<_||(d=g.y1)<E))if(P.length){var rt=(a+h)/2,ot=(s+d)/2;z.push(new Sh(P[3],rt,ot,h,d),new Sh(P[2],a,ot,rt,d),new Sh(P[1],rt,s,h,ot),new Sh(P[0],a,s,rt,ot)),(b=(e>=ot)<<1|t>=rt)&&(g=z[z.length-1],z[z.length-1]=z[z.length-1-b],z[z.length-1-b]=g)}else{var at=t-+this._x.call(null,P.data),dt=e-+this._y.call(null,P.data),ct=at*at+dt*dt;if(ct<n){var Ct=Math.sqrt(n=ct);_=t-Ct,E=e-Ct,I=t+Ct,R=e+Ct,r=P.data}}return r},ad.remove=function(t){if(isNaN(s=+this._x.call(null,t))||isNaN(h=+this._y.call(null,t)))return this;var e,n,r,a,s,h,d,g,b,_,E,I,R=this._root,z=this._x0,P=this._y0,rt=this._x1,ot=this._y1;if(!R)return this;if(R.length)for(;;){if((b=s>=(d=(z+rt)/2))?z=d:rt=d,(_=h>=(g=(P+ot)/2))?P=g:ot=g,e=R,!(R=R[E=_<<1|b]))return this;if(!R.length)break;(e[E+1&3]||e[E+2&3]||e[E+3&3])&&(n=e,I=E)}for(;R.data!==t;)if(r=R,!(R=R.next))return this;return(a=R.next)&&delete R.next,r?(a?r.next=a:delete r.next,this):e?(a?e[E]=a:delete e[E],(R=e[0]||e[1]||e[2]||e[3])&&R===(e[3]||e[2]||e[1]||e[0])&&!R.length&&(n?n[I]=R:this._root=R),this):(this._root=a,this)},ad.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},ad.root=function(){return this._root},ad.size=function(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t},ad.visit=function(t){var e,n,r,a,s,h,d=[],g=this._root;for(g&&d.push(new Sh(g,this._x0,this._y0,this._x1,this._y1));e=d.pop();)if(!t(g=e.node,r=e.x0,a=e.y0,s=e.x1,h=e.y1)&&g.length){var b=(r+s)/2,_=(a+h)/2;(n=g[3])&&d.push(new Sh(n,b,_,s,h)),(n=g[2])&&d.push(new Sh(n,r,_,b,h)),(n=g[1])&&d.push(new Sh(n,b,a,s,_)),(n=g[0])&&d.push(new Sh(n,r,a,b,_))}return this},ad.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new Sh(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var a=e.node;if(a.length){var s,h=e.x0,d=e.y0,g=e.x1,b=e.y1,_=(h+g)/2,E=(d+b)/2;(s=a[0])&&n.push(new Sh(s,h,d,_,E)),(s=a[1])&&n.push(new Sh(s,_,d,g,E)),(s=a[2])&&n.push(new Sh(s,h,E,_,b)),(s=a[3])&&n.push(new Sh(s,_,E,g,b))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},ad.x=function(t){return arguments.length?(this._x=t,this):this._x},ad.y=function(t){return arguments.length?(this._y=t,this):this._y};var Edt={value:()=>{}};function YZ(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new kI(r)}function kI(t){this._=t}function Tdt(t,e){for(var n,r=0,a=t.length;r<a;++r)if((n=t[r]).name===e)return n.value}function Gx(t,e,n){for(var r=0,a=t.length;r<a;++r)if(t[r].name===e){t[r]=Edt,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}kI.prototype=YZ.prototype={constructor:kI,on:function(t,e){var n,r=this._,a=function(d,g){return d.trim().split(/^|\s+/).map(function(b){var _="",E=b.indexOf(".");if(E>=0&&(_=b.slice(E+1),b=b.slice(0,E)),b&&!g.hasOwnProperty(b))throw new Error("unknown type: "+b);return{type:b,name:_}})}(t+"",r),s=-1,h=a.length;if(!(arguments.length<2)){if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<h;)if(n=(t=a[s]).type)r[n]=Gx(r[n],t.name,e);else if(e==null)for(n in r)r[n]=Gx(r[n],t.name,null);return this}for(;++s<h;)if((n=(t=a[s]).type)&&(n=Tdt(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new kI(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,a=new Array(n),s=0;s<n;++s)a[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,n=(r=this._[t]).length;s<n;++s)r[s].value.apply(e,a)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],a=0,s=r.length;a<s;++a)r[a].value.apply(e,n)}};let qZ=YZ;var Dm,Hx,Yx=0,kb=0,j_=0,U_=0,Sb=0,W_=0,_b=typeof performance=="object"&&performance.now?performance:Date,uz=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function SI(){return Sb||(uz(Adt),Sb=_b.now()+W_)}function Adt(){Sb=0}function V_(){this._call=this._time=this._next=null}function lz(t,e,n){var r=new V_;return r.restart(t,e,n),r}function cz(){Sb=(U_=_b.now())+W_,Yx=kb=0;try{(function(){SI(),++Yx;for(var t,e=Dm;e;)(t=Sb-e._time)>=0&&e._call.call(null,t),e=e._next;--Yx})()}finally{Yx=0,function(){for(var t,e,n=Dm,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Dm=e);Hx=t,qx(r)}(),Sb=0}}function hz(){var t=_b.now(),e=t-U_;e>1e3&&(W_-=e,U_=t)}function qx(t){Yx||(kb&&(kb=clearTimeout(kb)),t-Sb>24?(t<1/0&&(kb=setTimeout(cz,t-_b.now()-W_)),j_&&(j_=clearInterval(j_))):(j_||(U_=_b.now(),j_=setInterval(hz,1e3)),Yx=1,uz(cz)))}V_.prototype=lz.prototype={constructor:V_,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?SI():+n)+(e==null?0:+e),this._next||Hx===this||(Hx?Hx._next=this:Dm=this,Hx=this),this._call=t,this._time=n,qx()},stop:function(){this._call&&(this._call=null,this._time=1/0,qx())}};let XZ=4294967296;function cr(t){return t.x}function Xx(t){return t.y}var KZ=Math.PI*(3-Math.sqrt(5));function ZZ(t){var e,n=1,r=.001,a=1-Math.pow(r,1/300),s=0,h=.6,d=new Map,g=lz(E),b=qZ("tick","end"),_=function(){let P=1;return()=>(P=(1664525*P+1013904223)%XZ)/XZ}();function E(){I(),b.call("tick",e),n<r&&(g.stop(),b.call("end",e))}function I(P){var rt,ot,at=t.length;P===void 0&&(P=1);for(var dt=0;dt<P;++dt)for(n+=(s-n)*a,d.forEach(function(ct){ct(n)}),rt=0;rt<at;++rt)(ot=t[rt]).fx==null?ot.x+=ot.vx*=h:(ot.x=ot.fx,ot.vx=0),ot.fy==null?ot.y+=ot.vy*=h:(ot.y=ot.fy,ot.vy=0);return e}function R(){for(var P,rt=0,ot=t.length;rt<ot;++rt){if((P=t[rt]).index=rt,P.fx!=null&&(P.x=P.fx),P.fy!=null&&(P.y=P.fy),isNaN(P.x)||isNaN(P.y)){var at=10*Math.sqrt(.5+rt),dt=rt*KZ;P.x=at*Math.cos(dt),P.y=at*Math.sin(dt)}(isNaN(P.vx)||isNaN(P.vy))&&(P.vx=P.vy=0)}}function z(P){return P.initialize&&P.initialize(t,_),P}return t==null&&(t=[]),R(),e={tick:I,restart:function(){return g.restart(E),e},stop:function(){return g.stop(),e},nodes:function(P){return arguments.length?(t=P,R(),d.forEach(z),e):t},alpha:function(P){return arguments.length?(n=+P,e):n},alphaMin:function(P){return arguments.length?(r=+P,e):r},alphaDecay:function(P){return arguments.length?(a=+P,e):+a},alphaTarget:function(P){return arguments.length?(s=+P,e):s},velocityDecay:function(P){return arguments.length?(h=1-P,e):1-h},randomSource:function(P){return arguments.length?(_=P,d.forEach(z),e):_},force:function(P,rt){return arguments.length>1?(rt==null?d.delete(P):d.set(P,z(rt)),e):d.get(P)},find:function(P,rt,ot){var at,dt,ct,Ct,Et,Rt=0,Ot=t.length;for(ot==null?ot=1/0:ot*=ot,Rt=0;Rt<Ot;++Rt)(ct=(at=P-(Ct=t[Rt]).x)*at+(dt=rt-Ct.y)*dt)<ot&&(Et=Ct,ot=ct);return Et},on:function(P,rt){return arguments.length>1?(b.on(P,rt),e):b.on(P)}}}function mo(t){return t.index}function _I(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}let dz={center:function(t,e){var n,r=1;function a(){var s,h,d=n.length,g=0,b=0;for(s=0;s<d;++s)g+=(h=n[s]).x,b+=h.y;for(g=(g/d-t)*r,b=(b/d-e)*r,s=0;s<d;++s)(h=n[s]).x-=g,h.y-=b}return t==null&&(t=0),e==null&&(e=0),a.initialize=function(s){n=s},a.x=function(s){return arguments.length?(t=+s,a):t},a.y=function(s){return arguments.length?(e=+s,a):e},a.strength=function(s){return arguments.length?(r=+s,a):r},a},collide:function(t){var e,n,r,a=1,s=1;function h(){for(var b,_,E,I,R,z,P,rt=e.length,ot=0;ot<s;++ot)for(_=xI(e,_dt,Cdt).visitAfter(d),b=0;b<rt;++b)E=e[b],z=n[E.index],P=z*z,I=E.x+E.vx,R=E.y+E.vy,_.visit(at);function at(dt,ct,Ct,Et,Rt){var Ot=dt.data,Wt=dt.r,jt=z+Wt;if(!Ot)return ct>I+jt||Et<I-jt||Ct>R+jt||Rt<R-jt;if(Ot.index>E.index){var Ht=I-Ot.x-Ot.vx,Vt=R-Ot.y-Ot.vy,fe=Ht*Ht+Vt*Vt;fe<jt*jt&&(Ht===0&&(fe+=(Ht=q2(r))*Ht),Vt===0&&(fe+=(Vt=q2(r))*Vt),fe=(jt-(fe=Math.sqrt(fe)))/fe*a,E.vx+=(Ht*=fe)*(jt=(Wt*=Wt)/(P+Wt)),E.vy+=(Vt*=fe)*jt,Ot.vx-=Ht*(jt=1-jt),Ot.vy-=Vt*jt)}}}function d(b){if(b.data)return b.r=n[b.data.index];for(var _=b.r=0;_<4;++_)b[_]&&b[_].r>b.r&&(b.r=b[_].r)}function g(){if(e){var b,_,E=e.length;for(n=new Array(E),b=0;b<E;++b)_=e[b],n[_.index]=+t(_,b,e)}}return typeof t!="function"&&(t=od(t==null?1:+t)),h.initialize=function(b,_){e=b,r=_,g()},h.iterations=function(b){return arguments.length?(s=+b,h):s},h.strength=function(b){return arguments.length?(a=+b,h):a},h.radius=function(b){return arguments.length?(t=typeof b=="function"?b:od(+b),g(),h):t},h},nbody:function(){var t,e,n,r,a,s=od(-30),h=1,d=1/0,g=.81;function b(R){var z,P=t.length,rt=xI(t,cr,Xx).visitAfter(E);for(r=R,z=0;z<P;++z)e=t[z],rt.visit(I)}function _(){if(t){var R,z,P=t.length;for(a=new Array(P),R=0;R<P;++R)z=t[R],a[z.index]=+s(z,R,t)}}function E(R){var z,P,rt,ot,at,dt=0,ct=0;if(R.length){for(rt=ot=at=0;at<4;++at)(z=R[at])&&(P=Math.abs(z.value))&&(dt+=z.value,ct+=P,rt+=P*z.x,ot+=P*z.y);R.x=rt/ct,R.y=ot/ct}else{(z=R).x=z.data.x,z.y=z.data.y;do dt+=a[z.data.index];while(z=z.next)}R.value=dt}function I(R,z,P,rt){if(!R.value)return!0;var ot=R.x-e.x,at=R.y-e.y,dt=rt-z,ct=ot*ot+at*at;if(dt*dt/g<ct)return ct<d&&(ot===0&&(ct+=(ot=q2(n))*ot),at===0&&(ct+=(at=q2(n))*at),ct<h&&(ct=Math.sqrt(h*ct)),e.vx+=ot*R.value*r/ct,e.vy+=at*R.value*r/ct),!0;if(!(R.length||ct>=d)){(R.data!==e||R.next)&&(ot===0&&(ct+=(ot=q2(n))*ot),at===0&&(ct+=(at=q2(n))*at),ct<h&&(ct=Math.sqrt(h*ct)));do R.data!==e&&(dt=a[R.data.index]*r/ct,e.vx+=ot*dt,e.vy+=at*dt);while(R=R.next)}}return b.initialize=function(R,z){t=R,n=z,_()},b.strength=function(R){return arguments.length?(s=typeof R=="function"?R:od(+R),_(),b):s},b.distanceMin=function(R){return arguments.length?(h=R*R,b):Math.sqrt(h)},b.distanceMax=function(R){return arguments.length?(d=R*R,b):Math.sqrt(d)},b.theta=function(R){return arguments.length?(g=R*R,b):Math.sqrt(g)},b},link:function(t){var e,n,r,a,s,h,d=mo,g=function(P){return 1/Math.min(a[P.source.index],a[P.target.index])},b=od(30),_=1;function E(P){for(var rt=0,ot=t.length;rt<_;++rt)for(var at,dt,ct,Ct,Et,Rt,Ot,Wt=0;Wt<ot;++Wt)dt=(at=t[Wt]).source,Ct=(ct=at.target).x+ct.vx-dt.x-dt.vx||q2(h),Et=ct.y+ct.vy-dt.y-dt.vy||q2(h),Ct*=Rt=((Rt=Math.sqrt(Ct*Ct+Et*Et))-n[Wt])/Rt*P*e[Wt],Et*=Rt,ct.vx-=Ct*(Ot=s[Wt]),ct.vy-=Et*Ot,dt.vx+=Ct*(Ot=1-Ot),dt.vy+=Et*Ot}function I(){if(r){var P,rt,ot=r.length,at=t.length,dt=new Map(r.map((ct,Ct)=>[d(ct,Ct,r),ct]));for(P=0,a=new Array(ot);P<at;++P)(rt=t[P]).index=P,typeof rt.source!="object"&&(rt.source=_I(dt,rt.source)),typeof rt.target!="object"&&(rt.target=_I(dt,rt.target)),a[rt.source.index]=(a[rt.source.index]||0)+1,a[rt.target.index]=(a[rt.target.index]||0)+1;for(P=0,s=new Array(at);P<at;++P)rt=t[P],s[P]=a[rt.source.index]/(a[rt.source.index]+a[rt.target.index]);e=new Array(at),R(),n=new Array(at),z()}}function R(){if(r)for(var P=0,rt=t.length;P<rt;++P)e[P]=+g(t[P],P,t)}function z(){if(r)for(var P=0,rt=t.length;P<rt;++P)n[P]=+b(t[P],P,t)}return t==null&&(t=[]),E.initialize=function(P,rt){r=P,h=rt,I()},E.links=function(P){return arguments.length?(t=P,I(),E):t},E.id=function(P){return arguments.length?(d=P,E):d},E.iterations=function(P){return arguments.length?(_=+P,E):_},E.strength=function(P){return arguments.length?(g=typeof P=="function"?P:od(+P),R(),E):g},E.distance=function(P){return arguments.length?(b=typeof P=="function"?P:od(+P),z(),E):b},E},x:function(t){var e,n,r,a=od(.1);function s(d){for(var g,b=0,_=e.length;b<_;++b)(g=e[b]).vx+=(r[b]-g.x)*n[b]*d}function h(){if(e){var d,g=e.length;for(n=new Array(g),r=new Array(g),d=0;d<g;++d)n[d]=isNaN(r[d]=+t(e[d],d,e))?0:+a(e[d],d,e)}}return typeof t!="function"&&(t=od(t==null?0:+t)),s.initialize=function(d){e=d,h()},s.strength=function(d){return arguments.length?(a=typeof d=="function"?d:od(+d),h(),s):a},s.x=function(d){return arguments.length?(t=typeof d=="function"?d:od(+d),h(),s):t},s},y:function(t){var e,n,r,a=od(.1);function s(d){for(var g,b=0,_=e.length;b<_;++b)(g=e[b]).vy+=(r[b]-g.y)*n[b]*d}function h(){if(e){var d,g=e.length;for(n=new Array(g),r=new Array(g),d=0;d<g;++d)n[d]=isNaN(r[d]=+t(e[d],d,e))?0:+a(e[d],d,e)}}return typeof t!="function"&&(t=od(t==null?0:+t)),s.initialize=function(d){e=d,h()},s.strength=function(d){return arguments.length?(a=typeof d=="function"?d:od(+d),h(),s):a},s.y=function(d){return arguments.length?(t=typeof d=="function"?d:od(+d),h(),s):t},s}},Kx="forces",fz=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],CI=["static","iterations"],pz=["x","y","vx","vy"];function EI(t){ar.call(this,null,t)}function mz(t,e,n,r){var a,s,h,d,g=et(e.forces);for(a=0,s=fz.length;a<s;++a)(h=fz[a])!==Kx&&e.modified(h)&&t[h](e[h]);for(a=0,s=g.length;a<s;++a)d=Kx+a,(h=n||e.modified(Kx,a)?Idt(g[a]):r&&QZ(g[a],r)?t.force(d):null)&&t.force(d,h);for(s=t.numForces||0;a<s;++a)t.force(Kx+a,null);return t.numForces=g.length,t}function QZ(t,e){var n,r;for(n in t)if(ut(r=t[n])&&e.modified(Ca(r)))return 1;return 0}function Idt(t){var e,n;for(n in In(dz,t.force)||Dn("Unrecognized force: "+t.force),e=dz[t.force](),t)ut(e[n])&&JZ(e[n],t[n],t);return e}function JZ(t,e,n){t(ut(e)?r=>e(r,n):e)}function tQ(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function TI(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=gz)):e===void 0&&(e=Ndt);for(var n,r,a,s,h,d=new Zx(t),g=[d];n=g.pop();)if((a=e(n.data))&&(h=(a=Array.from(a)).length))for(n.children=a,s=h-1;s>=0;--s)g.push(r=a[s]=new Zx(a[s])),r.parent=n,r.depth=n.depth+1;return d.eachBefore(eQ)}function Ndt(t){return t.children}function gz(t){return Array.isArray(t)?t[1]:null}function yz(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function eQ(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Zx(t){this.data=t,this.depth=this.height=0,this.parent=null}function Mdt(t){for(var e,n,r=0,a=(t=function(h){for(var d,g,b=h.length;b;)g=Math.random()*b--|0,d=h[b],h[b]=h[g],h[g]=d;return h}(Array.from(t))).length,s=[];r<a;)e=t[r],n&&AI(n,e)?++r:(n=Ddt(s=_h(s,e)),r=0);return n}function _h(t,e){var n,r;if(H_(e,t))return[e];for(n=0;n<t.length;++n)if(G_(e,t[n])&&H_(Qx(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(G_(Qx(t[n],t[r]),e)&&G_(Qx(t[n],e),t[r])&&G_(Qx(t[r],e),t[n])&&H_(Jx(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function G_(t,e){var n=t.r-e.r,r=e.x-t.x,a=e.y-t.y;return n<0||n*n<r*r+a*a}function AI(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),r=e.x-t.x,a=e.y-t.y;return n>0&&n*n>r*r+a*a}function H_(t,e){for(var n=0;n<e.length;++n)if(!AI(t,e[n]))return!1;return!0}function Ddt(t){switch(t.length){case 1:return function(e){return{x:e.x,y:e.y,r:e.r}}(t[0]);case 2:return Qx(t[0],t[1]);case 3:return Jx(t[0],t[1],t[2])}}function Qx(t,e){var n=t.x,r=t.y,a=t.r,s=e.x,h=e.y,d=e.r,g=s-n,b=h-r,_=d-a,E=Math.sqrt(g*g+b*b);return{x:(n+s+g/E*_)/2,y:(r+h+b/E*_)/2,r:(E+a+d)/2}}function Jx(t,e,n){var r=t.x,a=t.y,s=t.r,h=e.x,d=e.y,g=e.r,b=n.x,_=n.y,E=n.r,I=r-h,R=r-b,z=a-d,P=a-_,rt=g-s,ot=E-s,at=r*r+a*a-s*s,dt=at-h*h-d*d+g*g,ct=at-b*b-_*_+E*E,Ct=R*z-I*P,Et=(z*ct-P*dt)/(2*Ct)-r,Rt=(P*rt-z*ot)/Ct,Ot=(R*dt-I*ct)/(2*Ct)-a,Wt=(I*ot-R*rt)/Ct,jt=Rt*Rt+Wt*Wt-1,Ht=2*(s+Et*Rt+Ot*Wt),Vt=Et*Et+Ot*Ot-s*s,fe=-(jt?(Ht+Math.sqrt(Ht*Ht-4*jt*Vt))/(2*jt):Vt/Ht);return{x:r+Et+Rt*fe,y:a+Ot+Wt*fe,r:fe}}function Y_(t,e,n){var r,a,s,h,d=t.x-e.x,g=t.y-e.y,b=d*d+g*g;b?(a=e.r+n.r,a*=a,h=t.r+n.r,a>(h*=h)?(r=(b+h-a)/(2*b),s=Math.sqrt(Math.max(0,h/b-r*r)),n.x=t.x-r*d-s*g,n.y=t.y-r*g+s*d):(r=(b+a-h)/(2*b),s=Math.sqrt(Math.max(0,a/b-r*r)),n.x=e.x+r*d-s*g,n.y=e.y+r*g+s*d)):(n.x=e.x+n.r,n.y=e.y)}function II(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,a=e.y-t.y;return n>0&&n*n>r*r+a*a}function q_(t){var e=t._,n=t.next._,r=e.r+n.r,a=(e.x*n.r+n.x*e.r)/r,s=(e.y*n.r+n.y*e.r)/r;return a*a+s*s}function Vd(t){this._=t,this.next=null,this.previous=null}function vz(t){if(!(a=(t=function(I){return typeof I=="object"&&"length"in I?I:Array.from(I)}(t)).length))return 0;var e,n,r,a,s,h,d,g,b,_,E;if((e=t[0]).x=0,e.y=0,!(a>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(a>2))return e.r+n.r;Y_(n,e,r=t[2]),e=new Vd(e),n=new Vd(n),r=new Vd(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(d=3;d<a;++d){Y_(e._,n._,r=t[d]),r=new Vd(r),g=n.next,b=e.previous,_=n._.r,E=e._.r;do if(_<=E){if(II(g._,r._)){n=g,e.next=n,n.previous=e,--d;continue t}_+=g._.r,g=g.next}else{if(II(b._,r._)){(e=b).next=n,n.previous=e,--d;continue t}E+=b._.r,b=b.previous}while(g!==b.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,s=q_(e);(r=r.next)!==n;)(h=q_(r))<s&&(e=r,s=h);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=Mdt(e),d=0;d<a;++d)(e=t[d]).x-=r.x,e.y-=r.y;return r.r}function X_(t){if(typeof t!="function")throw new Error;return t}function X2(){return 0}function Rm(t){return function(){return t}}function nQ(t){return Math.sqrt(t.value)}function rQ(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function bz(t,e){return function(n){if(r=n.children){var r,a,s,h=r.length,d=t(n)*e||0;if(d)for(a=0;a<h;++a)r[a].r+=d;if(s=vz(r),d)for(a=0;a<h;++a)r[a].r-=d;n.r=s+d}}}function K_(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function wz(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function t4(t,e,n,r,a){for(var s,h=t.children,d=-1,g=h.length,b=t.value&&(r-e)/t.value;++d<g;)(s=h[d]).y0=n,s.y1=a,s.x0=e,s.x1=e+=s.value*b}EI.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:pz}]},ur(EI,ar,{transform(t,e){var n,r,a=this.value,s=e.changed(e.ADD_REM),h=t.modified(fz),d=t.iterations||300;if(a?(s&&(e.modifies("index"),a.nodes(e.source)),(h||e.changed(e.MOD))&&mz(a,t,0,e)):(this.value=a=function(g,b){let _=ZZ(g),E=_.stop,I=_.restart,R=!1;return _.stopped=()=>R,_.restart=()=>(R=!1,I()),_.stop=()=>(R=!0,E()),mz(_,b,!0).on("end",()=>R=!0)}(e.source,t),a.on("tick",(n=e.dataflow,r=this,()=>n.touch(r).run())),t.static||(s=!0,a.tick()),e.modifies("index")),h||s||t.modified(CI)||e.changed()&&t.restart){if(a.alpha(Math.max(a.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(a.alphaMin(),1/d)),t.static)for(a.stop();--d>=0;)a.tick();else if(a.stopped()&&a.restart(),!s)return e.StopPropagation}return this.finish(t,e)},finish(t,e){let n=e.dataflow;for(let d,g=this._argops,b=0,_=g.length;b<_;++b)if(d=g[b],d.name===Kx&&d.op._argval.force==="link"){for(var r,a=d.op._argops,s=0,h=a.length;s<h;++s)if(a[s].name==="links"&&(r=a[s].op.source)){n.pulse(r,n.changeset().reflow());break}}return e.reflow(t.modified()).modifies(pz)}}),Zx.prototype=TI.prototype={constructor:Zx,count:function(){return this.eachAfter(tQ)},each:function(t,e){let n=-1;for(let r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,a,s=this,h=[s],d=[],g=-1;s=h.pop();)if(d.push(s),n=s.children)for(r=0,a=n.length;r<a;++r)h.push(n[r]);for(;s=d.pop();)t.call(e,s,++g,this);return this},eachBefore:function(t,e){for(var n,r,a=this,s=[a],h=-1;a=s.pop();)if(t.call(e,a,++h,this),n=a.children)for(r=n.length-1;r>=0;--r)s.push(n[r]);return this},find:function(t,e){let n=-1;for(let r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,a=r&&r.length;--a>=0;)n+=r[a].value;e.value=n})},sort:function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},path:function(t){for(var e=this,n=function(s,h){if(s===h)return s;var d=s.ancestors(),g=h.ancestors(),b=null;for(s=d.pop(),h=g.pop();s===h;)b=s,s=d.pop(),h=g.pop();return b}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var a=r.length;t!==n;)r.splice(a,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},links:function(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e},copy:function(){return TI(this).eachBefore(yz)},[Symbol.iterator]:function*(){var t,e,n,r,a=this,s=[a];do for(t=s.reverse(),s=[];a=t.pop();)if(yield a,e=a.children)for(n=0,r=e.length;n<r;++n)s.push(e[n]);while(s.length)}};var Rdt={depth:-1},Z_={};function iQ(t){return t.id}function Fdt(t){return t.parentId}function xz(){var t=iQ,e=Fdt;function n(r){var a,s,h,d,g,b,_,E=Array.from(r),I=E.length,R=new Map;for(s=0;s<I;++s)a=E[s],g=E[s]=new Zx(a),(b=t(a,s,r))!=null&&(b+="")&&(_=g.id=b,R.set(_,R.has(_)?Z_:g)),(b=e(a,s,r))!=null&&(b+="")&&(g.parent=b);for(s=0;s<I;++s)if(b=(g=E[s]).parent){if(!(d=R.get(b)))throw new Error("missing: "+b);if(d===Z_)throw new Error("ambiguous: "+b);d.children?d.children.push(g):d.children=[g],g.parent=d}else{if(h)throw new Error("multiple roots");h=g}if(!h)throw new Error("no root");if(h.parent=Rdt,h.eachBefore(function(z){z.depth=z.parent.depth+1,--I}).eachBefore(eQ),h.parent=null,I>0)throw new Error("cycle");return h}return n.id=function(r){return arguments.length?(t=X_(r),n):t},n.parentId=function(r){return arguments.length?(e=X_(r),n):e},n}function aQ(t,e){return t.parent===e.parent?1:2}function i1(t){var e=t.children;return e?e[0]:t.t}function NI(t){var e=t.children;return e?e[e.length-1]:t.t}function Odt(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function Ldt(t,e,n){return t.a.parent===e.parent?t.a:n}function MI(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function $dt(t,e){return t.parent===e.parent?1:2}function oQ(t,e){return t+e.x}function DI(t,e){return Math.max(t,e.y)}function Q_(t,e,n,r,a){for(var s,h=t.children,d=-1,g=h.length,b=t.value&&(a-n)/t.value;++d<g;)(s=h[d]).x0=e,s.x1=r,s.y0=n,s.y1=n+=s.value*b}MI.prototype=Object.create(Zx.prototype);var sQ=(1+Math.sqrt(5))/2;function kz(t,e,n,r,a,s){for(var h,d,g,b,_,E,I,R,z,P,rt,ot=[],at=e.children,dt=0,ct=0,Ct=at.length,Et=e.value;dt<Ct;){g=a-n,b=s-r;do _=at[ct++].value;while(!_&&ct<Ct);for(E=I=_,rt=_*_*(P=Math.max(b/g,g/b)/(Et*t)),z=Math.max(I/rt,rt/E);ct<Ct;++ct){if(_+=d=at[ct].value,d<E&&(E=d),d>I&&(I=d),rt=_*_*P,(R=Math.max(I/rt,rt/E))>z){_-=d;break}z=R}ot.push(h={value:_,dice:g<b,children:at.slice(dt,ct)}),h.dice?t4(h,n,r,a,Et?r+=b*_/Et:s):Q_(h,n,r,Et?n+=g*_/Et:a,s),Et-=_,dt=ct}return ot}let Sz=function t(e){function n(r,a,s,h,d){kz(e,r,a,s,h,d)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(sQ),zdt=function t(e){function n(r,a,s,h,d){if((g=r._squarify)&&g.ratio===e)for(var g,b,_,E,I,R=-1,z=g.length,P=r.value;++R<z;){for(_=(b=g[R]).children,E=b.value=0,I=_.length;E<I;++E)b.value+=_[E].value;b.dice?t4(b,a,s,h,P?s+=(d-s)*b.value/P:d):Q_(b,a,s,P?a+=(h-a)*b.value/P:h,d),P-=b.value}else r._squarify=g=kz(e,r,a,s,h,d),g.ratio=e}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(sQ);function J_(t,e,n){let r={};return t.each(a=>{let s=a.data;n(s)&&(r[e(s)]=a)}),t.lookup=r,t}function e4(t){ar.call(this,null,t)}e4.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};let uQ=t=>t.values;function Pdt(){let t=[],e={entries:a=>r(n(a,0),0),key:a=>(t.push(a),e)};function n(a,s){if(s>=t.length)return a;let h=a.length,d=t[s++],g={},b={},_,E,I,R=-1;for(;++R<h;)_=d(E=a[R])+"",(I=g[_])?I.push(E):g[_]=[E];for(_ in g)b[_]=n(g[_],s);return b}function r(a,s){if(++s>t.length)return a;let h=[];for(let d in a)h.push({key:d,values:r(a[d],s)});return h}return e}function Fm(t){ar.call(this,null,t)}ur(e4,ar,{transform(t,e){e.source||Dn("Nest transform requires an upstream data source.");var n=t.generate,r=t.modified(),a=e.clone(),s=this.value;return(!s||r||e.changed())&&(s&&s.each(h=>{h.children&&Qh(h.data)&&a.rem.push(h.data)}),this.value=s=TI({values:et(t.keys).reduce((h,d)=>(h.key(d),h),Pdt()).entries(a.source)},uQ),n&&s.each(h=>{h.children&&(h=Jo(h.data),a.add.push(h),a.source.push(h))}),J_(s,qi,qi)),a.source.root=s,a}});let lQ=(t,e)=>t.parent===e.parent?1:2;ur(Fm,ar,{transform(t,e){e.source&&e.source.root||Dn(this.constructor.name+" transform requires a backing tree data source.");let n=this.layout(t.method),r=this.fields,a=e.source.root,s=t.as||r;t.field?a.sum(t.field):a.count(),t.sort&&a.sort(op(t.sort,h=>h.data)),function(h,d,g){for(let b,_=0,E=d.length;_<E;++_)b=d[_],b in g&&h[b](g[b])}(n,this.params,t),n.separation&&n.separation(t.separation!==!1?lQ:io);try{this.value=n(a)}catch(h){Dn(h)}return a.each(h=>function(d,g,b){let _=d.data,E=g.length-1;for(let I=0;I<E;++I)_[b[I]]=d[g[I]];_[b[E]]=d.children?d.children.length:0}(h,r,s)),e.reflow(t.modified()).modifies(s).modifies("leaf")}});let _z=["x","y","r","depth","children"];function RI(t){Fm.call(this,t)}RI.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:_z.length,default:_z}]},ur(RI,Fm,{layout:function(){var t=null,e=1,n=1,r=X2;function a(s){return s.x=e/2,s.y=n/2,t?s.eachBefore(rQ(t)).eachAfter(bz(r,.5)).eachBefore(K_(1)):s.eachBefore(rQ(nQ)).eachAfter(bz(X2,1)).eachAfter(bz(r,s.r/Math.min(e,n))).eachBefore(K_(Math.min(e,n)/(2*s.r))),s}return a.radius=function(s){return arguments.length?(t=(h=s)==null?null:X_(h),a):t;var h},a.size=function(s){return arguments.length?(e=+s[0],n=+s[1],a):[e,n]},a.padding=function(s){return arguments.length?(r=typeof s=="function"?s:Rm(+s),a):r},a},params:["radius","size","padding"],fields:_z});let t6=["x0","y0","x1","y1","depth","children"];function FI(t){Fm.call(this,t)}function Cz(t){ar.call(this,null,t)}FI.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:t6.length,default:t6}]},ur(FI,Fm,{layout:function(){var t=1,e=1,n=0,r=!1;function a(s){var h=s.height+1;return s.x0=s.y0=n,s.x1=t,s.y1=e/h,s.eachBefore(function(d,g){return function(b){b.children&&t4(b,b.x0,d*(b.depth+1)/g,b.x1,d*(b.depth+2)/g);var _=b.x0,E=b.y0,I=b.x1-n,R=b.y1-n;I<_&&(_=I=(_+I)/2),R<E&&(E=R=(E+R)/2),b.x0=_,b.y0=E,b.x1=I,b.y1=R}}(e,h)),r&&s.eachBefore(wz),s}return a.round=function(s){return arguments.length?(r=!!s,a):r},a.size=function(s){return arguments.length?(t=+s[0],e=+s[1],a):[t,e]},a.padding=function(s){return arguments.length?(n=+s,a):n},a},params:["size","round","padding"],fields:t6}),Cz.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},ur(Cz,ar,{transform(t,e){e.source||Dn("Stratify transform requires an upstream data source.");let n=this.value,r=t.modified(),a=e.fork(e.ALL).materialize(e.SOURCE),s=!n||r||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return a.source=a.source.slice(),s&&(n=a.source.length?J_(xz().id(t.key).parentId(t.parentKey)(a.source),t.key,an):J_(xz()([{}]),t.key,t.key)),a.source.root=this.value=n,a}});let e6={tidy:function(){var t=aQ,e=1,n=1,r=null;function a(g){var b=function(ot){for(var at,dt,ct,Ct,Et,Rt=new MI(ot,0),Ot=[Rt];at=Ot.pop();)if(ct=at._.children)for(at.children=new Array(Et=ct.length),Ct=Et-1;Ct>=0;--Ct)Ot.push(dt=at.children[Ct]=new MI(ct[Ct],Ct)),dt.parent=at;return(Rt.parent=new MI(null,0)).children=[Rt],Rt}(g);if(b.eachAfter(s),b.parent.m=-b.z,b.eachBefore(h),r)g.eachBefore(d);else{var _=g,E=g,I=g;g.eachBefore(function(ot){ot.x<_.x&&(_=ot),ot.x>E.x&&(E=ot),ot.depth>I.depth&&(I=ot)});var R=_===E?1:t(_,E)/2,z=R-_.x,P=e/(E.x+R+z),rt=n/(I.depth||1);g.eachBefore(function(ot){ot.x=(ot.x+z)*P,ot.y=ot.depth*rt})}return g}function s(g){var b=g.children,_=g.parent.children,E=g.i?_[g.i-1]:null;if(b){(function(R){for(var z,P=0,rt=0,ot=R.children,at=ot.length;--at>=0;)(z=ot[at]).z+=P,z.m+=P,P+=z.s+(rt+=z.c)})(g);var I=(b[0].z+b[b.length-1].z)/2;E?(g.z=E.z+t(g._,E._),g.m=g.z-I):g.z=I}else E&&(g.z=E.z+t(g._,E._));g.parent.A=function(R,z,P){if(z){for(var rt,ot=R,at=R,dt=z,ct=ot.parent.children[0],Ct=ot.m,Et=at.m,Rt=dt.m,Ot=ct.m;dt=NI(dt),ot=i1(ot),dt&&ot;)ct=i1(ct),(at=NI(at)).a=R,(rt=dt.z+Rt-ot.z-Ct+t(dt._,ot._))>0&&(Odt(Ldt(dt,R,P),R,rt),Ct+=rt,Et+=rt),Rt+=dt.m,Ct+=ot.m,Ot+=ct.m,Et+=at.m;dt&&!NI(at)&&(at.t=dt,at.m+=Rt-Et),ot&&!i1(ct)&&(ct.t=ot,ct.m+=Ct-Ot,P=R)}return P}(g,E,g.parent.A||_[0])}function h(g){g._.x=g.z+g.parent.m,g.m+=g.parent.m}function d(g){g.x*=e,g.y=g.depth*n}return a.separation=function(g){return arguments.length?(t=g,a):t},a.size=function(g){return arguments.length?(r=!1,e=+g[0],n=+g[1],a):r?null:[e,n]},a.nodeSize=function(g){return arguments.length?(r=!0,e=+g[0],n=+g[1],a):r?[e,n]:null},a},cluster:function(){var t=$dt,e=1,n=1,r=!1;function a(s){var h,d=0;s.eachAfter(function(I){var R=I.children;R?(I.x=function(z){return z.reduce(oQ,0)/z.length}(R),I.y=function(z){return 1+z.reduce(DI,0)}(R)):(I.x=h?d+=t(I,h):0,I.y=0,h=I)});var g=function(I){for(var R;R=I.children;)I=R[0];return I}(s),b=function(I){for(var R;R=I.children;)I=R[R.length-1];return I}(s),_=g.x-t(g,b)/2,E=b.x+t(b,g)/2;return s.eachAfter(r?function(I){I.x=(I.x-s.x)*e,I.y=(s.y-I.y)*n}:function(I){I.x=(I.x-_)/(E-_)*e,I.y=(1-(s.y?I.y/s.y:1))*n})}return a.separation=function(s){return arguments.length?(t=s,a):t},a.size=function(s){return arguments.length?(r=!1,e=+s[0],n=+s[1],a):r?null:[e,n]},a.nodeSize=function(s){return arguments.length?(r=!0,e=+s[0],n=+s[1],a):r?[e,n]:null},a}},OI=["x","y","depth","children"];function n4(t){Fm.call(this,t)}function Ep(t){ar.call(this,[],t)}n4.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:OI.length,default:OI}]},ur(n4,Fm,{layout(t){let e=t||"tidy";if(In(e6,e))return e6[e]();Dn("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:OI}),Ep.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},ur(Ep,ar,{transform(t,e){let n=this.value,r=e.source&&e.source.root,a=e.fork(e.NO_SOURCE),s={};return r||Dn("TreeLinks transform requires a tree data source."),e.changed(e.ADD_REM)?(a.rem=n,e.visit(e.SOURCE,h=>s[qi(h)]=1),r.each(h=>{let d=h.data,g=h.parent&&h.parent.data;g&&s[qi(d)]&&s[qi(g)]&&a.add.push(Jo({source:g,target:d}))}),this.value=a.add):e.changed(e.MOD)&&(e.visit(e.MOD,h=>s[qi(h)]=1),n.forEach(h=>{(s[qi(h.source)]||s[qi(h.target)])&&a.mod.push(h)})),a}});let n6={binary:function(t,e,n,r,a){var s,h,d=t.children,g=d.length,b=new Array(g+1);for(b[0]=h=s=0;s<g;++s)b[s+1]=h+=d[s].value;(function _(E,I,R,z,P,rt,ot){if(E>=I-1){var at=d[E];return at.x0=z,at.y0=P,at.x1=rt,void(at.y1=ot)}for(var dt=b[E],ct=R/2+dt,Ct=E+1,Et=I-1;Ct<Et;){var Rt=Ct+Et>>>1;b[Rt]<ct?Ct=Rt+1:Et=Rt}ct-b[Ct-1]<b[Ct]-ct&&E+1<Ct&&--Ct;var Ot=b[Ct]-dt,Wt=R-Ot;if(rt-z>ot-P){var jt=R?(z*Wt+rt*Ot)/R:rt;_(E,Ct,Ot,z,P,jt,ot),_(Ct,I,Wt,jt,P,rt,ot)}else{var Ht=R?(P*Wt+ot*Ot)/R:ot;_(E,Ct,Ot,z,P,rt,Ht),_(Ct,I,Wt,z,Ht,rt,ot)}})(0,g,t.value,e,n,r,a)},dice:t4,slice:Q_,slicedice:function(t,e,n,r,a){(1&t.depth?Q_:t4)(t,e,n,r,a)},squarify:Sz,resquarify:zdt},r4=["x0","y0","x1","y1","depth","children"];function r6(t){Fm.call(this,t)}r6.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:r4.length,default:r4}]},ur(r6,Fm,{layout(){let t=function(){var e=Sz,n=!1,r=1,a=1,s=[0],h=X2,d=X2,g=X2,b=X2,_=X2;function E(R){return R.x0=R.y0=0,R.x1=r,R.y1=a,R.eachBefore(I),s=[0],n&&R.eachBefore(wz),R}function I(R){var z=s[R.depth],P=R.x0+z,rt=R.y0+z,ot=R.x1-z,at=R.y1-z;ot<P&&(P=ot=(P+ot)/2),at<rt&&(rt=at=(rt+at)/2),R.x0=P,R.y0=rt,R.x1=ot,R.y1=at,R.children&&(z=s[R.depth+1]=h(R)/2,P+=_(R)-z,rt+=d(R)-z,(ot-=g(R)-z)<P&&(P=ot=(P+ot)/2),(at-=b(R)-z)<rt&&(rt=at=(rt+at)/2),e(R,P,rt,ot,at))}return E.round=function(R){return arguments.length?(n=!!R,E):n},E.size=function(R){return arguments.length?(r=+R[0],a=+R[1],E):[r,a]},E.tile=function(R){return arguments.length?(e=X_(R),E):e},E.padding=function(R){return arguments.length?E.paddingInner(R).paddingOuter(R):E.paddingInner()},E.paddingInner=function(R){return arguments.length?(h=typeof R=="function"?R:Rm(+R),E):h},E.paddingOuter=function(R){return arguments.length?E.paddingTop(R).paddingRight(R).paddingBottom(R).paddingLeft(R):E.paddingTop()},E.paddingTop=function(R){return arguments.length?(d=typeof R=="function"?R:Rm(+R),E):d},E.paddingRight=function(R){return arguments.length?(g=typeof R=="function"?R:Rm(+R),E):g},E.paddingBottom=function(R){return arguments.length?(b=typeof R=="function"?R:Rm(+R),E):b},E.paddingLeft=function(R){return arguments.length?(_=typeof R=="function"?R:Rm(+R),E):_},E}();return t.ratio=e=>{let n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=e=>{In(n6,e)?t.tile(n6[e]):Dn("Unrecognized Treemap layout method: "+e)},t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:r4});function Bdt(t,e,n,r){let a=t.width,s=t.height,h=n||r,d=lp(a,s).getContext("2d");e.forEach(rt=>LI(d,rt,h));let g=new Uint32Array(d.getImageData(0,0,a,s).data.buffer),b=t.bitmap(),_=h&&t.bitmap(),E,I,R,z,P;for(I=0;I<s;++I)for(E=0;E<a;++E)P=4278190080&g[I*a+E],P&&(R=t(E),z=t(I),r||b.set(R,z),h&&268435456^P&&_.set(R,z));return[b,_]}function LI(t,e,n){if(!e.length)return;let r=e[0].mark.marktype;r==="group"?e.forEach(a=>{a.items.forEach(s=>LI(t,s.items,n))}):bh[r].draw(t,{items:n?e.map(jdt):e})}function jdt(t){let e=fE(t,{});return e.stroke&&(e.strokeOpacity=1),e.fill&&(e.fillOpacity=.0625,e.stroke="#000",e.strokeOpacity=1,e.strokeWidth=2),e}let Mo=31,Ch=new Uint32Array(33),Tp=new Uint32Array(33);Tp[0]=0,Ch[0]=~Tp[0];for(let t=1;t<=32;++t)Tp[t]=Tp[t-1]<<1|1,Ch[t]=~Tp[t];function Udt(t,e,n){let r=Math.max(1,Math.sqrt(t*e/1e6)),a=~~((t+2*n+r)/r),s=~~((e+2*n+r)/r),h=d=>~~((d+n)/r);return h.invert=d=>d*r-n,h.bitmap=()=>function(d,g){let b=new Uint32Array(~~((d*g+32)/32));function _(I,R){b[I]|=R}function E(I,R){b[I]&=R}return{array:b,get:(I,R)=>{let z=R*d+I;return b[z>>>5]&1<<(z&Mo)},set:(I,R)=>{let z=R*d+I;_(z>>>5,1<<(z&Mo))},clear:(I,R)=>{let z=R*d+I;E(z>>>5,~(1<<(z&Mo)))},getRange:(I,R,z,P)=>{let rt,ot,at,dt,ct=P;for(;ct>=R;--ct)if(rt=ct*d+I,ot=ct*d+z,at=rt>>>5,dt=ot>>>5,at===dt){if(b[at]&Ch[rt&Mo]&Tp[1+(ot&Mo)])return!0}else{if(b[at]&Ch[rt&Mo]||b[dt]&Tp[1+(ot&Mo)])return!0;for(let Ct=at+1;Ct<dt;++Ct)if(b[Ct])return!0}return!1},setRange:(I,R,z,P)=>{let rt,ot,at,dt,ct;for(;R<=P;++R)if(rt=R*d+I,ot=R*d+z,at=rt>>>5,dt=ot>>>5,at===dt)_(at,Ch[rt&Mo]&Tp[1+(ot&Mo)]);else for(_(at,Ch[rt&Mo]),_(dt,Tp[1+(ot&Mo)]),ct=at+1;ct<dt;++ct)_(ct,4294967295)},clearRange:(I,R,z,P)=>{let rt,ot,at,dt,ct;for(;R<=P;++R)if(rt=R*d+I,ot=R*d+z,at=rt>>>5,dt=ot>>>5,at===dt)E(at,Tp[rt&Mo]|Ch[1+(ot&Mo)]);else for(E(at,Tp[rt&Mo]),E(dt,Ch[1+(ot&Mo)]),ct=at+1;ct<dt;++ct)E(ct,0)},outOfBounds:(I,R,z,P)=>I<0||R<0||P>=g||z>=d}}(a,s),h.ratio=r,h.padding=n,h.width=t,h.height=e,h}function i4(t,e,n,r,a,s){let h=n/2;return t-h<0||t+h>a||e-(h=r/2)<0||e+h>s}function K2(t,e,n,r,a,s,h,d){let g=a*s/(2*r),b=t(e-g),_=t(e+g),E=t(n-(s/=2)),I=t(n+s);return h.outOfBounds(b,E,_,I)||h.getRange(b,E,_,I)||d&&d.getRange(b,E,_,I)}let gc=[-1,-1,1,1],Wdt=[-1,1,-1,1],a4=["right","center","left"],Vdt=["bottom","middle","top"];function $I(t,e,n,r,a,s,h,d,g,b,_,E){return!(a.outOfBounds(t,n,e,r)||(E&&s?s.getRange(t,n,e,r)||!function(I,R,z,P,rt){return rt[0]<=I&&z<=rt[2]&&rt[3]<=R&&P<=rt[5]}(h,g,d,b,_):a.getRange(t,n,e,r)))}let Ez={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},Gdt={naive:function(t,e,n,r){let a=t.width,s=t.height;return function(h){let d=h.datum.datum.items[r].items,g=d.length,b=h.datum.fontSize,_=pp.width(h.datum,h.datum.text),E,I,R,z,P,rt,ot,at=0;for(let dt=0;dt<g;++dt)E=d[dt].x,R=d[dt].y,I=d[dt].x2===void 0?E:d[dt].x2,z=d[dt].y2===void 0?R:d[dt].y2,P=(E+I)/2,rt=(R+z)/2,ot=Math.abs(I-E+z-R),ot>=at&&(at=ot,h.x=P,h.y=rt);return P=_/2,rt=b/2,E=h.x-P,I=h.x+P,R=h.y-rt,z=h.y+rt,h.align="center",E<0&&I<=a?h.align="left":0<=E&&a<I&&(h.align="right"),h.baseline="middle",R<0&&z<=s?h.baseline="top":0<=R&&s<z&&(h.baseline="bottom"),!0}},"reduced-search":function(t,e,n,r){let a=t.width,s=t.height,h=e[0],d=e[1];function g(b,_,E,I,R){let z=t.invert(b),P=t.invert(_),rt,ot=E,at=s;if(!i4(z,P,I,R,a,s)&&!K2(t,z,P,R,I,ot,h,d)&&!K2(t,z,P,R,I,R,h,null)){for(;at-ot>=1;)rt=(ot+at)/2,K2(t,z,P,R,I,rt,h,d)?at=rt:ot=rt;if(ot>E)return[z,P,ot,!0]}}return function(b){let _=b.datum.datum.items[r].items,E=_.length,I=b.datum.fontSize,R=pp.width(b.datum,b.datum.text),z,P,rt,ot,at,dt,ct,Ct,Et,Rt,Ot,Wt,jt,Ht,Vt,fe,se,he=n?I:0,_e=!1,Ve=!1,gn=0;for(let $n=0;$n<E;++$n){for(z=_[$n].x,rt=_[$n].y,P=_[$n].x2===void 0?z:_[$n].x2,ot=_[$n].y2===void 0?rt:_[$n].y2,z>P&&(se=z,z=P,P=se),rt>ot&&(se=rt,rt=ot,ot=se),Et=t(z),Ot=t(P),Rt=~~((Et+Ot)/2),Wt=t(rt),Ht=t(ot),jt=~~((Wt+Ht)/2),ct=Rt;ct>=Et;--ct)for(Ct=jt;Ct>=Wt;--Ct)fe=g(ct,Ct,he,R,I),fe&&([b.x,b.y,he,_e]=fe);for(ct=Rt;ct<=Ot;++ct)for(Ct=jt;Ct<=Ht;++Ct)fe=g(ct,Ct,he,R,I),fe&&([b.x,b.y,he,_e]=fe);_e||n||(Vt=Math.abs(P-z+ot-rt),at=(z+P)/2,dt=(rt+ot)/2,Vt>=gn&&!i4(at,dt,R,I,a,s)&&!K2(t,at,dt,I,R,I,h,null)&&(gn=Vt,b.x=at,b.y=dt,Ve=!0))}return!(!_e&&!Ve)&&(at=R/2,dt=I/2,h.setRange(t(b.x-at),t(b.y-dt),t(b.x+at),t(b.y+dt)),b.align="center",b.baseline="middle",!0)}},floodfill:function(t,e,n,r){let a=t.width,s=t.height,h=e[0],d=e[1],g=t.bitmap();return function(b){let _=b.datum.datum.items[r].items,E=_.length,I=b.datum.fontSize,R=pp.width(b.datum,b.datum.text),z=[],P,rt,ot,at,dt,ct,Ct,Et,Rt,Ot,Wt,jt,Ht=n?I:0,Vt=!1,fe=!1,se=0;for(let he=0;he<E;++he){for(P=_[he].x,ot=_[he].y,rt=_[he].x2===void 0?P:_[he].x2,at=_[he].y2===void 0?ot:_[he].y2,z.push([t((P+rt)/2),t((ot+at)/2)]);z.length;)if([Ct,Et]=z.pop(),!(h.get(Ct,Et)||d.get(Ct,Et)||g.get(Ct,Et))){g.set(Ct,Et);for(let _e=0;_e<4;++_e)dt=Ct+gc[_e],ct=Et+Wdt[_e],g.outOfBounds(dt,ct,dt,ct)||z.push([dt,ct]);if(dt=t.invert(Ct),ct=t.invert(Et),Rt=Ht,Ot=s,!i4(dt,ct,R,I,a,s)&&!K2(t,dt,ct,I,R,Rt,h,d)&&!K2(t,dt,ct,I,R,I,h,null)){for(;Ot-Rt>=1;)Wt=(Rt+Ot)/2,K2(t,dt,ct,I,R,Wt,h,d)?Ot=Wt:Rt=Wt;Rt>Ht&&(b.x=dt,b.y=ct,Ht=Rt,Vt=!0)}}Vt||n||(jt=Math.abs(rt-P+at-ot),dt=(P+rt)/2,ct=(ot+at)/2,jt>=se&&!i4(dt,ct,R,I,a,s)&&!K2(t,dt,ct,I,R,I,h,null)&&(se=jt,b.x=dt,b.y=ct,fe=!0))}return!(!Vt&&!fe)&&(dt=R/2,ct=I/2,h.setRange(t(b.x-dt),t(b.y-ct),t(b.x+dt),t(b.y+ct)),b.align="center",b.baseline="middle",!0)}}};function Hdt(t,e,n,r,a,s,h,d,g,b,_){if(!t.length)return t;let E=Math.max(r.length,a.length),I=function(Ot,Wt){let jt=new Float64Array(Wt),Ht=Ot.length;for(let Vt=0;Vt<Ht;++Vt)jt[Vt]=Ot[Vt]||0;for(let Vt=Ht;Vt<Wt;++Vt)jt[Vt]=jt[Ht-1];return jt}(r,E),R=function(Ot,Wt){let jt=new Int8Array(Wt),Ht=Ot.length;for(let Vt=0;Vt<Ht;++Vt)jt[Vt]|=Ez[Ot[Vt]];for(let Vt=Ht;Vt<Wt;++Vt)jt[Vt]=jt[Ht-1];return jt}(a,E),z=(ct=t[0].datum)&&ct.mark&&ct.mark.marktype,P=z==="group"&&t[0].datum.items[g].marktype,rt=P==="area",ot=function(Ot,Wt,jt,Ht){let Vt=fe=>[fe.x,fe.x,fe.x,fe.y,fe.y,fe.y];return Ot?Ot==="line"||Ot==="area"?fe=>Vt(fe.datum):Wt==="line"?fe=>{let se=fe.datum.items[Ht].items;return Vt(se.length?se[jt==="start"?0:se.length-1]:{x:NaN,y:NaN})}:fe=>{let se=fe.datum.bounds;return[se.x1,(se.x1+se.x2)/2,se.x2,se.y1,(se.y1+se.y2)/2,se.y2]}:Vt}(z,P,d,g),at=Udt(e[0],e[1],b),dt=rt&&_==="naive";var ct;let Ct=t.map(Ot=>({datum:Ot,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:ot(Ot)})),Et;if(!dt){n&&Ct.sort((Wt,jt)=>n(Wt.datum,jt.datum));let Ot=!1;for(let Wt=0;Wt<R.length&&!Ot;++Wt)Ot=R[Wt]===5||I[Wt]<0;z&&(h||rt)&&(s=[t.map(Wt=>Wt.datum)].concat(s)),Et=s.length?Bdt(at,s,Ot,rt):function(Wt,jt){let Ht=Wt.bitmap();return(jt||[]).forEach(Vt=>Ht.set(Wt(Vt.boundary[0]),Wt(Vt.boundary[3]))),[Ht,void 0]}(at,h&&Ct)}let Rt=rt?Gdt[_](at,Et,h,g):function(Ot,Wt,jt,Ht){let Vt=Ot.width,fe=Ot.height,se=Wt[0],he=Wt[1],_e=Ht.length;return function(Ve){let gn=Ve.boundary,$n=Ve.datum.fontSize;if(gn[2]<0||gn[5]<0||gn[0]>Vt||gn[3]>fe)return!1;let Gn,qe,tr,er,An,dn,nr,Qn,wr,yi,ha,mi,si,Ei,ki,Xi=0;for(let Fi=0;Fi<_e;++Fi){if(Gn=(3&jt[Fi])-1,qe=(jt[Fi]>>>2&3)-1,tr=Gn===0&&qe===0||Ht[Fi]<0,er=Gn&&qe?Math.SQRT1_2:1,An=Ht[Fi]<0?-1:1,dn=gn[1+Gn]+Ht[Fi]*Gn*er,ha=gn[4+qe]+An*$n*qe/2+Ht[Fi]*qe*er,Qn=ha-$n/2,wr=ha+$n/2,mi=Ot(dn),Ei=Ot(Qn),ki=Ot(wr),!Xi){if(!$I(mi,mi,Ei,ki,se,he,dn,dn,Qn,wr,gn,tr))continue;Xi=pp.width(Ve.datum,Ve.datum.text)}if(yi=dn+An*Xi*Gn/2,dn=yi-Xi/2,nr=yi+Xi/2,mi=Ot(dn),si=Ot(nr),$I(mi,si,Ei,ki,se,he,dn,nr,Qn,wr,gn,tr))return Ve.x=Gn?Gn*An<0?nr:dn:yi,Ve.y=qe?qe*An<0?wr:Qn:ha,Ve.align=a4[Gn*An+1],Ve.baseline=Vdt[qe*An+1],se.setRange(mi,Ei,si,ki),!0}return!1}}(at,Et,R,I);return Ct.forEach(Ot=>Ot.opacity=+Rt(Ot)),Ct}let yc=["x","y","opacity","align","baseline"],Ap=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function Ef(t){ar.call(this,null,t)}function i6(t,e){var n,r,a,s,h,d,g=[],b=function(_){return _(s)};if(e==null)g.push(t);else for(n={},r=0,a=t.length;r<a;++r)s=t[r],(d=n[h=e.map(b)])||(n[h]=d=[],d.dims=h,g.push(d)),d.push(s);return g}function a6(t){ar.call(this,null,t)}Ef.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:Ap},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:yc.length,default:yc}]},ur(Ef,ar,{transform(t,e){let n=t.modified();if(!(n||e.changed(e.ADD_REM)||function(a){let s=t[a];return ut(s)&&e.modified(s.fields)}("sort")))return;t.size&&t.size.length===2||Dn("Size parameter should be specified as a [width, height] array.");let r=t.as||yc;return Hdt(e.materialize(e.SOURCE).source,t.size,t.sort,et(t.offset||1),et(t.anchor||Ap),t.avoidMarks||[],t.avoidBaseMark!==!1,t.lineAnchor||"end",t.markIndex||0,t.padding||0,t.method||"naive").forEach(a=>{let s=a.datum;s[r[0]]=a.x,s[r[1]]=a.y,s[r[2]]=a.opacity,s[r[3]]=a.align,s[r[4]]=a.baseline}),e.reflow(n).modifies(r)}}),a6.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},ur(a6,ar,{transform(t,e){let n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){let r=i6(e.materialize(e.SOURCE).source,t.groupby),a=(t.groupby||[]).map(_a),s=a.length,h=t.as||[_a(t.x),_a(t.y)],d=[];r.forEach(g=>{(function(b,_,E,I){let[R,z,P,rt]=tS(b,_,E,!0),ot=R.length,at=Math.max(2,~~(I*ot)),dt=new Float64Array(ot),ct=new Float64Array(ot),Ct=new Float64Array(ot).fill(1);for(let Et=-1;++Et<=2;){let Rt=[0,at-1];for(let Wt=0;Wt<ot;++Wt){let jt=R[Wt],Ht=Rt[0],Vt=Rt[1],fe=jt-R[Ht]>R[Vt]-jt?Ht:Vt,se=0,he=0,_e=0,Ve=0,gn=0,$n=1/Math.abs(R[fe]-jt||1);for(let tr=Ht;tr<=Vt;++tr){let er=R[tr],An=z[tr],dn=vH(Math.abs(jt-er)*$n)*Ct[tr],nr=er*dn;se+=dn,he+=nr,_e+=An*dn,Ve+=An*nr,gn+=er*nr}let[Gn,qe]=Nv(he/se,_e/se,Ve/se,gn/se);dt[Wt]=Gn+qe*jt,ct[Wt]=Math.abs(z[Wt]-dt[Wt]),YR(R,Wt+1,Rt)}if(Et===2)break;let Ot=$R(ct);if(Math.abs(Ot)<1e-12)break;for(let Wt,jt,Ht=0;Ht<ot;++Ht)Wt=ct[Ht]/(6*Ot),Ct[Ht]=Wt>=1?1e-12:(jt=1-Wt*Wt)*jt}return function(Et,Rt,Ot,Wt){let jt=Et.length,Ht=[],Vt,fe=0,se=0,he=[];for(;fe<jt;++fe)Vt=Et[fe]+Ot,he[0]===Vt?he[1]+=(Rt[fe]-he[1])/++se:(se=0,he[1]+=Wt,he=[Vt,Rt[fe]],Ht.push(he));return he[1]+=Wt,Ht}(R,dt,P,rt)})(g,t.x,t.y,t.bandwidth||.3).forEach(b=>{let _={};for(let E=0;E<s;++E)_[a[E]]=g.dims[E];_[h[0]]=b[0],_[h[1]]=b[1],d.push(Jo(_))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=d}return n}});let Tz={linear:GR,log:function(t,e,n){let r=0,a=0,s=0,h=0,d=0;Mv(t,e,n,(_,E)=>{++d,_=Math.log(_),r+=(_-r)/d,a+=(E-a)/d,s+=(_*E-s)/d,h+=(_*_-h)/d});let g=Nv(r,a,s,h),b=_=>g[0]+g[1]*Math.log(_);return{coef:g,predict:b,rSquared:g2(t,e,n,a,b)}},exp:function(t,e,n){let[r,a,s,h]=tS(t,e,n),d,g,b,_=0,E=0,I=0,R=0,z=0;Mv(t,e,n,(at,dt)=>{d=r[z++],g=Math.log(dt),b=d*dt,_+=(dt*g-_)/z,E+=(b-E)/z,I+=(b*g-I)/z,R+=(d*b-R)/z});let[P,rt]=Nv(E/h,_/h,I/h,R/h),ot=at=>Math.exp(P+rt*(at-s));return{coef:[Math.exp(P-rt*s),rt],predict:ot,rSquared:g2(t,e,n,h,ot)}},pow:function(t,e,n){let r=0,a=0,s=0,h=0,d=0,g=0;Mv(t,e,n,(E,I)=>{let R=Math.log(E),z=Math.log(I);++g,r+=(R-r)/g,a+=(z-a)/g,s+=(R*z-s)/g,h+=(R*R-h)/g,d+=(I-d)/g});let b=Nv(r,a,s,h),_=E=>b[0]*Math.pow(E,b[1]);return b[0]=Math.exp(b[0]),{coef:b,predict:_,rSquared:g2(t,e,n,d,_)}},quad:DE,poly:function(t,e,n,r){if(r===0)return function(dt,ct,Ct){let Et=0,Rt=0;for(let Ot of dt){let Wt=Ct(Ot);ct(Ot)==null||Wt==null||isNaN(Wt)||(Et+=(Wt-Et)/++Rt)}return{coef:[Et],predict:()=>Et,rSquared:0}}(t,e,n);if(r===1)return GR(t,e,n);if(r===2)return DE(t,e,n);let[a,s,h,d]=tS(t,e,n),g=a.length,b=[],_=[],E=r+1,I,R,z,P,rt;for(I=0;I<E;++I){for(z=0,P=0;z<g;++z)P+=Math.pow(a[z],I)*s[z];for(b.push(P),rt=new Float64Array(E),R=0;R<E;++R){for(z=0,P=0;z<g;++z)P+=Math.pow(a[z],I+R);rt[R]=P}_.push(rt)}_.push(b);let ot=function(dt){let ct=dt.length-1,Ct=[],Et,Rt,Ot,Wt,jt;for(Et=0;Et<ct;++Et){for(Wt=Et,Rt=Et+1;Rt<ct;++Rt)Math.abs(dt[Et][Rt])>Math.abs(dt[Et][Wt])&&(Wt=Rt);for(Ot=Et;Ot<ct+1;++Ot)jt=dt[Ot][Et],dt[Ot][Et]=dt[Ot][Wt],dt[Ot][Wt]=jt;for(Rt=Et+1;Rt<ct;++Rt)for(Ot=ct;Ot>=Et;Ot--)dt[Ot][Rt]-=dt[Ot][Et]*dt[Et][Rt]/dt[Et][Et]}for(Rt=ct-1;Rt>=0;--Rt){for(jt=0,Ot=Rt+1;Ot<ct;++Ot)jt+=dt[Ot][Rt]*Ct[Ot];Ct[Rt]=(dt[ct][Rt]-jt)/dt[Rt][Rt]}return Ct}(_),at=dt=>{dt-=h;let ct=d+ot[0]+ot[1]*dt+ot[2]*dt*dt;for(I=3;I<E;++I)ct+=ot[I]*Math.pow(dt,I);return ct};return{coef:HR(E,ot,-h,d),predict:at,rSquared:g2(t,e,n,d,at)}}};function Az(t){ar.call(this,null,t)}Az.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(Tz)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},ur(Az,ar,{transform(t,e){let n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){let r=i6(e.materialize(e.SOURCE).source,t.groupby),a=(t.groupby||[]).map(_a),s=t.method||"linear",h=t.order||3,d=((I,R)=>I==="poly"?R:I==="quad"?2:1)(s,h),g=t.as||[_a(t.x),_a(t.y)],b=Tz[s],_=[],E=t.extent;In(Tz,s)||Dn("Invalid regression method: "+s),E!=null&&s==="log"&&E[0]<=0&&(e.dataflow.warn("Ignoring extent with values <= 0 for log regression."),E=null),r.forEach(I=>{if(I.length<=d)return void e.dataflow.warn("Skipping regression with more parameters than data points.");let R=b(I,t.x,t.y,h);if(t.params)return void _.push(Jo({keys:I.dims,coef:R.coef,rSquared:R.rSquared}));let z=E||un(I,t.x),P=rt=>{let ot={};for(let at=0;at<a.length;++at)ot[a[at]]=I.dims[at];ot[g[0]]=rt[0],ot[g[1]]=rt[1],_.push(Jo(ot))};s==="linear"?z.forEach(rt=>P([rt,R.predict(rt)])):eS(R.predict,z,25,200).forEach(P)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=_}return n}});let zI=Math.pow(2,-52),o6=new Uint32Array(512);class s6{static from(e,n=Ydt,r=qdt){let a=e.length,s=new Float64Array(2*a);for(let h=0;h<a;h++){let d=e[h];s[2*h]=n(d),s[2*h+1]=r(d)}return new s6(s)}constructor(e){let n=e.length>>1;if(n>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;let r=Math.max(2*n-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){let{coords:e,_hullPrev:n,_hullNext:r,_hullTri:a,_hullHash:s}=this,h=e.length>>1,d=1/0,g=1/0,b=-1/0,_=-1/0;for(let jt=0;jt<h;jt++){let Ht=e[2*jt],Vt=e[2*jt+1];Ht<d&&(d=Ht),Vt<g&&(g=Vt),Ht>b&&(b=Ht),Vt>_&&(_=Vt),this._ids[jt]=jt}let E=(d+b)/2,I=(g+_)/2,R,z,P,rt=1/0;for(let jt=0;jt<h;jt++){let Ht=o4(E,I,e[2*jt],e[2*jt+1]);Ht<rt&&(R=jt,rt=Ht)}let ot=e[2*R],at=e[2*R+1];rt=1/0;for(let jt=0;jt<h;jt++){if(jt===R)continue;let Ht=o4(ot,at,e[2*jt],e[2*jt+1]);Ht<rt&&Ht>0&&(z=jt,rt=Ht)}let dt=e[2*z],ct=e[2*z+1],Ct=1/0;for(let jt=0;jt<h;jt++){if(jt===R||jt===z)continue;let Ht=hQ(ot,at,dt,ct,e[2*jt],e[2*jt+1]);Ht<Ct&&(P=jt,Ct=Ht)}let Et=e[2*P],Rt=e[2*P+1];if(Ct===1/0){for(let Vt=0;Vt<h;Vt++)this._dists[Vt]=e[2*Vt]-e[0]||e[2*Vt+1]-e[1];Cb(this._ids,this._dists,0,h-1);let jt=new Uint32Array(h),Ht=0;for(let Vt=0,fe=-1/0;Vt<h;Vt++){let se=this._ids[Vt];this._dists[se]>fe&&(jt[Ht++]=se,fe=this._dists[se])}return this.hull=jt.subarray(0,Ht),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(s4(ot,at,dt,ct,Et,Rt)){let jt=z,Ht=dt,Vt=ct;z=P,dt=Et,ct=Rt,P=jt,Et=Ht,Rt=Vt}let Ot=function(jt,Ht,Vt,fe,se,he){let _e=Vt-jt,Ve=fe-Ht,gn=se-jt,$n=he-Ht,Gn=_e*_e+Ve*Ve,qe=gn*gn+$n*$n,tr=.5/(_e*$n-Ve*gn),er=jt+($n*Gn-Ve*qe)*tr,An=Ht+(_e*qe-gn*Gn)*tr;return{x:er,y:An}}(ot,at,dt,ct,Et,Rt);this._cx=Ot.x,this._cy=Ot.y;for(let jt=0;jt<h;jt++)this._dists[jt]=o4(e[2*jt],e[2*jt+1],Ot.x,Ot.y);Cb(this._ids,this._dists,0,h-1),this._hullStart=R;let Wt=3;r[R]=n[P]=z,r[z]=n[R]=P,r[P]=n[z]=R,a[R]=0,a[z]=1,a[P]=2,s.fill(-1),s[this._hashKey(ot,at)]=R,s[this._hashKey(dt,ct)]=z,s[this._hashKey(Et,Rt)]=P,this.trianglesLen=0,this._addTriangle(R,z,P,-1,-1,-1);for(let jt,Ht,Vt=0;Vt<this._ids.length;Vt++){let fe=this._ids[Vt],se=e[2*fe],he=e[2*fe+1];if(Vt>0&&Math.abs(se-jt)<=zI&&Math.abs(he-Ht)<=zI||(jt=se,Ht=he,fe===R||fe===z||fe===P))continue;let _e=0;for(let qe=0,tr=this._hashKey(se,he);qe<this._hashSize&&(_e=s[(tr+qe)%this._hashSize],_e===-1||_e===r[_e]);qe++);_e=n[_e];let Ve,gn=_e;for(;Ve=r[gn],!s4(se,he,e[2*gn],e[2*gn+1],e[2*Ve],e[2*Ve+1]);)if(gn=Ve,gn===_e){gn=-1;break}if(gn===-1)continue;let $n=this._addTriangle(gn,fe,r[gn],-1,-1,a[gn]);a[fe]=this._legalize($n+2),a[gn]=$n,Wt++;let Gn=r[gn];for(;Ve=r[Gn],s4(se,he,e[2*Gn],e[2*Gn+1],e[2*Ve],e[2*Ve+1]);)$n=this._addTriangle(Gn,fe,Ve,a[fe],-1,a[Gn]),a[fe]=this._legalize($n+2),r[Gn]=Gn,Wt--,Gn=Ve;if(gn===_e)for(;Ve=n[gn],s4(se,he,e[2*Ve],e[2*Ve+1],e[2*gn],e[2*gn+1]);)$n=this._addTriangle(Ve,fe,gn,-1,a[gn],a[Ve]),this._legalize($n+2),a[Ve]=$n,r[gn]=gn,Wt--,gn=Ve;this._hullStart=n[fe]=gn,r[gn]=n[Gn]=fe,r[fe]=Gn,s[this._hashKey(se,he)]=fe,s[this._hashKey(e[2*gn],e[2*gn+1])]=gn}this.hull=new Uint32Array(Wt);for(let jt=0,Ht=this._hullStart;jt<Wt;jt++)this.hull[jt]=Ht,Ht=r[Ht];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,n){return Math.floor(function(r,a){let s=r/(Math.abs(r)+Math.abs(a));return(a>0?3-s:1+s)/4}(e-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(e){let{_triangles:n,_halfedges:r,coords:a}=this,s=0,h=0;for(;;){let d=r[e],g=e-e%3;if(h=g+(e+2)%3,d===-1){if(s===0)break;e=o6[--s];continue}let b=d-d%3,_=g+(e+1)%3,E=b+(d+2)%3,I=n[h],R=n[e],z=n[_],P=n[E];if(cQ(a[2*I],a[2*I+1],a[2*R],a[2*R+1],a[2*z],a[2*z+1],a[2*P],a[2*P+1])){n[e]=P,n[d]=I;let rt=r[E];if(rt===-1){let at=this._hullStart;do{if(this._hullTri[at]===E){this._hullTri[at]=e;break}at=this._hullPrev[at]}while(at!==this._hullStart)}this._link(e,rt),this._link(d,r[h]),this._link(h,E);let ot=b+(d+1)%3;s<o6.length&&(o6[s++]=ot)}else{if(s===0)break;e=o6[--s]}}return h}_link(e,n){this._halfedges[e]=n,n!==-1&&(this._halfedges[n]=e)}_addTriangle(e,n,r,a,s,h){let d=this.trianglesLen;return this._triangles[d]=e,this._triangles[d+1]=n,this._triangles[d+2]=r,this._link(d,a),this._link(d+1,s),this._link(d+2,h),this.trianglesLen+=3,d}}function o4(t,e,n,r){let a=t-n,s=e-r;return a*a+s*s}function PI(t,e,n,r,a,s){let h=(r-e)*(a-t),d=(n-t)*(s-e);return Math.abs(h-d)>=33306690738754716e-32*Math.abs(h+d)?h-d:0}function s4(t,e,n,r,a,s){return(PI(a,s,t,e,n,r)||PI(t,e,n,r,a,s)||PI(n,r,a,s,t,e))<0}function cQ(t,e,n,r,a,s,h,d){let g=t-h,b=e-d,_=n-h,E=r-d,I=a-h,R=s-d,z=_*_+E*E,P=I*I+R*R;return g*(E*P-z*R)-b*(_*P-z*I)+(g*g+b*b)*(_*R-E*I)<0}function hQ(t,e,n,r,a,s){let h=n-t,d=r-e,g=a-t,b=s-e,_=h*h+d*d,E=g*g+b*b,I=.5/(h*b-d*g),R=(b*_-d*E)*I,z=(h*E-g*_)*I;return R*R+z*z}function Cb(t,e,n,r){if(r-n<=20)for(let a=n+1;a<=r;a++){let s=t[a],h=e[s],d=a-1;for(;d>=n&&e[t[d]]>h;)t[d+1]=t[d--];t[d+1]=s}else{let a=n+1,s=r;u6(t,n+r>>1,a),e[t[n]]>e[t[r]]&&u6(t,n,r),e[t[a]]>e[t[r]]&&u6(t,a,r),e[t[n]]>e[t[a]]&&u6(t,n,a);let h=t[a],d=e[h];for(;;){do a++;while(e[t[a]]<d);do s--;while(e[t[s]]>d);if(s<a)break;u6(t,a,s)}t[n+1]=t[s],t[s]=h,r-a+1>=s-n?(Cb(t,e,a,r),Cb(t,e,n,s-1)):(Cb(t,e,n,s-1),Cb(t,e,a,r))}}function u6(t,e,n){let r=t[e];t[e]=t[n],t[n]=r}function Ydt(t){return t[0]}function qdt(t){return t[1]}let dQ=1e-6;class Eb{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,n){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,n){this._+=`L${this._x1=+e},${this._y1=+n}`}arc(e,n,r){let a=(e=+e)+(r=+r),s=n=+n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${a},${s}`:(Math.abs(this._x1-a)>dQ||Math.abs(this._y1-s)>dQ)&&(this._+="L"+a+","+s),r&&(this._+=`A${r},${r},0,1,1,${e-r},${n}A${r},${r},0,1,1,${this._x1=a},${this._y1=s}`)}rect(e,n,r,a){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${+r}v${+a}h${-r}Z`}value(){return this._||null}}class Iz{constructor(){this._=[]}moveTo(e,n){this._.push([e,n])}closePath(){this._.push(this._[0].slice())}lineTo(e,n){this._.push([e,n])}value(){return this._.length?this._:null}}class Xdt{constructor(e,[n,r,a,s]=[0,0,960,500]){if(!((a=+a)>=(n=+n)&&(s=+s)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(2*e.points.length),this.vectors=new Float64Array(2*e.points.length),this.xmax=a,this.xmin=n,this.ymax=s,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){let{delaunay:{points:e,hull:n,triangles:r},vectors:a}=this,s=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let R,z,P=0,rt=0,ot=r.length;P<ot;P+=3,rt+=2){let at=2*r[P],dt=2*r[P+1],ct=2*r[P+2],Ct=e[at],Et=e[at+1],Rt=e[dt],Ot=e[dt+1],Wt=e[ct],jt=e[ct+1],Ht=Rt-Ct,Vt=Ot-Et,fe=Wt-Ct,se=jt-Et,he=Ht*Ht+Vt*Vt,_e=fe*fe+se*se,Ve=2*(Ht*se-Vt*fe);if(Ve)if(Math.abs(Ve)<1e-8)R=(Ct+Wt)/2,z=(Et+jt)/2;else{let gn=1/Ve;R=Ct+(se*he-Vt*_e)*gn,z=Et+(Ht*_e-fe*he)*gn}else R=(Ct+Wt)/2-1e8*se,z=(Et+jt)/2+1e8*fe;s[rt]=R,s[rt+1]=z}let h,d,g,b=n[n.length-1],_=4*b,E=e[2*b],I=e[2*b+1];a.fill(0);for(let R=0;R<n.length;++R)b=n[R],h=_,d=E,g=I,_=4*b,E=e[2*b],I=e[2*b+1],a[h+2]=a[_]=g-I,a[h+3]=a[_+1]=E-d}render(e){let n=e==null?e=new Eb:void 0,{delaunay:{halfedges:r,inedges:a,hull:s},circumcenters:h,vectors:d}=this;if(s.length<=1)return null;for(let _=0,E=r.length;_<E;++_){let I=r[_];if(I<_)continue;let R=2*Math.floor(_/3),z=2*Math.floor(I/3),P=h[R],rt=h[R+1],ot=h[z],at=h[z+1];this._renderSegment(P,rt,ot,at,e)}let g,b=s[s.length-1];for(let _=0;_<s.length;++_){g=b,b=s[_];let E=2*Math.floor(a[b]/3),I=h[E],R=h[E+1],z=4*g,P=this._project(I,R,d[z+2],d[z+3]);P&&this._renderSegment(I,R,P[0],P[1],e)}return n&&n.value()}renderBounds(e){let n=e==null?e=new Eb:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(e,n){let r=n==null?n=new Eb:void 0,a=this._clip(e);if(a===null||!a.length)return;n.moveTo(a[0],a[1]);let s=a.length;for(;a[0]===a[s-2]&&a[1]===a[s-1]&&s>1;)s-=2;for(let h=2;h<s;h+=2)a[h]===a[h-2]&&a[h+1]===a[h-1]||n.lineTo(a[h],a[h+1]);return n.closePath(),r&&r.value()}*cellPolygons(){let{delaunay:{points:e}}=this;for(let n=0,r=e.length/2;n<r;++n){let a=this.cellPolygon(n);a&&(a.index=n,yield a)}}cellPolygon(e){let n=new Iz;return this.renderCell(e,n),n.value()}_renderSegment(e,n,r,a,s){let h,d=this._regioncode(e,n),g=this._regioncode(r,a);d===0&&g===0?(s.moveTo(e,n),s.lineTo(r,a)):(h=this._clipSegment(e,n,r,a,d,g))&&(s.moveTo(h[0],h[1]),s.lineTo(h[2],h[3]))}contains(e,n,r){return(n=+n)==n&&(r=+r)==r&&this.delaunay._step(e,n,r)===e}*neighbors(e){let n=this._clip(e);if(n)for(let r of this.delaunay.neighbors(e)){let a=this._clip(r);if(a){t:for(let s=0,h=n.length;s<h;s+=2)for(let d=0,g=a.length;d<g;d+=2)if(n[s]==a[d]&&n[s+1]==a[d+1]&&n[(s+2)%h]==a[(d+g-2)%g]&&n[(s+3)%h]==a[(d+g-1)%g]){yield r;break t}}}}_cell(e){let{circumcenters:n,delaunay:{inedges:r,halfedges:a,triangles:s}}=this,h=r[e];if(h===-1)return null;let d=[],g=h;do{let b=Math.floor(g/3);if(d.push(n[2*b],n[2*b+1]),g=g%3==2?g-2:g+1,s[g]!==e)break;g=a[g]}while(g!==h&&g!==-1);return d}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];let n=this._cell(e);if(n===null)return null;let{vectors:r}=this,a=4*e;return r[a]||r[a+1]?this._clipInfinite(e,n,r[a],r[a+1],r[a+2],r[a+3]):this._clipFinite(e,n)}_clipFinite(e,n){let r=n.length,a,s,h,d,g,b=null,_=n[r-2],E=n[r-1],I=this._regioncode(_,E);for(let R=0;R<r;R+=2)if(a=_,s=E,_=n[R],E=n[R+1],h=I,I=this._regioncode(_,E),h===0&&I===0)d=g,g=0,b?b.push(_,E):b=[_,E];else{let z,P,rt,ot,at;if(h===0){if((z=this._clipSegment(a,s,_,E,h,I))===null)continue;[P,rt,ot,at]=z}else{if((z=this._clipSegment(_,E,a,s,I,h))===null)continue;[ot,at,P,rt]=z,d=g,g=this._edgecode(P,rt),d&&g&&this._edge(e,d,g,b,b.length),b?b.push(P,rt):b=[P,rt]}d=g,g=this._edgecode(ot,at),d&&g&&this._edge(e,d,g,b,b.length),b?b.push(ot,at):b=[ot,at]}if(b)d=g,g=this._edgecode(b[0],b[1]),d&&g&&this._edge(e,d,g,b,b.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return b}_clipSegment(e,n,r,a,s,h){for(;;){if(s===0&&h===0)return[e,n,r,a];if(s&h)return null;let d,g,b=s||h;8&b?(d=e+(r-e)*(this.ymax-n)/(a-n),g=this.ymax):4&b?(d=e+(r-e)*(this.ymin-n)/(a-n),g=this.ymin):2&b?(g=n+(a-n)*(this.xmax-e)/(r-e),d=this.xmax):(g=n+(a-n)*(this.xmin-e)/(r-e),d=this.xmin),s?(e=d,n=g,s=this._regioncode(e,n)):(r=d,a=g,h=this._regioncode(r,a))}}_clipInfinite(e,n,r,a,s,h){let d,g=Array.from(n);if((d=this._project(g[0],g[1],r,a))&&g.unshift(d[0],d[1]),(d=this._project(g[g.length-2],g[g.length-1],s,h))&&g.push(d[0],d[1]),g=this._clipFinite(e,g))for(let b,_=0,E=g.length,I=this._edgecode(g[E-2],g[E-1]);_<E;_+=2)b=I,I=this._edgecode(g[_],g[_+1]),b&&I&&(_=this._edge(e,b,I,g,_),E=g.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(g=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return g}_edge(e,n,r,a,s){for(;n!==r;){let h,d;switch(n){case 5:n=4;continue;case 4:n=6,h=this.xmax,d=this.ymin;break;case 6:n=2;continue;case 2:n=10,h=this.xmax,d=this.ymax;break;case 10:n=8;continue;case 8:n=9,h=this.xmin,d=this.ymax;break;case 9:n=1;continue;case 1:n=5,h=this.xmin,d=this.ymin}a[s]===h&&a[s+1]===d||!this.contains(e,h,d)||(a.splice(s,0,h,d),s+=2)}if(a.length>4)for(let h=0;h<a.length;h+=2){let d=(h+2)%a.length,g=(h+4)%a.length;(a[h]===a[d]&&a[d]===a[g]||a[h+1]===a[d+1]&&a[d+1]===a[g+1])&&(a.splice(d,2),h-=2)}return s}_project(e,n,r,a){let s,h,d,g=1/0;if(a<0){if(n<=this.ymin)return null;(s=(this.ymin-n)/a)<g&&(d=this.ymin,h=e+(g=s)*r)}else if(a>0){if(n>=this.ymax)return null;(s=(this.ymax-n)/a)<g&&(d=this.ymax,h=e+(g=s)*r)}if(r>0){if(e>=this.xmax)return null;(s=(this.xmax-e)/r)<g&&(h=this.xmax,d=n+(g=s)*a)}else if(r<0){if(e<=this.xmin)return null;(s=(this.xmin-e)/r)<g&&(h=this.xmin,d=n+(g=s)*a)}return[h,d]}_edgecode(e,n){return(e===this.xmin?1:e===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(e,n){return(e<this.xmin?1:e>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}let fQ=2*Math.PI,Tb=Math.pow;function BI(t){return t[0]}function Kdt(t){return t[1]}function Nz(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class l6{static from(e,n=BI,r=Kdt,a){return new l6("length"in e?function(s,h,d,g){let b=s.length,_=new Float64Array(2*b);for(let E=0;E<b;++E){let I=s[E];_[2*E]=h.call(g,I,E,s),_[2*E+1]=d.call(g,I,E,s)}return _}(e,n,r,a):Float64Array.from(function*(s,h,d,g){let b=0;for(let _ of s)yield h.call(g,_,b,s),yield d.call(g,_,b,s),++b}(e,n,r,a)))}constructor(e){this._delaunator=new s6(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){let e=this._delaunator,n=this.points;if(e.hull&&e.hull.length>2&&function(g){let{triangles:b,coords:_}=g;for(let E=0;E<b.length;E+=3){let I=2*b[E],R=2*b[E+1],z=2*b[E+2];if((_[z]-_[I])*(_[R+1]-_[I+1])-(_[R]-_[I])*(_[z+1]-_[I+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:n.length/2},(I,R)=>R).sort((I,R)=>n[2*I]-n[2*R]||n[2*I+1]-n[2*R+1]);let g=this.collinear[0],b=this.collinear[this.collinear.length-1],_=[n[2*g],n[2*g+1],n[2*b],n[2*b+1]],E=1e-8*Math.hypot(_[3]-_[1],_[2]-_[0]);for(let I=0,R=n.length/2;I<R;++I){let z=Nz(n[2*I],n[2*I+1],E);n[2*I]=z[0],n[2*I+1]=z[1]}this._delaunator=new s6(n)}else delete this.collinear;let r=this.halfedges=this._delaunator.halfedges,a=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,h=this.inedges.fill(-1),d=this._hullIndex.fill(-1);for(let g=0,b=r.length;g<b;++g){let _=s[g%3==2?g-2:g+1];r[g]!==-1&&h[_]!==-1||(h[_]=g)}for(let g=0,b=a.length;g<b;++g)d[a[g]]=g;a.length<=2&&a.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=a[0],this.triangles[1]=a[1],this.triangles[2]=a[1],h[a[0]]=1,a.length===2&&(h[a[1]]=0))}voronoi(e){return new Xdt(this,e)}*neighbors(e){let{inedges:n,hull:r,_hullIndex:a,halfedges:s,triangles:h,collinear:d}=this;if(d){let E=d.indexOf(e);return E>0&&(yield d[E-1]),void(E<d.length-1&&(yield d[E+1]))}let g=n[e];if(g===-1)return;let b=g,_=-1;do{if(yield _=h[b],b=b%3==2?b-2:b+1,h[b]!==e)return;if(b=s[b],b===-1){let E=r[(a[e]+1)%r.length];return void(E!==_&&(yield E))}}while(b!==g)}find(e,n,r=0){if((e=+e)!=e||(n=+n)!=n)return-1;let a=r,s;for(;(s=this._step(r,e,n))>=0&&s!==r&&s!==a;)r=s;return s}_step(e,n,r){let{inedges:a,hull:s,_hullIndex:h,halfedges:d,triangles:g,points:b}=this;if(a[e]===-1||!b.length)return(e+1)%(b.length>>1);let _=e,E=Tb(n-b[2*e],2)+Tb(r-b[2*e+1],2),I=a[e],R=I;do{let z=g[R],P=Tb(n-b[2*z],2)+Tb(r-b[2*z+1],2);if(P<E&&(E=P,_=z),R=R%3==2?R-2:R+1,g[R]!==e)break;if(R=d[R],R===-1){if(R=s[(h[e]+1)%s.length],R!==z&&Tb(n-b[2*R],2)+Tb(r-b[2*R+1],2)<E)return R;break}}while(R!==I);return _}render(e){let n=e==null?e=new Eb:void 0,{points:r,halfedges:a,triangles:s}=this;for(let h=0,d=a.length;h<d;++h){let g=a[h];if(g<h)continue;let b=2*s[h],_=2*s[g];e.moveTo(r[b],r[b+1]),e.lineTo(r[_],r[_+1])}return this.renderHull(e),n&&n.value()}renderPoints(e,n=2){let r=e==null?e=new Eb:void 0,{points:a}=this;for(let s=0,h=a.length;s<h;s+=2){let d=a[s],g=a[s+1];e.moveTo(d+n,g),e.arc(d,g,n,0,fQ)}return r&&r.value()}renderHull(e){let n=e==null?e=new Eb:void 0,{hull:r,points:a}=this,s=2*r[0],h=r.length;e.moveTo(a[s],a[s+1]);for(let d=1;d<h;++d){let g=2*r[d];e.lineTo(a[g],a[g+1])}return e.closePath(),n&&n.value()}hullPolygon(){let e=new Iz;return this.renderHull(e),e.value()}renderTriangle(e,n){let r=n==null?n=new Eb:void 0,{points:a,triangles:s}=this,h=2*s[e*=3],d=2*s[e+1],g=2*s[e+2];return n.moveTo(a[h],a[h+1]),n.lineTo(a[d],a[d+1]),n.lineTo(a[g],a[g+1]),n.closePath(),r&&r.value()}*trianglePolygons(){let{triangles:e}=this;for(let n=0,r=e.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(e){let n=new Iz;return this.renderTriangle(e,n),n.value()}}function Mz(t){ar.call(this,null,t)}Mz.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};let Zdt=[-1e5,-1e5,1e5,1e5];function Qdt(t){let e=t[0][0],n=t[0][1],r=t.length-1;for(;t[r][0]===e&&t[r][1]===n;--r);return"M"+t.slice(0,r+1).join("L")+"Z"}ur(Mz,ar,{transform(t,e){let n=t.as||"path",r=e.source;if(!r||!r.length)return e;let a=t.size;a=a?[0,0,a[0],a[1]]:(a=t.extent)?[a[0][0],a[0][1],a[1][0],a[1][1]]:Zdt;let s=this.value=l6.from(r,t.x,t.y).voronoi(a);for(let h=0,d=r.length;h<d;++h){let g=s.cellPolygon(h);r[h][n]=g?Qdt(g):null}return e.reflow(t.modified()).modifies(n)}});var Dz=Math.PI/180,c6=64,jI=2048;function Jdt(){var t,e,n,r,a,s,h,d=[256,256],g=pQ,b=[],_=Math.random,E={};function I(R,z,P){for(var rt,ot,at,dt=z.x,ct=z.y,Ct=Math.hypot(d[0],d[1]),Et=g(d),Rt=_()<.5?1:-1,Ot=-Rt;(rt=Et(Ot+=Rt))&&(ot=~~rt[0],at=~~rt[1],!(Math.min(Math.abs(ot),Math.abs(at))>=Ct));)if(z.x=dt+ot,z.y=ct+at,!(z.x+z.x0<0||z.y+z.y0<0||z.x+z.x1>d[0]||z.y+z.y1>d[1])&&(!P||!eft(z,R,d[0]))&&(!P||rft(z,P))){for(var Wt,jt=z.sprite,Ht=z.width>>5,Vt=d[0]>>5,fe=z.x-(Ht<<4),se=127&fe,he=32-se,_e=z.y1-z.y0,Ve=(z.y+z.y0)*Vt+(fe>>5),gn=0;gn<_e;gn++){Wt=0;for(var $n=0;$n<=Ht;$n++)R[Ve+$n]|=Wt<<he|($n<Ht?(Wt=jt[gn*Ht+$n])>>>se:0);Ve+=Vt}return z.sprite=null,!0}return!1}return E.layout=function(){for(var R=function(Ct){Ct.width=Ct.height=1;var Et=Math.sqrt(Ct.getContext("2d").getImageData(0,0,1,1).data.length>>2);Ct.width=(c6<<5)/Et,Ct.height=jI/Et;var Rt=Ct.getContext("2d");return Rt.fillStyle=Rt.strokeStyle="red",Rt.textAlign="center",{context:Rt,ratio:Et}}(lp()),z=function(Ct){for(var Et=[],Rt=-1;++Rt<Ct;)Et[Rt]=0;return Et}((d[0]>>5)*d[1]),P=null,rt=b.length,ot=-1,at=[],dt=b.map(Ct=>({text:t(Ct),font:e(Ct),style:r(Ct),weight:a(Ct),rotate:s(Ct),size:~~(n(Ct)+1e-14),padding:h(Ct),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:Ct})).sort((Ct,Et)=>Et.size-Ct.size);++ot<rt;){var ct=dt[ot];ct.x=d[0]*(_()+.5)>>1,ct.y=d[1]*(_()+.5)>>1,tft(R,ct,dt,ot),ct.hasText&&I(z,ct,P)&&(at.push(ct),P?nft(P,ct):P=[{x:ct.x+ct.x0,y:ct.y+ct.y0},{x:ct.x+ct.x1,y:ct.y+ct.y1}],ct.x-=d[0]>>1,ct.y-=d[1]>>1)}return at},E.words=function(R){return arguments.length?(b=R,E):b},E.size=function(R){return arguments.length?(d=[+R[0],+R[1]],E):d},E.font=function(R){return arguments.length?(e=Ab(R),E):e},E.fontStyle=function(R){return arguments.length?(r=Ab(R),E):r},E.fontWeight=function(R){return arguments.length?(a=Ab(R),E):a},E.rotate=function(R){return arguments.length?(s=Ab(R),E):s},E.text=function(R){return arguments.length?(t=Ab(R),E):t},E.spiral=function(R){return arguments.length?(g=ift[R]||R,E):g},E.fontSize=function(R){return arguments.length?(n=Ab(R),E):n},E.padding=function(R){return arguments.length?(h=Ab(R),E):h},E.random=function(R){return arguments.length?(_=R,E):_},E}function tft(t,e,n,r){if(!e.sprite){var a=t.context,s=t.ratio;a.clearRect(0,0,(c6<<5)/s,jI/s);var h,d,g,b,_,E=0,I=0,R=0,z=n.length;for(--r;++r<z;){if(e=n[r],a.save(),a.font=e.style+" "+e.weight+" "+~~((e.size+1)/s)+"px "+e.font,h=a.measureText(e.text+"m").width*s,g=e.size<<1,e.rotate){var P=Math.sin(e.rotate*Dz),rt=Math.cos(e.rotate*Dz),ot=h*rt,at=h*P,dt=g*rt,ct=g*P;h=Math.max(Math.abs(ot+ct),Math.abs(ot-ct))+31>>5<<5,g=~~Math.max(Math.abs(at+dt),Math.abs(at-dt))}else h=h+31>>5<<5;if(g>R&&(R=g),E+h>=c6<<5&&(E=0,I+=R,R=0),I+g>=jI)break;a.translate((E+(h>>1))/s,(I+(g>>1))/s),e.rotate&&a.rotate(e.rotate*Dz),a.fillText(e.text,0,0),e.padding&&(a.lineWidth=2*e.padding,a.strokeText(e.text,0,0)),a.restore(),e.width=h,e.height=g,e.xoff=E,e.yoff=I,e.x1=h>>1,e.y1=g>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,E+=h}for(var Ct=a.getImageData(0,0,(c6<<5)/s,jI/s).data,Et=[];--r>=0;)if((e=n[r]).hasText){for(d=(h=e.width)>>5,g=e.y1-e.y0,b=0;b<g*d;b++)Et[b]=0;if((E=e.xoff)==null)return;I=e.yoff;var Rt=0,Ot=-1;for(_=0;_<g;_++){for(b=0;b<h;b++){var Wt=d*_+(b>>5),jt=Ct[(I+_)*(c6<<5)+(E+b)<<2]?1<<31-b%32:0;Et[Wt]|=jt,Rt|=jt}Rt?Ot=_:(e.y0++,g--,_--,I++)}e.y1=e.y0+Ot,e.sprite=Et.slice(0,(e.y1-e.y0)*d)}}}function eft(t,e,n){n>>=5;for(var r,a=t.sprite,s=t.width>>5,h=t.x-(s<<4),d=127&h,g=32-d,b=t.y1-t.y0,_=(t.y+t.y0)*n+(h>>5),E=0;E<b;E++){r=0;for(var I=0;I<=s;I++)if((r<<g|(I<s?(r=a[E*s+I])>>>d:0))&e[_+I])return!0;_+=n}return!1}function nft(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function rft(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function pQ(t){var e=t[0]/t[1];return function(n){return[e*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Ab(t){return typeof t=="function"?t:function(){return t}}var ift={archimedean:pQ,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(a){var s=a<0?-1:1;switch(Math.sqrt(1+4*s*a)-s&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}};let mQ=["x","y","font","fontSize","fontStyle","fontWeight","angle"],aft=["text","font","rotate","fontSize","fontStyle","fontWeight"];function UI(t){ar.call(this,Jdt(),t)}UI.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:mQ}]},ur(UI,ar,{transform(t,e){!t.size||t.size[0]&&t.size[1]||Dn("Wordcloud size dimensions must be non-zero.");let n=t.modified();if(!(n||e.changed(e.ADD_REM)||aft.some(function(R){let z=t[R];return ut(z)&&e.modified(z.fields)})))return;let r=e.materialize(e.SOURCE).source,a=this.value,s=t.as||mQ,h,d=t.fontSize||14;if(ut(d)?h=t.fontSizeRange:d=Ke(d),h){let R=d,z=rs("sqrt")().domain(un(r,R)).range(h);d=P=>z(R(P))}r.forEach(R=>{R[s[0]]=NaN,R[s[1]]=NaN,R[s[3]]=0});let g=a.words(r).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(d).random(m0).layout(),b=a.size(),_=b[0]>>1,E=b[1]>>1,I=g.length;for(let R,z,P=0;P<I;++P)R=g[P],z=R.datum,z[s[0]]=R.x+_,z[s[1]]=R.y+E,z[s[2]]=R.font,z[s[3]]=R.size,z[s[4]]=R.style,z[s[5]]=R.weight,z[s[6]]=R.rotate;return e.reflow(n).modifies(s)}});let Om=rS(y2),h6=Om.right,oft=Om.left,Lm=(rS(bH).center,h6),Ip=t=>new Uint8Array(t),WI=t=>new Uint16Array(t),d6=t=>new Uint32Array(t);function VI(t,e,n){let r=(e<257?Ip:e<65537?WI:d6)(t);return n&&r.set(n),r}function gQ(t,e,n){let r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(a,s){let h=this,d=h.bisect(h.range,a.value),g=a.index,b=d[0],_=d[1],E=g.length,I;for(I=0;I<b;++I)s[g[I]]|=r;for(I=_;I<E;++I)s[g[I]]|=r;return h}}}function yQ(){let t=d6(0),e=[],n=0;return{insert:function(r,a,s){if(!a.length)return[];let h=n,d=a.length,g=d6(d),b,_,E,I=Array(d);for(E=0;E<d;++E)I[E]=r(a[E]),g[E]=E;if(I=function(R,z){return R.sort.call(z,(P,rt)=>{let ot=R[P],at=R[rt];return ot<at?-1:ot>at?1:0}),function(P,rt){return Array.from(rt,ot=>P[ot])}(R,z)}(I,g),h)b=e,_=t,e=Array(h+d),t=d6(h+d),function(R,z,P,rt,ot,at,dt,ct,Ct){let Et,Rt=0,Ot=0;for(Et=0;Rt<rt&&Ot<dt;++Et)z[Rt]<ot[Ot]?(ct[Et]=z[Rt],Ct[Et]=P[Rt++]):(ct[Et]=ot[Ot],Ct[Et]=at[Ot++]+R);for(;Rt<rt;++Rt,++Et)ct[Et]=z[Rt],Ct[Et]=P[Rt];for(;Ot<dt;++Ot,++Et)ct[Et]=ot[Ot],Ct[Et]=at[Ot]+R}(s,b,_,h,I,g,d,e,t);else{if(s>0)for(E=0;E<d;++E)g[E]+=s;e=I,t=g}return n=h+d,{index:g,value:I}},remove:function(r,a){let s=n,h,d,g;for(d=0;!a[t[d]]&&d<s;++d);for(g=d;d<s;++d)a[h=t[d]]||(t[g]=h,e[g]=e[d],++g);n=s-r},bisect:function(r,a){let s;return a?s=a.length:(a=e,s=n),[oft(a,r[0],0,s),h6(a,r[1],0,s)]},reindex:function(r){for(let a=0,s=n;a<s;++a)t[a]=r[t[a]]},index:()=>t,size:()=>n}}function Rz(t){ar.call(this,function(){let e=8,n=[],r=d6(0),a=VI(0,e),s=VI(0,e);return{data:()=>n,seen:()=>r=function(h,d,g){return h.length>=d?h:((g=g||new h.constructor(d)).set(h),g)}(r,n.length),add(h){for(let d,g=0,b=n.length,_=h.length;g<_;++g)d=h[g],d._index=b++,n.push(d)},remove(h,d){let g=n.length,b=Array(g-h),_=n,E,I,R;for(I=0;!d[I]&&I<g;++I)b[I]=n[I],_[I]=I;for(R=I;I<g;++I)E=n[I],d[I]?_[I]=-1:(_[I]=R,a[R]=a[I],s[R]=s[I],b[R]=E,E._index=R++),a[I]=0;return n=b,_},size:()=>n.length,curr:()=>a,prev:()=>s,reset:h=>s[h]=a[h],all:()=>e<257?255:e<65537?65535:4294967295,set(h,d){a[h]|=d},clear(h,d){a[h]&=~d},resize(h,d){(h>a.length||d>e)&&(e=Math.max(d,e),a=VI(h,e,a),s=VI(h,e))}}}(),t),this._indices=null,this._dims=null}function Fz(t){ar.call(this,null,t)}function*vQ(t,e){if(e==null)for(let n of t)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function Np(t,e,n){let r=Float64Array.from(vQ(t,n));return r.sort(y2),e.map(a=>ZR(r,a))}function $m(t,e){return Np(t,[.25,.5,.75],e)}function zm(t,e){let n=t.length,r=function(h,d){let g=function(b,_){let E,I=0,R=0,z=0;if(_===void 0)for(let P of b)P!=null&&(P=+P)>=P&&(E=P-R,R+=E/++I,z+=E*(P-R));else{let P=-1;for(let rt of b)(rt=_(rt,++P,b))!=null&&(rt=+rt)>=rt&&(E=rt-R,R+=E/++I,z+=E*(rt-R))}if(I>1)return z/(I-1)}(h,d);return g&&Math.sqrt(g)}(t,e),a=$m(t,e),s=(a[2]-a[0])/1.34;return 1.06*(Math.min(r,s)||r||Math.abs(a[0])||1)*Math.pow(n,-.2)}function Z2(t){let e=t.maxbins||20,n=t.base||10,r=Math.log(n),a=t.divide||[5,2],s,h,d,g,b,_,E=t.extent[0],I=t.extent[1],R=t.span||I-E||Math.abs(E)||1;if(t.step)s=t.step;else if(t.steps){for(g=R/e,b=0,_=t.steps.length;b<_&&t.steps[b]<g;++b);s=t.steps[Math.max(0,b-1)]}else{for(h=Math.ceil(Math.log(e)/r),d=t.minstep||0,s=Math.max(d,Math.pow(n,Math.round(Math.log(R)/r)-h));Math.ceil(R/s)>e;)s*=n;for(b=0,_=a.length;b<_;++b)g=s/a[b],g>=d&&R/g<=e&&(s=g)}g=Math.log(s);let z=g>=0?0:1+~~(-g/r),P=Math.pow(n,-z-1);return(t.nice||t.nice===void 0)&&(g=Math.floor(E/s+P)*s,E=E<g?g-s:g,I=Math.ceil(I/s)*s),{start:E,stop:I===E?E+s:I,step:s}}Rz.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},ur(Rz,ar,{transform(t,e){return this._dims?t.modified("fields")||t.fields.some(n=>e.modified(n.fields))?this.reinit(t,e):this.eval(t,e):this.init(t,e)},init(t,e){let n=t.fields,r=t.query,a=this._indices={},s=this._dims=[],h=r.length,d,g,b=0;for(;b<h;++b)d=n[b].fname,g=a[d]||(a[d]=yQ()),s.push(gQ(g,b,r[b]));return this.eval(t,e)},reinit(t,e){let n=e.materialize().fork(),r=t.fields,a=t.query,s=this._indices,h=this._dims,d=this.value,g=d.curr(),b=d.prev(),_=d.all(),E=n.rem=n.add,I=n.mod,R=a.length,z={},P,rt,ot,at,dt,ct,Ct,Et,Rt;if(b.set(g),e.rem.length&&(dt=this.remove(t,e,n)),e.add.length&&d.add(e.add),e.mod.length)for(ct={},at=e.mod,Ct=0,Et=at.length;Ct<Et;++Ct)ct[at[Ct]._index]=1;for(Ct=0;Ct<R;++Ct)Rt=r[Ct],(!h[Ct]||t.modified("fields",Ct)||e.modified(Rt.fields))&&(ot=Rt.fname,(P=z[ot])||(s[ot]=rt=yQ(),z[ot]=P=rt.insert(Rt,e.source,0)),h[Ct]=gQ(rt,Ct,a[Ct]).onAdd(P,g));for(Ct=0,Et=d.data().length;Ct<Et;++Ct)dt[Ct]||(b[Ct]!==g[Ct]?E.push(Ct):ct[Ct]&&g[Ct]!==_&&I.push(Ct));return d.mask=(1<<R)-1,n},eval(t,e){let n=e.materialize().fork(),r=this._dims.length,a=0;return e.rem.length&&(this.remove(t,e,n),a|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(a|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),a|=(1<<r)-1),e.mod.length&&(this.modify(e,n),a|=(1<<r)-1),this.value.mask=a,n},insert(t,e,n){let r=e.add,a=this.value,s=this._dims,h=this._indices,d=t.fields,g={},b=n.add,_=a.size()+r.length,E=s.length,I,R,z,P=a.size();a.resize(_,E),a.add(r);let rt=a.curr(),ot=a.prev(),at=a.all();for(I=0;I<E;++I)R=d[I].fname,z=g[R]||(g[R]=h[R].insert(d[I],r,P)),s[I].onAdd(z,rt);for(;P<_;++P)ot[P]=at,rt[P]!==at&&b.push(P)},modify(t,e){let n=e.mod,r=this.value,a=r.curr(),s=r.all(),h=t.mod,d,g,b;for(d=0,g=h.length;d<g;++d)b=h[d]._index,a[b]!==s&&n.push(b)},remove(t,e,n){let r=this._indices,a=this.value,s=a.curr(),h=a.prev(),d=a.all(),g={},b=n.rem,_=e.rem,E,I,R,z;for(E=0,I=_.length;E<I;++E)R=_[E]._index,g[R]=1,h[R]=z=s[R],s[R]=d,z!==d&&b.push(R);for(R in r)r[R].remove(I,g);return this.reindex(e,I,g),g},reindex(t,e,n){let r=this._indices,a=this.value;t.runAfter(()=>{let s=a.remove(e,n);for(let h in r)r[h].reindex(s)})},update(t,e,n){let r=this._dims,a=t.query,s=e.stamp,h=r.length,d,g,b=0;for(n.filters=0,g=0;g<h;++g)t.modified("query",g)&&(d=g,++b);if(b===1)b=r[d].one,this.incrementOne(r[d],a[d],n.add,n.rem);else for(g=0,b=0;g<h;++g)t.modified("query",g)&&(b|=r[g].one,this.incrementAll(r[g],a[g],s,n.add),n.rem=n.add);return b},incrementAll(t,e,n,r){let a=this.value,s=a.seen(),h=a.curr(),d=a.prev(),g=t.index(),b=t.bisect(t.range),_=t.bisect(e),E=_[0],I=_[1],R=b[0],z=b[1],P=t.one,rt,ot,at;if(E<R)for(rt=E,ot=Math.min(R,I);rt<ot;++rt)at=g[rt],s[at]!==n&&(d[at]=h[at],s[at]=n,r.push(at)),h[at]^=P;else if(E>R)for(rt=R,ot=Math.min(E,z);rt<ot;++rt)at=g[rt],s[at]!==n&&(d[at]=h[at],s[at]=n,r.push(at)),h[at]^=P;if(I>z)for(rt=Math.max(E,z),ot=I;rt<ot;++rt)at=g[rt],s[at]!==n&&(d[at]=h[at],s[at]=n,r.push(at)),h[at]^=P;else if(I<z)for(rt=Math.max(R,I),ot=z;rt<ot;++rt)at=g[rt],s[at]!==n&&(d[at]=h[at],s[at]=n,r.push(at)),h[at]^=P;t.range=e.slice()},incrementOne(t,e,n,r){let a=this.value.curr(),s=t.index(),h=t.bisect(t.range),d=t.bisect(e),g=d[0],b=d[1],_=h[0],E=h[1],I=t.one,R,z,P;if(g<_)for(R=g,z=Math.min(_,b);R<z;++R)P=s[R],a[P]^=I,n.push(P);else if(g>_)for(R=_,z=Math.min(g,E);R<z;++R)P=s[R],a[P]^=I,r.push(P);if(b>E)for(R=Math.max(g,E),z=b;R<z;++R)P=s[R],a[P]^=I,n.push(P);else if(b<E)for(R=Math.max(_,b),z=E;R<z;++R)P=s[R],a[P]^=I,r.push(P);t.range=e.slice()}}),Fz.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},ur(Fz,ar,{transform(t,e){let n=~(t.ignore||0),r=t.filter,a=r.mask;if(!(a&n))return e.StopPropagation;let s=e.fork(e.ALL),h=r.data(),d=r.curr(),g=r.prev(),b=_=>d[_]&n?null:h[_];return s.filter(s.MOD,b),a&a-1?(s.filter(s.ADD,_=>{let E=d[_]&n;return!E&&E^g[_]&n?h[_]:null}),s.filter(s.REM,_=>d[_]&n&&!(0^g[_]&n)?h[_]:null)):(s.filter(s.ADD,b),s.filter(s.REM,_=>(d[_]&n)===a?h[_]:null)),s.filter(s.SOURCE,_=>b(_._index))}});var Pm=Math.random;function sft(t){Pm=t}function uft(t,e,n,r){if(!t.length)return[void 0,void 0];let a=Float64Array.from(vQ(t,r)),s=a.length,h=e,d,g,b,_;for(b=0,_=Array(h);b<h;++b){for(d=0,g=0;g<s;++g)d+=a[~~(Pm()*s)];_[b]=d/s}return _.sort(y2),[KR(_,n/2),KR(_,1-n/2)]}function bQ(t,e,n,r){r=r||(I=>I);let a=t.length,s=new Float64Array(a),h,d=0,g=1,b=r(t[0]),_=b,E=b+e;for(;g<a;++g){if(h=r(t[g]),h>=E){for(_=(b+_)/2;d<g;++d)s[d]=_;E=h+e,b=h}_=h}for(_=(b+_)/2;d<g;++d)s[d]=_;return n?function(I,R){let z=I.length,P,rt,ot=0,at=1;for(;I[ot]===I[at];)++at;for(;at<z;){for(P=at+1;I[at]===I[P];)++P;if(I[at]-I[at-1]<R){for(rt=at+(ot+P-at-at>>1);rt<at;)I[rt++]=I[at];for(;rt>at;)I[rt--]=I[ot]}ot=at,at=P}return I}(s,e+e/4):s}function Oz(t){return function(){return(t=(1103515245*t+12345)%2147483647)/2147483647}}function Lz(t,e){let n,r,a;e==null&&(e=t,t=0);let s={min(h){return arguments.length?(n=h||0,a=r-n,s):n},max(h){return arguments.length?(r=h||0,a=r-n,s):r},sample:()=>n+Math.floor(a*Pm()),pdf:h=>h===Math.floor(h)&&h>=n&&h<r?1/a:0,cdf(h){let d=Math.floor(h);return d<n?0:d>=r?1:(d-n+1)/a},icdf:h=>h>=0&&h<=1?n-1+Math.floor(h*a):NaN};return s.min(t).max(e)}let wQ=Math.sqrt(2*Math.PI),lft=Math.SQRT2,Ib=NaN;function $z(t,e){t=t||0,e=e??1;let n,r,a=0,s=0;if(Ib==Ib)a=Ib,Ib=NaN;else{do a=2*Pm()-1,s=2*Pm()-1,n=a*a+s*s;while(n===0||n>1);r=Math.sqrt(-2*Math.log(n)/n),a*=r,Ib=s*r}return t+a*e}function a1(t,e,n){let r=(t-(e||0))/(n=n??1);return Math.exp(-.5*r*r)/(n*wQ)}function T0(t,e,n){let r=(t-(e=e||0))/(n=n??1),a=Math.abs(r),s;if(a>37)s=0;else{let h=Math.exp(-a*a/2),d;a<7.07106781186547?(d=.0352624965998911*a+.700383064443688,d=d*a+6.37396220353165,d=d*a+33.912866078383,d=d*a+112.079291497871,d=d*a+221.213596169931,d=d*a+220.206867912376,s=h*d,d=.0883883476483184*a+1.75566716318264,d=d*a+16.064177579207,d=d*a+86.7807322029461,d=d*a+296.564248779674,d=d*a+637.333633378831,d=d*a+793.826512519948,d=d*a+440.413735824752,s/=d):(d=a+.65,d=a+4/d,d=a+3/d,d=a+2/d,d=a+1/d,s=h/d/2.506628274631)}return r>0?1-s:s}function A0(t,e,n){return t<0||t>1?NaN:(e||0)+(n??1)*lft*function(r){let a,s=-Math.log((1-r)*(1+r));return s<6.25?(s-=3.125,a=-364441206401782e-35,a=a*s-16850591381820166e-35,a=128584807152564e-32+a*s,a=11157877678025181e-33+a*s,a=a*s-1333171662854621e-31,a=20972767875968562e-33+a*s,a=6637638134358324e-30+a*s,a=a*s-4054566272975207e-29,a=a*s-8151934197605472e-29,a=26335093153082323e-28+a*s,a=a*s-12975133253453532e-27,a=a*s-5415412054294628e-26,a=10512122733215323e-25+a*s,a=a*s-4112633980346984e-24,a=a*s-29070369957882005e-24,a=42347877827932404e-23+a*s,a=a*s-13654692000834679e-22,a=a*s-13882523362786469e-21,a=.00018673420803405714+a*s,a=a*s-.000740702534166267,a=a*s-.006033670871430149,a=.24015818242558962+a*s,a=1.6536545626831027+a*s):s<16?(s=Math.sqrt(s)-3.25,a=22137376921775787e-25,a=9075656193888539e-23+a*s,a=a*s-27517406297064545e-23,a=18239629214389228e-24+a*s,a=15027403968909828e-22+a*s,a=a*s-4013867526981546e-21,a=29234449089955446e-22+a*s,a=12475304481671779e-21+a*s,a=a*s-47318229009055734e-21,a=6828485145957318e-20+a*s,a=24031110387097894e-21+a*s,a=a*s-.0003550375203628475,a=.0009532893797373805+a*s,a=a*s-.0016882755560235047,a=.002491442096107851+a*s,a=a*s-.003751208507569241,a=.005370914553590064+a*s,a=1.0052589676941592+a*s,a=3.0838856104922208+a*s):Number.isFinite(s)?(s=Math.sqrt(s)-5,a=-27109920616438573e-27,a=a*s-2555641816996525e-25,a=15076572693500548e-25+a*s,a=a*s-3789465440126737e-24,a=761570120807834e-23+a*s,a=a*s-1496002662714924e-23,a=2914795345090108e-23+a*s,a=a*s-6771199775845234e-23,a=22900482228026655e-23+a*s,a=a*s-99298272942317e-20,a=4526062597223154e-21+a*s,a=a*s-1968177810553167e-20,a=7599527703001776e-20+a*s,a=a*s-.00021503011930044477,a=a*s-.00013871931833623122,a=1.0103004648645344+a*s,a=4.849906401408584+a*s):a=1/0,a*r}(2*t-1)}function zz(t,e){let n,r,a={mean(s){return arguments.length?(n=s||0,a):n},stdev(s){return arguments.length?(r=s??1,a):r},sample:()=>$z(n,r),pdf:s=>a1(s,n,r),cdf:s=>T0(s,n,r),icdf:s=>A0(s,n,r)};return a.mean(t).stdev(e)}function Pz(t,e){let n=zz(),r=0,a={data(s){return arguments.length?(t=s,r=s?s.length:0,a.bandwidth(e)):t},bandwidth(s){return arguments.length?(!(e=s)&&t&&(e=zm(t)),a):e},sample:()=>t[~~(Pm()*r)]+e*n.sample(),pdf(s){let h=0,d=0;for(;d<r;++d)h+=n.pdf((s-t[d])/e);return h/e/r},cdf(s){let h=0,d=0;for(;d<r;++d)h+=n.cdf((s-t[d])/e);return h/r},icdf(){throw Error("KDE icdf not supported.")}};return a.data(t)}function xQ(t,e){return t=t||0,e=e??1,Math.exp(t+$z()*e)}function kQ(t,e,n){if(t<=0)return 0;e=e||0,n=n??1;let r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*wQ*t)}function Bz(t,e,n){return T0(Math.log(t),e,n)}function jz(t,e,n){return Math.exp(A0(t,e,n))}function Uz(t,e){let n,r,a={mean(s){return arguments.length?(n=s||0,a):n},stdev(s){return arguments.length?(r=s??1,a):r},sample:()=>xQ(n,r),pdf:s=>kQ(s,n,r),cdf:s=>Bz(s,n,r),icdf:s=>jz(s,n,r)};return a.mean(t).stdev(e)}function SQ(t,e){let n,r=0,a={weights(s){return arguments.length?(n=function(h){let d=[],g,b=0;for(g=0;g<r;++g)b+=d[g]=h[g]==null?1:+h[g];for(g=0;g<r;++g)d[g]/=b;return d}(e=s||[]),a):e},distributions(s){return arguments.length?(s?(r=s.length,t=s):(r=0,t=[]),a.weights(e)):t},sample(){let s=Pm(),h=t[r-1],d=n[0],g=0;for(;g<r-1;d+=n[++g])if(s<d){h=t[g];break}return h.sample()},pdf(s){let h=0,d=0;for(;d<r;++d)h+=n[d]*t[d].pdf(s);return h},cdf(s){let h=0,d=0;for(;d<r;++d)h+=n[d]*t[d].cdf(s);return h},icdf(){throw Error("Mixture icdf not supported.")}};return a.distributions(t).weights(e)}function Wz(t,e){return e==null&&(e=t??1,t=0),t+(e-t)*Pm()}function Vz(t,e,n){return n==null&&(n=e??1,e=0),t>=e&&t<=n?1/(n-e):0}function _Q(t,e,n){return n==null&&(n=e??1,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function CQ(t,e,n){return n==null&&(n=e??1,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function cft(t,e){let n,r,a={min(s){return arguments.length?(n=s||0,a):n},max(s){return arguments.length?(r=s??1,a):r},sample:()=>Wz(n,r),pdf:s=>Vz(s,n,r),cdf:s=>_Q(s,n,r),icdf:s=>CQ(s,n,r)};return e==null&&(e=t??1,t=0),a.min(t).max(e)}function f6(t,e,n,r){let a=r-t*t,s=Math.abs(a)<1e-24?0:(n-t*e)/a;return[e-s*t,s]}function Nb(t,e,n,r){t=t.filter(R=>{let z=e(R),P=n(R);return z!=null&&(z=+z)>=z&&P!=null&&(P=+P)>=P}),r&&t.sort((R,z)=>e(R)-e(z));let a=t.length,s=new Float64Array(a),h=new Float64Array(a),d,g,b,_=0,E=0,I=0;for(b of t)s[_]=d=+e(b),h[_]=g=+n(b),++_,E+=(d-E)/_,I+=(g-I)/_;for(_=0;_<a;++_)s[_]-=E,h[_]-=I;return[s,h,E,I]}function p6(t,e,n,r){let a,s,h=-1;for(let d of t)a=e(d),s=n(d),a!=null&&(a=+a)>=a&&s!=null&&(s=+s)>=s&&r(a,s,++h)}function u4(t,e,n,r,a){let s=0,h=0;return p6(t,e,n,(d,g)=>{let b=g-a(d),_=g-r;s+=b*b,h+=_*_}),1-s/h}function GI(t,e,n){let r=0,a=0,s=0,h=0,d=0;p6(t,e,n,(_,E)=>{++d,r+=(_-r)/d,a+=(E-a)/d,s+=(_*E-s)/d,h+=(_*_-h)/d});let g=f6(r,a,s,h),b=_=>g[0]+g[1]*_;return{coef:g,predict:b,rSquared:u4(t,e,n,a,b)}}function hft(t,e,n){let r=0,a=0,s=0,h=0,d=0;p6(t,e,n,(_,E)=>{++d,_=Math.log(_),r+=(_-r)/d,a+=(E-a)/d,s+=(_*E-s)/d,h+=(_*_-h)/d});let g=f6(r,a,s,h),b=_=>g[0]+g[1]*Math.log(_);return{coef:g,predict:b,rSquared:u4(t,e,n,a,b)}}function dft(t,e,n){let[r,a,s,h]=Nb(t,e,n),d,g,b,_=0,E=0,I=0,R=0,z=0;p6(t,e,n,(at,dt)=>{d=r[z++],g=Math.log(dt),b=d*dt,_+=(dt*g-_)/z,E+=(b-E)/z,I+=(b*g-I)/z,R+=(d*b-R)/z});let[P,rt]=f6(E/h,_/h,I/h,R/h),ot=at=>Math.exp(P+rt*(at-s));return{coef:[Math.exp(P-rt*s),rt],predict:ot,rSquared:u4(t,e,n,h,ot)}}function fft(t,e,n){let r=0,a=0,s=0,h=0,d=0,g=0;p6(t,e,n,(E,I)=>{let R=Math.log(E),z=Math.log(I);++g,r+=(R-r)/g,a+=(z-a)/g,s+=(R*z-s)/g,h+=(R*R-h)/g,d+=(I-d)/g});let b=f6(r,a,s,h),_=E=>b[0]*Math.pow(E,b[1]);return b[0]=Math.exp(b[0]),{coef:b,predict:_,rSquared:u4(t,e,n,d,_)}}function EQ(t,e,n){let[r,a,s,h]=Nb(t,e,n),d=r.length,g,b,_,E,I=0,R=0,z=0,P=0,rt=0;for(g=0;g<d;)b=r[g],_=a[g++],E=b*b,I+=(E-I)/g,R+=(E*b-R)/g,z+=(E*E-z)/g,P+=(b*_-P)/g,rt+=(E*_-rt)/g;let ot=z-I*I,at=I*ot-R*R,dt=(rt*I-P*R)/at,ct=(P*ot-rt*R)/at,Ct=-dt*I,Et=Rt=>dt*(Rt-=s)*Rt+ct*Rt+Ct+h;return{coef:[Ct-ct*s+dt*s*s+h,ct-2*dt*s,dt],predict:Et,rSquared:u4(t,e,n,h,Et)}}function pft(t,e,n,r){if(r===1)return GI(t,e,n);if(r===2)return EQ(t,e,n);let[a,s,h,d]=Nb(t,e,n),g=a.length,b=[],_=[],E=r+1,I,R,z,P,rt;for(I=0;I<E;++I){for(z=0,P=0;z<g;++z)P+=Math.pow(a[z],I)*s[z];for(b.push(P),rt=new Float64Array(E),R=0;R<E;++R){for(z=0,P=0;z<g;++z)P+=Math.pow(a[z],I+R);rt[R]=P}_.push(rt)}_.push(b);let ot=function(dt){let ct=dt.length-1,Ct=[],Et,Rt,Ot,Wt,jt;for(Et=0;Et<ct;++Et){for(Wt=Et,Rt=Et+1;Rt<ct;++Rt)Math.abs(dt[Et][Rt])>Math.abs(dt[Et][Wt])&&(Wt=Rt);for(Ot=Et;Ot<ct+1;++Ot)jt=dt[Ot][Et],dt[Ot][Et]=dt[Ot][Wt],dt[Ot][Wt]=jt;for(Rt=Et+1;Rt<ct;++Rt)for(Ot=ct;Ot>=Et;Ot--)dt[Ot][Rt]-=dt[Ot][Et]*dt[Et][Rt]/dt[Et][Et]}for(Rt=ct-1;Rt>=0;--Rt){for(jt=0,Ot=Rt+1;Ot<ct;++Ot)jt+=dt[Ot][Rt]*Ct[Ot];Ct[Rt]=(dt[ct][Rt]-jt)/dt[Rt][Rt]}return Ct}(_),at=dt=>{dt-=h;let ct=d+ot[0]+ot[1]*dt+ot[2]*dt*dt;for(I=3;I<E;++I)ct+=ot[I]*Math.pow(dt,I);return ct};return{coef:mft(E,ot,-h,d),predict:at,rSquared:u4(t,e,n,d,at)}}function mft(t,e,n,r){let a=Array(t),s,h,d,g;for(s=0;s<t;++s)a[s]=0;for(s=t-1;s>=0;--s)for(d=e[s],g=1,a[s]+=d,h=1;h<=s;++h)g*=(s+1-h)/h,a[s-h]+=d*Math.pow(n,h)*g;return a[0]+=r,a}let TQ=2,HI=1e-12;function AQ(t,e,n,r){let[a,s,h,d]=Nb(t,e,n,!0),g=a.length,b=Math.max(2,~~(r*g)),_=new Float64Array(g),E=new Float64Array(g),I=new Float64Array(g).fill(1);for(let R=-1;++R<=TQ;){let z=[0,b-1];for(let rt=0;rt<g;++rt){let ot=a[rt],at=z[0],dt=z[1],ct=ot-a[at]>a[dt]-ot?at:dt,Ct=0,Et=0,Rt=0,Ot=0,Wt=0,jt=1/Math.abs(a[ct]-ot||1);for(let fe=at;fe<=dt;++fe){let se=a[fe],he=s[fe],_e=IQ(Math.abs(ot-se)*jt)*I[fe],Ve=se*_e;Ct+=_e,Et+=Ve,Rt+=he*_e,Ot+=he*Ve,Wt+=se*Ve}let[Ht,Vt]=f6(Et/Ct,Rt/Ct,Ot/Ct,Wt/Ct);_[rt]=Ht+Vt*ot,E[rt]=Math.abs(s[rt]-_[rt]),NQ(a,rt+1,z)}if(R===TQ)break;let P=RE(E);if(Math.abs(P)<HI)break;for(let rt,ot,at=0;at<g;++at)rt=E[at]/(6*P),I[at]=rt>=1?HI:(ot=1-rt*rt)*ot}return function(R,z,P,rt){let ot=R.length,at=[],dt,ct=0,Ct=0,Et=[];for(;ct<ot;++ct)dt=R[ct]+P,Et[0]===dt?Et[1]+=(z[ct]-Et[1])/++Ct:(Ct=0,Et[1]+=rt,Et=[dt,z[ct]],at.push(Et));return Et[1]+=rt,at}(a,_,h,d)}function IQ(t){return(t=1-t*t*t)*t*t}function NQ(t,e,n){let r=t[e],a=n[0],s=n[1]+1;if(!(s>=t.length))for(;e>a&&t[s]-r<=r-t[a];)n[0]=++a,n[1]=s,++s}let MQ=.5*Math.PI/180;function Gz(t,e,n,r){n=n||25,r=Math.max(n,r||200);let a=P=>[P,t(P)],s=e[0],h=e[1],d=h-s,g=d/r,b=[a(s)],_=[];if(n===r){for(let P=1;P<r;++P)b.push(a(s+P/n*d));return b.push(a(h)),b}_.push(a(h));for(let P=n;--P>0;)_.push(a(s+P/n*d));let E=b[0],I=_[_.length-1],R=1/d,z=function(P,rt){let ot=P,at=P,dt=rt.length;for(let ct=0;ct<dt;++ct){let Ct=rt[ct][1];Ct<ot&&(ot=Ct),Ct>at&&(at=Ct)}return 1/(at-ot)}(E[1],_);for(;I;){let P=a((E[0]+I[0])/2);P[0]-E[0]>=g&&gft(E,P,I,R,z)>MQ?_.push(P):(E=I,b.push(I),_.pop()),I=_[_.length-1]}return b}function gft(t,e,n,r,a){let s=Math.atan2(a*(n[1]-t[1]),r*(n[0]-t[0])),h=Math.atan2(a*(e[1]-t[1]),r*(e[0]-t[0]));return Math.abs(s-h)}function Mb(t,e,n){return t.fields=e||[],t.fname=n,t}function yft(t){return t.length===1?DQ(t[0]):vft(t)}let DQ=t=>function(e){return e[t]},vft=t=>{let e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function l4(t){throw Error(t)}function bft(t){let e=[],n=t.length,r,a,s,h=null,d=0,g="";function b(){e.push(g+t.substring(r,a)),g="",r=a+1}for(t+="",r=a=0;a<n;++a)if(s=t[a],s==="\\")g+=t.substring(r,a++),r=a;else if(s===h)b(),h=null,d=-1;else{if(h)continue;r===d&&s==='"'||r===d&&s==="'"?(r=a+1,h=s):s!=="."||d?s==="["?(a>r&&b(),d=r=a+1):s==="]"&&(d||l4("Access path missing open bracket: "+t),d>0&&b(),d=0,r=a+1):a>r?b():r=a+1}return d&&l4("Access path missing closing bracket: "+t),h&&l4("Access path missing closing quote: "+t),a>r&&(a++,b()),e}function wft(t,e,n){let r=bft(t);return t=r.length===1?r[0]:t,Mb(yft(r),[t],t)}wft("id"),Mb(t=>t,[],"identity");let m6=Mb(()=>0,[],"zero"),Db=Mb(()=>1,[],"one");Mb(()=>!0,[],"true"),Mb(()=>!1,[],"false");var RQ=Array.isArray;function Bm(t){return t[t.length-1]}function Hz(t){return t!=null?RQ(t)?t:[t]:[]}function Yz(t){for(let e,n,r=1,a=arguments.length;r<a;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}let FQ=Object.prototype.hasOwnProperty;function xft(t,e){return FQ.call(t,e)}var YI=new Date,qz=new Date;function Jl(t,e,n,r){function a(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=function(s){return t(s=new Date(+s)),s},a.ceil=function(s){return t(s=new Date(s-1)),e(s,1),t(s),s},a.round=function(s){var h=a(s),d=a.ceil(s);return s-h<d-s?h:d},a.offset=function(s,h){return e(s=new Date(+s),h==null?1:Math.floor(h)),s},a.range=function(s,h,d){var g,b=[];if(s=a.ceil(s),d=d==null?1:Math.floor(d),!(s<h&&d>0))return b;do b.push(g=new Date(+s)),e(s,d),t(s);while(g<s&&s<h);return b},a.filter=function(s){return Jl(function(h){if(h>=h)for(;t(h),!s(h);)h.setTime(h-1)},function(h,d){if(h>=h)if(d<0)for(;++d<=0;)for(;e(h,-1),!s(h););else for(;--d>=0;)for(;e(h,1),!s(h););})},n&&(a.count=function(s,h){return YI.setTime(+s),qz.setTime(+h),t(YI),t(qz),Math.floor(n(YI,qz))},a.every=function(s){return s=Math.floor(s),isFinite(s)&&s>0?s>1?a.filter(r?function(h){return r(h)%s==0}:function(h){return a.count(0,h)%s==0}):a:null}),a}let g6=1e3,Rb=6e4,qI=36e5,OQ=864e5,LQ=6048e5;var kft=Jl(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Rb)/OQ,t=>t.getDate()-1);let XI=kft;function Fb(t){return Jl(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+7*n)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Rb)/LQ})}var $Q=Fb(0);Fb(1),Fb(2),Fb(3),Fb(4),Fb(5),Fb(6);var Xz=Jl(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/OQ},function(t){return t.getUTCDate()-1});let KI=Xz;function Ob(t){return Jl(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+7*n)},function(e,n){return(n-e)/LQ})}var zQ=Ob(0);Ob(1),Ob(2),Ob(3),Ob(4),Ob(5),Ob(6);var PQ=Jl(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});PQ.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Jl(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};let Sft=PQ;var _ft=Jl(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()});let Gd=_ft;var Cft=Jl(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*g6-t.getMinutes()*Rb)},function(t,e){t.setTime(+t+e*qI)},function(t,e){return(e-t)/qI},function(t){return t.getHours()});let Eft=Cft;var BQ=Jl(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*g6)},function(t,e){t.setTime(+t+e*Rb)},function(t,e){return(e-t)/Rb},function(t){return t.getMinutes()});let Tft=BQ;var jQ=Jl(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+e*g6)},function(t,e){return(e-t)/g6},function(t){return t.getUTCSeconds()});let Kz=jQ;var Zz=Jl(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});Zz.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Jl(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):Zz:null};let o1=Zz;var Lb=Jl(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});Lb.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Jl(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};let ZI=Lb;var Aft=Jl(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()});let ro=Aft;var ol=Jl(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*qI)},function(t,e){return(e-t)/qI},function(t){return t.getUTCHours()});let s1=ol;var Gr=Jl(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*Rb)},function(t,e){return(e-t)/Rb},function(t){return t.getUTCMinutes()});let UQ=Gr,Eh="year",Mp="quarter",Xc="month",Kc="week",Tf="date",vl="day",I0="dayofyear",Zc="hours",Nr="minutes",N0="seconds",M0="milliseconds",hi=[Eh,Mp,Xc,Kc,Tf,vl,I0,Zc,Nr,N0,M0],QI=hi.reduce((t,e,n)=>(t[e]=1+n,t),{});function Qz(t){let e=Hz(t).slice(),n={};return e.length||l4("Missing time unit."),e.forEach(r=>{xft(QI,r)?n[r]=1:l4("Invalid time unit: ".concat(r,"."))}),(n[Kc]||n[vl]?1:0)+(n[Mp]||n[Xc]||n[Tf]?1:0)+(n[I0]?1:0)>1&&l4("Incompatible time units: ".concat(t)),e.sort((r,a)=>QI[r]-QI[a]),e}let WQ={[Eh]:"%Y ",[Mp]:"Q%q ",[Xc]:"%b ",[Tf]:"%d ",[Kc]:"W%U ",[vl]:"%a ",[I0]:"%j ",[Zc]:"%H:00",[Nr]:"00:%M",[N0]:":%S",[M0]:".%L",["".concat(Eh,"-").concat(Xc)]:"%Y-%m ",["".concat(Eh,"-").concat(Xc,"-").concat(Tf)]:"%Y-%m-%d ",["".concat(Zc,"-").concat(Nr)]:"%H:%M"};function jm(t,e){let n=Yz({},WQ,e),r=Qz(t),a=r.length,s,h,d="",g=0;for(g=0;g<a;)for(s=r.length;s>g;--s)if(h=r.slice(g,s).join("-"),n[h]!=null){d+=n[h],g=s;break}return d.trim()}let Th=new Date;function Jz(t){return Th.setFullYear(t),Th.setMonth(0),Th.setDate(1),Th.setHours(0,0,0,0),Th}function c4(t){return za(new Date(t))}function Ma(t){return y6(new Date(t))}function za(t){return XI.count(Jz(t.getFullYear())-1,t)}function y6(t){return $Q.count(Jz(t.getFullYear())-1,t)}function zr(t){return Jz(t).getDay()}function ei(t,e,n,r,a,s,h){if(0<=t&&t<100){let d=new Date(-1,e,n,r,a,s,h);return d.setFullYear(t),d}return new Date(t,e,n,r,a,s,h)}function Ift(t){return Q2(new Date(t))}function Nft(t){return D0(new Date(t))}function Q2(t){let e=Date.UTC(t.getUTCFullYear(),0,1);return KI.count(e-1,t)}function D0(t){let e=Date.UTC(t.getUTCFullYear(),0,1);return zQ.count(e-1,t)}function u1(t){return Th.setTime(Date.UTC(t,0,1)),Th.getUTCDay()}function VQ(t,e,n,r,a,s,h){if(0<=t&&t<100){let d=new Date(Date.UTC(-1,e,n,r,a,s,h));return d.setUTCFullYear(n.y),d}return new Date(Date.UTC(t,e,n,r,a,s,h))}function JI(t,e,n,r,a){let s=e||1,h=Bm(t),d=(ot,at,dt)=>function(ct,Ct,Et,Rt){let Ot=Et<=1?ct:Rt?(Wt,jt)=>Rt+Et*Math.floor((ct(Wt,jt)-Rt)/Et):(Wt,jt)=>Et*Math.floor(ct(Wt,jt)/Et);return Ct?(Wt,jt)=>Ct(Ot(Wt,jt),jt):Ot}(n[dt=dt||ot],r[dt],ot===h&&s,at),g=new Date,b=function(ot){let at={},dt=ot.length;for(let ct=0;ct<dt;++ct)at[ot[ct]]=!0;return at}(t),_=b[Eh]?d(Eh):function(ot){return()=>ot}(2012),E=b[Xc]?d(Xc):b[Mp]?d(Mp):m6,I=b[Kc]&&b[vl]?d(vl,1,Kc+vl):b[Kc]?d(Kc,1):b[vl]?d(vl,1):b[Tf]?d(Tf,1):b[I0]?d(I0,1):Db,R=b[Zc]?d(Zc):m6,z=b[Nr]?d(Nr):m6,P=b[N0]?d(N0):m6,rt=b[M0]?d(M0):m6;return function(ot){g.setTime(+ot);let at=_(g);return a(at,E(g),I(g,at),R(g),z(g),P(g),rt(g))}}function l1(t,e,n){return e+7*t-(n+6)%7}let GQ={[Eh]:t=>t.getFullYear(),[Mp]:t=>Math.floor(t.getMonth()/3),[Xc]:t=>t.getMonth(),[Tf]:t=>t.getDate(),[Zc]:t=>t.getHours(),[Nr]:t=>t.getMinutes(),[N0]:t=>t.getSeconds(),[M0]:t=>t.getMilliseconds(),[I0]:t=>za(t),[Kc]:t=>y6(t),[Kc+vl]:(t,e)=>l1(y6(t),t.getDay(),zr(e)),[vl]:(t,e)=>l1(1,t.getDay(),zr(e))},t7={[Mp]:t=>3*t,[Kc]:(t,e)=>l1(t,0,zr(e))};function Mft(t,e){return JI(t,e||1,GQ,t7,ei)}let Dft={[Eh]:t=>t.getUTCFullYear(),[Mp]:t=>Math.floor(t.getUTCMonth()/3),[Xc]:t=>t.getUTCMonth(),[Tf]:t=>t.getUTCDate(),[Zc]:t=>t.getUTCHours(),[Nr]:t=>t.getUTCMinutes(),[N0]:t=>t.getUTCSeconds(),[M0]:t=>t.getUTCMilliseconds(),[I0]:t=>Q2(t),[Kc]:t=>D0(t),[vl]:(t,e)=>l1(1,t.getUTCDay(),u1(e)),[Kc+vl]:(t,e)=>l1(D0(t),t.getUTCDay(),u1(e))},Rft={[Mp]:t=>3*t,[Kc]:(t,e)=>l1(t,0,u1(e))};function Fft(t,e){return JI(t,e||1,Dft,Rft,VQ)}let Oft={[Eh]:Sft,[Mp]:Gd.every(3),[Xc]:Gd,[Kc]:$Q,[Tf]:XI,[vl]:XI,[I0]:XI,[Zc]:Eft,[Nr]:Tft,[N0]:Kz,[M0]:o1},Lft={[Eh]:ZI,[Mp]:ro.every(3),[Xc]:ro,[Kc]:zQ,[Tf]:KI,[vl]:KI,[I0]:KI,[Zc]:s1,[Nr]:UQ,[N0]:Kz,[M0]:o1};function Qc(t){return Oft[t]}function tP(t){return Lft[t]}function zi(t,e,n){return t?t.offset(e,n):void 0}function $ft(t,e,n){return zi(Qc(t),e,n)}function e7(t,e,n){return zi(tP(t),e,n)}function HQ(t,e,n,r){return t?t.range(e,n,r):void 0}function YQ(t,e,n,r){return HQ(Qc(t),e,n,r)}function n7(t,e,n,r){return HQ(tP(t),e,n,r)}let Hd=1e3,zft=6e4,$b=36e5,Pft=864e5,h4=2592e6,go=31536e6,Dl=[Eh,Xc,Tf,Zc,Nr,N0,M0],v6=Dl.slice(0,-1),b6=v6.slice(0,-1),w6=b6.slice(0,-1),Bft=w6.slice(0,-1),qQ=[Eh,Xc],XQ=[Eh],x6=[[v6,1,Hd],[v6,5,5e3],[v6,15,15e3],[v6,30,3e4],[b6,1,zft],[b6,5,3e5],[b6,15,9e5],[b6,30,18e5],[w6,1,$b],[w6,3,108e5],[w6,6,216e5],[w6,12,432e5],[Bft,1,Pft],[[Eh,Kc],1,6048e5],[qQ,1,h4],[qQ,3,7776e6],[XQ,1,go]];function jft(t){let e=t.extent,n=t.maxbins||40,r=Math.abs(function(d){return d&&Bm(d)-d[0]||0}(e))/n,a,s,h=rS(d=>d[2]).right(x6,r);return h===x6.length?(a=XQ,s=H2(e[0]/go,e[1]/go,n)):h?(h=x6[r/x6[h-1][2]<x6[h][2]/r?h-1:h],a=h[0],s=h[1]):(a=Dl,s=Math.max(H2(e[0],e[1],n),1)),{units:a,step:s}}function d4(t,e,n){return t.fields=e||[],t.fname=n,t}function Uft(t){return t.length===1?Wft(t[0]):Vft(t)}let Wft=t=>function(e){return e[t]},Vft=t=>{let e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function R0(t){throw Error(t)}function Gft(t){let e=[],n=t.length,r,a,s,h=null,d=0,g="";function b(){e.push(g+t.substring(r,a)),g="",r=a+1}for(t+="",r=a=0;a<n;++a)if(s=t[a],s==="\\")g+=t.substring(r,a++),r=a;else if(s===h)b(),h=null,d=-1;else{if(h)continue;r===d&&s==='"'||r===d&&s==="'"?(r=a+1,h=s):s!=="."||d?s==="["?(a>r&&b(),d=r=a+1):s==="]"&&(d||R0("Access path missing open bracket: "+t),d>0&&b(),d=0,r=a+1):a>r?b():r=a+1}return d&&R0("Access path missing closing bracket: "+t),h&&R0("Access path missing closing quote: "+t),a>r&&(a++,b()),e}function KQ(t,e,n){let r=Gft(t);return t=r.length===1?r[0]:t,d4(Uft(r),[t],t)}KQ("id");let ZQ=d4(t=>t,[],"identity");d4(()=>0,[],"zero"),d4(()=>1,[],"one"),d4(()=>!0,[],"true"),d4(()=>!1,[],"false");var QQ=Array.isArray;function eP(t){return t===Object(t)}function JQ(t){return t==null||t===""?null:+t}function nP(t){return typeof t=="function"}function rP(t){for(let e,n,r=1,a=arguments.length;r<a;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}let Hft=Object.prototype.hasOwnProperty;function tJ(t,e){return Hft.call(t,e)}function iP(t){return typeof t=="string"}function aP(t){return QQ(t)?"["+t.map(aP)+"]":eP(t)||iP(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}let Yft=t=>function(e){return typeof e=="number"}(t)||function(e){return Object.prototype.toString.call(e)==="[object Date]"}(t)?t:Date.parse(t);var eJ={},oP={};function nJ(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function rJ(t){var e=Object.create(null),n=[];return t.forEach(function(r){for(var a in r)a in e||n.push(e[a]=a)}),n}function Yd(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function qft(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":function(s){return s<0?"-"+Yd(-s,6):s>9999?"+"+Yd(s,6):Yd(s,4)}(t.getUTCFullYear())+"-"+Yd(t.getUTCMonth()+1,2)+"-"+Yd(t.getUTCDate(),2)+(a?"T"+Yd(e,2)+":"+Yd(n,2)+":"+Yd(r,2)+"."+Yd(a,3)+"Z":r?"T"+Yd(e,2)+":"+Yd(n,2)+":"+Yd(r,2)+"Z":n||e?"T"+Yd(e,2)+":"+Yd(n,2)+"Z":"")}function Xft(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function r(d,g){var b,_=[],E=d.length,I=0,R=0,z=E<=0,P=!1;function rt(){if(z)return oP;if(P)return P=!1,eJ;var at,dt,ct=I;if(d.charCodeAt(ct)===34){for(;I++<E&&d.charCodeAt(I)!==34||d.charCodeAt(++I)===34;);return(at=I)>=E?z=!0:(dt=d.charCodeAt(I++))===10?P=!0:dt===13&&(P=!0,d.charCodeAt(I)===10&&++I),d.slice(ct+1,at-1).replace(/""/g,'"')}for(;I<E;){if((dt=d.charCodeAt(at=I++))===10)P=!0;else if(dt===13)P=!0,d.charCodeAt(I)===10&&++I;else if(dt!==n)continue;return d.slice(ct,at)}return z=!0,d.slice(ct,E)}for(d.charCodeAt(E-1)===10&&--E,d.charCodeAt(E-1)===13&&--E;(b=rt())!==oP;){for(var ot=[];b!==eJ&&b!==oP;)ot.push(b),b=rt();g&&(ot=g(ot,R++))==null||_.push(ot)}return _}function a(d,g){return d.map(function(b){return g.map(function(_){return h(b[_])}).join(t)})}function s(d){return d.map(h).join(t)}function h(d){return d==null?"":d instanceof Date?qft(d):e.test(d+="")?'"'+d.replace(/"/g,'""')+'"':d}return{parse:function(d,g){var b,_,E=r(d,function(I,R){if(b)return b(I,R-1);_=I,b=g?function(z,P){var rt=nJ(z);return function(ot,at){return P(rt(ot),at,z)}}(I,g):nJ(I)});return E.columns=_||[],E},parseRows:r,format:function(d,g){return g==null&&(g=rJ(d)),[g.map(h).join(t)].concat(a(d,g)).join(`
`)},formatBody:function(d,g){return g==null&&(g=rJ(d)),a(d,g).join(`
`)},formatRows:function(d){return d.map(s).join(`
`)},formatRow:s,formatValue:h}}let k6="year",S6="quarter",_6="month",C6="week",E6="date",r7="day",sP="dayofyear",T6="hours",A6="minutes",I6="seconds",i7="milliseconds";[k6,S6,_6,C6,E6,r7,sP,T6,A6,I6,i7].reduce((t,e,n)=>(t[e]=1+n,t),{});let Kft={[k6]:gh,[S6]:tl.every(3),[_6]:tl,[C6]:Hl,[E6]:Ds,[r7]:Ds,[sP]:Ds,[T6]:ip,[A6]:lc,[I6]:Il,[i7]:bf},Zft={[k6]:Uc,[S6]:Kh.every(3),[_6]:Kh,[C6]:Td,[E6]:Ss,[r7]:Ss,[sP]:Ss,[T6]:hm,[A6]:Ag,[I6]:Il,[i7]:bf};function iJ(t){return Kft[t]}function Um(t){return Zft[t]}function a7(t){let e={};return n=>e[n]||(e[n]=t(n))}let uP;function aJ(t,e,n){eP(n=n||{})||R0(`Invalid time multi-format specifier: ${n}`);let r=e(I6),a=e(A6),s=e(T6),h=e(E6),d=e(C6),g=e(_6),b=e(S6),_=e(k6),E=t(n[i7]||".%L"),I=t(n[I6]||":%S"),R=t(n[A6]||"%I:%M"),z=t(n[T6]||"%I %p"),P=t(n[E6]||n[r7]||"%a %d"),rt=t(n[C6]||"%b %d"),ot=t(n[_6]||"%B"),at=t(n[S6]||"%B"),dt=t(n[k6]||"%Y");return ct=>(r(ct)<ct?E:a(ct)<ct?I:s(ct)<ct?R:h(ct)<ct?z:g(ct)<ct?d(ct)<ct?P:rt:_(ct)<ct?b(ct)<ct?ot:at:dt)(ct)}function J2(t){let e=a7(t.format),n=a7(t.utcFormat);return{timeFormat:r=>iP(r)?e(r):aJ(e,iJ,r),utcFormat:r=>iP(r)?n(r):aJ(n,Um,r),timeParse:a7(t.parse),utcParse:a7(t.utcParse)}}function Qft(){return uP=J2({format:Z8,parse:sR,utcFormat:Q8,utcParse:uR})}function Jft(t){return J2(oR(t))}function oJ(t){return arguments.length?uP=Jft(t):uP}Qft();let tpt=/^(data:|([A-Za-z]+:)?\/\/)/,ept=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,npt=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,rpt="file://";function ipt(t,e){return ce(this,null,function*(){let n=yield this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)})}function apt(t,e){return ce(this,null,function*(){e=rP({},this.options,e);let n=this.fileAccess,r={href:null},a,s,h,d=ept.test(t.replace(npt,""));t!=null&&typeof t=="string"&&d||R0("Sanitize failure, invalid URI: "+aP(t));let g=tpt.test(t);return(h=e.baseURL)&&!g&&(t.startsWith("/")||h.endsWith("/")||(t="/"+t),t=h+t),s=(a=t.startsWith(rpt))||e.mode==="file"||e.mode!=="http"&&!g&&n,a?t=t.slice(7):t.startsWith("//")&&(e.defaultProtocol==="file"?(t=t.slice(2),s=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!s}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),e.context==="image"&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r})}function opt(t){return t?e=>new Promise((n,r)=>{t.readFile(e,(a,s)=>{a?r(a):n(s)})}):spt}function spt(){return ce(this,null,function*(){R0("No file system access.")})}function upt(t){return t?function(e,n){return ce(this,null,function*(){let r=rP({},this.options.http,n),a=n&&n.response,s=yield t(e,r);return s.ok?nP(s[a])?s[a]():s.text():R0(s.status+""+s.statusText)})}:lpt}function lpt(){return ce(this,null,function*(){R0("No HTTP fetch method available.")})}let cpt=t=>t!=null&&t==t,sJ=t=>!(Number.isNaN(+t)||t instanceof Date),lP={boolean:function(t){return t==null||t===""?null:!(!t||t==="false"||t==="0")&&!!t},integer:JQ,number:JQ,date:function(t,e){return e=e||Yft,t==null||t===""?null:e(t)},string:function(t){return t==null||t===""?null:t+""},unknown:ZQ},ty=[t=>t==="true"||t==="false"||t===!0||t===!1,t=>sJ(t)&&Number.isInteger(+t),sJ,t=>!Number.isNaN(Date.parse(t))],cP=["boolean","integer","number","date"];function hP(t,e){if(!t||!t.length)return"unknown";let n=t.length,r=ty.length,a=ty.map((s,h)=>h+1);for(let s,h,d=0,g=0;d<n;++d)for(h=e?t[d][e]:t[d],s=0;s<r;++s)if(a[s]&&cpt(h)&&!ty[s](h)&&(a[s]=0,++g,g===ty.length))return"string";return cP[a.reduce((s,h)=>s===0?h:s,0)-1]}function uJ(t,e){return e.reduce((n,r)=>(n[r]=hP(t,r),n),{})}function dP(t){let e=function(n,r){let a={delimiter:t};return fP(n,r?rP(r,a):a)};return e.responseType="text",e}function fP(t,e){return e.header&&(t=e.header.map(aP).join(e.delimiter)+`
`+t),Xft(e.delimiter).parse(t+"")}function o7(t,e){let n=e&&e.property?KQ(e.property):ZQ;return!eP(t)||(r=t,typeof Un=="function"&&nP(Un.isBuffer)&&Un.isBuffer(r))?n(JSON.parse(t)):function(a,s){return!QQ(a)&&function(h){return h&&nP(h[Symbol.iterator])}(a)&&(a=[...a]),s&&s.copy?JSON.parse(JSON.stringify(a)):a}(n(t),e);var r}fP.responseType="text",o7.responseType="json";let hpt={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function lJ(t,e){let n,r,a,s;return t=o7(t,e),e&&e.feature?(n=qh,a=e.feature):e&&e.mesh?(n=Xh,a=e.mesh,s=hpt[e.filter]):R0("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[a])?n(t,r,s):R0("Invalid TopoJSON object: "+a),r&&r.features||[r]}lJ.responseType="json";let s7={dsv:fP,csv:dP(","),tsv:dP("	"),json:o7,topojson:lJ};function pP(t,e){return arguments.length>1?(s7[t]=e,this):tJ(s7,t)?s7[t]:null}function dpt(t){let e=pP(t);return e&&e.responseType||"text"}function fpt(t,e,n,r){let a=pP((e=e||{}).type||"json");return a||R0("Unknown data format type: "+e.type),t=a(t,e),e.parse&&function(s,h,d,g){if(!s.length)return;let b=oJ();d=d||b.timeParse,g=g||b.utcParse;let _,E,I,R,z,P,rt=s.columns||Object.keys(s[0]);h==="auto"&&(h=uJ(s,rt)),rt=Object.keys(h);let ot=rt.map(at=>{let dt=h[at],ct,Ct;if(dt&&(dt.startsWith("date:")||dt.startsWith("utc:")))return ct=dt.split(/:(.+)?/,2),Ct=ct[1],(Ct[0]==="'"&&Ct[Ct.length-1]==="'"||Ct[0]==='"'&&Ct[Ct.length-1]==='"')&&(Ct=Ct.slice(1,-1)),(ct[0]==="utc"?g:d)(Ct);if(!lP[dt])throw Error("Illegal format pattern: "+at+":"+dt);return lP[dt]});for(I=0,z=s.length,P=rt.length;I<z;++I)for(_=s[I],R=0;R<P;++R)E=rt[R],_[E]=ot[R](_[E])}(t,e.parse,n,r),tJ(t,"columns")&&delete t.columns,t}let ppt=function(t,e){return n=>({options:n||{},sanitize:apt,load:ipt,fileAccess:!1,file:opt(e),http:upt(t)})}(typeof fetch<"u"&&fetch,null);function f4(t,e,n){return t.fields=e||[],t.fname=n,t}function mP(t){return t.length===1?p4(t[0]):mpt(t)}let p4=t=>function(e){return e[t]},mpt=t=>{let e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function c1(t){throw Error(t)}function gpt(t){let e=[],n=t.length,r,a,s,h=null,d=0,g="";function b(){e.push(g+t.substring(r,a)),g="",r=a+1}for(t+="",r=a=0;a<n;++a)if(s=t[a],s==="\\")g+=t.substring(r,a++),r=a;else if(s===h)b(),h=null,d=-1;else{if(h)continue;r===d&&s==='"'||r===d&&s==="'"?(r=a+1,h=s):s!=="."||d?s==="["?(a>r&&b(),d=r=a+1):s==="]"&&(d||c1("Access path missing open bracket: "+t),d>0&&b(),d=0,r=a+1):a>r?b():r=a+1}return d&&c1("Access path missing closing bracket: "+t),h&&c1("Access path missing closing quote: "+t),a>r&&(a++,b()),e}function cJ(t,e,n){let r=gpt(t);return t=r.length===1?r[0]:t,f4(mP(r),[t],t)}cJ("id"),f4(t=>t,[],"identity");let hJ=(f4(()=>0,[],"zero"),f4(()=>1,[],"one"),f4(()=>!0,[],"true"));f4(()=>!1,[],"false");var F0=Array.isArray;function gP(t){return t===Object(t)}function zb(t){return t[t.length-1]}function ypt(t){return t==null||t===""?null:+t}function Pb(t){return t!=null?F0(t)?t:[t]:[]}function u7(t){return typeof t=="function"}function l7(t){for(let e,n,r=1,a=arguments.length;r<a;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}let vpt=Object.prototype.hasOwnProperty;function h1(t,e){return vpt.call(t,e)}function m4(t,e,n){let r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),l7(r,n)}function dJ(t){return typeof t=="number"}function fJ(t){return typeof t=="string"}function pJ(t){return F0(t)?"["+t.map(pJ)+"]":gP(t)||fJ(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function yP(t){let e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function c7(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function h7(t){this._context=t}function O0(){}function mJ(t){this._context=t}function g4(t){this._context=t}function vP(t,e){this._basis=new h7(t),this._beta=e}h7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:c7(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:c7(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},mJ.prototype={areaStart:O0,areaEnd:O0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:c7(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},g4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:c7(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},vP.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,a=t[0],s=e[0],h=t[n]-a,d=e[n]-s,g=-1;++g<=n;)r=g/n,this._basis.point(this._beta*t[g]+(1-this._beta)*(a+r*h),this._beta*e[g]+(1-this._beta)*(s+r*d));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};let bpt=function t(e){function n(r){return e===1?new h7(r):new vP(r,e)}return n.beta=function(r){return t(+r)},n}(.85);function d7(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function bP(t,e){this._context=t,this._k=(1-e)/6}bP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:d7(this,this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:d7(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};let wpt=function t(e){function n(r){return new bP(r,e)}return n.tension=function(r){return t(+r)},n}(0);function y4(t,e){this._context=t,this._k=(1-e)/6}y4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:d7(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};let gJ=function t(e){function n(r){return new y4(r,e)}return n.tension=function(r){return t(+r)},n}(0);function wP(t,e){this._context=t,this._k=(1-e)/6}wP.prototype={areaStart:O0,areaEnd:O0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:d7(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};let xpt=function t(e){function n(r){return new wP(r,e)}return n.tension=function(r){return t(+r)},n}(0);var yJ=Math.abs,Ah=Math.atan2,Bb=Math.cos,kpt=Math.max,xP=Math.min,Wm=Math.sin,v4=Math.sqrt,Ih=1e-12,b4=Math.PI,f7=b4/2,vJ=2*b4;function bJ(t){return t>=1?f7:t<=-1?-f7:Math.asin(t)}function kP(t,e,n){var r=t._x1,a=t._y1,s=t._x2,h=t._y2;if(t._l01_a>Ih){var d=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,g=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*d-t._x0*t._l12_2a+t._x2*t._l01_2a)/g,a=(a*d-t._y0*t._l12_2a+t._y2*t._l01_2a)/g}if(t._l23_a>Ih){var b=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,_=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*b+t._x1*t._l23_2a-e*t._l12_2a)/_,h=(h*b+t._y1*t._l23_2a-n*t._l12_2a)/_}t._context.bezierCurveTo(r,a,s,h,t._x2,t._y2)}function wJ(t,e){this._context=t,this._alpha=e}wJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:kP(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};let Spt=function t(e){function n(r){return e?new wJ(r,e):new bP(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function xJ(t,e){this._context=t,this._alpha=e}xJ.prototype={areaStart:O0,areaEnd:O0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:kP(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};let N6=function t(e){function n(r){return e?new xJ(r,e):new wP(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function SP(t,e){this._context=t,this._alpha=e}SP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:kP(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};let kJ=function t(e){function n(r){return e?new SP(r,e):new y4(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function _P(t){this._context=t}function p7(t){return new _P(t)}function SJ(t){this._context=t}function _J(t){return t<0?-1:1}function CJ(t,e,n){var r=t._x1-t._x0,a=e-t._x1,s=(t._y1-t._y0)/(r||a<0&&-0),h=(n-t._y1)/(a||r<0&&-0),d=(s*a+h*r)/(r+a);return(_J(s)+_J(h))*Math.min(Math.abs(s),Math.abs(h),.5*Math.abs(d))||0}function EJ(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function CP(t,e,n){var r=t._x0,a=t._y0,s=t._x1,h=t._y1,d=(s-r)/3;t._context.bezierCurveTo(r+d,a+d*e,s-d,h-d*n,s,h)}function m7(t){this._context=t}function EP(t){this._context=new TP(t)}function TP(t){this._context=t}function TJ(t){this._context=t}function AJ(t){var e,n,r=t.length-1,a=new Array(r),s=new Array(r),h=new Array(r);for(a[0]=0,s[0]=2,h[0]=t[0]+2*t[1],e=1;e<r-1;++e)a[e]=1,s[e]=4,h[e]=4*t[e]+2*t[e+1];for(a[r-1]=2,s[r-1]=7,h[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=a[e]/s[e-1],s[e]-=n,h[e]-=n*h[e-1];for(a[r-1]=h[r-1]/s[r-1],e=r-2;e>=0;--e)a[e]=(h[e]-a[e+1])/s[e];for(s[r-1]=(t[r]+a[r-1])/2,e=0;e<r-1;++e)s[e]=2*t[e+1]-a[e+1];return[a,s]}function g7(t,e){this._context=t,this._t=e}_P.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},SJ.prototype={areaStart:O0,areaEnd:O0,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},m7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:CP(this,this._t0,EJ(this,this._t0))}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,CP(this,EJ(this,n=CJ(this,t,e)),n);break;default:CP(this,this._t0,n=CJ(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(EP.prototype=Object.create(m7.prototype)).point=function(t,e){m7.prototype.point.call(this,e,t)},TP.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,a,s){this._context.bezierCurveTo(e,t,r,n,s,a)}},TJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var r=AJ(t),a=AJ(e),s=0,h=1;h<n;++s,++h)this._context.bezierCurveTo(r[0][s],a[0][s],r[1][s],a[1][s],t[h],e[h]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},g7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};let AP=Math.PI,IP=2*AP,jb=1e-6,_pt=IP-jb;function NP(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function IJ(){return new NP}NP.prototype=IJ.prototype={constructor:NP,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,a,s){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+a)+","+(this._y1=+s)},arcTo:function(t,e,n,r,a){t=+t,e=+e,n=+n,r=+r,a=+a;var s=this._x1,h=this._y1,d=n-t,g=r-e,b=s-t,_=h-e,E=b*b+_*_;if(a<0)throw new Error("negative radius: "+a);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(E>jb)if(Math.abs(_*d-g*b)>jb&&a){var I=n-s,R=r-h,z=d*d+g*g,P=I*I+R*R,rt=Math.sqrt(z),ot=Math.sqrt(E),at=a*Math.tan((AP-Math.acos((z+E-P)/(2*rt*ot)))/2),dt=at/ot,ct=at/rt;Math.abs(dt-1)>jb&&(this._+="L"+(t+dt*b)+","+(e+dt*_)),this._+="A"+a+","+a+",0,0,"+ +(_*I>b*R)+","+(this._x1=t+ct*d)+","+(this._y1=e+ct*g)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,r,a,s){t=+t,e=+e,s=!!s;var h=(n=+n)*Math.cos(r),d=n*Math.sin(r),g=t+h,b=e+d,_=1^s,E=s?r-a:a-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+g+","+b:(Math.abs(this._x1-g)>jb||Math.abs(this._y1-b)>jb)&&(this._+="L"+g+","+b),n&&(E<0&&(E=E%IP+IP),E>_pt?this._+="A"+n+","+n+",0,1,"+_+","+(t-h)+","+(e-d)+"A"+n+","+n+",0,1,"+_+","+(this._x1=g)+","+(this._y1=b):E>jb&&(this._+="A"+n+","+n+",0,"+ +(E>=AP)+","+_+","+(this._x1=t+n*Math.cos(a))+","+(this._y1=e+n*Math.sin(a))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};let w4=IJ;function Es(t){return function(){return t}}function Cpt(t){return t.innerRadius}function Ept(t){return t.outerRadius}function Tpt(t){return t.startAngle}function Apt(t){return t.endAngle}function NJ(t){return t&&t.padAngle}function y7(t,e,n,r,a,s,h){var d=t-n,g=e-r,b=(h?s:-s)/v4(d*d+g*g),_=b*g,E=-b*d,I=t+_,R=e+E,z=n+_,P=r+E,rt=(I+z)/2,ot=(R+P)/2,at=z-I,dt=P-R,ct=at*at+dt*dt,Ct=a-s,Et=I*P-z*R,Rt=(dt<0?-1:1)*v4(kpt(0,Ct*Ct*ct-Et*Et)),Ot=(Et*dt-at*Rt)/ct,Wt=(-Et*at-dt*Rt)/ct,jt=(Et*dt+at*Rt)/ct,Ht=(-Et*at+dt*Rt)/ct,Vt=Ot-rt,fe=Wt-ot,se=jt-rt,he=Ht-ot;return Vt*Vt+fe*fe>se*se+he*he&&(Ot=jt,Wt=Ht),{cx:Ot,cy:Wt,x01:-_,y01:-E,x11:Ot*(a/Ct-1),y11:Wt*(a/Ct-1)}}function MP(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function MJ(t){return t[0]}function DJ(t){return t[1]}function RJ(t,e){var n=Es(!0),r=null,a=p7,s=null;function h(d){var g,b,_,E=(d=MP(d)).length,I=!1;for(r==null&&(s=a(_=w4())),g=0;g<=E;++g)!(g<E&&n(b=d[g],g,d))===I&&((I=!I)?s.lineStart():s.lineEnd()),I&&s.point(+t(b,g,d),+e(b,g,d));if(_)return s=null,_+""||null}return t=typeof t=="function"?t:t===void 0?MJ:Es(t),e=typeof e=="function"?e:e===void 0?DJ:Es(e),h.x=function(d){return arguments.length?(t=typeof d=="function"?d:Es(+d),h):t},h.y=function(d){return arguments.length?(e=typeof d=="function"?d:Es(+d),h):e},h.defined=function(d){return arguments.length?(n=typeof d=="function"?d:Es(!!d),h):n},h.curve=function(d){return arguments.length?(a=d,r!=null&&(s=a(r)),h):a},h.context=function(d){return arguments.length?(d==null?r=s=null:s=a(r=d),h):r},h}function FJ(t,e,n){var r=null,a=Es(!0),s=null,h=p7,d=null;function g(_){var E,I,R,z,P,rt=(_=MP(_)).length,ot=!1,at=new Array(rt),dt=new Array(rt);for(s==null&&(d=h(P=w4())),E=0;E<=rt;++E){if(!(E<rt&&a(z=_[E],E,_))===ot)if(ot=!ot)I=E,d.areaStart(),d.lineStart();else{for(d.lineEnd(),d.lineStart(),R=E-1;R>=I;--R)d.point(at[R],dt[R]);d.lineEnd(),d.areaEnd()}ot&&(at[E]=+t(z,E,_),dt[E]=+e(z,E,_),d.point(r?+r(z,E,_):at[E],n?+n(z,E,_):dt[E]))}if(P)return d=null,P+""||null}function b(){return RJ().defined(a).curve(h).context(s)}return t=typeof t=="function"?t:t===void 0?MJ:Es(+t),e=typeof e=="function"?e:Es(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?DJ:Es(+n),g.x=function(_){return arguments.length?(t=typeof _=="function"?_:Es(+_),r=null,g):t},g.x0=function(_){return arguments.length?(t=typeof _=="function"?_:Es(+_),g):t},g.x1=function(_){return arguments.length?(r=_==null?null:typeof _=="function"?_:Es(+_),g):r},g.y=function(_){return arguments.length?(e=typeof _=="function"?_:Es(+_),n=null,g):e},g.y0=function(_){return arguments.length?(e=typeof _=="function"?_:Es(+_),g):e},g.y1=function(_){return arguments.length?(n=_==null?null:typeof _=="function"?_:Es(+_),g):n},g.lineX0=g.lineY0=function(){return b().x(t).y(e)},g.lineY1=function(){return b().x(t).y(n)},g.lineX1=function(){return b().x(r).y(e)},g.defined=function(_){return arguments.length?(a=typeof _=="function"?_:Es(!!_),g):a},g.curve=function(_){return arguments.length?(h=_,s!=null&&(d=h(s)),g):h},g.context=function(_){return arguments.length?(_==null?s=d=null:d=h(s=_),g):s},g}let Ipt={draw:function(t,e){var n=Math.sqrt(e/b4);t.moveTo(n,0),t.arc(0,0,n,0,vJ)}},Npt="year",DP="quarter";[Npt,DP,"month","week","date","day","dayofyear","hours","minutes","seconds","milliseconds"].reduce((t,e,n)=>(t[e]=1+n,t),{}),DP+"",tl.every(3),DP+"",Kh.every(3);let LJ=/^(data:|([A-Za-z]+:)?\/\/)/,Dpt=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Rpt=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Fpt="file://";function Opt(t,e){return ce(this,null,function*(){let n=yield this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)})}function Lpt(t,e){return ce(this,null,function*(){e=l7({},this.options,e);let n=this.fileAccess,r={href:null},a,s,h,d=Dpt.test(t.replace(Rpt,""));t!=null&&typeof t=="string"&&d||c1("Sanitize failure, invalid URI: "+pJ(t));let g=LJ.test(t);return(h=e.baseURL)&&!g&&(t.startsWith("/")||h.endsWith("/")||(t="/"+t),t=h+t),s=(a=t.startsWith(Fpt))||e.mode==="file"||e.mode!=="http"&&!g&&n,a?t=t.slice(7):t.startsWith("//")&&(e.defaultProtocol==="file"?(t=t.slice(2),s=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!s}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),e.context==="image"&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r})}function $pt(t){return t?e=>new Promise((n,r)=>{t.readFile(e,(a,s)=>{a?r(a):n(s)})}):zpt}function zpt(){return ce(this,null,function*(){c1("No file system access.")})}function Ppt(t){return t?function(e,n){return ce(this,null,function*(){let r=l7({},this.options.http,n),a=n&&n.response,s=yield t(e,r);return s.ok?u7(s[a])?s[a]():s.text():c1(s.status+""+s.statusText)})}:Bpt}function Bpt(){return ce(this,null,function*(){c1("No HTTP fetch method available.")})}let Ub=function(t,e){return n=>({options:n||{},sanitize:Lpt,load:Opt,fileAccess:!1,file:$pt(e),http:Ppt(t)})}(typeof fetch<"u"&&fetch,null);function x4(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function jpt(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function $J(t){let e,n,r;function a(s,h,d=0,g=s.length){if(d<g){if(e(h,h)!==0)return g;do{let b=d+g>>>1;n(s[b],h)<0?d=b+1:g=b}while(d<g)}return d}return t.length!==2?(e=x4,n=(s,h)=>x4(t(s),h),r=(s,h)=>t(s)-h):(e=t===x4||t===jpt?t:Upt,n=t,r=t),{left:a,center:function(s,h,d=0,g=s.length){let b=a(s,h,d,g-1);return b>d&&r(s[b-1],h)>-r(s[b],h)?b-1:b},right:function(s,h,d=0,g=s.length){if(d<g){if(e(h,h)!==0)return g;do{let b=d+g>>>1;n(s[b],h)<=0?d=b+1:g=b}while(d<g)}return d}}}function Upt(){return 0}let Wpt=$J(x4),RP=Wpt.right,Vpt=($J(function(t){return t===null?NaN:+t}).center,RP);function k4(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function S4(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ey(){}var _4=.7,C4=1.4285714285714286,E4="\\s*([+-]?\\d+)\\s*",M6="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Vm="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Gpt=/^#([0-9a-f]{3,8})$/,Hpt=new RegExp(`^rgb\\(${E4},${E4},${E4}\\)$`),Ypt=new RegExp(`^rgb\\(${Vm},${Vm},${Vm}\\)$`),qpt=new RegExp(`^rgba\\(${E4},${E4},${E4},${M6}\\)$`),Xpt=new RegExp(`^rgba\\(${Vm},${Vm},${Vm},${M6}\\)$`),Kpt=new RegExp(`^hsl\\(${M6},${Vm},${Vm}\\)$`),Zpt=new RegExp(`^hsla\\(${M6},${Vm},${Vm},${M6}\\)$`),zJ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function PJ(){return this.rgb().formatHex()}function BJ(){return this.rgb().formatRgb()}function D6(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Gpt.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?jJ(e):n===3?new vc(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):n===8?v7(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):n===4?v7(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Hpt.exec(t))?new vc(e[1],e[2],e[3],1):(e=Ypt.exec(t))?new vc(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=qpt.exec(t))?v7(e[1],e[2],e[3],e[4]):(e=Xpt.exec(t))?v7(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Kpt.exec(t))?VJ(e[1],e[2]/100,e[3]/100,1):(e=Zpt.exec(t))?VJ(e[1],e[2]/100,e[3]/100,e[4]):zJ.hasOwnProperty(t)?jJ(zJ[t]):t==="transparent"?new vc(NaN,NaN,NaN,0):null}function jJ(t){return new vc(t>>16&255,t>>8&255,255&t,1)}function v7(t,e,n,r){return r<=0&&(t=e=n=NaN),new vc(t,e,n,r)}function FP(t){return t instanceof ey||(t=D6(t)),t?new vc((t=t.rgb()).r,t.g,t.b,t.opacity):new vc}function b7(t,e,n,r){return arguments.length===1?FP(t):new vc(t,e,n,r??1)}function vc(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function UJ(){return`#${Vb(this.r)}${Vb(this.g)}${Vb(this.b)}`}function WJ(){let t=w7(this.opacity);return`${t===1?"rgb(":"rgba("}${Wb(this.r)}, ${Wb(this.g)}, ${Wb(this.b)}${t===1?")":`, ${t})`}`}function w7(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Wb(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Vb(t){return((t=Wb(t))<16?"0":"")+t.toString(16)}function VJ(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new L0(t,e,n,r)}function GJ(t){if(t instanceof L0)return new L0(t.h,t.s,t.l,t.opacity);if(t instanceof ey||(t=D6(t)),!t)return new L0;if(t instanceof L0)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),s=Math.max(e,n,r),h=NaN,d=s-a,g=(s+a)/2;return d?(h=e===s?(n-r)/d+6*(n<r):n===s?(r-e)/d+2:(e-n)/d+4,d/=g<.5?s+a:2-s-a,h*=60):d=g>0&&g<1?0:h,new L0(h,d,g,t.opacity)}function x7(t,e,n,r){return arguments.length===1?GJ(t):new L0(t,e,n,r??1)}function L0(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function HJ(t){return(t=(t||0)%360)<0?t+360:t}function k7(t){return Math.max(0,Math.min(1,t||0))}function OP(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function YJ(t,e,n,r,a){var s=t*t,h=s*t;return((1-3*t+3*s-h)*e+(4-6*s+3*h)*n+(1+3*t+3*s-3*h)*r+h*a)/6}function qJ(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),a=t[r],s=t[r+1],h=r>0?t[r-1]:2*a-s,d=r<e-1?t[r+2]:2*s-a;return YJ((n-r/e)*e,h,a,s,d)}}function XJ(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),a=t[(r+e-1)%e],s=t[r%e],h=t[(r+1)%e],d=t[(r+2)%e];return YJ((n-r/e)*e,a,s,h,d)}}k4(ey,D6,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:PJ,formatHex:PJ,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return GJ(this).formatHsl()},formatRgb:BJ,toString:BJ}),k4(vc,b7,S4(ey,{brighter(t){return t=t==null?C4:Math.pow(C4,t),new vc(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?_4:Math.pow(_4,t),new vc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new vc(Wb(this.r),Wb(this.g),Wb(this.b),w7(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:UJ,formatHex:UJ,formatHex8:function(){return`#${Vb(this.r)}${Vb(this.g)}${Vb(this.b)}${Vb(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:WJ,toString:WJ})),k4(L0,x7,S4(ey,{brighter(t){return t=t==null?C4:Math.pow(C4,t),new L0(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?_4:Math.pow(_4,t),new L0(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,a=2*n-r;return new vc(OP(t>=240?t-240:t+120,a,r),OP(t,a,r),OP(t<120?t+240:t-120,a,r),this.opacity)},clamp(){return new L0(HJ(this.h),k7(this.s),k7(this.l),w7(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=w7(this.opacity);return`${t===1?"hsl(":"hsla("}${HJ(this.h)}, ${100*k7(this.s)}%, ${100*k7(this.l)}%${t===1?")":`, ${t})`}`}}));let S7=t=>()=>t;function KJ(t,e){return function(n){return t+n*e}}function _7(t,e){var n=e-t;return n?KJ(t,n>180||n<-180?n-360*Math.round(n/360):n):S7(isNaN(t)?e:t)}function Qpt(t){return(t=+t)==1?bc:function(e,n){return n-e?function(r,a,s){return r=Math.pow(r,s),a=Math.pow(a,s)-r,s=1/s,function(h){return Math.pow(r+h*a,s)}}(e,n,t):S7(isNaN(e)?n:e)}}function bc(t,e){var n=e-t;return n?KJ(t,n):S7(isNaN(t)?e:t)}let LP=function t(e){var n=Qpt(e);function r(a,s){var h=n((a=b7(a)).r,(s=b7(s)).r),d=n(a.g,s.g),g=n(a.b,s.b),b=bc(a.opacity,s.opacity);return function(_){return a.r=h(_),a.g=d(_),a.b=g(_),a.opacity=b(_),a+""}}return r.gamma=t,r}(1);function ZJ(t){return function(e){var n,r,a=e.length,s=new Array(a),h=new Array(a),d=new Array(a);for(n=0;n<a;++n)r=b7(e[n]),s[n]=r.r||0,h[n]=r.g||0,d[n]=r.b||0;return s=t(s),h=t(h),d=t(d),r.opacity=1,function(g){return r.r=s(g),r.g=h(g),r.b=d(g),r+""}}}var Jpt=ZJ(qJ),t0t=ZJ(XJ);function $P(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,a=e.slice();return function(s){for(n=0;n<r;++n)a[n]=t[n]*(1-s)+e[n]*s;return a}}function QJ(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function e0t(t,e){return(QJ(e)?$P:JJ)(t,e)}function JJ(t,e){var n,r=e?e.length:0,a=t?Math.min(r,t.length):0,s=new Array(a),h=new Array(r);for(n=0;n<a;++n)s[n]=E7(t[n],e[n]);for(;n<r;++n)h[n]=e[n];return function(d){for(n=0;n<a;++n)h[n]=s[n](d);return h}}function ttt(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Gm(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function ett(t,e){var n,r={},a={};for(n in t!==null&&typeof t=="object"||(t={}),e!==null&&typeof e=="object"||(e={}),e)n in t?r[n]=E7(t[n],e[n]):a[n]=e[n];return function(s){for(n in r)a[n]=r[n](s);return a}}var C7=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zP=new RegExp(C7.source,"g");function ntt(t,e){var n,r,a,s=C7.lastIndex=zP.lastIndex=0,h=-1,d=[],g=[];for(t+="",e+="";(n=C7.exec(t))&&(r=zP.exec(e));)(a=r.index)>s&&(a=e.slice(s,a),d[h]?d[h]+=a:d[++h]=a),(n=n[0])===(r=r[0])?d[h]?d[h]+=r:d[++h]=r:(d[++h]=null,g.push({i:h,x:Gm(n,r)})),s=zP.lastIndex;return s<e.length&&(a=e.slice(s),d[h]?d[h]+=a:d[++h]=a),d.length<2?g[0]?function(b){return function(_){return b(_)+""}}(g[0].x):function(b){return function(){return b}}(e):(e=g.length,function(b){for(var _,E=0;E<e;++E)d[(_=g[E]).i]=_.x(b);return d.join("")})}function E7(t,e){var n,r=typeof e;return e==null||r==="boolean"?S7(e):(r==="number"?Gm:r==="string"?(n=D6(e))?(e=n,LP):ntt:e instanceof D6?LP:e instanceof Date?ttt:QJ(e)?$P:Array.isArray(e)?JJ:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?ett:Gm)(t,e)}function rtt(t,e){e===void 0&&(e=t,t=E7);for(var n=0,r=e.length-1,a=e[0],s=new Array(r<0?0:r);n<r;)s[n]=t(a,a=e[++n]);return function(h){var d=Math.max(0,Math.min(r-1,Math.floor(h*=r)));return s[d](h-d)}}function n0t(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function r0t(t,e){var n=_7(+t,+e);return function(r){var a=n(r);return a-360*Math.floor(a/360)}}function i0t(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Gb,itt=180/Math.PI,PP={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function att(t,e,n,r,a,s){var h,d,g;return(h=Math.sqrt(t*t+e*e))&&(t/=h,e/=h),(g=t*n+e*r)&&(n-=t*g,r-=e*g),(d=Math.sqrt(n*n+r*r))&&(n/=d,r/=d,g/=d),t*r<e*n&&(t=-t,e=-e,g=-g,h=-h),{translateX:a,translateY:s,rotate:Math.atan2(e,t)*itt,skewX:Math.atan(g)*itt,scaleX:h,scaleY:d}}function BP(t,e,n,r){function a(s){return s.length?s.pop()+" ":""}return function(s,h){var d=[],g=[];return s=t(s),h=t(h),function(b,_,E,I,R,z){if(b!==E||_!==I){var P=R.push("translate(",null,e,null,n);z.push({i:P-4,x:Gm(b,E)},{i:P-2,x:Gm(_,I)})}else(E||I)&&R.push("translate("+E+e+I+n)}(s.translateX,s.translateY,h.translateX,h.translateY,d,g),function(b,_,E,I){b!==_?(b-_>180?_+=360:_-b>180&&(b+=360),I.push({i:E.push(a(E)+"rotate(",null,r)-2,x:Gm(b,_)})):_&&E.push(a(E)+"rotate("+_+r)}(s.rotate,h.rotate,d,g),function(b,_,E,I){b!==_?I.push({i:E.push(a(E)+"skewX(",null,r)-2,x:Gm(b,_)}):_&&E.push(a(E)+"skewX("+_+r)}(s.skewX,h.skewX,d,g),function(b,_,E,I,R,z){if(b!==E||_!==I){var P=R.push(a(R)+"scale(",null,",",null,")");z.push({i:P-4,x:Gm(b,E)},{i:P-2,x:Gm(_,I)})}else E===1&&I===1||R.push(a(R)+"scale("+E+","+I+")")}(s.scaleX,s.scaleY,h.scaleX,h.scaleY,d,g),s=h=null,function(b){for(var _,E=-1,I=g.length;++E<I;)d[(_=g[E]).i]=_.x(b);return d.join("")}}}var a0t=BP(function(t){let e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?PP:att(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),o0t=BP(function(t){return t==null?PP:(Gb||(Gb=document.createElementNS("http://www.w3.org/2000/svg","g")),Gb.setAttribute("transform",t),(t=Gb.transform.baseVal.consolidate())?att((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):PP)},", ",")",")");function ott(t){return((t=Math.exp(t))+1/t)/2}let s0t=function t(e,n,r){function a(s,h){var d,g,b=s[0],_=s[1],E=s[2],I=h[0],R=h[1],z=h[2],P=I-b,rt=R-_,ot=P*P+rt*rt;if(ot<1e-12)g=Math.log(z/E)/e,d=function(Rt){return[b+Rt*P,_+Rt*rt,E*Math.exp(e*Rt*g)]};else{var at=Math.sqrt(ot),dt=(z*z-E*E+r*ot)/(2*E*n*at),ct=(z*z-E*E-r*ot)/(2*z*n*at),Ct=Math.log(Math.sqrt(dt*dt+1)-dt),Et=Math.log(Math.sqrt(ct*ct+1)-ct);g=(Et-Ct)/e,d=function(Rt){var Ot=Rt*g,Wt=ott(Ct),jt=E/(n*at)*(Wt*function(Ht){return((Ht=Math.exp(2*Ht))-1)/(Ht+1)}(e*Ot+Ct)-function(Ht){return((Ht=Math.exp(Ht))-1/Ht)/2}(Ct));return[b+jt*P,_+jt*rt,E*Wt/ott(e*Ot+Ct)]}}return d.duration=1e3*g*e/Math.SQRT2,d}return a.rho=function(s){var h=Math.max(.001,+s),d=h*h;return t(h,d,d*d)},a}(Math.SQRT2,2,4);function stt(t){return function(e,n){var r=t((e=x7(e)).h,(n=x7(n)).h),a=bc(e.s,n.s),s=bc(e.l,n.l),h=bc(e.opacity,n.opacity);return function(d){return e.h=r(d),e.s=a(d),e.l=s(d),e.opacity=h(d),e+""}}}let u0t=stt(_7);var l0t=stt(bc);let utt=Math.PI/180,ltt=180/Math.PI,ctt=.96422,htt=1,dtt=.82521,ftt=4/29,c0t=6/29,ptt=.12841854934601665,h0t=.008856451679035631;function mtt(t){if(t instanceof Hm)return new Hm(t.l,t.a,t.b,t.opacity);if(t instanceof d1)return gtt(t);t instanceof vc||(t=FP(t));var e,n,r=GP(t.r),a=GP(t.g),s=GP(t.b),h=UP((.2225045*r+.7168786*a+.0606169*s)/htt);return r===a&&a===s?e=n=h:(e=UP((.4360747*r+.3850649*a+.1430804*s)/ctt),n=UP((.0139322*r+.0971045*a+.7141733*s)/dtt)),new Hm(116*h-16,500*(e-h),200*(h-n),t.opacity)}function jP(t,e,n,r){return arguments.length===1?mtt(t):new Hm(t,e,n,r??1)}function Hm(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function UP(t){return t>h0t?Math.pow(t,.3333333333333333):t/ptt+ftt}function WP(t){return t>c0t?t*t*t:ptt*(t-ftt)}function VP(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,.4166666666666667)-.055)}function GP(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function d0t(t){if(t instanceof d1)return new d1(t.h,t.c,t.l,t.opacity);if(t instanceof Hm||(t=mtt(t)),t.a===0&&t.b===0)return new d1(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*ltt;return new d1(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function HP(t,e,n,r){return arguments.length===1?d0t(t):new d1(t,e,n,r??1)}function d1(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function gtt(t){if(isNaN(t.h))return new Hm(t.l,0,0,t.opacity);var e=t.h*utt;return new Hm(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function f0t(t,e){var n=bc((t=jP(t)).l,(e=jP(e)).l),r=bc(t.a,e.a),a=bc(t.b,e.b),s=bc(t.opacity,e.opacity);return function(h){return t.l=n(h),t.a=r(h),t.b=a(h),t.opacity=s(h),t+""}}function ytt(t){return function(e,n){var r=t((e=HP(e)).h,(n=HP(n)).h),a=bc(e.c,n.c),s=bc(e.l,n.l),h=bc(e.opacity,n.opacity);return function(d){return e.h=r(d),e.c=a(d),e.l=s(d),e.opacity=h(d),e+""}}}k4(Hm,jP,S4(ey,{brighter(t){return new Hm(this.l+18*(t??1),this.a,this.b,this.opacity)},darker(t){return new Hm(this.l-18*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new vc(VP(3.1338561*(e=ctt*WP(e))-1.6168667*(t=htt*WP(t))-.4906146*(n=dtt*WP(n))),VP(-.9787684*e+1.9161415*t+.033454*n),VP(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),k4(d1,HP,S4(ey,{brighter(t){return new d1(this.h,this.c,this.l+18*(t??1),this.opacity)},darker(t){return new d1(this.h,this.c,this.l-18*(t??1),this.opacity)},rgb(){return gtt(this).rgb()}}));let p0t=ytt(_7);var m0t=ytt(bc),R6=-.14861,g0t=1.78277,vtt=-.29227,btt=-.90649,YP=1.97294,y0t=-1.7884503806,v0t=3.5172982438,b0t=-.6557636667999999;function qP(t,e,n,r){return arguments.length===1?function(a){if(a instanceof Hb)return new Hb(a.h,a.s,a.l,a.opacity);a instanceof vc||(a=FP(a));var s=a.r/255,h=a.g/255,d=a.b/255,g=(b0t*d+y0t*s-v0t*h)/-5.9615122912,b=d-g,_=(YP*(h-g)-vtt*b)/btt,E=Math.sqrt(_*_+b*b)/(YP*g*(1-g)),I=E?Math.atan2(_,b)*ltt-120:NaN;return new Hb(I<0?I+360:I,E,g,a.opacity)}(t):new Hb(t,e,n,r??1)}function Hb(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function wtt(t){return function e(n){function r(a,s){var h=t((a=qP(a)).h,(s=qP(s)).h),d=bc(a.s,s.s),g=bc(a.l,s.l),b=bc(a.opacity,s.opacity);return function(_){return a.h=h(_),a.s=d(_),a.l=g(Math.pow(_,n)),a.opacity=b(_),a+""}}return n=+n,r.gamma=e,r}(1)}k4(Hb,qP,S4(ey,{brighter(t){return t=t==null?C4:Math.pow(C4,t),new Hb(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?_4:Math.pow(_4,t),new Hb(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*utt,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),a=Math.sin(t);return new vc(255*(e+n*(R6*r+g0t*a)),255*(e+n*(vtt*r+btt*a)),255*(e+n*(YP*r)),this.opacity)}}));let w0t=wtt(_7);var x0t=wtt(bc);function k0t(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}let XP="linear",ny="log",KP="pow",ZP="sqrt",QP="symlog",F6="time",O6="utc",T4="sequential",L6="diverging",$6="quantile",JP="quantize",xtt="threshold",wc="continuous",Yb="discrete",z6="discretizing",$0="interpolating",tB="temporal";function eB(){let t=jv().unknown(void 0),e=t.domain,n=t.range,r,a,s=[0,1],h=!1,d=0,g=0,b=.5;function _(){let E=e().length,I=s[1]<s[0],R=s[1-I],z=function(ot,at,dt){let ct=ot-at+2*dt;return ot?ct>0?ct:1:0}(E,d,g),P=s[I-0];r=(R-P)/(z||1),h&&(r=Math.floor(r)),P+=(R-P-r*(E-d))*b,a=r*(1-d),h&&(P=Math.round(P),a=Math.round(a));let rt=function(ot,at,dt){ot=+ot,at=+at,dt=(Ct=arguments.length)<2?(at=ot,ot=0,1):Ct<3?1:+dt;for(var ct=-1,Ct=0|Math.max(0,Math.ceil((at-ot)/dt)),Et=new Array(Ct);++ct<Ct;)Et[ct]=ot+ct*dt;return Et}(E).map(ot=>P+r*ot);return n(I?rt.reverse():rt)}return delete t.unknown,t.domain=function(E){return arguments.length?(e(E),_()):e()},t.range=function(E){return arguments.length?(s=[+E[0],+E[1]],_()):s.slice()},t.rangeRound=function(E){return s=[+E[0],+E[1]],h=!0,_()},t.bandwidth=function(){return a},t.step=function(){return r},t.round=function(E){return arguments.length?(h=!!E,_()):h},t.padding=function(E){return arguments.length?(g=Math.max(0,Math.min(1,E)),d=g,_()):d},t.paddingInner=function(E){return arguments.length?(d=Math.max(0,Math.min(1,E)),_()):d},t.paddingOuter=function(E){return arguments.length?(g=Math.max(0,Math.min(1,E)),_()):g},t.align=function(E){return arguments.length?(b=Math.max(0,Math.min(1,E)),_()):b},t.invertRange=function(E){if(E[0]==null||E[1]==null)return;let I=s[1]<s[0],R=I?n().reverse():n(),z=R.length-1,P,rt,ot,at=+E[0],dt=+E[1];return at!=at||dt!=dt||(dt<at&&(ot=at,at=dt,dt=ot),dt<R[0]||at>s[1-I])?void 0:(P=Math.max(0,RP(R,at)-1),rt=at===dt?P:RP(R,dt)-1,at-R[P]>a+1e-10&&++P,I&&(ot=P,P=z-rt,rt=z-ot),P>rt?void 0:e().slice(P,rt+1))},t.invert=function(E){let I=t.invertRange([E,E]);return I&&I[0]},t.copy=function(){return eB().domain(e()).range(s).round(h).paddingInner(d).paddingOuter(g).align(b)},_()}function ktt(t){let e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return ktt(e())},t}var S0t=Array.prototype.map;let _0t=Array.prototype.slice,T7=new Map,C0t=Symbol("vega_scale");function E0t(t,e,n){let r=function(){let a=e();return a.invertRange||(a.invertRange=a.invert?function(s){return function(h){let d,g=h[0],b=h[1];return b<g&&(d=g,g=b,b=d),[s.invert(g),s.invert(b)]}}(a):a.invertExtent?function(s){return function(h){let d=s.range(),g,b,_,E,I=h[0],R=h[1],z=-1;for(R<I&&(b=I,I=R,R=b),_=0,E=d.length;_<E;++_)d[_]>=I&&d[_]<=R&&(z<0&&(z=_),g=_);if(!(z<0))return I=s.invertExtent(d[z]),R=s.invertExtent(d[g]),[I[0]===void 0?I[1]:I[0],R[1]===void 0?R[0]:R[1]]}}(a):void 0),a.type=t,function(s){return s[C0t]=!0,s}(a)};return r.metadata=yP(Pb(n)),r}function eu(t,e,n){return arguments.length>1?(T7.set(t,E0t(t,e,n)),this):function(r){return T7.has(r)}(t)?T7.get(t):void 0}function A7(t,e){let n=T7.get(t);return n&&n.metadata[e]}function Stt(t){return A7(t,Yb)}eu("identity",Ii),eu(XP,AS,wc),eu(ny,xf,[wc,ny]),eu(KP,cp,wc),eu(ZP,JF,wc),eu(QP,aT,wc),eu(F6,oT,[wc,tB]),eu(O6,sT,[wc,tB]),eu(T4,Bv,[wc,$0]),eu(`${T4}-${XP}`,Bv,[wc,$0]),eu(`${T4}-${ny}`,lT,[wc,$0,ny]),eu(`${T4}-${KP}`,NS,[wc,$0]),eu(`${T4}-${ZP}`,nO,[wc,$0]),eu(`${T4}-${QP}`,IS,[wc,$0]),eu(`${L6}-${XP}`,cT,[wc,$0]),eu(`${L6}-${ny}`,hT,[wc,$0,ny]),eu(`${L6}-${KP}`,Zw,[wc,$0]),eu(`${L6}-${ZP}`,dT,[wc,$0]),eu(`${L6}-${QP}`,DS,[wc,$0]),eu($6,fT,[z6,$6]),eu(JP,RS,z6),eu(xtt,pT,z6),eu("bin-ordinal",function t(){let e=[],n=[];function r(a){return a==null||a!=a?void 0:n[(Vpt(e,a)-1)%n.length]}return r.domain=function(a){return arguments.length?(e=function(s){return S0t.call(s,ypt)}(a),r):e.slice()},r.range=function(a){return arguments.length?(n=_0t.call(a),r):n.slice()},r.tickFormat=function(a,s){return eT(e[0],zb(e),a??10,s)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r},[Yb,z6]),eu("ordinal",jv,Yb),eu("band",eB,Yb),eu("point",function(){return ktt(eB().paddingInner(1))},Yb);function T0t(t,e,n){return rtt(function(r,a){let s=xt[function(h){return"interpolate"+h.toLowerCase().split("-").map(d=>d[0].toUpperCase()+d.slice(1)).join("")}(r)];return a!=null&&s&&s.gamma?s.gamma(a):s}("rgb",n),t)}function _tt(t){if(F0(t))return t;let e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function Ctt(t,e){for(let n in t)A0t(n,e(t[n]))}let Ett={};function A0t(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(Ett[t]=e,this):Ett[t]}Ctt({accent:IT,category10:MO,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:DO,observable10:RO,paired:FO,pastel1:OO,pastel2:LO,set1:$O,set2:zO,set3:PO,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"},_tt),Ctt({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},t=>T0t(_tt(t)));let I0t=t=>F0(t)?t.map(e=>String(e)):String(t),N0t=(t,e)=>t[1]-e[1],M0t=(t,e)=>e[1]-t[1];function qb(t,e){return t.bins?function(n,r,a){let s=n.range(),h=s[0],d=zb(s),g=N0t;return h>d&&(s=d,d=h,h=s,g=M0t),h=Math.floor(h),d=Math.ceil(d),r=r.map(b=>[b,n(b)]).filter(b=>h<=b[1]&&b[1]<=d).sort(g).map(b=>b[0]),a>0,r}(t,t.bins,e):t.ticks?t.ticks(e):t.domain()}function Ttt(t,e,n,r,a,s){let h=e.type,d=I0t;if(h===F6||a===F6)d=t.timeFormat(r);else if(h===O6||a===O6)d=t.utcFormat(r);else if(function(g){return A7(g,ny)}(h))d=t.formatFloat(r);else if(e.tickFormat){let g=e.domain();d=t.formatSpan(g[0],g[g.length-1],n,r)}else r&&(d=t.format(r));return d}function D0t(t,e,n){let r=qb(t,e),a=t.base(),s=Math.log(a),h=Math.max(1,a*e/r.length),d=g=>{let b=g/Math.pow(a,Math.round(Math.log(g)/s));return b*a<a-.5&&(b*=a),b<=h};return n?r.filter(d):d}let nB={[$6]:"quantiles",[JP]:"thresholds",[xtt]:"domain"},Att={[$6]:"quantiles",[JP]:"domain"};function R0t(t,e){return t.bins?function(n){let r=n.slice(0,-1);return r.max=zb(n),r}(t.bins):t.type===ny?D0t(t,e,!0):nB[t.type]?function(n){let r=[-1/0].concat(n);return r.max=1/0,r}(t[nB[t.type]]()):qb(t,e)}function F0t(t,e,n,r,a,s,h){let d=Att[e.type]&&s!==F6&&s!==O6?function(g,b,_){let E=b[Att[b.type]](),I=E.length,R,z=I>1?E[1]-E[0]:E[0];for(R=1;R<I;++R)z=Math.min(z,E[R]-E[R-1]);return g.formatSpan(0,z,30,_)}(t,e,a):Ttt(t,e,n,a,s);return r==="symbol"&&(g=>nB[g.type]||g.bins)(e)?O0t(d):r==="discrete"?Ntt(d):Mtt(d)}let O0t=t=>(e,n,r)=>{let a=Itt(r[n+1],Itt(r.max,1/0)),s=Ts(e,t),h=Ts(a,t);return s&&h?s+" \u2013 "+h:h?"< "+h:"\u2265 "+s},Itt=(t,e)=>t??e,Ntt=t=>(e,n)=>n?t(e):null,Mtt=t=>e=>t(e),Ts=(t,e)=>Number.isFinite(t)?e(t):null;function So(t,e,n,r){let a=r||e.type;return fJ(n)&&function(s){return A7(s,tB)}(a)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||a!==F6?n||a!==O6?F0t(t,e,5,null,n,r):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function yo(t,e,n){n=n||{};let r=Math.max(3,n.maxlen||7),a=So(t,e,n.format,n.formatType);if(function(s){return A7(s,z6)}(e.type)){let s=R0t(e).slice(1).map(a),h=s.length;return`${h} boundar${h===1?"y":"ies"}: ${s.join(", ")}`}if(Stt(e.type)){let s=e.domain(),h=s.length;return`${h} value${h===1?"":"s"}: ${h>r?s.slice(0,r-2).map(a).join(", ")+", ending with "+s.slice(-1).map(a):s.map(a).join(", ")}`}{let s=e.domain();return`values from ${a(s[0])} to ${a(zb(s))}`}}let ry=0,Af="p_";function Xb(t){return t&&t.gradient}function Dtt(t,e,n){let r=t.gradient,a=t.id,s=r==="radial"?Af:"";return a||(a=t.id="gradient_"+ry++,r==="radial"?(t.x1=Ym(t.x1,.5),t.y1=Ym(t.y1,.5),t.r1=Ym(t.r1,0),t.x2=Ym(t.x2,.5),t.y2=Ym(t.y2,.5),t.r2=Ym(t.r2,.5),s=Af):(t.x1=Ym(t.x1,0),t.y1=Ym(t.y1,0),t.x2=Ym(t.x2,1),t.y2=Ym(t.y2,0))),e[a]=t,"url("+(n||"")+"#"+s+a+")"}function Ym(t,e){return t??e}function L0t(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(a,s){return r.push({offset:a,color:s}),n}}}let Rtt={basis:{curve:function(t){return new h7(t)}},"basis-closed":{curve:function(t){return new mJ(t)}},"basis-open":{curve:function(t){return new g4(t)}},bundle:{curve:bpt,tension:"beta",value:.85},cardinal:{curve:wpt,tension:"tension",value:0},"cardinal-open":{curve:gJ,tension:"tension",value:0},"cardinal-closed":{curve:xpt,tension:"tension",value:0},"catmull-rom":{curve:Spt,tension:"alpha",value:.5},"catmull-rom-closed":{curve:N6,tension:"alpha",value:.5},"catmull-rom-open":{curve:kJ,tension:"alpha",value:.5},linear:{curve:p7},"linear-closed":{curve:function(t){return new SJ(t)}},monotone:{horizontal:function(t){return new EP(t)},vertical:function(t){return new m7(t)}},natural:{curve:function(t){return new TJ(t)}},step:{curve:function(t){return new g7(t,.5)}},"step-after":{curve:function(t){return new g7(t,1)}},"step-before":{curve:function(t){return new g7(t,0)}}};function A4(t,e,n){var r=h1(Rtt,t)&&Rtt[t],a=null;return r&&(a=r.curve||r[e||"vertical"],r.tension&&n!=null&&(a=a[r.tension](n))),a}let Ftt={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},I4=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function P6(t){let e=[],n,r,a,s,h,d,g,b,_,E,I=t.slice().replace(I4[0],"###$1").split(I4[1]).slice(1);for(g=0,_=I.length;g<_;++g){for(n=I[g],r=n.slice(1).trim().replace(I4[2],"$1###$2").replace(I4[3],"$1###$2").split(I4[4]),h=n.charAt(0),a=[h],b=0,E=r.length;b<E;++b)(s=+r[b])===s&&a.push(s);if(d=Ftt[h.toLowerCase()],a.length-1>d){let R=a.length;for(b=1,e.push([h].concat(a.slice(b,b+=d))),h=h==="M"?"L":h==="m"?"l":h;b<R;b+=d)e.push([h].concat(a.slice(b,b+d)))}else e.push(a)}return e}let f1=Math.PI/180,z0=Math.PI/2,qm=2*Math.PI,N4=Math.sqrt(3)/2;var rB={},iB={},Kb=[].join;function Ott(t){let e=Kb.call(t);if(iB[e])return iB[e];var n=t[0],r=t[1],a=t[2],s=t[3],h=t[4],d=t[5],g=t[6],b=t[7];let _=b*h,E=-g*d,I=g*h,R=b*d,z=Math.cos(a),P=Math.sin(a),rt=Math.cos(s),ot=Math.sin(s),at=.5*(s-a),dt=Math.sin(.5*at),ct=8/3*dt*dt/Math.sin(at),Ct=n+z-ct*P,Et=r+P+ct*z,Rt=n+rt,Ot=r+ot,Wt=Rt+ct*ot,jt=Ot-ct*rt;return iB[e]=[_*Ct+E*Et,I*Ct+R*Et,_*Wt+E*jt,I*Wt+R*jt,_*Rt+E*Ot,I*Rt+R*Ot]}let qd=["l",0,0,0,0,0,0,0];function Ltt(t,e,n){let r=qd[0]=t[0];if(r==="a"||r==="A")qd[1]=e*t[1],qd[2]=n*t[2],qd[3]=t[3],qd[4]=t[4],qd[5]=t[5],qd[6]=e*t[6],qd[7]=n*t[7];else if(r==="h"||r==="H")qd[1]=e*t[1];else if(r==="v"||r==="V")qd[1]=n*t[1];else for(var a=1,s=t.length;a<s;++a)qd[a]=(a%2==1?e:n)*t[a];return qd}function M4(t,e,n,r,a,s){var h,d,g,b,_,E=null,I=0,R=0,z=0,P=0;n==null&&(n=0),r==null&&(r=0),a==null&&(a=1),s==null&&(s=a),t.beginPath&&t.beginPath();for(var rt=0,ot=e.length;rt<ot;++rt){switch(h=e[rt],a===1&&s===1||(h=Ltt(h,a,s)),h[0]){case"l":I+=h[1],R+=h[2],t.lineTo(I+n,R+r);break;case"L":I=h[1],R=h[2],t.lineTo(I+n,R+r);break;case"h":I+=h[1],t.lineTo(I+n,R+r);break;case"H":I=h[1],t.lineTo(I+n,R+r);break;case"v":R+=h[1],t.lineTo(I+n,R+r);break;case"V":R=h[1],t.lineTo(I+n,R+r);break;case"m":I+=h[1],R+=h[2],t.moveTo(I+n,R+r);break;case"M":I=h[1],R=h[2],t.moveTo(I+n,R+r);break;case"c":d=I+h[5],g=R+h[6],z=I+h[3],P=R+h[4],t.bezierCurveTo(I+h[1]+n,R+h[2]+r,z+n,P+r,d+n,g+r),I=d,R=g;break;case"C":I=h[5],R=h[6],z=h[3],P=h[4],t.bezierCurveTo(h[1]+n,h[2]+r,z+n,P+r,I+n,R+r);break;case"s":d=I+h[3],g=R+h[4],z=2*I-z,P=2*R-P,t.bezierCurveTo(z+n,P+r,I+h[1]+n,R+h[2]+r,d+n,g+r),z=I+h[1],P=R+h[2],I=d,R=g;break;case"S":d=h[3],g=h[4],z=2*I-z,P=2*R-P,t.bezierCurveTo(z+n,P+r,h[1]+n,h[2]+r,d+n,g+r),I=d,R=g,z=h[1],P=h[2];break;case"q":d=I+h[3],g=R+h[4],z=I+h[1],P=R+h[2],t.quadraticCurveTo(z+n,P+r,d+n,g+r),I=d,R=g;break;case"Q":d=h[3],g=h[4],t.quadraticCurveTo(h[1]+n,h[2]+r,d+n,g+r),I=d,R=g,z=h[1],P=h[2];break;case"t":d=I+h[1],g=R+h[2],E[0].match(/[QqTt]/)===null?(z=I,P=R):E[0]==="t"?(z=2*I-b,P=2*R-_):E[0]==="q"&&(z=2*I-z,P=2*R-P),b=z,_=P,t.quadraticCurveTo(z+n,P+r,d+n,g+r),R=g,z=(I=d)+h[1],P=R+h[2];break;case"T":d=h[1],g=h[2],z=2*I-z,P=2*R-P,t.quadraticCurveTo(z+n,P+r,d+n,g+r),I=d,R=g;break;case"a":I7(t,I+n,R+r,[h[1],h[2],h[3],h[4],h[5],h[6]+I+n,h[7]+R+r]),I+=h[6],R+=h[7];break;case"A":I7(t,I+n,R+r,[h[1],h[2],h[3],h[4],h[5],h[6]+n,h[7]+r]),I=h[6],R=h[7];break;case"z":case"Z":t.closePath()}E=h}}function I7(t,e,n,r){let a=function(s,h,d,g,b,_,E,I,R){let z=Kb.call(arguments);if(rB[z])return rB[z];let P=E*f1,rt=Math.sin(P),ot=Math.cos(P),at=ot*(I-s)*.5+rt*(R-h)*.5,dt=ot*(R-h)*.5-rt*(I-s)*.5,ct=at*at/((d=Math.abs(d))*d)+dt*dt/((g=Math.abs(g))*g);ct>1&&(ct=Math.sqrt(ct),d*=ct,g*=ct);let Ct=ot/d,Et=rt/d,Rt=-rt/g,Ot=ot/g,Wt=Ct*I+Et*R,jt=Rt*I+Ot*R,Ht=Ct*s+Et*h,Vt=Rt*s+Ot*h,fe=1/((Ht-Wt)*(Ht-Wt)+(Vt-jt)*(Vt-jt))-.25;fe<0&&(fe=0);let se=Math.sqrt(fe);_==b&&(se=-se);let he=.5*(Wt+Ht)-se*(Vt-jt),_e=.5*(jt+Vt)+se*(Ht-Wt),Ve=Math.atan2(jt-_e,Wt-he),gn=Math.atan2(Vt-_e,Ht-he)-Ve;gn<0&&_===1?gn+=qm:gn>0&&_===0&&(gn-=qm);let $n=Math.ceil(Math.abs(gn/(z0+.001))),Gn=[];for(let qe=0;qe<$n;++qe){let tr=Ve+qe*gn/$n,er=Ve+(qe+1)*gn/$n;Gn[qe]=[he,_e,tr,er,d,g,rt,ot]}return rB[z]=Gn}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let s=0;s<a.length;++s){let h=Ott(a[s]);t.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5])}}let aB=.5773502691896257,N7={circle:{draw:function(t,e){let n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,qm)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){let n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,a=n/2.5,s=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-s),t.lineTo(a,-s),t.lineTo(0,-n),t.lineTo(-a,-s),t.lineTo(-r,-s),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=N4*n,a=r-n*aB,s=n/4;t.moveTo(0,-r-a),t.lineTo(-s,r-a),t.lineTo(s,r-a),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=N4*n,a=r-n*aB;t.moveTo(0,-r-a),t.lineTo(-n,r-a),t.lineTo(n,r-a),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=N4*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=N4*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=N4*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=N4*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){let n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function Jc(t){return h1(N7,t)?N7[t]:function(e){if(!h1(M7,e)){let n=P6(e);M7[e]={draw:function(r,a){M4(r,n,0,0,Math.sqrt(a)/2)}}}return M7[e]}(t)}var M7={};let p1=.448084975506;function oB(t){return t.x}function $tt(t){return t.y}function ztt(t){return t.width}function Ptt(t){return t.height}function m1(t){return typeof t=="function"?t:()=>+t}function B6(t,e,n){return Math.max(e,Math.min(t,n))}function Btt(){var t=oB,e=$tt,n=ztt,r=Ptt,a=m1(0),s=a,h=a,d=a,g=null;function b(_,E,I){var R,z=E??+t.call(this,_),P=I??+e.call(this,_),rt=+n.call(this,_),ot=+r.call(this,_),at=Math.min(rt,ot)/2,dt=B6(+a.call(this,_),0,at),ct=B6(+s.call(this,_),0,at),Ct=B6(+h.call(this,_),0,at),Et=B6(+d.call(this,_),0,at);if(g||(g=R=w4()),dt<=0&&ct<=0&&Ct<=0&&Et<=0)g.rect(z,P,rt,ot);else{var Rt=z+rt,Ot=P+ot;g.moveTo(z+dt,P),g.lineTo(Rt-ct,P),g.bezierCurveTo(Rt-p1*ct,P,Rt,P+p1*ct,Rt,P+ct),g.lineTo(Rt,Ot-Et),g.bezierCurveTo(Rt,Ot-p1*Et,Rt-p1*Et,Ot,Rt-Et,Ot),g.lineTo(z+Ct,Ot),g.bezierCurveTo(z+p1*Ct,Ot,z,Ot-p1*Ct,z,Ot-Ct),g.lineTo(z,P+dt),g.bezierCurveTo(z,P+p1*dt,z+p1*dt,P,z+dt,P),g.closePath()}if(R)return g=null,R+""||null}return b.x=function(_){return arguments.length?(t=m1(_),b):t},b.y=function(_){return arguments.length?(e=m1(_),b):e},b.width=function(_){return arguments.length?(n=m1(_),b):n},b.height=function(_){return arguments.length?(r=m1(_),b):r},b.cornerRadius=function(_,E,I,R){return arguments.length?(a=m1(_),s=E!=null?m1(E):a,d=I!=null?m1(I):a,h=R!=null?m1(R):s,b):a},b.context=function(_){return arguments.length?(g=_??null,b):g},b}function sB(){var t,e,n,r,a,s,h,d,g=null;function b(E,I,R){let z=R/2;if(a){var P=h-I,rt=E-s;if(P||rt){var ot=Math.sqrt(P*P+rt*rt),at=(P/=ot)*d,dt=(rt/=ot)*d,ct=Math.atan2(rt,P);g.moveTo(s-at,h-dt),g.lineTo(E-P*z,I-rt*z),g.arc(E,I,z,ct-Math.PI,ct),g.lineTo(s+at,h+dt),g.arc(s,h,d,ct,ct+Math.PI)}else g.arc(E,I,z,0,qm);g.closePath()}else a=1;s=E,h=I,d=z}function _(E){var I,R,z,P=E.length,rt=!1;for(g==null&&(g=z=w4()),I=0;I<=P;++I)!(I<P&&r(R=E[I],I,E))===rt&&(rt=!rt)&&(a=0),rt&&b(+t(R,I,E),+e(R,I,E),+n(R,I,E));if(z)return g=null,z+""||null}return _.x=function(E){return arguments.length?(t=E,_):t},_.y=function(E){return arguments.length?(e=E,_):e},_.size=function(E){return arguments.length?(n=E,_):n},_.defined=function(E){return arguments.length?(r=E,_):r},_.context=function(E){return arguments.length?(g=E??null,_):g},_}function j6(t,e){return t??e}let U6=t=>t.x||0,W6=t=>t.y||0,D7=t=>t.defined!==!1,jtt=function(){var t=Cpt,e=Ept,n=Es(0),r=null,a=Tpt,s=Apt,h=NJ,d=null;function g(){var b,_,E=+t.apply(this,arguments),I=+e.apply(this,arguments),R=a.apply(this,arguments)-f7,z=s.apply(this,arguments)-f7,P=yJ(z-R),rt=z>R;if(d||(d=b=w4()),I<E&&(_=I,I=E,E=_),I>Ih)if(P>vJ-Ih)d.moveTo(I*Bb(R),I*Wm(R)),d.arc(0,0,I,R,z,!rt),E>Ih&&(d.moveTo(E*Bb(z),E*Wm(z)),d.arc(0,0,E,z,R,rt));else{var ot,at,dt=R,ct=z,Ct=R,Et=z,Rt=P,Ot=P,Wt=h.apply(this,arguments)/2,jt=Wt>Ih&&(r?+r.apply(this,arguments):v4(E*E+I*I)),Ht=xP(yJ(I-E)/2,+n.apply(this,arguments)),Vt=Ht,fe=Ht;if(jt>Ih){var se=bJ(jt/E*Wm(Wt)),he=bJ(jt/I*Wm(Wt));(Rt-=2*se)>Ih?(Ct+=se*=rt?1:-1,Et-=se):(Rt=0,Ct=Et=(R+z)/2),(Ot-=2*he)>Ih?(dt+=he*=rt?1:-1,ct-=he):(Ot=0,dt=ct=(R+z)/2)}var _e=I*Bb(dt),Ve=I*Wm(dt),gn=E*Bb(Et),$n=E*Wm(Et);if(Ht>Ih){var Gn,qe=I*Bb(ct),tr=I*Wm(ct),er=E*Bb(Ct),An=E*Wm(Ct);if(P<b4&&(Gn=function(mi,si,Ei,ki,Xi,Fi,Go,gd){var Uh=Ei-mi,rc=ki-si,Do=Go-Xi,us=gd-Fi,Io=us*Uh-Do*rc;if(!(Io*Io<Ih))return[mi+(Io=(Do*(si-Fi)-us*(mi-Xi))/Io)*Uh,si+Io*rc]}(_e,Ve,er,An,qe,tr,gn,$n))){var dn=_e-Gn[0],nr=Ve-Gn[1],Qn=qe-Gn[0],wr=tr-Gn[1],yi=1/Wm(function(mi){return mi>1?0:mi<-1?b4:Math.acos(mi)}((dn*Qn+nr*wr)/(v4(dn*dn+nr*nr)*v4(Qn*Qn+wr*wr)))/2),ha=v4(Gn[0]*Gn[0]+Gn[1]*Gn[1]);Vt=xP(Ht,(E-ha)/(yi-1)),fe=xP(Ht,(I-ha)/(yi+1))}}Ot>Ih?fe>Ih?(ot=y7(er,An,_e,Ve,I,fe,rt),at=y7(qe,tr,gn,$n,I,fe,rt),d.moveTo(ot.cx+ot.x01,ot.cy+ot.y01),fe<Ht?d.arc(ot.cx,ot.cy,fe,Ah(ot.y01,ot.x01),Ah(at.y01,at.x01),!rt):(d.arc(ot.cx,ot.cy,fe,Ah(ot.y01,ot.x01),Ah(ot.y11,ot.x11),!rt),d.arc(0,0,I,Ah(ot.cy+ot.y11,ot.cx+ot.x11),Ah(at.cy+at.y11,at.cx+at.x11),!rt),d.arc(at.cx,at.cy,fe,Ah(at.y11,at.x11),Ah(at.y01,at.x01),!rt))):(d.moveTo(_e,Ve),d.arc(0,0,I,dt,ct,!rt)):d.moveTo(_e,Ve),E>Ih&&Rt>Ih?Vt>Ih?(ot=y7(gn,$n,qe,tr,E,-Vt,rt),at=y7(_e,Ve,er,An,E,-Vt,rt),d.lineTo(ot.cx+ot.x01,ot.cy+ot.y01),Vt<Ht?d.arc(ot.cx,ot.cy,Vt,Ah(ot.y01,ot.x01),Ah(at.y01,at.x01),!rt):(d.arc(ot.cx,ot.cy,Vt,Ah(ot.y01,ot.x01),Ah(ot.y11,ot.x11),!rt),d.arc(0,0,E,Ah(ot.cy+ot.y11,ot.cx+ot.x11),Ah(at.cy+at.y11,at.cx+at.x11),rt),d.arc(at.cx,at.cy,Vt,Ah(at.y11,at.x11),Ah(at.y01,at.x01),!rt))):d.arc(0,0,E,Et,Ct,rt):d.lineTo(gn,$n)}else d.moveTo(0,0);if(d.closePath(),b)return d=null,b+""||null}return g.centroid=function(){var b=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,_=(+a.apply(this,arguments)+ +s.apply(this,arguments))/2-b4/2;return[Bb(_)*b,Wm(_)*b]},g.innerRadius=function(b){return arguments.length?(t=typeof b=="function"?b:Es(+b),g):t},g.outerRadius=function(b){return arguments.length?(e=typeof b=="function"?b:Es(+b),g):e},g.cornerRadius=function(b){return arguments.length?(n=typeof b=="function"?b:Es(+b),g):n},g.padRadius=function(b){return arguments.length?(r=b==null?null:typeof b=="function"?b:Es(+b),g):r},g.startAngle=function(b){return arguments.length?(a=typeof b=="function"?b:Es(+b),g):a},g.endAngle=function(b){return arguments.length?(s=typeof b=="function"?b:Es(+b),g):s},g.padAngle=function(b){return arguments.length?(h=typeof b=="function"?b:Es(+b),g):h},g.context=function(b){return arguments.length?(d=b??null,g):d},g}().startAngle(t=>t.startAngle||0).endAngle(t=>t.endAngle||0).padAngle(t=>t.padAngle||0).innerRadius(t=>t.innerRadius||0).outerRadius(t=>t.outerRadius||0).cornerRadius(t=>t.cornerRadius||0),Utt=FJ().x(U6).y1(W6).y0(t=>(t.y||0)+(t.height||0)).defined(D7),$0t=FJ().y(W6).x1(U6).x0(t=>(t.x||0)+(t.width||0)).defined(D7),iy=RJ().x(U6).y(W6).defined(D7),uB=Btt().x(U6).y(W6).width(t=>t.width||0).height(t=>t.height||0).cornerRadius(t=>j6(t.cornerRadiusTopLeft,t.cornerRadius)||0,t=>j6(t.cornerRadiusTopRight,t.cornerRadius)||0,t=>j6(t.cornerRadiusBottomRight,t.cornerRadius)||0,t=>j6(t.cornerRadiusBottomLeft,t.cornerRadius)||0),lB=function(t,e){var n=null;function r(){var a;if(n||(n=a=w4()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),a)return n=null,a+""||null}return t=typeof t=="function"?t:Es(t||Ipt),e=typeof e=="function"?e:Es(e===void 0?64:+e),r.type=function(a){return arguments.length?(t=typeof a=="function"?a:Es(a),r):t},r.size=function(a){return arguments.length?(e=typeof a=="function"?a:Es(+a),r):e},r.context=function(a){return arguments.length?(n=a??null,r):n},r}().type(t=>Jc(t.shape||"circle")).size(t=>j6(t.size,64)),cB=sB().x(U6).y(W6).defined(D7).size(t=>t.size||1);function hB(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function ay(t,e,n,r){return uB.context(t)(e,n,r)}var dB=1;function Wtt(){dB=1}function oy(t,e,n){var r=e.clip,a=t._defs,s=e.clip_id||(e.clip_id="clip"+dB++),h=a.clipping[s]||(a.clipping[s]={id:s});return u7(r)?h.path=r(null):hB(n)?h.path=ay(null,n,0,0):(h.width=n.width||0,h.height=n.height||0),"url(#"+s+")"}function Xd(t){this.clear(),t&&this.union(t)}function fB(t){this.mark=t,this.bounds=this.bounds||new Xd}function R7(t){fB.call(this,t),this.items=this.items||[]}function pB(t){this._pending=0,this._loader=t||Ub()}function Vtt(t){t._pending+=1}function V6(t){t._pending-=1}function Zb(t,e,n){if(e.stroke&&e.opacity!==0&&e.strokeOpacity!==0){let r=e.strokeWidth!=null?+e.strokeWidth:1;t.expand(r+(n?function(a,s){return a.strokeJoin&&a.strokeJoin!=="miter"?0:s}(e,r):0))}return t}Xd.prototype={clone(){return new Xd(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){let r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:a,x2:s,y2:h}=this,d=Math.cos(t),g=Math.sin(t),b=e-e*d+n*g,_=n-e*g-n*d;return[d*r-g*a+b,g*r+d*a+_,d*r-g*h+b,g*r+d*h+_,d*s-g*a+b,g*s+d*a+_,d*s-g*h+b,g*s+d*h+_]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},m4(R7,fB),pB.prototype={pending(){return this._pending},sanitizeURL(t){let e=this;return Vtt(e),e._loader.sanitize(t,{context:"href"}).then(n=>(V6(e),n)).catch(()=>(V6(e),null))},loadImage(t){let e=this,n=LF();return Vtt(e),e._loader.sanitize(t,{context:"image"}).then(r=>{let a=r.href;if(!a||!n)throw{url:a};let s=new n,h=h1(r,"crossOrigin")?r.crossOrigin:"anonymous";return h!=null&&(s.crossOrigin=h),s.onload=()=>V6(e),s.onerror=()=>V6(e),s.src=a,s}).catch(r=>(V6(e),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){let t=this;return new Promise(e=>{(function n(r){t.pending()?setTimeout(()=>{n(!0)},10):e(r)})(!1)})}};let z0t=qm-1e-8,G6,F7,O7,Qb,mB,L7,gB,yB,sy=(t,e)=>G6.add(t,e),$7=(t,e)=>sy(F7=t,O7=e),uy=t=>sy(t,G6.y1),Rl=t=>sy(G6.x1,t),ly=(t,e)=>mB*t+gB*e,Jb=(t,e)=>L7*t+yB*e,vB=(t,e)=>sy(ly(t,e),Jb(t,e)),z7=(t,e)=>$7(ly(t,e),Jb(t,e));function D4(t,e){return G6=t,e?(Qb=e*f1,mB=yB=Math.cos(Qb),L7=Math.sin(Qb),gB=-L7):(mB=yB=1,Qb=L7=gB=0),Gtt}let Gtt={beginPath(){},closePath(){},moveTo:z7,lineTo:z7,rect(t,e,n,r){Qb?(vB(t+n,e),vB(t+n,e+r),vB(t,e+r),z7(t,e)):(sy(t+n,e+r),$7(t,e))},quadraticCurveTo(t,e,n,r){let a=ly(t,e),s=Jb(t,e),h=ly(n,r),d=Jb(n,r);bB(F7,a,h,uy),bB(O7,s,d,Rl),$7(h,d)},bezierCurveTo(t,e,n,r,a,s){let h=ly(t,e),d=Jb(t,e),g=ly(n,r),b=Jb(n,r),_=ly(a,s),E=Jb(a,s);wB(F7,h,g,_,uy),wB(O7,d,b,E,Rl),$7(_,E)},arc(t,e,n,r,a,s){if(r+=Qb,a+=Qb,F7=n*Math.cos(a)+t,O7=n*Math.sin(a)+e,Math.abs(a-r)>z0t)sy(t-n,e-n),sy(t+n,e+n);else{let h=b=>sy(n*Math.cos(b)+t,n*Math.sin(b)+e),d,g;if(h(r),h(a),a!==r)if((r%=qm)<0&&(r+=qm),(a%=qm)<0&&(a+=qm),a<r&&(s=!s,d=r,r=a,a=d),s)for(a-=qm,d=r-r%z0,g=0;g<4&&d>a;++g,d-=z0)h(d);else for(d=r-r%z0+z0,g=0;g<4&&d<a;++g,d+=z0)h(d)}}};function bB(t,e,n,r){let a=(t-e)/(t+n-2*e);0<a&&a<1&&r(t+(e-t)*a)}function wB(t,e,n,r,a){let s=r-t+3*e-3*n,h=t+n-2*e,d=t-e,g,b=0,_=0;Math.abs(s)>1e-14?(g=h*h+d*s,g>=0&&(g=Math.sqrt(g),b=(-h+g)/s,_=(-h-g)/s)):b=.5*d/h,0<b&&b<1&&a(xB(b,t,e,n,r)),0<_&&_<1&&a(xB(_,t,e,n,r))}function xB(t,e,n,r,a){let s=1-t,h=s*s,d=t*t;return h*s*e+3*h*t*n+3*s*d*r+d*t*a}var Xm=(Xm=lp(1,1))?Xm.getContext("2d"):null;let P7=new Xd;function H6(t){return function(e,n){if(!Xm)return!0;t(Xm,e),P7.clear().union(e.bounds).intersect(n).round();let{x1:r,y1:a,x2:s,y2:h}=P7;for(let d=a;d<=h;++d)for(let g=r;g<=s;++g)if(Xm.isPointInPath(g,d))return!0;return!1}}function B7(t,e){return e.contains(t.x||0,t.y||0)}function Htt(t,e){let n=t.x||0,r=t.y||0,a=t.width||0,s=t.height||0;return e.intersects(P7.set(n,r,n+a,r+s))}function Ytt(t,e){let n=t.x||0,r=t.y||0;return t3(e,n,r,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r)}function t3(t,e,n,r,a){let{x1:s,y1:h,x2:d,y2:g}=t,b=r-e,_=a-n,E,I,R,z,P=0,rt=1;for(z=0;z<4;++z){if(z===0&&(E=-b,I=-(s-e)),z===1&&(E=b,I=d-e),z===2&&(E=-_,I=-(h-n)),z===3&&(E=_,I=g-n),Math.abs(E)<1e-10&&I<0)return!1;if(R=I/E,E<0){if(R>rt)return!1;R>P&&(P=R)}else if(E>0){if(R<P)return!1;R<rt&&(rt=R)}}return!0}function e3(t,e){t.globalCompositeOperation=e.blend||"source-over"}function Dp(t,e){return t??e}function qtt(t,e){let n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function kB(t,e,n){return Xb(n)?function(r,a,s){let h=s.width(),d=s.height(),g;if(a.gradient==="radial")g=r.createRadialGradient(s.x1+Dp(a.x1,.5)*h,s.y1+Dp(a.y1,.5)*d,Math.max(h,d)*Dp(a.r1,0),s.x1+Dp(a.x2,.5)*h,s.y1+Dp(a.y2,.5)*d,Math.max(h,d)*Dp(a.r2,.5));else{let b=Dp(a.x1,0),_=Dp(a.y1,0),E=Dp(a.x2,1),I=Dp(a.y2,0);if(b!==E&&_!==I&&h!==d){let R=lp(Math.ceil(h),Math.ceil(d)),z=R.getContext("2d");return z.scale(h,d),z.fillStyle=qtt(z.createLinearGradient(b,_,E,I),a.stops),z.fillRect(0,0,h,d),r.createPattern(R,"no-repeat")}g=r.createLinearGradient(s.x1+b*h,s.y1+_*d,s.x1+E*h,s.y1+I*d)}return qtt(g,a.stops)}(t,n,e.bounds):n}function Y6(t,e,n){return(n*=e.fillOpacity==null?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=kB(t,e,e.fill),!0)}var Xtt=[];function R4(t,e,n){var r=(r=e.strokeWidth)!=null?r:1;return!(r<=0)&&(n*=e.strokeOpacity==null?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=kB(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||Xtt),t.lineDashOffset=e.strokeDashOffset||0),!0)}function P0t(t,e){return t.zindex-e.zindex||t.index-e.index}function q6(t){if(!t.zdirty)return t.zitems;var e,n,r,a=t.items,s=[];for(n=0,r=a.length;n<r;++n)(e=a[n]).index=n,e.zindex&&s.push(e);return t.zdirty=!1,t.zitems=s.sort(P0t)}function P0(t,e){var n,r,a=t.items;if(!a||!a.length)return;let s=q6(t);if(s&&s.length){for(n=0,r=a.length;n<r;++n)a[n].zindex||e(a[n]);a=s}for(n=0,r=a.length;n<r;++n)e(a[n])}function j7(t,e){var n,r,a=t.items;if(!a||!a.length)return null;let s=q6(t);for(s&&s.length&&(a=s),r=a.length;--r>=0;)if(n=e(a[r]))return n;if(a===s){for(r=(a=t.items).length;--r>=0;)if(!a[r].zindex&&(n=e(a[r])))return n}return null}function SB(t){return function(e,n,r){P0(n,a=>{r&&!r.intersects(a.bounds)||_B(t,e,a,a)})}}function Ktt(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||_B(t,e,n.items[0],n.items)}}function _B(t,e,n,r){var a=n.opacity==null?1:n.opacity;a!==0&&(t(e,r)||(e3(e,n),n.fill&&Y6(e,n,a)&&e.fill(),n.stroke&&R4(e,n,a)&&e.stroke()))}function X6(t){return t=t||hJ,function(e,n,r,a,s,h){return r*=e.pixelRatio,a*=e.pixelRatio,j7(n,d=>{let g=d.bounds;if((!g||g.contains(s,h))&&g)return t(e,d,r,a,s,h)?d:void 0})}}function F4(t,e){return function(n,r,a,s){var h,d,g=Array.isArray(r)?r[0]:r,b=e??g.fill,_=g.stroke&&n.isPointInStroke;return _&&(h=g.strokeWidth,d=g.strokeCap,n.lineWidth=h??1,n.lineCap=d??"butt"),!t(n,r)&&(b&&n.isPointInPath(a,s)||_&&n.isPointInStroke(a,s))}}function U7(t){return X6(F4(t))}function g1(t,e){return"translate("+t+","+e+")"}function W7(t){return"rotate("+t+")"}function CB(t){return g1(t.x||0,t.y||0)}function K6(t,e,n){function r(a,s){var h=s.x||0,d=s.y||0,g=s.angle||0;a.translate(h,d),g&&a.rotate(g*=f1),a.beginPath(),e(a,s),g&&a.rotate(-g),a.translate(-h,-d)}return{type:t,tag:"path",nested:!1,attr:function(a,s){a("transform",function(h){return g1(h.x||0,h.y||0)+(h.angle?" "+W7(h.angle):"")}(s)),a("d",e(null,s))},bound:function(a,s){return e(D4(a,s.angle),s),Zb(a,s).translate(s.x||0,s.y||0)},draw:SB(r),pick:U7(r),isect:n||H6(r)}}var Ztt=K6("arc",function(t,e){return jtt.context(t)(e)});function V7(t,e,n){function r(s,h){s.beginPath(),e(s,h)}let a=F4(r);return{type:t,tag:"path",nested:!0,attr:function(s,h){var d=h.mark.items;d.length&&s("d",e(null,d))},bound:function(s,h){var d=h.items;return d.length===0?s:(e(D4(s),d),Zb(s,d[0]))},draw:Ktt(r),pick:function(s,h,d,g,b,_){var E=h.items,I=h.bounds;return!E||!E.length||I&&!I.contains(b,_)?null:(d*=s.pixelRatio,g*=s.pixelRatio,a(s,E,d,g)?E[0]:null)},isect:B7,tip:n}}var B0t=V7("area",function(t,e){let n=e[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?$0t:Utt).curve(A4(r,n.orient,n.tension)).context(t)(e)},function(t,e){for(var n,r,a=t[0].orient==="horizontal"?e[1]:e[0],s=t[0].orient==="horizontal"?"y":"x",h=t.length,d=1/0;--h>=0;)t[h].defined!==!1&&(r=Math.abs(t[h][s]-a))<d&&(d=r,n=t[h]);return n});function Qtt(t,e){t.beginPath(),hB(e)?ay(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function Jtt(t){let e=Dp(t.strokeWidth,1);return t.strokeOffset!=null?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function EB(t,e){let n=Jtt(e);t("d",ay(null,e,n,n))}function Z6(t,e,n,r){let a=Jtt(e);t.beginPath(),ay(t,e,(n||0)+a,(r||0)+a)}let j0t=F4(Z6),tet=F4(Z6,!1),U0t=F4(Z6,!0);var W0t={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",CB(e))},bound:function(t,e){if(!e.clip&&e.items){let n=e.items,r=n.length;for(let a=0;a<r;++a)t.union(n[a].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),Zb(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){P0(e,r=>{let a=r.x||0,s=r.y||0,h=r.strokeForeground,d=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&d&&(Z6(t,r,a,s),e3(t,r),r.fill&&Y6(t,r,d)&&t.fill(),r.stroke&&!h&&R4(t,r,d)&&t.stroke()),t.save(),t.translate(a,s),r.clip&&Qtt(t,r),n&&n.translate(-a,-s),P0(r,g=>{this.draw(t,g,n)}),n&&n.translate(a,s),t.restore(),h&&r.stroke&&d&&(Z6(t,r,a,s),e3(t,r),R4(t,r,d)&&t.stroke())})},pick:function(t,e,n,r,a,s){if(e.bounds&&!e.bounds.contains(a,s)||!e.items)return null;let h=n*t.pixelRatio,d=r*t.pixelRatio;return j7(e,g=>{let b,_,E,I=g.bounds;if(I&&!I.contains(a,s))return;_=g.x||0,E=g.y||0;let R=_+(g.width||0),z=E+(g.height||0),P=g.clip;if(P&&(a<_||a>R||s<E||s>z))return;if(t.save(),t.translate(_,E),_=a-_,E=s-E,P&&hB(g)&&!U0t(t,g,h,d))return t.restore(),null;let rt=g.strokeForeground,ot=e.interactive!==!1;return ot&&rt&&g.stroke&&tet(t,g,h,d)?(t.restore(),g):(b=j7(g,at=>function(dt,ct,Ct){return(dt.interactive!==!1||dt.marktype==="group")&&dt.bounds&&dt.bounds.contains(ct,Ct)}(at,_,E)?this.pick(at,n,r,_,E):null),!b&&ot&&(g.fill||!rt&&g.stroke)&&j0t(t,g,h,d)&&(b=g),t.restore(),b||null)})},isect:Htt,content:function(t,e,n){t("clip-path",e.clip?oy(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),EB(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?EB(t,e):t("d","")}},Q6={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function TB(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(r=>{t.image=r,t.image.url=t.url})),n}function G7(t,e){return t.width!=null?t.width:e&&e.width?t.aspect!==!1&&t.height?t.height*e.width/e.height:e.width:0}function H7(t,e){return t.height!=null?t.height:e&&e.height?t.aspect!==!1&&t.width?t.width*e.height/e.width:e.height:0}function J6(t,e){return t==="center"?e/2:t==="right"?e:0}function tC(t,e){return t==="middle"?e/2:t==="bottom"?e:0}var eet={type:"image",tag:"image",nested:!1,attr:function(t,e,n){let r=TB(e,n),a=G7(e,r),s=H7(e,r),h=(e.x||0)-J6(e.align,a),d=(e.y||0)-tC(e.baseline,s);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",Q6["xmlns:xlink"],"xlink:href"),t("transform",g1(h,d)),t("width",a),t("height",s),t("preserveAspectRatio",e.aspect===!1?"none":"xMidYMid")},bound:function(t,e){let n=e.image,r=G7(e,n),a=H7(e,n),s=(e.x||0)-J6(e.align,r),h=(e.y||0)-tC(e.baseline,a);return t.set(s,h,s+r,h+a)},draw:function(t,e,n){P0(e,r=>{if(n&&!n.intersects(r.bounds))return;let a=TB(r,this),s=G7(r,a),h=H7(r,a);if(s===0||h===0)return;let d,g,b,_,E=(r.x||0)-J6(r.align,s),I=(r.y||0)-tC(r.baseline,h);r.aspect!==!1&&(g=a.width/a.height,b=r.width/r.height,g==g&&b==b&&g!==b&&(b<g?(_=s/g,I+=(h-_)/2,h=_):(_=h*g,E+=(s-_)/2,s=_))),(a.complete||a.toDataURL)&&(e3(t,r),t.globalAlpha=(d=r.opacity)!=null?d:1,t.imageSmoothingEnabled=r.smooth!==!1,t.drawImage(a,E,I,s,h))})},pick:X6(),isect:hJ,get:TB,xOffset:J6,yOffset:tC},V0t=V7("line",function(t,e){let n=e[0],r=n.interpolate||"linear";return iy.curve(A4(r,n.orient,n.tension)).context(t)(e)},function(t,e){for(var n,r,a=Math.pow(t[0].strokeWidth||1,2),s=t.length;--s>=0;)if(t[s].defined!==!1&&(n=t[s].x-e[0])*n+(r=t[s].y-e[1])*r<a)return t[s];return null});function O4(t,e){var n=e.path;if(n==null)return!0;var r=e.x||0,a=e.y||0,s=e.scaleX||1,h=e.scaleY||1,d=(e.angle||0)*f1,g=e.pathCache;g&&g.path===n||((e.pathCache=g=P6(n)).path=n),d&&t.rotate&&t.translate?(t.translate(r,a),t.rotate(d),M4(t,g,0,0,s,h),t.rotate(-d),t.translate(-r,-a)):M4(t,g,r,a,s,h)}var G0t={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;n===1&&r===1||t("vector-effect","non-scaling-stroke"),t("transform",function(a){return g1(a.x||0,a.y||0)+(a.angle?" "+W7(a.angle):"")+(a.scaleX||a.scaleY?" "+function(s,h){return"scale("+s+","+h+")"}(a.scaleX||1,a.scaleY||1):"")}(e)),t("d",e.path)},bound:function(t,e){return O4(D4(t,e.angle),e)?t.set(0,0,0,0):Zb(t,e,!0)},draw:SB(O4),pick:U7(O4),isect:H6(O4)};function net(t,e){t.beginPath(),ay(t,e)}var H0t={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",ay(null,e))},bound:function(t,e){var n,r;return Zb(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:SB(net),pick:U7(net),isect:Htt};function ret(t,e,n){var r,a,s,h;return!(!e.stroke||!R4(t,e,n))&&(r=e.x||0,a=e.y||0,s=e.x2!=null?e.x2:r,h=e.y2!=null?e.y2:a,t.beginPath(),t.moveTo(r,a),t.lineTo(s,h),!0)}var Y0t={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",CB(e)),t("x2",e.x2!=null?e.x2-(e.x||0):0),t("y2",e.y2!=null?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return Zb(t.set(n=e.x||0,r=e.y||0,e.x2!=null?e.x2:n,e.y2!=null?e.y2:r),e)},draw:function(t,e,n){P0(e,r=>{if(!n||n.intersects(r.bounds)){var a=r.opacity==null?1:r.opacity;a&&ret(t,r,a)&&(e3(t,r),t.stroke())}})},pick:X6(function(t,e,n,r){return!!t.isPointInStroke&&ret(t,e,1)&&t.isPointInStroke(n,r)}),isect:Ytt},Y7=K6("shape",function(t,e){return(e.mark.shape||e.shape).context(t)(e)}),q7=K6("symbol",function(t,e){return lB.context(t)(e)},B7);let iet=function(t){let e,n,r;t=+t||1e4;let a=()=>{e={},n={},r=0},s=(h,d)=>(++r>t&&(n=e,e={},r=1),e[h]=d);return a(),{clear:a,has:h=>h1(e,h)||h1(n,h),get:h=>h1(e,h)?e[h]:h1(n,h)?s(h,n[h]):void 0,set:(h,d)=>h1(e,h)?e[h]=d:s(h,d)}}();var L4={height:Km,measureWidth:IB,estimateWidth:AB,width:AB,canvas:y1};function y1(t){L4.width=t&&Xm?IB:AB}function AB(t,e){return n3(cy(t,e),Km(t))}function n3(t,e){return~~(.8*t.length*e)}function IB(t,e){return Km(t)<=0||!(e=cy(t,e))?0:aet(e,X7(t))}function aet(t,e){let n=`(${e}) ${t}`,r=iet.get(n);return r===void 0&&(Xm.font=e,r=Xm.measureText(t).width,iet.set(n,r)),r}function Km(t){return t.fontSize!=null?+t.fontSize||0:11}function Zm(t){return t.lineHeight!=null?t.lineHeight:Km(t)+2}function eC(t){return e=t.lineBreak&&t.text&&!F0(t.text)?t.text.split(t.lineBreak):t.text,F0(e)?e.length>1?e:e[0]:e;var e}function q0t(t){let e=eC(t);return(F0(e)?e.length-1:0)*Zm(t)}function cy(t,e){let n=e==null?"":(e+"").trim();return t.limit>0&&n.length?function(r,a){var s=+r.limit,h=function(I){if(L4.width===IB){let R=X7(I);return z=>aet(z,R)}{let R=Km(I);return z=>n3(z,R)}}(r);if(h(a)<s)return a;var d,g=r.ellipsis||"\u2026",b=r.dir==="rtl",_=0,E=a.length;if(s-=h(g),b){for(;_<E;)d=_+E>>>1,h(a.slice(d))>s?_=d+1:E=d;return g+a.slice(_)}for(;_<E;)d=1+(_+E>>>1),h(a.slice(0,d))<s?_=d:E=d-1;return a.slice(0,_)+g}(t,n):n}function nC(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function X7(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Km(t)+"px "+nC(t,e)}function K7(t){var e=t.baseline,n=Km(t);return Math.round(e==="top"?.79*n:e==="middle"?.3*n:e==="bottom"?-.21*n:e==="line-top"?.29*n+.5*Zm(t):e==="line-bottom"?.29*n-.5*Zm(t):0)}y1(!0);let X0t={left:"start",center:"middle",right:"end"},rC=new Xd;function Z7(t){var e,n=t.x||0,r=t.y||0,a=t.radius||0;return a&&(e=(t.theta||0)-z0,n+=a*Math.cos(e),r+=a*Math.sin(e)),rC.x1=n,rC.y1=r,rC}function NB(t,e,n){var r,a=L4.height(e),s=e.align,h=Z7(e),d=h.x1,g=h.y1,b=e.dx||0,_=(e.dy||0)+K7(e)-Math.round(.8*a),E=eC(e);if(F0(E)?(a+=Zm(e)*(E.length-1),r=E.reduce((I,R)=>Math.max(I,L4.width(e,R)),0)):r=L4.width(e,E),s==="center"?b-=r/2:s==="right"&&(b-=r),t.set(b+=d,_+=g,b+r,_+a),e.angle&&!n)t.rotate(e.angle*f1,d,g);else if(n===2)return t.rotatedPoints(e.angle*f1,d,g);return t}var oet={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,a=(e.dy||0)+K7(e),s=Z7(e),h=s.x1,d=s.y1,g=e.angle||0;t("text-anchor",X0t[e.align]||"start"),g?(n=g1(h,d)+" "+W7(g),(r||a)&&(n+=" "+g1(r,a))):n=g1(h+r,d+a),t("transform",n)},bound:NB,draw:function(t,e,n){P0(e,r=>{var a,s,h,d,g,b,_,E=r.opacity==null?1:r.opacity;if(!(n&&!n.intersects(r.bounds)||E===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(t.font=X7(r),t.textAlign=r.align||"left",s=(a=Z7(r)).x1,h=a.y1,r.angle&&(t.save(),t.translate(s,h),t.rotate(r.angle*f1),s=h=0),s+=r.dx||0,h+=(r.dy||0)+K7(r),b=eC(r),e3(t,r),F0(b))for(g=Zm(r),d=0;d<b.length;++d)_=cy(r,b[d]),r.fill&&Y6(t,r,E)&&t.fillText(_,s,h),r.stroke&&R4(t,r,E)&&t.strokeText(_,s,h),h+=g;else _=cy(r,b),r.fill&&Y6(t,r,E)&&t.fillText(_,s,h),r.stroke&&R4(t,r,E)&&t.strokeText(_,s,h);r.angle&&t.restore()}})},pick:X6(function(t,e,n,r,a,s){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var h=Z7(e),d=h.x1,g=h.y1,b=NB(rC,e,1),_=-e.angle*f1,E=Math.cos(_),I=Math.sin(_),R=E*a-I*s+(d-E*d+I*g),z=I*a+E*s+(g-I*d-E*g);return b.contains(R,z)}),isect:function(t,e){let n=NB(rC,t,2);return t3(e,n[0],n[1],n[2],n[3])||t3(e,n[0],n[1],n[4],n[5])||t3(e,n[4],n[5],n[6],n[7])||t3(e,n[2],n[3],n[6],n[7])}},K0t=V7("trail",function(t,e){return cB.context(t)(e)},function(t,e){for(var n,r,a=t.length;--a>=0;)if(t[a].defined!==!1&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<(n=t[a].size||1)*n)return t[a];return null}),B0={arc:Ztt,area:B0t,group:W0t,image:eet,line:V0t,path:G0t,rect:H0t,rule:Y0t,shape:Y7,symbol:q7,text:oet,trail:K0t};function MB(t,e,n){var r=B0[t.mark.marktype],a=e||r.bound;return r.nested&&(t=t.mark),a(t.bounds||(t.bounds=new Xd),t,n)}var set={mark:null};function uet(t,e,n){var r,a,s,h,d=B0[t.marktype],g=d.bound,b=t.items,_=b&&b.length;if(d.nested)return _?s=b[0]:(set.mark=t,s=set),h=MB(s,g,n),e=e&&e.union(h)||h;if(e=e||t.bounds&&t.bounds.clear()||new Xd,_)for(r=0,a=b.length;r<a;++r)e.union(MB(b[r],g,n));return t.bounds=e}let cet=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function Q7(t,e){return JSON.stringify(t,cet,e)}function pu(t){return mu(typeof t=="string"?JSON.parse(t):t)}function mu(t){var e,n,r,a=t.marktype,s=t.items;if(s)for(n=0,r=s.length;n<r;++n)e=a?"mark":"group",s[n][e]=t,s[n].zindex&&(s[n][e].zdirty=!0),(a||e)==="group"&&mu(s[n]);return a&&uet(t),t}function Nh(t){arguments.length?this.root=pu(t):(this.root=J7({marktype:"group",name:"root",role:"frame"}),this.root.items=[new R7(this.root)])}function J7(t,e){let n={bounds:new Xd,clip:!!t.clip,group:e,interactive:t.interactive!==!1,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return t.aria!=null&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function Rp(t,e,n){return!t&&typeof document<"u"&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function DB(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,a=n.length;r<a;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function tc(t,e,n,r){var a,s=t.childNodes[e];return s&&s.tagName.toLowerCase()===n.toLowerCase()||(a=s||null,s=Rp(t.ownerDocument,n,r),t.insertBefore(s,a)),s}function sd(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function het(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function RB(t,e){let n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function Qm(t,e){this._active=null,this._handlers={},this._loader=t||Ub(),this._tooltip=e||det}function det(t,e,n,r){t.element().setAttribute("title",r||"")}function j0(t){this._el=null,this._bgcolor=null,this._loader=new pB(t)}Nh.prototype={toJSON(t){return Q7(this.root,t||0)},mark(t,e,n){let r=J7(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},Qm.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){let e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(let r in e)n.push(...e[r]);return n},eventName(t){let e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then(r=>{let a=new MouseEvent(t.type,t),s=Rp(null,"a");for(let h in r)s.setAttribute(h,r[h]);s.dispatchEvent(a)}).catch(()=>{})},handleTooltip(t,e,n){if(e&&e.tooltip!=null){e=function(a,s,h,d){var g,b,_=a&&a.mark;if(_&&(g=B0[_.marktype]).tip){for((b=RB(s,h))[0]-=d[0],b[1]-=d[1];a=a.mark.group;)b[0]-=a.x||0,b[1]-=a.y||0;a=g.tip(_.items,b)}return a}(e,t,this.canvas(),this._origin);let r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){let e=this.canvas();if(!e)return;let n=e.getBoundingClientRect(),r=this._origin,a=t.bounds,s=a.width(),h=a.height(),d=a.x1+r[0]+n.left,g=a.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)d+=t.x||0,g+=t.y||0;return{x:d,y:g,width:s,height:h,left:d,top:g,right:d+s,bottom:g+h}}},j0.prototype={initialize(t,e,n,r,a){return this._el=t,this.resize(e,n,r,a)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t){let e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){let e=this.render(t);return this._ready?this._ready.then(()=>e):Promise.resolve(e)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){let a=n._call;n._ready=n._loader.ready().then(s=>{s&&a(),n._ready=null})}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};let fet="dragenter",r3="dragleave",pet="dragover",tN="mousedown",iC="mousemove",$4="mouseout",i3="mouseover",aC="click",met="mousewheel",eN="touchstart",nN="touchmove",rN="touchend",get=["keydown","keypress","keyup",fet,r3,pet,tN,"mouseup",iC,$4,i3,aC,"dblclick","wheel",met,eN,nN,rN],oC=iC,sC=$4,uC=aC;function z4(t,e){Qm.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function FB(t,e){(n=>n===eN||n===nN||n===rN?[eN,nN,rN]:[n])(e).forEach(n=>function(r,a){let s=r.canvas();s&&!r._events[a]&&(r._events[a]=1,s.addEventListener(a,r[a]?h=>r[a](h):h=>r.fire(a,h)))}(t,n))}function yet(t,e,n){return function(r){let a=this._active,s=this.pickEvent(r);s===a||(a&&a.exit||this.fire(n,r),this._active=s,this.fire(e,r)),this.fire(t,r)}}function OB(t){return function(e){this.fire(t,e),this._active=null}}m4(z4,Qm,{initialize(t,e,n){return this._canvas=t&&DB(t,"canvas"),[aC,tN,iC,$4,r3].forEach(r=>FB(this,r)),Qm.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:get,DOMMouseScroll(t){this.fire(met,t)},mousemove:yet(iC,i3,$4),dragover:yet(pet,fet,r3),mouseout:OB($4),dragleave:OB(r3),mousedown(t){this._down=this._active,this.fire(tN,t)},click(t){this._down===this._active&&(this.fire(aC,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(eN,t,!0)},touchmove(t){this.fire(nN,t,!0)},touchend(t){this.fire(rN,t,!0),this._touch=null},fire(t,e,n){let r=n?this._touch:this._active,a=this._handlers[t];if(e.vegaType=t,t===uC&&r&&r.href?this.handleHref(e,r,r.href):t!==oC&&t!==sC||this.handleTooltip(e,r,t!==sC),a)for(let s=0,h=a.length;s<h;++s)a[s].handler.call(this._obj,e,r)},on(t,e){let n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(FB(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){let n=this.eventName(t),r=this._handlers[n],a=this._handlerIndex(r,t,e);return a>=0&&r.splice(a,1),this},pickEvent(t){let e=RB(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,a){let s=this.context();return B0[t.marktype].pick.call(this,s,t,e,n,r,a)}});var vet=typeof window<"u"&&window.devicePixelRatio||1;function lC(t){j0.call(this,t),this._options={},this._redraw=!1,this._dirty=new Xd,this._tempb=new Xd}let bet=j0.prototype;function LB(t,e){Qm.call(this,t,e);let n=this;n._hrefHandler=P4(n,(r,a)=>{a&&a.href&&n.handleHref(r,a,a.href)}),n._tooltipHandler=P4(n,(r,a)=>{n.handleTooltip(r,a,r.type!==sC)})}m4(lC,j0,{initialize(t,e,n,r,a,s){return this._options=s||{},this._canvas=this._options.externalContext?null:lp(1,1),t&&this._canvas&&(sd(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),bet.initialize.call(this,t,e,n,r,a)},resize(t,e,n,r){if(bet.resize.call(this,t,e,n,r),this._canvas)(function(a,s,h,d,g,b){let _=typeof HTMLElement<"u"&&a instanceof HTMLElement&&a.parentNode!=null,E=a.getContext("2d"),I=_?vet:g;a.width=s*I,a.height=h*I;for(let R in b)E[R]=b[R];_&&I!==1&&(a.style.width=s+"px",a.style.height=h+"px"),E.pixelRatio=I,E.setTransform(I,0,0,I,I*d[0],I*d[1])})(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{let a=this._options.externalContext;a||c1("CanvasRenderer is missing a valid canvas or context"),a.scale(this._scale,this._scale),a.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){let e=this._tempb.clear().union(t.bounds),n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){let e=this.context(),n=this._origin,r=this._width,a=this._height,s=this._dirty,h=((g,b,_)=>new Xd().set(0,0,b,_).translate(-g[0],-g[1]))(n,r,a);e.save();let d=this._redraw||s.empty()?(this._redraw=!1,h.expand(1)):function(g,b,_){return b.expand(1).round(),g.pixelRatio%1&&b.scale(g.pixelRatio).round().scale(1/g.pixelRatio),b.translate(-_[0]%1,-_[1]%1),g.beginPath(),g.rect(b.x1,b.y1,b.width(),b.height()),g.clip(),b}(e,h.intersect(s),n);return this.clear(-n[0],-n[1],r,a),this.draw(e,t,d),e.restore(),s.clear(),this},draw(t,e,n){let r=B0[e.marktype];e.clip&&function(a,s){var h=s.clip;a.save(),u7(h)?(a.beginPath(),h(a),a.clip()):Qtt(a,s.group)}(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,r){let a=this._options,s=this.context();a.type==="pdf"||a.externalContext||s.clearRect(t,e,n,r),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(t,e,n,r))}});let P4=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};m4(LB,Qm,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(uC,this._hrefHandler),r.removeEventListener(oC,this._tooltipHandler),r.removeEventListener(sC,this._tooltipHandler)),this._svg=r=t&&DB(t,"svg"),r&&(r.addEventListener(uC,this._hrefHandler),r.addEventListener(oC,this._tooltipHandler),r.addEventListener(sC,this._tooltipHandler)),Qm.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){let n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){let a={type:t,handler:e,listener:P4(this,e)};(r[n]||(r[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this},off(t,e){let n=this.eventName(t),r=this._handlers[n],a=this._handlerIndex(r,t,e);return a>=0&&(this._svg&&this._svg.removeEventListener(n,r[a].listener),r.splice(a,1)),this}});let wet="aria-hidden",$B="aria-label",zB="role",cC="aria-roledescription",PB="graphics-object",xc="graphics-symbol",jo=(t,e,n)=>({[zB]:t,[cC]:e,[$B]:n||void 0}),as=yP(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),hC={axis:{desc:"axis",caption:function(t){let e=t.datum,n=t.orient,r=e.title?aN(t):null,a=t.context,s=a.scales[e.scale].value,h=a.dataflow.locale(),d=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${Stt(d)?"discrete":d} scale with ${yo(h,s,t)}`}},legend:{desc:"legend",caption:function(t){let e=t.datum,n=e.title?aN(t):null,r=`${e.type||""} legend`.trim(),a=e.scales,s=Object.keys(a),h=t.context,d=h.scales[a[s[0]]].value,g=h.dataflow.locale();return function(b){return b.length?b[0].toUpperCase()+b.slice(1):b}(r)+(n?` titled '${n}'`:"")+` for ${function(b){return b=b.map(_=>_+(_==="fill"||_==="stroke"?" color":"")),b.length<2?b[0]:b.slice(0,-1).join(", ")+" and "+zb(b)}(s)} with ${yo(g,d,t)}`}},"title-text":{desc:"title",caption:t=>`Title text '${B4(t)}'`},"title-subtitle":{desc:"subtitle",caption:t=>`Subtitle text '${B4(t)}'`}},iN={ariaRole:zB,ariaRoleDescription:cC,description:$B};function BB(t,e){let n=e.aria===!1;if(t(wet,n||void 0),n||e.description==null)for(let r in iN)t(iN[r],void 0);else{let r=e.mark.marktype;t($B,e.description),t(zB,e.ariaRole||(r==="group"?PB:xc)),t(cC,e.ariaRoleDescription||`${r} mark`)}}function jB(t){return t.aria===!1?{[wet]:!0}:as[t.role]?null:hC[t.role]?function(e,n){try{let r=e.items[0],a=n.caption||(()=>"");return jo(n.role||xc,n.desc,r.description||a(r))}catch{return null}}(t,hC[t.role]):function(e){let n=e.marktype,r=n==="group"||n==="text"||e.items.some(a=>a.description!=null&&a.aria!==!1);return jo(r?PB:xc,`${n} mark container`,e.description)}(t)}function B4(t){return Pb(t.text).join(" ")}function aN(t){try{return Pb(zb(t.items).items[0].text).join(" ")}catch{return null}}let UB=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),xet=t=>UB(t).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function j4(){let t="",e="",n="",r=[],a=()=>e=n="",s=(d,g)=>(g!=null&&(e+=` ${d}="${xet(g)}"`),h),h={open(d,...g){(b=>{e&&(t+=`${e}>${n}`,a()),r.push(b)})(d),e="<"+d;for(let b of g)for(let _ in b)s(_,b[_]);return h},close(){let d=r.pop();return t+=e?e+(n?`>${n}</${d}>`:"/>"):`</${d}>`,a(),h},attr:s,text:d=>(n+=UB(d),h),toString:()=>t};return h}let ket=t=>WB(j4(),t)+"";function WB(t,e){if(t.open(e.tagName),e.hasAttributes()){let n=e.attributes,r=n.length;for(let a=0;a<r;++a)t.attr(n[a].name,n[a].value)}if(e.hasChildNodes()){let n=e.childNodes,r=n.length;for(let a=0;a<r;a++){let s=n[a];s.nodeType===3?t.text(s.nodeValue):WB(t,s)}}return t.close()}let oN={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},dC={fill:"none","stroke-miterlimit":10},Fp="http://www.w3.org/2000/xmlns/",Fl=Q6.xmlns;function fC(t){j0.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}let sN=j0.prototype;function VB(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function _et(t,e,n){let r,a,s;if(e.gradient==="radial"){let h=tc(t,n++,"pattern",Fl);hy(h,{id:Af+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),h=tc(h,0,"rect",Fl),hy(h,{width:1,height:1,fill:`url(${lN()}#${e.id})`}),hy(t=tc(t,n++,"radialGradient",Fl),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else hy(t=tc(t,n++,"linearGradient",Fl),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,a=e.stops.length;r<a;++r)s=tc(t,r,"stop",Fl),s.setAttribute("offset",e.stops[r].offset),s.setAttribute("stop-color",e.stops[r].color);return sd(t,r),n}function Cet(t,e,n){let r;return(t=tc(t,n,"clipPath",Fl)).setAttribute("id",e.id),e.path?(r=tc(t,0,"path",Fl),r.setAttribute("d",e.path)):(r=tc(t,0,"rect",Fl),hy(r,{x:0,y:0,width:e.width,height:e.height})),sd(t,1),n+1}function Eet(t,e,n,r,a){let s,h=t._svg;if(!h&&(s=e.ownerDocument,h=Rp(s,r,Fl),t._svg=h,t.mark&&(h.__data__=t,h.__values__={fill:"default"},r==="g"))){let d=Rp(s,"path",Fl);h.appendChild(d),d.__data__=t;let g=Rp(s,"g",Fl);h.appendChild(g),g.__data__=t;let b=Rp(s,"path",Fl);h.appendChild(b),b.__data__=t,b.__values__={fill:"default"}}return(h.ownerSVGElement!==a||function(d,g){return d.parentNode&&d.parentNode.childNodes.length>1&&d.previousSibling!=g}(h,n))&&e.insertBefore(h,n?n.nextSibling:e.firstChild),h}m4(fC,j0,{initialize(t,e,n,r,a){return this._defs={},this._clearDefs(),t&&(this._svg=tc(t,0,"svg",Fl),this._svg.setAttributeNS(Fp,"xmlns",Fl),this._svg.setAttributeNS(Fp,"xmlns:xlink",Q6["xmlns:xlink"]),this._svg.setAttribute("version",Q6.version),this._svg.setAttribute("class","marks"),sd(t,1),this._root=tc(this._svg,0,"g",Fl),hy(this._root,dC),sd(this._svg,1)),this.background(this._bgcolor),sN.initialize.call(this,t,e,n,r,a)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),sN.background.apply(this,arguments)},resize(t,e,n,r){return sN.resize.call(this,t,e,n,r),this._svg&&(hy(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){let t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=tc(t,0,"rect",Fl),hy(n,{width:this._width,height:this._height,fill:e}));let r=ket(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),sd(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;let t=this._dirty;if(!t.length||!this._dirtyID)return!0;let e=++this._dirtyID,n,r,a,s,h,d,g;for(h=0,d=t.length;h<d;++h)n=t[h],r=n.mark,r.marktype!==a&&(a=r.marktype,s=B0[a]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,VB(n,e),r.items.forEach(b=>{b.dirty=e})),r.zdirty||(n.exit?(s.nested&&r.items.length?(g=r.items[0],g._svg&&this._update(s,g._svg,g)):n._svg&&(g=n._svg.parentNode,g&&g.removeChild(n._svg)),n._svg=null):(n=s.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(s,n._svg,n):(this._dirtyAll=!1,VB(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;let r=this._svg,a=B0[e.marktype],s=e.interactive===!1?"none":null,h=a.tag==="g",d=null,g=0,b=Eet(e,t,n,"g",r);b.setAttribute("class",het(e));let _=jB(e);for(let I in _)ud(b,I,_[I]);h||ud(b,"pointer-events",s),ud(b,"clip-path",e.clip?oy(this,e,e.group):null);let E=I=>{let R=this.isDirty(I),z=Eet(I,b,d,a.tag,r);R&&(this._update(a,z,I),h&&function(P,rt,ot){rt=rt.lastChild.previousSibling;let at,dt=0;P0(ot,ct=>{at=P.mark(rt,ct,at),++dt}),sd(rt,1+dt)}(this,z,I)),d=z,++g};return a.nested?e.items.length&&E(e.items[0]):P0(e,E),sd(b,g),b},_update(t,e,n){v1=e,th=e.__values__,BB(U4,n),t.attr(U4,n,this);let r=Tet[t.type];r&&r.call(this,t,e,n),v1&&this.style(v1,n)},style(t,e){if(e!=null)for(let n in oN){let r=n==="font"?nC(e):e[n];if(r===th[n])continue;let a=oN[n];r==null?t.removeAttribute(a):(Xb(r)&&(r=Dtt(r,this._defs.gradient,lN())),t.setAttribute(a,r+"")),th[n]=r}},defs(){let t=this._svg,e=this._defs,n=e.el,r=0;for(let a in e.gradient)n||(e.el=n=tc(t,1,"defs",Fl)),r=_et(n,e.gradient[a],r);for(let a in e.clipping)n||(e.el=n=tc(t,1,"defs",Fl)),r=Cet(n,e.clipping[a],r);n&&(r===0?(t.removeChild(n),e.el=null):sd(n,r))},_clearDefs(){let t=this._defs;t.gradient={},t.clipping={}}});let v1=null,th=null,Tet={group(t,e,n){let r=v1=e.childNodes[2];th=r.__values__,t.foreground(U4,n,this),th=e.__values__,v1=e.childNodes[1],t.content(U4,n,this);let a=v1=e.childNodes[0];t.background(U4,n,this);let s=n.mark.interactive===!1?"none":null;if(s!==th.events&&(ud(r,"pointer-events",s),ud(a,"pointer-events",s),th.events=s),n.strokeForeground&&n.stroke){let h=n.fill;ud(r,"display",null),this.style(a,n),ud(a,"stroke",null),h&&(n.fill=null),th=r.__values__,this.style(r,n),h&&(n.fill=h),v1=null}else ud(r,"display","none")},image(t,e,n){n.smooth===!1?(uN(e,"image-rendering","optimizeSpeed"),uN(e,"image-rendering","pixelated")):uN(e,"image-rendering",null)},text(t,e,n){let r=eC(n),a,s,h,d;F0(r)?(s=r.map(g=>cy(n,g)),a=s.join(`
`),a!==th.text&&(sd(e,0),h=e.ownerDocument,d=Zm(n),s.forEach((g,b)=>{let _=Rp(h,"tspan",Fl);_.__data__=n,_.textContent=g,b&&(_.setAttribute("x",0),_.setAttribute("dy",d)),e.appendChild(_)}),th.text=a)):(s=cy(n,r),s!==th.text&&(e.textContent=s,th.text=s)),ud(e,"font-family",nC(n)),ud(e,"font-size",Km(n)+"px"),ud(e,"font-style",n.fontStyle),ud(e,"font-variant",n.fontVariant),ud(e,"font-weight",n.fontWeight)}};function U4(t,e,n){e!==th[t]&&(n?function(r,a,s,h){s!=null?r.setAttributeNS(h,a,s):r.removeAttributeNS(h,a)}(v1,t,e,n):ud(v1,t,e),th[t]=e)}function uN(t,e,n){n!==th[e]&&(n==null?t.style.removeProperty(e):t.style.setProperty(e,n+""),th[e]=n)}function hy(t,e){for(let n in e)ud(t,n,e[n])}function ud(t,e,n){n!=null?t.setAttribute(e,n):t.removeAttribute(e)}function lN(){let t;return typeof window>"u"?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function GB(t){j0.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}m4(GB,j0,{svg(){return this._text},_render(t){let e=j4();e.open("svg",l7({},Q6,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));let n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",dC,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){let n=B0[e.marktype],r=n.tag,a=[BB,n.attr];t.open("g",{class:het(e),"clip-path":e.clip?oy(this,e,e.group):null},jB(e),{"pointer-events":r!=="g"&&e.interactive===!1?"none":null});let s=h=>{let d=this.href(h);if(d&&t.open("a",d),t.open(r,this.attr(e,h,a,r!=="g"?r:null)),r==="text"){let g=eC(h);if(F0(g)){let b={x:0,dy:Zm(h)};for(let _=0;_<g.length;++_)t.open("tspan",_?b:null).text(cy(h,g[_])).close()}else t.text(cy(h,g))}else if(r==="g"){let g=h.strokeForeground,b=h.fill,_=h.stroke;g&&_&&(h.stroke=null),t.open("path",this.attr(e,h,n.background,"bgrect")).close(),t.open("g",this.attr(e,h,n.content)),P0(h,E=>this.mark(t,E)),t.close(),g&&_?(b&&(h.fill=null),h.stroke=_,t.open("path",this.attr(e,h,n.foreground,"bgrect")).close(),b&&(h.fill=b)):t.open("path",this.attr(e,h,n.foreground,"bgfore")).close()}t.close(),d&&t.close()};return n.nested?e.items&&e.items.length&&s(e.items[0]):P0(e,s),t.close()},href(t){let e=t.href,n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[e]=r})}return null},attr(t,e,n,r){let a={},s=(h,d,g,b)=>{a[b||h]=d};return Array.isArray(n)?n.forEach(h=>h(s,e,this)):n(s,e,this),r&&function(h,d,g,b,_){if(d==null||(b==="bgrect"&&g.interactive===!1&&(h["pointer-events"]="none"),b==="bgfore"&&(g.interactive===!1&&(h["pointer-events"]="none"),h.display="none",d.fill!==null)))return h;b==="image"&&d.smooth===!1&&(h.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),b==="text"&&(h["font-family"]=nC(d),h["font-size"]=Km(d)+"px",h["font-style"]=d.fontStyle,h["font-variant"]=d.fontVariant,h["font-weight"]=d.fontWeight);for(let E in oN){let I=d[E],R=oN[E];(I!=="transparent"||R!=="fill"&&R!=="stroke")&&I!=null&&(Xb(I)&&(I=Dtt(I,_.gradient,"")),h[R]=I)}}(a,e,t,r,this._defs),a},defs(t){let e=this._defs.gradient,n=this._defs.clipping;if(Object.keys(e).length+Object.keys(n).length!==0){t.open("defs");for(let r in e){let a=e[r],s=a.stops;a.gradient==="radial"?(t.open("pattern",{id:Af+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),t.close(),t.open("radialGradient",{id:r,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):t.open("linearGradient",{id:r,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(let h=0;h<s.length;++h)t.open("stop",{offset:s[h].offset,"stop-color":s[h].color}).close();t.close()}for(let r in n){let a=n[r];t.open("clipPath",{id:r}),a.path?t.open("path",{d:a.path}).close():t.open("rect",{x:0,y:0,width:a.width,height:a.height}).close(),t.close()}t.close()}}});let Aet="canvas",HB="none",YB={Canvas:Aet,PNG:"png",SVG:"svg",None:HB},a3={};function qB(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(a3[t]=e,this):a3[t]}function Iet(t,e,n){let r=[],a=new Xd().union(e),s=t.marktype;return s?Net(t,a,n,r):s==="group"?XB(t,a,n,r):c1("Intersect scene must be mark node or group item.")}function Net(t,e,n,r){if(function(a,s,h){return a.bounds&&s.intersects(a.bounds)&&(a.marktype==="group"||a.interactive!==!1&&(!h||h(a)))}(t,e,n)){let a=t.items,s=t.marktype,h=a.length,d=0;if(s==="group")for(;d<h;++d)XB(a[d],e,n,r);else for(let g=B0[s].isect;d<h;++d){let b=a[d];Met(b,e,g)&&r.push(b)}}return r}function XB(t,e,n,r){n&&n(t.mark)&&Met(t,e,B0.group.isect)&&r.push(t);let a=t.items,s=a&&a.length;if(s){let h=t.x||0,d=t.y||0;e.translate(-h,-d);for(let g=0;g<s;++g)Net(a[g],e,n,r);e.translate(h,d)}return r}function Met(t,e,n){let r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}a3[Aet]=a3.png={renderer:lC,headless:lC,handler:z4},a3.svg={renderer:fC,headless:GB,handler:LB},a3[HB]={};let W4=new Xd;function pC(t){let e=t.clip;if(u7(e))e(D4(W4.clear()));else{if(!e)return;W4.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(W4)}let Z0t=1e-9;function KB(t,e,n){return t===e||(n==="path"?ZB(t,e):t instanceof Date&&e instanceof Date?+t==+e:dJ(t)&&dJ(e)?Math.abs(t-e)<=Z0t:t&&e&&(gP(t)||gP(e))?function(r,a){var s,h,d=Object.keys(r),g=Object.keys(a);if(d.length!==g.length)return!1;for(d.sort(),g.sort(),h=d.length-1;h>=0;h--)if(d[h]!=g[h])return!1;for(h=d.length-1;h>=0;h--)if(!KB(r[s=d[h]],a[s],s))return!1;return typeof r==typeof a}(t,e):t==e)}function ZB(t,e){return KB(P6(t),P6(e))}function Det(){Wtt(),ry=0}function Jm(t,e,n){return t.fields=e||[],t.fname=n,t}function Ret(t){return t.length===1?mC(t[0]):Q0t(t)}let mC=t=>function(e){return e[t]},Q0t=t=>{let e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function V4(t){throw Error(t)}function G4(t){let e=[],n=t.length,r,a,s,h=null,d=0,g="";function b(){e.push(g+t.substring(r,a)),g="",r=a+1}for(t+="",r=a=0;a<n;++a)if(s=t[a],s==="\\")g+=t.substring(r,a++),r=a;else if(s===h)b(),h=null,d=-1;else{if(h)continue;r===d&&s==='"'||r===d&&s==="'"?(r=a+1,h=s):s!=="."||d?s==="["?(a>r&&b(),d=r=a+1):s==="]"&&(d||V4("Access path missing open bracket: "+t),d>0&&b(),d=0,r=a+1):a>r?b():r=a+1}return d&&V4("Access path missing closing bracket: "+t),h&&V4("Access path missing closing quote: "+t),a>r&&(a++,b()),e}function cN(t,e,n){let r=G4(t);return t=r.length===1?r[0]:t,Jm(Ret(r),[t],t)}cN("id"),Jm(t=>t,[],"identity"),Jm(()=>0,[],"zero"),Jm(()=>1,[],"one"),Jm(()=>!0,[],"true"),Jm(()=>!1,[],"false");var hN=Array.isArray;function gC(t){return t[t.length-1]}function Fet(t){return t==null||t===""?null:+t}function Oet(t){return t!=null?hN(t)?t:[t]:[]}let Let=Object.prototype.hasOwnProperty;function $et(t,e){return Let.call(t,e)}function U0(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function W0(t,e){switch(arguments.length){case 0:break;case 1:typeof t=="function"?this.interpolator(t):this.range(t);break;default:this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e)}return this}let yC=Symbol("implicit");function dN(){var t=new Map,e=[],n=[],r=yC;function a(s){var h=s+"",d=t.get(h);if(!d){if(r!==yC)return r;t.set(h,d=e.push(s))}return n[(d-1)%n.length]}return a.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new Map;for(let h of s){let d=h+"";t.has(d)||t.set(d,e.push(h))}return a},a.range=function(s){return arguments.length?(n=Array.from(s),a):n.slice()},a.unknown=function(s){return arguments.length?(r=s,a):r},a.copy=function(){return dN(e,n).unknown(r)},U0.apply(a,arguments),a}var QB,zet=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function fN(t){if(!(e=zet.exec(t)))throw new Error("invalid format: "+t);var e;return new JB({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function JB(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}function pN(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function dy(t){return(t=pN(Math.abs(t)))?t[1]:NaN}function tj(t,e){var n=pN(t,e);if(!n)return t+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}fN.prototype=JB.prototype,JB.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,0|this.width))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};let Pet={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>tj(100*t,e),r:tj,s:function(t,e){var n=pN(t,e);if(!n)return t+"";var r=n[0],a=n[1],s=a-(QB=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,h=r.length;return s===h?r:s>h?r+new Array(s-h+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+pN(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Bet(t){return t}var ej,nj,rj,jet=Array.prototype.map,Uet=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function J0t(t){var e,n,r=t.grouping===void 0||t.thousands===void 0?Bet:(e=jet.call(t.grouping,Number),n=t.thousands+"",function(I,R){for(var z=I.length,P=[],rt=0,ot=e[0],at=0;z>0&&ot>0&&(at+ot+1>R&&(ot=Math.max(1,R-at)),P.push(I.substring(z-=ot,z+ot)),!((at+=ot+1)>R));)ot=e[rt=(rt+1)%e.length];return P.reverse().join(n)}),a=t.currency===void 0?"":t.currency[0]+"",s=t.currency===void 0?"":t.currency[1]+"",h=t.decimal===void 0?".":t.decimal+"",d=t.numerals===void 0?Bet:function(I){return function(R){return R.replace(/[0-9]/g,function(z){return I[+z]})}}(jet.call(t.numerals,String)),g=t.percent===void 0?"%":t.percent+"",b=t.minus===void 0?"\u2212":t.minus+"",_=t.nan===void 0?"NaN":t.nan+"";function E(I){var R=(I=fN(I)).fill,z=I.align,P=I.sign,rt=I.symbol,ot=I.zero,at=I.width,dt=I.comma,ct=I.precision,Ct=I.trim,Et=I.type;Et==="n"?(dt=!0,Et="g"):Pet[Et]||(ct===void 0&&(ct=12),Ct=!0,Et="g"),(ot||R==="0"&&z==="=")&&(ot=!0,R="0",z="=");var Rt=rt==="$"?a:rt==="#"&&/[boxX]/.test(Et)?"0"+Et.toLowerCase():"",Ot=rt==="$"?s:/[%p]/.test(Et)?g:"",Wt=Pet[Et],jt=/[defgprs%]/.test(Et);function Ht(Vt){var fe,se,he,_e=Rt,Ve=Ot;if(Et==="c")Ve=Wt(Vt)+Ve,Vt="";else{var gn=(Vt=+Vt)<0||1/Vt<0;if(Vt=isNaN(Vt)?_:Wt(Math.abs(Vt),ct),Ct&&(Vt=function(qe){t:for(var tr,er=qe.length,An=1,dn=-1;An<er;++An)switch(qe[An]){case".":dn=tr=An;break;case"0":dn===0&&(dn=An),tr=An;break;default:if(!+qe[An])break t;dn>0&&(dn=0)}return dn>0?qe.slice(0,dn)+qe.slice(tr+1):qe}(Vt)),gn&&+Vt==0&&P!=="+"&&(gn=!1),_e=(gn?P==="("?P:b:P==="-"||P==="("?"":P)+_e,Ve=(Et==="s"?Uet[8+QB/3]:"")+Ve+(gn&&P==="("?")":""),jt){for(fe=-1,se=Vt.length;++fe<se;)if(48>(he=Vt.charCodeAt(fe))||he>57){Ve=(he===46?h+Vt.slice(fe+1):Vt.slice(fe))+Ve,Vt=Vt.slice(0,fe);break}}}dt&&!ot&&(Vt=r(Vt,1/0));var $n=_e.length+Vt.length+Ve.length,Gn=$n<at?new Array(at-$n+1).join(R):"";switch(dt&&ot&&(Vt=r(Gn+Vt,Gn.length?at-Ve.length:1/0),Gn=""),z){case"<":Vt=_e+Vt+Ve+Gn;break;case"=":Vt=_e+Gn+Vt+Ve;break;case"^":Vt=Gn.slice(0,$n=Gn.length>>1)+_e+Vt+Ve+Gn.slice($n);break;default:Vt=Gn+_e+Vt+Ve}return d(Vt)}return ct=ct===void 0?6:/[gprs]/.test(Et)?Math.max(1,Math.min(21,ct)):Math.max(0,Math.min(20,ct)),Ht.toString=function(){return I+""},Ht}return{format:E,formatPrefix:function(I,R){var z=E(((I=fN(I)).type="f",I)),P=3*Math.max(-8,Math.min(8,Math.floor(dy(R)/3))),rt=Math.pow(10,-P),ot=Uet[8+P/3];return function(at){return z(rt*at)+ot}}}}function Wet(t,e,n,r){var a,s=H2(t,e,n);switch((r=fN(r??",f")).type){case"s":var h=Math.max(Math.abs(t),Math.abs(e));return r.precision!=null||isNaN(a=function(d,g){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(dy(g)/3)))-dy(Math.abs(d)))}(s,h))||(r.precision=a),rj(r,h);case"":case"e":case"g":case"p":case"r":r.precision!=null||isNaN(a=function(d,g){return d=Math.abs(d),g=Math.abs(g)-d,Math.max(0,dy(g)-dy(d))+1}(s,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=a-(r.type==="e"));break;case"f":case"%":r.precision!=null||isNaN(a=function(d){return Math.max(0,-dy(Math.abs(d)))}(s))||(r.precision=a-2*(r.type==="%"))}return nj(r)}function mN(t){return+t}(function(t){ej=J0t(t),nj=ej.format,rj=ej.formatPrefix})({thousands:",",grouping:[3],currency:["$",""]});var gN=[0,1];function Kd(t){return t}function yN(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(n){return function(){return n}}(isNaN(e)?NaN:.5)}function Vet(t,e,n){var r=t[0],a=t[1],s=e[0],h=e[1];return a<r?(r=yN(a,r),s=n(h,s)):(r=yN(r,a),s=n(s,h)),function(d){return s(r(d))}}function tmt(t,e,n){var r=Math.min(t.length,e.length)-1,a=new Array(r),s=new Array(r),h=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++h<r;)a[h]=yN(t[h],t[h+1]),s[h]=n(e[h],e[h+1]);return function(d){var g=Lm(t,d,1,r)-1;return s[g](a[g](d))}}function vC(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function vN(){var t,e,n,r,a,s,h=gN,d=gN,g=yp,b=Kd;function _(){var I=Math.min(h.length,d.length);return b!==Kd&&(b=function(R,z){var P;return R>z&&(P=R,R=z,z=P),function(rt){return Math.max(R,Math.min(z,rt))}}(h[0],h[I-1])),r=I>2?tmt:Vet,a=s=null,E}function E(I){return I==null||isNaN(I=+I)?n:(a||(a=r(h.map(t),d,g)))(t(b(I)))}return E.invert=function(I){return b(e((s||(s=r(d,h.map(t),C0)))(I)))},E.domain=function(I){return arguments.length?(h=Array.from(I,mN),_()):h.slice()},E.range=function(I){return arguments.length?(d=Array.from(I),_()):d.slice()},E.rangeRound=function(I){return d=Array.from(I),g=lo,_()},E.clamp=function(I){return arguments.length?(b=!!I||Kd,_()):b!==Kd},E.interpolate=function(I){return arguments.length?(g=I,_()):g},E.unknown=function(I){return arguments.length?(n=I,E):n},function(I,R){return t=I,e=R,_()}}function Get(){return vN()(Kd,Kd)}function o3(t){var e=t.domain;return t.ticks=function(n){var r=e();return v$(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var a=e();return Wet(a[0],a[a.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r,a,s=e(),h=0,d=s.length-1,g=s[h],b=s[d],_=10;for(b<g&&(a=g,g=b,b=a,a=h,h=d,d=a);_-- >0;){if((a=bK(g,b,n))===r)return s[h]=g,s[d]=b,e(s);if(a>0)g=Math.floor(g/a)*a,b=Math.ceil(b/a)*a;else{if(!(a<0))break;g=Math.ceil(g*a)/a,b=Math.floor(b*a)/a}r=a}return t},t}function s3(t,e){var n,r=0,a=(t=t.slice()).length-1,s=t[r],h=t[a];return h<s&&(n=r,r=a,a=n,n=s,s=h,h=n),t[r]=e.floor(s),t[a]=e.ceil(h),t}function Het(t){return Math.log(t)}function Yet(t){return Math.exp(t)}function emt(t){return-Math.log(-t)}function nmt(t){return-Math.exp(-t)}function bN(t){return isFinite(t)?+("1e"+t):t<0?0:t}function ij(t){return function(e){return-t(-e)}}function wN(t){var e,n,r=t(Het,Yet),a=r.domain,s=10;function h(){return e=function(d){return d===Math.E?Math.log:d===10&&Math.log10||d===2&&Math.log2||(d=Math.log(d),function(g){return Math.log(g)/d})}(s),n=function(d){return d===10?bN:d===Math.E?Math.exp:function(g){return Math.pow(d,g)}}(s),a()[0]<0?(e=ij(e),n=ij(n),t(emt,nmt)):t(Het,Yet),r}return r.base=function(d){return arguments.length?(s=+d,h()):s},r.domain=function(d){return arguments.length?(a(d),h()):a()},r.ticks=function(d){var g,b=a(),_=b[0],E=b[b.length-1];(g=E<_)&&(P=_,_=E,E=P);var I,R,z,P=e(_),rt=e(E),ot=d==null?10:+d,at=[];if(!(s%1)&&rt-P<ot){if(P=Math.floor(P),rt=Math.ceil(rt),_>0){for(;P<=rt;++P)for(R=1,I=n(P);R<s;++R)if(!((z=I*R)<_)){if(z>E)break;at.push(z)}}else for(;P<=rt;++P)for(R=s-1,I=n(P);R>=1;--R)if(!((z=I*R)<_)){if(z>E)break;at.push(z)}2*at.length<ot&&(at=v$(_,E,ot))}else at=v$(P,rt,Math.min(rt-P,ot)).map(n);return g?at.reverse():at},r.tickFormat=function(d,g){if(g==null&&(g=s===10?".0e":","),typeof g!="function"&&(g=nj(g)),d===1/0)return g;d==null&&(d=10);var b=Math.max(1,s*d/r.ticks().length);return function(_){var E=_/n(Math.round(e(_)));return E*s<s-.5&&(E*=s),E<=b?g(_):""}},r.nice=function(){return a(s3(a(),{floor:function(d){return n(Math.floor(e(d)))},ceil:function(d){return n(Math.ceil(e(d)))}}))},r}function qet(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Xet(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function rmt(t){return t<0?-t*t:t*t}function xN(t){var e=t(Kd,Kd),n=1;return e.exponent=function(r){return arguments.length?(n=+r)==1?t(Kd,Kd):n===.5?t(Xet,rmt):t(qet(n),qet(1/n)):n},o3(e)}function kN(){var t=xN(vN());return t.copy=function(){return vC(t,kN()).exponent(t.exponent())},U0.apply(t,arguments),t}function Ket(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function l(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function i(t){var e=1,n=t(Ket(e),l(e));return n.constant=function(r){return arguments.length?t(Ket(e=+r),l(e)):e},o3(n)}let o=1e3,u=6e4,c=36e5,f=864e5,y=6048e5,w=2592e6,C=31536e6;var T=new Date,x=new Date;function A(t,e,n,r){function a(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=function(s){return t(s=new Date(+s)),s},a.ceil=function(s){return t(s=new Date(s-1)),e(s,1),t(s),s},a.round=function(s){var h=a(s),d=a.ceil(s);return s-h<d-s?h:d},a.offset=function(s,h){return e(s=new Date(+s),h==null?1:Math.floor(h)),s},a.range=function(s,h,d){var g,b=[];if(s=a.ceil(s),d=d==null?1:Math.floor(d),!(s<h&&d>0))return b;do b.push(g=new Date(+s)),e(s,d),t(s);while(g<s&&s<h);return b},a.filter=function(s){return A(function(h){if(h>=h)for(;t(h),!s(h);)h.setTime(h-1)},function(h,d){if(h>=h)if(d<0)for(;++d<=0;)for(;e(h,-1),!s(h););else for(;--d>=0;)for(;e(h,1),!s(h););})},n&&(a.count=function(s,h){return T.setTime(+s),x.setTime(+h),t(T),t(x),Math.floor(n(T,x))},a.every=function(s){return s=Math.floor(s),isFinite(s)&&s>0?s>1?a.filter(r?function(h){return r(h)%s==0}:function(h){return a.count(0,h)%s==0}):a:null}),a}var M=A(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});M.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?A(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):M:null};let $=M;var V=A(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+e*o)},function(t,e){return(e-t)/o},function(t){return t.getUTCSeconds()});let G=V;var Q=A(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*o)},function(t,e){t.setTime(+t+e*u)},function(t,e){return(e-t)/u},function(t){return t.getMinutes()});let nt=Q;var it=A(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*o-t.getMinutes()*u)},function(t,e){t.setTime(+t+e*c)},function(t,e){return(e-t)/c},function(t){return t.getHours()});let ht=it;var kt=A(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*u)/f,t=>t.getDate()-1);let Nt=kt;function $t(t){return A(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+7*n)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*u)/y})}var Ut=$t(0);$t(1),$t(2),$t(3),$t(4),$t(5),$t(6);var Pt=A(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()});let re=Pt;var ue=A(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});ue.every=function(t){return isFinite(t=Math.floor(t))&&t>0?A(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};let be=ue;var De=A(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*u)},function(t,e){return(e-t)/u},function(t){return t.getUTCMinutes()});let ze=De;var Qe=A(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*c)},function(t,e){return(e-t)/c},function(t){return t.getUTCHours()});let cn=Qe;var en=A(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/f},function(t){return t.getUTCDate()-1});let sn=en;function xn(t){return A(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+7*n)},function(e,n){return(n-e)/y})}var Rn=xn(0);xn(1),xn(2),xn(3),xn(4),xn(5),xn(6);var Bn=A(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()});let Fn=Bn;var Xn=A(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});Xn.every=function(t){return isFinite(t=Math.floor(t))&&t>0?A(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};let Nn=Xn;function kr(t,e,n,r,a,s){let h=[[G,1,o],[G,5,5e3],[G,15,15e3],[G,30,3e4],[s,1,u],[s,5,3e5],[s,15,9e5],[s,30,18e5],[a,1,c],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,f],[r,2,1728e5],[n,1,y],[e,1,w],[e,3,7776e6],[t,1,C]];function d(g,b,_){let E=Math.abs(b-g)/_,I=rS(([,,P])=>P).right(h,E);if(I===h.length)return t.every(H2(g/C,b/C,_));if(I===0)return $.every(Math.max(H2(g,b,_),1));let[R,z]=h[E/h[I-1][2]<h[I][2]/E?I-1:I];return R.every(z)}return[function(g,b,_){let E=b<g;E&&([g,b]=[b,g]);let I=_&&typeof _.range=="function"?_:d(g,b,_),R=I?I.range(g,+b+1):[];return E?R.reverse():R},d]}let[Tr,Ar]=kr(Nn,Fn,Rn,sn,cn,ze),[Dr,Ni]=kr(be,re,Ut,Nt,ht,nt);var Mi=new Date,Yi=new Date;function Hr(t,e,n,r){function a(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=function(s){return t(s=new Date(+s)),s},a.ceil=function(s){return t(s=new Date(s-1)),e(s,1),t(s),s},a.round=function(s){var h=a(s),d=a.ceil(s);return s-h<d-s?h:d},a.offset=function(s,h){return e(s=new Date(+s),h==null?1:Math.floor(h)),s},a.range=function(s,h,d){var g,b=[];if(s=a.ceil(s),d=d==null?1:Math.floor(d),!(s<h&&d>0))return b;do b.push(g=new Date(+s)),e(s,d),t(s);while(g<s&&s<h);return b},a.filter=function(s){return Hr(function(h){if(h>=h)for(;t(h),!s(h);)h.setTime(h-1)},function(h,d){if(h>=h)if(d<0)for(;++d<=0;)for(;e(h,-1),!s(h););else for(;--d>=0;)for(;e(h,1),!s(h););})},n&&(a.count=function(s,h){return Mi.setTime(+s),Yi.setTime(+h),t(Mi),t(Yi),Math.floor(n(Mi,Yi))},a.every=function(s){return s=Math.floor(s),isFinite(s)&&s>0?s>1?a.filter(r?function(h){return r(h)%s==0}:function(h){return a.count(0,h)%s==0}):a:null}),a}let wa=6e4,Oa=864e5,Xa=6048e5;function ta(t){return Hr(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+7*n)},function(e,n){return(n-e)/Xa})}var xa=ta(0),Ka=ta(1);ta(2),ta(3);var nu=ta(4);ta(5),ta(6);var Ol=Hr(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/Oa},function(t){return t.getUTCDate()-1});let Wu=Ol;function vo(t){return Hr(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+7*n)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*wa)/Xa})}var eh=vo(0),Ll=vo(1);vo(2),vo(3);var Cu=vo(4);vo(5),vo(6);var Vu=Hr(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*wa)/Oa,t=>t.getDate()-1);let bl=Vu;var $l=Hr(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});$l.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Hr(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};let Zd=$l;var ld=Hr(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});ld.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Hr(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};let Qd=ld;function kc(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Jd(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Op(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var Sc,ru,fy,nh={"-":"",_:" ",0:"0"},os=/^\s*\d+/,Zet=/^%/,Qet=/[\\^$*+?|[\]().{}]/g;function $o(t,e,n){var r=t<0?"-":"",a=(r?-t:t)+"",s=a.length;return r+(s<n?new Array(n-s+1).join(e)+a:a)}function Jet(t){return t.replace(Qet,"\\$&")}function H4(t){return new RegExp("^(?:"+t.map(Jet).join("|")+")","i")}function Y4(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function tnt(t,e,n){var r=os.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function imt(t,e,n){var r=os.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function SN(t,e,n){var r=os.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function _N(t,e,n){var r=os.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function ent(t,e,n){var r=os.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function aj(t,e,n){var r=os.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function bC(t,e,n){var r=os.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function nnt(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function rnt(t,e,n){var r=os.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function amt(t,e,n){var r=os.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function oj(t,e,n){var r=os.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function CN(t,e,n){var r=os.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function sj(t,e,n){var r=os.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function int(t,e,n){var r=os.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function ant(t,e,n){var r=os.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function omt(t,e,n){var r=os.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function smt(t,e,n){var r=os.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function umt(t,e,n){var r=Zet.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function lmt(t,e,n){var r=os.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function ont(t,e,n){var r=os.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function uj(t,e){return $o(t.getDate(),e,2)}function cmt(t,e){return $o(t.getHours(),e,2)}function hmt(t,e){return $o(t.getHours()%12||12,e,2)}function dmt(t,e){return $o(1+bl.count(Zd(t),t),e,3)}function snt(t,e){return $o(t.getMilliseconds(),e,3)}function unt(t,e){return snt(t,e)+"000"}function lnt(t,e){return $o(t.getMonth()+1,e,2)}function lj(t,e){return $o(t.getMinutes(),e,2)}function cnt(t,e){return $o(t.getSeconds(),e,2)}function cj(t){var e=t.getDay();return e===0?7:e}function wC(t,e){return $o(eh.count(Zd(t)-1,t),e,2)}function Lp(t){var e=t.getDay();return e>=4||e===0?Cu(t):Cu.ceil(t)}function fmt(t,e){return t=Lp(t),$o(Cu.count(Zd(t),t)+(Zd(t).getDay()===4),e,2)}function pmt(t){return t.getDay()}function hnt(t,e){return $o(Ll.count(Zd(t)-1,t),e,2)}function dnt(t,e){return $o(t.getFullYear()%100,e,2)}function $p(t,e){return $o((t=Lp(t)).getFullYear()%100,e,2)}function fnt(t,e){return $o(t.getFullYear()%1e4,e,4)}function xC(t,e){var n=t.getDay();return $o((t=n>=4||n===0?Cu(t):Cu.ceil(t)).getFullYear()%1e4,e,4)}function pnt(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+$o(e/60|0,"0",2)+$o(e%60,"0",2)}function EN(t,e){return $o(t.getUTCDate(),e,2)}function mmt(t,e){return $o(t.getUTCHours(),e,2)}function gmt(t,e){return $o(t.getUTCHours()%12||12,e,2)}function TN(t,e){return $o(1+Wu.count(Qd(t),t),e,3)}function hj(t,e){return $o(t.getUTCMilliseconds(),e,3)}function mnt(t,e){return hj(t,e)+"000"}function ymt(t,e){return $o(t.getUTCMonth()+1,e,2)}function vmt(t,e){return $o(t.getUTCMinutes(),e,2)}function dj(t,e){return $o(t.getUTCSeconds(),e,2)}function gnt(t){var e=t.getUTCDay();return e===0?7:e}function ynt(t,e){return $o(xa.count(Qd(t)-1,t),e,2)}function fj(t){var e=t.getUTCDay();return e>=4||e===0?nu(t):nu.ceil(t)}function vnt(t,e){return t=fj(t),$o(nu.count(Qd(t),t)+(Qd(t).getUTCDay()===4),e,2)}function bnt(t){return t.getUTCDay()}function wnt(t,e){return $o(Ka.count(Qd(t)-1,t),e,2)}function xnt(t,e){return $o(t.getUTCFullYear()%100,e,2)}function bmt(t,e){return $o((t=fj(t)).getUTCFullYear()%100,e,2)}function knt(t,e){return $o(t.getUTCFullYear()%1e4,e,4)}function wmt(t,e){var n=t.getUTCDay();return $o((t=n>=4||n===0?nu(t):nu.ceil(t)).getUTCFullYear()%1e4,e,4)}function xmt(){return"+0000"}function AN(){return"%"}function pj(t){return+t}function Snt(t){return Math.floor(+t/1e3)}function kmt(t){return new Date(t)}function Smt(t){return t instanceof Date?+t:+new Date(+t)}function IN(t,e,n,r,a,s,h,d,g,b){var _=Get(),E=_.invert,I=_.domain,R=b(".%L"),z=b(":%S"),P=b("%I:%M"),rt=b("%I %p"),ot=b("%a %d"),at=b("%b %d"),dt=b("%B"),ct=b("%Y");function Ct(Et){return(g(Et)<Et?R:d(Et)<Et?z:h(Et)<Et?P:s(Et)<Et?rt:r(Et)<Et?a(Et)<Et?ot:at:n(Et)<Et?dt:ct)(Et)}return _.invert=function(Et){return new Date(E(Et))},_.domain=function(Et){return arguments.length?I(Array.from(Et,Smt)):I().map(kmt)},_.ticks=function(Et){var Rt=I();return t(Rt[0],Rt[Rt.length-1],Et??10)},_.tickFormat=function(Et,Rt){return Rt==null?Ct:b(Rt)},_.nice=function(Et){var Rt=I();return Et&&typeof Et.range=="function"||(Et=e(Rt[0],Rt[Rt.length-1],Et??10)),Et?I(s3(Rt,Et)):_},_.copy=function(){return vC(_,IN(t,e,n,r,a,s,h,d,g,b))},_}function q4(){var t,e,n,r,a,s=0,h=1,d=Kd,g=!1;function b(E){return E==null||isNaN(E=+E)?a:d(n===0?.5:(E=(r(E)-t)*n,g?Math.max(0,Math.min(1,E)):E))}function _(E){return function(I){var R,z;return arguments.length?([R,z]=I,d=E(R,z),b):[d(0),d(1)]}}return b.domain=function(E){return arguments.length?([s,h]=E,t=r(s=+s),e=r(h=+h),n=t===e?0:1/(e-t),b):[s,h]},b.clamp=function(E){return arguments.length?(g=!!E,b):g},b.interpolator=function(E){return arguments.length?(d=E,b):d},b.range=_(yp),b.rangeRound=_(lo),b.unknown=function(E){return arguments.length?(a=E,b):a},function(E){return r=E,t=E(s),e=E(h),n=t===e?0:1/(e-t),b}}function V0(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function mj(){var t=o3(q4()(Kd));return t.copy=function(){return V0(t,mj())},W0.apply(t,arguments)}function gj(){var t=xN(q4());return t.copy=function(){return V0(t,gj()).exponent(t.exponent())},W0.apply(t,arguments)}function NN(t,e){e===void 0&&(e=t,t=yp);for(var n=0,r=e.length-1,a=e[0],s=new Array(r<0?0:r);n<r;)s[n]=t(a,a=e[++n]);return function(h){var d=Math.max(0,Math.min(r-1,Math.floor(h*=r)));return s[d](h-d)}}function Mt(){var t,e,n,r,a,s,h,d=0,g=.5,b=1,_=1,E=Kd,I=!1;function R(P){return isNaN(P=+P)?h:(P=.5+((P=+s(P))-e)*(_*P<_*e?r:a),E(I?Math.max(0,Math.min(1,P)):P))}function z(P){return function(rt){var ot,at,dt;return arguments.length?([ot,at,dt]=rt,E=NN(P,[ot,at,dt]),R):[E(0),E(.5),E(1)]}}return R.domain=function(P){return arguments.length?([d,g,b]=P,t=s(d=+d),e=s(g=+g),n=s(b=+b),r=t===e?0:.5/(e-t),a=e===n?0:.5/(n-e),_=e<t?-1:1,R):[d,g,b]},R.clamp=function(P){return arguments.length?(I=!!P,R):I},R.interpolator=function(P){return arguments.length?(E=P,R):E},R.range=z(yp),R.rangeRound=z(lo),R.unknown=function(P){return arguments.length?(h=P,R):h},function(P){return s=P,t=P(d),e=P(g),n=P(b),r=t===e?0:.5/(e-t),a=e===n?0:.5/(n-e),_=e<t?-1:1,R}}function ae(){var t=xN(Mt());return t.copy=function(){return V0(t,ae()).exponent(t.exponent())},W0.apply(t,arguments)}function me(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function Ie(t,e){var n=CA(+t,+e);return function(r){var a=n(r);return a-360*Math.floor(a/360)}}(function(t){Sc=function(e){var n=e.dateTime,r=e.date,a=e.time,s=e.periods,h=e.days,d=e.shortDays,g=e.months,b=e.shortMonths,_=H4(s),E=Y4(s),I=H4(h),R=Y4(h),z=H4(d),P=Y4(d),rt=H4(g),ot=Y4(g),at=H4(b),dt=Y4(b),ct={a:function(jt){return d[jt.getDay()]},A:function(jt){return h[jt.getDay()]},b:function(jt){return b[jt.getMonth()]},B:function(jt){return g[jt.getMonth()]},c:null,d:uj,e:uj,f:unt,g:$p,G:xC,H:cmt,I:hmt,j:dmt,L:snt,m:lnt,M:lj,p:function(jt){return s[+(jt.getHours()>=12)]},q:function(jt){return 1+~~(jt.getMonth()/3)},Q:pj,s:Snt,S:cnt,u:cj,U:wC,V:fmt,w:pmt,W:hnt,x:null,X:null,y:dnt,Y:fnt,Z:pnt,"%":AN},Ct={a:function(jt){return d[jt.getUTCDay()]},A:function(jt){return h[jt.getUTCDay()]},b:function(jt){return b[jt.getUTCMonth()]},B:function(jt){return g[jt.getUTCMonth()]},c:null,d:EN,e:EN,f:mnt,g:bmt,G:wmt,H:mmt,I:gmt,j:TN,L:hj,m:ymt,M:vmt,p:function(jt){return s[+(jt.getUTCHours()>=12)]},q:function(jt){return 1+~~(jt.getUTCMonth()/3)},Q:pj,s:Snt,S:dj,u:gnt,U:ynt,V:vnt,w:bnt,W:wnt,x:null,X:null,y:xnt,Y:knt,Z:xmt,"%":AN},Et={a:function(jt,Ht,Vt){var fe=z.exec(Ht.slice(Vt));return fe?(jt.w=P.get(fe[0].toLowerCase()),Vt+fe[0].length):-1},A:function(jt,Ht,Vt){var fe=I.exec(Ht.slice(Vt));return fe?(jt.w=R.get(fe[0].toLowerCase()),Vt+fe[0].length):-1},b:function(jt,Ht,Vt){var fe=at.exec(Ht.slice(Vt));return fe?(jt.m=dt.get(fe[0].toLowerCase()),Vt+fe[0].length):-1},B:function(jt,Ht,Vt){var fe=rt.exec(Ht.slice(Vt));return fe?(jt.m=ot.get(fe[0].toLowerCase()),Vt+fe[0].length):-1},c:function(jt,Ht,Vt){return Wt(jt,n,Ht,Vt)},d:oj,e:oj,f:smt,g:bC,G:aj,H:sj,I:sj,j:CN,L:omt,m:amt,M:int,p:function(jt,Ht,Vt){var fe=_.exec(Ht.slice(Vt));return fe?(jt.p=E.get(fe[0].toLowerCase()),Vt+fe[0].length):-1},q:rnt,Q:lmt,s:ont,S:ant,u:imt,U:SN,V:_N,w:tnt,W:ent,x:function(jt,Ht,Vt){return Wt(jt,r,Ht,Vt)},X:function(jt,Ht,Vt){return Wt(jt,a,Ht,Vt)},y:bC,Y:aj,Z:nnt,"%":umt};function Rt(jt,Ht){return function(Vt){var fe,se,he,_e=[],Ve=-1,gn=0,$n=jt.length;for(Vt instanceof Date||(Vt=new Date(+Vt));++Ve<$n;)jt.charCodeAt(Ve)===37&&(_e.push(jt.slice(gn,Ve)),(se=nh[fe=jt.charAt(++Ve)])!=null?fe=jt.charAt(++Ve):se=fe==="e"?" ":"0",(he=Ht[fe])&&(fe=he(Vt,se)),_e.push(fe),gn=Ve+1);return _e.push(jt.slice(gn,Ve)),_e.join("")}}function Ot(jt,Ht){return function(Vt){var fe,se,he=Op(1900,void 0,1);if(Wt(he,jt,Vt+="",0)!=Vt.length)return null;if("Q"in he)return new Date(he.Q);if("s"in he)return new Date(1e3*he.s+("L"in he?he.L:0));if(Ht&&!("Z"in he)&&(he.Z=0),"p"in he&&(he.H=he.H%12+12*he.p),he.m===void 0&&(he.m="q"in he?he.q:0),"V"in he){if(he.V<1||he.V>53)return null;"w"in he||(he.w=1),"Z"in he?(se=(fe=Jd(Op(he.y,0,1))).getUTCDay(),fe=se>4||se===0?Ka.ceil(fe):Ka(fe),fe=Wu.offset(fe,7*(he.V-1)),he.y=fe.getUTCFullYear(),he.m=fe.getUTCMonth(),he.d=fe.getUTCDate()+(he.w+6)%7):(se=(fe=kc(Op(he.y,0,1))).getDay(),fe=se>4||se===0?Ll.ceil(fe):Ll(fe),fe=bl.offset(fe,7*(he.V-1)),he.y=fe.getFullYear(),he.m=fe.getMonth(),he.d=fe.getDate()+(he.w+6)%7)}else("W"in he||"U"in he)&&("w"in he||(he.w="u"in he?he.u%7:"W"in he?1:0),se="Z"in he?Jd(Op(he.y,0,1)).getUTCDay():kc(Op(he.y,0,1)).getDay(),he.m=0,he.d="W"in he?(he.w+6)%7+7*he.W-(se+5)%7:he.w+7*he.U-(se+6)%7);return"Z"in he?(he.H+=he.Z/100|0,he.M+=he.Z%100,Jd(he)):kc(he)}}function Wt(jt,Ht,Vt,fe){for(var se,he,_e=0,Ve=Ht.length,gn=Vt.length;_e<Ve;){if(fe>=gn)return-1;if((se=Ht.charCodeAt(_e++))===37){if(se=Ht.charAt(_e++),!(he=Et[se in nh?Ht.charAt(_e++):se])||(fe=he(jt,Vt,fe))<0)return-1}else if(se!=Vt.charCodeAt(fe++))return-1}return fe}return ct.x=Rt(r,ct),ct.X=Rt(a,ct),ct.c=Rt(n,ct),Ct.x=Rt(r,Ct),Ct.X=Rt(a,Ct),Ct.c=Rt(n,Ct),{format:function(jt){var Ht=Rt(jt+="",ct);return Ht.toString=function(){return jt},Ht},parse:function(jt){var Ht=Ot(jt+="",!1);return Ht.toString=function(){return jt},Ht},utcFormat:function(jt){var Ht=Rt(jt+="",Ct);return Ht.toString=function(){return jt},Ht},utcParse:function(jt){var Ht=Ot(jt+="",!0);return Ht.toString=function(){return jt},Ht}}}(t),ru=Sc.format,fy=Sc.utcFormat})({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var on,Je=180/Math.PI,ln={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ln(t,e,n,r,a,s){var h,d,g;return(h=Math.sqrt(t*t+e*e))&&(t/=h,e/=h),(g=t*n+e*r)&&(n-=t*g,r-=e*g),(d=Math.sqrt(n*n+r*r))&&(n/=d,r/=d,g/=d),t*r<e*n&&(t=-t,e=-e,g=-g,h=-h),{translateX:a,translateY:s,rotate:Math.atan2(e,t)*Je,skewX:Math.atan(g)*Je,scaleX:h,scaleY:d}}function vr(t,e,n,r){function a(s){return s.length?s.pop()+" ":""}return function(s,h){var d=[],g=[];return s=t(s),h=t(h),function(b,_,E,I,R,z){if(b!==E||_!==I){var P=R.push("translate(",null,e,null,n);z.push({i:P-4,x:C0(b,E)},{i:P-2,x:C0(_,I)})}else(E||I)&&R.push("translate("+E+e+I+n)}(s.translateX,s.translateY,h.translateX,h.translateY,d,g),function(b,_,E,I){b!==_?(b-_>180?_+=360:_-b>180&&(b+=360),I.push({i:E.push(a(E)+"rotate(",null,r)-2,x:C0(b,_)})):_&&E.push(a(E)+"rotate("+_+r)}(s.rotate,h.rotate,d,g),function(b,_,E,I){b!==_?I.push({i:E.push(a(E)+"skewX(",null,r)-2,x:C0(b,_)}):_&&E.push(a(E)+"skewX("+_+r)}(s.skewX,h.skewX,d,g),function(b,_,E,I,R,z){if(b!==E||_!==I){var P=R.push(a(R)+"scale(",null,",",null,")");z.push({i:P-4,x:C0(b,E)},{i:P-2,x:C0(_,I)})}else E===1&&I===1||R.push(a(R)+"scale("+E+","+I+")")}(s.scaleX,s.scaleY,h.scaleX,h.scaleY,d,g),s=h=null,function(b){for(var _,E=-1,I=g.length;++E<I;)d[(_=g[E]).i]=_.x(b);return d.join("")}}}var Br=vr(function(t){let e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ln:Ln(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),xi=vr(function(t){return t==null?ln:(on||(on=document.createElementNS("http://www.w3.org/2000/svg","g")),on.setAttribute("transform",t),(t=on.transform.baseVal.consolidate())?Ln((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):ln)},", ",")",")");function ya(t){return((t=Math.exp(t))+1/t)/2}let Ja=function t(e,n,r){function a(s,h){var d,g,b=s[0],_=s[1],E=s[2],I=h[0],R=h[1],z=h[2],P=I-b,rt=R-_,ot=P*P+rt*rt;if(ot<1e-12)g=Math.log(z/E)/e,d=function(Rt){return[b+Rt*P,_+Rt*rt,E*Math.exp(e*Rt*g)]};else{var at=Math.sqrt(ot),dt=(z*z-E*E+r*ot)/(2*E*n*at),ct=(z*z-E*E-r*ot)/(2*z*n*at),Ct=Math.log(Math.sqrt(dt*dt+1)-dt),Et=Math.log(Math.sqrt(ct*ct+1)-ct);g=(Et-Ct)/e,d=function(Rt){var Ot=Rt*g,Wt=ya(Ct),jt=E/(n*at)*(Wt*function(Ht){return((Ht=Math.exp(2*Ht))-1)/(Ht+1)}(e*Ot+Ct)-function(Ht){return((Ht=Math.exp(Ht))-1/Ht)/2}(Ct));return[b+jt*P,_+jt*rt,E*Wt/ya(e*Ot+Ct)]}}return d.duration=1e3*g*e/Math.SQRT2,d}return a.rho=function(s){var h=Math.max(.001,+s),d=h*h;return t(h,d,d*d)},a}(Math.SQRT2,2,4);function _o(t){return function(e,n){var r=t((e=b_(e)).h,(n=b_(n)).h),a=Ql(e.s,n.s),s=Ql(e.l,n.l),h=Ql(e.opacity,n.opacity);return function(d){return e.h=r(d),e.s=a(d),e.l=s(d),e.opacity=h(d),e+""}}}let $a=_o(CA);var Di=_o(Ql);let Vs=Math.PI/180,po=180/Math.PI,Gs=.96422,If=1,cd=.82521,Uo=4/29,rh=6/29,b1=.12841854934601665,u3=.008856451679035631;function yj(t){if(t instanceof Nf)return new Nf(t.l,t.a,t.b,t.opacity);if(t instanceof l3)return Wkt(t);t instanceof mc||(t=_x(t));var e,n,r=Emt(t.r),a=Emt(t.g),s=Emt(t.b),h=kC((.2225045*r+.7168786*a+.0606169*s)/If);return r===a&&a===s?e=n=h:(e=kC((.4360747*r+.3850649*a+.1430804*s)/Gs),n=kC((.0139322*r+.0971045*a+.7141733*s)/cd)),new Nf(116*h-16,500*(e-h),200*(h-n),t.opacity)}function w1(t,e,n,r){return arguments.length===1?yj(t):new Nf(t,e,n,r??1)}function Nf(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function kC(t){return t>u3?Math.pow(t,.3333333333333333):t/b1+Uo}function _mt(t){return t>rh?t*t*t:b1*(t-Uo)}function Cmt(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,.4166666666666667)-.055)}function Emt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function vPt(t){if(t instanceof l3)return new l3(t.h,t.c,t.l,t.opacity);if(t instanceof Nf||(t=yj(t)),t.a===0&&t.b===0)return new l3(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*po;return new l3(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function _nt(t,e,n,r){return arguments.length===1?vPt(t):new l3(t,e,n,r??1)}function l3(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Wkt(t){if(isNaN(t.h))return new Nf(t.l,0,0,t.opacity);var e=t.h*Vs;return new Nf(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function bPt(t,e){var n=Ql((t=w1(t)).l,(e=w1(e)).l),r=Ql(t.a,e.a),a=Ql(t.b,e.b),s=Ql(t.opacity,e.opacity);return function(h){return t.l=n(h),t.a=r(h),t.b=a(h),t.opacity=s(h),t+""}}function Vkt(t){return function(e,n){var r=t((e=_nt(e)).h,(n=_nt(n)).h),a=Ql(e.c,n.c),s=Ql(e.l,n.l),h=Ql(e.opacity,n.opacity);return function(d){return e.h=r(d),e.c=a(d),e.l=s(d),e.opacity=h(d),e+""}}}Bu(Nf,w1,Xg(Kg,{brighter:function(t){return new Nf(this.l+18*(t??1),this.a,this.b,this.opacity)},darker:function(t){return new Nf(this.l-18*(t??1),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new mc(Cmt(3.1338561*(e=Gs*_mt(e))-1.6168667*(t=If*_mt(t))-.4906146*(n=cd*_mt(n))),Cmt(-.9787684*e+1.9161415*t+.033454*n),Cmt(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Bu(l3,_nt,Xg(Kg,{brighter:function(t){return new l3(this.h,this.c,this.l+18*(t??1),this.opacity)},darker:function(t){return new l3(this.h,this.c,this.l-18*(t??1),this.opacity)},rgb:function(){return Wkt(this).rgb()}}));let wPt=Vkt(CA);var xPt=Vkt(Ql),kPt=-.14861,SPt=1.78277,Gkt=-.29227,Hkt=-.90649,Tmt=1.97294,_Pt=-1.7884503806,CPt=3.5172982438,EPt=-.6557636667999999;function Amt(t,e,n,r){return arguments.length===1?function(a){if(a instanceof SC)return new SC(a.h,a.s,a.l,a.opacity);a instanceof mc||(a=_x(a));var s=a.r/255,h=a.g/255,d=a.b/255,g=(EPt*d+_Pt*s-CPt*h)/-5.9615122912,b=d-g,_=(Tmt*(h-g)-Gkt*b)/Hkt,E=Math.sqrt(_*_+b*b)/(Tmt*g*(1-g)),I=E?Math.atan2(_,b)*po-120:NaN;return new SC(I<0?I+360:I,E,g,a.opacity)}(t):new SC(t,e,n,r??1)}function SC(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Ykt(t){return function e(n){function r(a,s){var h=t((a=Amt(a)).h,(s=Amt(s)).h),d=Ql(a.s,s.s),g=Ql(a.l,s.l),b=Ql(a.opacity,s.opacity);return function(_){return a.h=h(_),a.s=d(_),a.l=g(Math.pow(_,n)),a.opacity=b(_),a+""}}return n=+n,r.gamma=e,r}(1)}Bu(SC,Amt,Xg(Kg,{brighter:function(t){return t=t==null?kx:Math.pow(kx,t),new SC(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?xx:Math.pow(xx,t),new SC(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Vs,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),a=Math.sin(t);return new mc(255*(e+n*(kPt*r+SPt*a)),255*(e+n*(Gkt*r+Hkt*a)),255*(e+n*(Tmt*r)),this.opacity)}}));let TPt=Ykt(CA);var APt=Ykt(Ql);function IPt(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}["year","quarter","month","week","date","day","dayofyear","hours","minutes","seconds","milliseconds"].reduce((t,e,n)=>(t[e]=1+n,t),{}),tl.every(3),Kh.every(3);let Imt="linear",MN="log",Nmt="pow",Mmt="sqrt",Dmt="symlog",NPt="time",MPt="utc",DN="sequential",vj="diverging",qkt="quantile",DPt="quantize",RPt="threshold",Mh="continuous",Cnt="discrete",Ent="discretizing",x1="interpolating",Xkt="temporal";function Rmt(){let t=dN().unknown(void 0),e=t.domain,n=t.range,r,a,s=[0,1],h=!1,d=0,g=0,b=.5;function _(){let E=e().length,I=s[1]<s[0],R=s[1-I],z=function(ot,at,dt){let ct=ot-at+2*dt;return ot?ct>0?ct:1:0}(E,d,g),P=s[I-0];r=(R-P)/(z||1),h&&(r=Math.floor(r)),P+=(R-P-r*(E-d))*b,a=r*(1-d),h&&(P=Math.round(P),a=Math.round(a));let rt=wf(E).map(ot=>P+r*ot);return n(I?rt.reverse():rt)}return delete t.unknown,t.domain=function(E){return arguments.length?(e(E),_()):e()},t.range=function(E){return arguments.length?(s=[+E[0],+E[1]],_()):s.slice()},t.rangeRound=function(E){return s=[+E[0],+E[1]],h=!0,_()},t.bandwidth=function(){return a},t.step=function(){return r},t.round=function(E){return arguments.length?(h=!!E,_()):h},t.padding=function(E){return arguments.length?(g=Math.max(0,Math.min(1,E)),d=g,_()):d},t.paddingInner=function(E){return arguments.length?(d=Math.max(0,Math.min(1,E)),_()):d},t.paddingOuter=function(E){return arguments.length?(g=Math.max(0,Math.min(1,E)),_()):g},t.align=function(E){return arguments.length?(b=Math.max(0,Math.min(1,E)),_()):b},t.invertRange=function(E){if(E[0]==null||E[1]==null)return;let I=s[1]<s[0],R=I?n().reverse():n(),z=R.length-1,P,rt,ot,at=+E[0],dt=+E[1];return at!=at||dt!=dt||(dt<at&&(ot=at,at=dt,dt=ot),dt<R[0]||at>s[1-I])?void 0:(P=Math.max(0,h6(R,at)-1),rt=at===dt?P:h6(R,dt)-1,at-R[P]>a+1e-10&&++P,I&&(ot=P,P=z-rt,rt=z-ot),P>rt?void 0:e().slice(P,rt+1))},t.invert=function(E){let I=t.invertRange([E,E]);return I&&I[0]},t.copy=function(){return Rmt().domain(e()).range(s).round(h).paddingInner(d).paddingOuter(g).align(b)},_()}function Kkt(t){let e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return Kkt(e())},t}var FPt=Array.prototype.map;let OPt=Array.prototype.slice,Fmt={};function gu(t,e,n){return arguments.length>1?(Fmt[t]=function(r,a,s){let h=function(){let d=a();return d.invertRange||(d.invertRange=d.invert?function(g){return function(b){let _,E=b[0],I=b[1];return I<E&&(_=E,E=I,I=_),[g.invert(E),g.invert(I)]}}(d):d.invertExtent?function(g){return function(b){let _=g.range(),E,I,R,z,P=b[0],rt=b[1],ot=-1;for(rt<P&&(I=P,P=rt,rt=I),R=0,z=_.length;R<z;++R)_[R]>=P&&_[R]<=rt&&(ot<0&&(ot=R),E=R);if(!(ot<0))return P=g.invertExtent(_[ot]),rt=g.invertExtent(_[E]),[P[0]===void 0?P[1]:P[0],rt[1]===void 0?rt[0]:rt[1]]}}(d):void 0),d.type=r,d};return h.metadata=function(d){let g={},b=d.length;for(let _=0;_<b;++_)g[d[_]]=!0;return g}(Oet(s)),h}(t,e,n),this):function(r){return $et(Fmt,r)}(t)?Fmt[t]:void 0}gu("identity",function t(e){var n;function r(a){return a==null||isNaN(a=+a)?n:a}return r.invert=r,r.domain=r.range=function(a){return arguments.length?(e=Array.from(a,mN),r):e.slice()},r.unknown=function(a){return arguments.length?(n=a,r):n},r.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,mN):[0,1],o3(r)}),gu(Imt,function t(){var e=Get();return e.copy=function(){return vC(e,t())},U0.apply(e,arguments),o3(e)},Mh),gu(MN,function t(){var e=wN(vN()).domain([1,10]);return e.copy=function(){return vC(e,t()).base(e.base())},U0.apply(e,arguments),e},[Mh,MN]),gu(Nmt,kN,Mh),gu(Mmt,function(){return kN.apply(null,arguments).exponent(.5)},Mh),gu(Dmt,function t(){var e=i(vN());return e.copy=function(){return vC(e,t()).constant(e.constant())},U0.apply(e,arguments)},Mh),gu(NPt,function(){return U0.apply(IN(Dr,Ni,be,re,Ut,Nt,ht,nt,G,ru).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},[Mh,Xkt]),gu(MPt,function(){return U0.apply(IN(Tr,Ar,Nn,Fn,Rn,sn,cn,ze,G,fy).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},[Mh,Xkt]),gu(DN,mj,[Mh,x1]),gu("".concat(DN,"-").concat(Imt),mj,[Mh,x1]),gu("".concat(DN,"-").concat(MN),function t(){var e=wN(q4()).domain([1,10]);return e.copy=function(){return V0(e,t()).base(e.base())},W0.apply(e,arguments)},[Mh,x1,MN]),gu("".concat(DN,"-").concat(Nmt),gj,[Mh,x1]),gu("".concat(DN,"-").concat(Mmt),function(){return gj.apply(null,arguments).exponent(.5)},[Mh,x1]),gu("".concat(DN,"-").concat(Dmt),function t(){var e=i(q4());return e.copy=function(){return V0(e,t()).constant(e.constant())},W0.apply(e,arguments)},[Mh,x1]),gu("".concat(vj,"-").concat(Imt),function t(){var e=o3(Mt()(Kd));return e.copy=function(){return V0(e,t())},W0.apply(e,arguments)},[Mh,x1]),gu("".concat(vj,"-").concat(MN),function t(){var e=wN(Mt()).domain([.1,1,10]);return e.copy=function(){return V0(e,t()).base(e.base())},W0.apply(e,arguments)},[Mh,x1,MN]),gu("".concat(vj,"-").concat(Nmt),ae,[Mh,x1]),gu("".concat(vj,"-").concat(Mmt),function(){return ae.apply(null,arguments).exponent(.5)},[Mh,x1]),gu("".concat(vj,"-").concat(Dmt),function t(){var e=i(Mt());return e.copy=function(){return V0(e,t()).constant(e.constant())},W0.apply(e,arguments)},[Mh,x1]),gu(qkt,function t(){var e,n=[],r=[],a=[];function s(){var d=0,g=Math.max(1,r.length);for(a=new Array(g-1);++d<g;)a[d-1]=ZR(n,d/g);return h}function h(d){return d==null||isNaN(d=+d)?e:r[Lm(a,d)]}return h.invertExtent=function(d){var g=r.indexOf(d);return g<0?[NaN,NaN]:[g>0?a[g-1]:n[0],g<a.length?a[g]:n[n.length-1]]},h.domain=function(d){if(!arguments.length)return n.slice();n=[];for(let g of d)g==null||isNaN(g=+g)||n.push(g);return n.sort(y2),s()},h.range=function(d){return arguments.length?(r=Array.from(d),s()):r.slice()},h.unknown=function(d){return arguments.length?(e=d,h):e},h.quantiles=function(){return a.slice()},h.copy=function(){return t().domain(n).range(r).unknown(e)},U0.apply(h,arguments)},[Ent,qkt]),gu(DPt,function t(){var e,n=0,r=1,a=1,s=[.5],h=[0,1];function d(b){return b!=null&&b<=b?h[Lm(s,b,0,a)]:e}function g(){var b=-1;for(s=new Array(a);++b<a;)s[b]=((b+1)*r-(b-a)*n)/(a+1);return d}return d.domain=function(b){return arguments.length?([n,r]=b,n=+n,r=+r,g()):[n,r]},d.range=function(b){return arguments.length?(a=(h=Array.from(b)).length-1,g()):h.slice()},d.invertExtent=function(b){var _=h.indexOf(b);return _<0?[NaN,NaN]:_<1?[n,s[0]]:_>=a?[s[a-1],r]:[s[_-1],s[_]]},d.unknown=function(b){return arguments.length&&(e=b),d},d.thresholds=function(){return s.slice()},d.copy=function(){return t().domain([n,r]).range(h).unknown(e)},U0.apply(o3(d),arguments)},Ent),gu(RPt,function t(){var e,n=[.5],r=[0,1],a=1;function s(h){return h!=null&&h<=h?r[Lm(n,h,0,a)]:e}return s.domain=function(h){return arguments.length?(n=Array.from(h),a=Math.min(n.length,r.length-1),s):n.slice()},s.range=function(h){return arguments.length?(r=Array.from(h),a=Math.min(n.length,r.length-1),s):r.slice()},s.invertExtent=function(h){var d=r.indexOf(h);return[n[d-1],n[d]]},s.unknown=function(h){return arguments.length?(e=h,s):e},s.copy=function(){return t().domain(n).range(r).unknown(e)},U0.apply(s,arguments)},Ent),gu("bin-ordinal",function t(){let e=[],n=[];function r(a){return a==null||a!=a?void 0:n[(Lm(e,a)-1)%n.length]}return r.domain=function(a){return arguments.length?(e=function(s){return FPt.call(s,Fet)}(a),r):e.slice()},r.range=function(a){return arguments.length?(n=OPt.call(a),r):n.slice()},r.tickFormat=function(a,s){return Wet(e[0],gC(e),a??10,s)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r},[Cnt,Ent]),gu("ordinal",dN,Cnt),gu("band",Rmt,Cnt),gu("point",function(){return Kkt(Rmt().paddingInner(1))},Cnt);function LPt(t,e){let n=e[0],r=gC(e)-n;return function(a){return t(n+a*r)}}function Zkt(t,e,n){return NN(Qkt(e||"rgb",n),t)}function $Pt(t,e){let n=new Array(e),r=e+1;for(let a=0;a<e;)n[a]=t(++a/r);return n}function Qkt(t,e){let n=wt[function(r){return"interpolate"+r.toLowerCase().split("-").map(a=>a[0].toUpperCase()+a.slice(1)).join("")}(t)];return e!=null&&n&&n.gamma?n.gamma(e):n}function Jkt(t){let e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function t5t(t,e){for(let n in t)n5t(n,e(t[n]))}let e5t={};function n5t(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(e5t[t]=e,this):e5t[t]}t5t({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},Jkt),t5t({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},t=>Zkt(Jkt(t)));let bj=t=>t;function Tnt(t,e){t&&i5t.hasOwnProperty(t.type)&&i5t[t.type](t,e)}var r5t={Feature:function(t,e){Tnt(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,a=n.length;++r<a;)Tnt(n[r].geometry,e)}},i5t={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){Omt(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)Omt(n[r],e,0)},Polygon:function(t,e){a5t(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)a5t(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,a=n.length;++r<a;)Tnt(n[r],e)}};function Omt(t,e,n){var r,a=-1,s=t.length-n;for(e.lineStart();++a<s;)r=t[a],e.point(r[0],r[1],r[2]);e.lineEnd()}function a5t(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)Omt(t[n],e,1);e.polygonEnd()}function c3(t,e){t&&r5t.hasOwnProperty(t.type)?r5t[t.type](t,e):Tnt(t,e)}class Mf{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){let n=this._partials,r=0;for(let a=0;a<this._n&&a<32;a++){let s=n[a],h=e+s,d=Math.abs(e)<Math.abs(s)?e-(h-s):s-(h-e);d&&(n[r++]=d),e=h}return n[r]=e,this._n=r+1,this}valueOf(){let e=this._partials,n,r,a,s=this._n,h=0;if(s>0){for(h=e[--s];s>0&&(n=h,r=e[--s],h=n+r,a=r-(h-n),!a););s>0&&(a<0&&e[s-1]<0||a>0&&e[s-1]>0)&&(r=2*a,n=h+r,r==n-h&&(h=n))}return h}}function hd(){}var o5t,s5t,Lmt,$mt,zmt=new Mf,Pmt=new Mf,X4={point:hd,lineStart:hd,lineEnd:hd,polygonStart:function(){X4.lineStart=zPt,X4.lineEnd=BPt},polygonEnd:function(){X4.lineStart=X4.lineEnd=X4.point=hd,zmt.add(No(Pmt)),Pmt=new Mf},result:function(){var t=zmt/2;return zmt=new Mf,t}};function zPt(){X4.point=PPt}function PPt(t,e){X4.point=u5t,o5t=Lmt=t,s5t=$mt=e}function u5t(t,e){Pmt.add($mt*t-Lmt*e),Lmt=t,$mt=e}function BPt(){u5t(o5t,s5t)}let l5t=X4;var RN=1/0,Ant=RN,wj=-RN,Int=wj,jPt={point:function(t,e){t<RN&&(RN=t),t>wj&&(wj=t),e<Ant&&(Ant=e),e>Int&&(Int=e)},lineStart:hd,lineEnd:hd,polygonStart:hd,polygonEnd:hd,result:function(){var t=[[RN,Ant],[wj,Int]];return wj=Int=-(Ant=RN=1/0),t}};let Nnt=jPt;var c5t,h5t,py,my,Bmt=0,jmt=0,xj=0,Mnt=0,Dnt=0,FN=0,Umt=0,Wmt=0,kj=0,k1={point:_C,lineStart:d5t,lineEnd:f5t,polygonStart:function(){k1.lineStart=VPt,k1.lineEnd=GPt},polygonEnd:function(){k1.point=_C,k1.lineStart=d5t,k1.lineEnd=f5t},result:function(){var t=kj?[Umt/kj,Wmt/kj]:FN?[Mnt/FN,Dnt/FN]:xj?[Bmt/xj,jmt/xj]:[NaN,NaN];return Bmt=jmt=xj=Mnt=Dnt=FN=Umt=Wmt=kj=0,t}};function _C(t,e){Bmt+=t,jmt+=e,++xj}function d5t(){k1.point=UPt}function UPt(t,e){k1.point=WPt,_C(py=t,my=e)}function WPt(t,e){var n=t-py,r=e-my,a=id(n*n+r*r);Mnt+=a*(py+t)/2,Dnt+=a*(my+e)/2,FN+=a,_C(py=t,my=e)}function f5t(){k1.point=_C}function VPt(){k1.point=HPt}function GPt(){p5t(c5t,h5t)}function HPt(t,e){k1.point=p5t,_C(c5t=py=t,h5t=my=e)}function p5t(t,e){var n=t-py,r=e-my,a=id(n*n+r*r);Mnt+=a*(py+t)/2,Dnt+=a*(my+e)/2,FN+=a,Umt+=(a=my*t-py*e)*(py+t),Wmt+=a*(my+e),kj+=3*a,_C(py=t,my=e)}let m5t=k1;function g5t(t){this._context=t}g5t.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,rd)}},result:hd};var Vmt,y5t,v5t,Sj,_j,Gmt=new Mf,Rnt={point:hd,lineStart:function(){Rnt.point=YPt},lineEnd:function(){Vmt&&b5t(y5t,v5t),Rnt.point=hd},polygonStart:function(){Vmt=!0},polygonEnd:function(){Vmt=null},result:function(){var t=+Gmt;return Gmt=new Mf,t}};function YPt(t,e){Rnt.point=b5t,y5t=Sj=t,v5t=_j=e}function b5t(t,e){Sj-=t,_j-=e,Gmt.add(id(Sj*Sj+_j*_j)),Sj=t,_j=e}let w5t=Rnt;function x5t(){this._string=[]}function k5t(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function S5t(t,e){var n,r,a=4.5;function s(h){return h&&(typeof a=="function"&&r.pointRadius(+a.apply(this,arguments)),c3(h,n(r))),r.result()}return s.area=function(h){return c3(h,n(l5t)),l5t.result()},s.measure=function(h){return c3(h,n(w5t)),w5t.result()},s.bounds=function(h){return c3(h,n(Nnt)),Nnt.result()},s.centroid=function(h){return c3(h,n(m5t)),m5t.result()},s.projection=function(h){return arguments.length?(n=h==null?(t=null,bj):(t=h).stream,s):t},s.context=function(h){return arguments.length?(r=h==null?(e=null,new x5t):new g5t(e=h),typeof a!="function"&&r.pointRadius(a),s):e},s.pointRadius=function(h){return arguments.length?(a=typeof h=="function"?h:(r.pointRadius(+h),+h),s):a},s.projection(t).context(e)}function _5t(){var t,e=[];return{point:function(n,r,a){t.push([n,r,a])},lineStart:function(){e.push(t=[])},lineEnd:hd,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Fnt(t,e){return No(t[0]-e[0])<ba&&No(t[1]-e[1])<ba}function Ont(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function C5t(t,e,n,r,a){var s,h,d=[],g=[];if(t.forEach(function(z){if(!((P=z.length-1)<=0)){var P,rt,ot=z[0],at=z[P];if(Fnt(ot,at)){if(!ot[2]&&!at[2]){for(a.lineStart(),s=0;s<P;++s)a.point((ot=z[s])[0],ot[1]);return void a.lineEnd()}at[0]+=2*ba}d.push(rt=new Ont(ot,z,null,!0)),g.push(rt.o=new Ont(ot,null,rt,!1)),d.push(rt=new Ont(at,z,null,!1)),g.push(rt.o=new Ont(at,null,rt,!0))}}),d.length){for(g.sort(e),E5t(d),E5t(g),s=0,h=g.length;s<h;++s)g[s].e=n=!n;for(var b,_,E=d[0];;){for(var I=E,R=!0;I.v;)if((I=I.n)===E)return;b=I.z,a.lineStart();do{if(I.v=I.o.v=!0,I.e){if(R)for(s=0,h=b.length;s<h;++s)a.point((_=b[s])[0],_[1]);else r(I.x,I.n.x,1,a);I=I.n}else{if(R)for(b=I.p.z,s=b.length-1;s>=0;--s)a.point((_=b[s])[0],_[1]);else r(I.x,I.p.x,-1,a);I=I.p}b=(I=I.o).z,R=!R}while(!I.v);a.lineEnd()}}}function E5t(t){if(e=t.length){for(var e,n,r=0,a=t[0];++r<e;)a.n=n=t[r],n.p=a,a=n;a.n=n=t[0],n.p=a}}function Lnt(t){return[Sp(t[1],t[0]),Wd(t[2])]}function CC(t){var e=t[0],n=t[1],r=ga(n);return[r*ga(e),r*ia(e),ia(n)]}function $nt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ON(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Hmt(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function znt(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Pnt(t){var e=id(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Ymt(t){return No(t[0])<=co?t[0]:_p(t[0])*((No(t[0])+co)%rd-co)}function T5t(t){return Array.from(function*(e){for(let n of e)yield*OM(n)}(t))}function A5t(t,e,n,r){return function(a){var s,h,d,g=e(a),b=_5t(),_=e(b),E=!1,I={point:R,lineStart:P,lineEnd:rt,polygonStart:function(){I.point=ot,I.lineStart=at,I.lineEnd=dt,h=[],s=[]},polygonEnd:function(){I.point=R,I.lineStart=P,I.lineEnd=rt,h=T5t(h);var ct=function(Ct,Et){var Rt=Ymt(Et),Ot=Et[1],Wt=ia(Ot),jt=[ia(Rt),-ga(Rt),0],Ht=0,Vt=0,fe=new Mf;Wt===1?Ot=al+ba:Wt===-1&&(Ot=-al-ba);for(var se=0,he=Ct.length;se<he;++se)if(Ve=(_e=Ct[se]).length)for(var _e,Ve,gn=_e[Ve-1],$n=Ymt(gn),Gn=gn[1]/2+yI,qe=ia(Gn),tr=ga(Gn),er=0;er<Ve;++er,$n=dn,qe=Qn,tr=wr,gn=An){var An=_e[er],dn=Ymt(An),nr=An[1]/2+yI,Qn=ia(nr),wr=ga(nr),yi=dn-$n,ha=yi>=0?1:-1,mi=ha*yi,si=mi>co,Ei=qe*Qn;if(fe.add(Sp(Ei*ha*ia(mi),tr*wr+Ei*ga(mi))),Ht+=si?yi+ha*rd:yi,si^$n>=Rt^dn>=Rt){var ki=ON(CC(gn),CC(An));Pnt(ki);var Xi=ON(jt,ki);Pnt(Xi);var Fi=(si^yi>=0?-1:1)*Wd(Xi[2]);(Ot>Fi||Ot===Fi&&(ki[0]||ki[1]))&&(Vt+=si^yi>=0?1:-1)}}return(Ht<-1e-6||Ht<ba&&fe<-1e-12)^1&Vt}(s,r);h.length?(E||(a.polygonStart(),E=!0),C5t(h,XPt,ct,n,a)):ct&&(E||(a.polygonStart(),E=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),E&&(a.polygonEnd(),E=!1),h=s=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function R(ct,Ct){t(ct,Ct)&&a.point(ct,Ct)}function z(ct,Ct){g.point(ct,Ct)}function P(){I.point=z,g.lineStart()}function rt(){I.point=R,g.lineEnd()}function ot(ct,Ct){d.push([ct,Ct]),_.point(ct,Ct)}function at(){_.lineStart(),d=[]}function dt(){ot(d[0][0],d[0][1]),_.lineEnd();var ct,Ct,Et,Rt,Ot=_.clean(),Wt=b.result(),jt=Wt.length;if(d.pop(),s.push(d),d=null,jt)if(1&Ot){if((Ct=(Et=Wt[0]).length-1)>0){for(E||(a.polygonStart(),E=!0),a.lineStart(),ct=0;ct<Ct;++ct)a.point((Rt=Et[ct])[0],Rt[1]);a.lineEnd()}}else jt>1&&2&Ot&&Wt.push(Wt.pop().concat(Wt.shift())),h.push(Wt.filter(qPt))}return I}}function qPt(t){return t.length>1}function XPt(t,e){return((t=t.x)[0]<0?t[1]-al-ba:al-t[1])-((e=e.x)[0]<0?e[1]-al-ba:al-e[1])}x5t.prototype={_radius:4.5,_circle:k5t(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:this._circle==null&&(this._circle=k5t(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};let I5t=A5t(function(){return!0},function(t){var e,n=NaN,r=NaN,a=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(s,h){var d=s>0?co:-co,g=No(s-n);No(g-co)<ba?(t.point(n,r=(r+h)/2>0?al:-al),t.point(a,r),t.lineEnd(),t.lineStart(),t.point(d,r),t.point(s,r),e=0):a!==d&&g>=co&&(No(n-a)<ba&&(n-=a*ba),No(s-d)<ba&&(s-=d*ba),r=function(b,_,E,I){var R,z,P=ia(b-E);return No(P)>ba?$x((ia(_)*(z=ga(I))*ia(E)-ia(I)*(R=ga(_))*ia(b))/(R*z*P)):(_+I)/2}(n,r,s,h),t.point(a,r),t.lineEnd(),t.lineStart(),t.point(d,r),e=0),t.point(n=s,r=h),a=d},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}},function(t,e,n,r){var a;if(t==null)a=n*al,r.point(-co,a),r.point(0,a),r.point(co,a),r.point(co,0),r.point(co,-a),r.point(0,-a),r.point(-co,-a),r.point(-co,0),r.point(-co,a);else if(No(t[0]-e[0])>ba){var s=t[0]<e[0]?co:-co;a=n*s/2,r.point(-s,a),r.point(0,a),r.point(s,a)}else r.point(e[0],e[1])},[-co,-al]);function KPt(t,e,n,r,a,s){if(n){var h=ga(e),d=ia(e),g=r*n;a==null?(a=e+r*rd,s=e-g/2):(a=N5t(h,a),s=N5t(h,s),(r>0?a<s:a>s)&&(a+=r*rd));for(var b,_=a;r>0?_>s:_<s;_-=g)b=Lnt([h,-d*ga(_),-d*ia(_)]),t.point(b[0],b[1])}}function N5t(t,e){(e=CC(e))[0]-=t,Pnt(e);var n=BZ(-e[1]);return((-e[2]<0?-n:n)+rd-ba)%rd}var Bnt=1e9,jnt=-1e9;function M5t(t,e,n,r){function a(b,_){return t<=b&&b<=n&&e<=_&&_<=r}function s(b,_,E,I){var R=0,z=0;if(b==null||(R=h(b,E))!==(z=h(_,E))||g(b,_)<0^E>0)do I.point(R===0||R===3?t:n,R>1?r:e);while((R=(R+E+4)%4)!==z);else I.point(_[0],_[1])}function h(b,_){return No(b[0]-t)<ba?_>0?0:3:No(b[0]-n)<ba?_>0?2:1:No(b[1]-e)<ba?_>0?1:0:_>0?3:2}function d(b,_){return g(b.x,_.x)}function g(b,_){var E=h(b,1),I=h(_,1);return E!==I?E-I:E===0?_[1]-b[1]:E===1?b[0]-_[0]:E===2?b[1]-_[1]:_[0]-b[0]}return function(b){var _,E,I,R,z,P,rt,ot,at,dt,ct,Ct=b,Et=_5t(),Rt={point:Ot,lineStart:function(){Rt.point=Wt,E&&E.push(I=[]),dt=!0,at=!1,rt=ot=NaN},lineEnd:function(){_&&(Wt(R,z),P&&at&&Et.rejoin(),_.push(Et.result())),Rt.point=Ot,at&&Ct.lineEnd()},polygonStart:function(){Ct=Et,_=[],E=[],ct=!0},polygonEnd:function(){var jt=function(){for(var fe=0,se=0,he=E.length;se<he;++se)for(var _e,Ve,gn=E[se],$n=1,Gn=gn.length,qe=gn[0],tr=qe[0],er=qe[1];$n<Gn;++$n)_e=tr,Ve=er,tr=(qe=gn[$n])[0],er=qe[1],Ve<=r?er>r&&(tr-_e)*(r-Ve)>(er-Ve)*(t-_e)&&++fe:er<=r&&(tr-_e)*(r-Ve)<(er-Ve)*(t-_e)&&--fe;return fe}(),Ht=ct&&jt,Vt=(_=T5t(_)).length;(Ht||Vt)&&(b.polygonStart(),Ht&&(b.lineStart(),s(null,null,1,b),b.lineEnd()),Vt&&C5t(_,d,jt,s,b),b.polygonEnd()),Ct=b,_=E=I=null}};function Ot(jt,Ht){a(jt,Ht)&&Ct.point(jt,Ht)}function Wt(jt,Ht){var Vt=a(jt,Ht);if(E&&I.push([jt,Ht]),dt)R=jt,z=Ht,P=Vt,dt=!1,Vt&&(Ct.lineStart(),Ct.point(jt,Ht));else if(Vt&&at)Ct.point(jt,Ht);else{var fe=[rt=Math.max(jnt,Math.min(Bnt,rt)),ot=Math.max(jnt,Math.min(Bnt,ot))],se=[jt=Math.max(jnt,Math.min(Bnt,jt)),Ht=Math.max(jnt,Math.min(Bnt,Ht))];(function(he,_e,Ve,gn,$n,Gn){var qe,tr=he[0],er=he[1],An=0,dn=1,nr=_e[0]-tr,Qn=_e[1]-er;if(qe=Ve-tr,nr||!(qe>0)){if(qe/=nr,nr<0){if(qe<An)return;qe<dn&&(dn=qe)}else if(nr>0){if(qe>dn)return;qe>An&&(An=qe)}if(qe=$n-tr,nr||!(qe<0)){if(qe/=nr,nr<0){if(qe>dn)return;qe>An&&(An=qe)}else if(nr>0){if(qe<An)return;qe<dn&&(dn=qe)}if(qe=gn-er,Qn||!(qe>0)){if(qe/=Qn,Qn<0){if(qe<An)return;qe<dn&&(dn=qe)}else if(Qn>0){if(qe>dn)return;qe>An&&(An=qe)}if(qe=Gn-er,Qn||!(qe<0)){if(qe/=Qn,Qn<0){if(qe>dn)return;qe>An&&(An=qe)}else if(Qn>0){if(qe<An)return;qe<dn&&(dn=qe)}return An>0&&(he[0]=tr+An*nr,he[1]=er+An*Qn),dn<1&&(_e[0]=tr+dn*nr,_e[1]=er+dn*Qn),!0}}}}})(fe,se,t,e,n,r)?(at||(Ct.lineStart(),Ct.point(fe[0],fe[1])),Ct.point(se[0],se[1]),Vt||Ct.lineEnd(),ct=!1):Vt&&(Ct.lineStart(),Ct.point(jt,Ht),ct=!1)}rt=jt,ot=Ht,at=Vt}return Rt}}function qmt(t,e){function n(r,a){return r=t(r,a),e(r[0],r[1])}return t.invert&&e.invert&&(n.invert=function(r,a){return(r=e.invert(r,a))&&t.invert(r[0],r[1])}),n}function Xmt(t,e){return[No(t)>co?t+Math.round(-t/rd)*rd:t,e]}function D5t(t,e,n){return(t%=rd)?e||n?qmt(F5t(t),O5t(e,n)):F5t(t):e||n?O5t(e,n):Xmt}function R5t(t){return function(e,n){return[(e+=t)>co?e-rd:e<-co?e+rd:e,n]}}function F5t(t){var e=R5t(t);return e.invert=R5t(-t),e}function O5t(t,e){var n=ga(t),r=ia(t),a=ga(e),s=ia(e);function h(d,g){var b=ga(g),_=ga(d)*b,E=ia(d)*b,I=ia(g),R=I*n+_*r;return[Sp(E*a-R*s,_*n-I*r),Wd(R*a+E*s)]}return h.invert=function(d,g){var b=ga(g),_=ga(d)*b,E=ia(d)*b,I=ia(g),R=I*a-E*s;return[Sp(E*a+I*s,_*n+R*r),Wd(R*n-_*r)]},h}function Unt(t){return function(e){var n=new Kmt;for(var r in t)n[r]=t[r];return n.stream=e,n}}function Kmt(){}function Zmt(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),r!=null&&t.clipExtent(null),c3(n,t.stream(Nnt)),e(Nnt.result()),r!=null&&t.clipExtent(r),t}function Wnt(t,e,n){return Zmt(t,function(r){var a=e[1][0]-e[0][0],s=e[1][1]-e[0][1],h=Math.min(a/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),d=+e[0][0]+(a-h*(r[1][0]+r[0][0]))/2,g=+e[0][1]+(s-h*(r[1][1]+r[0][1]))/2;t.scale(150*h).translate([d,g])},n)}function Qmt(t,e,n){return Wnt(t,[[0,0],e],n)}function Jmt(t,e,n){return Zmt(t,function(r){var a=+e,s=a/(r[1][0]-r[0][0]),h=(a-s*(r[1][0]+r[0][0]))/2,d=-s*r[0][1];t.scale(150*s).translate([h,d])},n)}function tgt(t,e,n){return Zmt(t,function(r){var a=+e,s=a/(r[1][1]-r[0][1]),h=-s*r[0][0],d=(a-s*(r[1][1]+r[0][1]))/2;t.scale(150*s).translate([h,d])},n)}Xmt.invert=Xmt,Kmt.prototype={constructor:Kmt,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var ZPt=ga(30*ho);function L5t(t,e){return+e?function(n,r){function a(s,h,d,g,b,_,E,I,R,z,P,rt,ot,at){var dt=E-s,ct=I-h,Ct=dt*dt+ct*ct;if(Ct>4*r&&ot--){var Et=g+z,Rt=b+P,Ot=_+rt,Wt=id(Et*Et+Rt*Rt+Ot*Ot),jt=Wd(Ot/=Wt),Ht=No(No(Ot)-1)<ba||No(d-R)<ba?(d+R)/2:Sp(Rt,Et),Vt=n(Ht,jt),fe=Vt[0],se=Vt[1],he=fe-s,_e=se-h,Ve=ct*he-dt*_e;(Ve*Ve/Ct>r||No((dt*he+ct*_e)/Ct-.5)>.3||g*z+b*P+_*rt<ZPt)&&(a(s,h,d,g,b,_,fe,se,Ht,Et/=Wt,Rt/=Wt,Ot,ot,at),at.point(fe,se),a(fe,se,Ht,Et,Rt,Ot,E,I,R,z,P,rt,ot,at))}}return function(s){var h,d,g,b,_,E,I,R,z,P,rt,ot,at={point:dt,lineStart:ct,lineEnd:Et,polygonStart:function(){s.polygonStart(),at.lineStart=Rt},polygonEnd:function(){s.polygonEnd(),at.lineStart=ct}};function dt(jt,Ht){jt=n(jt,Ht),s.point(jt[0],jt[1])}function ct(){R=NaN,at.point=Ct,s.lineStart()}function Ct(jt,Ht){var Vt=CC([jt,Ht]),fe=n(jt,Ht);a(R,z,I,P,rt,ot,R=fe[0],z=fe[1],I=jt,P=Vt[0],rt=Vt[1],ot=Vt[2],16,s),s.point(R,z)}function Et(){at.point=dt,s.lineEnd()}function Rt(){ct(),at.point=Ot,at.lineEnd=Wt}function Ot(jt,Ht){Ct(h=jt,Ht),d=R,g=z,b=P,_=rt,E=ot,at.point=Ct}function Wt(){a(R,z,I,P,rt,ot,d,g,h,b,_,E,16,s),at.lineEnd=Et,Et()}return at}}(t,e):function(n){return Unt({point:function(r,a){r=n(r,a),this.stream.point(r[0],r[1])}})}(t)}var QPt=Unt({point:function(t,e){this.stream.point(t*ho,e*ho)}});function $5t(t,e,n,r,a,s){if(!s)return function(P,rt,ot,at,dt){function ct(Ct,Et){return[rt+P*(Ct*=at),ot-P*(Et*=dt)]}return ct.invert=function(Ct,Et){return[(Ct-rt)/P*at,(ot-Et)/P*dt]},ct}(t,e,n,r,a);var h=ga(s),d=ia(s),g=h*t,b=d*t,_=h/t,E=d/t,I=(d*n-h*e)/t,R=(d*e+h*n)/t;function z(P,rt){return[g*(P*=r)-b*(rt*=a)+e,n-b*P-g*rt]}return z.invert=function(P,rt){return[r*(_*P-E*rt+I),a*(R-E*P-_*rt)]},z}function gy(t){return z5t(function(){return t})()}function z5t(t){var e,n,r,a,s,h,d,g,b,_,E=150,I=480,R=250,z=0,P=0,rt=0,ot=0,at=0,dt=0,ct=1,Ct=1,Et=null,Rt=I5t,Ot=null,Wt=bj,jt=.5;function Ht(he){return g(he[0]*ho,he[1]*ho)}function Vt(he){return(he=g.invert(he[0],he[1]))&&[he[0]*yl,he[1]*yl]}function fe(){var he=$5t(E,0,0,ct,Ct,dt).apply(null,e(z,P)),_e=$5t(E,I-he[0],R-he[1],ct,Ct,dt);return n=D5t(rt,ot,at),d=qmt(e,_e),g=qmt(n,d),h=L5t(d,jt),se()}function se(){return b=_=null,Ht}return Ht.stream=function(he){return b&&_===he?b:b=QPt(function(_e){return Unt({point:function(Ve,gn){var $n=_e(Ve,gn);return this.stream.point($n[0],$n[1])}})}(n)(Rt(h(Wt(_=he)))))},Ht.preclip=function(he){return arguments.length?(Rt=he,Et=void 0,se()):Rt},Ht.postclip=function(he){return arguments.length?(Wt=he,Ot=r=a=s=null,se()):Wt},Ht.clipAngle=function(he){return arguments.length?(Rt=+he?function(_e){var Ve=ga(_e),gn=6*ho,$n=Ve>0,Gn=No(Ve)>ba;function qe(An,dn){return ga(An)*ga(dn)>Ve}function tr(An,dn,nr){var Qn=[1,0,0],wr=ON(CC(An),CC(dn)),yi=$nt(wr,wr),ha=wr[0],mi=yi-ha*ha;if(!mi)return!nr&&An;var si=Ve*yi/mi,Ei=-Ve*ha/mi,ki=ON(Qn,wr),Xi=znt(Qn,si);Hmt(Xi,znt(wr,Ei));var Fi=ki,Go=$nt(Xi,Fi),gd=$nt(Fi,Fi),Uh=Go*Go-gd*($nt(Xi,Xi)-1);if(!(Uh<0)){var rc=id(Uh),Do=znt(Fi,(-Go-rc)/gd);if(Hmt(Do,Xi),Do=Lnt(Do),!nr)return Do;var us,Io=An[0],ou=dn[0],uh=An[1],Ac=dn[1];ou<Io&&(us=Io,Io=ou,ou=us);var Zp=ou-Io,G1=No(Zp-co)<ba;if(!G1&&Ac<uh&&(us=uh,uh=Ac,Ac=us),G1||Zp<ba?G1?uh+Ac>0^Do[1]<(No(Do[0]-Io)<ba?uh:Ac):uh<=Do[1]&&Do[1]<=Ac:Zp>co^(Io<=Do[0]&&Do[0]<=ou)){var W3=znt(Fi,(-Go+rc)/gd);return Hmt(W3,Xi),[Do,Lnt(W3)]}}}function er(An,dn){var nr=$n?_e:co-_e,Qn=0;return An<-nr?Qn|=1:An>nr&&(Qn|=2),dn<-nr?Qn|=4:dn>nr&&(Qn|=8),Qn}return A5t(qe,function(An){var dn,nr,Qn,wr,yi;return{lineStart:function(){wr=Qn=!1,yi=1},point:function(ha,mi){var si,Ei=[ha,mi],ki=qe(ha,mi),Xi=$n?ki?0:er(ha,mi):ki?er(ha+(ha<0?co:-co),mi):0;if(!dn&&(wr=Qn=ki)&&An.lineStart(),ki!==Qn&&(!(si=tr(dn,Ei))||Fnt(dn,si)||Fnt(Ei,si))&&(Ei[2]=1),ki!==Qn)yi=0,ki?(An.lineStart(),si=tr(Ei,dn),An.point(si[0],si[1])):(si=tr(dn,Ei),An.point(si[0],si[1],2),An.lineEnd()),dn=si;else if(Gn&&dn&&$n^ki){var Fi;Xi&nr||!(Fi=tr(Ei,dn,!0))||(yi=0,$n?(An.lineStart(),An.point(Fi[0][0],Fi[0][1]),An.point(Fi[1][0],Fi[1][1]),An.lineEnd()):(An.point(Fi[1][0],Fi[1][1]),An.lineEnd(),An.lineStart(),An.point(Fi[0][0],Fi[0][1],3)))}!ki||dn&&Fnt(dn,Ei)||An.point(Ei[0],Ei[1]),dn=Ei,Qn=ki,nr=Xi},lineEnd:function(){Qn&&An.lineEnd(),dn=null},clean:function(){return yi|(wr&&Qn)<<1}}},function(An,dn,nr,Qn){KPt(Qn,_e,gn,nr,An,dn)},$n?[0,-_e]:[-co,_e-co])}(Et=he*ho):(Et=null,I5t),se()):Et*yl},Ht.clipExtent=function(he){return arguments.length?(Wt=he==null?(Ot=r=a=s=null,bj):M5t(Ot=+he[0][0],r=+he[0][1],a=+he[1][0],s=+he[1][1]),se()):Ot==null?null:[[Ot,r],[a,s]]},Ht.scale=function(he){return arguments.length?(E=+he,fe()):E},Ht.translate=function(he){return arguments.length?(I=+he[0],R=+he[1],fe()):[I,R]},Ht.center=function(he){return arguments.length?(z=he[0]%360*ho,P=he[1]%360*ho,fe()):[z*yl,P*yl]},Ht.rotate=function(he){return arguments.length?(rt=he[0]%360*ho,ot=he[1]%360*ho,at=he.length>2?he[2]%360*ho:0,fe()):[rt*yl,ot*yl,at*yl]},Ht.angle=function(he){return arguments.length?(dt=he%360*ho,fe()):dt*yl},Ht.reflectX=function(he){return arguments.length?(ct=he?-1:1,fe()):ct<0},Ht.reflectY=function(he){return arguments.length?(Ct=he?-1:1,fe()):Ct<0},Ht.precision=function(he){return arguments.length?(h=L5t(d,jt=he*he),se()):id(jt)},Ht.fitExtent=function(he,_e){return Wnt(Ht,he,_e)},Ht.fitSize=function(he,_e){return Qmt(Ht,he,_e)},Ht.fitWidth=function(he,_e){return Jmt(Ht,he,_e)},Ht.fitHeight=function(he,_e){return tgt(Ht,he,_e)},function(){return e=t.apply(this,arguments),Ht.invert=e.invert&&Vt,fe()}}function egt(t){var e=0,n=co/3,r=z5t(t),a=r(e,n);return a.parallels=function(s){return arguments.length?r(e=s[0]*ho,n=s[1]*ho):[e*yl,n*yl]},a}function JPt(t,e){var n=ia(t),r=(n+ia(e))/2;if(No(r)<ba)return function(d){var g=ga(d);function b(_,E){return[_*g,ia(E)/g]}return b.invert=function(_,E){return[_/g,Wd(E*g)]},b}(t);var a=1+n*(2*r-n),s=id(a)/r;function h(d,g){var b=id(a-2*r*ia(g))/r;return[b*ia(d*=r),s-b*ga(d)]}return h.invert=function(d,g){var b=s-g,_=Sp(d,No(b))*_p(b);return b*r<0&&(_-=co*_p(d)*_p(b)),[_/r,Wd((a-(d*d+b*b)*r*r)/(2*r))]},h}function Vnt(){return egt(JPt).scale(155.424).center([0,33.6442])}function P5t(){return Vnt().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function B5t(t){return function(e,n){var r=ga(e),a=ga(n),s=t(r*a);return s===1/0?[2,0]:[s*a*ia(e),s*ia(n)]}}function Cj(t){return function(e,n){var r=id(e*e+n*n),a=t(r),s=ia(a),h=ga(a);return[Sp(e*s,r*h),Wd(r&&n*s/r)]}}var j5t=B5t(function(t){return id(2/(1+t))});j5t.invert=Cj(function(t){return 2*Wd(t/2)});var U5t=B5t(function(t){return(t=BZ(t))&&t/ia(t)});function Gnt(t,e){return[t,vI(tz((al+e)/2))]}function W5t(t){var e,n,r,a=gy(t),s=a.center,h=a.scale,d=a.translate,g=a.clipExtent,b=null;function _(){var E=co*h(),I=a(function(R){function z(P){return(P=R(P[0]*ho,P[1]*ho))[0]*=yl,P[1]*=yl,P}return R=D5t(R[0]*ho,R[1]*ho,R.length>2?R[2]*ho:0),z.invert=function(P){return(P=R.invert(P[0]*ho,P[1]*ho))[0]*=yl,P[1]*=yl,P},z}(a.rotate()).invert([0,0]));return g(b==null?[[I[0]-E,I[1]-E],[I[0]+E,I[1]+E]]:t===Gnt?[[Math.max(I[0]-E,b),e],[Math.min(I[0]+E,n),r]]:[[b,Math.max(I[1]-E,e)],[n,Math.min(I[1]+E,r)]])}return a.scale=function(E){return arguments.length?(h(E),_()):h()},a.translate=function(E){return arguments.length?(d(E),_()):d()},a.center=function(E){return arguments.length?(s(E),_()):s()},a.clipExtent=function(E){return arguments.length?(E==null?b=e=n=r=null:(b=+E[0][0],e=+E[0][1],n=+E[1][0],r=+E[1][1]),_()):b==null?null:[[b,e],[n,r]]},_()}function Hnt(t){return tz((al+t)/2)}function tBt(t,e){var n=ga(t),r=t===e?ia(t):vI(n/ga(e))/vI(Hnt(e)/Hnt(t)),a=n*n1(Hnt(t),r)/r;if(!r)return Gnt;function s(h,d){a>0?d<-al+ba&&(d=-al+ba):d>al-ba&&(d=al-ba);var g=a/n1(Hnt(d),r);return[g*ia(r*h),a-g*ga(r*h)]}return s.invert=function(h,d){var g=a-d,b=_p(r)*id(h*h+g*g),_=Sp(h,No(g))*_p(g);return g*r<0&&(_-=co*_p(h)*_p(g)),[_/r,2*$x(n1(a/b,1/r))-al]},s}function Ynt(t,e){return[t,e]}function eBt(t,e){var n=ga(t),r=t===e?ia(t):(n-ga(e))/(e-t),a=n/r+t;if(No(r)<ba)return Ynt;function s(h,d){var g=a-d,b=r*h;return[g*ia(b),a-g*ga(b)]}return s.invert=function(h,d){var g=a-d,b=Sp(h,No(g))*_p(g);return g*r<0&&(b-=co*_p(h)*_p(g)),[b/r,a-_p(r)*id(h*h+g*g)]},s}U5t.invert=Cj(function(t){return t}),Gnt.invert=function(t,e){return[t,2*$x(PZ(e))-al]},Ynt.invert=Ynt;var Ej=1.340264,Tj=-.081106,Aj=893e-6,V5t=.003796,qnt=id(3)/2;function G5t(t,e){var n=Wd(qnt*ia(e)),r=n*n,a=r*r*r;return[t*ga(n)/(qnt*(Ej+3*Tj*r+a*(7*Aj+.034164*r))),n*(Ej+Tj*r+a*(Aj+V5t*r))]}function H5t(t,e){var n=ga(e),r=ga(t)*n;return[n*ia(t)/r,ia(e)/r]}function Y5t(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function q5t(t,e){return[ga(e)*ia(t),ia(e)]}function X5t(t,e){var n=ga(e),r=1+ga(t)*n;return[n*ia(t)/r,ia(e)/r]}function K5t(t,e){return[vI(tz((al+e)/2)),-t]}G5t.invert=function(t,e){for(var n,r=e,a=r*r,s=a*a*a,h=0;h<12&&(s=(a=(r-=n=(r*(Ej+Tj*a+s*(Aj+V5t*a))-e)/(Ej+3*Tj*a+s*(7*Aj+.034164*a)))*r)*a*a,!(No(n)<Q$));++h);return[qnt*t*(Ej+3*Tj*a+s*(7*Aj+.034164*a))/ga(r),Wd(ia(r)/qnt)]},H5t.invert=Cj($x),Y5t.invert=function(t,e){var n,r=e,a=25;do{var s=r*r,h=s*s;r-=n=(r*(1.007226+s*(.015085+h*(.028874*s-.044475-.005916*h)))-e)/(1.007226+s*(.045255+h*(.259866*s-.311325-.06507600000000001*h)))}while(No(n)>ba&&--a>0);return[t/(.8707+(s=r*r)*(s*(s*s*s*(.003971-.001529*s)-.013791)-.131979)),r]},q5t.invert=Cj(Wd),X5t.invert=Cj(function(t){return 2*$x(t)}),K5t.invert=function(t,e){return[-e,2*$x(PZ(t))-al]};var nBt=Math.abs,ngt=Math.cos,Xnt=Math.sin,Z5t=Math.PI,rgt=Z5t/2,Q5t=rBt(2);function J5t(t){return t>1?rgt:t<-1?-rgt:Math.asin(t)}function rBt(t){return t>0?Math.sqrt(t):0}function iBt(t,e){var n,r=t*Xnt(e),a=30;do e-=n=(e+Xnt(e)-r)/(1+ngt(e));while(nBt(n)>1e-6&&--a>0);return e/2}var aBt=function(t,e,n){function r(a,s){return[t*a*ngt(s=iBt(n,s)),e*Xnt(s)]}return r.invert=function(a,s){return s=J5t(s/e),[a/(t*ngt(s)),J5t((2*s+Xnt(2*s))/n)]},r}(Q5t/rgt,Q5t,Z5t);S5t();let oBt=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function tSt(t,e){if(!t||typeof t!="string")throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(Knt[t]=function(n,r){return function a(){let s=r();return s.type=n,s.path=S5t().projection(s),s.copy=s.copy||function(){let h=a();return oBt.forEach(d=>{s[d]&&h[d](s[d]())}),h.path.pointRadius(s.path.pointRadius()),h},s}}(t,e),this):Knt[t]||null}let Knt={albers:P5t,albersusa:function(){var t,e,n,r,a,s,h=P5t(),d=Vnt().rotate([154,0]).center([-2,58.5]).parallels([55,65]),g=Vnt().rotate([157,0]).center([-3,19.9]).parallels([8,18]),b={point:function(I,R){s=[I,R]}};function _(I){var R=I[0],z=I[1];return s=null,n.point(R,z),s||(r.point(R,z),s)||(a.point(R,z),s)}function E(){return t=e=null,_}return _.invert=function(I){var R=h.scale(),z=h.translate(),P=(I[0]-z[0])/R,rt=(I[1]-z[1])/R;return(rt>=.12&&rt<.234&&P>=-.425&&P<-.214?d:rt>=.166&&rt<.234&&P>=-.214&&P<-.115?g:h).invert(I)},_.stream=function(I){return t&&e===I?t:t=function(R){var z=R.length;return{point:function(P,rt){for(var ot=-1;++ot<z;)R[ot].point(P,rt)},sphere:function(){for(var P=-1;++P<z;)R[P].sphere()},lineStart:function(){for(var P=-1;++P<z;)R[P].lineStart()},lineEnd:function(){for(var P=-1;++P<z;)R[P].lineEnd()},polygonStart:function(){for(var P=-1;++P<z;)R[P].polygonStart()},polygonEnd:function(){for(var P=-1;++P<z;)R[P].polygonEnd()}}}([h.stream(e=I),d.stream(I),g.stream(I)])},_.precision=function(I){return arguments.length?(h.precision(I),d.precision(I),g.precision(I),E()):h.precision()},_.scale=function(I){return arguments.length?(h.scale(I),d.scale(.35*I),g.scale(I),_.translate(h.translate())):h.scale()},_.translate=function(I){if(!arguments.length)return h.translate();var R=h.scale(),z=+I[0],P=+I[1];return n=h.translate(I).clipExtent([[z-.455*R,P-.238*R],[z+.455*R,P+.238*R]]).stream(b),r=d.translate([z-.307*R,P+.201*R]).clipExtent([[z-.425*R+ba,P+.12*R+ba],[z-.214*R-ba,P+.234*R-ba]]).stream(b),a=g.translate([z-.205*R,P+.212*R]).clipExtent([[z-.214*R+ba,P+.166*R+ba],[z-.115*R-ba,P+.234*R-ba]]).stream(b),E()},_.fitExtent=function(I,R){return Wnt(_,I,R)},_.fitSize=function(I,R){return Qmt(_,I,R)},_.fitWidth=function(I,R){return Jmt(_,I,R)},_.fitHeight=function(I,R){return tgt(_,I,R)},_.scale(1070)},azimuthalequalarea:function(){return gy(j5t).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return gy(U5t).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return egt(tBt).scale(109.5).parallels([30,30])},conicequalarea:Vnt,conicequidistant:function(){return egt(eBt).scale(131.154).center([0,13.9389])},equalEarth:function(){return gy(G5t).scale(177.158)},equirectangular:function(){return gy(Ynt).scale(152.63)},gnomonic:function(){return gy(H5t).scale(144.049).clipAngle(60)},identity:function(){var t,e,n,r,a,s,h,d=1,g=0,b=0,_=1,E=1,I=0,R=null,z=1,P=1,rt=Unt({point:function(ct,Ct){var Et=dt([ct,Ct]);this.stream.point(Et[0],Et[1])}}),ot=bj;function at(){return z=d*_,P=d*E,s=h=null,dt}function dt(ct){var Ct=ct[0]*z,Et=ct[1]*P;if(I){var Rt=Et*t-Ct*e;Ct=Ct*t+Et*e,Et=Rt}return[Ct+g,Et+b]}return dt.invert=function(ct){var Ct=ct[0]-g,Et=ct[1]-b;if(I){var Rt=Et*t+Ct*e;Ct=Ct*t-Et*e,Et=Rt}return[Ct/z,Et/P]},dt.stream=function(ct){return s&&h===ct?s:s=rt(ot(h=ct))},dt.postclip=function(ct){return arguments.length?(ot=ct,R=n=r=a=null,at()):ot},dt.clipExtent=function(ct){return arguments.length?(ot=ct==null?(R=n=r=a=null,bj):M5t(R=+ct[0][0],n=+ct[0][1],r=+ct[1][0],a=+ct[1][1]),at()):R==null?null:[[R,n],[r,a]]},dt.scale=function(ct){return arguments.length?(d=+ct,at()):d},dt.translate=function(ct){return arguments.length?(g=+ct[0],b=+ct[1],at()):[g,b]},dt.angle=function(ct){return arguments.length?(e=ia(I=ct%360*ho),t=ga(I),at()):I*yl},dt.reflectX=function(ct){return arguments.length?(_=ct?-1:1,at()):_<0},dt.reflectY=function(ct){return arguments.length?(E=ct?-1:1,at()):E<0},dt.fitExtent=function(ct,Ct){return Wnt(dt,ct,Ct)},dt.fitSize=function(ct,Ct){return Qmt(dt,ct,Ct)},dt.fitWidth=function(ct,Ct){return Jmt(dt,ct,Ct)},dt.fitHeight=function(ct,Ct){return tgt(dt,ct,Ct)},dt},mercator:function(){return W5t(Gnt).scale(961/rd)},mollweide:function(){return gy(aBt).scale(169.529)},naturalEarth1:function(){return gy(Y5t).scale(175.295)},orthographic:function(){return gy(q5t).scale(249.5).clipAngle(90+ba)},stereographic:function(){return gy(X5t).scale(250).clipAngle(142)},transversemercator:function(){var t=W5t(K5t),e=t.center,n=t.rotate;return t.center=function(r){return arguments.length?e([-r[1],r[0]]):[(r=e())[1],-r[0]]},t.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):[(r=n())[0],r[1],r[2]-90]},n([0,0,90]).scale(159.155)}};for(let t in Knt)tSt(t,Knt[t]);let LN="Literal",sBt="Property",uBt="ArrayExpression",lBt="BinaryExpression",eSt="CallExpression",cBt="ConditionalExpression",hBt="LogicalExpression",dBt="MemberExpression",fBt="ObjectExpression",pBt="UnaryExpression";function S1(t){this.type=t}var h3,Zi,mr,tf,Hs;S1.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(a){switch(a.type){case uBt:return a.elements;case lBt:case hBt:return[a.left,a.right];case eSt:return[a.callee].concat(a.arguments);case cBt:return[a.test,a.consequent,a.alternate];case dBt:return[a.object,a.property];case fBt:return a.properties;case sBt:return[a.key,a.value];case pBt:return[a.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var Znt=1,Ij=2,EC=3,K4=4,Qnt=5,TC=6,zp=7,Nj=8;(h3={})[Znt]="Boolean",h3[Ij]="<end>",h3[EC]="Identifier",h3[K4]="Keyword",h3[Qnt]="Null",h3[TC]="Numeric",h3[zp]="Punctuator",h3[Nj]="String",h3[9]="RegularExpression";var mBt="ArrayExpression",gBt="BinaryExpression",yBt="CallExpression",vBt="ConditionalExpression",nSt="Identifier",bBt="Literal",wBt="LogicalExpression",xBt="MemberExpression",kBt="ObjectExpression",SBt="Property",_Bt="UnaryExpression",Dh="Unexpected token %0",CBt="Unexpected number",EBt="Unexpected string",TBt="Unexpected identifier",ABt="Unexpected reserved word",IBt="Unexpected end of input",rSt="Invalid regular expression",igt="Invalid regular expression: missing /",iSt="Octal literals are not allowed in strict mode.",NBt="Duplicate data property in object literal not allowed in strict mode",dd="ILLEGAL",Mj="Disabled.",MBt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),DBt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Jnt(t,e){if(!t)throw new Error("ASSERT: "+e)}function d3(t){return t>=48&&t<=57}function agt(t){return"0123456789abcdefABCDEF".includes(t)}function Dj(t){return"01234567".includes(t)}function RBt(t){return t===32||t===9||t===11||t===12||t===160||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(t)}function Rj(t){return t===10||t===13||t===8232||t===8233}function Fj(t){return t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t===92||t>=128&&MBt.test(String.fromCharCode(t))}function trt(t){return t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||t===92||t>=128&&DBt.test(String.fromCharCode(t))}let FBt={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function aSt(){for(;mr<tf;){let t=Zi.charCodeAt(mr);if(!RBt(t)&&!Rj(t))break;++mr}}function ogt(t){var e,n,r,a=0;for(n=t==="u"?4:2,e=0;e<n;++e)mr<tf&&agt(Zi[mr])?(r=Zi[mr++],a=16*a+"0123456789abcdef".indexOf(r.toLowerCase())):As({},Dh,dd);return String.fromCharCode(a)}function OBt(){var t,e,n,r;for(e=0,(t=Zi[mr])==="}"&&As({},Dh,dd);mr<tf&&agt(t=Zi[mr++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||t!=="}")&&As({},Dh,dd),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function oSt(){var t,e;for(t=Zi.charCodeAt(mr++),e=String.fromCharCode(t),t===92&&(Zi.charCodeAt(mr)!==117&&As({},Dh,dd),++mr,(t=ogt("u"))&&t!=="\\"&&Fj(t.charCodeAt(0))||As({},Dh,dd),e=t);mr<tf&&trt(t=Zi.charCodeAt(mr));)++mr,e+=String.fromCharCode(t),t===92&&(e=e.substr(0,e.length-1),Zi.charCodeAt(mr)!==117&&As({},Dh,dd),++mr,(t=ogt("u"))&&t!=="\\"&&trt(t.charCodeAt(0))||As({},Dh,dd),e+=t);return e}function LBt(){var t,e;return t=mr,e=Zi.charCodeAt(mr)===92?oSt():function(){var n,r;for(n=mr++;mr<tf;){if((r=Zi.charCodeAt(mr))===92)return mr=n,oSt();if(!trt(r))break;++mr}return Zi.slice(n,mr)}(),{type:e.length===1?EC:FBt.hasOwnProperty(e)?K4:e==="null"?Qnt:e==="true"||e==="false"?Znt:EC,value:e,start:t,end:mr}}function sgt(){var t,e,n,r,a=mr,s=Zi.charCodeAt(mr),h=Zi[mr];switch(s){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++mr,{type:zp,value:String.fromCharCode(s),start:a,end:mr};default:if((t=Zi.charCodeAt(mr+1))===61)switch(s){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return mr+=2,{type:zp,value:String.fromCharCode(s)+String.fromCharCode(t),start:a,end:mr};case 33:case 61:return mr+=2,Zi.charCodeAt(mr)===61&&++mr,{type:zp,value:Zi.slice(a,mr),start:a,end:mr}}}return(r=Zi.substr(mr,4))===">>>="?{type:zp,value:r,start:a,end:mr+=4}:(n=r.substr(0,3))===">>>"||n==="<<="||n===">>="?{type:zp,value:n,start:a,end:mr+=3}:h===(e=n.substr(0,2))[1]&&"+-<>&|".includes(h)||e==="=>"?{type:zp,value:e,start:a,end:mr+=2}:(e==="//"&&As({},Dh,dd),"<>=!+-*%&|^/".includes(h)?(++mr,{type:zp,value:h,start:a,end:mr}):void As({},Dh,dd))}function sSt(){var t,e,n;if(Jnt(d3((n=Zi[mr]).charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),e=mr,t="",n!=="."){if(t=Zi[mr++],n=Zi[mr],t==="0"){if(n==="x"||n==="X")return++mr,function(r){let a="";for(;mr<tf&&agt(Zi[mr]);)a+=Zi[mr++];return a.length===0&&As({},Dh,dd),Fj(Zi.charCodeAt(mr))&&As({},Dh,dd),{type:TC,value:parseInt("0x"+a,16),start:r,end:mr}}(e);if(Dj(n))return function(r){let a="0"+Zi[mr++];for(;mr<tf&&Dj(Zi[mr]);)a+=Zi[mr++];return(Fj(Zi.charCodeAt(mr))||d3(Zi.charCodeAt(mr)))&&As({},Dh,dd),{type:TC,value:parseInt(a,8),octal:!0,start:r,end:mr}}(e);n&&d3(n.charCodeAt(0))&&As({},Dh,dd)}for(;d3(Zi.charCodeAt(mr));)t+=Zi[mr++];n=Zi[mr]}if(n==="."){for(t+=Zi[mr++];d3(Zi.charCodeAt(mr));)t+=Zi[mr++];n=Zi[mr]}if(n==="e"||n==="E")if(t+=Zi[mr++],(n=Zi[mr])!=="+"&&n!=="-"||(t+=Zi[mr++]),d3(Zi.charCodeAt(mr)))for(;d3(Zi.charCodeAt(mr));)t+=Zi[mr++];else As({},Dh,dd);return Fj(Zi.charCodeAt(mr))&&As({},Dh,dd),{type:TC,value:parseFloat(t),start:e,end:mr}}function $Bt(){var t,e,n,r;return Hs=null,aSt(),t=mr,e=function(){var a,s,h,d;for(Jnt((a=Zi[mr])==="/","Regular expression literal must start with a slash"),s=Zi[mr++],h=!1,d=!1;mr<tf;)if(s+=a=Zi[mr++],a==="\\")Rj((a=Zi[mr++]).charCodeAt(0))&&As({},igt),s+=a;else if(Rj(a.charCodeAt(0)))As({},igt);else if(h)a==="]"&&(h=!1);else{if(a==="/"){d=!0;break}a==="["&&(h=!0)}return d||As({},igt),{value:s.substr(1,s.length-2),literal:s}}(),n=function(){var a,s,h;for(s="",h="";mr<tf&&trt((a=Zi[mr]).charCodeAt(0));)++mr,a==="\\"&&mr<tf?As({},Dh,dd):(h+=a,s+=a);return h.search(/[^gimuy]/g)>=0&&As({},rSt,h),{value:h,literal:s}}(),r=function(a,s){let h=a;s.includes("u")&&(h=h.replace(/\\u\{([0-9a-fA-F]+)\}/g,(d,g)=>{if(parseInt(g,16)<=1114111)return"x";As({},rSt)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{return new RegExp(a,s)}catch{return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:mr}}function uSt(){if(aSt(),mr>=tf)return{type:Ij,start:mr,end:mr};let t=Zi.charCodeAt(mr);return Fj(t)?LBt():t===40||t===41||t===59?sgt():t===39||t===34?function(){var e,n,r,a,s="",h=!1;for(Jnt((e=Zi[mr])==="'"||e==='"',"String literal must starts with a quote"),n=mr,++mr;mr<tf;){if((r=Zi[mr++])===e){e="";break}if(r==="\\")if((r=Zi[mr++])&&Rj(r.charCodeAt(0)))r==="\r"&&Zi[mr]===`
`&&++mr;else switch(r){case"u":case"x":Zi[mr]==="{"?(++mr,s+=OBt()):s+=ogt(r);break;case"n":s+=`
`;break;case"r":s+="\r";break;case"t":s+="	";break;case"b":s+="\b";break;case"f":s+="\f";break;case"v":s+="\v";break;default:Dj(r)?((a="01234567".indexOf(r))!==0&&(h=!0),mr<tf&&Dj(Zi[mr])&&(h=!0,a=8*a+"01234567".indexOf(Zi[mr++]),"0123".includes(r)&&mr<tf&&Dj(Zi[mr])&&(a=8*a+"01234567".indexOf(Zi[mr++]))),s+=String.fromCharCode(a)):s+=r}else{if(Rj(r.charCodeAt(0)))break;s+=r}}return e!==""&&As({},Dh,dd),{type:Nj,value:s,octal:h,start:n,end:mr}}():t===46?d3(Zi.charCodeAt(mr+1))?sSt():sgt():d3(t)?sSt():sgt()}function Pp(){let t=Hs;return mr=t.end,Hs=uSt(),mr=t.end,t}function lSt(){let t=mr;Hs=uSt(),mr=t}function cSt(t,e,n){let r=new S1(t==="||"||t==="&&"?wBt:gBt);return r.operator=t,r.left=e,r.right=n,r}function zBt(t,e){let n=new S1(yBt);return n.callee=t,n.arguments=e,n}function ugt(t){let e=new S1(nSt);return e.name=t,e}function Oj(t){let e=new S1(bBt);return e.value=t.value,e.raw=Zi.slice(t.start,t.end),t.regex&&(e.raw==="//"&&(e.raw="/(?:)/"),e.regex=t.regex),e}function hSt(t,e,n){let r=new S1(xBt);return r.computed=t==="[",r.object=e,r.property=n,r.computed||(n.member=!0),r}function dSt(t,e,n){let r=new S1(SBt);return r.key=e,r.value=n,r.kind=t,r}function As(t,e){var n,r=Array.prototype.slice.call(arguments,2),a=e.replace(/%(\d)/g,(s,h)=>(Jnt(h<r.length,"Message reference must be in range"),r[h]));throw(n=new Error(a)).index=mr,n.description=a,n}function ert(t){t.type===Ij&&As(t,IBt),t.type===TC&&As(t,CBt),t.type===Nj&&As(t,EBt),t.type===EC&&As(t,TBt),t.type===K4&&As(t,ABt),As(t,Dh,t.value)}function ef(t){let e=Pp();e.type===zp&&e.value===t||ert(e)}function Gu(t){return Hs.type===zp&&Hs.value===t}function lgt(t){return Hs.type===K4&&Hs.value===t}function PBt(){let t=[];for(mr=Hs.start,ef("[");!Gu("]");)Gu(",")?(Pp(),t.push(null)):(t.push(AC()),Gu("]")||ef(","));return Pp(),function(e){let n=new S1(mBt);return n.elements=e,n}(t)}function fSt(){mr=Hs.start;let t=Pp();return t.type===Nj||t.type===TC?(t.octal&&As(t,iSt),Oj(t)):ugt(t.value)}function BBt(){var t,e,n;return mr=Hs.start,(t=Hs).type===EC?(n=fSt(),ef(":"),dSt("init",n,AC())):t.type!==Ij&&t.type!==zp?(e=fSt(),ef(":"),dSt("init",e,AC())):void ert(t)}function jBt(){var t,e,n=[],r={},a=String;for(mr=Hs.start,ef("{");!Gu("}");)e="$"+((t=BBt()).key.type===nSt?t.key.name:a(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?As({},NBt):r[e]=!0,n.push(t),Gu("}")||ef(",");return ef("}"),function(s){let h=new S1(kBt);return h.properties=s,h}(n)}let UBt={if:1};function WBt(){var t,e,n;if(Gu("("))return function(){ef("(");let r=cgt();return ef(")"),r}();if(Gu("["))return PBt();if(Gu("{"))return jBt();if(t=Hs.type,mr=Hs.start,t===EC||UBt[Hs.value])n=ugt(Pp().value);else if(t===Nj||t===TC)Hs.octal&&As(Hs,iSt),n=Oj(Pp());else{if(t===K4)throw new Error(Mj);t===Znt?((e=Pp()).value=e.value==="true",n=Oj(e)):t===Qnt?((e=Pp()).value=null,n=Oj(e)):Gu("/")||Gu("/=")?(n=Oj($Bt()),lSt()):ert(Pp())}return n}function VBt(){let t=[];if(ef("("),!Gu(")"))for(;mr<tf&&(t.push(AC()),!Gu(")"));)ef(",");return ef(")"),t}function GBt(){mr=Hs.start;let t=Pp();return function(e){return e.type===EC||e.type===K4||e.type===Znt||e.type===Qnt}(t)||ert(t),ugt(t.value)}function HBt(){ef("[");let t=cgt();return ef("]"),t}function pSt(){let t=function(){var e;for(e=WBt();;)if(Gu("."))ef("."),e=hSt(".",e,GBt());else if(Gu("("))e=zBt(e,VBt());else{if(!Gu("["))break;e=hSt("[",e,HBt())}return e}();if(Hs.type===zp&&(Gu("++")||Gu("--")))throw new Error(Mj);return t}function nrt(){var t,e;if(Hs.type!==zp&&Hs.type!==K4)e=pSt();else{if(Gu("++")||Gu("--"))throw new Error(Mj);if(Gu("+")||Gu("-")||Gu("~")||Gu("!"))t=Pp(),e=nrt(),e=function(n,r){let a=new S1(_Bt);return a.operator=n,a.argument=r,a.prefix=!0,a}(t.value,e);else{if(lgt("delete")||lgt("void")||lgt("typeof"))throw new Error(Mj);e=pSt()}}return e}function mSt(t){let e=0;if(t.type!==zp&&t.type!==K4)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function AC(){var t,e;return t=function(){var n,r,a,s,h,d,g,b,_,E;if(n=Hs,_=nrt(),(h=mSt(s=Hs))===0)return _;for(s.prec=h,Pp(),r=[n,Hs],d=[_,s,g=nrt()];(h=mSt(Hs))>0;){for(;d.length>2&&h<=d[d.length-2].prec;)g=d.pop(),b=d.pop().value,_=d.pop(),r.pop(),a=cSt(b,_,g),d.push(a);(s=Pp()).prec=h,d.push(s),r.push(Hs),a=nrt(),d.push(a)}for(a=d[E=d.length-1],r.pop();E>1;)r.pop(),a=cSt(d[E-1].value,d[E-2],a),E-=2;return a}(),Gu("?")&&(Pp(),e=AC(),ef(":"),t=function(n,r,a){let s=new S1(vBt);return s.test=n,s.consequent=r,s.alternate=a,s}(t,e,AC())),t}function cgt(){let t=AC();if(Gu(","))throw new Error(Mj);return t}var gSt={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function ySt(t){function e(s,h,d){return g=>function(b,_,E,I){let R=t(_[0]);return E&&(R=E+"("+R+")",E.lastIndexOf("new ",0)===0&&(R="("+R+")")),R+"."+b+(I<0?"":I===0?"()":"("+_.slice(1).map(t).join(",")+")")}(s,g,h,d)}let n="new Date",r="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(s){s.length<3&&Dn("Missing arguments to clamp function."),s.length>3&&Dn("Too many arguments to clamp function.");let h=s.map(t);return"Math.max("+h[1]+", Math.min("+h[2]+","+h[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:a,test:e("test",a),if:function(s){s.length<3&&Dn("Missing arguments to if function."),s.length>3&&Dn("Too many arguments to if function.");let h=s.map(t);return"("+h[0]+"?"+h[1]+":"+h[2]+")"}}}class Z4{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){let n=this._partials,r=0;for(let a=0;a<this._n&&a<32;a++){let s=n[a],h=e+s,d=Math.abs(e)<Math.abs(s)?e-(h-s):s-(h-e);d&&(n[r++]=d),e=h}return n[r]=e,this._n=r+1,this}valueOf(){let e=this._partials,n,r,a,s=this._n,h=0;if(s>0){for(h=e[--s];s>0&&(n=h,r=e[--s],h=n+r,a=r-(h-n),!a););s>0&&(a<0&&e[s-1]<0||a>0&&e[s-1]>0)&&(r=2*a,n=h+r,r==n-h&&(h=n))}return h}}var hgt=1e-6,Lj=Math.PI,vSt=Lj/2,bSt=Lj/4,wSt=2*Lj,$j=180/Lj,nf=Lj/180,dgt=Math.abs,rrt=Math.atan2,Df=Math.cos,fgt=Math.hypot,Rf=Math.sin,xSt=Math.sqrt;function pgt(t){return t>1?vSt:t<-1?-vSt:Math.asin(t)}function zj(){}function irt(t,e){t&&SSt.hasOwnProperty(t.type)&&SSt[t.type](t,e)}var kSt={Feature:function(t,e){irt(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,a=n.length;++r<a;)irt(n[r].geometry,e)}},SSt={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){mgt(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)mgt(n[r],e,0)},Polygon:function(t,e){_St(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)_St(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,a=n.length;++r<a;)irt(n[r],e)}};function mgt(t,e,n){var r,a=-1,s=t.length-n;for(e.lineStart();++a<s;)r=t[a],e.point(r[0],r[1],r[2]);e.lineEnd()}function _St(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)mgt(t[n],e,1);e.polygonEnd()}function ggt(t,e){t&&kSt.hasOwnProperty(t.type)?kSt[t.type](t,e):irt(t,e)}var CSt,ESt,ygt,vgt,bgt,wl,Bp,zl,G0,IC,TSt,ASt,$N,Pj,Q4,f3,art=new Z4,ort=new Z4,yy={point:zj,lineStart:zj,lineEnd:zj,polygonStart:function(){art=new Z4,yy.lineStart=YBt,yy.lineEnd=qBt},polygonEnd:function(){var t=+art;ort.add(t<0?wSt+t:t),this.lineStart=this.lineEnd=this.point=zj},sphere:function(){ort.add(wSt)}};function YBt(){yy.point=XBt}function qBt(){ISt(CSt,ESt)}function XBt(t,e){yy.point=ISt,CSt=t,ESt=e,ygt=t*=nf,vgt=Df(e=(e*=nf)/2+bSt),bgt=Rf(e)}function ISt(t,e){var n=(t*=nf)-ygt,r=n>=0?1:-1,a=r*n,s=Df(e=(e*=nf)/2+bSt),h=Rf(e),d=bgt*h,g=vgt*s+d*Df(a),b=d*r*Rf(a);art.add(rrt(b,g)),ygt=t,vgt=s,bgt=h}function NSt(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}var Bj,srt,urt,lrt,crt,hrt,drt,frt,wgt,xgt,kgt,MSt,DSt,Ff,Of,Lf,p3={point:Sgt,lineStart:FSt,lineEnd:OSt,polygonStart:function(){p3.point=LSt,p3.lineStart=KBt,p3.lineEnd=ZBt,Pj=new Z4,yy.polygonStart()},polygonEnd:function(){yy.polygonEnd(),p3.point=Sgt,p3.lineStart=FSt,p3.lineEnd=OSt,art<0?(wl=-(zl=180),Bp=-(G0=90)):Pj>hgt?G0=90:Pj<-1e-6&&(Bp=-90),f3[0]=wl,f3[1]=zl},sphere:function(){wl=-(zl=180),Bp=-(G0=90)}};function Sgt(t,e){Q4.push(f3=[wl=t,zl=t]),e<Bp&&(Bp=e),e>G0&&(G0=e)}function RSt(t,e){var n,r,a=function(I){var R=I[0],z=I[1],P=Df(z);return[P*Df(R),P*Rf(R),Rf(z)]}([t*nf,e*nf]);if($N){var s=NSt($N,a),h=NSt([s[1],-s[0],0],s);r=xSt((n=h)[0]*n[0]+n[1]*n[1]+n[2]*n[2]),n[0]/=r,n[1]/=r,n[2]/=r,h=function(I){return[rrt(I[1],I[0]),pgt(I[2])]}(h);var d,g=t-IC,b=g>0?1:-1,_=h[0]*$j*b,E=dgt(g)>180;E^(b*IC<_&&_<b*t)?(d=h[1]*$j)>G0&&(G0=d):E^(b*IC<(_=(_+360)%360-180)&&_<b*t)?(d=-h[1]*$j)<Bp&&(Bp=d):(e<Bp&&(Bp=e),e>G0&&(G0=e)),E?t<IC?H0(wl,t)>H0(wl,zl)&&(zl=t):H0(t,zl)>H0(wl,zl)&&(wl=t):zl>=wl?(t<wl&&(wl=t),t>zl&&(zl=t)):t>IC?H0(wl,t)>H0(wl,zl)&&(zl=t):H0(t,zl)>H0(wl,zl)&&(wl=t)}else Q4.push(f3=[wl=t,zl=t]);e<Bp&&(Bp=e),e>G0&&(G0=e),$N=a,IC=t}function FSt(){p3.point=RSt}function OSt(){f3[0]=wl,f3[1]=zl,p3.point=Sgt,$N=null}function LSt(t,e){if($N){var n=t-IC;Pj.add(dgt(n)>180?n+(n>0?360:-360):n)}else TSt=t,ASt=e;yy.point(t,e),RSt(t,e)}function KBt(){yy.lineStart()}function ZBt(){LSt(TSt,ASt),yy.lineEnd(),dgt(Pj)>hgt&&(wl=-(zl=180)),f3[0]=wl,f3[1]=zl,$N=null}function H0(t,e){return(e-=t)<0?e+360:e}function QBt(t,e){return t[0]-e[0]}function $St(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var _1={sphere:zj,point:_gt,lineStart:zSt,lineEnd:PSt,polygonStart:function(){_1.lineStart=ejt,_1.lineEnd=njt},polygonEnd:function(){_1.lineStart=zSt,_1.lineEnd=PSt}};function _gt(t,e){t*=nf;var n=Df(e*=nf);jj(n*Df(t),n*Rf(t),Rf(e))}function jj(t,e,n){++Bj,urt+=(t-urt)/Bj,lrt+=(e-lrt)/Bj,crt+=(n-crt)/Bj}function zSt(){_1.point=JBt}function JBt(t,e){t*=nf;var n=Df(e*=nf);Ff=n*Df(t),Of=n*Rf(t),Lf=Rf(e),_1.point=tjt,jj(Ff,Of,Lf)}function tjt(t,e){t*=nf;var n=Df(e*=nf),r=n*Df(t),a=n*Rf(t),s=Rf(e),h=rrt(xSt((h=Of*s-Lf*a)*h+(h=Lf*r-Ff*s)*h+(h=Ff*a-Of*r)*h),Ff*r+Of*a+Lf*s);srt+=h,hrt+=h*(Ff+(Ff=r)),drt+=h*(Of+(Of=a)),frt+=h*(Lf+(Lf=s)),jj(Ff,Of,Lf)}function PSt(){_1.point=_gt}function ejt(){_1.point=rjt}function njt(){BSt(MSt,DSt),_1.point=_gt}function rjt(t,e){MSt=t,DSt=e,t*=nf,e*=nf,_1.point=BSt;var n=Df(e);Ff=n*Df(t),Of=n*Rf(t),Lf=Rf(e),jj(Ff,Of,Lf)}function BSt(t,e){t*=nf;var n=Df(e*=nf),r=n*Df(t),a=n*Rf(t),s=Rf(e),h=Of*s-Lf*a,d=Lf*r-Ff*s,g=Ff*a-Of*r,b=fgt(h,d,g),_=pgt(b),E=b&&-_/b;wgt.add(E*h),xgt.add(E*d),kgt.add(E*g),srt+=_,hrt+=_*(Ff+(Ff=r)),drt+=_*(Of+(Of=a)),frt+=_*(Lf+(Lf=s)),jj(Ff,Of,Lf)}function Uj(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function prt(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function NC(){}var mrt=.7,grt=1.4285714285714286,zN="\\s*([+-]?\\d+)\\s*",Wj="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",vy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ijt=/^#([0-9a-f]{3,8})$/,ajt=new RegExp(`^rgb\\(${zN},${zN},${zN}\\)$`),ojt=new RegExp(`^rgb\\(${vy},${vy},${vy}\\)$`),sjt=new RegExp(`^rgba\\(${zN},${zN},${zN},${Wj}\\)$`),ujt=new RegExp(`^rgba\\(${vy},${vy},${vy},${Wj}\\)$`),ljt=new RegExp(`^hsl\\(${Wj},${vy},${vy}\\)$`),cjt=new RegExp(`^hsla\\(${Wj},${vy},${vy},${Wj}\\)$`),jSt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function USt(){return this.rgb().formatHex()}function WSt(){return this.rgb().formatRgb()}function Cgt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ijt.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?VSt(e):n===3?new rf(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):n===8?yrt(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):n===4?yrt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=ajt.exec(t))?new rf(e[1],e[2],e[3],1):(e=ojt.exec(t))?new rf(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=sjt.exec(t))?yrt(e[1],e[2],e[3],e[4]):(e=ujt.exec(t))?yrt(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=ljt.exec(t))?qSt(e[1],e[2]/100,e[3]/100,1):(e=cjt.exec(t))?qSt(e[1],e[2]/100,e[3]/100,e[4]):jSt.hasOwnProperty(t)?VSt(jSt[t]):t==="transparent"?new rf(NaN,NaN,NaN,0):null}function VSt(t){return new rf(t>>16&255,t>>8&255,255&t,1)}function yrt(t,e,n,r){return r<=0&&(t=e=n=NaN),new rf(t,e,n,r)}function GSt(t){return t instanceof NC||(t=Cgt(t)),t?new rf((t=t.rgb()).r,t.g,t.b,t.opacity):new rf}function Egt(t,e,n,r){return arguments.length===1?GSt(t):new rf(t,e,n,r??1)}function rf(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function HSt(){return`#${DC(this.r)}${DC(this.g)}${DC(this.b)}`}function YSt(){let t=vrt(this.opacity);return`${t===1?"rgb(":"rgba("}${MC(this.r)}, ${MC(this.g)}, ${MC(this.b)}${t===1?")":`, ${t})`}`}function vrt(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function MC(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function DC(t){return((t=MC(t))<16?"0":"")+t.toString(16)}function qSt(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new C1(t,e,n,r)}function XSt(t){if(t instanceof C1)return new C1(t.h,t.s,t.l,t.opacity);if(t instanceof NC||(t=Cgt(t)),!t)return new C1;if(t instanceof C1)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),s=Math.max(e,n,r),h=NaN,d=s-a,g=(s+a)/2;return d?(h=e===s?(n-r)/d+6*(n<r):n===s?(r-e)/d+2:(e-n)/d+4,d/=g<.5?s+a:2-s-a,h*=60):d=g>0&&g<1?0:h,new C1(h,d,g,t.opacity)}function KSt(t,e,n,r){return arguments.length===1?XSt(t):new C1(t,e,n,r??1)}function C1(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function ZSt(t){return(t=(t||0)%360)<0?t+360:t}function brt(t){return Math.max(0,Math.min(1,t||0))}function Tgt(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Uj(NC,Cgt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:USt,formatHex:USt,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return XSt(this).formatHsl()},formatRgb:WSt,toString:WSt}),Uj(rf,Egt,prt(NC,{brighter(t){return t=t==null?grt:Math.pow(grt,t),new rf(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?mrt:Math.pow(mrt,t),new rf(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new rf(MC(this.r),MC(this.g),MC(this.b),vrt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:HSt,formatHex:HSt,formatHex8:function(){return`#${DC(this.r)}${DC(this.g)}${DC(this.b)}${DC(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:YSt,toString:YSt})),Uj(C1,KSt,prt(NC,{brighter(t){return t=t==null?grt:Math.pow(grt,t),new C1(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?mrt:Math.pow(mrt,t),new C1(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,a=2*n-r;return new rf(Tgt(t>=240?t-240:t+120,a,r),Tgt(t,a,r),Tgt(t<120?t+240:t-120,a,r),this.opacity)},clamp(){return new C1(ZSt(this.h),brt(this.s),brt(this.l),vrt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=vrt(this.opacity);return`${t===1?"hsl(":"hsla("}${ZSt(this.h)}, ${100*brt(this.s)}%, ${100*brt(this.l)}%${t===1?")":`, ${t})`}`}}));let hjt=Math.PI/180,djt=180/Math.PI,QSt=.96422,JSt=.82521,t_t=4/29,fjt=6/29,e_t=.12841854934601665;function n_t(t){if(t instanceof by)return new by(t.l,t.a,t.b,t.opacity);if(t instanceof m3)return a_t(t);t instanceof rf||(t=GSt(t));var e,n,r=Mgt(t.r),a=Mgt(t.g),s=Mgt(t.b),h=Agt((.2225045*r+.7168786*a+.0606169*s)/1);return r===a&&a===s?e=n=h:(e=Agt((.4360747*r+.3850649*a+.1430804*s)/QSt),n=Agt((.0139322*r+.0971045*a+.7141733*s)/JSt)),new by(116*h-16,500*(e-h),200*(h-n),t.opacity)}function r_t(t,e,n,r){return arguments.length===1?n_t(t):new by(t,e,n,r??1)}function by(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Agt(t){return t>.008856451679035631?Math.pow(t,.3333333333333333):t/e_t+t_t}function Igt(t){return t>fjt?t*t*t:e_t*(t-t_t)}function Ngt(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,.4166666666666667)-.055)}function Mgt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function pjt(t){if(t instanceof m3)return new m3(t.h,t.c,t.l,t.opacity);if(t instanceof by||(t=n_t(t)),t.a===0&&t.b===0)return new m3(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*djt;return new m3(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function i_t(t,e,n,r){return arguments.length===1?pjt(t):new m3(t,e,n,r??1)}function m3(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function a_t(t){if(isNaN(t.h))return new by(t.l,0,0,t.opacity);var e=t.h*hjt;return new by(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function Dgt(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function mjt(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function gjt(){return 0}Uj(by,r_t,prt(NC,{brighter(t){return new by(this.l+18*(t??1),this.a,this.b,this.opacity)},darker(t){return new by(this.l-18*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new rf(Ngt(3.1338561*(e=QSt*Igt(e))-1.6168667*(t=1*Igt(t))-.4906146*(n=JSt*Igt(n))),Ngt(-.9787684*e+1.9161415*t+.033454*n),Ngt(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Uj(m3,i_t,prt(NC,{brighter(t){return new m3(this.h,this.c,this.l+18*(t??1),this.opacity)},darker(t){return new m3(this.h,this.c,this.l-18*(t??1),this.opacity)},rgb(){return a_t(this).rgb()}}));class wrt extends Set{constructor(e,n=wjt){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(let r of e)this.add(r)}has(e){return super.has(yjt(this,e))}add(e){return super.add(vjt(this,e))}delete(e){return super.delete(bjt(this,e))}}function yjt({_intern:t,_key:e},n){let r=e(n);return t.has(r)?t.get(r):n}function vjt({_intern:t,_key:e},n){let r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function bjt({_intern:t,_key:e},n){let r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function wjt(t){return t!==null&&typeof t=="object"?t.valueOf():t}function xjt(t){return t instanceof wrt?t:new wrt(t)}let o_t=Symbol("vega_selection_getter");function s_t(t){return t.getter&&t.getter[o_t]||(t.getter=sa(t.field),t.getter[o_t]=!0),t.getter}let Rgt="intersect",u_t="union",l_t="or",kjt="and",wy="_vgsid_",Vj=sa(wy),xrt="index:unit";function c_t(t,e){for(var n,r,a=e.fields,s=e.values,h=a.length,d=0;d<h;++d)if(fi(n=s_t(r=a[d])(t))&&(n=$s(n)),fi(s[d])&&(s[d]=$s(s[d])),ni(s[d])&&fi(s[d][0])&&(s[d]=s[d].map($s)),r.type==="E"){if(ni(s[d])?s[d].indexOf(n)<0:n!==s[d])return!1}else if(r.type==="R"){if(!Na(n,s[d]))return!1}else if(r.type==="R-RE"){if(!Na(n,s[d],!0,!1))return!1}else if(r.type==="R-E"){if(!Na(n,s[d],!1,!1))return!1}else if(r.type==="R-LE"&&!Na(n,s[d],!1,!0))return!1;return!0}function h_t(t,e,n){for(var r,a,s,h,d,g=this.context.data[t],b=g?g.values.value:[],_=g?g[xrt]&&g[xrt].value:void 0,E=n===Rgt,I=b.length,R=0;R<I;++R)if(r=b[R],_&&E){if((s=(a=a||{})[h=r.unit]||0)===-1)continue;if(d=c_t(e,r),a[h]=d?-1:++s,d&&_.size===1)return!0;if(!d&&s===_.get(h).count)return!1}else if(E^(d=c_t(e,r)))return d;return I&&E}let d_t=function(t){let e,n,r;function a(s,h,d=0,g=s.length){if(d<g){if(e(h,h)!==0)return g;do{let b=d+g>>>1;n(s[b],h)<0?d=b+1:g=b}while(d<g)}return d}return t.length!==2?(e=Dgt,n=(s,h)=>Dgt(t(s),h),r=(s,h)=>t(s)-h):(e=t===Dgt||t===mjt?t:gjt,n=t,r=t),{left:a,center:function(s,h,d=0,g=s.length){let b=a(s,h,d,g-1);return b>d&&r(s[b-1],h)>-r(s[b],h)?b-1:b},right:function(s,h,d=0,g=s.length){if(d<g){if(e(h,h)!==0)return g;do{let b=d+g>>>1;n(s[b],h)<=0?d=b+1:g=b}while(d<g)}return d}}}(Vj),Sjt=d_t.left,_jt=d_t.right;function f_t(t,e,n){let r=this.context.data[t],a=r?r.values.value:[],s=r?r[xrt]&&r[xrt].value:void 0,h=n===Rgt,d=Vj(e),g=Sjt(a,d);if(g===a.length||Vj(a[g])!==d)return!1;if(s&&h){if(s.size===1)return!0;if(_jt(a,d)-g<s.size)return!1}return!0}function p_t(t,e){return t.map(n=>nn(e.fields?{values:e.fields.map(r=>s_t(r)(n.datum))}:{[wy]:Vj(n.datum)},e))}function m_t(t,e,n,r){for(var a,s,h,d,g,b,_,E,I,R,z,P,rt=this.context.data[t],ot=rt?rt.values.value:[],at={},dt={},ct={},Ct=ot.length,Et=0;Et<Ct;++Et)if(d=(a=ot[Et]).unit,s=a.fields,h=a.values,s&&h){for(z=0,P=s.length;z<P;++z)g=s[z],E=(_=at[g.field]||(at[g.field]={}))[d]||(_[d]=[]),ct[g.field]=I=g.type.charAt(0),R=Fgt[`${I}_union`],_[d]=R(E,et(h[z]));n&&(E=dt[d]||(dt[d]=[])).push(et(h).reduce((Rt,Ot,Wt)=>(Rt[s[Wt].field]=Ot,Rt),{}))}else g=wy,b=Vj(a),(E=(_=at[g]||(at[g]={}))[d]||(_[d]=[])).push(b),n&&(E=dt[d]||(dt[d]=[])).push({[wy]:b});return e=e||u_t,at[wy]?at[wy]=Fgt[`${wy}_${e}`](...Object.values(at[wy])):Object.keys(at).forEach(Rt=>{at[Rt]=Object.keys(at[Rt]).map(Ot=>at[Rt][Ot]).reduce((Ot,Wt)=>Ot===void 0?Wt:Fgt[`${ct[Rt]}_${e}`](Ot,Wt))}),ot=Object.keys(dt),n&&ot.length&&(at[r?"vlPoint":"vlMulti"]=e===u_t?{[l_t]:ot.reduce((Rt,Ot)=>(Rt.push(...dt[Ot]),Rt),[])}:{[kjt]:ot.map(Rt=>({[l_t]:dt[Rt]}))}),at}var Fgt={[`${wy}_union`]:function(...t){let e=new wrt;for(let n of t)for(let r of n)e.add(r);return e},[`${wy}_intersect`]:function(t,...e){t=new wrt(t),e=e.map(xjt);t:for(let n of t)for(let r of e)if(!r.has(n)){t.delete(n);continue t}return t},E_union:function(t,e){if(!t.length)return e;for(var n=0,r=e.length;n<r;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter(n=>e.indexOf(n)>=0):e},R_union:function(t,e){var n=$s(e[0]),r=$s(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?(t[0]>n&&(t[0]=n),t[1]<r&&(t[1]=r),t):[n,r]},R_intersect:function(t,e){var n=$s(e[0]),r=$s(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?r<t[0]||t[1]<n?[]:(t[0]<n&&(t[0]=n),t[1]>r&&(t[1]=r),t):[n,r]}};function PN(t,e,n,r){e[0].type!==LN&&Dn("First argument to selection functions must be a string literal.");let a=e[0].value,s="unit",h="@"+s,d=":"+a;(e.length>=2&&Ba(e).value)!==Rgt||In(r,h)||(r[h]=n.getData(a).indataRef(n,s)),In(r,d)||(r[d]=n.getData(a).tuplesRef())}function g_t(t){let e=this.context.data[t];return e?e.values.value:[]}let Gj=t=>function(e,n){let r=this.context.dataflow.locale();return e===null?"null":r[t](n)(e)},Cjt=Gj("format"),y_t=Gj("timeFormat"),Ejt=Gj("utcFormat"),Tjt=Gj("timeParse"),Ajt=Gj("utcParse"),krt=new Date(2e3,0,1);function Srt(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(krt.setYear(2e3),krt.setMonth(t),krt.setDate(e),y_t.call(this,krt,n)):""}let v_t="$";function Ogt(t,e,n,r){e[0].type!==LN&&Dn("First argument to data functions must be a string literal.");let a=e[0].value,s=":"+a;if(!In(s,r))try{r[s]=n.getData(a).tuplesRef()}catch{}}function $f(t,e,n,r){if(e[0].type===LN)b_t(n,r,e[0].value);else for(t in n.scales)b_t(n,r,t)}function b_t(t,e,n){let r="%"+n;if(!In(e,r))try{e[r]=t.scaleRef(n)}catch{}}function xy(t,e){if(ut(t))return t;if(wi(t)){let n=e.scales[t];return n&&function(r){return r&&r[Cq]===!0}(n.value)?n.value:void 0}}function Ijt(t,e,n){e.__bandwidth=a=>a&&a.bandwidth?a.bandwidth():0,n._bandwidth=$f,n._range=$f,n._scale=$f;let r=a=>"_["+(a.type===LN?pi("%"+a.value):pi("%")+"+"+t(a))+"]";return{_bandwidth:a=>`this.__bandwidth(${r(a[0])})`,_range:a=>`${r(a[0])}.range()`,_scale:a=>`${r(a[0])}(${t(a[1])})`}}function Lgt(t,e){return function(n,r,a){if(n){let s=xy(n,(a||this).context);return s&&s.path[t](r)}return e(r)}}let Njt=Lgt("area",function(t){return ort=new Z4,ggt(t,yy),2*ort}),Mjt=Lgt("bounds",function(t){var e,n,r,a,s,h,d;if(G0=zl=-(wl=Bp=1/0),Q4=[],ggt(t,p3),n=Q4.length){for(Q4.sort(QBt),e=1,s=[r=Q4[0]];e<n;++e)$St(r,(a=Q4[e])[0])||$St(r,a[1])?(H0(r[0],a[1])>H0(r[0],r[1])&&(r[1]=a[1]),H0(a[0],r[1])>H0(r[0],r[1])&&(r[0]=a[0])):s.push(r=a);for(h=-1/0,e=0,r=s[n=s.length-1];e<=n;r=a,++e)a=s[e],(d=H0(r[1],a[0]))>h&&(h=d,wl=a[0],zl=r[1])}return Q4=f3=null,wl===1/0||Bp===1/0?[[NaN,NaN],[NaN,NaN]]:[[wl,Bp],[zl,G0]]}),Djt=Lgt("centroid",function(t){Bj=srt=urt=lrt=crt=hrt=drt=frt=0,wgt=new Z4,xgt=new Z4,kgt=new Z4,ggt(t,_1);var e=+wgt,n=+xgt,r=+kgt,a=fgt(e,n,r);return a<1e-12&&(e=hrt,n=drt,r=frt,srt<hgt&&(e=urt,n=lrt,r=crt),(a=fgt(e,n,r))<1e-12)?[NaN,NaN]:[rrt(n,e)*$j,pgt(r/a)*$j]});function $gt(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(r){t.warn(r)}return n[n.length-1]}function zgt(t){let e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Pgt(t){let e=Egt(t);return .2126*zgt(e.r)+.7152*zgt(e.g)+.0722*zgt(e.b)}function w_t(t,e){return t===e||t!=t&&e!=e||(ni(t)?!(!ni(e)||t.length!==e.length)&&function(n,r){for(let a=0,s=n.length;a<s;++a)if(!w_t(n[a],r[a]))return!1;return!0}(t,e):!(!Zr(t)||!Zr(e))&&x_t(t,e))}function x_t(t,e){for(let n in t)if(!w_t(t[n],e[n]))return!1;return!0}function k_t(t){return e=>x_t(t,e)}let S_t={};function Bgt(t){return ni(t)||ArrayBuffer.isView(t)?t:null}function jgt(t){return Bgt(t)||(wi(t)?t:null)}let __t=t=>t.data;function C_t(t,e){let n=g_t.call(e,t);return n.root&&n.root.lookup||{}}let E_t=()=>typeof window<"u"&&window||null;function T_t(t,e,n){if(!t)return[];let[r,a]=t,s=new Kl().set(r[0],r[1],a[0],a[1]);return function(h,d,g){let b=[],_=new Kl().union(d),E=h.marktype;return E?AX(h,_,g,b):E==="group"?IX(h,_,g,b):Dn("Intersect scene must be mark node or group item.")}(n||this.context.dataflow.scenegraph().root,s,function(h){let d=null;if(h){let g=et(h.marktype),b=et(h.markname);d=_=>(!g.length||g.some(E=>_.marktype===E))&&(!b.length||b.some(E=>_.name===E))}return d}(e))}let Hj={random:()=>m0(),cumulativeNormal:Z5,cumulativeLogNormal:AE,cumulativeUniform:VR,densityNormal:EE,densityLogNormal:TE,densityUniform:NE,quantileNormal:Q5,quantileLogNormal:WR,quantileUniform:ME,sampleNormal:BR,sampleLogNormal:UR,sampleUniform:IE,isArray:ni,isBoolean:function(t){return typeof t=="boolean"},isDate:fi,isDefined:t=>t!==void 0,isNumber:Lr,isObject:Zr,isRegExp:function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},isString:wi,isTuple:Qh,isValid:t=>t!=null&&t==t,toBoolean:cu,toDate:t=>Al(t),toNumber:$s,toString:yw,indexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return jgt(t).indexOf(...n)},join:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Bgt(t).join(...n)},lastindexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return jgt(t).lastIndexOf(...n)},replace:function(t,e,n){return ut(n)&&Dn("Function argument passed to replace."),String(t).replace(e,n)},reverse:function(t){return Bgt(t).slice().reverse()},slice:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return jgt(t).slice(...n)},flush:function(t,e,n,r,a,s){if(!n&&n!==0)return s;let h=+n,d,g=t[0],b=Ba(t);b<g&&(d=g,g=b,b=d),d=Math.abs(e-g);let _=Math.abs(b-e);return d<_&&d<=h?r:_<=h?a:s},lerp:function(t,e){let n=t[0],r=Ba(t),a=+e;return a?a===1?r:n+a*(r-n):n},merge:function(){let t=[].slice.call(arguments);return t.unshift({}),nn(...t)},pad:function(t,e,n,r){let a=n||" ",s=t+"",h=e-s.length;return h<=0?s:r==="left"?Js(a,h)+s:r==="center"?Js(a,~~(h/2))+s+Js(a,Math.ceil(h/2)):s+Js(a,h)},peek:Ba,pluck:function(t,e){let n=S_t[e]||(S_t[e]=sa(e));return ni(t)?t.map(n):n(t)},span:zs,inrange:Na,truncate:function(t,e,n,r){let a=r??"\u2026",s=t+"",h=s.length,d=Math.max(0,e-a.length);return h<=e?s:n==="left"?a+s.slice(h-d):n==="center"?s.slice(0,Math.ceil(d/2))+a+s.slice(h-~~(d/2)):s.slice(0,d)+a},rgb:Egt,lab:r_t,hcl:i_t,hsl:KSt,luminance:Pgt,contrast:function(t,e){let n=Pgt(t),r=Pgt(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:function(t,e,n){t=+t,e=+e,n=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((e-t)/n)),s=new Array(a);++r<a;)s[r]=t+r*n;return s},format:Cjt,utcFormat:Ejt,utcParse:Ajt,utcOffset:function(t,e,n){return K8(F5(t),e,n)},utcSequence:function(t,e,n,r){return _w(F5(t),e,n,r)},timeFormat:y_t,timeParse:Tjt,timeOffset:function(t,e,n){return K8(Sw(t),e,n)},timeSequence:function(t,e,n,r){return _w(Sw(t),e,n,r)},timeUnitSpecifier:function(t,e){let n=nn({},Vr,e),r=Ha(t),a=r.length,s,h,d="",g=0;for(g=0;g<a;)for(s=r.length;s>g;--s)if(h=r.slice(g,s).join("-"),n[h]!=null){d+=n[h],g=s;break}return d.trim()},monthFormat:function(t){return Srt.call(this,t,1,"%B")},monthAbbrevFormat:function(t){return Srt.call(this,t,1,"%b")},dayFormat:function(t){return Srt.call(this,0,2+t,"%A")},dayAbbrevFormat:function(t){return Srt.call(this,0,2+t,"%a")},quarter:function(t){return 1+~~(new Date(t).getMonth()/3)},utcquarter:function(t){return 1+~~(new Date(t).getUTCMonth()/3)},week:function(t){return To(new Date(t))},utcweek:function(t){return no(new Date(t))},dayofyear:function(t){return tu(new Date(t))},utcdayofyear:function(t){return La(new Date(t))},warn:function(){return $gt(this.context.dataflow,"warn",arguments)},info:function(){return $gt(this.context.dataflow,"info",arguments)},debug:function(){return $gt(this.context.dataflow,"debug",arguments)},extent:t=>un(t),inScope:function(t){let e=this.context.group,n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},intersect:T_t,clampRange:function(t,e,n){let r,a=t[0],s=t[1];return s<a&&(r=s,s=a,a=r),r=s-a,r>=n-e?[e,n]:[a=Math.min(Math.max(a,e),n-r),a+r]},pinchDistance:function(t){let e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.hypot(n,r)},pinchAngle:function(t){let e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){let t=E_t();return t?t.screen:{}},containerSize:function(){let t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){let t=E_t();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]},bandspace:function(t,e,n){return BO(t||0,e||0,n||0)},setdata:function(t,e){let n=this.context.dataflow,r=this.context.data[t].input;return n.pulse(r,n.changeset().remove(an).insert(e)),1},pathShape:function(t){let e=null;return function(n){return n?LT(n,e=e||ZO(t)):t}},panLinear:function(t,e){return ph(t,e,$s,Po)},panLog:function(t,e){var n=Math.sign(t[0]);return ph(t,e,oc(n),Oc(n))},panPow:function(t,e,n){return ph(t,e,Ju(n),Ju(1/n))},panSymlog:function(t,e,n){return ph(t,e,sc(n),Lc(n))},zoomLinear:uc,zoomLog:yt,zoomPow:D,zoomSymlog:U,encode:function(t,e,n){if(t){let r=this.context.dataflow,a=t.mark.source;r.pulse(a,r.changeset().encode(t,e))}return n!==void 0?n:t},modify:function(t,e,n,r,a,s){let h=this.context.dataflow,d=this.context.data[t],g=d.input,b=h.stamp(),_,E,I=d.changes;if(h._trigger===!1||!(g.value.length||e||r))return 0;if((!I||I.stamp<b)&&(d.changes=I=h.changeset(),I.stamp=b,h.runAfter(()=>{d.modified=!0,h.pulse(g,I).run()},!0,1)),n&&(_=n===!0?an:ni(n)||Qh(n)?n:k_t(n),I.remove(_)),e&&I.insert(e),r&&(_=k_t(r),g.value.some(_)?I.remove(_):I.insert(r)),a)for(E in s)I.modify(a,E,s[E]);return 1},lassoAppend:function(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5,a=(t=et(t))[t.length-1];return a===void 0||Math.hypot(a[0]-e,a[1]-n)>r?[...t,[e,n]]:t},lassoPath:function(t){return et(t).reduce((e,n,r)=>{let[a,s]=n;return e+(r==0?`M ${a},${s} `:r===t.length-1?" Z":`L ${a},${s} `)},"")},intersectLasso:function(t,e,n){let{x:r,y:a,mark:s}=n,h=new Kl().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(let[d,g]of e)d<h.x1&&(h.x1=d),d>h.x2&&(h.x2=d),g<h.y1&&(h.y1=g),g>h.y2&&(h.y2=g);return h.translate(r,a),T_t([[h.x1,h.y1],[h.x2,h.y2]],t,s).filter(d=>function(g,b,_){let E=0;for(let I=0,R=_.length-1;I<_.length;R=I++){let[z,P]=_[R],[rt,ot]=_[I];ot>b!=P>b&&g<(z-rt)*(b-ot)/(P-ot)+rt&&E++}return 1&E}(d.x,d.y,e))}},Rjt=["view","item","group","xy","x","y"],A_t="this.",Ugt={},I_t={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>`_[${pi(v_t+t)}]`,functions:function(t){let e=ySt(t);Rjt.forEach(n=>e[n]="event.vega."+n);for(let n in Hj)e[n]=A_t+n;return nn(e,Ijt(t,Hj,Ugt)),e},constants:gSt,visitors:Ugt},Wgt=function(t){let e=(t=t||{}).allowed?zc(t.allowed):{},n=t.forbidden?zc(t.forbidden):{},r=t.constants||gSt,a=(t.functions||ySt)(E),s=t.globalvar,h=t.fieldvar,d=ut(s)?s:z=>`${s}["${z}"]`,g={},b={},_=0;function E(z){if(wi(z))return z;let P=I[z.type];return P==null&&Dn("Unsupported type: "+z.type),P(z)}let I={Literal:z=>z.raw,Identifier:z=>{let P=z.name;return _>0?P:In(n,P)?Dn("Illegal identifier: "+P):In(r,P)?r[P]:In(e,P)?P:(g[P]=1,d(P))},MemberExpression:z=>{let P=!z.computed,rt=E(z.object);P&&(_+=1);let ot=E(z.property);return rt===h&&(b[function(at){let dt=at&&at.length-1;return dt&&(at[0]==='"'&&at[dt]==='"'||at[0]==="'"&&at[dt]==="'")?at.slice(1,-1):at}(ot)]=1),P&&(_-=1),rt+(P?"."+ot:"["+ot+"]")},CallExpression:z=>{z.callee.type!=="Identifier"&&Dn("Illegal callee type: "+z.callee.type);let P=z.callee.name,rt=z.arguments,ot=In(a,P)&&a[P];return ot||Dn("Unrecognized function: "+P),ut(ot)?ot(rt):ot+"("+rt.map(E).join(",")+")"},ArrayExpression:z=>"["+z.elements.map(E).join(",")+"]",BinaryExpression:z=>"("+E(z.left)+" "+z.operator+" "+E(z.right)+")",UnaryExpression:z=>"("+z.operator+E(z.argument)+")",ConditionalExpression:z=>"("+E(z.test)+"?"+E(z.consequent)+":"+E(z.alternate)+")",LogicalExpression:z=>"("+E(z.left)+z.operator+E(z.right)+")",ObjectExpression:z=>"{"+z.properties.map(E).join(",")+"}",Property:z=>{_+=1;let P=E(z.key);return _-=1,P+":"+E(z.value)}};function R(z){let P={code:E(z),globals:Object.keys(g),fields:Object.keys(b)};return g={},b={},P}return R.functions=a,R.constants=r,R}(I_t);function _c(t,e,n){return arguments.length===1?Hj[t]:(Hj[t]=e,n&&(Ugt[t]=n),Wgt&&(Wgt.functions[t]=A_t+t),this)}function ky(t,e){let n={},r;try{r=function(s){mr=0,tf=(Zi=s).length,Hs=null,lSt();let h=cgt();if(Hs.type!==Ij)throw new Error("Unexpect token after expression.");return h}(t=wi(t)?t:pi(t)+"")}catch{Dn("Expression parse error: "+t)}r.visit(s=>{if(s.type!==eSt)return;let h=s.callee.name,d=I_t.visitors[h];d&&d(h,s.arguments,e,n)});let a=Wgt(r);return a.globals.forEach(s=>{let h=v_t+s;!In(n,h)&&e.getSignal(s)&&(n[h]=e.signalRef(s))}),{$expr:nn({code:a.code},e.options.ast?{ast:r}:null),$fields:a.fields,$params:n}}_c("bandwidth",function(t,e){let n=xy(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0},$f),_c("copy",function(t,e){let n=xy(t,(e||this).context);return n?n.copy():void 0},$f),_c("domain",function(t,e){let n=xy(t,(e||this).context);return n?n.domain():[]},$f),_c("range",function(t,e){let n=xy(t,(e||this).context);return n&&n.range?n.range():[]},$f),_c("invert",function(t,e,n){let r=xy(t,(n||this).context);return r?ni(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0},$f),_c("scale",function(t,e,n){let r=xy(t,(n||this).context);return r?r(e):void 0},$f),_c("gradient",function(t,e,n,r,a){t=xy(t,(a||this).context);let s=function(_,E){var I,R=[];return I={gradient:"linear",x1:_?_[0]:0,y1:_?_[1]:0,x2:E?E[0]:1,y2:E?E[1]:0,stops:R,stop:function(z,P){return R.push({offset:z,color:P}),I}}}(e,n),h=t.domain(),d=h[0],g=Ba(h),b=Po;return g-d?b=Mq(t,d,g):t=(t.interpolator?rs("sequential")().interpolator(t.interpolator()):rs("linear")().interpolate(t.interpolate()).range(t.range())).domain([d=0,g=1]),t.ticks&&(h=t.ticks(+r||15),d!==h[0]&&h.unshift(d),g!==Ba(h)&&h.push(g)),h.forEach(_=>s.stop(b(_),t(_))),s},$f),_c("geoArea",Njt,$f),_c("geoBounds",Mjt,$f),_c("geoCentroid",Djt,$f),_c("geoShape",function(t,e,n){let r=xy(t,(n||this).context);return function(a){return r?r.path.context(a)(e):""}},$f),_c("geoScale",function(t,e){let n=xy(t,(e||this).context);return n&&n.scale()},$f),_c("indata",function(t,e,n){let r=this.context.data[t]["index:"+e],a=r?r.value.get(n):void 0;return a&&a.count},function(t,e,n,r){e[0].type!==LN&&Dn("First argument to indata must be a string literal."),e[1].type!==LN&&Dn("Second argument to indata must be a string literal.");let a=e[0].value,s=e[1].value,h="@"+s;In(h,r)||(r[h]=n.getData(a).indataRef(n,s))}),_c("data",g_t,Ogt),_c("treePath",function(t,e,n){let r=C_t(t,this),a=r[e],s=r[n];return a&&s?a.path(s).map(__t):void 0},Ogt),_c("treeAncestors",function(t,e){let n=C_t(t,this)[e];return n?n.ancestors().map(__t):void 0},Ogt),_c("vlSelectionTest",h_t,PN),_c("vlSelectionIdTest",f_t,PN),_c("vlSelectionResolve",m_t,PN),_c("vlSelectionTuples",p_t);let Fjt=zc(["rule"]),N_t=zc(["group","image","rect"]);function Vgt(t){return(t+"").toLowerCase()}function Yj(t,e,n){n.endsWith(";")||(n="return("+n+");");let r=Function(...e.concat(n));return t&&t.functions?r.bind(t.functions):r}var Ojt={operator:(t,e)=>Yj(t,["_"],e.code),parameter:(t,e)=>Yj(t,["datum","_"],e.code),event:(t,e)=>Yj(t,["event"],e.code),handler:(t,e)=>Yj(t,["_","event"],`var datum=event.item&&event.item.datum;return ${e.code};`),encode:(t,e)=>{let{marktype:n,channels:r}=e,a="var o=item,datum=o.datum,m=0,$;";for(let s in r){let h="o["+pi(s)+"]";a+=`$=${r[s].code};if(${h}!==$)${h}=$,m=1;`}return a+=function(s,h){let d="";return Fjt[h]||(s.x2&&(s.x?(N_t[h]&&(d+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),d+="o.width=o.x2-o.x;"):d+="o.x=o.x2-(o.width||0);"),s.xc&&(d+="o.x=o.xc-(o.width||0)/2;"),s.y2&&(s.y?(N_t[h]&&(d+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),d+="o.height=o.y2-o.y;"):d+="o.y=o.y2-(o.height||0);"),s.yc&&(d+="o.y=o.yc-(o.height||0)/2;")),d}(r,n),a+="return m;",Yj(t,["item","_"],a)},codegen:{get(t){let e=`[${t.map(pi).join("][")}]`,n=Function("_",`return _${e};`);return n.path=e,n},comparator(t,e){let n,r=Function("a","b","var u, v; return "+t.map((a,s)=>{let h=e[s],d,g;return a.path?(d=`a${a.path}`,g=`b${a.path}`):((n=n||{})["f"+s]=a,d=`this.f${s}(a)`,g=`this.f${s}(b)`),function(b,_,E,I){return`((u = ${b}) < (v = ${_}) || u == null) && v != null ? ${E}
  : (u > v || v == null) && u != null ? ${I}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${E}
  : v !== v && u === u ? ${I} : `}(d,g,-h,h)}).join("")+"0;");return n?r.bind(n):r}}};function M_t(t,e,n){if(!t||!Zr(t))return t;for(let r,a=0,s=D_t.length;a<s;++a)if(r=D_t[a],In(t,r.key))return r.parse(t,e,n);return t}var D_t=[{key:"$ref",parse:function(t,e){return e.get(t.$ref)||Dn("Operator not defined: "+t.$ref)}},{key:"$key",parse:function(t,e){let n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=cs(t.$key,t.$flat,e.expr.codegen))}},{key:"$expr",parse:function(t,e,n){t.$params&&e.parseParameters(t.$params,n);let r="e:"+t.$expr.code;return e.fn[r]||(e.fn[r]=Wr(e.parameterExpression(t.$expr),t.$fields))}},{key:"$field",parse:function(t,e){if(!t.$field)return null;let n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=sa(t.$field,t.$name,e.expr.codegen))}},{key:"$encode",parse:function(t,e){let n=t.$encode,r={};for(let a in n){let s=n[a];r[a]=Wr(e.encodeExpression(s.$expr),s.$fields),r[a].output=s.$output}return r}},{key:"$compare",parse:function(t,e){let n="c:"+t.$compare+"_"+t.$order,r=et(t.$compare).map(a=>a&&a.$tupleid?qi:a);return e.fn[n]||(e.fn[n]=mt(r,t.$order,e.expr.codegen))}},{key:"$context",parse:function(t,e){return e}},{key:"$subflow",parse:function(t,e){let n=t.$subflow;return function(r,a,s){let h=e.fork().parse(n),d=h.get(n.operators[0].id),g=h.signals.parent;return g&&g.set(s),d.detachSubflow=()=>e.detach(h),d}}},{key:"$tupleid",parse:function(){return qi}}];let Ljt={skip:!0};function R_t(t,e,n,r){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=r||Ojt,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function F_t(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}function O_t(t,e){t&&(e==null?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}R_t.prototype=F_t.prototype={fork(){let t=new F_t(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter(n=>n!==t);let e=Object.keys(t.nodes);for(let n of e)t.nodes[n]._targets=null;for(let n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){let n=this,r=n.dataflow,a=t.value;if(n.set(t.id,e),function(s){return Vgt(s)==="collect"}(t.type)&&a&&(a.$ingest?r.ingest(e,a.$ingest,a.$format):a.$request?r.preload(e,a.$request,a.$format):r.pulse(e,r.changeset().insert(a))),t.root&&(n.root=e),t.parent){let s=n.get(t.parent.$ref);s?(r.connect(s,[e]),e.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(t.parent.$ref),r.connect(s,[e]),e.targets().add(s)})}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(let s in t.data){let h=n.data[s]||(n.data[s]={});t.data[s].forEach(d=>h[d]=e)}},resolve(){return(this.unresolved||[]).forEach(t=>t()),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[Vgt(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,r,a){this.dataflow.on(e,n,r,a,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:function(t){let e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach(r=>e.parseOperator(r)),n.forEach(r=>e.parseOperatorParameters(r)),(t.streams||[]).forEach(r=>e.parseStream(r)),(t.updates||[]).forEach(r=>e.parseUpdate(r)),e.resolve()},parseOperator:function(t){let e=this;!function(n){return Vgt(n)==="operator"}(t.type)&&t.type?e.transform(t,t.type):e.operator(t,t.update?e.operatorExpression(t.update):null)},parseOperatorParameters:function(t){let e=this;if(t.params){let n=e.get(t.id);n||Dn("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}},parseParameters:function(t,e){e=e||{};let n=this;for(let r in t){let a=t[r];e[r]=ni(a)?a.map(s=>M_t(s,n,e)):M_t(a,n,e)}return e},parseStream:function(t){var e,n=this,r=t.filter!=null?n.eventExpression(t.filter):void 0,a=t.stream!=null?n.get(t.stream):void 0;t.source?a=n.events(t.source,t.type,r):t.merge&&(a=(e=t.merge.map(s=>n.get(s)))[0].merge.apply(e[0],e.slice(1))),t.between&&(e=t.between.map(s=>n.get(s)),a=a.between(e[0],e[1])),t.filter&&(a=a.filter(r)),t.throttle!=null&&(a=a.throttle(+t.throttle)),t.debounce!=null&&(a=a.debounce(+t.debounce)),a==null&&Dn("Invalid stream definition: "+JSON.stringify(t)),t.consume&&a.consume(!0),n.stream(t,a)},parseUpdate:function(t){var e,n=this,r=Zr(r=t.source)?r.$ref:r,a=n.get(r),s=t.update,h=void 0;a||Dn("Source not defined: "+t.source),e=t.target&&t.target.$expr?n.eventExpression(t.target.$expr):n.get(t.target),s&&s.$expr&&(s.$params&&(h=n.parseParameters(s.$params)),s=n.handlerExpression(s.$expr)),n.update(t,a,e,s,h)},getState:function(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach(s=>{let h=e.signals[s];t.signals(s,h)&&(r[s]=h.value)})}if(t.data){var a=n.data={};Object.keys(e.data).forEach(s=>{let h=e.data[s];t.data(s,h)&&(a[s]=h.input.value)})}return e.subcontext&&t.recurse!==!1&&(n.subcontext=e.subcontext.map(s=>s.getState(t))),n},setState:function(t){var e=this,n=e.dataflow,r=t.data,a=t.signals;Object.keys(a||{}).forEach(s=>{n.update(e.signals[s],a[s],Ljt)}),Object.keys(r||{}).forEach(s=>{n.pulse(e.data[s].input,n.changeset().remove(an).insert(r[s]))}),(t.subcontext||[]).forEach((s,h)=>{let d=e.subcontext[h];d&&d.setState(s)})}};let Ggt="default";function Hgt(t,e){let n=t.globalCursor()?typeof document<"u"&&document.body:t.container();if(n)return e==null?n.style.removeProperty("cursor"):n.style.cursor=e}function _rt(t,e){var n=t._runtime.data;return In(n,e)||Dn("Unrecognized data set: "+e),n[e]}function Crt(t,e){Tv(e)||Dn("Second argument to changes must be a changeset.");let n=_rt(this,t);return n.modified=!0,this.pulse(n.input,e)}function L_t(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function $_t(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function Ert(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}function $jt(t,e,n){var r,a,s=t._renderer,h=s&&s.canvas();return h&&(a=Ert(t),(r=nA(e.changedTouches?e.changedTouches[0]:e,h))[0]-=a[0],r[1]-=a[1]),e.dataflow=t,e.item=n,e.vega=function(d,g,b){let _=g?g.mark.marktype==="group"?g:g.mark.group:null;function E(R){var z,P=_;if(R){for(z=g;z;z=z.mark.group)if(z.mark.name===R){P=z;break}}return P&&P.mark&&P.mark.interactive?P:{}}function I(R){if(!R)return b;wi(R)&&(R=E(R));let z=b.slice();for(;R;)z[0]-=R.x||0,z[1]-=R.y||0,R=R.mark&&R.mark.group;return z}return{view:Ke(d),item:Ke(g||{}),group:E,xy:I,x:R=>I(R)[0],y:R=>I(R)[1]}}(t,n,r),e}let z_t="view",zjt={trap:!1};function P_t(t,e,n,r){t._eventListeners.push({type:n,sources:et(e),handler:r})}function Trt(t,e,n){let r=t._eventConfig&&t._eventConfig[e];return!(r===!1||Zr(r)&&!r[n])||(t.warn(`Blocked ${e} ${n} event listener.`),!1)}function B_t(t){return t.item}function j_t(t){return t.item.mark.source}function U_t(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function Y0(t,e,n){let r=document.createElement(t);for(let a in e)r.setAttribute(a,e[a]);return n!=null&&(r.textContent=n),r}function Pjt(t,e,n,r){let a=n.event||"input",s=()=>t.update(e.value);r.signal(n.signal,e.value),e.addEventListener(a,s),P_t(r,e,a,s),t.set=h=>{e.value=h,e.dispatchEvent(function(d){return typeof Event<"u"?new Event(d):{type:d}}(a))}}function Bjt(t,e,n,r){let a=r.signal(n.signal),s=Y0("div",{class:"vega-bind"}),h=n.input==="radio"?s:s.appendChild(Y0("label"));h.appendChild(Y0("span",{class:"vega-bind-name"},n.name||n.signal)),e.appendChild(s);let d=jjt;switch(n.input){case"checkbox":d=Ujt;break;case"select":d=Wjt;break;case"radio":d=Vjt;break;case"range":d=Gjt}d(t,h,n,a)}function jjt(t,e,n,r){let a=Y0("input");for(let s in n)s!=="signal"&&s!=="element"&&a.setAttribute(s==="input"?"type":s,n[s]);a.setAttribute("name",n.signal),a.value=r,e.appendChild(a),a.addEventListener("input",()=>t.update(a.value)),t.elements=[a],t.set=s=>a.value=s}function Ujt(t,e,n,r){let a={type:"checkbox",name:n.signal};r&&(a.checked=!0);let s=Y0("input",a);e.appendChild(s),s.addEventListener("change",()=>t.update(s.checked)),t.elements=[s],t.set=h=>s.checked=!!h||null}function Wjt(t,e,n,r){let a=Y0("select",{name:n.signal}),s=n.labels||[];n.options.forEach((h,d)=>{let g={value:h};Art(h,r)&&(g.selected=!0),a.appendChild(Y0("option",g,(s[d]||h)+""))}),e.appendChild(a),a.addEventListener("change",()=>{t.update(n.options[a.selectedIndex])}),t.elements=[a],t.set=h=>{for(let d=0,g=n.options.length;d<g;++d)if(Art(n.options[d],h))return void(a.selectedIndex=d)}}function Vjt(t,e,n,r){let a=Y0("span",{class:"vega-bind-radio"}),s=n.labels||[];e.appendChild(a),t.elements=n.options.map((h,d)=>{let g={type:"radio",name:n.signal,value:h};Art(h,r)&&(g.checked=!0);let b=Y0("input",g);b.addEventListener("change",()=>t.update(h));let _=Y0("label",{},(s[d]||h)+"");return _.prepend(b),a.appendChild(_),b}),t.set=h=>{let d=t.elements,g=d.length;for(let b=0;b<g;++b)Art(d[b].value,h)&&(d[b].checked=!0)}}function Gjt(t,e,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;let a=n.max!=null?n.max:Math.max(100,+r)||100,s=n.min||Math.min(0,a,+r)||0,h=n.step||H2(s,a,100),d=Y0("input",{type:"range",name:n.signal,min:s,max:a,step:h});d.value=r;let g=Y0("span",{},+r);e.appendChild(d),e.appendChild(g);let b=()=>{g.textContent=d.value,t.update(+d.value)};d.addEventListener("input",b),d.addEventListener("change",b),t.elements=[d],t.set=_=>{d.value=_,g.textContent=_}}function Art(t,e){return t===e||t+""==e+""}function W_t(t,e,n,r,a,s){return(e=e||new r(t.loader())).initialize(n,L_t(t),$_t(t),Ert(t),a,s).background(t.background())}function Ygt(t,e){return e?function(){try{e.apply(this,arguments)}catch(n){t.error(n)}}:null}function qgt(t,e,n){if(typeof e=="string"){if(typeof document>"u")return t.error("DOM document instance not found."),null;if(!(e=document.querySelector(e)))return t.error("Signal bind element not found: "+e),null}if(e&&n)try{e.innerHTML=""}catch(r){e=null,t.error(r)}return e}let qj=t=>+t||0;function V_t(t){return Zr(t)?{top:qj(t.top),bottom:qj(t.bottom),left:qj(t.left),right:qj(t.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(qj(t))}function Xgt(t,e,n,r){return ce(this,null,function*(){let a=WL(e),s=a&&a.headless;return s||Dn("Unrecognized renderer type: "+e),yield t.runAsync(),W_t(t,null,null,s,n,r).renderAsync(t._scenegraph.root)})}function Hjt(t,e,n){return function(r,a,s,h){return new R_t(r,a,s,h)}(t,m2,Hj,n).parse(e)}var G_t="width",H_t="height",Kgt="padding",Y_t={skip:!0};function q_t(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===Kgt?r.left+r.right:0)}function X_t(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===Kgt?r.top+r.bottom:0)}function Yjt(t,e){return e.modified&&ni(e.input.value)&&t.indexOf("_:vega:_")}function qjt(t,e){return!(t==="parent"||e instanceof m2.proxy)}function Xjt(t,e,n,r){let a=t.element();a&&a.setAttribute("title",function(s){return s==null?"":ni(s)?K_t(s):Zr(s)&&!fi(s)?(h=s,Object.keys(h).map(d=>{let g=h[d];return d+": "+(ni(g)?K_t(g):Z_t(g))}).join(`
`)):s+"";var h}(r))}function K_t(t){return"["+t.map(Z_t).join(", ")+"]"}function Z_t(t){return ni(t)?"[\u2026]":Zr(t)&&!fi(t)?"{\u2026}":t}function Q_t(t,e){let n=this;if(e=e||{},Dg.call(n),e.loader&&n.loader(e.loader),e.logger&&n.logger(e.logger),e.logLevel!=null&&n.logLevel(e.logLevel),e.locale||t.locale){let s=nn({},t.locale,e.locale);n.locale(function(h,d){let g=h?sE(h):uE(),b=d?_R(d):V5();return lE(g,b)}(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=e.renderer||lb.Canvas,n._scenegraph=new bX;let r=n._scenegraph.root;n._renderer=null,n._tooltip=e.tooltip||Xjt,n._redraw=!0,n._handler=new mx().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(s){let h=nn({defaults:{}},s),d=(g,b)=>{b.forEach(_=>{ni(g[_])&&(g[_]=zc(g[_]))})};return d(h.defaults,["prevent","allow"]),d(h,["view","window","selector"]),h}(t.eventConfig),n.globalCursor(n._eventConfig.globalCursor);let a=Hjt(n,t,e.expr);n._runtime=a,n._signals=a.signals,n._bind=(t.bindings||[]).map(s=>({state:null,param:nn({},s)})),a.root&&a.root.set(r),r.source=a.data.root.input,n.pulse(a.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=q_t(n,n._width),n._viewHeight=X_t(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(s){var h=s._signals,d=h[G_t],g=h[H_t],b=h[Kgt];function _(){s._autosize=s._resize=1}s._resizeWidth=s.add(null,I=>{s._width=I.size,s._viewWidth=q_t(s,I.size),_()},{size:d}),s._resizeHeight=s.add(null,I=>{s._height=I.size,s._viewHeight=X_t(s,I.size),_()},{size:g});let E=s.add(null,_,{pad:b});s._resizeWidth.rank=d.rank+1,s._resizeHeight.rank=g.rank+1,E.rank=b.rank+1}(n),function(s){s.add(null,h=>(s._background=h.bg,s._resize=1,h.bg),{bg:s._signals.background})}(n),function(s){let h=s._signals.cursor||(s._signals.cursor=s.add({user:Ggt,item:null}));s.on(s.events("view","mousemove"),h,(d,g)=>{let b=h.value,_=b?wi(b)?b:b.user:Ggt,E=g.item&&g.item.cursor||null;return b&&_===b.user&&E==b.item?b:{user:_,item:E}}),s.add(null,function(d){let g=d.cursor,b=this.value;return wi(g)||(b=g.item,g=g.user),Hgt(s,g&&g!==Ggt?g:b||g),b},{cursor:h})}(n),n.description(t.description),e.hover&&n.hover(),e.container&&n.initialize(e.container,e.bind)}function Irt(t,e){return In(t._signals,e)?t._signals[e]:Dn("Unrecognized signal name: "+pi(e))}function J_t(t,e){let n=(t._targets||[]).filter(r=>r._update&&r._update.handler===e);return n.length?n[0]:null}function t6t(t,e,n,r){let a=J_t(n,r);return a||(a=Ygt(t,()=>r(e,n.value)),a.handler=r,t.on(n,null,a)),t}function e6t(t,e,n){let r=J_t(e,n);return r&&e._targets.remove(r),t}ur(Q_t,Dg,{evaluate(t,e,n){return ce(this,null,function*(){if(yield Dg.prototype.evaluate.call(this,t,e),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,function(r){var a=Ert(r),s=L_t(r),h=$_t(r);r._renderer.background(r.background()),r._renderer.resize(s,h,a),r._handler.origin(a),r._resizeListeners.forEach(d=>{try{d(s,h)}catch(g){r.error(g)}})}(this)),yield this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&Nw(this,n),this})},dirty(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){let e=t!=null?t+"":null;return e!==this._desc&&O_t(this._el,this._desc=e),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){let r=Irt(this,t);return arguments.length===1?r.value:this.update(r,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",V_t(t)):V_t(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){return arguments.length?(WL(t)||Dn("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},tooltip(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},loader(t){return arguments.length?(t!==this._loader&&(Dg.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Irt(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(t,e,n,r,a,s){this.runAfter(h=>{let d=0;h._autosize=0,h.width()!==n&&(d=1,h.signal(G_t,n,Y_t),h._resizeWidth.skip(!0)),h.height()!==r&&(d=1,h.signal(H_t,r,Y_t),h._resizeHeight.skip(!0)),h._viewWidth!==t&&(h._resize=1,h._viewWidth=t),h._viewHeight!==e&&(h._resize=1,h._viewHeight=e),h._origin[0]===a[0]&&h._origin[1]===a[1]||(h._resize=1,h._origin=a),d&&h.run("enter"),s&&h.runAfter(g=>g.resize())},!1,1)},addEventListener(t,e,n){let r=e;return n&&n.trap===!1||(r=Ygt(this,e),r.raw=e),this._handler.on(t,r),this},removeEventListener(t,e){for(var n,r,a=this._handler.handlers(t),s=a.length;--s>=0;)if(r=a[s].type,n=a[s].handler,t===r&&(e===n||e===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(t){let e=this._resizeListeners;return e.indexOf(t)<0&&e.push(t),this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},addSignalListener(t,e){return t6t(this,t,Irt(this,t),e)},removeSignalListener(t,e){return e6t(this,Irt(this,t),e)},addDataListener(t,e){return t6t(this,t,_rt(this,t).values,e)},removeDataListener(t,e){return e6t(this,_rt(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){let e=Hgt(this,null);this._globalCursor=!!t,e&&Hgt(this,e)}return this}return this._globalCursor},preventDefault(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},timer:function(t,e){this._timers.push(function(n,r,a){var s=new V_,h=r;return r==null?(s.restart(n,r,a),s):(s._restart=s.restart,s.restart=function(d,g,b){g=+g,b=b==null?SI():+b,s._restart(function _(E){E+=h,s._restart(_,h+=g,b),d(E)},g,b)},s.restart(n,r,a),s)}(function(n){t({timestamp:Date.now(),elapsed:n})},e))},events:function(t,e,n){var r,a=this,s=new Rw(n),h=function(b,_){a.runAsync(null,()=>{t===z_t&&function(E,I){var R=E._eventConfig.defaults,z=R.prevent,P=R.allow;return z!==!1&&P!==!0&&(z===!0||P===!1||(z?z[I]:P?!P[I]:E.preventDefault()))}(a,e)&&b.preventDefault(),s.receive($jt(a,b,_))})};if(t==="timer")Trt(a,"timer",e)&&a.timer(h,e);else if(t===z_t)Trt(a,"view",e)&&a.addEventListener(e,h,zjt);else if(t==="window"?Trt(a,"window",e)&&typeof window<"u"&&(r=[window]):typeof document<"u"&&Trt(a,"selector",e)&&(r=document.querySelectorAll(t)),r){for(var d=0,g=r.length;d<g;++d)r[d].addEventListener(e,h);P_t(a,r,e,h)}else a.warn("Can not resolve event source: "+t);return s},finalize:function(){var t,e,n,r=this._tooltip,a=this._timers,s=this._eventListeners;for(t=a.length;--t>=0;)a[t].stop();for(t=s.length;--t>=0;)for(e=(n=s[t]).sources.length;--e>=0;)n.sources[e].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(t,e){return e=[e||"update",(t=[t||"hover"])[0]],this.on(this.events("view","mouseover",B_t),j_t,U_t(t)),this.on(this.events("view","mouseout",B_t),j_t,U_t(e)),this},data:function(t,e){return arguments.length<2?_rt(this,t).values.value:Crt.call(this,t,sp().remove(an).insert(e))},change:Crt,insert:function(t,e){return Crt.call(this,t,sp().insert(e))},remove:function(t,e){return Crt.call(this,t,sp().remove(e))},scale:function(t){var e=this._runtime.scales;return In(e,t)||Dn("Unrecognized scale or projection: "+t),e[t].value},initialize:function(t,e){let n=this,r=n._renderType,a=n._eventConfig.bind,s=WL(r);t=n._el=t?qgt(n,t,!0):null,function(g){let b=g.container();b&&(b.setAttribute("role","graphics-document"),b.setAttribute("aria-roleDescription","visualization"),O_t(b,g.description()))}(n),s||n.error("Unrecognized renderer type: "+r);let h=s.handler||mx,d=t?s.renderer:s.headless;return n._renderer=d?W_t(n,n._renderer,t,d):null,n._handler=function(g,b,_,E){let I=new E(g.loader(),Ygt(g,g.tooltip())).scene(g.scenegraph().root).initialize(_,Ert(g),g);return b&&b.handlers().forEach(R=>{I.on(R.type,R.handler)}),I}(n,n._handler,t,h),n._redraw=!0,t&&a!=="none"&&(e=e?n._elBind=qgt(n,e,!0):t.appendChild(Y0("form",{class:"vega-bindings"})),n._bind.forEach(g=>{g.param.element&&a!=="container"&&(g.element=qgt(n,g.param.element,!!g.param.input))}),n._bind.forEach(g=>{(function(b,_,E){if(!_)return;let I=E.param,R=E.state;R||(R=E.state={elements:null,active:!1,set:null,update:z=>{z!=b.signal(I.signal)&&b.runAsync(null,()=>{R.source=!0,b.signal(I.signal,z)})}},I.debounce&&(R.update=Tn(I.debounce,R.update))),(I.input==null&&I.element?Pjt:Bjt)(R,_,I,b),R.active||(b.on(b._signals[I.signal],null,()=>{R.source?R.source=!1:R.set(b.signal(I.signal))}),R.active=!0)})(n,g.element||e,g)})),n},toImageURL:function(t,e){return ce(this,null,function*(){t!==lb.Canvas&&t!==lb.SVG&&t!==lb.PNG&&Dn("Unrecognized image type: "+t);let n=yield Xgt(this,t,e);return t===lb.SVG?function(r,a){let s=new Blob([r],{type:a});return window.URL.createObjectURL(s)}(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")})},toCanvas:function(t,e){return ce(this,null,function*(){return(yield Xgt(this,lb.Canvas,t,e)).canvas()})},toSVG:function(t){return ce(this,null,function*(){return(yield Xgt(this,lb.SVG,t)).svg()})},getState:function(t){return this._runtime.getState(t||{data:Yjt,signals:qjt,recurse:!0})},setState:function(t){return this.runAsync(null,e=>{e._trigger=!1,e._runtime.setState(t)},e=>{e._trigger=!0}),this}});var n6t,Kjt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Xj(t){if(!(e=Kjt.exec(t)))throw new Error("invalid format: "+t);var e;return new Zgt({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Zgt(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}function Nrt(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function BN(t){return(t=Nrt(Math.abs(t)))?t[1]:NaN}function r6t(t,e){var n=Nrt(t,e);if(!n)return t+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}Xj.prototype=Zgt.prototype,Zgt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,0|this.width))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};let i6t={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>r6t(100*t,e),r:r6t,s:function(t,e){var n=Nrt(t,e);if(!n)return t+"";var r=n[0],a=n[1],s=a-(n6t=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,h=r.length;return s===h?r:s>h?r+new Array(s-h+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+Nrt(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function a6t(t){return t}var Qgt,o6t,s6t,u6t=Array.prototype.map,l6t=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function c6t(t){var e,n,r=t.grouping===void 0||t.thousands===void 0?a6t:(e=u6t.call(t.grouping,Number),n=t.thousands+"",function(I,R){for(var z=I.length,P=[],rt=0,ot=e[0],at=0;z>0&&ot>0&&(at+ot+1>R&&(ot=Math.max(1,R-at)),P.push(I.substring(z-=ot,z+ot)),!((at+=ot+1)>R));)ot=e[rt=(rt+1)%e.length];return P.reverse().join(n)}),a=t.currency===void 0?"":t.currency[0]+"",s=t.currency===void 0?"":t.currency[1]+"",h=t.decimal===void 0?".":t.decimal+"",d=t.numerals===void 0?a6t:function(I){return function(R){return R.replace(/[0-9]/g,function(z){return I[+z]})}}(u6t.call(t.numerals,String)),g=t.percent===void 0?"%":t.percent+"",b=t.minus===void 0?"\u2212":t.minus+"",_=t.nan===void 0?"NaN":t.nan+"";function E(I){var R=(I=Xj(I)).fill,z=I.align,P=I.sign,rt=I.symbol,ot=I.zero,at=I.width,dt=I.comma,ct=I.precision,Ct=I.trim,Et=I.type;Et==="n"?(dt=!0,Et="g"):i6t[Et]||(ct===void 0&&(ct=12),Ct=!0,Et="g"),(ot||R==="0"&&z==="=")&&(ot=!0,R="0",z="=");var Rt=rt==="$"?a:rt==="#"&&/[boxX]/.test(Et)?"0"+Et.toLowerCase():"",Ot=rt==="$"?s:/[%p]/.test(Et)?g:"",Wt=i6t[Et],jt=/[defgprs%]/.test(Et);function Ht(Vt){var fe,se,he,_e=Rt,Ve=Ot;if(Et==="c")Ve=Wt(Vt)+Ve,Vt="";else{var gn=(Vt=+Vt)<0||1/Vt<0;if(Vt=isNaN(Vt)?_:Wt(Math.abs(Vt),ct),Ct&&(Vt=function(qe){t:for(var tr,er=qe.length,An=1,dn=-1;An<er;++An)switch(qe[An]){case".":dn=tr=An;break;case"0":dn===0&&(dn=An),tr=An;break;default:if(!+qe[An])break t;dn>0&&(dn=0)}return dn>0?qe.slice(0,dn)+qe.slice(tr+1):qe}(Vt)),gn&&+Vt==0&&P!=="+"&&(gn=!1),_e=(gn?P==="("?P:b:P==="-"||P==="("?"":P)+_e,Ve=(Et==="s"?l6t[8+n6t/3]:"")+Ve+(gn&&P==="("?")":""),jt){for(fe=-1,se=Vt.length;++fe<se;)if(48>(he=Vt.charCodeAt(fe))||he>57){Ve=(he===46?h+Vt.slice(fe+1):Vt.slice(fe))+Ve,Vt=Vt.slice(0,fe);break}}}dt&&!ot&&(Vt=r(Vt,1/0));var $n=_e.length+Vt.length+Ve.length,Gn=$n<at?new Array(at-$n+1).join(R):"";switch(dt&&ot&&(Vt=r(Gn+Vt,Gn.length?at-Ve.length:1/0),Gn=""),z){case"<":Vt=_e+Vt+Ve+Gn;break;case"=":Vt=_e+Gn+Vt+Ve;break;case"^":Vt=Gn.slice(0,$n=Gn.length>>1)+_e+Vt+Ve+Gn.slice($n);break;default:Vt=Gn+_e+Vt+Ve}return d(Vt)}return ct=ct===void 0?6:/[gprs]/.test(Et)?Math.max(1,Math.min(21,ct)):Math.max(0,Math.min(20,ct)),Ht.toString=function(){return I+""},Ht}return{format:E,formatPrefix:function(I,R){var z=E(((I=Xj(I)).type="f",I)),P=3*Math.max(-8,Math.min(8,Math.floor(BN(R)/3))),rt=Math.pow(10,-P),ot=l6t[8+P/3];return function(at){return z(rt*at)+ot}}}}function jN(t,e,n){return t.fields=e||[],t.fname=n,t}function Zjt(t){return t.length===1?Qjt(t[0]):Jjt(t)}(function(t){Qgt=c6t(t),o6t=Qgt.format,s6t=Qgt.formatPrefix})({thousands:",",grouping:[3],currency:["$",""]});let Qjt=t=>function(e){return e[t]},Jjt=t=>{let e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Kj(t){throw Error(t)}function tUt(t){let e=[],n=t.length,r,a,s,h=null,d=0,g="";function b(){e.push(g+t.substring(r,a)),g="",r=a+1}for(t+="",r=a=0;a<n;++a)if(s=t[a],s==="\\")g+=t.substring(r,a++),r=a;else if(s===h)b(),h=null,d=-1;else{if(h)continue;r===d&&s==='"'||r===d&&s==="'"?(r=a+1,h=s):s!=="."||d?s==="["?(a>r&&b(),d=r=a+1):s==="]"&&(d||Kj("Access path missing open bracket: "+t),d>0&&b(),d=0,r=a+1):a>r?b():r=a+1}return d&&Kj("Access path missing closing bracket: "+t),h&&Kj("Access path missing closing quote: "+t),a>r&&(a++,b()),e}function eUt(t,e,n){let r=tUt(t);return t=r.length===1?r[0]:t,jN(Zjt(r),[t],t)}eUt("id"),jN(t=>t,[],"identity"),jN(()=>0,[],"zero"),jN(()=>1,[],"one"),jN(()=>!0,[],"true"),jN(()=>!1,[],"false");function nUt(t){return t===Object(t)}function rUt(t){for(let e,n,r=1,a=arguments.length;r<a;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function h6t(t){return typeof t=="string"}let Zj="year",Qj="quarter",Jj="month",tU="week",eU="date",Mrt="day",Jgt="dayofyear",nU="hours",rU="minutes",iU="seconds",Drt="milliseconds";[Zj,Qj,Jj,tU,eU,Mrt,Jgt,nU,rU,iU,Drt].reduce((t,e,n)=>(t[e]=1+n,t),{});let iUt={[Zj]:gh,[Qj]:tl.every(3),[Jj]:tl,[tU]:Hl,[eU]:Ds,[Mrt]:Ds,[Jgt]:Ds,[nU]:ip,[rU]:lc,[iU]:Il,[Drt]:bf},aUt={[Zj]:Uc,[Qj]:Kh.every(3),[Jj]:Kh,[tU]:Td,[eU]:Ss,[Mrt]:Ss,[Jgt]:Ss,[nU]:hm,[rU]:Ag,[iU]:Il,[Drt]:bf};function oUt(t){return iUt[t]}function sUt(t){return aUt[t]}var t1t=new Date,e1t=new Date;function g3(t,e,n,r){function a(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=function(s){return t(s=new Date(+s)),s},a.ceil=function(s){return t(s=new Date(s-1)),e(s,1),t(s),s},a.round=function(s){var h=a(s),d=a.ceil(s);return s-h<d-s?h:d},a.offset=function(s,h){return e(s=new Date(+s),h==null?1:Math.floor(h)),s},a.range=function(s,h,d){var g,b=[];if(s=a.ceil(s),d=d==null?1:Math.floor(d),!(s<h&&d>0))return b;do b.push(g=new Date(+s)),e(s,d),t(s);while(g<s&&s<h);return b},a.filter=function(s){return g3(function(h){if(h>=h)for(;t(h),!s(h);)h.setTime(h-1)},function(h,d){if(h>=h)if(d<0)for(;++d<=0;)for(;e(h,-1),!s(h););else for(;--d>=0;)for(;e(h,1),!s(h););})},n&&(a.count=function(s,h){return t1t.setTime(+s),e1t.setTime(+h),t(t1t),t(e1t),Math.floor(n(t1t,e1t))},a.every=function(s){return s=Math.floor(s),isFinite(s)&&s>0?s>1?a.filter(r?function(h){return r(h)%s==0}:function(h){return a.count(0,h)%s==0}):a:null}),a}let d6t=6e4,f6t=864e5,p6t=6048e5;function RC(t){return g3(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+7*n)},function(e,n){return(n-e)/p6t})}var uUt=RC(0),n1t=RC(1);RC(2),RC(3);var aU=RC(4);RC(5),RC(6);var lUt=g3(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/f6t},function(t){return t.getUTCDate()-1});let m6t=lUt;function FC(t){return g3(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+7*n)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*d6t)/p6t})}var cUt=FC(0),r1t=FC(1);FC(2),FC(3);var oU=FC(4);FC(5),FC(6);var hUt=g3(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*d6t)/f6t,t=>t.getDate()-1);let g6t=hUt;var y6t=g3(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});y6t.every=function(t){return isFinite(t=Math.floor(t))&&t>0?g3(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};let sU=y6t;var v6t=g3(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});v6t.every=function(t){return isFinite(t=Math.floor(t))&&t>0?g3(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};let uU=v6t;function i1t(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function a1t(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function lU(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function b6t(t){var e=t.dateTime,n=t.date,r=t.time,a=t.periods,s=t.days,h=t.shortDays,d=t.months,g=t.shortMonths,b=hU(a),_=dU(a),E=hU(s),I=dU(s),R=hU(h),z=dU(h),P=hU(d),rt=dU(d),ot=hU(g),at=dU(g),dt={a:function(Wt){return h[Wt.getDay()]},A:function(Wt){return s[Wt.getDay()]},b:function(Wt){return g[Wt.getMonth()]},B:function(Wt){return d[Wt.getMonth()]},c:null,d:I6t,e:I6t,f:FUt,g:VUt,G:HUt,H:MUt,I:DUt,j:RUt,L:N6t,m:OUt,M:LUt,p:function(Wt){return a[+(Wt.getHours()>=12)]},q:function(Wt){return 1+~~(Wt.getMonth()/3)},Q:L6t,s:$6t,S:$Ut,u:zUt,U:PUt,V:BUt,w:jUt,W:UUt,x:null,X:null,y:WUt,Y:GUt,Z:YUt,"%":O6t},ct={a:function(Wt){return h[Wt.getUTCDay()]},A:function(Wt){return s[Wt.getUTCDay()]},b:function(Wt){return g[Wt.getUTCMonth()]},B:function(Wt){return d[Wt.getUTCMonth()]},c:null,d:D6t,e:D6t,f:ZUt,g:sWt,G:lWt,H:qUt,I:XUt,j:KUt,L:R6t,m:QUt,M:JUt,p:function(Wt){return a[+(Wt.getUTCHours()>=12)]},q:function(Wt){return 1+~~(Wt.getUTCMonth()/3)},Q:L6t,s:$6t,S:tWt,u:eWt,U:nWt,V:rWt,w:iWt,W:aWt,x:null,X:null,y:oWt,Y:uWt,Z:cWt,"%":O6t},Ct={a:function(Wt,jt,Ht){var Vt=R.exec(jt.slice(Ht));return Vt?(Wt.w=z.get(Vt[0].toLowerCase()),Ht+Vt[0].length):-1},A:function(Wt,jt,Ht){var Vt=E.exec(jt.slice(Ht));return Vt?(Wt.w=I.get(Vt[0].toLowerCase()),Ht+Vt[0].length):-1},b:function(Wt,jt,Ht){var Vt=ot.exec(jt.slice(Ht));return Vt?(Wt.m=at.get(Vt[0].toLowerCase()),Ht+Vt[0].length):-1},B:function(Wt,jt,Ht){var Vt=P.exec(jt.slice(Ht));return Vt?(Wt.m=rt.get(Vt[0].toLowerCase()),Ht+Vt[0].length):-1},c:function(Wt,jt,Ht){return Ot(Wt,e,jt,Ht)},d:T6t,e:T6t,f:TUt,g:E6t,G:C6t,H:A6t,I:A6t,j:SUt,L:EUt,m:kUt,M:_Ut,p:function(Wt,jt,Ht){var Vt=b.exec(jt.slice(Ht));return Vt?(Wt.p=_.get(Vt[0].toLowerCase()),Ht+Vt[0].length):-1},q:xUt,Q:IUt,s:NUt,S:CUt,u:gUt,U:yUt,V:vUt,w:mUt,W:bUt,x:function(Wt,jt,Ht){return Ot(Wt,n,jt,Ht)},X:function(Wt,jt,Ht){return Ot(Wt,r,jt,Ht)},y:E6t,Y:C6t,Z:wUt,"%":AUt};function Et(Wt,jt){return function(Ht){var Vt,fe,se,he=[],_e=-1,Ve=0,gn=Wt.length;for(Ht instanceof Date||(Ht=new Date(+Ht));++_e<gn;)Wt.charCodeAt(_e)===37&&(he.push(Wt.slice(Ve,_e)),(fe=_6t[Vt=Wt.charAt(++_e)])!=null?Vt=Wt.charAt(++_e):fe=Vt==="e"?" ":"0",(se=jt[Vt])&&(Vt=se(Ht,fe)),he.push(Vt),Ve=_e+1);return he.push(Wt.slice(Ve,_e)),he.join("")}}function Rt(Wt,jt){return function(Ht){var Vt,fe,se=lU(1900,void 0,1);if(Ot(se,Wt,Ht+="",0)!=Ht.length)return null;if("Q"in se)return new Date(se.Q);if("s"in se)return new Date(1e3*se.s+("L"in se?se.L:0));if(jt&&!("Z"in se)&&(se.Z=0),"p"in se&&(se.H=se.H%12+12*se.p),se.m===void 0&&(se.m="q"in se?se.q:0),"V"in se){if(se.V<1||se.V>53)return null;"w"in se||(se.w=1),"Z"in se?(fe=(Vt=a1t(lU(se.y,0,1))).getUTCDay(),Vt=fe>4||fe===0?n1t.ceil(Vt):n1t(Vt),Vt=m6t.offset(Vt,7*(se.V-1)),se.y=Vt.getUTCFullYear(),se.m=Vt.getUTCMonth(),se.d=Vt.getUTCDate()+(se.w+6)%7):(fe=(Vt=i1t(lU(se.y,0,1))).getDay(),Vt=fe>4||fe===0?r1t.ceil(Vt):r1t(Vt),Vt=g6t.offset(Vt,7*(se.V-1)),se.y=Vt.getFullYear(),se.m=Vt.getMonth(),se.d=Vt.getDate()+(se.w+6)%7)}else("W"in se||"U"in se)&&("w"in se||(se.w="u"in se?se.u%7:"W"in se?1:0),fe="Z"in se?a1t(lU(se.y,0,1)).getUTCDay():i1t(lU(se.y,0,1)).getDay(),se.m=0,se.d="W"in se?(se.w+6)%7+7*se.W-(fe+5)%7:se.w+7*se.U-(fe+6)%7);return"Z"in se?(se.H+=se.Z/100|0,se.M+=se.Z%100,a1t(se)):i1t(se)}}function Ot(Wt,jt,Ht,Vt){for(var fe,se,he=0,_e=jt.length,Ve=Ht.length;he<_e;){if(Vt>=Ve)return-1;if((fe=jt.charCodeAt(he++))===37){if(fe=jt.charAt(he++),!(se=Ct[fe in _6t?jt.charAt(he++):fe])||(Vt=se(Wt,Ht,Vt))<0)return-1}else if(fe!=Ht.charCodeAt(Vt++))return-1}return Vt}return dt.x=Et(n,dt),dt.X=Et(r,dt),dt.c=Et(e,dt),ct.x=Et(n,ct),ct.X=Et(r,ct),ct.c=Et(e,ct),{format:function(Wt){var jt=Et(Wt+="",dt);return jt.toString=function(){return Wt},jt},parse:function(Wt){var jt=Rt(Wt+="",!1);return jt.toString=function(){return Wt},jt},utcFormat:function(Wt){var jt=Et(Wt+="",ct);return jt.toString=function(){return Wt},jt},utcParse:function(Wt){var jt=Rt(Wt+="",!0);return jt.toString=function(){return Wt},jt}}}var cU,w6t,x6t,k6t,S6t,_6t={"-":"",_:" ",0:"0"},Rh=/^\s*\d+/,dUt=/^%/,fUt=/[\\^$*+?|[\]().{}]/g;function fs(t,e,n){var r=t<0?"-":"",a=(r?-t:t)+"",s=a.length;return r+(s<n?new Array(n-s+1).join(e)+a:a)}function pUt(t){return t.replace(fUt,"\\$&")}function hU(t){return new RegExp("^(?:"+t.map(pUt).join("|")+")","i")}function dU(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function mUt(t,e,n){var r=Rh.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function gUt(t,e,n){var r=Rh.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function yUt(t,e,n){var r=Rh.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function vUt(t,e,n){var r=Rh.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function bUt(t,e,n){var r=Rh.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function C6t(t,e,n){var r=Rh.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function E6t(t,e,n){var r=Rh.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function wUt(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function xUt(t,e,n){var r=Rh.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function kUt(t,e,n){var r=Rh.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function T6t(t,e,n){var r=Rh.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function SUt(t,e,n){var r=Rh.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function A6t(t,e,n){var r=Rh.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function _Ut(t,e,n){var r=Rh.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function CUt(t,e,n){var r=Rh.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function EUt(t,e,n){var r=Rh.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function TUt(t,e,n){var r=Rh.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function AUt(t,e,n){var r=dUt.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function IUt(t,e,n){var r=Rh.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function NUt(t,e,n){var r=Rh.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function I6t(t,e){return fs(t.getDate(),e,2)}function MUt(t,e){return fs(t.getHours(),e,2)}function DUt(t,e){return fs(t.getHours()%12||12,e,2)}function RUt(t,e){return fs(1+g6t.count(sU(t),t),e,3)}function N6t(t,e){return fs(t.getMilliseconds(),e,3)}function FUt(t,e){return N6t(t,e)+"000"}function OUt(t,e){return fs(t.getMonth()+1,e,2)}function LUt(t,e){return fs(t.getMinutes(),e,2)}function $Ut(t,e){return fs(t.getSeconds(),e,2)}function zUt(t){var e=t.getDay();return e===0?7:e}function PUt(t,e){return fs(cUt.count(sU(t)-1,t),e,2)}function M6t(t){var e=t.getDay();return e>=4||e===0?oU(t):oU.ceil(t)}function BUt(t,e){return t=M6t(t),fs(oU.count(sU(t),t)+(sU(t).getDay()===4),e,2)}function jUt(t){return t.getDay()}function UUt(t,e){return fs(r1t.count(sU(t)-1,t),e,2)}function WUt(t,e){return fs(t.getFullYear()%100,e,2)}function VUt(t,e){return fs((t=M6t(t)).getFullYear()%100,e,2)}function GUt(t,e){return fs(t.getFullYear()%1e4,e,4)}function HUt(t,e){var n=t.getDay();return fs((t=n>=4||n===0?oU(t):oU.ceil(t)).getFullYear()%1e4,e,4)}function YUt(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+fs(e/60|0,"0",2)+fs(e%60,"0",2)}function D6t(t,e){return fs(t.getUTCDate(),e,2)}function qUt(t,e){return fs(t.getUTCHours(),e,2)}function XUt(t,e){return fs(t.getUTCHours()%12||12,e,2)}function KUt(t,e){return fs(1+m6t.count(uU(t),t),e,3)}function R6t(t,e){return fs(t.getUTCMilliseconds(),e,3)}function ZUt(t,e){return R6t(t,e)+"000"}function QUt(t,e){return fs(t.getUTCMonth()+1,e,2)}function JUt(t,e){return fs(t.getUTCMinutes(),e,2)}function tWt(t,e){return fs(t.getUTCSeconds(),e,2)}function eWt(t){var e=t.getUTCDay();return e===0?7:e}function nWt(t,e){return fs(uUt.count(uU(t)-1,t),e,2)}function F6t(t){var e=t.getUTCDay();return e>=4||e===0?aU(t):aU.ceil(t)}function rWt(t,e){return t=F6t(t),fs(aU.count(uU(t),t)+(uU(t).getUTCDay()===4),e,2)}function iWt(t){return t.getUTCDay()}function aWt(t,e){return fs(n1t.count(uU(t)-1,t),e,2)}function oWt(t,e){return fs(t.getUTCFullYear()%100,e,2)}function sWt(t,e){return fs((t=F6t(t)).getUTCFullYear()%100,e,2)}function uWt(t,e){return fs(t.getUTCFullYear()%1e4,e,4)}function lWt(t,e){var n=t.getUTCDay();return fs((t=n>=4||n===0?aU(t):aU.ceil(t)).getUTCFullYear()%1e4,e,4)}function cWt(){return"+0000"}function O6t(){return"%"}function L6t(t){return+t}function $6t(t){return Math.floor(+t/1e3)}function fU(t){let e={};return n=>e[n]||(e[n]=t(n))}function z6t(t){let e=fU(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(r){let a=Xj(r||",");if(a.precision==null){switch(a.precision=12,a.type){case"%":a.precision-=2;break;case"e":a.precision-=1}return function(s,h){return d=>{let g=s(d),b=g.indexOf(h);if(b<0)return g;let _=function(I,R){let z,P=I.lastIndexOf("e");if(P>0)return P;for(P=I.length;--P>R;)if(z=I.charCodeAt(P),z>=48&&z<=57)return P+1}(g,b),E=_<g.length?g.slice(_):"";for(;--_>b;)if(g[_]!=="0"){++_;break}return g.slice(0,_)+E}}(e(a),e(".1f")(1)[1])}return e(a)},formatSpan(r,a,s,h){h=Xj(h??",f");let d=H2(r,a,s),g=Math.max(Math.abs(r),Math.abs(a)),b;if(h.precision==null)switch(h.type){case"s":return isNaN(b=function(_,E){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(BN(E)/3)))-BN(Math.abs(_)))}(d,g))||(h.precision=b),n(h,g);case"":case"e":case"g":case"p":case"r":isNaN(b=function(_,E){return _=Math.abs(_),E=Math.abs(E)-_,Math.max(0,BN(E)-BN(_))+1}(d,g))||(h.precision=b-(h.type==="e"));break;case"f":case"%":isNaN(b=function(_){return Math.max(0,-BN(Math.abs(_)))}(d))||(h.precision=b-2*(h.type==="%"))}return e(h)}}}let o1t,s1t;function P6t(){return o1t=z6t({format:o6t,formatPrefix:s6t})}function B6t(t){return z6t(c6t(t))}function Rrt(t){return arguments.length?o1t=B6t(t):o1t}function j6t(t,e,n){nUt(n=n||{})||Kj("Invalid time multi-format specifier: ".concat(n));let r=e(iU),a=e(rU),s=e(nU),h=e(eU),d=e(tU),g=e(Jj),b=e(Qj),_=e(Zj),E=t(n[Drt]||".%L"),I=t(n[iU]||":%S"),R=t(n[rU]||"%I:%M"),z=t(n[nU]||"%I %p"),P=t(n[eU]||n[Mrt]||"%a %d"),rt=t(n[tU]||"%b %d"),ot=t(n[Jj]||"%B"),at=t(n[Qj]||"%B"),dt=t(n[Zj]||"%Y");return ct=>(r(ct)<ct?E:a(ct)<ct?I:s(ct)<ct?R:h(ct)<ct?z:g(ct)<ct?d(ct)<ct?P:rt:_(ct)<ct?b(ct)<ct?ot:at:dt)(ct)}function U6t(t){let e=fU(t.format),n=fU(t.utcFormat);return{timeFormat:r=>h6t(r)?e(r):j6t(e,oUt,r),utcFormat:r=>h6t(r)?n(r):j6t(n,sUt,r),timeParse:fU(t.parse),utcParse:fU(t.utcParse)}}function W6t(){return s1t=U6t({format:w6t,parse:x6t,utcFormat:k6t,utcParse:S6t})}function V6t(t){return U6t(b6t(t))}function Frt(t){return arguments.length?s1t=V6t(t):s1t}(function(t){cU=b6t(t),w6t=cU.format,x6t=cU.parse,k6t=cU.utcFormat,S6t=cU.utcParse})({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),P6t(),W6t();let u1t=(t,e)=>rUt({},t,e);function hWt(t,e){let n=t?B6t(t):Rrt(),r=e?V6t(e):Frt();return u1t(n,r)}function G6t(t,e){let n=arguments.length;return n&&n!==2&&Kj("defaultLocale expects either zero or two arguments."),n?u1t(Rrt(t),Frt(e)):u1t(Rrt(),Frt())}function dWt(){return P6t(),W6t(),G6t()}function UN(t,e,n){return t.fields=e||[],t.fname=n,t}function fWt(t){return t.length===1?pWt(t[0]):mWt(t)}let pWt=t=>function(e){return e[t]},mWt=t=>{let e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function ih(t){throw Error(t)}function gWt(t){let e=[],n=t.length,r,a,s,h=null,d=0,g="";function b(){e.push(g+t.substring(r,a)),g="",r=a+1}for(t+="",r=a=0;a<n;++a)if(s=t[a],s==="\\")g+=t.substring(r,a++),r=a;else if(s===h)b(),h=null,d=-1;else{if(h)continue;r===d&&s==='"'||r===d&&s==="'"?(r=a+1,h=s):s!=="."||d?s==="["?(a>r&&b(),d=r=a+1):s==="]"&&(d||ih("Access path missing open bracket: "+t),d>0&&b(),d=0,r=a+1):a>r?b():r=a+1}return d&&ih("Access path missing closing bracket: "+t),h&&ih("Access path missing closing quote: "+t),a>r&&(a++,b()),e}function H6t(t,e,n){let r=gWt(t);return t=r.length===1?r[0]:t,UN(fWt(r),[t],t)}H6t("id");let l1t=UN(t=>t,[],"identity"),Ort=(UN(()=>0,[],"zero"),UN(()=>1,[],"one"),UN(()=>!0,[],"true"));UN(()=>!1,[],"false");var jp=Array.isArray;function Lrt(t){return t===Object(t)}function y3(t){return t[t.length-1]}function $rt(t){return t==null||t===""?null:+t}let Y6t=t=>e=>t*Math.exp(e),q6t=t=>e=>Math.log(t*e),X6t=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),K6t=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,zrt=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function Prt(t,e,n,r){let a=n(t[0]),s=n(y3(t)),h=(s-a)*e;return[r(a-h),r(s-h)]}function Brt(t,e,n,r,a){let s=r(t[0]),h=r(y3(t)),d=e!=null?r(e):(s+h)/2;return[a(d+(s-d)*n),a(d+(h-d)*n)]}function jrt(t){return t!=null?jp(t)?t:[t]:[]}function WN(t){return typeof t=="function"}function Urt(t){for(let e,n,r=1,a=arguments.length;r<a;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}let yWt=Object.prototype.hasOwnProperty;function af(t,e){return yWt.call(t,e)}function Z6t(t){return Object.prototype.toString.call(t)==="[object Date]"}function Q6t(t){return typeof t=="number"}function pU(t){return typeof t=="string"}function Wrt(t,e){let n="";for(;--e>=0;)n+=t;return n}function Vrt(t){return jp(t)?"["+t.map(Vrt)+"]":Lrt(t)||pU(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function vWt(t){return t==null||t===""?null:!(!t||t==="false"||t==="0")&&!!t}let bWt=t=>Q6t(t)||Z6t(t)?t:Date.parse(t);function wWt(t,e){return e=e||bWt,t==null||t===""?null:e(t)}function xWt(t){return t==null||t===""?null:t+""}function Grt(t){let e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}let mU="Literal";var v3;(v3={})[1]="Boolean",v3[2]="<end>",v3[3]="Identifier",v3[4]="Keyword",v3[5]="Null",v3[6]="Numeric",v3[7]="Punctuator",v3[8]="String",v3[9]="RegularExpression";var J6t={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function tCt(t){function e(s,h,d){return g=>function(b,_,E,I){let R=t(_[0]);return E&&(R=E+"("+R+")",E.lastIndexOf("new ",0)===0&&(R="("+R+")")),R+"."+b+(I<0?"":I===0?"()":"("+_.slice(1).map(t).join(",")+")")}(s,g,h,d)}let n="new Date",r="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(s){s.length<3&&ih("Missing arguments to clamp function."),s.length>3&&ih("Too many arguments to clamp function.");let h=s.map(t);return"Math.max("+h[1]+", Math.min("+h[2]+","+h[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:a,test:e("test",a),if:function(s){s.length<3&&ih("Missing arguments to if function."),s.length>3&&ih("Too many arguments to if function.");let h=s.map(t);return"("+h[0]+"?"+h[1]+":"+h[2]+")"}}}var eCt,nCt,c1t,h1t,d1t,xl,Up,Pl,q0,OC,rCt,iCt,VN,gU,J4,b3,Hrt=new Mf,Yrt=new Mf,Sy={point:hd,lineStart:hd,lineEnd:hd,polygonStart:function(){Hrt=new Mf,Sy.lineStart=kWt,Sy.lineEnd=SWt},polygonEnd:function(){var t=+Hrt;Yrt.add(t<0?rd+t:t),this.lineStart=this.lineEnd=this.point=hd},sphere:function(){Yrt.add(rd)}};function kWt(){Sy.point=_Wt}function SWt(){aCt(eCt,nCt)}function _Wt(t,e){Sy.point=aCt,eCt=t,nCt=e,c1t=t*=ho,h1t=ga(e=(e*=ho)/2+yI),d1t=ia(e)}function aCt(t,e){var n=(t*=ho)-c1t,r=n>=0?1:-1,a=r*n,s=ga(e=(e*=ho)/2+yI),h=ia(e),d=d1t*h,g=h1t*s+d*ga(a),b=d*r*ia(a);Hrt.add(Sp(b,g)),c1t=t,h1t=s,d1t=h}var yU,qrt,Xrt,Krt,Zrt,Qrt,Jrt,tit,f1t,p1t,m1t,oCt,sCt,zf,Pf,Bf,w3={point:g1t,lineStart:lCt,lineEnd:cCt,polygonStart:function(){w3.point=hCt,w3.lineStart=CWt,w3.lineEnd=EWt,gU=new Mf,Sy.polygonStart()},polygonEnd:function(){Sy.polygonEnd(),w3.point=g1t,w3.lineStart=lCt,w3.lineEnd=cCt,Hrt<0?(xl=-(Pl=180),Up=-(q0=90)):gU>ba?q0=90:gU<-1e-6&&(Up=-90),b3[0]=xl,b3[1]=Pl},sphere:function(){xl=-(Pl=180),Up=-(q0=90)}};function g1t(t,e){J4.push(b3=[xl=t,Pl=t]),e<Up&&(Up=e),e>q0&&(q0=e)}function uCt(t,e){var n=CC([t*ho,e*ho]);if(VN){var r=ON(VN,n),a=ON([r[1],-r[0],0],r);Pnt(a),a=Lnt(a);var s,h=t-OC,d=h>0?1:-1,g=a[0]*yl*d,b=No(h)>180;b^(d*OC<g&&g<d*t)?(s=a[1]*yl)>q0&&(q0=s):b^(d*OC<(g=(g+360)%360-180)&&g<d*t)?(s=-a[1]*yl)<Up&&(Up=s):(e<Up&&(Up=e),e>q0&&(q0=e)),b?t<OC?X0(xl,t)>X0(xl,Pl)&&(Pl=t):X0(t,Pl)>X0(xl,Pl)&&(xl=t):Pl>=xl?(t<xl&&(xl=t),t>Pl&&(Pl=t)):t>OC?X0(xl,t)>X0(xl,Pl)&&(Pl=t):X0(t,Pl)>X0(xl,Pl)&&(xl=t)}else J4.push(b3=[xl=t,Pl=t]);e<Up&&(Up=e),e>q0&&(q0=e),VN=n,OC=t}function lCt(){w3.point=uCt}function cCt(){b3[0]=xl,b3[1]=Pl,w3.point=g1t,VN=null}function hCt(t,e){if(VN){var n=t-OC;gU.add(No(n)>180?n+(n>0?360:-360):n)}else rCt=t,iCt=e;Sy.point(t,e),uCt(t,e)}function CWt(){Sy.lineStart()}function EWt(){hCt(rCt,iCt),Sy.lineEnd(),No(gU)>ba&&(xl=-(Pl=180)),b3[0]=xl,b3[1]=Pl,VN=null}function X0(t,e){return(e-=t)<0?e+360:e}function TWt(t,e){return t[0]-e[0]}function dCt(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var E1={sphere:hd,point:y1t,lineStart:fCt,lineEnd:pCt,polygonStart:function(){E1.lineStart=NWt,E1.lineEnd=MWt},polygonEnd:function(){E1.lineStart=fCt,E1.lineEnd=pCt}};function y1t(t,e){t*=ho;var n=ga(e*=ho);vU(n*ga(t),n*ia(t),ia(e))}function vU(t,e,n){++yU,Xrt+=(t-Xrt)/yU,Krt+=(e-Krt)/yU,Zrt+=(n-Zrt)/yU}function fCt(){E1.point=AWt}function AWt(t,e){t*=ho;var n=ga(e*=ho);zf=n*ga(t),Pf=n*ia(t),Bf=ia(e),E1.point=IWt,vU(zf,Pf,Bf)}function IWt(t,e){t*=ho;var n=ga(e*=ho),r=n*ga(t),a=n*ia(t),s=ia(e),h=Sp(id((h=Pf*s-Bf*a)*h+(h=Bf*r-zf*s)*h+(h=zf*a-Pf*r)*h),zf*r+Pf*a+Bf*s);qrt+=h,Qrt+=h*(zf+(zf=r)),Jrt+=h*(Pf+(Pf=a)),tit+=h*(Bf+(Bf=s)),vU(zf,Pf,Bf)}function pCt(){E1.point=y1t}function NWt(){E1.point=DWt}function MWt(){mCt(oCt,sCt),E1.point=y1t}function DWt(t,e){oCt=t,sCt=e,t*=ho,e*=ho,E1.point=mCt;var n=ga(e);zf=n*ga(t),Pf=n*ia(t),Bf=ia(e),vU(zf,Pf,Bf)}function mCt(t,e){t*=ho;var n=ga(e*=ho),r=n*ga(t),a=n*ia(t),s=ia(e),h=Pf*s-Bf*a,d=Bf*r-zf*s,g=zf*a-Pf*r,b=J$(h,d,g),_=Wd(b),E=b&&-_/b;f1t.add(E*h),p1t.add(E*d),m1t.add(E*g),qrt+=_,Qrt+=_*(zf+(zf=r)),Jrt+=_*(Pf+(Pf=a)),tit+=_*(Bf+(Bf=s)),vU(zf,Pf,Bf)}function eit(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function RWt(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function gCt(t){let e,n,r;function a(s,h,d=0,g=s.length){if(d<g){if(e(h,h)!==0)return g;do{let b=d+g>>>1;n(s[b],h)<0?d=b+1:g=b}while(d<g)}return d}return t.length!==2?(e=eit,n=(s,h)=>eit(t(s),h),r=(s,h)=>t(s)-h):(e=t===eit||t===RWt?t:FWt,n=t,r=t),{left:a,center:function(s,h,d=0,g=s.length){let b=a(s,h,d,g-1);return b>d&&r(s[b-1],h)>-r(s[b],h)?b-1:b},right:function(s,h,d=0,g=s.length){if(d<g){if(e(h,h)!==0)return g;do{let b=d+g>>>1;n(s[b],h)<=0?d=b+1:g=b}while(d<g)}return d}}}function FWt(){return 0}let OWt=gCt(eit),v1t=OWt.right,LWt=(gCt(function(t){return t===null?NaN:+t}).center,v1t);function GN(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function bU(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function tk(){}var HN=.7,YN=1.4285714285714286,qN="\\s*([+-]?\\d+)\\s*",wU="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",_y="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",$Wt=/^#([0-9a-f]{3,8})$/,zWt=new RegExp(`^rgb\\(${qN},${qN},${qN}\\)$`),PWt=new RegExp(`^rgb\\(${_y},${_y},${_y}\\)$`),BWt=new RegExp(`^rgba\\(${qN},${qN},${qN},${wU}\\)$`),jWt=new RegExp(`^rgba\\(${_y},${_y},${_y},${wU}\\)$`),UWt=new RegExp(`^hsl\\(${wU},${_y},${_y}\\)$`),WWt=new RegExp(`^hsla\\(${wU},${_y},${_y},${wU}\\)$`),yCt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function vCt(){return this.rgb().formatHex()}function bCt(){return this.rgb().formatRgb()}function xU(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=$Wt.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?wCt(e):n===3?new Fh(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):n===8?nit(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):n===4?nit(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=zWt.exec(t))?new Fh(e[1],e[2],e[3],1):(e=PWt.exec(t))?new Fh(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=BWt.exec(t))?nit(e[1],e[2],e[3],e[4]):(e=jWt.exec(t))?nit(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=UWt.exec(t))?SCt(e[1],e[2]/100,e[3]/100,1):(e=WWt.exec(t))?SCt(e[1],e[2]/100,e[3]/100,e[4]):yCt.hasOwnProperty(t)?wCt(yCt[t]):t==="transparent"?new Fh(NaN,NaN,NaN,0):null}function wCt(t){return new Fh(t>>16&255,t>>8&255,255&t,1)}function nit(t,e,n,r){return r<=0&&(t=e=n=NaN),new Fh(t,e,n,r)}function b1t(t){return t instanceof tk||(t=xU(t)),t?new Fh((t=t.rgb()).r,t.g,t.b,t.opacity):new Fh}function rit(t,e,n,r){return arguments.length===1?b1t(t):new Fh(t,e,n,r??1)}function Fh(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function xCt(){return`#${$C(this.r)}${$C(this.g)}${$C(this.b)}`}function kCt(){let t=iit(this.opacity);return`${t===1?"rgb(":"rgba("}${LC(this.r)}, ${LC(this.g)}, ${LC(this.b)}${t===1?")":`, ${t})`}`}function iit(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function LC(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function $C(t){return((t=LC(t))<16?"0":"")+t.toString(16)}function SCt(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new T1(t,e,n,r)}function _Ct(t){if(t instanceof T1)return new T1(t.h,t.s,t.l,t.opacity);if(t instanceof tk||(t=xU(t)),!t)return new T1;if(t instanceof T1)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),s=Math.max(e,n,r),h=NaN,d=s-a,g=(s+a)/2;return d?(h=e===s?(n-r)/d+6*(n<r):n===s?(r-e)/d+2:(e-n)/d+4,d/=g<.5?s+a:2-s-a,h*=60):d=g>0&&g<1?0:h,new T1(h,d,g,t.opacity)}function w1t(t,e,n,r){return arguments.length===1?_Ct(t):new T1(t,e,n,r??1)}function T1(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function CCt(t){return(t=(t||0)%360)<0?t+360:t}function ait(t){return Math.max(0,Math.min(1,t||0))}function x1t(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function ECt(t,e,n,r,a){var s=t*t,h=s*t;return((1-3*t+3*s-h)*e+(4-6*s+3*h)*n+(1+3*t+3*s-3*h)*r+h*a)/6}function TCt(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),a=t[r],s=t[r+1],h=r>0?t[r-1]:2*a-s,d=r<e-1?t[r+2]:2*s-a;return ECt((n-r/e)*e,h,a,s,d)}}function ACt(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),a=t[(r+e-1)%e],s=t[r%e],h=t[(r+1)%e],d=t[(r+2)%e];return ECt((n-r/e)*e,a,s,h,d)}}GN(tk,xU,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:vCt,formatHex:vCt,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return _Ct(this).formatHsl()},formatRgb:bCt,toString:bCt}),GN(Fh,rit,bU(tk,{brighter(t){return t=t==null?YN:Math.pow(YN,t),new Fh(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?HN:Math.pow(HN,t),new Fh(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Fh(LC(this.r),LC(this.g),LC(this.b),iit(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xCt,formatHex:xCt,formatHex8:function(){return`#${$C(this.r)}${$C(this.g)}${$C(this.b)}${$C(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:kCt,toString:kCt})),GN(T1,w1t,bU(tk,{brighter(t){return t=t==null?YN:Math.pow(YN,t),new T1(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?HN:Math.pow(HN,t),new T1(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,a=2*n-r;return new Fh(x1t(t>=240?t-240:t+120,a,r),x1t(t,a,r),x1t(t<120?t+240:t-120,a,r),this.opacity)},clamp(){return new T1(CCt(this.h),ait(this.s),ait(this.l),iit(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=iit(this.opacity);return`${t===1?"hsl(":"hsla("}${CCt(this.h)}, ${100*ait(this.s)}%, ${100*ait(this.l)}%${t===1?")":`, ${t})`}`}}));let oit=t=>()=>t;function ICt(t,e){return function(n){return t+n*e}}function sit(t,e){var n=e-t;return n?ICt(t,n>180||n<-180?n-360*Math.round(n/360):n):oit(isNaN(t)?e:t)}function VWt(t){return(t=+t)==1?Oh:function(e,n){return n-e?function(r,a,s){return r=Math.pow(r,s),a=Math.pow(a,s)-r,s=1/s,function(h){return Math.pow(r+h*a,s)}}(e,n,t):oit(isNaN(e)?n:e)}}function Oh(t,e){var n=e-t;return n?ICt(t,n):oit(isNaN(t)?e:t)}let k1t=function t(e){var n=VWt(e);function r(a,s){var h=n((a=rit(a)).r,(s=rit(s)).r),d=n(a.g,s.g),g=n(a.b,s.b),b=Oh(a.opacity,s.opacity);return function(_){return a.r=h(_),a.g=d(_),a.b=g(_),a.opacity=b(_),a+""}}return r.gamma=t,r}(1);function NCt(t){return function(e){var n,r,a=e.length,s=new Array(a),h=new Array(a),d=new Array(a);for(n=0;n<a;++n)r=rit(e[n]),s[n]=r.r||0,h[n]=r.g||0,d[n]=r.b||0;return s=t(s),h=t(h),d=t(d),r.opacity=1,function(g){return r.r=s(g),r.g=h(g),r.b=d(g),r+""}}}var GWt=NCt(TCt),HWt=NCt(ACt);function S1t(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,a=e.slice();return function(s){for(n=0;n<r;++n)a[n]=t[n]*(1-s)+e[n]*s;return a}}function MCt(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function YWt(t,e){return(MCt(e)?S1t:DCt)(t,e)}function DCt(t,e){var n,r=e?e.length:0,a=t?Math.min(r,t.length):0,s=new Array(a),h=new Array(r);for(n=0;n<a;++n)s[n]=uit(t[n],e[n]);for(;n<r;++n)h[n]=e[n];return function(d){for(n=0;n<a;++n)h[n]=s[n](d);return h}}function RCt(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Cy(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function FCt(t,e){var n,r={},a={};for(n in t!==null&&typeof t=="object"||(t={}),e!==null&&typeof e=="object"||(e={}),e)n in t?r[n]=uit(t[n],e[n]):a[n]=e[n];return function(s){for(n in r)a[n]=r[n](s);return a}}var _1t=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,C1t=new RegExp(_1t.source,"g");function OCt(t,e){var n,r,a,s=_1t.lastIndex=C1t.lastIndex=0,h=-1,d=[],g=[];for(t+="",e+="";(n=_1t.exec(t))&&(r=C1t.exec(e));)(a=r.index)>s&&(a=e.slice(s,a),d[h]?d[h]+=a:d[++h]=a),(n=n[0])===(r=r[0])?d[h]?d[h]+=r:d[++h]=r:(d[++h]=null,g.push({i:h,x:Cy(n,r)})),s=C1t.lastIndex;return s<e.length&&(a=e.slice(s),d[h]?d[h]+=a:d[++h]=a),d.length<2?g[0]?function(b){return function(_){return b(_)+""}}(g[0].x):function(b){return function(){return b}}(e):(e=g.length,function(b){for(var _,E=0;E<e;++E)d[(_=g[E]).i]=_.x(b);return d.join("")})}function uit(t,e){var n,r=typeof e;return e==null||r==="boolean"?oit(e):(r==="number"?Cy:r==="string"?(n=xU(e))?(e=n,k1t):OCt:e instanceof xU?k1t:e instanceof Date?RCt:MCt(e)?S1t:Array.isArray(e)?DCt:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?FCt:Cy)(t,e)}function LCt(t,e){e===void 0&&(e=t,t=uit);for(var n=0,r=e.length-1,a=e[0],s=new Array(r<0?0:r);n<r;)s[n]=t(a,a=e[++n]);return function(h){var d=Math.max(0,Math.min(r-1,Math.floor(h*=r)));return s[d](h-d)}}function qWt(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function XWt(t,e){var n=sit(+t,+e);return function(r){var a=n(r);return a-360*Math.floor(a/360)}}function KWt(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var lit,$Ct=180/Math.PI,E1t={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function zCt(t,e,n,r,a,s){var h,d,g;return(h=Math.sqrt(t*t+e*e))&&(t/=h,e/=h),(g=t*n+e*r)&&(n-=t*g,r-=e*g),(d=Math.sqrt(n*n+r*r))&&(n/=d,r/=d,g/=d),t*r<e*n&&(t=-t,e=-e,g=-g,h=-h),{translateX:a,translateY:s,rotate:Math.atan2(e,t)*$Ct,skewX:Math.atan(g)*$Ct,scaleX:h,scaleY:d}}function PCt(t,e,n,r){function a(s){return s.length?s.pop()+" ":""}return function(s,h){var d=[],g=[];return s=t(s),h=t(h),function(b,_,E,I,R,z){if(b!==E||_!==I){var P=R.push("translate(",null,e,null,n);z.push({i:P-4,x:Cy(b,E)},{i:P-2,x:Cy(_,I)})}else(E||I)&&R.push("translate("+E+e+I+n)}(s.translateX,s.translateY,h.translateX,h.translateY,d,g),function(b,_,E,I){b!==_?(b-_>180?_+=360:_-b>180&&(b+=360),I.push({i:E.push(a(E)+"rotate(",null,r)-2,x:Cy(b,_)})):_&&E.push(a(E)+"rotate("+_+r)}(s.rotate,h.rotate,d,g),function(b,_,E,I){b!==_?I.push({i:E.push(a(E)+"skewX(",null,r)-2,x:Cy(b,_)}):_&&E.push(a(E)+"skewX("+_+r)}(s.skewX,h.skewX,d,g),function(b,_,E,I,R,z){if(b!==E||_!==I){var P=R.push(a(R)+"scale(",null,",",null,")");z.push({i:P-4,x:Cy(b,E)},{i:P-2,x:Cy(_,I)})}else E===1&&I===1||R.push(a(R)+"scale("+E+","+I+")")}(s.scaleX,s.scaleY,h.scaleX,h.scaleY,d,g),s=h=null,function(b){for(var _,E=-1,I=g.length;++E<I;)d[(_=g[E]).i]=_.x(b);return d.join("")}}}var ZWt=PCt(function(t){let e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?E1t:zCt(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),QWt=PCt(function(t){return t==null?E1t:(lit||(lit=document.createElementNS("http://www.w3.org/2000/svg","g")),lit.setAttribute("transform",t),(t=lit.transform.baseVal.consolidate())?zCt((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):E1t)},", ",")",")");function BCt(t){return((t=Math.exp(t))+1/t)/2}let JWt=function t(e,n,r){function a(s,h){var d,g,b=s[0],_=s[1],E=s[2],I=h[0],R=h[1],z=h[2],P=I-b,rt=R-_,ot=P*P+rt*rt;if(ot<1e-12)g=Math.log(z/E)/e,d=function(Rt){return[b+Rt*P,_+Rt*rt,E*Math.exp(e*Rt*g)]};else{var at=Math.sqrt(ot),dt=(z*z-E*E+r*ot)/(2*E*n*at),ct=(z*z-E*E-r*ot)/(2*z*n*at),Ct=Math.log(Math.sqrt(dt*dt+1)-dt),Et=Math.log(Math.sqrt(ct*ct+1)-ct);g=(Et-Ct)/e,d=function(Rt){var Ot=Rt*g,Wt=BCt(Ct),jt=E/(n*at)*(Wt*function(Ht){return((Ht=Math.exp(2*Ht))-1)/(Ht+1)}(e*Ot+Ct)-function(Ht){return((Ht=Math.exp(Ht))-1/Ht)/2}(Ct));return[b+jt*P,_+jt*rt,E*Wt/BCt(e*Ot+Ct)]}}return d.duration=1e3*g*e/Math.SQRT2,d}return a.rho=function(s){var h=Math.max(.001,+s),d=h*h;return t(h,d,d*d)},a}(Math.SQRT2,2,4);function jCt(t){return function(e,n){var r=t((e=w1t(e)).h,(n=w1t(n)).h),a=Oh(e.s,n.s),s=Oh(e.l,n.l),h=Oh(e.opacity,n.opacity);return function(d){return e.h=r(d),e.s=a(d),e.l=s(d),e.opacity=h(d),e+""}}}let tVt=jCt(sit);var eVt=jCt(Oh);let UCt=Math.PI/180,WCt=180/Math.PI,VCt=.96422,GCt=1,HCt=.82521,YCt=4/29,nVt=6/29,qCt=.12841854934601665,rVt=.008856451679035631;function XCt(t){if(t instanceof Ey)return new Ey(t.l,t.a,t.b,t.opacity);if(t instanceof x3)return KCt(t);t instanceof Fh||(t=b1t(t));var e,n,r=M1t(t.r),a=M1t(t.g),s=M1t(t.b),h=A1t((.2225045*r+.7168786*a+.0606169*s)/GCt);return r===a&&a===s?e=n=h:(e=A1t((.4360747*r+.3850649*a+.1430804*s)/VCt),n=A1t((.0139322*r+.0971045*a+.7141733*s)/HCt)),new Ey(116*h-16,500*(e-h),200*(h-n),t.opacity)}function T1t(t,e,n,r){return arguments.length===1?XCt(t):new Ey(t,e,n,r??1)}function Ey(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function A1t(t){return t>rVt?Math.pow(t,.3333333333333333):t/qCt+YCt}function I1t(t){return t>nVt?t*t*t:qCt*(t-YCt)}function N1t(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,.4166666666666667)-.055)}function M1t(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function iVt(t){if(t instanceof x3)return new x3(t.h,t.c,t.l,t.opacity);if(t instanceof Ey||(t=XCt(t)),t.a===0&&t.b===0)return new x3(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*WCt;return new x3(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function D1t(t,e,n,r){return arguments.length===1?iVt(t):new x3(t,e,n,r??1)}function x3(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function KCt(t){if(isNaN(t.h))return new Ey(t.l,0,0,t.opacity);var e=t.h*UCt;return new Ey(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function aVt(t,e){var n=Oh((t=T1t(t)).l,(e=T1t(e)).l),r=Oh(t.a,e.a),a=Oh(t.b,e.b),s=Oh(t.opacity,e.opacity);return function(h){return t.l=n(h),t.a=r(h),t.b=a(h),t.opacity=s(h),t+""}}function ZCt(t){return function(e,n){var r=t((e=D1t(e)).h,(n=D1t(n)).h),a=Oh(e.c,n.c),s=Oh(e.l,n.l),h=Oh(e.opacity,n.opacity);return function(d){return e.h=r(d),e.c=a(d),e.l=s(d),e.opacity=h(d),e+""}}}GN(Ey,T1t,bU(tk,{brighter(t){return new Ey(this.l+18*(t??1),this.a,this.b,this.opacity)},darker(t){return new Ey(this.l-18*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Fh(N1t(3.1338561*(e=VCt*I1t(e))-1.6168667*(t=GCt*I1t(t))-.4906146*(n=HCt*I1t(n))),N1t(-.9787684*e+1.9161415*t+.033454*n),N1t(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),GN(x3,D1t,bU(tk,{brighter(t){return new x3(this.h,this.c,this.l+18*(t??1),this.opacity)},darker(t){return new x3(this.h,this.c,this.l-18*(t??1),this.opacity)},rgb(){return KCt(this).rgb()}}));let oVt=ZCt(sit);var sVt=ZCt(Oh),uVt=-.14861,lVt=1.78277,QCt=-.29227,JCt=-.90649,R1t=1.97294,cVt=-1.7884503806,hVt=3.5172982438,dVt=-.6557636667999999;function F1t(t,e,n,r){return arguments.length===1?function(a){if(a instanceof zC)return new zC(a.h,a.s,a.l,a.opacity);a instanceof Fh||(a=b1t(a));var s=a.r/255,h=a.g/255,d=a.b/255,g=(dVt*d+cVt*s-hVt*h)/-5.9615122912,b=d-g,_=(R1t*(h-g)-QCt*b)/JCt,E=Math.sqrt(_*_+b*b)/(R1t*g*(1-g)),I=E?Math.atan2(_,b)*WCt-120:NaN;return new zC(I<0?I+360:I,E,g,a.opacity)}(t):new zC(t,e,n,r??1)}function zC(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function t9t(t){return function e(n){function r(a,s){var h=t((a=F1t(a)).h,(s=F1t(s)).h),d=Oh(a.s,s.s),g=Oh(a.l,s.l),b=Oh(a.opacity,s.opacity);return function(_){return a.h=h(_),a.s=d(_),a.l=g(Math.pow(_,n)),a.opacity=b(_),a+""}}return n=+n,r.gamma=e,r}(1)}GN(zC,F1t,bU(tk,{brighter(t){return t=t==null?YN:Math.pow(YN,t),new zC(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?HN:Math.pow(HN,t),new zC(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*UCt,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),a=Math.sin(t);return new Fh(255*(e+n*(uVt*r+lVt*a)),255*(e+n*(QCt*r+JCt*a)),255*(e+n*(R1t*r)),this.opacity)}}));let fVt=t9t(sit);var pVt=t9t(Oh);function mVt(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}let XN="year",kU="quarter",PC="month",SU="week",KN="date",_U="day",CU="dayofyear",EU="hours",TU="minutes",cit="seconds",hit="milliseconds",O1t=[XN,kU,PC,SU,KN,_U,CU,EU,TU,cit,hit].reduce((t,e,n)=>(t[e]=1+n,t),{}),gVt={[XN]:"%Y ",[kU]:"Q%q ",[PC]:"%b ",[KN]:"%d ",[SU]:"W%U ",[_U]:"%a ",[CU]:"%j ",[EU]:"%H:00",[TU]:"00:%M",[cit]:":%S",[hit]:".%L",[`${XN}-${PC}`]:"%Y-%m ",[`${XN}-${PC}-${KN}`]:"%Y-%m-%d ",[`${EU}-${TU}`]:"%H:%M"},AU=new Date;function e9t(t){return AU.setFullYear(t),AU.setMonth(0),AU.setDate(1),AU.setHours(0,0,0,0),AU}function yVt(t){return Ds.count(e9t(t.getFullYear())-1,t)}function vVt(t){return Hl.count(e9t(t.getFullYear())-1,t)}function bVt(t){let e=Date.UTC(t.getUTCFullYear(),0,1);return Ss.count(e-1,t)}function wVt(t){let e=Date.UTC(t.getUTCFullYear(),0,1);return Td.count(e-1,t)}let xVt={[XN]:gh,[kU]:tl.every(3),[PC]:tl,[SU]:Hl,[KN]:Ds,[_U]:Ds,[CU]:Ds,[EU]:ip,[TU]:lc,[cit]:Il,[hit]:bf},kVt={[XN]:Uc,[kU]:Kh.every(3),[PC]:Kh,[SU]:Td,[KN]:Ss,[_U]:Ss,[CU]:Ss,[EU]:hm,[TU]:Ag,[cit]:Il,[hit]:bf};function n9t(t){return xVt[t]}function r9t(t){return kVt[t]}function i9t(t,e,n){return t?t.offset(e,n):void 0}function a9t(t,e,n,r){return t?t.range(e,n,r):void 0}function o9t(t,e,n){let r=t-e+2*n;return t?r>0?r:1:0}let L1t="linear",ZN="log",$1t="pow",z1t="sqrt",P1t="symlog",SVt="time",_Vt="utc",QN="sequential",IU="diverging",s9t="quantile",CVt="quantize",EVt="threshold",Lh="continuous",dit="discrete",fit="discretizing",A1="interpolating",u9t="temporal";function B1t(){let t=jv().unknown(void 0),e=t.domain,n=t.range,r,a,s=[0,1],h=!1,d=0,g=0,b=.5;function _(){let E=e().length,I=s[1]<s[0],R=s[1-I],z=o9t(E,d,g),P=s[I-0];r=(R-P)/(z||1),h&&(r=Math.floor(r)),P+=(R-P-r*(E-d))*b,a=r*(1-d),h&&(P=Math.round(P),a=Math.round(a));let rt=function(ot,at,dt){ot=+ot,at=+at,dt=(Ct=arguments.length)<2?(at=ot,ot=0,1):Ct<3?1:+dt;for(var ct=-1,Ct=0|Math.max(0,Math.ceil((at-ot)/dt)),Et=new Array(Ct);++ct<Ct;)Et[ct]=ot+ct*dt;return Et}(E).map(ot=>P+r*ot);return n(I?rt.reverse():rt)}return delete t.unknown,t.domain=function(E){return arguments.length?(e(E),_()):e()},t.range=function(E){return arguments.length?(s=[+E[0],+E[1]],_()):s.slice()},t.rangeRound=function(E){return s=[+E[0],+E[1]],h=!0,_()},t.bandwidth=function(){return a},t.step=function(){return r},t.round=function(E){return arguments.length?(h=!!E,_()):h},t.padding=function(E){return arguments.length?(g=Math.max(0,Math.min(1,E)),d=g,_()):d},t.paddingInner=function(E){return arguments.length?(d=Math.max(0,Math.min(1,E)),_()):d},t.paddingOuter=function(E){return arguments.length?(g=Math.max(0,Math.min(1,E)),_()):g},t.align=function(E){return arguments.length?(b=Math.max(0,Math.min(1,E)),_()):b},t.invertRange=function(E){if(E[0]==null||E[1]==null)return;let I=s[1]<s[0],R=I?n().reverse():n(),z=R.length-1,P,rt,ot,at=+E[0],dt=+E[1];return at!=at||dt!=dt||(dt<at&&(ot=at,at=dt,dt=ot),dt<R[0]||at>s[1-I])?void 0:(P=Math.max(0,v1t(R,at)-1),rt=at===dt?P:v1t(R,dt)-1,at-R[P]>a+1e-10&&++P,I&&(ot=P,P=z-rt,rt=z-ot),P>rt?void 0:e().slice(P,rt+1))},t.invert=function(E){let I=t.invertRange([E,E]);return I&&I[0]},t.copy=function(){return B1t().domain(e()).range(s).round(h).paddingInner(d).paddingOuter(g).align(b)},_()}function l9t(t){let e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return l9t(e())},t}var TVt=Array.prototype.map;let AVt=Array.prototype.slice,j1t=new Map,IVt=Symbol("vega_scale");function NVt(t,e,n){let r=function(){let a=e();return a.invertRange||(a.invertRange=a.invert?function(s){return function(h){let d,g=h[0],b=h[1];return b<g&&(d=g,g=b,b=d),[s.invert(g),s.invert(b)]}}(a):a.invertExtent?function(s){return function(h){let d=s.range(),g,b,_,E,I=h[0],R=h[1],z=-1;for(R<I&&(b=I,I=R,R=b),_=0,E=d.length;_<E;++_)d[_]>=I&&d[_]<=R&&(z<0&&(z=_),g=_);if(!(z<0))return I=s.invertExtent(d[z]),R=s.invertExtent(d[g]),[I[0]===void 0?I[1]:I[0],R[1]===void 0?R[0]:R[1]]}}(a):void 0),a.type=t,function(s){return s[IVt]=!0,s}(a)};return r.metadata=Grt(jrt(n)),r}function Ys(t,e,n){return arguments.length>1?(j1t.set(t,NVt(t,e,n)),this):function(r){return j1t.has(r)}(t)?j1t.get(t):void 0}Ys("identity",Ii),Ys(L1t,AS,Lh),Ys(ZN,xf,[Lh,ZN]),Ys($1t,cp,Lh),Ys(z1t,JF,Lh),Ys(P1t,aT,Lh),Ys(SVt,oT,[Lh,u9t]),Ys(_Vt,sT,[Lh,u9t]),Ys(QN,Bv,[Lh,A1]),Ys(`${QN}-${L1t}`,Bv,[Lh,A1]),Ys(`${QN}-${ZN}`,lT,[Lh,A1,ZN]),Ys(`${QN}-${$1t}`,NS,[Lh,A1]),Ys(`${QN}-${z1t}`,nO,[Lh,A1]),Ys(`${QN}-${P1t}`,IS,[Lh,A1]),Ys(`${IU}-${L1t}`,cT,[Lh,A1]),Ys(`${IU}-${ZN}`,hT,[Lh,A1,ZN]),Ys(`${IU}-${$1t}`,Zw,[Lh,A1]),Ys(`${IU}-${z1t}`,dT,[Lh,A1]),Ys(`${IU}-${P1t}`,DS,[Lh,A1]),Ys(s9t,fT,[fit,s9t]),Ys(CVt,RS,fit),Ys(EVt,pT,fit),Ys("bin-ordinal",function t(){let e=[],n=[];function r(a){return a==null||a!=a?void 0:n[(LWt(e,a)-1)%n.length]}return r.domain=function(a){return arguments.length?(e=function(s){return TVt.call(s,$rt)}(a),r):e.slice()},r.range=function(a){return arguments.length?(n=AVt.call(a),r):n.slice()},r.tickFormat=function(a,s){return eT(e[0],y3(e),a??10,s)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r},[dit,fit]),Ys("ordinal",jv,dit),Ys("band",B1t,dit),Ys("point",function(){return l9t(B1t().paddingInner(1))},dit);let MVt=["clamp","base","constant","exponent"];function DVt(t,e,n){return LCt(function(r,a){let s=_t[function(h){return"interpolate"+h.toLowerCase().split("-").map(d=>d[0].toUpperCase()+d.slice(1)).join("")}(r)];return a!=null&&s&&s.gamma?s.gamma(a):s}("rgb",n),t)}function RVt(t,e,n){let r=n-e,a,s,h;return r&&Number.isFinite(r)?(a=(s=t.type).indexOf("-"),s=a<0?s:s.slice(a+1),h=Ys(s)().domain([e,n]).range([0,1]),MVt.forEach(g=>t[g]?h[g](t[g]()):0),h):WN(d=.5)?d:()=>d;var d}function c9t(t){if(jp(t))return t;let e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function h9t(t,e){for(let n in t)FVt(n,e(t[n]))}let d9t={};function FVt(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(d9t[t]=e,this):d9t[t]}h9t({accent:IT,category10:MO,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:DO,observable10:RO,paired:FO,pastel1:OO,pastel2:LO,set1:$O,set2:zO,set3:PO,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"},c9t),h9t({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},t=>DVt(c9t(t)));function OVt(t){return t&&t.gradient}let f9t={basis:{curve:XH},"basis-closed":{curve:ZH},"basis-open":{curve:JH},bundle:{curve:eY,tension:"beta",value:.85},cardinal:{curve:nY,tension:"tension",value:0},"cardinal-open":{curve:lS,tension:"tension",value:0},"cardinal-closed":{curve:EF,tension:"tension",value:0},"catmull-rom":{curve:hS,tension:"alpha",value:.5},"catmull-rom-closed":{curve:aY,tension:"alpha",value:.5},"catmull-rom-open":{curve:sY,tension:"alpha",value:.5},linear:{curve:BE},"linear-closed":{curve:cY},monotone:{horizontal:yY,vertical:gY},natural:{curve:wY},step:{curve:IF},"step-after":{curve:WE},"step-before":{curve:UE}};function p9t(t,e,n){var r=af(f9t,t)&&f9t[t],a=null;return r&&(a=r.curve||r[e||"vertical"],r.tension&&n!=null&&(a=a[r.tension](n))),a}let LVt={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},$Vt=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,zVt=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,PVt=/^((\s+,?\s*)|(,\s*))/,BVt=/^[01]/;function U1t(t){let e=[];return(t.match($Vt)||[]).forEach(n=>{let r=n[0],a=r.toLowerCase(),s=LVt[a],h=function(g,b,_){let E=[];for(let I=0;b&&I<_.length;)for(let R=0;R<b;++R){let z=g!=="a"||R!==3&&R!==4?zVt:BVt,P=_.slice(I).match(z);if(P===null)throw Error("Invalid SVG path, incorrect parameter type");I+=P[0].length,E.push(+P[0]);let rt=_.slice(I).match(PVt);rt!==null&&(I+=rt[0].length)}return E}(a,s,n.slice(1).trim()),d=h.length;if(d<s||d&&d%s!=0)throw Error("Invalid SVG path, incorrect parameter count");if(e.push([r,...h.slice(0,s)]),d!==s){a==="m"&&(r=r==="M"?"L":"l");for(let g=s;g<d;g+=s)e.push([r,...h.slice(g,g+s)])}}),e}let ek=Math.PI/180,BC=Math.PI/2,Ty=2*Math.PI,JN=Math.sqrt(3)/2;var W1t={},V1t={},m9t=[].join;function jVt(t){let e=m9t.call(t);if(V1t[e])return V1t[e];var n=t[0],r=t[1],a=t[2],s=t[3],h=t[4],d=t[5],g=t[6],b=t[7];let _=b*h,E=-g*d,I=g*h,R=b*d,z=Math.cos(a),P=Math.sin(a),rt=Math.cos(s),ot=Math.sin(s),at=.5*(s-a),dt=Math.sin(.5*at),ct=8/3*dt*dt/Math.sin(at),Ct=n+z-ct*P,Et=r+P+ct*z,Rt=n+rt,Ot=r+ot,Wt=Rt+ct*ot,jt=Ot-ct*rt;return V1t[e]=[_*Ct+E*Et,I*Ct+R*Et,_*Wt+E*jt,I*Wt+R*jt,_*Rt+E*Ot,I*Rt+R*Ot]}let tg=["l",0,0,0,0,0,0,0];function UVt(t,e,n){let r=tg[0]=t[0];if(r==="a"||r==="A")tg[1]=e*t[1],tg[2]=n*t[2],tg[3]=t[3],tg[4]=t[4],tg[5]=t[5],tg[6]=e*t[6],tg[7]=n*t[7];else if(r==="h"||r==="H")tg[1]=e*t[1];else if(r==="v"||r==="V")tg[1]=n*t[1];else for(var a=1,s=t.length;a<s;++a)tg[a]=(a%2==1?e:n)*t[a];return tg}function pit(t,e,n,r,a,s){var h,d,g,b,_,E=null,I=0,R=0,z=0,P=0,rt=0,ot=0;n==null&&(n=0),r==null&&(r=0),a==null&&(a=1),s==null&&(s=a),t.beginPath&&t.beginPath();for(var at=0,dt=e.length;at<dt;++at){switch(h=e[at],a===1&&s===1||(h=UVt(h,a,s)),h[0]){case"l":I+=h[1],R+=h[2],t.lineTo(I+n,R+r);break;case"L":I=h[1],R=h[2],t.lineTo(I+n,R+r);break;case"h":I+=h[1],t.lineTo(I+n,R+r);break;case"H":I=h[1],t.lineTo(I+n,R+r);break;case"v":R+=h[1],t.lineTo(I+n,R+r);break;case"V":R=h[1],t.lineTo(I+n,R+r);break;case"m":rt=I+=h[1],ot=R+=h[2],t.moveTo(I+n,R+r);break;case"M":rt=I=h[1],ot=R=h[2],t.moveTo(I+n,R+r);break;case"c":d=I+h[5],g=R+h[6],z=I+h[3],P=R+h[4],t.bezierCurveTo(I+h[1]+n,R+h[2]+r,z+n,P+r,d+n,g+r),I=d,R=g;break;case"C":I=h[5],R=h[6],z=h[3],P=h[4],t.bezierCurveTo(h[1]+n,h[2]+r,z+n,P+r,I+n,R+r);break;case"s":d=I+h[3],g=R+h[4],z=2*I-z,P=2*R-P,t.bezierCurveTo(z+n,P+r,I+h[1]+n,R+h[2]+r,d+n,g+r),z=I+h[1],P=R+h[2],I=d,R=g;break;case"S":d=h[3],g=h[4],z=2*I-z,P=2*R-P,t.bezierCurveTo(z+n,P+r,h[1]+n,h[2]+r,d+n,g+r),I=d,R=g,z=h[1],P=h[2];break;case"q":d=I+h[3],g=R+h[4],z=I+h[1],P=R+h[2],t.quadraticCurveTo(z+n,P+r,d+n,g+r),I=d,R=g;break;case"Q":d=h[3],g=h[4],t.quadraticCurveTo(h[1]+n,h[2]+r,d+n,g+r),I=d,R=g,z=h[1],P=h[2];break;case"t":d=I+h[1],g=R+h[2],E[0].match(/[QqTt]/)===null?(z=I,P=R):E[0]==="t"?(z=2*I-b,P=2*R-_):E[0]==="q"&&(z=2*I-z,P=2*R-P),b=z,_=P,t.quadraticCurveTo(z+n,P+r,d+n,g+r),R=g,z=(I=d)+h[1],P=R+h[2];break;case"T":d=h[1],g=h[2],z=2*I-z,P=2*R-P,t.quadraticCurveTo(z+n,P+r,d+n,g+r),I=d,R=g;break;case"a":g9t(t,I+n,R+r,[h[1],h[2],h[3],h[4],h[5],h[6]+I+n,h[7]+R+r]),I+=h[6],R+=h[7];break;case"A":g9t(t,I+n,R+r,[h[1],h[2],h[3],h[4],h[5],h[6]+n,h[7]+r]),I=h[6],R=h[7];break;case"z":case"Z":I=rt,R=ot,t.closePath()}E=h}}function g9t(t,e,n,r){let a=function(s,h,d,g,b,_,E,I,R){let z=m9t.call(arguments);if(W1t[z])return W1t[z];let P=E*ek,rt=Math.sin(P),ot=Math.cos(P),at=ot*(I-s)*.5+rt*(R-h)*.5,dt=ot*(R-h)*.5-rt*(I-s)*.5,ct=at*at/((d=Math.abs(d))*d)+dt*dt/((g=Math.abs(g))*g);ct>1&&(ct=Math.sqrt(ct),d*=ct,g*=ct);let Ct=ot/d,Et=rt/d,Rt=-rt/g,Ot=ot/g,Wt=Ct*I+Et*R,jt=Rt*I+Ot*R,Ht=Ct*s+Et*h,Vt=Rt*s+Ot*h,fe=1/((Ht-Wt)*(Ht-Wt)+(Vt-jt)*(Vt-jt))-.25;fe<0&&(fe=0);let se=Math.sqrt(fe);_==b&&(se=-se);let he=.5*(Wt+Ht)-se*(Vt-jt),_e=.5*(jt+Vt)+se*(Ht-Wt),Ve=Math.atan2(jt-_e,Wt-he),gn=Math.atan2(Vt-_e,Ht-he)-Ve;gn<0&&_===1?gn+=Ty:gn>0&&_===0&&(gn-=Ty);let $n=Math.ceil(Math.abs(gn/(BC+.001))),Gn=[];for(let qe=0;qe<$n;++qe){let tr=Ve+qe*gn/$n,er=Ve+(qe+1)*gn/$n;Gn[qe]=[he,_e,tr,er,d,g,rt,ot]}return W1t[z]=Gn}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let s=0;s<a.length;++s){let h=jVt(a[s]);t.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5])}}let y9t=.5773502691896257,v9t={circle:{draw:function(t,e){let n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,Ty)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){let n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,a=n/2.5,s=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-s),t.lineTo(a,-s),t.lineTo(0,-n),t.lineTo(-a,-s),t.lineTo(-r,-s),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=JN*n,a=r-n*y9t,s=n/4;t.moveTo(0,-r-a),t.lineTo(-s,r-a),t.lineTo(s,r-a),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=JN*n,a=r-n*y9t;t.moveTo(0,-r-a),t.lineTo(-n,r-a),t.lineTo(n,r-a),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=JN*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=JN*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=JN*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=JN*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){let n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function WVt(t){return af(v9t,t)?v9t[t]:function(e){if(!af(G1t,e)){let n=U1t(e);G1t[e]={draw:function(r,a){pit(r,n,0,0,Math.sqrt(a)/2)}}}return G1t[e]}(t)}var G1t={};let nk=.448084975506;function VVt(t){return t.x}function GVt(t){return t.y}function HVt(t){return t.width}function YVt(t){return t.height}function k3(t){return typeof t=="function"?t:()=>+t}function mit(t,e,n){return Math.max(e,Math.min(t,n))}function NU(t,e){return t??e}let MU=t=>t.x||0,DU=t=>t.y||0,git=t=>t.defined!==!1,qVt=Bw().startAngle(t=>t.startAngle||0).endAngle(t=>t.endAngle||0).padAngle(t=>t.padAngle||0).innerRadius(t=>t.innerRadius||0).outerRadius(t=>t.outerRadius||0).cornerRadius(t=>t.cornerRadius||0),XVt=gS().x(MU).y1(DU).y0(t=>(t.y||0)+(t.height||0)).defined(git),KVt=gS().y(DU).x1(MU).x0(t=>(t.x||0)+(t.width||0)).defined(git),ZVt=FF().x(MU).y(DU).defined(git),QVt=function(){var t=VVt,e=GVt,n=HVt,r=YVt,a=k3(0),s=a,h=a,d=a,g=null;function b(_,E,I){var R,z=E??+t.call(this,_),P=I??+e.call(this,_),rt=+n.call(this,_),ot=+r.call(this,_),at=Math.min(rt,ot)/2,dt=mit(+a.call(this,_),0,at),ct=mit(+s.call(this,_),0,at),Ct=mit(+h.call(this,_),0,at),Et=mit(+d.call(this,_),0,at);if(g||(g=R=Fv()),dt<=0&&ct<=0&&Ct<=0&&Et<=0)g.rect(z,P,rt,ot);else{var Rt=z+rt,Ot=P+ot;g.moveTo(z+dt,P),g.lineTo(Rt-ct,P),g.bezierCurveTo(Rt-nk*ct,P,Rt,P+nk*ct,Rt,P+ct),g.lineTo(Rt,Ot-Et),g.bezierCurveTo(Rt,Ot-nk*Et,Rt-nk*Et,Ot,Rt-Et,Ot),g.lineTo(z+Ct,Ot),g.bezierCurveTo(z+nk*Ct,Ot,z,Ot-nk*Ct,z,Ot-Ct),g.lineTo(z,P+dt),g.bezierCurveTo(z,P+nk*dt,z+nk*dt,P,z+dt,P),g.closePath()}if(R)return g=null,R+""||null}return b.x=function(_){return arguments.length?(t=k3(_),b):t},b.y=function(_){return arguments.length?(e=k3(_),b):e},b.width=function(_){return arguments.length?(n=k3(_),b):n},b.height=function(_){return arguments.length?(r=k3(_),b):r},b.cornerRadius=function(_,E,I,R){return arguments.length?(a=k3(_),s=E!=null?k3(E):a,d=I!=null?k3(I):a,h=R!=null?k3(R):s,b):a},b.context=function(_){return arguments.length?(g=_??null,b):g},b}().x(MU).y(DU).width(t=>t.width||0).height(t=>t.height||0).cornerRadius(t=>NU(t.cornerRadiusTopLeft,t.cornerRadius)||0,t=>NU(t.cornerRadiusTopRight,t.cornerRadius)||0,t=>NU(t.cornerRadiusBottomRight,t.cornerRadius)||0,t=>NU(t.cornerRadiusBottomLeft,t.cornerRadius)||0),JVt=kY().type(t=>WVt(t.shape||"circle")).size(t=>NU(t.size,64)),tGt=function(){var t,e,n,r,a,s,h,d,g=null;function b(E,I,R){let z=R/2;if(a){var P=h-I,rt=E-s;if(P||rt){var ot=Math.hypot(P,rt),at=(P/=ot)*d,dt=(rt/=ot)*d,ct=Math.atan2(rt,P);g.moveTo(s-at,h-dt),g.lineTo(E-P*z,I-rt*z),g.arc(E,I,z,ct-Math.PI,ct),g.lineTo(s+at,h+dt),g.arc(s,h,d,ct,ct+Math.PI)}else g.arc(E,I,z,0,Ty);g.closePath()}else a=1;s=E,h=I,d=z}function _(E){var I,R,z,P=E.length,rt=!1;for(g==null&&(g=z=Fv()),I=0;I<=P;++I)!(I<P&&r(R=E[I],I,E))===rt&&(rt=!rt)&&(a=0),rt&&b(+t(R,I,E),+e(R,I,E),+n(R,I,E));if(z)return g=null,z+""||null}return _.x=function(E){return arguments.length?(t=E,_):t},_.y=function(E){return arguments.length?(e=E,_):e},_.size=function(E){return arguments.length?(n=E,_):n},_.defined=function(E){return arguments.length?(r=E,_):r},_.context=function(E){return arguments.length?(g=E??null,_):g},_}().x(MU).y(DU).defined(git).size(t=>t.size||1);function H1t(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function tM(t,e,n,r){return QVt.context(t)(e,n,r)}var eGt=1;function nGt(t,e,n){var r=e.clip,a=t._defs,s=e.clip_id||(e.clip_id="clip"+eGt++),h=a.clipping[s]||(a.clipping[s]={id:s});return WN(r)?h.path=r(null):H1t(n)?h.path=tM(null,n,0,0):(h.width=n.width||0,h.height=n.height||0),"url(#"+s+")"}function rk(t){this.clear(),t&&this.union(t)}function b9t(t){this.mark=t,this.bounds=this.bounds||new rk}function rGt(t){b9t.call(this,t),this.items=this.items||[]}rk.prototype={clone(){return new rk(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){let r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:a,x2:s,y2:h}=this,d=Math.cos(t),g=Math.sin(t),b=e-e*d+n*g,_=n-e*g-n*d;return[d*r-g*a+b,g*r+d*a+_,d*r-g*h+b,g*r+d*h+_,d*s-g*a+b,g*s+d*a+_,d*s-g*h+b,g*s+d*h+_]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},function(t,e,n){let r=t.prototype=Object.create(e.prototype);Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),Urt(r,n)}(rGt,b9t);function eM(t,e,n){if(e.stroke&&e.opacity!==0&&e.strokeOpacity!==0){let r=e.strokeWidth!=null?+e.strokeWidth:1;t.expand(r+(n?function(a,s){return a.strokeJoin&&a.strokeJoin!=="miter"?0:s}(e,r):0))}return t}let iGt=Ty-1e-8,yit,vit,bit,jC,Y1t,wit,q1t,X1t,ik=(t,e)=>yit.add(t,e),xit=(t,e)=>ik(vit=t,bit=e),w9t=t=>ik(t,yit.y1),x9t=t=>ik(yit.x1,t),UC=(t,e)=>Y1t*t+q1t*e,WC=(t,e)=>wit*t+X1t*e,K1t=(t,e)=>ik(UC(t,e),WC(t,e)),Z1t=(t,e)=>xit(UC(t,e),WC(t,e));function Q1t(t,e){return yit=t,e?(jC=e*ek,Y1t=X1t=Math.cos(jC),wit=Math.sin(jC),q1t=-wit):(Y1t=X1t=1,jC=wit=q1t=0),aGt}let aGt={beginPath(){},closePath(){},moveTo:Z1t,lineTo:Z1t,rect(t,e,n,r){jC?(K1t(t+n,e),K1t(t+n,e+r),K1t(t,e+r),Z1t(t,e)):(ik(t+n,e+r),xit(t,e))},quadraticCurveTo(t,e,n,r){let a=UC(t,e),s=WC(t,e),h=UC(n,r),d=WC(n,r);k9t(vit,a,h,w9t),k9t(bit,s,d,x9t),xit(h,d)},bezierCurveTo(t,e,n,r,a,s){let h=UC(t,e),d=WC(t,e),g=UC(n,r),b=WC(n,r),_=UC(a,s),E=WC(a,s);S9t(vit,h,g,_,w9t),S9t(bit,d,b,E,x9t),xit(_,E)},arc(t,e,n,r,a,s){if(r+=jC,a+=jC,vit=n*Math.cos(a)+t,bit=n*Math.sin(a)+e,Math.abs(a-r)>iGt)ik(t-n,e-n),ik(t+n,e+n);else{let h=b=>ik(n*Math.cos(b)+t,n*Math.sin(b)+e),d,g;if(h(r),h(a),a!==r)if((r%=Ty)<0&&(r+=Ty),(a%=Ty)<0&&(a+=Ty),a<r&&(s=!s,d=r,r=a,a=d),s)for(a-=Ty,d=r-r%BC,g=0;g<4&&d>a;++g,d-=BC)h(d);else for(d=r-r%BC+BC,g=0;g<4&&d<a;++g,d+=BC)h(d)}}};function k9t(t,e,n,r){let a=(t-e)/(t+n-2*e);0<a&&a<1&&r(t+(e-t)*a)}function S9t(t,e,n,r,a){let s=r-t+3*e-3*n,h=t+n-2*e,d=t-e,g,b=0,_=0;Math.abs(s)>1e-14?(g=h*h+d*s,g>=0&&(g=Math.sqrt(g),b=(-h+g)/s,_=(-h-g)/s)):b=.5*d/h,0<b&&b<1&&a(_9t(b,t,e,n,r)),0<_&&_<1&&a(_9t(_,t,e,n,r))}function _9t(t,e,n,r,a){let s=1-t,h=s*s,d=t*t;return h*s*e+3*h*t*n+3*s*d*r+d*t*a}var ak=(ak=lp(1,1))?ak.getContext("2d"):null;let J1t=new rk;function C9t(t){return function(e,n){if(!ak)return!0;t(ak,e),J1t.clear().union(e.bounds).intersect(n).round();let{x1:r,y1:a,x2:s,y2:h}=J1t;for(let d=a;d<=h;++d)for(let g=r;g<=s;++g)if(ak.isPointInPath(g,d))return!0;return!1}}function E9t(t,e){return e.contains(t.x||0,t.y||0)}function T9t(t,e){let n=t.x||0,r=t.y||0,a=t.width||0,s=t.height||0;return e.intersects(J1t.set(n,r,n+a,r+s))}function RU(t,e,n,r,a){let{x1:s,y1:h,x2:d,y2:g}=t,b=r-e,_=a-n,E,I,R,z,P=0,rt=1;for(z=0;z<4;++z){if(z===0&&(E=-b,I=-(s-e)),z===1&&(E=b,I=d-e),z===2&&(E=-_,I=-(h-n)),z===3&&(E=_,I=g-n),Math.abs(E)<1e-10&&I<0)return!1;if(R=I/E,E<0){if(R>rt)return!1;R>P&&(P=R)}else if(E>0){if(R<P)return!1;R<rt&&(rt=R)}}return!0}function nM(t,e){t.globalCompositeOperation=e.blend||"source-over"}function I1(t,e){return t??e}function A9t(t,e){let n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function I9t(t,e,n){return OVt(n)?function(r,a,s){let h=s.width(),d=s.height(),g;if(a.gradient==="radial")g=r.createRadialGradient(s.x1+I1(a.x1,.5)*h,s.y1+I1(a.y1,.5)*d,Math.max(h,d)*I1(a.r1,0),s.x1+I1(a.x2,.5)*h,s.y1+I1(a.y2,.5)*d,Math.max(h,d)*I1(a.r2,.5));else{let b=I1(a.x1,0),_=I1(a.y1,0),E=I1(a.x2,1),I=I1(a.y2,0);if(b!==E&&_!==I&&h!==d){let R=lp(Math.ceil(h),Math.ceil(d)),z=R.getContext("2d");return z.scale(h,d),z.fillStyle=A9t(z.createLinearGradient(b,_,E,I),a.stops),z.fillRect(0,0,h,d),r.createPattern(R,"no-repeat")}g=r.createLinearGradient(s.x1+b*h,s.y1+_*d,s.x1+E*h,s.y1+I*d)}return A9t(g,a.stops)}(t,n,e.bounds):n}function kit(t,e,n){return(n*=e.fillOpacity==null?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=I9t(t,e,e.fill),!0)}var oGt=[];function rM(t,e,n){var r=(r=e.strokeWidth)!=null?r:1;return!(r<=0)&&(n*=e.strokeOpacity==null?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=I9t(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||oGt),t.lineDashOffset=e.strokeDashOffset||0),!0)}function sGt(t,e){return t.zindex-e.zindex||t.index-e.index}function N9t(t){if(!t.zdirty)return t.zitems;var e,n,r,a=t.items,s=[];for(n=0,r=a.length;n<r;++n)(e=a[n]).index=n,e.zindex&&s.push(e);return t.zdirty=!1,t.zitems=s.sort(sGt)}function iM(t,e){var n,r,a=t.items;if(!a||!a.length)return;let s=N9t(t);if(s&&s.length){for(n=0,r=a.length;n<r;++n)a[n].zindex||e(a[n]);a=s}for(n=0,r=a.length;n<r;++n)e(a[n])}function t2t(t,e){var n,r,a=t.items;if(!a||!a.length)return null;let s=N9t(t);for(s&&s.length&&(a=s),r=a.length;--r>=0;)if(n=e(a[r]))return n;if(a===s){for(r=(a=t.items).length;--r>=0;)if(!a[r].zindex&&(n=e(a[r])))return n}return null}function e2t(t){return function(e,n,r){iM(n,a=>{r&&!r.intersects(a.bounds)||M9t(t,e,a,a)})}}function uGt(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||M9t(t,e,n.items[0],n.items)}}function M9t(t,e,n,r){var a=n.opacity==null?1:n.opacity;a!==0&&(t(e,r)||(nM(e,n),n.fill&&kit(e,n,a)&&e.fill(),n.stroke&&rM(e,n,a)&&e.stroke()))}function Sit(t){return t=t||Ort,function(e,n,r,a,s,h){return r*=e.pixelRatio,a*=e.pixelRatio,t2t(n,d=>{let g=d.bounds;if((!g||g.contains(s,h))&&g)return t(e,d,r,a,s,h)?d:void 0})}}function FU(t,e){return function(n,r,a,s){var h,d,g=Array.isArray(r)?r[0]:r,b=e??g.fill,_=g.stroke&&n.isPointInStroke;return _&&(h=g.strokeWidth,d=g.strokeCap,n.lineWidth=h??1,n.lineCap=d??"butt"),!t(n,r)&&(b&&n.isPointInPath(a,s)||_&&n.isPointInStroke(a,s))}}function n2t(t){return Sit(FU(t))}function VC(t,e){return"translate("+t+","+e+")"}function r2t(t){return"rotate("+t+")"}function D9t(t){return VC(t.x||0,t.y||0)}function i2t(t,e,n){function r(a,s){var h=s.x||0,d=s.y||0,g=s.angle||0;a.translate(h,d),g&&a.rotate(g*=ek),a.beginPath(),e(a,s),g&&a.rotate(-g),a.translate(-h,-d)}return{type:t,tag:"path",nested:!1,attr:function(a,s){a("transform",function(h){return VC(h.x||0,h.y||0)+(h.angle?" "+r2t(h.angle):"")}(s)),a("d",e(null,s))},bound:function(a,s){return e(Q1t(a,s.angle),s),eM(a,s).translate(s.x||0,s.y||0)},draw:e2t(r),pick:n2t(r),isect:n||C9t(r)}}var lGt=i2t("arc",function(t,e){return qVt.context(t)(e)});function a2t(t,e,n){function r(s,h){s.beginPath(),e(s,h)}let a=FU(r);return{type:t,tag:"path",nested:!0,attr:function(s,h){var d=h.mark.items;d.length&&s("d",e(null,d))},bound:function(s,h){var d=h.items;return d.length===0?s:(e(Q1t(s),d),eM(s,d[0]))},draw:uGt(r),pick:function(s,h,d,g,b,_){var E=h.items,I=h.bounds;return!E||!E.length||I&&!I.contains(b,_)?null:(d*=s.pixelRatio,g*=s.pixelRatio,a(s,E,d,g)?E[0]:null)},isect:E9t,tip:n}}var cGt=a2t("area",function(t,e){let n=e[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?KVt:XVt).curve(p9t(r,n.orient,n.tension)).context(t)(e)},function(t,e){for(var n,r,a=t[0].orient==="horizontal"?e[1]:e[0],s=t[0].orient==="horizontal"?"y":"x",h=t.length,d=1/0;--h>=0;)t[h].defined!==!1&&(r=Math.abs(t[h][s]-a))<d&&(d=r,n=t[h]);return n});function hGt(t,e){t.beginPath(),H1t(e)?tM(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function R9t(t){let e=I1(t.strokeWidth,1);return t.strokeOffset!=null?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function F9t(t,e){let n=R9t(e);t("d",tM(null,e,n,n))}function OU(t,e,n,r){let a=R9t(e);t.beginPath(),tM(t,e,(n||0)+a,(r||0)+a)}let dGt=FU(OU),fGt=FU(OU,!1),pGt=FU(OU,!0);var mGt={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",D9t(e))},bound:function(t,e){if(!e.clip&&e.items){let n=e.items,r=n.length;for(let a=0;a<r;++a)t.union(n[a].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),eM(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n,r){iM(e,a=>{let s=a.x||0,h=a.y||0,d=a.strokeForeground,g=a.opacity==null?1:a.opacity;(a.stroke||a.fill)&&g&&(OU(t,a,s,h),nM(t,a),a.fill&&kit(t,a,g)&&t.fill(),a.stroke&&!d&&rM(t,a,g)&&t.stroke()),t.save(),t.translate(s,h),a.clip&&hGt(t,a),n&&n.translate(-s,-h),iM(a,b=>{(b.marktype==="group"||r==null||r.includes(b.marktype))&&this.draw(t,b,n,r)}),n&&n.translate(s,h),t.restore(),d&&a.stroke&&g&&(OU(t,a,s,h),nM(t,a),rM(t,a,g)&&t.stroke())})},pick:function(t,e,n,r,a,s){if(e.bounds&&!e.bounds.contains(a,s)||!e.items)return null;let h=n*t.pixelRatio,d=r*t.pixelRatio;return t2t(e,g=>{let b,_,E,I=g.bounds;if(I&&!I.contains(a,s))return;_=g.x||0,E=g.y||0;let R=_+(g.width||0),z=E+(g.height||0),P=g.clip;if(P&&(a<_||a>R||s<E||s>z))return;if(t.save(),t.translate(_,E),_=a-_,E=s-E,P&&H1t(g)&&!pGt(t,g,h,d))return t.restore(),null;let rt=g.strokeForeground,ot=e.interactive!==!1;return ot&&rt&&g.stroke&&fGt(t,g,h,d)?(t.restore(),g):(b=t2t(g,at=>function(dt,ct,Ct){return(dt.interactive!==!1||dt.marktype==="group")&&dt.bounds&&dt.bounds.contains(ct,Ct)}(at,_,E)?this.pick(at,n,r,_,E):null),!b&&ot&&(g.fill||!rt&&g.stroke)&&dGt(t,g,h,d)&&(b=g),t.restore(),b||null)})},isect:T9t,content:function(t,e,n){t("clip-path",e.clip?nGt(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),F9t(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?F9t(t,e):t("d","")}},gGt={"xmlns:xlink":"http://www.w3.org/1999/xlink"};function o2t(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(r=>{t.image=r,t.image.url=t.url})),n}function s2t(t,e){return t.width!=null?t.width:e&&e.width?t.aspect!==!1&&t.height?t.height*e.width/e.height:e.width:0}function u2t(t,e){return t.height!=null?t.height:e&&e.height?t.aspect!==!1&&t.width?t.width*e.height/e.width:e.height:0}function _it(t,e){return t==="center"?e/2:t==="right"?e:0}function Cit(t,e){return t==="middle"?e/2:t==="bottom"?e:0}var yGt={type:"image",tag:"image",nested:!1,attr:function(t,e,n){let r=o2t(e,n),a=s2t(e,r),s=u2t(e,r),h=(e.x||0)-_it(e.align,a),d=(e.y||0)-Cit(e.baseline,s);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",gGt["xmlns:xlink"],"xlink:href"),t("transform",VC(h,d)),t("width",a),t("height",s),t("preserveAspectRatio",e.aspect===!1?"none":"xMidYMid")},bound:function(t,e){let n=e.image,r=s2t(e,n),a=u2t(e,n),s=(e.x||0)-_it(e.align,r),h=(e.y||0)-Cit(e.baseline,a);return t.set(s,h,s+r,h+a)},draw:function(t,e,n){iM(e,r=>{if(n&&!n.intersects(r.bounds))return;let a=o2t(r,this),s=s2t(r,a),h=u2t(r,a);if(s===0||h===0)return;let d,g,b,_,E=(r.x||0)-_it(r.align,s),I=(r.y||0)-Cit(r.baseline,h);r.aspect!==!1&&(g=a.width/a.height,b=r.width/r.height,g==g&&b==b&&g!==b&&(b<g?(_=s/g,I+=(h-_)/2,h=_):(_=h*g,E+=(s-_)/2,s=_))),(a.complete||a.toDataURL)&&(nM(t,r),t.globalAlpha=(d=r.opacity)!=null?d:1,t.imageSmoothingEnabled=r.smooth!==!1,t.drawImage(a,E,I,s,h))})},pick:Sit(),isect:Ort,get:o2t,xOffset:_it,yOffset:Cit},vGt=a2t("line",function(t,e){let n=e[0],r=n.interpolate||"linear";return ZVt.curve(p9t(r,n.orient,n.tension)).context(t)(e)},function(t,e){for(var n,r,a=Math.pow(t[0].strokeWidth||1,2),s=t.length;--s>=0;)if(t[s].defined!==!1&&(n=t[s].x-e[0])*n+(r=t[s].y-e[1])*r<a)return t[s];return null});function Eit(t,e){var n=e.path;if(n==null)return!0;var r=e.x||0,a=e.y||0,s=e.scaleX||1,h=e.scaleY||1,d=(e.angle||0)*ek,g=e.pathCache;g&&g.path===n||((e.pathCache=g=U1t(n)).path=n),d&&t.rotate&&t.translate?(t.translate(r,a),t.rotate(d),pit(t,g,0,0,s,h),t.rotate(-d),t.translate(-r,-a)):pit(t,g,r,a,s,h)}var bGt={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;n===1&&r===1||t("vector-effect","non-scaling-stroke"),t("transform",function(a){return VC(a.x||0,a.y||0)+(a.angle?" "+r2t(a.angle):"")+(a.scaleX||a.scaleY?" "+function(s,h){return"scale("+s+","+h+")"}(a.scaleX||1,a.scaleY||1):"")}(e)),t("d",e.path)},bound:function(t,e){return Eit(Q1t(t,e.angle),e)?t.set(0,0,0,0):eM(t,e,!0)},draw:e2t(Eit),pick:n2t(Eit),isect:C9t(Eit)};function O9t(t,e){t.beginPath(),tM(t,e)}var wGt={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",tM(null,e))},bound:function(t,e){var n,r;return eM(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:e2t(O9t),pick:n2t(O9t),isect:T9t};function L9t(t,e,n){var r,a,s,h;return!(!e.stroke||!rM(t,e,n))&&(r=e.x||0,a=e.y||0,s=e.x2!=null?e.x2:r,h=e.y2!=null?e.y2:a,t.beginPath(),t.moveTo(r,a),t.lineTo(s,h),!0)}var xGt={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",D9t(e)),t("x2",e.x2!=null?e.x2-(e.x||0):0),t("y2",e.y2!=null?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return eM(t.set(n=e.x||0,r=e.y||0,e.x2!=null?e.x2:n,e.y2!=null?e.y2:r),e)},draw:function(t,e,n){iM(e,r=>{if(!n||n.intersects(r.bounds)){var a=r.opacity==null?1:r.opacity;a&&L9t(t,r,a)&&(nM(t,r),t.stroke())}})},pick:Sit(function(t,e,n,r){return!!t.isPointInStroke&&L9t(t,e,1)&&t.isPointInStroke(n,r)}),isect:function(t,e){let n=t.x||0,r=t.y||0;return RU(e,n,r,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r)}},kGt=i2t("shape",function(t,e){return(e.mark.shape||e.shape).context(t)(e)}),SGt=i2t("symbol",function(t,e){return JVt.context(t)(e)},E9t);let $9t=function(t){let e,n,r;t=+t||1e4;let a=()=>{e={},n={},r=0},s=(h,d)=>(++r>t&&(n=e,e={},r=1),e[h]=d);return a(),{clear:a,has:h=>af(e,h)||af(n,h),get:h=>af(e,h)?e[h]:af(n,h)?s(h,n[h]):void 0,set:(h,d)=>af(e,h)?e[h]=d:s(h,d)}}();var GC={height:HC,measureWidth:l2t,estimateWidth:Tit,width:Tit,canvas:z9t};function z9t(t){GC.width=t&&ak?l2t:Tit}function Tit(t,e){return P9t(Iit(t,e),HC(t))}function P9t(t,e){return~~(.8*t.length*e)}function l2t(t,e){return HC(t)<=0||!(e=Iit(t,e))?0:B9t(e,c2t(t))}function B9t(t,e){let n=`(${e}) ${t}`,r=$9t.get(n);return r===void 0&&(ak.font=e,r=ak.measureText(t).width,$9t.set(n,r)),r}function HC(t){return t.fontSize!=null?+t.fontSize||0:11}function Ait(t){return t.lineHeight!=null?t.lineHeight:HC(t)+2}function j9t(t){return e=t.lineBreak&&t.text&&!jp(t.text)?t.text.split(t.lineBreak):t.text,jp(e)?e.length>1?e:e[0]:e;var e}function Iit(t,e){let n=e==null?"":(e+"").trim();return t.limit>0&&n.length?function(r,a){var s=+r.limit,h=function(I){if(GC.width===l2t){let R=c2t(I);return z=>B9t(z,R)}if(GC.width===Tit){let R=HC(I);return z=>P9t(z,R)}return R=>GC.width(I,R)}(r);if(h(a)<s)return a;var d,g=r.ellipsis||"\u2026",b=r.dir==="rtl",_=0,E=a.length;if(s-=h(g),b){for(;_<E;)d=_+E>>>1,h(a.slice(d))>s?_=d+1:E=d;return g+a.slice(_)}for(;_<E;)d=1+(_+E>>>1),h(a.slice(0,d))<s?_=d:E=d-1;return a.slice(0,_)+g}(t,n):n}function _Gt(t,e){var n=t.font;return n||"sans-serif"}function c2t(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+HC(t)+"px "+_Gt(t)}function h2t(t){var e=t.baseline,n=HC(t);return Math.round(e==="top"?.79*n:e==="middle"?.3*n:e==="bottom"?-.21*n:e==="line-top"?.29*n+.5*Ait(t):e==="line-bottom"?.29*n-.5*Ait(t):0)}z9t(!0);let CGt={left:"start",center:"middle",right:"end"},LU=new rk;function Nit(t){var e,n=t.x||0,r=t.y||0,a=t.radius||0;return a&&(e=(t.theta||0)-BC,n+=a*Math.cos(e),r+=a*Math.sin(e)),LU.x1=n,LU.y1=r,LU}function d2t(t,e,n){var r,a=GC.height(e),s=e.align,h=Nit(e),d=h.x1,g=h.y1,b=e.dx||0,_=(e.dy||0)+h2t(e)-Math.round(.8*a),E=j9t(e);if(jp(E)?(a+=Ait(e)*(E.length-1),r=E.reduce((I,R)=>Math.max(I,GC.width(e,R)),0)):r=GC.width(e,E),s==="center"?b-=r/2:s==="right"&&(b-=r),t.set(b+=d,_+=g,b+r,_+a),e.angle&&!n)t.rotate(e.angle*ek,d,g);else if(n===2)return t.rotatedPoints(e.angle*ek,d,g);return t}var EGt={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,a=(e.dy||0)+h2t(e),s=Nit(e),h=s.x1,d=s.y1,g=e.angle||0;t("text-anchor",CGt[e.align]||"start"),g?(n=VC(h,d)+" "+r2t(g),(r||a)&&(n+=" "+VC(r,a))):n=VC(h+r,d+a),t("transform",n)},bound:d2t,draw:function(t,e,n){iM(e,r=>{var a,s,h,d,g,b,_,E=r.opacity==null?1:r.opacity;if(!(n&&!n.intersects(r.bounds)||E===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(t.font=c2t(r),t.textAlign=r.align||"left",s=(a=Nit(r)).x1,h=a.y1,r.angle&&(t.save(),t.translate(s,h),t.rotate(r.angle*ek),s=h=0),s+=r.dx||0,h+=(r.dy||0)+h2t(r),b=j9t(r),nM(t,r),jp(b))for(g=Ait(r),d=0;d<b.length;++d)_=Iit(r,b[d]),r.fill&&kit(t,r,E)&&t.fillText(_,s,h),r.stroke&&rM(t,r,E)&&t.strokeText(_,s,h),h+=g;else _=Iit(r,b),r.fill&&kit(t,r,E)&&t.fillText(_,s,h),r.stroke&&rM(t,r,E)&&t.strokeText(_,s,h);r.angle&&t.restore()}})},pick:Sit(function(t,e,n,r,a,s){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var h=Nit(e),d=h.x1,g=h.y1,b=d2t(LU,e,1),_=-e.angle*ek,E=Math.cos(_),I=Math.sin(_),R=E*a-I*s+(d-E*d+I*g),z=I*a+E*s+(g-I*d-E*g);return b.contains(R,z)}),isect:function(t,e){let n=d2t(LU,t,2);return RU(e,n[0],n[1],n[2],n[3])||RU(e,n[0],n[1],n[4],n[5])||RU(e,n[4],n[5],n[6],n[7])||RU(e,n[2],n[3],n[6],n[7])}},TGt=a2t("trail",function(t,e){return tGt.context(t)(e)},function(t,e){for(var n,r,a=t.length;--a>=0;)if(t[a].defined!==!1&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<(n=t[a].size||1)*n)return t[a];return null}),U9t={arc:lGt,area:cGt,group:mGt,image:yGt,line:vGt,path:bGt,rect:wGt,rule:xGt,shape:kGt,symbol:SGt,text:EGt,trail:TGt};Grt(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]);function W9t(t,e,n,r){if(function(a,s,h){return a.bounds&&s.intersects(a.bounds)&&(a.marktype==="group"||a.interactive!==!1&&(!h||h(a)))}(t,e,n)){let a=t.items,s=t.marktype,h=a.length,d=0;if(s==="group")for(;d<h;++d)V9t(a[d],e,n,r);else for(let g=U9t[s].isect;d<h;++d){let b=a[d];G9t(b,e,g)&&r.push(b)}}return r}function V9t(t,e,n,r){n&&n(t.mark)&&G9t(t,e,U9t.group.isect)&&r.push(t);let a=t.items,s=a&&a.length;if(s){let h=t.x||0,d=t.y||0;e.translate(-h,-d);for(let g=0;g<s;++g)W9t(a[g],e,n,r);e.translate(h,d)}return r}function G9t(t,e,n){let r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}new rk;var Mit=Math.random;let H9t=Math.sqrt(2*Math.PI),AGt=Math.SQRT2,$U=NaN;function Y9t(t,e){t=t||0,e=e??1;let n,r,a=0,s=0;if($U==$U)a=$U,$U=NaN;else{do a=2*Mit()-1,s=2*Mit()-1,n=a*a+s*s;while(n===0||n>1);r=Math.sqrt(-2*Math.log(n)/n),a*=r,$U=s*r}return t+a*e}function IGt(t,e,n){let r=(t-(e||0))/(n=n??1);return Math.exp(-.5*r*r)/(n*H9t)}function q9t(t,e,n){let r=(t-(e=e||0))/(n=n??1),a=Math.abs(r),s;if(a>37)s=0;else{let h=Math.exp(-a*a/2),d;a<7.07106781186547?(d=.0352624965998911*a+.700383064443688,d=d*a+6.37396220353165,d=d*a+33.912866078383,d=d*a+112.079291497871,d=d*a+221.213596169931,d=d*a+220.206867912376,s=h*d,d=.0883883476483184*a+1.75566716318264,d=d*a+16.064177579207,d=d*a+86.7807322029461,d=d*a+296.564248779674,d=d*a+637.333633378831,d=d*a+793.826512519948,d=d*a+440.413735824752,s/=d):(d=a+.65,d=a+4/d,d=a+3/d,d=a+2/d,d=a+1/d,s=h/d/2.506628274631)}return r>0?1-s:s}function X9t(t,e,n){return t<0||t>1?NaN:(e||0)+(n??1)*AGt*function(r){let a,s=-Math.log((1-r)*(1+r));return s<6.25?(s-=3.125,a=-364441206401782e-35,a=a*s-16850591381820166e-35,a=128584807152564e-32+a*s,a=11157877678025181e-33+a*s,a=a*s-1333171662854621e-31,a=20972767875968562e-33+a*s,a=6637638134358324e-30+a*s,a=a*s-4054566272975207e-29,a=a*s-8151934197605472e-29,a=26335093153082323e-28+a*s,a=a*s-12975133253453532e-27,a=a*s-5415412054294628e-26,a=10512122733215323e-25+a*s,a=a*s-4112633980346984e-24,a=a*s-29070369957882005e-24,a=42347877827932404e-23+a*s,a=a*s-13654692000834679e-22,a=a*s-13882523362786469e-21,a=.00018673420803405714+a*s,a=a*s-.000740702534166267,a=a*s-.006033670871430149,a=.24015818242558962+a*s,a=1.6536545626831027+a*s):s<16?(s=Math.sqrt(s)-3.25,a=22137376921775787e-25,a=9075656193888539e-23+a*s,a=a*s-27517406297064545e-23,a=18239629214389228e-24+a*s,a=15027403968909828e-22+a*s,a=a*s-4013867526981546e-21,a=29234449089955446e-22+a*s,a=12475304481671779e-21+a*s,a=a*s-47318229009055734e-21,a=6828485145957318e-20+a*s,a=24031110387097894e-21+a*s,a=a*s-.0003550375203628475,a=.0009532893797373805+a*s,a=a*s-.0016882755560235047,a=.002491442096107851+a*s,a=a*s-.003751208507569241,a=.005370914553590064+a*s,a=1.0052589676941592+a*s,a=3.0838856104922208+a*s):Number.isFinite(s)?(s=Math.sqrt(s)-5,a=-27109920616438573e-27,a=a*s-2555641816996525e-25,a=15076572693500548e-25+a*s,a=a*s-3789465440126737e-24,a=761570120807834e-23+a*s,a=a*s-1496002662714924e-23,a=2914795345090108e-23+a*s,a=a*s-6771199775845234e-23,a=22900482228026655e-23+a*s,a=a*s-99298272942317e-20,a=4526062597223154e-21+a*s,a=a*s-1968177810553167e-20,a=7599527703001776e-20+a*s,a=a*s-.00021503011930044477,a=a*s-.00013871931833623122,a=1.0103004648645344+a*s,a=4.849906401408584+a*s):a=1/0,a*r}(2*t-1)}function NGt(t,e){return t=t||0,e=e??1,Math.exp(t+Y9t()*e)}function MGt(t,e,n){if(t<=0)return 0;e=e||0,n=n??1;let r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*H9t*t)}function DGt(t,e,n){return q9t(Math.log(t),e,n)}function RGt(t,e,n){return Math.exp(X9t(t,e,n))}function FGt(t,e){return e==null&&(e=t??1,t=0),t+(e-t)*Mit()}function OGt(t,e,n){return n==null&&(n=e??1,e=0),t>=e&&t<=n?1/(n-e):0}function LGt(t,e,n){return n==null&&(n=e??1,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function $Gt(t,e,n){return n==null&&(n=e??1,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function K9t(t){let e=this.context.data[t];return e?e.values.value:[]}let zU=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},zGt=zU("format"),Z9t=zU("timeFormat"),PGt=zU("utcFormat"),BGt=zU("timeParse"),jGt=zU("utcParse"),Dit=new Date(2e3,0,1);function Rit(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(Dit.setYear(2e3),Dit.setMonth(t),Dit.setDate(e),Z9t.call(this,Dit,n)):""}function f2t(t,e,n,r){e[0].type!==mU&&ih("First argument to data functions must be a string literal.");let a=e[0].value,s=":"+a;if(!af(s,r))try{r[s]=n.getData(a).tuplesRef()}catch{}}function Wp(t,e,n,r){if(e[0].type===mU)Q9t(n,r,e[0].value);else for(t in n.scales)Q9t(n,r,t)}function Q9t(t,e,n){let r="%"+n;if(!af(e,r))try{e[r]=t.scaleRef(n)}catch{}}function S3(t,e){let n;return WN(t)?t:pU(t)?(n=e.scales[t])&&n.value:void 0}function UGt(t,e,n){e.__bandwidth=a=>a&&a.bandwidth?a.bandwidth():0,n._bandwidth=Wp,n._range=Wp,n._scale=Wp;let r=a=>"_["+(a.type===mU?Vrt("%"+a.value):Vrt("%")+"+"+t(a))+"]";return{_bandwidth:a=>`this.__bandwidth(${r(a[0])})`,_range:a=>`${r(a[0])}.range()`,_scale:a=>`${r(a[0])}(${t(a[1])})`}}function p2t(t,e){return function(n,r,a){if(n){let s=S3(n,(a||this).context);return s&&s.path[t](r)}return e(r)}}let WGt=p2t("area",function(t){return Yrt=new Mf,c3(t,Sy),2*Yrt}),VGt=p2t("bounds",function(t){var e,n,r,a,s,h,d;if(q0=Pl=-(xl=Up=1/0),J4=[],c3(t,w3),n=J4.length){for(J4.sort(TWt),e=1,s=[r=J4[0]];e<n;++e)dCt(r,(a=J4[e])[0])||dCt(r,a[1])?(X0(r[0],a[1])>X0(r[0],r[1])&&(r[1]=a[1]),X0(a[0],r[1])>X0(r[0],r[1])&&(r[0]=a[0])):s.push(r=a);for(h=-1/0,e=0,r=s[n=s.length-1];e<=n;r=a,++e)a=s[e],(d=X0(r[1],a[0]))>h&&(h=d,xl=a[0],Pl=r[1])}return J4=b3=null,xl===1/0||Up===1/0?[[NaN,NaN],[NaN,NaN]]:[[xl,Up],[Pl,q0]]}),GGt=p2t("centroid",function(t){yU=qrt=Xrt=Krt=Zrt=Qrt=Jrt=tit=0,f1t=new Mf,p1t=new Mf,m1t=new Mf,c3(t,E1);var e=+f1t,n=+p1t,r=+m1t,a=J$(e,n,r);return a<Q$&&(e=Qrt,n=Jrt,r=tit,qrt<ba&&(e=Xrt,n=Krt,r=Zrt),(a=J$(e,n,r))<Q$)?[NaN,NaN]:[Sp(n,e)*yl,Wd(r/a)*yl]});function m2t(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(r){t.warn(r)}return n[n.length-1]}function g2t(t){let e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function y2t(t){let e=V2(t);return .2126*g2t(e.r)+.7152*g2t(e.g)+.0722*g2t(e.b)}function J9t(t,e){return t===e||t!=t&&e!=e||(jp(t)?!(!jp(e)||t.length!==e.length)&&function(n,r){for(let a=0,s=n.length;a<s;++a)if(!J9t(n[a],r[a]))return!1;return!0}(t,e):!(!Lrt(t)||!Lrt(e))&&t8t(t,e))}function t8t(t,e){for(let n in t)if(!J9t(t[n],e[n]))return!1;return!0}function e8t(t){return e=>t8t(t,e)}let n8t={};function v2t(t){return jp(t)||ArrayBuffer.isView(t)?t:null}function b2t(t){return v2t(t)||(pU(t)?t:null)}let r8t=t=>t.data;function i8t(t,e){let n=K9t.call(e,t);return n.root&&n.root.lookup||{}}let a8t=()=>typeof window<"u"&&window||null,Fit={random:()=>Mit(),cumulativeNormal:q9t,cumulativeLogNormal:DGt,cumulativeUniform:LGt,densityNormal:IGt,densityLogNormal:MGt,densityUniform:OGt,quantileNormal:X9t,quantileLogNormal:RGt,quantileUniform:$Gt,sampleNormal:Y9t,sampleLogNormal:NGt,sampleUniform:FGt,isArray:jp,isBoolean:function(t){return typeof t=="boolean"},isDate:Z6t,isDefined:t=>t!==void 0,isNumber:Q6t,isObject:Lrt,isRegExp:function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},isString:pU,isTuple:Qh,isValid:t=>t!=null&&t==t,toBoolean:vWt,toDate:wWt,toNumber:$rt,toString:xWt,indexof:function(t,...e){return b2t(t).indexOf(...e)},join:function(t,...e){return v2t(t).join(...e)},lastindexof:function(t,...e){return b2t(t).lastIndexOf(...e)},replace:function(t,e,n){return WN(n)&&ih("Function argument passed to replace."),String(t).replace(e,n)},reverse:function(t){return v2t(t).slice().reverse()},slice:function(t,...e){return b2t(t).slice(...e)},flush:function(t,e,n,r,a,s){if(!n&&n!==0)return s;let h=+n,d,g=t[0],b=y3(t);b<g&&(d=g,g=b,b=d),d=Math.abs(e-g);let _=Math.abs(b-e);return d<_&&d<=h?r:_<=h?a:s},lerp:function(t,e){let n=t[0],r=y3(t),a=+e;return a?a===1?r:n+a*(r-n):n},merge:function(){let t=[].slice.call(arguments);return t.unshift({}),Urt(...t)},pad:function(t,e,n,r){let a=n||" ",s=t+"",h=e-s.length;return h<=0?s:r==="left"?Wrt(a,h)+s:r==="center"?Wrt(a,~~(h/2))+s+Wrt(a,Math.ceil(h/2)):s+Wrt(a,h)},peek:y3,pluck:function(t,e){let n=n8t[e]||(n8t[e]=H6t(e));return jp(t)?t.map(n):n(t)},span:function(t){return t&&y3(t)-t[0]||0},inrange:function(t,e,n,r){let a,s=e[0],h=e[e.length-1];return s>h&&(a=s,s=h,h=a),r=r===void 0||r,((n=n===void 0||n)?s<=t:s<t)&&(r?t<=h:t<h)},truncate:function(t,e,n,r){let a=r??"\u2026",s=t+"",h=s.length,d=Math.max(0,e-a.length);return h<=e?s:n==="left"?a+s.slice(h-d):n==="center"?s.slice(0,Math.ceil(d/2))+a+s.slice(h-~~(d/2)):s.slice(0,d)+a},rgb:V2,lab:w1,hcl:_nt,hsl:b_,luminance:y2t,contrast:function(t,e){let n=y2t(t),r=y2t(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:wf,format:zGt,utcFormat:PGt,utcParse:jGt,utcOffset:function(t,e,n){return i9t(r9t(t),e,n)},utcSequence:function(t,e,n,r){return a9t(r9t(t),e,n,r)},timeFormat:Z9t,timeParse:BGt,timeOffset:function(t,e,n){return i9t(n9t(t),e,n)},timeSequence:function(t,e,n,r){return a9t(n9t(t),e,n,r)},timeUnitSpecifier:function(t,e){let n=Urt({},gVt,e),r=function(b){let _=jrt(b).slice(),E={};return _.length||ih("Missing time unit."),_.forEach(I=>{af(O1t,I)?E[I]=1:ih(`Invalid time unit: ${I}.`)}),(E[SU]||E[_U]?1:0)+(E[kU]||E[PC]||E[KN]?1:0)+(E[CU]?1:0)>1&&ih(`Incompatible time units: ${b}`),_.sort((I,R)=>O1t[I]-O1t[R]),_}(t),a=r.length,s,h,d="",g=0;for(g=0;g<a;)for(s=r.length;s>g;--s)if(h=r.slice(g,s).join("-"),n[h]!=null){d+=n[h],g=s;break}return d.trim()},monthFormat:function(t){return Rit.call(this,t,1,"%B")},monthAbbrevFormat:function(t){return Rit.call(this,t,1,"%b")},dayFormat:function(t){return Rit.call(this,0,2+t,"%A")},dayAbbrevFormat:function(t){return Rit.call(this,0,2+t,"%a")},quarter:function(t){return 1+~~(new Date(t).getMonth()/3)},utcquarter:function(t){return 1+~~(new Date(t).getUTCMonth()/3)},week:function(t){return vVt(new Date(t))},utcweek:function(t){return wVt(new Date(t))},dayofyear:function(t){return yVt(new Date(t))},utcdayofyear:function(t){return bVt(new Date(t))},warn:function(){return m2t(this.context.dataflow,"warn",arguments)},info:function(){return m2t(this.context.dataflow,"info",arguments)},debug:function(){return m2t(this.context.dataflow,"debug",arguments)},extent:function(t,e){let n,r,a,s,h=0;if(t&&(n=t.length))if(e==null){for(r=t[h];h<n&&(r==null||r!=r);r=t[++h]);for(a=s=r;h<n;++h)r=t[h],r!=null&&(r<a&&(a=r),r>s&&(s=r))}else{for(r=e(t[h]);h<n&&(r==null||r!=r);r=e(t[++h]));for(a=s=r;h<n;++h)r=e(t[h]),r!=null&&(r<a&&(a=r),r>s&&(s=r))}return[a,s]},inScope:function(t){let e=this.context.group,n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},intersect:function(t,e,n){if(!t)return[];let[r,a]=t,s=new rk().set(r[0],r[1],a[0],a[1]);return function(h,d,g){let b=[],_=new rk().union(d),E=h.marktype;return E?W9t(h,_,g,b):E==="group"?V9t(h,_,g,b):ih("Intersect scene must be mark node or group item.")}(n||this.context.dataflow.scenegraph().root,s,function(h){let d=null;if(h){let g=jrt(h.marktype),b=jrt(h.markname);d=_=>(!g.length||g.some(E=>_.marktype===E))&&(!b.length||b.some(E=>_.name===E))}return d}(e))},clampRange:function(t,e,n){let r,a=t[0],s=t[1];return s<a&&(r=s,s=a,a=r),r=s-a,r>=n-e?[e,n]:[a=Math.min(Math.max(a,e),n-r),a+r]},pinchDistance:function(t){let e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(t){let e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){let t=a8t();return t?t.screen:{}},containerSize:function(){let t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){let t=a8t();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]},bandspace:function(t,e,n){return o9t(t||0,e||0,n||0)},setdata:function(t,e){let n=this.context.dataflow,r=this.context.data[t].input;return n.pulse(r,n.changeset().remove(Ort).insert(e)),1},pathShape:function(t){let e=null;return function(n){return n?pit(n,e=e||U1t(t)):t}},panLinear:function(t,e){return Prt(t,e,$rt,l1t)},panLog:function(t,e){var n=Math.sign(t[0]);return Prt(t,e,q6t(n),Y6t(n))},panPow:function(t,e,n){return Prt(t,e,zrt(n),zrt(1/n))},panSymlog:function(t,e,n){return Prt(t,e,X6t(n),K6t(n))},zoomLinear:function(t,e,n){return Brt(t,e,n,$rt,l1t)},zoomLog:function(t,e,n){let r=Math.sign(t[0]);return Brt(t,e,n,q6t(r),Y6t(r))},zoomPow:function(t,e,n,r){return Brt(t,e,n,zrt(r),zrt(1/r))},zoomSymlog:function(t,e,n,r){return Brt(t,e,n,X6t(r),K6t(r))},encode:function(t,e,n){if(t){let r=this.context.dataflow,a=t.mark.source;r.pulse(a,r.changeset().encode(t,e))}return n!==void 0?n:t},modify:function(t,e,n,r,a,s){let h=this.context.dataflow,d=this.context.data[t],g=d.input,b=h.stamp(),_,E,I=d.changes;if(h._trigger===!1||!(g.value.length||e||r))return 0;if((!I||I.stamp<b)&&(d.changes=I=h.changeset(),I.stamp=b,h.runAfter(()=>{d.modified=!0,h.pulse(g,I).run()},!0,1)),n&&(_=n===!0?Ort:jp(n)||Qh(n)?n:e8t(n),I.remove(_)),e&&I.insert(e),r&&(_=e8t(r),g.value.some(_)?I.remove(_):I.insert(r)),a)for(E in s)I.modify(a,E,s[E]);return 1}},HGt=["view","item","group","xy","x","y"],o8t="this.",w2t={},YGt={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>`_[${Vrt("$"+t)}]`,functions:function(t){let e=tCt(t);HGt.forEach(n=>e[n]="event.vega."+n);for(let n in Fit)e[n]=o8t+n;return Urt(e,UGt(t,Fit,w2t)),e},constants:J6t,visitors:w2t},s8t=function(t){let e=(t=t||{}).allowed?Grt(t.allowed):{},n=t.forbidden?Grt(t.forbidden):{},r=t.constants||J6t,a=(t.functions||tCt)(E),s=t.globalvar,h=t.fieldvar,d=WN(s)?s:z=>`${s}["${z}"]`,g={},b={},_=0;function E(z){if(pU(z))return z;let P=I[z.type];return P==null&&ih("Unsupported type: "+z.type),P(z)}let I={Literal:z=>z.raw,Identifier:z=>{let P=z.name;return _>0?P:af(n,P)?ih("Illegal identifier: "+P):af(r,P)?r[P]:af(e,P)?P:(g[P]=1,d(P))},MemberExpression:z=>{let P=!z.computed,rt=E(z.object);P&&(_+=1);let ot=E(z.property);return rt===h&&(b[function(at){let dt=at&&at.length-1;return dt&&(at[0]==='"'&&at[dt]==='"'||at[0]==="'"&&at[dt]==="'")?at.slice(1,-1):at}(ot)]=1),P&&(_-=1),rt+(P?"."+ot:"["+ot+"]")},CallExpression:z=>{z.callee.type!=="Identifier"&&ih("Illegal callee type: "+z.callee.type);let P=z.callee.name,rt=z.arguments,ot=af(a,P)&&a[P];return ot||ih("Unrecognized function: "+P),WN(ot)?ot(rt):ot+"("+rt.map(E).join(",")+")"},ArrayExpression:z=>"["+z.elements.map(E).join(",")+"]",BinaryExpression:z=>"("+E(z.left)+" "+z.operator+" "+E(z.right)+")",UnaryExpression:z=>"("+z.operator+E(z.argument)+")",ConditionalExpression:z=>"("+E(z.test)+"?"+E(z.consequent)+":"+E(z.alternate)+")",LogicalExpression:z=>"("+E(z.left)+z.operator+E(z.right)+")",ObjectExpression:z=>"{"+z.properties.map(E).join(",")+"}",Property:z=>{_+=1;let P=E(z.key);return _-=1,P+":"+E(z.value)}};function R(z){let P={code:E(z),globals:Object.keys(g),fields:Object.keys(b)};return g={},b={},P}return R.functions=a,R.constants=r,R}(YGt);function Cc(t,e,n){return arguments.length===1?Fit[t]:(Fit[t]=e,n&&(w2t[t]=n),s8t&&(s8t.functions[t]=o8t+t),this)}Cc("bandwidth",function(t,e){let n=S3(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0},Wp),Cc("copy",function(t,e){let n=S3(t,(e||this).context);return n?n.copy():void 0},Wp),Cc("domain",function(t,e){let n=S3(t,(e||this).context);return n?n.domain():[]},Wp),Cc("range",function(t,e){let n=S3(t,(e||this).context);return n&&n.range?n.range():[]},Wp),Cc("invert",function(t,e,n){let r=S3(t,(n||this).context);return r?jp(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0},Wp),Cc("scale",function(t,e,n){let r=S3(t,(n||this).context);return r?r(e):void 0},Wp),Cc("gradient",function(t,e,n,r,a){t=S3(t,(a||this).context);let s=function(_,E){var I,R=[];return I={gradient:"linear",x1:_?_[0]:0,y1:_?_[1]:0,x2:E?E[0]:1,y2:E?E[1]:0,stops:R,stop:function(z,P){return R.push({offset:z,color:P}),I}}}(e,n),h=t.domain(),d=h[0],g=y3(h),b=l1t;return g-d?b=RVt(t,d,g):t=(t.interpolator?Ys("sequential")().interpolator(t.interpolator()):Ys("linear")().interpolate(t.interpolate()).range(t.range())).domain([d=0,g=1]),t.ticks&&(h=t.ticks(+r||15),d!==h[0]&&h.unshift(d),g!==y3(h)&&h.push(g)),h.forEach(_=>s.stop(b(_),t(_))),s},Wp),Cc("geoArea",WGt,Wp),Cc("geoBounds",VGt,Wp),Cc("geoCentroid",GGt,Wp),Cc("geoShape",function(t,e,n){let r=S3(t,(n||this).context);return function(a){return r?r.path.context(a)(e):""}},Wp),Cc("indata",function(t,e,n){let r=this.context.data[t]["index:"+e],a=r?r.value.get(n):void 0;return a&&a.count},function(t,e,n,r){e[0].type!==mU&&ih("First argument to indata must be a string literal."),e[1].type!==mU&&ih("Second argument to indata must be a string literal.");let a=e[0].value,s=e[1].value,h="@"+s;af(h,r)||(r[h]=n.getData(a).indataRef(n,s))}),Cc("data",K9t,f2t),Cc("treePath",function(t,e,n){let r=i8t(t,this),a=r[e],s=r[n];return a&&s?a.path(s).map(r8t):void 0},f2t),Cc("treeAncestors",function(t,e){let n=i8t(t,this)[e];return n?n.ancestors().map(r8t):void 0},f2t),Cc("vlSelectionTest",h_t,PN),Cc("vlSelectionIdTest",f_t,PN),Cc("vlSelectionResolve",m_t,PN),Cc("vlSelectionTuples",p_t);let qGt="view",Oit="[",Lit="]",u8t="{",l8t="}",XGt=":",c8t=",",KGt="@",ZGt=">",QGt=/[[\]{}]/,JGt={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},h8t,d8t;function PU(t,e,n,r,a){let s=t.length,h,d=0;for(;e<s;++e){if(h=t[e],!d&&h===n)return e;a&&a.indexOf(h)>=0?--d:r&&r.indexOf(h)>=0&&++d}return e}function f8t(t){let e=[],n=t.length,r=0,a=0;for(;a<n;)a=PU(t,a,c8t,Oit+u8t,Lit+l8t),e.push(t.substring(r,a).trim()),r=++a;if(e.length===0)throw"Empty event selector: "+t;return e}function x2t(t){return t[0]==="["?function(e){let n=e.length,r,a=1;if(a=PU(e,a,Lit,Oit,Lit),a===n)throw"Empty between selector: "+e;if(r=f8t(e.substring(1,a)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(a+1).trim(),e[0]!==ZGt)throw"Expected '>' after between selector: "+e;r=r.map(x2t);let s=x2t(e.slice(1).trim());return s.between?{between:r,stream:s}:(s.between=r,s)}(t):function(e){let n={source:h8t},r=[],a,s,h=[0,0],d=0,g=0,b=e.length,_=0;if(e[b-1]===l8t){if(_=e.lastIndexOf(u8t),!(_>=0))throw"Unmatched right brace: "+e;try{h=function(E){let I=E.split(c8t);if(!E.length||I.length>2)throw E;return I.map(R=>{let z=+R;if(z!=z)throw E;return z})}(e.substring(_+1,b-1))}catch{throw"Invalid throttle specification: "+e}b=(e=e.slice(0,_).trim()).length,_=0}if(!b)throw e;if(e[0]===KGt&&(d=++_),a=PU(e,_,XGt),a<b&&(r.push(e.substring(g,a).trim()),g=_=++a),_=PU(e,_,Oit),_===b)r.push(e.substring(g,b).trim());else if(r.push(e.substring(g,_).trim()),s=[],g=++_,g===b)throw"Unmatched left bracket: "+e;for(;_<b;){if(_=PU(e,_,Lit),_===b)throw"Unmatched left bracket: "+e;if(s.push(e.substring(g,_).trim()),_<b-1&&e[++_]!==Oit)throw"Expected left bracket: "+e;g=++_}if(!(b=r.length)||QGt.test(r[b-1]))throw"Invalid event selector: "+e;return b>1?(n.type=r[1],d?n.markname=r[0].slice(1):function(E){return d8t[E]}(r[0])?n.marktype=r[0]:n.source=r[0]):n.type=r[0],n.type.slice(-1)==="!"&&(n.consume=!0,n.type=n.type.slice(0,-1)),s!=null&&(n.filter=s),h[0]&&(n.throttle=h[0]),h[1]&&(n.debounce=h[1]),n}(t)}function tHt(t){return Zr(t)?t:{type:t||"pad"}}let BU=t=>+t||0,eHt=t=>({top:t,bottom:t,left:t,right:t});function nHt(t){return Zr(t)?t.signal?t:{top:BU(t.top),bottom:BU(t.bottom),left:BU(t.left),right:BU(t.right)}:eHt(BU(t))}let $h=t=>Zr(t)&&!ni(t)?nn({},t):{value:t};function p8t(t,e,n,r){return n!=null?(Zr(n)&&!ni(n)||ni(n)&&n.length&&Zr(n[0])?t.update[e]=n:t[r||"enter"][e]={value:n},1):0}function fd(t,e,n){for(let r in e)p8t(t,r,e[r]);for(let r in n)p8t(t,r,n[r],"update")}function aM(t,e,n){for(let r in e)n&&In(n,r)||(t[r]=nn(t[r]||{},e[r]));return t}function oM(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}let k2t="mark",S2t="frame",_2t="scope",rHt="axis",iHt="axis-domain",aHt="axis-grid",oHt="axis-label",sHt="axis-tick",uHt="axis-title",lHt="legend",cHt="legend-band",hHt="legend-entry",dHt="legend-gradient",m8t="legend-label",fHt="legend-symbol",pHt="legend-title",mHt="title",gHt="title-text",yHt="title-subtitle";function C2t(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}let g8t=t=>wi(t)?pi(t):t.signal?`(${t.signal})`:y8t(t);function $it(t){if(t.gradient!=null)return function(n){let r=[n.start,n.stop,n.count].map(a=>a==null?null:pi(a));for(;r.length&&Ba(r)==null;)r.pop();return r.unshift(g8t(n.gradient)),`gradient(${r.join(",")})`}(t);let e=t.signal?`(${t.signal})`:t.color?function(n){return n.c?zit("hcl",n.h,n.c,n.l):n.h||n.s?zit("hsl",n.h,n.s,n.l):n.l||n.a?zit("lab",n.l,n.a,n.b):n.r||n.g||n.b?zit("rgb",n.r,n.g,n.b):null}(t.color):t.field!=null?y8t(t.field):t.value!==void 0?pi(t.value):void 0;return t.scale!=null&&(e=function(n,r){let a=g8t(n.scale);return n.range!=null?r=`lerp(_range(${a}), ${+n.range})`:(r!==void 0&&(r=`_scale(${a}, ${r})`),n.band&&(r=(r?r+"+":"")+`_bandwidth(${a})`+(+n.band==1?"":"*"+Pit(n.band)),n.extra&&(r=`(datum.extra ? _scale(${a}, datum.extra.value) : ${r})`)),r==null&&(r="0")),r}(t,e)),e===void 0&&(e=null),t.exponent!=null&&(e=`pow(${e},${Pit(t.exponent)})`),t.mult!=null&&(e+=`*${Pit(t.mult)}`),t.offset!=null&&(e+=`+${Pit(t.offset)}`),t.round&&(e=`round(${e})`),e}let zit=(t,e,n,r)=>`(${t}(${[e,n,r].map($it).join(",")})+'')`;function Pit(t){return Zr(t)?"("+$it(t)+")":t}function y8t(t){return v8t(Zr(t)?t:{datum:t})}function v8t(t){let e,n,r;if(t.signal)e="datum",r=t.signal;else if(t.group||t.parent){for(n=Math.max(1,t.level||1),e="item";n-- >0;)e+=".mark.group";t.parent?(r=t.parent,e+=".datum"):r=t.group}else t.datum?(e="datum",r=t.datum):Dn("Invalid field reference: "+pi(t));return t.signal||(r=wi(r)?Ui(r).map(pi).join("]["):v8t(r)),e+"["+r+"]"}function b8t(t,e,n,r,a,s){let h={};(s=s||{}).encoders={$encode:h},t=function(d,g,b,_,E){let I={},R={},z,P,rt,ot;for(P in P="lineBreak",g!=="text"||E[P]==null||oM(P,d)||C2t(I,P,E[P]),(b=="legend"||String(b).startsWith("axis"))&&(b=null),ot=b===S2t?E.group:b===k2t?nn({},E.mark,E[g]):null,ot)rt=oM(P,d)||(P==="fill"||P==="stroke")&&(oM("fill",d)||oM("stroke",d)),rt||C2t(I,P,ot[P]);for(P in et(_).forEach(at=>{let dt=E.style&&E.style[at];for(let ct in dt)oM(ct,d)||C2t(I,ct,dt[ct])}),d=nn({},d),I)ot=I[P],ot.signal?(z=z||{})[P]=ot:R[P]=ot;return d.enter=nn(R,d.enter),z&&(d.update=nn(z,d.update)),d}(t,e,n,r,a.config);for(let d in t)h[d]=vHt(t[d],e,s,a);return s}function vHt(t,e,n,r){let a={},s={};for(let d in t)t[d]!=null&&(a[d]=bHt((h=t[d],ni(h)?function(g){let b="";return g.forEach(_=>{let E=$it(_);b+=_.test?`(${_.test})?${E}:`:E}),Ba(b)===":"&&(b+="null"),b}(h):$it(h)),r,n,s));var h;return{$expr:{marktype:e,channels:a},$fields:Object.keys(s),$output:Object.keys(t)}}function bHt(t,e,n,r){let a=ky(t,e);return a.$fields.forEach(s=>r[s]=1),nn(n,a.$params),a.$expr}let wHt="outer",xHt=["value","update","init","react","bind"];function w8t(t,e){Dn(t+' for "outer" push: '+pi(e))}function x8t(t,e){let n=t.name;if(t.push===wHt)e.signals[n]||w8t("No prior signal definition",n),xHt.forEach(r=>{t[r]!==void 0&&w8t("Invalid property ",r)});else{let r=e.addSignal(n,t.value);t.react===!1&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}}function E2t(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function Bit(t,e,n,r){return new E2t(t,e,n,r)}function jit(t,e){return Bit("operator",t,e)}function da(t){let e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function jU(t,e){return e?{$field:t,$name:e}:{$field:t}}let T2t=jU("key");function k8t(t,e){return{$compare:t,$order:e}}function Uit(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}let A2t="scope",I2t="view";function ah(t){return t&&t.signal}function Wit(t){if(ah(t))return!0;if(Zr(t)){for(let e in t)if(Wit(t[e]))return!0}return!1}function N1(t,e){return t??e}function YC(t){return t&&t.signal||t}let S8t="timer";function UU(t,e){return(t.merge?kHt:t.stream?SHt:t.type?_Ht:Dn("Invalid stream specification: "+pi(t)))(t,e)}function kHt(t,e){let n=t.merge.map(a=>UU(a,e)),r=N2t({merge:n},t,e);return e.addStream(r).id}function SHt(t,e){let n=N2t({stream:UU(t.stream,e)},t,e);return e.addStream(n).id}function _Ht(t,e){let n;t.type===S8t?(n=e.event(S8t,t.throttle),t={between:t.between,filter:t.filter}):n=e.event(function(a){return a===A2t?I2t:a||I2t}(t.source),t.type);let r=N2t({stream:n},t,e);return Object.keys(r).length===1?n:e.addStream(r).id}function N2t(t,e,n){let r=e.between;return r&&(r.length!==2&&Dn('Stream "between" parameter must have 2 entries: '+pi(e)),t.between=[UU(r[0],n),UU(r[1],n)]),r=e.filter?[].concat(e.filter):[],(e.marktype||e.markname||e.markrole)&&r.push(function(a,s,h){let d="event.item";return d+(a&&a!=="*"?"&&"+d+".mark.marktype==='"+a+"'":"")+(h?"&&"+d+".mark.role==='"+h+"'":"")+(s?"&&"+d+".mark.name==='"+s+"'":"")}(e.marktype,e.markname,e.markrole)),e.source===A2t&&r.push("inScope(event.item)"),r.length&&(t.filter=ky("("+r.join(")&&(")+")",n).$expr),(r=e.throttle)!=null&&(t.throttle=+r),(r=e.debounce)!=null&&(t.debounce=+r),e.consume&&(t.consume=!0),t}let CHt={code:"_.$value",ast:{type:"Identifier",value:"value"}};function EHt(t,e,n){let r=t.encode,a={target:n},s=t.events,h=t.update,d=[];s||Dn("Signal update missing events specification."),wi(s)&&(s=function(g,b,_){return h8t=b||qGt,d8t=JGt,f8t(g.trim()).map(x2t)}(s,e.isSubscope()?A2t:I2t)),s=et(s).filter(g=>g.signal||g.scale?(d.push(g),0):1),d.length>1&&(d=[THt(d)]),s.length&&d.push(s.length>1?{merge:s}:s[0]),r!=null&&(h&&Dn("Signal encode and update are mutually exclusive."),h="encode(item(),"+pi(r)+")"),a.update=wi(h)?ky(h,e):h.expr!=null?ky(h.expr,e):h.value!=null?h.value:h.signal!=null?{$expr:CHt,$params:{$value:e.signalRef(h.signal)}}:Dn("Invalid signal update specification."),t.force&&(a.options={force:!0}),d.forEach(g=>e.addUpdate(nn(function(b,_){return{source:b.signal?_.signalRef(b.signal):b.scale?_.scaleRef(b.scale):UU(b,_)}}(g,e),a)))}function THt(t){return{signal:"["+t.map(e=>e.scale?'scale("'+e.scale+'")':e.signal)+"]"}}let iu=t=>(e,n,r)=>Bit(t,n,e||void 0,r),_8t=iu("aggregate"),AHt=iu("axisticks"),C8t=iu("bound"),M1=iu("collect"),E8t=iu("compare"),IHt=iu("datajoin"),T8t=iu("encode"),NHt=iu("expression"),MHt=iu("facet"),DHt=iu("field"),RHt=iu("key"),FHt=iu("legendentries"),OHt=iu("load"),LHt=iu("mark"),$Ht=iu("multiextent"),zHt=iu("multivalues"),PHt=iu("overlap"),BHt=iu("params"),A8t=iu("prefacet"),jHt=iu("projection"),UHt=iu("proxy"),WHt=iu("relay"),I8t=iu("render"),VHt=iu("scale"),qC=iu("sieve"),GHt=iu("sortitems"),N8t=iu("viewlayout"),HHt=iu("values"),YHt=0,M8t={min:"min",max:"max",count:"sum"};function qHt(t,e){let n=e.getScale(t.name).params,r;for(r in n.domain=D8t(t.domain,t,e),t.range!=null&&(n.range=F8t(t,e,n)),t.interpolate!=null&&function(a,s){s.interpolate=eg(a.type||a),a.gamma!=null&&(s.interpolateGamma=eg(a.gamma))}(t.interpolate,n),t.nice!=null&&(n.nice=function(a){return Zr(a)?{interval:eg(a.interval),step:eg(a.step)}:eg(a)}(t.nice)),t.bins!=null&&(n.bins=function(a,s){return a.signal||ni(a)?Vit(a,s):s.objectProperty(a)}(t.bins,e)),t)In(n,r)||r==="name"||(n[r]=eg(t[r],e))}function eg(t,e){return Zr(t)?t.signal?e.signalRef(t.signal):Dn("Unsupported object: "+pi(t)):t}function Vit(t,e){return t.signal?e.signalRef(t.signal):t.map(n=>eg(n,e))}function Git(t){Dn("Can not find data set: "+pi(t))}function D8t(t,e,n){if(t)return t.signal?n.signalRef(t.signal):(ni(t)?XHt:t.fields?ZHt:KHt)(t,e,n);e.domainMin==null&&e.domainMax==null||Dn("No scale domain defined for domainMin/domainMax to override.")}function XHt(t,e,n){return t.map(r=>eg(r,n))}function KHt(t,e,n){let r=n.getData(t.data);return r||Git(t.data),ix(e.type)?r.valuesRef(n,t.field,R8t(t.sort,!1)):Nq(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)}function ZHt(t,e,n){let r=t.data,a=t.fields.reduce((s,h)=>(h=wi(h)?{data:r,field:h}:ni(h)||h.signal?function(d,g){let b="_:vega:_"+YHt++,_=M1({});if(ni(d))_.value={$ingest:d};else if(d.signal){let E="setdata("+pi(b)+","+d.signal+")";_.params.input=g.signalRef(E)}return g.addDataPipeline(b,[_,qC({})]),{data:b,field:"data"}}(h,n):h,s.push(h),s),[]);return(ix(e.type)?QHt:Nq(e.type)?JHt:tYt)(t,n,a)}function QHt(t,e,n){let r=R8t(t.sort,!0),a,s,h=n.map(b=>{let _=e.getData(b.data);return _||Git(b.data),_.countsRef(e,b.field,r)}),d={groupby:T2t,pulse:h};r&&(a=r.op||"count",s=r.field?Uit(a,r.field):"count",d.ops=[M8t[a]],d.fields=[e.fieldRef(s)],d.as=[s]),a=e.add(_8t(d));let g=e.add(M1({pulse:da(a)}));return s=e.add(HHt({field:T2t,sort:e.sortRef(r),pulse:da(g)})),da(s)}function R8t(t,e){return t&&(t.field||t.op?t.field||t.op==="count"?e&&t.field&&t.op&&!M8t[t.op]&&Dn("Multiple domain scales can not be sorted using "+t.op):Dn("No field provided for sort aggregate op: "+t.op):Zr(t)?t.field="key":t={field:"key"}),t}function JHt(t,e,n){let r=n.map(a=>{let s=e.getData(a.data);return s||Git(a.data),s.domainRef(e,a.field)});return da(e.add(zHt({values:r})))}function tYt(t,e,n){let r=n.map(a=>{let s=e.getData(a.data);return s||Git(a.data),s.extentRef(e,a.field)});return da(e.add($Ht({extents:r})))}function F8t(t,e,n){let r=e.config.range,a=t.range;if(a.signal)return e.signalRef(a.signal);if(wi(a)){if(r&&In(r,a))return F8t(t=nn({},t,{range:r[a]}),e,n);a==="width"?a=[0,{signal:"width"}]:a==="height"?a=ix(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Dn("Unrecognized scale range value: "+pi(a))}else{if(a.scheme)return n.scheme=ni(a.scheme)?Vit(a.scheme,e):eg(a.scheme,e),a.extent&&(n.schemeExtent=Vit(a.extent,e)),void(a.count&&(n.schemeCount=eg(a.count,e)));if(a.step)return void(n.rangeStep=eg(a.step,e));if(ix(t.type)&&!ni(a))return D8t(a,t,e);ni(a)||Dn("Unsupported range type: "+pi(a))}return a.map(s=>(ni(s)?Vit:eg)(s,e))}function M2t(t,e,n){return ni(t)?t.map(r=>M2t(r,e,n)):Zr(t)?t.signal?n.signalRef(t.signal):e==="fit"?t:Dn("Unsupported parameter object: "+pi(t)):t}let D1="top",sM="left",uM="right",ok="bottom",O8t="center",eYt="vertical",nYt="start",rYt="end",D2t="index",R2t="label",iYt="offset",lM="perc",aYt="perc2",ng="value",WU="guide-label",F2t="guide-title",oYt="group-title",sYt="group-subtitle",L8t="symbol",Hit="gradient",O2t="discrete",L2t="size",$2t=[L2t,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],VU={name:1,style:1,interactive:1},Wo={value:0},rg={value:1},Yit="group",$8t="rect",z2t="rule",uYt="symbol",XC="text";function GU(t){return t.type=Yit,t.interactive=t.interactive||!1,t}function Vp(t,e){let n=(r,a)=>N1(t[r],N1(e[r],a));return n.isVertical=r=>eYt===N1(t.direction,e.direction||(r?e.symbolDirection:e.gradientDirection)),n.gradientLength=()=>N1(t.gradientLength,e.gradientLength||e.gradientWidth),n.gradientThickness=()=>N1(t.gradientThickness,e.gradientThickness||e.gradientHeight),n.entryColumns=()=>N1(t.columns,N1(e.columns,+n.isVertical(!0))),n}function z8t(t,e){let n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function qit(t,e,n){return`item.anchor === '${nYt}' ? ${t} : item.anchor === '${rYt}' ? ${e} : ${n}`}let P2t=qit(pi(sM),pi(uM),pi(O8t));function P8t(t,e){return e?t?Zr(t)?Object.assign({},t,{offset:P8t(t.offset,e)}):{value:t,offset:e}:e:t}function K0(t,e){return e?(t.name=e.name,t.style=e.style||t.style,t.interactive=!!e.interactive,t.encode=aM(t.encode,e,VU)):t.interactive=!1,t}function lYt(t,e,n,r){let a=Vp(t,n),s=a.isVertical(),h=a.gradientThickness(),d=a.gradientLength(),g,b,_,E,I;s?(b=[0,1],_=[0,0],E=h,I=d):(b=[0,0],_=[1,0],E=d,I=h);let R={enter:g={opacity:Wo,x:Wo,y:Wo,width:$h(E),height:$h(I)},update:nn({},g,{opacity:rg,fill:{gradient:e,start:b,stop:_}}),exit:{opacity:Wo}};return fd(R,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")}),K0({type:$8t,role:dHt,encode:R},r)}function cYt(t,e,n,r,a){let s=Vp(t,n),h=s.isVertical(),d=s.gradientThickness(),g=s.gradientLength(),b,_,E,I,R="";h?(b="y",E="y2",_="x",I="width",R="1-"):(b="x",E="x2",_="y",I="height");let z={opacity:Wo,fill:{scale:e,field:ng}};z[b]={signal:R+"datum."+lM,mult:g},z[_]=Wo,z[E]={signal:R+"datum."+aYt,mult:g},z[I]=$h(d);let P={enter:z,update:nn({},z,{opacity:rg}),exit:{opacity:Wo}};return fd(P,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),K0({type:$8t,role:cHt,key:ng,from:a,encode:P},r)}let hYt=`datum.${lM}<=0?"${sM}":datum.${lM}>=1?"${uM}":"${O8t}"`,dYt=`datum.${lM}<=0?"${ok}":datum.${lM}>=1?"${D1}":"middle"`;function B8t(t,e,n,r){let a=Vp(t,e),s=a.isVertical(),h=$h(a.gradientThickness()),d=a.gradientLength(),g,b,_,E,I=a("labelOverlap"),R="",z={enter:g={opacity:Wo},update:b={opacity:rg,text:{field:R2t}},exit:{opacity:Wo}};return fd(z,{fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:N1(t.labelLimit,e.gradientLabelLimit)}),s?(g.align={value:"left"},g.baseline=b.baseline={signal:dYt},_="y",E="x",R="1-"):(g.align=b.align={signal:hYt},g.baseline={value:"top"},_="x",E="y"),g[_]=b[_]={signal:R+"datum."+lM,mult:d},g[E]=b[E]=h,h.offset=N1(t.labelOffset,e.gradientLabelOffset)||0,I=I?{separation:a("labelSeparation"),method:I,order:"datum."+D2t}:void 0,K0({type:XC,role:m8t,style:WU,key:ng,from:r,encode:z,overlap:I},n)}function fYt(t,e,n,r,a){let s=Vp(t,e),h=n.entries,d=!(!h||!h.interactive),g=h?h.name:void 0,b=s("clipHeight"),_=s("symbolOffset"),E={data:"value"},I=`(${a}) ? datum.${iYt} : datum.${L2t}`,R=b?$h(b):{field:L2t},z=`datum.${D2t}`,P=`max(1, ${a})`,rt,ot,at,dt,ct;R.mult=.5,rt={enter:ot={opacity:Wo,x:{signal:I,mult:.5,offset:_},y:R},update:at={opacity:rg,x:ot.x,y:ot.y},exit:{opacity:Wo}};let Ct=null,Et=null;t.fill||(Ct=e.symbolBaseFillColor,Et=e.symbolBaseStrokeColor),fd(rt,{fill:s("symbolFillColor",Ct),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",Et),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),$2t.forEach(jt=>{t[jt]&&(at[jt]=ot[jt]={scale:t[jt],field:ng})});let Rt=K0({type:uYt,role:fHt,key:ng,from:E,clip:!!b||void 0,encode:rt},n.symbols),Ot=$h(_);Ot.offset=s("labelOffset"),rt={enter:ot={opacity:Wo,x:{signal:I,offset:Ot},y:R},update:at={opacity:rg,text:{field:R2t},x:ot.x,y:ot.y},exit:{opacity:Wo}},fd(rt,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});let Wt=K0({type:XC,role:m8t,style:WU,key:ng,from:E,encode:rt},n.labels);return rt={enter:{noBound:{value:!b},width:Wo,height:b?$h(b):Wo,opacity:Wo},exit:{opacity:Wo},update:at={opacity:rg,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?(dt=`ceil(item.mark.items.length / ${P})`,at.row.signal=`${z}%${dt}`,at.column.signal=`floor(${z} / ${dt})`,ct={field:["row",z]}):(at.row.signal=`floor(${z} / ${P})`,at.column.signal=`${z} % ${P}`,ct={field:z}),at.column.signal=`(${a})?${at.column.signal}:${z}`,GU({role:_2t,from:r={facet:{data:r,name:"value",groupby:D2t}},encode:aM(rt,h,VU),marks:[Rt,Wt],name:g,interactive:d,sort:ct})}let B2t='item.orient === "left"',j2t='item.orient === "right"',Xit=`(${B2t} || ${j2t})`,pYt=`datum.vgrad && ${Xit}`,mYt=qit('"top"','"bottom"','"middle"'),gYt=`datum.vgrad && ${j2t} ? (${qit('"right"','"left"','"center"')}) : (${Xit} && !(datum.vgrad && ${B2t})) ? "left" : ${P2t}`,yYt=`item._anchor || (${Xit} ? "middle" : "start")`,vYt=`${pYt} ? (${B2t} ? -90 : 90) : 0`,bYt=`${Xit} ? (datum.vgrad ? (${j2t} ? "bottom" : "top") : ${mYt}) : "top"`;function wYt(t,e){let n;return Zr(t)&&(t.signal?n=t.signal:t.path?n="pathShape("+j8t(t.path)+")":t.sphere&&(n="geoShape("+j8t(t.sphere)+', {type: "Sphere"})')),n?e.signalRef(n):!!t}function j8t(t){return Zr(t)&&t.signal?t.signal:pi(t)}function U8t(t){let e=t.role||"";return e.indexOf("axis")&&e.indexOf("legend")&&e.indexOf("title")?t.type===Yit?_2t:e||k2t:e}function xYt(t){return{marktype:t.type,name:t.name||void 0,role:t.role||U8t(t),zindex:+t.zindex||void 0,aria:t.aria,description:t.description}}function kYt(t,e){return t&&t.signal?e.signalRef(t.signal):t!==!1}function U2t(t,e){let n=gE(t.type);n||Dn("Unrecognized transform type: "+pi(t.type));let r=Bit(n.type.toLowerCase(),null,W8t(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(r)),r.metadata=n.metadata||{},r}function W8t(t,e,n){let r={},a=t.params.length;for(let s=0;s<a;++s){let h=t.params[s];r[h.name]=SYt(h,e,n)}return r}function SYt(t,e,n){let r=t.type,a=e[t.name];return r==="index"?function(s,h,d){return wi(h.from)||Dn('Lookup "from" parameter must be a string literal.'),d.getData(h.from).lookupRef(d,h.key)}(0,e,n):a!==void 0?r==="param"?function(s,h,d){let g=h[s.name];return s.array?(ni(g)||Dn("Expected an array of sub-parameters. Instead: "+pi(g)),g.map(b=>G8t(s,b,d))):G8t(s,g,d)}(t,e,n):r==="projection"?n.projectionRef(e[t.name]):t.array&&!ah(a)?a.map(s=>V8t(t,s,n)):V8t(t,a,n):void(t.required&&Dn("Missing required "+pi(e.type)+" parameter: "+pi(t.name)))}function V8t(t,e,n){let r=t.type;if(ah(e))return H8t(r)?Dn("Expression references can not be signals."):W2t(r)?n.fieldRef(e):Y8t(r)?n.compareRef(e):n.signalRef(e.signal);{let a=t.expr||W2t(r);return a&&_Yt(e)?n.exprRef(e.expr,e.as):a&&CYt(e)?jU(e.field,e.as):H8t(r)?ky(e,n):EYt(r)?da(n.getData(e).values):W2t(r)?jU(e):Y8t(r)?n.compareRef(e):e}}function G8t(t,e,n){let r=t.params.length,a;for(let h=0;h<r;++h){a=t.params[h];for(let d in a.key)if(a.key[d]!==e[d]){a=null;break}if(a)break}a||Dn("Unsupported parameter: "+pi(e));let s=nn(W8t(a,e,n),a.key);return da(n.add(BHt(s)))}let _Yt=t=>t&&t.expr,CYt=t=>t&&t.field,EYt=t=>t==="data",H8t=t=>t==="expr",W2t=t=>t==="field",Y8t=t=>t==="compare";function Kit(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:da(e.getData(t.data).output)}function KC(t,e,n,r,a){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=a,this.index={}}function q8t(t){return wi(t)?t:null}function X8t(t,e,n){let r=Uit(n.op,n.field),a;if(e.ops){for(let s=0,h=e.as.length;s<h;++s)if(e.as[s]===r)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((a=n.op.signal)?t.signalRef(a):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(r))}function HU(t,e,n,r,a,s,h){let d=e[n]||(e[n]={}),g=function(I){return Zr(I)?(I.order==="descending"?"-":"+")+Uit(I.op,I.field):""}(s),b,_,E=q8t(a);if(E!=null&&(t=e.scope,E+=g?"|"+g:"",b=d[E]),!b){let I=s?{field:T2t,pulse:e.countsRef(t,a,s)}:{field:t.fieldRef(a),pulse:da(e.output)};g&&(I.sort=t.sortRef(s)),_=t.add(Bit(r,void 0,I)),h&&(e.index[a]=_),b=da(_),E!=null&&(d[E]=b)}return b}function K8t(t,e,n){let r=t.remove,a=t.insert,s=t.toggle,h=t.modify,d=t.values,g=e.add(jit()),b=ky("if("+t.trigger+',modify("'+n+'",'+[a,r,s,h,d].map(_=>_??"null").join(",")+"),0)",e);g.update=b.$expr,g.params=b.$params}function Zit(t,e){let n=U8t(t),r=t.type===Yit,a=t.from&&t.from.facet,s=t.overlap,h,d,g,b,_,E,I,R=t.layout||n===_2t||n===S2t,z=n===k2t||R||a,P=function(Et,Rt,Ot){let Wt,jt,Ht,Vt,fe;return Et?(Wt=Et.facet)&&(Rt||Dn("Only group marks can be faceted."),Wt.field!=null?Vt=fe=Kit(Wt,Ot):(Et.data?fe=da(Ot.getData(Et.data).aggregate):(Ht=U2t(nn({type:"aggregate",groupby:et(Wt.groupby)},Wt.aggregate),Ot),Ht.params.key=Ot.keyRef(Wt.groupby),Ht.params.pulse=Kit(Wt,Ot),Vt=fe=da(Ot.add(Ht))),jt=Ot.keyRef(Wt.groupby,!0))):Vt=da(Ot.add(M1(null,[{}]))),Vt||(Vt=Kit(Et,Ot)),{key:jt,pulse:Vt,parent:fe}}(t.from,r,e);d=e.add(IHt({key:P.key||(t.key?jU(t.key):void 0),pulse:P.pulse,clean:!r}));let rt=da(d);d=g=e.add(M1({pulse:rt})),d=e.add(LHt({markdef:xYt(t),interactive:kYt(t.interactive,e),clip:wYt(t.clip,e),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:da(d)}));let ot=da(d);d=b=e.add(T8t(b8t(t.encode,t.type,n,t.style,e,{mod:!1,pulse:ot}))),d.params.parent=e.encode(),t.transform&&t.transform.forEach(Et=>{let Rt=U2t(Et,e),Ot=Rt.metadata;(Ot.generates||Ot.changes)&&Dn("Mark transforms should not generate new data."),Ot.nomod||(b.params.mod=!0),Rt.params.pulse=da(d),e.add(d=Rt)}),t.sort&&(d=e.add(GHt({sort:e.compareRef(t.sort),pulse:da(d)})));let at=da(d);(a||R)&&(R=e.add(N8t({layout:e.objectProperty(t.layout),legends:e.legends,mark:ot,pulse:at})),E=da(R));let dt=e.add(C8t({mark:ot,pulse:E||at}));I=da(dt),r&&(z&&(h=e.operators,h.pop(),R&&h.pop()),e.pushState(at,E||I,rt),a?function(Et,Rt,Ot){let Wt=Et.from.facet,jt=Wt.name,Ht=Kit(Wt,Rt),Vt;Wt.name||Dn("Facet must have a name: "+pi(Wt)),Wt.data||Dn("Facet must reference a data set: "+pi(Wt)),Wt.field?Vt=Rt.add(A8t({field:Rt.fieldRef(Wt.field),pulse:Ht})):Wt.groupby?Vt=Rt.add(MHt({key:Rt.keyRef(Wt.groupby),group:da(Rt.proxy(Ot.parent)),pulse:Ht})):Dn("Facet must specify groupby or field: "+pi(Wt));let fe=Rt.fork(),se=fe.add(M1()),he=fe.add(qC({pulse:da(se)}));fe.addData(jt,new KC(fe,se,se,he)),fe.addSignal("parent",null),Vt.params.subflow={$subflow:fe.parse(Et).toRuntime()}}(t,e,P):z?function(Et,Rt,Ot){let Wt=Rt.add(A8t({pulse:Ot.pulse})),jt=Rt.fork();jt.add(qC()),jt.addSignal("parent",null),Wt.params.subflow={$subflow:jt.parse(Et).toRuntime()}}(t,e,P):e.parse(t),e.popState(),z&&(R&&h.push(R),h.push(dt))),s&&(I=function(Et,Rt,Ot){let Wt=Et.method,jt=Et.bound,Ht=Et.separation,Vt={separation:ah(Ht)?Ot.signalRef(Ht.signal):Ht,method:ah(Wt)?Ot.signalRef(Wt.signal):Wt,pulse:Rt};if(Et.order&&(Vt.sort=Ot.compareRef({field:Et.order})),jt){let fe=jt.tolerance;Vt.boundTolerance=ah(fe)?Ot.signalRef(fe.signal):+fe,Vt.boundScale=Ot.scaleRef(jt.scale),Vt.boundOrient=jt.orient}return da(Ot.add(PHt(Vt)))}(s,I,e));let ct=e.add(I8t({pulse:I})),Ct=e.add(qC({pulse:da(ct)},void 0,e.parent()));t.name!=null&&(_=t.name,e.addData(_,new KC(e,g,ct,Ct)),t.on&&t.on.forEach(Et=>{(Et.insert||Et.remove||Et.toggle)&&Dn("Marks only support modify triggers."),K8t(Et,e,_)}))}function TYt(t,e){let n=e.config.legend,r=t.encode||{},a=Vp(t,n),s=r.legend||{},h=s.name||void 0,d=s.interactive,g=s.style,b={},_,E,I,R=0;$2t.forEach(at=>t[at]?(b[at]=t[at],R=R||t[at]):0),R||Dn("Missing valid scale for legend.");let z=function(at,dt){let ct=at.type||L8t;return at.type||function(Ct){return $2t.reduce((Et,Rt)=>Et+(Ct[Rt]?1:0),0)}(at)!==1||!at.fill&&!at.stroke||(ct=GO(dt)?Hit:HO(dt)?O2t:L8t),ct!==Hit?ct:HO(dt)?O2t:Hit}(t,e.scaleType(R)),P={title:t.title!=null,scales:b,type:z,vgrad:z!=="symbol"&&a.isVertical()},rt=da(e.add(M1(null,[P]))),ot=da(e.add(FHt(E={type:z,scale:e.scaleRef(R),count:e.objectProperty(a("tickCount")),limit:e.property(a("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return z===Hit?(I=[lYt(t,R,n,r.gradient),B8t(t,n,r.labels,ot)],E.count=E.count||e.signalRef(`max(2,2*floor((${YC(a.gradientLength())})/100))`)):z===O2t?I=[cYt(t,R,n,r.gradient,ot),B8t(t,n,r.labels,ot)]:(_=function(at,dt){let ct=Vp(at,dt);return{align:ct("gridAlign"),columns:ct.entryColumns(),center:{row:!0,column:!1},padding:{row:ct("rowPadding"),column:ct("columnPadding")}}}(t,n),I=[fYt(t,n,r,ot,YC(_.columns))],E.size=function(at,dt,ct){let Ct=YC(Z8t("size",at,ct)),Et=YC(Z8t("strokeWidth",at,ct)),Rt=YC(function(Ot,Wt,jt){return z8t("fontSize",Ot)||function(Ht,Vt,fe){let se=Vt.config.style[fe];return se&&se[Ht]}("fontSize",Wt,jt)}(ct[1].encode,dt,WU));return ky(`max(ceil(sqrt(${Ct})+${Et}),${Rt})`,dt)}(t,e,I[0].marks)),I=[GU({role:hHt,from:rt,encode:{enter:{x:{value:0},y:{value:0}}},marks:I,layout:_,interactive:d})],P.title&&I.push(function(at,dt,ct,Ct){let Et=Vp(at,dt),Rt={enter:{opacity:Wo},update:{opacity:rg,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Wo}};return fd(Rt,{orient:Et("titleOrient"),_anchor:Et("titleAnchor"),anchor:{signal:yYt},angle:{signal:vYt},align:{signal:gYt},baseline:{signal:bYt},text:at.title,fill:Et("titleColor"),fillOpacity:Et("titleOpacity"),font:Et("titleFont"),fontSize:Et("titleFontSize"),fontStyle:Et("titleFontStyle"),fontWeight:Et("titleFontWeight"),limit:Et("titleLimit"),lineHeight:Et("titleLineHeight")},{align:Et("titleAlign"),baseline:Et("titleBaseline")}),K0({type:XC,role:pHt,style:F2t,from:Ct,encode:Rt},ct)}(t,n,r.title,rt)),Zit(GU({role:lHt,from:rt,encode:aM(AYt(a,t,n),s,VU),marks:I,aria:a("aria"),description:a("description"),zindex:a("zindex"),name:h,interactive:d,style:g}),e)}function AYt(t,e,n){let r={enter:{},update:{}};return fd(r,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType}),r}function Z8t(t,e,n){return e[t]?`scale("${e[t]}",datum)`:z8t(t,n[0].encode)}KC.fromEntries=function(t,e){let n=e.length,r=e[n-1],a=e[n-2],s=e[0],h=null,d=1;for(s&&s.type==="load"&&(s=e[1]),t.add(e[0]);d<n;++d)e[d].params.pulse=da(e[d-1]),t.add(e[d]),e[d].type==="aggregate"&&(h=e[d]);return new KC(t,s,a,r,h)},KC.prototype={countsRef(t,e,n){let r=this,a=r.counts||(r.counts={}),s=q8t(e),h,d,g;return s!=null&&(t=r.scope,h=a[s]),h?n&&n.field&&X8t(t,h.agg.params,n):(g={groupby:t.fieldRef(e,"key"),pulse:da(r.output)},n&&n.field&&X8t(t,g,n),d=t.add(_8t(g)),h=t.add(M1({pulse:da(d)})),h={agg:d,ref:da(h)},s!=null&&(a[s]=h)),h.ref},tuplesRef(){return da(this.values)},extentRef(t,e){return HU(t,this,"extent","extent",e,!1)},domainRef(t,e){return HU(t,this,"domain","values",e,!1)},valuesRef(t,e,n){return HU(t,this,"vals","values",e,n||!0)},lookupRef(t,e){return HU(t,this,"lookup","tupleindex",e,!1)},indataRef(t,e){return HU(t,this,"indata","tupleindex",e,!0,!0)}};let IYt=`item.orient==="${sM}"?-90:item.orient==="${uM}"?90:0`;function NYt(t,e){let n=Vp(t=wi(t)?{text:t}:t,e.config.title),r=t.encode||{},a=r.group||{},s=a.name||void 0,h=a.interactive,d=a.style,g=[],b=da(e.add(M1(null,[{}])));return g.push(function(_,E,I,R){let z={value:0},P=_.text,rt={enter:{opacity:z},update:{opacity:{value:1}},exit:{opacity:z}};return fd(rt,{text:P,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:E("dx"),dy:E("dy"),fill:E("color"),font:E("font"),fontSize:E("fontSize"),fontStyle:E("fontStyle"),fontWeight:E("fontWeight"),lineHeight:E("lineHeight")},{align:E("align"),angle:E("angle"),baseline:E("baseline")}),K0({type:XC,role:gHt,style:oYt,from:R,encode:rt},I)}(t,n,function(_){let E=_.encode;return E&&E.title||nn({name:_.name,interactive:_.interactive,style:_.style},E)}(t),b)),t.subtitle&&g.push(function(_,E,I,R){let z={value:0},P=_.subtitle,rt={enter:{opacity:z},update:{opacity:{value:1}},exit:{opacity:z}};return fd(rt,{text:P,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:E("dx"),dy:E("dy"),fill:E("subtitleColor"),font:E("subtitleFont"),fontSize:E("subtitleFontSize"),fontStyle:E("subtitleFontStyle"),fontWeight:E("subtitleFontWeight"),lineHeight:E("subtitleLineHeight")},{align:E("align"),angle:E("angle"),baseline:E("baseline")}),K0({type:XC,role:yHt,style:sYt,from:R,encode:rt},I)}(t,n,r.subtitle,b)),Zit(GU({role:mHt,from:b,encode:MYt(n,a),marks:g,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:h,style:d}),e)}function MYt(t,e){let n={enter:{},update:{}};return fd(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:P2t},angle:{signal:IYt},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),aM(n,e,VU)}function DYt(t,e){let n=[];t.transform&&t.transform.forEach(r=>{n.push(U2t(r,e))}),t.on&&t.on.forEach(r=>{K8t(r,e,t.name)}),e.addDataPipeline(t.name,function(r,a,s){let h=[],d,g,b,_,E,I=null,R=!1,z=!1;for(r.values?ah(r.values)||Wit(r.format)?(h.push(Q8t(a,r)),h.push(I=ZC())):h.push(I=ZC({$ingest:r.values,$format:r.format})):r.url?Wit(r.url)||Wit(r.format)?(h.push(Q8t(a,r)),h.push(I=ZC())):h.push(I=ZC({$request:r.url,$format:r.format})):r.source&&(I=d=et(r.source).map(P=>da(a.getData(P).output)),h.push(null)),g=0,b=s.length;g<b;++g)_=s[g],E=_.metadata,I||E.source||h.push(I=ZC()),h.push(_),E.generates&&(z=!0),E.modifies&&!z&&(R=!0),E.source?I=_:E.changes&&(I=null);return d&&(b=d.length-1,h[0]=WHt({derive:R,pulse:b?d:d[0]}),(R||b)&&h.splice(1,0,ZC())),I||h.push(ZC()),h.push(qC({})),h}(t,e,n))}function ZC(t){let e=M1({},t);return e.metadata={source:!0},e}function Q8t(t,e){return OHt({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}let J8t=t=>t===ok||t===D1,Qit=(t,e,n)=>ah(t)?LYt(t.signal,e,n):t===sM||t===D1?e:n,zh=(t,e,n)=>ah(t)?FYt(t.signal,e,n):J8t(t)?e:n,R1=(t,e,n)=>ah(t)?OYt(t.signal,e,n):J8t(t)?n:e,tEt=(t,e,n)=>ah(t)?$Yt(t.signal,e,n):t===D1?{value:e}:{value:n},RYt=(t,e,n)=>ah(t)?zYt(t.signal,e,n):t===uM?{value:e}:{value:n},FYt=(t,e,n)=>eEt(`${t} === '${D1}' || ${t} === '${ok}'`,e,n),OYt=(t,e,n)=>eEt(`${t} !== '${D1}' && ${t} !== '${ok}'`,e,n),LYt=(t,e,n)=>V2t(`${t} === '${sM}' || ${t} === '${D1}'`,e,n),$Yt=(t,e,n)=>V2t(`${t} === '${D1}'`,e,n),zYt=(t,e,n)=>V2t(`${t} === '${uM}'`,e,n),eEt=(t,e,n)=>(e=e!=null?$h(e):e,n=n!=null?$h(n):n,nEt(e)&&nEt(n)?{signal:`${t} ? (${e=e?e.signal||pi(e.value):null}) : (${n=n?n.signal||pi(n.value):null})`}:[nn({test:t},e)].concat(n||[])),nEt=t=>t==null||Object.keys(t).length===1,V2t=(t,e,n)=>({signal:`${t} ? (${cM(e)}) : (${cM(n)})`}),PYt=(t,e,n,r,a)=>({signal:(r!=null?`${t} === '${sM}' ? (${cM(r)}) : `:"")+(n!=null?`${t} === '${ok}' ? (${cM(n)}) : `:"")+(a!=null?`${t} === '${uM}' ? (${cM(a)}) : `:"")+(e!=null?`${t} === '${D1}' ? (${cM(e)}) : `:"")+"(null)"}),cM=t=>ah(t)?t.signal:t==null?null:pi(t),BYt=(t,e)=>e===0?0:ah(t)?{signal:`(${t.signal}) * ${e}`}:{value:t*e},hM=(t,e)=>{let n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function dM(t,e,n,r){let a;if(e&&In(e,t))return e[t];if(In(n,t))return n[t];if(t.startsWith("title")){switch(t){case"titleColor":a="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":a=t[5].toLowerCase()+t.slice(6)}return r[F2t][a]}if(t.startsWith("label")){switch(t){case"labelColor":a="fill";break;case"labelFont":case"labelFontSize":a=t[5].toLowerCase()+t.slice(6)}return r[WU][a]}return null}function rEt(t){let e={};for(let n of t)if(n)for(let r in n)e[r]=1;return Object.keys(e)}function iEt(t,e){return{scale:t.scale,range:e}}function jYt(t,e,n,r,a){let s=Vp(t,e),h=t.orient,d=t.gridScale,g=Qit(h,1,-1),b=function(at,dt){if(dt!==1)if(Zr(at)){let ct=at=nn({},at);for(;ct.mult!=null;){if(!Zr(ct.mult))return ct.mult=ah(dt)?{signal:`(${ct.mult}) * (${dt.signal})`}:ct.mult*dt,at;ct=ct.mult=nn({},ct.mult)}ct.mult=dt}else at=ah(dt)?{signal:`(${dt.signal}) * (${at||0})`}:dt*(at||0);return at}(t.offset,g),_,E,I,R={enter:_={opacity:Wo},update:I={opacity:rg},exit:E={opacity:Wo}};fd(R,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});let z={scale:t.scale,field:ng,band:a.band,extra:a.extra,offset:a.offset,round:s("tickRound")},P=zh(h,{signal:"height"},{signal:"width"}),rt=d?{scale:d,range:0,mult:g,offset:b}:{value:0,offset:b},ot=d?{scale:d,range:1,mult:g,offset:b}:nn(P,{mult:g,offset:b});return _.x=I.x=zh(h,z,rt),_.y=I.y=R1(h,z,rt),_.x2=I.x2=R1(h,ot),_.y2=I.y2=zh(h,ot),E.x=zh(h,z),E.y=R1(h,z),K0({type:z2t,role:aHt,key:ng,from:r,encode:R},n)}function G2t(t,e,n,r,a){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+a+")"}}function UYt(t,e,n,r){let a=Vp(t,e),s=t.orient,h=Qit(s,-1,1),d,g,b={enter:d={opacity:Wo,anchor:$h(a("titleAnchor",null)),align:{signal:P2t}},update:g=nn({},d,{opacity:rg,text:$h(t.title)}),exit:{opacity:Wo}},_={signal:`lerp(range("${t.scale}"), ${qit(0,1,.5)})`};return g.x=zh(s,_),g.y=R1(s,_),d.angle=zh(s,Wo,BYt(h,90)),d.baseline=zh(s,tEt(s,ok,D1),{value:ok}),g.angle=d.angle,g.baseline=d.baseline,fd(b,{fill:a("titleColor"),fillOpacity:a("titleOpacity"),font:a("titleFont"),fontSize:a("titleFontSize"),fontStyle:a("titleFontStyle"),fontWeight:a("titleFontWeight"),limit:a("titleLimit"),lineHeight:a("titleLineHeight")},{align:a("titleAlign"),angle:a("titleAngle"),baseline:a("titleBaseline")}),function(E,I,R,z){let P=(at,dt)=>at!=null?(R.update[dt]=hM($h(at),R.update[dt]),!1):!oM(dt,z),rt=P(E("titleX"),"x"),ot=P(E("titleY"),"y");R.enter.auto=ot===rt?$h(ot):zh(I,$h(ot),$h(rt))}(a,s,b,n),b.update.align=hM(b.update.align,d.align),b.update.angle=hM(b.update.angle,d.angle),b.update.baseline=hM(b.update.baseline,d.baseline),K0({type:XC,role:uHt,style:F2t,from:r,encode:b},n)}function WYt(t,e){let n=function(P,rt){var ot,at,dt,ct=rt.config,Ct=ct.style,Et=ct.axis,Rt=rt.scaleType(P.scale)==="band"&&ct.axisBand,Ot=P.orient;if(ah(Ot)){let Wt=rEt([ct.axisX,ct.axisY]),jt=rEt([ct.axisTop,ct.axisBottom,ct.axisLeft,ct.axisRight]);for(dt of(ot={},Wt))ot[dt]=zh(Ot,dM(dt,ct.axisX,Et,Ct),dM(dt,ct.axisY,Et,Ct));for(dt of(at={},jt))at[dt]=PYt(Ot.signal,dM(dt,ct.axisTop,Et,Ct),dM(dt,ct.axisBottom,Et,Ct),dM(dt,ct.axisLeft,Et,Ct),dM(dt,ct.axisRight,Et,Ct))}else ot=Ot===D1||Ot===ok?ct.axisX:ct.axisY,at=ct["axis"+Ot[0].toUpperCase()+Ot.slice(1)];return ot||at||Rt?nn({},Et,ot,at,Rt):Et}(t,e),r=t.encode||{},a=r.axis||{},s=a.name||void 0,h=a.interactive,d=a.style,g=Vp(t,n),b=function(P){let rt=P("tickBand"),ot,at,dt=P("tickOffset");return rt?rt.signal?(ot={signal:`(${rt.signal}) === 'extent' ? 1 : 0.5`},at={signal:`(${rt.signal}) === 'extent'`},Zr(dt)||(dt={signal:`(${rt.signal}) === 'extent' ? 0 : ${dt}`})):rt==="extent"?(ot=1,at=!0,dt=0):(ot=.5,at=!1):(ot=P("bandPosition"),at=P("tickExtra")),{extra:at,band:ot,offset:dt}}(g),_={scale:t.scale,ticks:!!g("ticks"),labels:!!g("labels"),grid:!!g("grid"),domain:!!g("domain"),title:t.title!=null},E=da(e.add(M1({},[_]))),I=da(e.add(AHt({scale:e.scaleRef(t.scale),extra:e.property(b.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),R=[],z;return _.grid&&R.push(jYt(t,n,r.grid,I,b)),_.ticks&&(z=g("tickSize"),R.push(function(P,rt,ot,at,dt,ct){let Ct=Vp(P,rt),Et=P.orient,Rt=Qit(Et,-1,1),Ot,Wt,jt,Ht={enter:Ot={opacity:Wo},update:jt={opacity:rg},exit:Wt={opacity:Wo}};fd(Ht,{stroke:Ct("tickColor"),strokeCap:Ct("tickCap"),strokeDash:Ct("tickDash"),strokeDashOffset:Ct("tickDashOffset"),strokeOpacity:Ct("tickOpacity"),strokeWidth:Ct("tickWidth")});let Vt=$h(dt);Vt.mult=Rt;let fe={scale:P.scale,field:ng,band:ct.band,extra:ct.extra,offset:ct.offset,round:Ct("tickRound")};return jt.y=Ot.y=zh(Et,Wo,fe),jt.y2=Ot.y2=zh(Et,Vt),Wt.x=zh(Et,fe),jt.x=Ot.x=R1(Et,Wo,fe),jt.x2=Ot.x2=R1(Et,Vt),Wt.y=R1(Et,fe),K0({type:z2t,role:sHt,key:ng,from:at,encode:Ht},ot)}(t,n,r.ticks,I,z,b))),_.labels&&(z=_.ticks?z:0,R.push(function(P,rt,ot,at,dt,ct){let Ct=Vp(P,rt),Et=P.orient,Rt=P.scale,Ot=Qit(Et,-1,1),Wt=YC(Ct("labelFlush")),jt=YC(Ct("labelFlushOffset")),Ht=Ct("labelAlign"),Vt=Ct("labelBaseline"),fe,se=Wt===0||!!Wt,he=$h(dt);he.mult=Ot,he.offset=$h(Ct("labelPadding")||0),he.offset.mult=Ot;let _e={scale:Rt,field:ng,band:.5,offset:P8t(ct.offset,Ct("labelOffset"))},Ve=zh(Et,se?G2t(Rt,Wt,'"left"','"right"','"center"'):{value:"center"},RYt(Et,"left","right")),gn=zh(Et,tEt(Et,"bottom","top"),se?G2t(Rt,Wt,'"top"','"bottom"','"middle"'):{value:"middle"}),$n=G2t(Rt,Wt,`-(${jt})`,jt,0);se=se&&jt;let Gn={opacity:Wo,x:zh(Et,_e,he),y:R1(Et,_e,he)},qe={enter:Gn,update:fe={opacity:rg,text:{field:R2t},x:Gn.x,y:Gn.y,align:Ve,baseline:gn},exit:{opacity:Wo,x:Gn.x,y:Gn.y}};fd(qe,{dx:!Ht&&se?zh(Et,$n):null,dy:!Vt&&se?R1(Et,$n):null}),fd(qe,{angle:Ct("labelAngle"),fill:Ct("labelColor"),fillOpacity:Ct("labelOpacity"),font:Ct("labelFont"),fontSize:Ct("labelFontSize"),fontWeight:Ct("labelFontWeight"),fontStyle:Ct("labelFontStyle"),limit:Ct("labelLimit"),lineHeight:Ct("labelLineHeight")},{align:Ht,baseline:Vt});let tr=Ct("labelBound"),er=Ct("labelOverlap");return er=er||tr?{separation:Ct("labelSeparation"),method:er,order:"datum.index",bound:tr?{scale:Rt,orient:Et,tolerance:tr}:null}:void 0,fe.align!==Ve&&(fe.align=hM(fe.align,Ve)),fe.baseline!==gn&&(fe.baseline=hM(fe.baseline,gn)),K0({type:XC,role:oHt,style:WU,key:ng,from:at,encode:qe,overlap:er},ot)}(t,n,r.labels,I,z,b))),_.domain&&R.push(function(P,rt,ot,at){let dt=Vp(P,rt),ct=P.orient,Ct,Et,Rt={enter:Ct={opacity:Wo},update:Et={opacity:rg},exit:{opacity:Wo}};fd(Rt,{stroke:dt("domainColor"),strokeCap:dt("domainCap"),strokeDash:dt("domainDash"),strokeDashOffset:dt("domainDashOffset"),strokeWidth:dt("domainWidth"),strokeOpacity:dt("domainOpacity")});let Ot=iEt(P,0),Wt=iEt(P,1);return Ct.x=Et.x=zh(ct,Ot,Wo),Ct.x2=Et.x2=zh(ct,Wt),Ct.y=Et.y=R1(ct,Ot,Wo),Ct.y2=Et.y2=R1(ct,Wt),K0({type:z2t,role:iHt,from:at,encode:Rt},ot)}(t,n,r.domain,E)),_.title&&R.push(UYt(t,n,r.title,E)),Zit(GU({role:rHt,from:E,encode:aM(VYt(g,t),a,VU),marks:R,aria:g("aria"),description:g("description"),zindex:g("zindex"),name:s,interactive:h,style:d}),e)}function VYt(t,e){let n={enter:{},update:{}};return fd(n,{orient:t("orient"),offset:t("offset")||0,position:N1(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:`abs(span(range("${e.scale}")))`},translate:t("translate"),format:e.format,formatType:e.formatType}),n}function aEt(t,e,n){let r=et(t.signals),a=et(t.scales);return n||r.forEach(s=>x8t(s,e)),et(t.projections).forEach(s=>function(h,d){let g=d.config.projection||{},b={};for(let _ in h)_!=="name"&&(b[_]=M2t(h[_],_,d));for(let _ in g)b[_]==null&&(b[_]=M2t(g[_],_,d));d.addProjection(h.name,b)}(s,e)),a.forEach(s=>function(h,d){let g=h.type||"linear";Tq(g)||Dn("Unrecognized scale type: "+pi(g)),d.addScale(h.name,{type:g,domain:void 0})}(s,e)),et(t.data).forEach(s=>DYt(s,e)),a.forEach(s=>qHt(s,e)),(n||r).forEach(s=>function(h,d){let g=d.getSignal(h.name),b=h.update;h.init&&(b?Dn("Signals can not include both init and update expressions."):(b=h.init,g.initonly=!0)),b&&(b=ky(b,d),g.update=b.$expr,g.params=b.$params),h.on&&h.on.forEach(_=>EHt(_,d,g.id))}(s,e)),et(t.axes).forEach(s=>WYt(s,e)),et(t.marks).forEach(s=>Zit(s,e)),et(t.legends).forEach(s=>TYt(s,e)),t.title&&NYt(t.title,e),e.parseLambdas(),e}let GYt=t=>aM({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t);function HYt(t,e){let n=e.config,r=da(e.root=e.add(jit())),a=function(b,_){let E=P=>N1(b[P],_[P]),I=[YU("background",E("background")),YU("autosize",tHt(E("autosize"))),YU("padding",nHt(E("padding"))),YU("width",E("width")||0),YU("height",E("height")||0)],R=I.reduce((P,rt)=>(P[rt.name]=rt,P),{}),z={};return et(b.signals).forEach(P=>{In(R,P.name)?P=nn(R[P.name],P):I.push(P),z[P.name]=P}),et(_.signals).forEach(P=>{In(z,P.name)||In(R,P.name)||I.push(P)}),I}(t,n);a.forEach(b=>x8t(b,e)),e.description=t.description||n.description,e.eventConfig=n.events,e.legends=e.objectProperty(n.legend&&n.legend.layout),e.locale=n.locale;let s=e.add(M1()),h=e.add(T8t(b8t(GYt(t.encode),Yit,S2t,t.style,e,{pulse:da(s)}))),d=e.add(N8t({layout:e.objectProperty(t.layout),legends:e.legends,autosize:e.signalRef("autosize"),mark:r,pulse:da(h)}));e.operators.pop(),e.pushState(da(h),da(d),null),aEt(t,e,a),e.operators.push(d);let g=e.add(C8t({mark:r,pulse:da(d)}));return g=e.add(I8t({pulse:da(g)})),g=e.add(qC({pulse:da(g)})),e.addData("root",new KC(e,s,s,g)),e}function YU(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function oEt(t,e){this.config=t||{},this.options=e||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function sEt(t){this.config=t.config,this.options=t.options,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}function H2t(t){return(ni(t)?YYt:qYt)(t)}function YYt(t){let e=t.length,n="[";for(let r=0;r<e;++r){let a=t[r];n+=(r>0?",":"")+(Zr(a)?a.signal||H2t(a):pi(a))}return n+"]"}function qYt(t){let e,n,r="{",a=0;for(e in t)n=t[e],r+=(++a>1?",":"")+pi(e)+":"+(Zr(n)?n.signal||H2t(n):pi(n));return r+"}"}function XYt(t,e,n){return Zr(t)||Dn("Input Vega specification must be an object."),e=function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return a.reduce((h,d)=>{for(let g in d)if(g==="signals")h.signals=Yh(h.signals,d.signals);else{let b=g==="legend"?{layout:1}:g==="style"||null;Wl(h,g,d[g],b)}return h},{})}(function(){let r="sans-serif",a="#4c78a8",s="#000",h="#888",d="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:a},area:{fill:a},image:null,line:{stroke:a,strokeWidth:2},path:{stroke:a},rect:{fill:a},rule:{stroke:s},shape:{stroke:a},symbol:{fill:a,size:64},text:{fill:s,font:r,fontSize:11},trail:{fill:a,size:2},style:{"guide-label":{fill:s,font:r,fontSize:10},"guide-title":{fill:s,font:r,fontSize:11,fontWeight:"bold"},"group-title":{fill:s,font:r,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:s,font:r,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:d}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:h,grid:!1,gridWidth:1,gridColor:d,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:h,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:d,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:h,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),e,t.config),HYt(t,new oEt(e,n)).toRuntime()}oEt.prototype=sEt.prototype={parse(t){return aEt(t,this)},fork(){return new sEt(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach(e=>{e.$ref=t.id}),t.refs=null),t},proxy(t){let e=t instanceof E2t?da(t):t;return this.add(UHt({value:e}))},addStream(t){return this.streams.push(t),t.id=this.id(),t},addUpdate(t){return this.updates.push(t),t},finish(){let t,e;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(r,a,s){let h,d;r&&(h=r.data||(r.data={}),d=h[a]||(h[a]=[]),d.push(s))}for(t in this.data){e=this.data[t],n(e.input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values");for(let r in e.index)n(e.index[r],t,"index:"+r)}return this},pushState(t,e,n){this._encode.push(da(this.add(qC({pulse:t})))),this._parent.push(e),this._lookup.push(n?da(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Ba(this._parent)},encode(){return Ba(this._encode)},lookup(){return Ba(this._lookup)},markpath(){let t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if(wi(t))return jU(t,e);t.signal||Dn("Unsupported field reference: "+pi(t));let n=t.signal,r=this.field[n];if(!r){let a={name:this.signalRef(n)};e&&(a.as=e),this.field[n]=r=da(this.add(DHt(a)))}return r},compareRef(t){let e=!1,n=s=>ah(s)?(e=!0,this.signalRef(s.signal)):function(h){return h&&h.expr}(s)?(e=!0,this.exprRef(s.expr)):s,r=et(t.field).map(n),a=et(t.order).map(n);return e?da(this.add(E8t({fields:r,orders:a}))):k8t(r,a)},keyRef(t,e){let n=!1,r=this.signals;return t=et(t).map(a=>ah(a)?(n=!0,da(r[a.signal])):a),n?da(this.add(RHt({fields:t,flat:e}))):function(a,s){let h={$key:a};return s&&(h.$flat=!0),h}(t,e)},sortRef(t){if(!t)return t;let e=Uit(t.op,t.field),n=t.order||"ascending";return n.signal?da(this.add(E8t({fields:e,orders:this.signalRef(n.signal)}))):k8t(e,n)},event(t,e){let n=t+":"+e;if(!this.events[n]){let r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},hasOwnSignal(t){return In(this.signals,t)},addSignal(t,e){this.hasOwnSignal(t)&&Dn("Duplicate signal name: "+pi(t));let n=e instanceof E2t?e:this.add(jit(e));return this.signals[t]=n},getSignal(t){return this.signals[t]||Dn("Unrecognized signal name: "+pi(t)),this.signals[t]},signalRef(t){return this.signals[t]?da(this.signals[t]):(In(this.lambdas,t)||(this.lambdas[t]=this.add(jit(null))),da(this.lambdas[t]))},parseLambdas(){let t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){let r=t[e],a=ky(r,this),s=this.lambdas[r];s.params=a.$params,s.update=a.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return t&&Zr(t)?this.signalRef(t.signal||H2t(t)):t},exprRef(t,e){let n={expr:ky(t,this)};return e&&(n.expr.$name=e),da(this.add(NHt(n)))},addBinding(t,e){this.bindings||Dn("Nested signals do not support binding: "+pi(t)),this.bindings.push(nn({signal:t},e))},addScaleProj(t,e){In(this.scales,t)&&Dn("Duplicate scale or projection name: "+pi(t)),this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,VHt(e))},addProjection(t,e){this.addScaleProj(t,jHt(e))},getScale(t){return this.scales[t]||Dn("Unrecognized scale name: "+pi(t)),this.scales[t]},scaleRef(t){return da(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){return In(this.data,t)&&Dn("Duplicate data set name: "+pi(t)),this.data[t]=e},getData(t){return this.data[t]||Dn("Undefined data set name: "+pi(t)),this.data[t]},addDataPipeline(t,e){return In(this.data,t)&&Dn("Duplicate data set name: "+pi(t)),this.addData(t,KC.fromEntries(this,e))}};let KYt=zc(["rule"]),uEt=zc(["group","image","rect"]);function Y2t(t){return(t+"").toLowerCase()}function qU(t,e,n){n.endsWith(";")||(n="return("+n+");");let r=Function(...e.concat(n));return t&&t.functions?r.bind(t.functions):r}var ZYt={operator:(t,e)=>qU(t,["_"],e.code),parameter:(t,e)=>qU(t,["datum","_"],e.code),event:(t,e)=>qU(t,["event"],e.code),handler:(t,e)=>qU(t,["_","event"],`var datum=event.item&&event.item.datum;return ${e.code};`),encode:(t,e)=>{let{marktype:n,channels:r}=e,a="var o=item,datum=o.datum,m=0,$;";for(let s in r){let h="o["+pi(s)+"]";a+=`$=${r[s].code};if(${h}!==$)${h}=$,m=1;`}return a+=function(s,h){let d="";return KYt[h]||(s.x2&&(s.x?(uEt[h]&&(d+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),d+="o.width=o.x2-o.x;"):d+="o.x=o.x2-(o.width||0);"),s.xc&&(d+="o.x=o.xc-(o.width||0)/2;"),s.y2&&(s.y?(uEt[h]&&(d+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),d+="o.height=o.y2-o.y;"):d+="o.y=o.y2-(o.height||0);"),s.yc&&(d+="o.y=o.yc-(o.height||0)/2;")),d}(r,n),a+="return m;",qU(t,["item","_"],a)},codegen:{get(t){let e=`[${t.map(pi).join("][")}]`,n=Function("_",`return _${e};`);return n.path=e,n},comparator(t,e){let n,r=Function("a","b","var u, v; return "+t.map((a,s)=>{let h=e[s],d,g;return a.path?(d=`a${a.path}`,g=`b${a.path}`):((n=n||{})["f"+s]=a,d=`this.f${s}(a)`,g=`this.f${s}(b)`),function(b,_,E,I){return`((u = ${b}) < (v = ${_}) || u == null) && v != null ? ${E}
  : (u > v || v == null) && u != null ? ${I}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${E}
  : v !== v && u === u ? ${I} : `}(d,g,-h,h)}).join("")+"0;");return n?r.bind(n):r}}};function lEt(t,e,n){if(!t||!Zr(t))return t;for(let r,a=0,s=cEt.length;a<s;++a)if(r=cEt[a],In(t,r.key))return r.parse(t,e,n);return t}var cEt=[{key:"$ref",parse:function(t,e){return e.get(t.$ref)||Dn("Operator not defined: "+t.$ref)}},{key:"$key",parse:function(t,e){let n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=cs(t.$key,t.$flat,e.expr.codegen))}},{key:"$expr",parse:function(t,e,n){t.$params&&e.parseParameters(t.$params,n);let r="e:"+t.$expr.code;return e.fn[r]||(e.fn[r]=Wr(e.parameterExpression(t.$expr),t.$fields))}},{key:"$field",parse:function(t,e){if(!t.$field)return null;let n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=sa(t.$field,t.$name,e.expr.codegen))}},{key:"$encode",parse:function(t,e){let n=t.$encode,r={};for(let a in n){let s=n[a];r[a]=Wr(e.encodeExpression(s.$expr),s.$fields),r[a].output=s.$output}return r}},{key:"$compare",parse:function(t,e){let n="c:"+t.$compare+"_"+t.$order,r=et(t.$compare).map(a=>a&&a.$tupleid?qi:a);return e.fn[n]||(e.fn[n]=mt(r,t.$order,e.expr.codegen))}},{key:"$context",parse:function(t,e){return e}},{key:"$subflow",parse:function(t,e){let n=t.$subflow;return function(r,a,s){let h=e.fork().parse(n),d=h.get(n.operators[0].id),g=h.signals.parent;return g&&g.set(s),d.detachSubflow=()=>e.detach(h),d}}},{key:"$tupleid",parse:function(){return qi}}];let QYt={skip:!0};function JYt(t,e,n,r){return new hEt(t,e,n,r)}function hEt(t,e,n,r){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=r||ZYt,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function dEt(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}function fM(t,e,n){return t.fields=e||[],t.fname=n,t}function tqt(t){return t.length===1?eqt(t[0]):nqt(t)}hEt.prototype=dEt.prototype={fork(){let t=new dEt(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter(n=>n!==t);let e=Object.keys(t.nodes);for(let n of e)t.nodes[n]._targets=null;for(let n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){let n=this,r=n.dataflow,a=t.value;if(n.set(t.id,e),function(s){return Y2t(s)==="collect"}(t.type)&&a&&(a.$ingest?r.ingest(e,a.$ingest,a.$format):a.$request?r.preload(e,a.$request,a.$format):r.pulse(e,r.changeset().insert(a))),t.root&&(n.root=e),t.parent){let s=n.get(t.parent.$ref);s?(r.connect(s,[e]),e.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(t.parent.$ref),r.connect(s,[e]),e.targets().add(s)})}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(let s in t.data){let h=n.data[s]||(n.data[s]={});t.data[s].forEach(d=>h[d]=e)}},resolve(){return(this.unresolved||[]).forEach(t=>t()),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[Y2t(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,r,a){this.dataflow.on(e,n,r,a,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:function(t){let e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach(r=>e.parseOperator(r)),n.forEach(r=>e.parseOperatorParameters(r)),(t.streams||[]).forEach(r=>e.parseStream(r)),(t.updates||[]).forEach(r=>e.parseUpdate(r)),e.resolve()},parseOperator:function(t){let e=this;!function(n){return Y2t(n)==="operator"}(t.type)&&t.type?e.transform(t,t.type):e.operator(t,t.update?e.operatorExpression(t.update):null)},parseOperatorParameters:function(t){let e=this;if(t.params){let n=e.get(t.id);n||Dn("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}},parseParameters:function(t,e){e=e||{};let n=this;for(let r in t){let a=t[r];e[r]=ni(a)?a.map(s=>lEt(s,n,e)):lEt(a,n,e)}return e},parseStream:function(t){var e,n=this,r=t.filter!=null?n.eventExpression(t.filter):void 0,a=t.stream!=null?n.get(t.stream):void 0;t.source?a=n.events(t.source,t.type,r):t.merge&&(a=(e=t.merge.map(s=>n.get(s)))[0].merge.apply(e[0],e.slice(1))),t.between&&(e=t.between.map(s=>n.get(s)),a=a.between(e[0],e[1])),t.filter&&(a=a.filter(r)),t.throttle!=null&&(a=a.throttle(+t.throttle)),t.debounce!=null&&(a=a.debounce(+t.debounce)),a==null&&Dn("Invalid stream definition: "+JSON.stringify(t)),t.consume&&a.consume(!0),n.stream(t,a)},parseUpdate:function(t){var e,n=this,r=Zr(r=t.source)?r.$ref:r,a=n.get(r),s=t.update,h=void 0;a||Dn("Source not defined: "+t.source),e=t.target&&t.target.$expr?n.eventExpression(t.target.$expr):n.get(t.target),s&&s.$expr&&(s.$params&&(h=n.parseParameters(s.$params)),s=n.handlerExpression(s.$expr)),n.update(t,a,e,s,h)},getState:function(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach(s=>{let h=e.signals[s];t.signals(s,h)&&(r[s]=h.value)})}if(t.data){var a=n.data={};Object.keys(e.data).forEach(s=>{let h=e.data[s];t.data(s,h)&&(a[s]=h.input.value)})}return e.subcontext&&t.recurse!==!1&&(n.subcontext=e.subcontext.map(s=>s.getState(t))),n},setState:function(t){var e=this,n=e.dataflow,r=t.data,a=t.signals;Object.keys(a||{}).forEach(s=>{n.update(e.signals[s],a[s],QYt)}),Object.keys(r||{}).forEach(s=>{n.pulse(e.data[s].input,n.changeset().remove(an).insert(r[s]))}),(t.subcontext||[]).forEach((s,h)=>{let d=e.subcontext[h];d&&d.setState(s)})}};let eqt=t=>function(e){return e[t]},nqt=t=>{let e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function F1(t){throw Error(t)}function rqt(t){let e=[],n=t.length,r,a,s,h=null,d=0,g="";function b(){e.push(g+t.substring(r,a)),g="",r=a+1}for(t+="",r=a=0;a<n;++a)if(s=t[a],s==="\\")g+=t.substring(r,a++),r=a;else if(s===h)b(),h=null,d=-1;else{if(h)continue;r===d&&s==='"'||r===d&&s==="'"?(r=a+1,h=s):s!=="."||d?s==="["?(a>r&&b(),d=r=a+1):s==="]"&&(d||F1("Access path missing open bracket: "+t),d>0&&b(),d=0,r=a+1):a>r?b():r=a+1}return d&&F1("Access path missing closing bracket: "+t),h&&F1("Access path missing closing quote: "+t),a>r&&(a++,b()),e}function iqt(t,e,n){let r=rqt(t);return t=r.length===1?r[0]:t,fM(tqt(r),[t],t)}iqt("id"),fM(t=>t,[],"identity"),fM(()=>0,[],"zero"),fM(()=>1,[],"one"),fM(()=>!0,[],"true"),fM(()=>!1,[],"false");function fEt(t){return typeof t=="function"}let aqt=Object.prototype.hasOwnProperty;function Jit(t,e){return aqt.call(t,e)}function oqt(t){return typeof t=="string"}function pEt(t){let e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}let sqt="Property",uqt="ArrayExpression",lqt="BinaryExpression",cqt="CallExpression",hqt="ConditionalExpression",dqt="LogicalExpression",fqt="MemberExpression",pqt="ObjectExpression",mqt="UnaryExpression";function O1(t){this.type=t}var _3,Qi,gr,of,qs;O1.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(a){switch(a.type){case uqt:return a.elements;case lqt:case dqt:return[a.left,a.right];case cqt:return[a.callee].concat(a.arguments);case hqt:return[a.test,a.consequent,a.alternate];case fqt:return[a.object,a.property];case pqt:return a.properties;case sqt:return[a.key,a.value];case mqt:return[a.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var tat=1,XU=2,QC=3,sk=4,eat=5,JC=6,Gp=7,KU=8;(_3={})[tat]="Boolean",_3[XU]="<end>",_3[QC]="Identifier",_3[sk]="Keyword",_3[eat]="Null",_3[JC]="Numeric",_3[Gp]="Punctuator",_3[KU]="String",_3[9]="RegularExpression";var gqt="ArrayExpression",yqt="BinaryExpression",vqt="CallExpression",bqt="ConditionalExpression",mEt="Identifier",wqt="Literal",xqt="LogicalExpression",kqt="MemberExpression",Sqt="ObjectExpression",_qt="Property",Cqt="UnaryExpression",Ph="Unexpected token %0",Eqt="Unexpected number",Tqt="Unexpected string",Aqt="Unexpected identifier",Iqt="Unexpected reserved word",Nqt="Unexpected end of input",gEt="Invalid regular expression",q2t="Invalid regular expression: missing /",yEt="Octal literals are not allowed in strict mode.",Mqt="Duplicate data property in object literal not allowed in strict mode",pd="ILLEGAL",ZU="Disabled.",Dqt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Rqt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function nat(t,e){if(!t)throw new Error("ASSERT: "+e)}function C3(t){return t>=48&&t<=57}function X2t(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function QU(t){return"01234567".indexOf(t)>=0}function Fqt(t){return t===32||t===9||t===11||t===12||t===160||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function JU(t){return t===10||t===13||t===8232||t===8233}function tW(t){return t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t===92||t>=128&&Dqt.test(String.fromCharCode(t))}function rat(t){return t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||t===92||t>=128&&Rqt.test(String.fromCharCode(t))}let Oqt={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function vEt(){for(;gr<of;){let t=Qi.charCodeAt(gr);if(!Fqt(t)&&!JU(t))break;++gr}}function K2t(t){var e,n,r,a=0;for(n=t==="u"?4:2,e=0;e<n;++e)gr<of&&X2t(Qi[gr])?(r=Qi[gr++],a=16*a+"0123456789abcdef".indexOf(r.toLowerCase())):Is({},Ph,pd);return String.fromCharCode(a)}function Lqt(){var t,e,n,r;for(e=0,(t=Qi[gr])==="}"&&Is({},Ph,pd);gr<of&&X2t(t=Qi[gr++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||t!=="}")&&Is({},Ph,pd),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function bEt(){var t,e;for(t=Qi.charCodeAt(gr++),e=String.fromCharCode(t),t===92&&(Qi.charCodeAt(gr)!==117&&Is({},Ph,pd),++gr,(t=K2t("u"))&&t!=="\\"&&tW(t.charCodeAt(0))||Is({},Ph,pd),e=t);gr<of&&rat(t=Qi.charCodeAt(gr));)++gr,e+=String.fromCharCode(t),t===92&&(e=e.substr(0,e.length-1),Qi.charCodeAt(gr)!==117&&Is({},Ph,pd),++gr,(t=K2t("u"))&&t!=="\\"&&rat(t.charCodeAt(0))||Is({},Ph,pd),e+=t);return e}function $qt(){var t,e;return t=gr,e=Qi.charCodeAt(gr)===92?bEt():function(){var n,r;for(n=gr++;gr<of;){if((r=Qi.charCodeAt(gr))===92)return gr=n,bEt();if(!rat(r))break;++gr}return Qi.slice(n,gr)}(),{type:e.length===1?QC:Oqt.hasOwnProperty(e)?sk:e==="null"?eat:e==="true"||e==="false"?tat:QC,value:e,start:t,end:gr}}function Z2t(){var t,e,n,r,a=gr,s=Qi.charCodeAt(gr),h=Qi[gr];switch(s){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++gr,{type:Gp,value:String.fromCharCode(s),start:a,end:gr};default:if((t=Qi.charCodeAt(gr+1))===61)switch(s){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return gr+=2,{type:Gp,value:String.fromCharCode(s)+String.fromCharCode(t),start:a,end:gr};case 33:case 61:return gr+=2,Qi.charCodeAt(gr)===61&&++gr,{type:Gp,value:Qi.slice(a,gr),start:a,end:gr}}}return(r=Qi.substr(gr,4))===">>>="?{type:Gp,value:r,start:a,end:gr+=4}:(n=r.substr(0,3))===">>>"||n==="<<="||n===">>="?{type:Gp,value:n,start:a,end:gr+=3}:h===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(h)>=0||e==="=>"?{type:Gp,value:e,start:a,end:gr+=2}:(e==="//"&&Is({},Ph,pd),"<>=!+-*%&|^/".indexOf(h)>=0?(++gr,{type:Gp,value:h,start:a,end:gr}):void Is({},Ph,pd))}function wEt(){var t,e,n;if(nat(C3((n=Qi[gr]).charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),e=gr,t="",n!=="."){if(t=Qi[gr++],n=Qi[gr],t==="0"){if(n==="x"||n==="X")return++gr,function(r){let a="";for(;gr<of&&X2t(Qi[gr]);)a+=Qi[gr++];return a.length===0&&Is({},Ph,pd),tW(Qi.charCodeAt(gr))&&Is({},Ph,pd),{type:JC,value:parseInt("0x"+a,16),start:r,end:gr}}(e);if(QU(n))return function(r){let a="0"+Qi[gr++];for(;gr<of&&QU(Qi[gr]);)a+=Qi[gr++];return(tW(Qi.charCodeAt(gr))||C3(Qi.charCodeAt(gr)))&&Is({},Ph,pd),{type:JC,value:parseInt(a,8),octal:!0,start:r,end:gr}}(e);n&&C3(n.charCodeAt(0))&&Is({},Ph,pd)}for(;C3(Qi.charCodeAt(gr));)t+=Qi[gr++];n=Qi[gr]}if(n==="."){for(t+=Qi[gr++];C3(Qi.charCodeAt(gr));)t+=Qi[gr++];n=Qi[gr]}if(n==="e"||n==="E")if(t+=Qi[gr++],(n=Qi[gr])!=="+"&&n!=="-"||(t+=Qi[gr++]),C3(Qi.charCodeAt(gr)))for(;C3(Qi.charCodeAt(gr));)t+=Qi[gr++];else Is({},Ph,pd);return tW(Qi.charCodeAt(gr))&&Is({},Ph,pd),{type:JC,value:parseFloat(t),start:e,end:gr}}function zqt(){var t,e,n,r;return qs=null,vEt(),t=gr,e=function(){var a,s,h,d;for(nat((a=Qi[gr])==="/","Regular expression literal must start with a slash"),s=Qi[gr++],h=!1,d=!1;gr<of;)if(s+=a=Qi[gr++],a==="\\")JU((a=Qi[gr++]).charCodeAt(0))&&Is({},q2t),s+=a;else if(JU(a.charCodeAt(0)))Is({},q2t);else if(h)a==="]"&&(h=!1);else{if(a==="/"){d=!0;break}a==="["&&(h=!0)}return d||Is({},q2t),{value:s.substr(1,s.length-2),literal:s}}(),n=function(){var a,s,h;for(s="",h="";gr<of&&rat((a=Qi[gr]).charCodeAt(0));)++gr,a==="\\"&&gr<of?Is({},Ph,pd):(h+=a,s+=a);return h.search(/[^gimuy]/g)>=0&&Is({},gEt,h),{value:h,literal:s}}(),r=function(a,s){let h=a;s.indexOf("u")>=0&&(h=h.replace(/\\u\{([0-9a-fA-F]+)\}/g,(d,g)=>{if(parseInt(g,16)<=1114111)return"x";Is({},gEt)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{return new RegExp(a,s)}catch{return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:gr}}function xEt(){if(vEt(),gr>=of)return{type:XU,start:gr,end:gr};let t=Qi.charCodeAt(gr);return tW(t)?$qt():t===40||t===41||t===59?Z2t():t===39||t===34?function(){var e,n,r,a,s="",h=!1;for(nat((e=Qi[gr])==="'"||e==='"',"String literal must starts with a quote"),n=gr,++gr;gr<of;){if((r=Qi[gr++])===e){e="";break}if(r==="\\")if((r=Qi[gr++])&&JU(r.charCodeAt(0)))r==="\r"&&Qi[gr]===`
`&&++gr;else switch(r){case"u":case"x":Qi[gr]==="{"?(++gr,s+=Lqt()):s+=K2t(r);break;case"n":s+=`
`;break;case"r":s+="\r";break;case"t":s+="	";break;case"b":s+="\b";break;case"f":s+="\f";break;case"v":s+="\v";break;default:QU(r)?((a="01234567".indexOf(r))!==0&&(h=!0),gr<of&&QU(Qi[gr])&&(h=!0,a=8*a+"01234567".indexOf(Qi[gr++]),"0123".indexOf(r)>=0&&gr<of&&QU(Qi[gr])&&(a=8*a+"01234567".indexOf(Qi[gr++]))),s+=String.fromCharCode(a)):s+=r}else{if(JU(r.charCodeAt(0)))break;s+=r}}return e!==""&&Is({},Ph,pd),{type:KU,value:s,octal:h,start:n,end:gr}}():t===46?C3(Qi.charCodeAt(gr+1))?wEt():Z2t():C3(t)?wEt():Z2t()}function Hp(){let t=qs;return gr=t.end,qs=xEt(),gr=t.end,t}function kEt(){let t=gr;qs=xEt(),gr=t}function SEt(t,e,n){let r=new O1(t==="||"||t==="&&"?xqt:yqt);return r.operator=t,r.left=e,r.right=n,r}function Pqt(t,e){let n=new O1(vqt);return n.callee=t,n.arguments=e,n}function Q2t(t){let e=new O1(mEt);return e.name=t,e}function eW(t){let e=new O1(wqt);return e.value=t.value,e.raw=Qi.slice(t.start,t.end),t.regex&&(e.raw==="//"&&(e.raw="/(?:)/"),e.regex=t.regex),e}function _Et(t,e,n){let r=new O1(kqt);return r.computed=t==="[",r.object=e,r.property=n,r.computed||(n.member=!0),r}function CEt(t,e,n){let r=new O1(_qt);return r.key=e,r.value=n,r.kind=t,r}function Is(t,e){var n,r=Array.prototype.slice.call(arguments,2),a=e.replace(/%(\d)/g,(s,h)=>(nat(h<r.length,"Message reference must be in range"),r[h]));throw(n=new Error(a)).index=gr,n.description=a,n}function iat(t){t.type===XU&&Is(t,Nqt),t.type===JC&&Is(t,Eqt),t.type===KU&&Is(t,Tqt),t.type===QC&&Is(t,Aqt),t.type===sk&&Is(t,Iqt),Is(t,Ph,t.value)}function sf(t){let e=Hp();e.type===Gp&&e.value===t||iat(e)}function Hu(t){return qs.type===Gp&&qs.value===t}function J2t(t){return qs.type===sk&&qs.value===t}function Bqt(){let t=[];for(gr=qs.start,sf("[");!Hu("]");)Hu(",")?(Hp(),t.push(null)):(t.push(t9()),Hu("]")||sf(","));return Hp(),function(e){let n=new O1(gqt);return n.elements=e,n}(t)}function EEt(){gr=qs.start;let t=Hp();return t.type===KU||t.type===JC?(t.octal&&Is(t,yEt),eW(t)):Q2t(t.value)}function jqt(){var t,e,n;return gr=qs.start,(t=qs).type===QC?(n=EEt(),sf(":"),CEt("init",n,t9())):t.type!==XU&&t.type!==Gp?(e=EEt(),sf(":"),CEt("init",e,t9())):void iat(t)}function Uqt(){var t,e,n=[],r={},a=String;for(gr=qs.start,sf("{");!Hu("}");)e="$"+((t=jqt()).key.type===mEt?t.key.name:a(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?Is({},Mqt):r[e]=!0,n.push(t),Hu("}")||sf(",");return sf("}"),function(s){let h=new O1(Sqt);return h.properties=s,h}(n)}let Wqt={if:1};function Vqt(){var t,e,n;if(Hu("("))return function(){sf("(");let r=tyt();return sf(")"),r}();if(Hu("["))return Bqt();if(Hu("{"))return Uqt();if(t=qs.type,gr=qs.start,t===QC||Wqt[qs.value])n=Q2t(Hp().value);else if(t===KU||t===JC)qs.octal&&Is(qs,yEt),n=eW(Hp());else{if(t===sk)throw new Error(ZU);t===tat?((e=Hp()).value=e.value==="true",n=eW(e)):t===eat?((e=Hp()).value=null,n=eW(e)):Hu("/")||Hu("/=")?(n=eW(zqt()),kEt()):iat(Hp())}return n}function Gqt(){let t=[];if(sf("("),!Hu(")"))for(;gr<of&&(t.push(t9()),!Hu(")"));)sf(",");return sf(")"),t}function Hqt(){gr=qs.start;let t=Hp();return function(e){return e.type===QC||e.type===sk||e.type===tat||e.type===eat}(t)||iat(t),Q2t(t.value)}function Yqt(){sf("[");let t=tyt();return sf("]"),t}function TEt(){let t=function(){var e;for(e=Vqt();;)if(Hu("."))sf("."),e=_Et(".",e,Hqt());else if(Hu("("))e=Pqt(e,Gqt());else{if(!Hu("["))break;e=_Et("[",e,Yqt())}return e}();if(qs.type===Gp&&(Hu("++")||Hu("--")))throw new Error(ZU);return t}function aat(){var t,e;if(qs.type!==Gp&&qs.type!==sk)e=TEt();else{if(Hu("++")||Hu("--"))throw new Error(ZU);if(Hu("+")||Hu("-")||Hu("~")||Hu("!"))t=Hp(),e=aat(),e=function(n,r){let a=new O1(Cqt);return a.operator=n,a.argument=r,a.prefix=!0,a}(t.value,e);else{if(J2t("delete")||J2t("void")||J2t("typeof"))throw new Error(ZU);e=TEt()}}return e}function AEt(t){let e=0;if(t.type!==Gp&&t.type!==sk)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function t9(){var t,e;return t=function(){var n,r,a,s,h,d,g,b,_,E;if(n=qs,_=aat(),(h=AEt(s=qs))===0)return _;for(s.prec=h,Hp(),r=[n,qs],d=[_,s,g=aat()];(h=AEt(qs))>0;){for(;d.length>2&&h<=d[d.length-2].prec;)g=d.pop(),b=d.pop().value,_=d.pop(),r.pop(),a=SEt(b,_,g),d.push(a);(s=Hp()).prec=h,d.push(s),r.push(qs),a=aat(),d.push(a)}for(a=d[E=d.length-1],r.pop();E>1;)r.pop(),a=SEt(d[E-1].value,d[E-2],a),E-=2;return a}(),Hu("?")&&(Hp(),e=t9(),sf(":"),t=function(n,r,a){let s=new O1(bqt);return s.test=n,s.consequent=r,s.alternate=a,s}(t,e,t9())),t}function tyt(){let t=t9();if(Hu(","))throw new Error(ZU);return t}function qqt(t){gr=0,of=(Qi=t).length,qs=null,kEt();let e=tyt();if(qs.type!==XU)throw new Error("Unexpect token after expression.");return e}var Xqt={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Kqt(t){function e(s,h,d){return g=>function(b,_,E,I){let R=t(_[0]);return E&&(R=E+"("+R+")",E.lastIndexOf("new ",0)===0&&(R="("+R+")")),R+"."+b+(I<0?"":I===0?"()":"("+_.slice(1).map(t).join(",")+")")}(s,g,h,d)}let n="new Date",r="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(s){s.length<3&&F1("Missing arguments to clamp function."),s.length>3&&F1("Too many arguments to clamp function.");let h=s.map(t);return"Math.max("+h[1]+", Math.min("+h[2]+","+h[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:a,test:e("test",a),if:function(s){s.length<3&&F1("Missing arguments to if function."),s.length>3&&F1("Too many arguments to if function.");let h=s.map(t);return"("+h[0]+"?"+h[1]+":"+h[2]+")"}}}function Zqt(t){let e=(t=t||{}).allowed?pEt(t.allowed):{},n=t.forbidden?pEt(t.forbidden):{},r=t.constants||Xqt,a=(t.functions||Kqt)(E),s=t.globalvar,h=t.fieldvar,d=fEt(s)?s:z=>"".concat(s,'["').concat(z,'"]'),g={},b={},_=0;function E(z){if(oqt(z))return z;let P=I[z.type];return P==null&&F1("Unsupported type: "+z.type),P(z)}let I={Literal:z=>z.raw,Identifier:z=>{let P=z.name;return _>0?P:Jit(n,P)?F1("Illegal identifier: "+P):Jit(r,P)?r[P]:Jit(e,P)?P:(g[P]=1,d(P))},MemberExpression:z=>{let P=!z.computed,rt=E(z.object);P&&(_+=1);let ot=E(z.property);return rt===h&&(b[function(at){let dt=at&&at.length-1;return dt&&(at[0]==='"'&&at[dt]==='"'||at[0]==="'"&&at[dt]==="'")?at.slice(1,-1):at}(ot)]=1),P&&(_-=1),rt+(P?"."+ot:"["+ot+"]")},CallExpression:z=>{z.callee.type!=="Identifier"&&F1("Illegal callee type: "+z.callee.type);let P=z.callee.name,rt=z.arguments,ot=Jit(a,P)&&a[P];return ot||F1("Unrecognized function: "+P),fEt(ot)?ot(rt):ot+"("+rt.map(E).join(",")+")"},ArrayExpression:z=>"["+z.elements.map(E).join(",")+"]",BinaryExpression:z=>"("+E(z.left)+" "+z.operator+" "+E(z.right)+")",UnaryExpression:z=>"("+z.operator+E(z.argument)+")",ConditionalExpression:z=>"("+E(z.test)+"?"+E(z.consequent)+":"+E(z.alternate)+")",LogicalExpression:z=>"("+E(z.left)+z.operator+E(z.right)+")",ObjectExpression:z=>"{"+z.properties.map(E).join(",")+"}",Property:z=>{_+=1;let P=E(z.key);return _-=1,P+":"+E(z.value)}};function R(z){let P={code:E(z),globals:Object.keys(g),fields:Object.keys(b)};return g={},b={},P}return R.functions=a,R.constants=r,R}let Qqt="view",oat="[",sat="]",IEt="{",NEt="}",Jqt=":",MEt=",",tXt="@",eXt=">",nXt=/[[\]{}]/,rXt={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},DEt,REt;function e9(t,e,n){return DEt=e||Qqt,REt=n||rXt,FEt(t.trim()).map(eyt)}function nW(t,e,n,r,a){let s=t.length,h,d=0;for(;e<s;++e){if(h=t[e],!d&&h===n)return e;a&&a.indexOf(h)>=0?--d:r&&r.indexOf(h)>=0&&++d}return e}function FEt(t){let e=[],n=t.length,r=0,a=0;for(;a<n;)a=nW(t,a,MEt,oat+IEt,sat+NEt),e.push(t.substring(r,a).trim()),r=++a;if(e.length===0)throw"Empty event selector: "+t;return e}function eyt(t){return t[0]==="["?function(e){let n=e.length,r,a=1;if(a=nW(e,a,sat,oat,sat),a===n)throw"Empty between selector: "+e;if(r=FEt(e.substring(1,a)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(a+1).trim(),e[0]!==eXt)throw"Expected '>' after between selector: "+e;r=r.map(eyt);let s=eyt(e.slice(1).trim());return s.between?{between:r,stream:s}:(s.between=r,s)}(t):function(e){let n={source:DEt},r=[],a,s,h=[0,0],d=0,g=0,b=e.length,_=0;if(e[b-1]===NEt){if(_=e.lastIndexOf(IEt),!(_>=0))throw"Unmatched right brace: "+e;try{h=function(E){let I=E.split(MEt);if(!E.length||I.length>2)throw E;return I.map(R=>{let z=+R;if(z!=z)throw E;return z})}(e.substring(_+1,b-1))}catch{throw"Invalid throttle specification: "+e}b=(e=e.slice(0,_).trim()).length,_=0}if(!b)throw e;if(e[0]===tXt&&(d=++_),a=nW(e,_,Jqt),a<b&&(r.push(e.substring(g,a).trim()),g=_=++a),_=nW(e,_,oat),_===b)r.push(e.substring(g,b).trim());else if(r.push(e.substring(g,_).trim()),s=[],g=++_,g===b)throw"Unmatched left bracket: "+e;for(;_<b;){if(_=nW(e,_,sat),_===b)throw"Unmatched left bracket: "+e;if(s.push(e.substring(g,_).trim()),_<b-1&&e[++_]!==oat)throw"Expected left bracket: "+e;g=++_}if(!(b=r.length)||nXt.test(r[b-1]))throw"Invalid event selector: "+e;return b>1?(n.type=r[1],d?n.markname=r[0].slice(1):function(E){return REt[E]}(r[0])?n.marktype=r[0]:n.source=r[0]):n.type=r[0],n.type.slice(-1)==="!"&&(n.consume=!0,n.type=n.type.slice(0,-1)),s!=null&&(n.filter=s),h[0]&&(n.throttle=h[0]),h[1]&&(n.debounce=h[1]),n}(t)}var iXt="5.20.0";bu(m2,K,Y,X,J,q,tt,H,st,lt,ft,gt);let aXt=iXt;function pM(t,e,n){return t.fields=e||[],t.fname=n,t}function oXt(t){return t.length===1?sXt(t[0]):uXt(t)}let sXt=t=>function(e){return e[t]},uXt=t=>{let e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function nyt(t){throw Error(t)}function n9(t){var e,n,r,a=[],s=null,h=0,d=t.length,g="";function b(){a.push(g+t.substring(e,n)),g="",e=n+1}for(t+="",e=n=0;n<d;++n)if((r=t[n])==="\\")g+=t.substring(e,n),g+=t.substring(++n,++n),e=n;else if(r===s)b(),s=null,h=-1;else{if(s)continue;e===h&&r==='"'||e===h&&r==="'"?(e=n+1,s=r):r!=="."||h?r==="["?(n>e&&b(),h=e=n+1):r==="]"&&(h||nyt("Access path missing open bracket: "+t),h>0&&b(),h=0,e=n+1):n>e?b():e=n+1}return h&&nyt("Access path missing closing bracket: "+t),s&&nyt("Access path missing closing quote: "+t),n>e&&(n++,b()),a}var rW=[],lXt=(function(t,e,n){let r=n9(t);t=r.length===1?r[0]:t,pM(oXt(r),[t],t)}("id"),pM(function(t){return t},rW,"identity"));pM(function(){return 0},rW,"zero"),pM(function(){return 1},rW,"one"),pM(function(){return!0},rW,"true"),pM(function(){return!1},rW,"false");function uat(t,e,n){var r=[e].concat([].slice.call(n));console[t].apply(console,r)}let ka=Array.isArray;function Bh(t){return t===Object(t)}let OEt=t=>t!=="__proto__";function LEt(...t){return t.reduce((e,n)=>{for(var r in n)if(r==="signals")e.signals=cXt(e.signals,n.signals);else{var a=r==="legend"?{layout:1}:r==="style"||null;ryt(e,r,n[r],a)}return e},{})}function ryt(t,e,n,r){var a,s;if(OEt(e))if(Bh(n)&&!ka(n))for(a in s=Bh(t[e])?t[e]:t[e]={},n)r&&(r===!0||r[a])?ryt(s,a,n[a]):OEt(a)&&(s[a]=n[a]);else t[e]=n}function cXt(t,e){if(t==null)return e;let n={},r=[];function a(s){n[s.name]||(n[s.name]=1,r.push(s))}return e.forEach(a),t.forEach(a),r}function ec(t){return t!=null?ka(t)?t:[t]:[]}let hXt=Object.prototype.hasOwnProperty;function r9(t,e){return hXt.call(t,e)}function iW(t){return typeof t=="boolean"}function Ec(t){return typeof t=="number"}function bo(t){return typeof t=="string"}function Vo(t){return ka(t)?"["+t.map(Vo)+"]":Bh(t)||bo(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function i9(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=!0;return e}function fa(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function"){var a=0;for(r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]])}return n}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function t(){var e=isNaN(arguments[0])?1:Number(arguments[0]);return e?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,t.call(r,e-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(t){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var dXt=S(1779),fXt=S.n(dXt),pXt=S(2017),mXt=S.n(pXt),gXt=S(2492),aW=S.n(gXt);function iyt(t){return!!t.or}function ayt(t){return!!t.and}function oyt(t){return!!t.not}function lat(t,e){if(oyt(t))lat(t.not,e);else if(ayt(t))for(let n of t.and)lat(n,e);else if(iyt(t))for(let n of t.or)lat(n,e);else e(t)}function cat(t,e){return oyt(t)?{not:cat(t.not,e)}:ayt(t)?{and:t.and.map(n=>cat(n,e))}:iyt(t)?{or:t.or.map(n=>cat(n,e))}:e(t)}let oW=mXt(),wo=fXt();function sW(t,e){let n={};for(let r of e)r9(t,r)&&(n[r]=t[r]);return n}function E3(t,e){let n=Object.assign({},t);for(let r of e)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(t=>aW()(t)).join(",")})`};let sl=aW();function ss(t){if(Ec(t))return t;let e=bo(t)?t:aW()(t);if(e.length<250)return e;let n=0;for(let r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r),n|=0;return n}function $Et(t){return t===!1||t===null}function Aa(t,e){return t.indexOf(e)>-1}function uW(t,e){let n=0;for(let[r,a]of t.entries())if(e(a,r,n++))return!0;return!1}function zEt(t,e){let n=0;for(let[r,a]of t.entries())if(!e(a,r,n++))return!1;return!0}function yXt(t,e){for(let n of jr(e))ryt(t,n,e[n],!0)}function uk(t,e){let n=[],r={},a;for(let s of t)a=e(s),a in r||(r[a]=1,n.push(s));return n}function PEt(t,e){for(let n of t)if(e.has(n))return!0;return!1}function BEt(t){let e=new Set;for(let n of t){let r=n9(n).map((s,h)=>h===0?s:`[${s}]`),a=r.map((s,h)=>r.slice(0,h+1).join(""));for(let s of a)e.add(s)}return e}function jEt(t,e){return t===void 0||e===void 0||PEt(BEt(t),BEt(e))}function yu(t){return jr(t).length===0}let jr=Object.keys,lk=Object.values;function UEt(t){let e=[];for(let n in t)r9(t,n)&&e.push({key:n,value:t[n]});return e}function hat(t){return t===!0||t===!1}function ul(t){let e=t.replace(/\W/g,"_");return(t.match(/^\d+/)?"_":"")+e}function lW(t,e){return oyt(t)?"!("+lW(t.not,e)+")":ayt(t)?"("+t.and.map(n=>lW(n,e)).join(") && (")+")":iyt(t)?"("+t.or.map(n=>lW(n,e)).join(") || (")+")":e(t)}function syt(t,e){if(e.length===0)return!0;let n=e.shift();return n in t&&syt(t[n],e)&&delete t[n],yu(t)}function dat(t){return t.charAt(0).toUpperCase()+t.substr(1)}function WEt(t,e="datum"){let n=n9(t),r=[];for(let a=1;a<=n.length;a++){let s=`[${n.slice(0,a).map(Vo).join("][")}]`;r.push(`${e}${s}`)}return r.join(" && ")}function vXt(t){return t.replace(/(\[|\]|\.|'|")/g,"\\$1")}function ck(t){return`${n9(t).map(vXt).join("\\.")}`}function mM(t,e,n){return t.replace(new RegExp(e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function VEt(t){return`${n9(t).join(".")}`}function cW(t){return t?n9(t).length:0}function Tc(...t){for(let e of t)if(e!==void 0)return e}let bXt=42;function fat(t){if(t!==void 0)return(t%360+360)%360}function uyt(t){return!!Ec(t)||!isNaN(t)&&!isNaN(parseFloat(t))}let GEt={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function lyt(t){return t&&t.condition}let HEt=["domain","grid","labels","ticks","title"],wXt={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},YEt={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},xXt=Object.assign(Object.assign({},YEt),{style:1,labelExpr:1,encoding:1});function qEt(t){return!!xXt[t]}let jf={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},XEt=jf.arc,pat=jf.area,mat=jf.bar,kXt=jf.image,gat=jf.line,yat=jf.point,SXt=jf.rect,vat=jf.rule,KEt=jf.text,cyt=jf.tick,_Xt=jf.trail,hyt=jf.circle,dyt=jf.square,ZEt=jf.geoshape;function a9(t){return Aa(["line","area","trail"],t)}function QEt(t){return Aa(["rect","bar","image","arc"],t)}let JEt=jr(jf);function Ay(t){return t.type}i9(JEt);let CXt=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],tTt=jr({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1}),EXt={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},TXt={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},AXt={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5};function T3(t){return"mark"in t}class bat{constructor(e,n){this.name=e,this.run=n}hasMatchingType(e){return!!T3(e)&&function(n){return Ay(n)?n.type:n}(e.mark)===this.name}}let IXt={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},NXt={count:1,min:1,max:1};function hk(t){return!!t&&!!t.argmin}function o9(t){return!!t&&!!t.argmax}function fyt(t){return bo(t)&&!!IXt[t]}let MXt=["count","valid","missing","distinct"];function eTt(t){return bo(t)&&Aa(MXt,t)}let DXt=["count","sum","distinct","valid","missing"],RXt=i9(["mean","average","median","q1","q3","min","max"]),A3="row",I3="column",wat="facet",kl="x",oh="y",L1="x2",Iy="y2",Ny="radius",N3="radius2",$1="theta",M3="theta2",My="latitude",Dy="longitude",z1="latitude2",ig="longitude2",Yp="color",Ry="fill",Fy="stroke",qp="shape",D3="size",s9="angle",R3="opacity",dk="fillOpacity",fk="strokeOpacity",pk="strokeWidth",mk="strokeDash",hW="text",dW="order",fW="detail",xat="key",u9="tooltip",kat="href",Sat="url",_at="description",nTt={theta:1,theta2:1,radius:1,radius2:1};function rTt(t){return t in nTt}let pyt={longitude:1,longitude2:1,latitude:1,latitude2:1},FXt=jr(pyt),iTt=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),nTt),pyt),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function gM(t){return t===Yp||t===Ry||t===Fy}let aTt={row:1,column:1,facet:1},ag=jr(aTt),myt=Object.assign(Object.assign({},iTt),aTt),oTt=jr(myt),OXt=fa(myt,["order","detail","tooltip"]),LXt=fa(OXt,["row","column","facet"]);function sTt(t){return!!myt[t]}let $Xt=[L1,Iy,z1,ig,M3,N3];function uTt(t){return l9(t)!==t}function l9(t){switch(t){case L1:return kl;case Iy:return oh;case z1:return My;case ig:return Dy;case M3:return $1;case N3:return Ny}return t}function gk(t){if(rTt(t))switch(t){case $1:return"startAngle";case M3:return"endAngle";case Ny:return"outerRadius";case N3:return"innerRadius"}return t}function Oy(t){switch(t){case kl:return L1;case oh:return Iy;case My:return z1;case Dy:return ig;case $1:return M3;case Ny:return N3}}function Ly(t){switch(t){case kl:case L1:return"width";case oh:case Iy:return"height"}}let gyt=fa(iTt,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),zXt=jr(gyt),yk={x:1,y:1},og=jr(yk);function $y(t){return t in yk}let yyt={theta:1,radius:1},PXt=jr(yyt);function Cat(t){return t==="width"?kl:oh}let lTt=fa(gyt,["text","tooltip","href","url","description","detail","key","order"]),BXt=jr(lTt),cTt=Object.assign(Object.assign(Object.assign({},yk),yyt),lTt),Eat=jr(cTt);function vk(t){return!!cTt[t]}function jXt(t,e){return function(n){switch(n){case Yp:case Ry:case Fy:case _at:case fW:case xat:case u9:case kat:case dW:case R3:case dk:case fk:case pk:case wat:case A3:case I3:return hTt;case kl:case oh:case My:case Dy:return UXt;case L1:case Iy:case z1:case ig:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case D3:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case mk:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case qp:return{point:"always",geoshape:"always"};case hW:return{text:"always"};case s9:return{point:"always",square:"always",text:"always"};case Sat:return{image:"always"};case $1:case Ny:return{text:"always",arc:"always"};case M3:case N3:return{arc:"always"}}}(t)[e]}let hTt={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},UXt=fa(hTt,["geoshape"]);function Tat(t){switch(t){case kl:case oh:case $1:case Ny:case D3:case s9:case pk:case R3:case dk:case fk:case L1:case Iy:case M3:case N3:return;case wat:case A3:case I3:case qp:case mk:case hW:case u9:case kat:case Sat:case _at:return"discrete";case Yp:case Ry:case Fy:return"flexible";case My:case Dy:case z1:case ig:case fW:case xat:case dW:return}}function dTt(t){return iW(t)&&(t=Bat(t,void 0)),"bin"+jr(t).map(e=>Aat(t[e])?ul(`_${e}_${Object.entries(t[e])}`):ul(`_${e}_${t[e]}`)).join("")}function Eu(t){return t===!0||pW(t)&&!t.binned}function Uf(t){return t==="binned"||pW(t)&&t.binned===!0}function pW(t){return Bh(t)}function Aat(t){return t?.selection}function fTt(t){switch(t){case A3:case I3:case D3:case Yp:case Ry:case Fy:case pk:case R3:case dk:case fk:case qp:return 6;case mk:return 4;default:return 10}}function vyt(t){return`Invalid specification ${JSON.stringify(t)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}let WXt='Autosize "fit" only works for single views and layered views.';function pTt(t){return`${t=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function mTt(t){return`${t=="width"?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${t=="width"?"x":"y"}".`}function gTt(t){return t?`Dropping "fit-${t}" because spec has discrete ${Ly(t)}.`:'Dropping "fit" because spec has discrete size.'}function yTt(t){return`Cannot project a selection on encoding channel "${t}", which has no field.`}function VXt(t,e){return`Cannot project a selection on encoding channel "${t}" as it uses an aggregate function ("${e}").`}function vTt(t){return`Selection not supported for ${t} yet.`}function bTt(t){return`The "columns" property cannot be used when "${t}" has nested row/column.`}function wTt(t,e,n){return`An ancestor parsed field "${t}" as ${n} but a child wants to parse the field as ${e}.`}function GXt(t){return`Ignoring an invalid transform: ${sl(t)}.`}function xTt(t){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${t} are dropped.`}function kTt(t){return`Invalid field type "${t}".`}function STt(t,e){let{fill:n,stroke:r}=e;return`Dropping color ${t} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function byt(t,e){return`Dropping ${sl(t)} from channel "${e}" since it does not contain any data field, datum, value, or signal.`}function Iat(t,e,n){return`${t} dropped as it is incompatible with "${e}".`}function HXt(t){return`${t} encoding should be discrete (ordinal / nominal / binned).`}function wyt(t,e){return`Using discrete channel "${t}" to encode "${e}" field can be misleading as it does not encode ${e==="ordinal"?"order":"magnitude"}.`}function YXt(t){return`Using unaggregated domain with raw field has no effect (${sl(t)}).`}function qXt(t){return`Unaggregated domain not applicable for "${t}" since it produces values outside the origin domain of the source data.`}function XXt(t){return`Unaggregated domain is currently unsupported for log scale (${sl(t)}).`}function _Tt(t,e,n){return`${n}-scale's "${e}" is dropped as it does not work with ${t} scale.`}function CTt(t){return`The step for "${t}" is dropped because the ${t==="width"?"x":"y"} is continuous.`}let ETt="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function Nat(t,e){return`Invalid ${t}: ${sl(e)}.`}function TTt(t){return`1D error band does not support ${t}.`}function ATt(t){return`Channel ${t} is required for "binned" bin.`}let ITt=function(t,e){var n=t;return{level:function(r){return arguments.length?(n=+r,this):n},error:function(){return n>=1&&uat("error","ERROR",arguments),this},warn:function(){return n>=2&&uat("warn","WARN",arguments),this},info:function(){return n>=3&&uat("log","INFO",arguments),this},debug:function(){return n>=4&&uat("log","DEBUG",arguments),this}}}(2),mW=ITt;function KXt(){return mW=ITt,mW}function $r(...t){mW.warn(...t)}function yM(t){if(t&&Bh(t)){for(let e of kyt)if(e in t)return!0}return!1}let NTt=["january","february","march","april","may","june","july","august","september","october","november","december"],ZXt=NTt.map(t=>t.substr(0,3)),MTt=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],QXt=MTt.map(t=>t.substr(0,3));function xyt(t,e){let n=[];if(e&&t.day!==void 0&&jr(t).length>1&&($r(function(r){return`Dropping day from datetime ${sl(r)} as day cannot be combined with other units.`}(t)),delete(t=wo(t)).day),t.year!==void 0?n.push(t.year):n.push(2012),t.month!==void 0){let r=e?function(a){if(uyt(a)&&(a=+a),Ec(a))return a-1;{let s=a.toLowerCase(),h=NTt.indexOf(s);if(h!==-1)return h;let d=s.substr(0,3),g=ZXt.indexOf(d);if(g!==-1)return g;throw new Error(Nat("month",a))}}(t.month):t.month;n.push(r)}else if(t.quarter!==void 0){let r=e?function(a){if(uyt(a)&&(a=+a),Ec(a))return a>4&&$r(Nat("quarter",a)),a-1;throw new Error(Nat("quarter",a))}(t.quarter):t.quarter;n.push(Ec(r)?3*r:r+"*3")}else n.push(0);if(t.date!==void 0)n.push(t.date);else if(t.day!==void 0){let r=e?function(a){if(uyt(a)&&(a=+a),Ec(a))return a%7;{let s=a.toLowerCase(),h=MTt.indexOf(s);if(h!==-1)return h;let d=s.substr(0,3),g=QXt.indexOf(d);if(g!==-1)return g;throw new Error(Nat("day",a))}}(t.day):t.day;n.push(Ec(r)?r+1:r+"+1")}else n.push(1);for(let r of["hours","minutes","seconds","milliseconds"]){let a=t[r];n.push(a===void 0?0:a)}return n}function gW(t){let e=xyt(t,!0).join(", ");return t.utc?`utc(${e})`:`datetime(${e})`}let DTt={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},kyt=jr(DTt);function Syt(t){return t.startsWith("utc")}let JXt={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function _yt(t){let e=[];for(let n of kyt)RTt(t,n)&&e.push(n);return e}function RTt(t,e){let n=t.indexOf(e);return!(n<0)&&!(n>0&&e==="seconds"&&t.charAt(n-1)==="i")&&!(t.length>n+3&&e==="day"&&t.charAt(n+3)==="o")&&!(n>0&&e==="year"&&t.charAt(n-1)==="f")}function tKt(t,e,{end:n}={end:!1}){let r=WEt(e),a=Syt(t)?"utc":"",s,h={};for(let g of kyt)RTt(t,g)&&(h[g]=(d=g)==="quarter"?`(${a}quarter(${r})-1)`:`${a}${d}(${r})`,s=g);var d;return n&&(h[s]+="+1"),function(g){let b=xyt(g,!1).join(", ");return g.utc?`utc(${b})`:`datetime(${b})`}(h)}function FTt(t){if(!t)return;let e=_yt(t);return`timeUnitSpecifier(${aW()(e)}, ${aW()(JXt)})`}function Wf(t){if(!t)return;let e;return bo(t)?e={unit:t}:Bh(t)&&(e=Object.assign(Object.assign({},t),t.unit?{unit:t.unit}:{})),Syt(e.unit)&&(e.utc=!0,e.unit=e.unit.substr(3)),e}function Ua(t){return t&&!!t.signal}function bk(t){return!!t.step}function wk(t){return!ka(t)&&"field"in t&&"data"in t}let eKt=jr({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1}),nKt={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},Cyt=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function Eyt(t){return t&&!!t.field&&t.equal!==void 0}function OTt(t){return t&&!!t.field&&t.lt!==void 0}function LTt(t){return t&&!!t.field&&t.lte!==void 0}function $Tt(t){return t&&!!t.field&&t.gt!==void 0}function zTt(t){return t&&!!t.field&&t.gte!==void 0}function Tyt(t){return!!(t&&t.field&&(ka(t.range)&&t.range.length===2||Ua(t.range)))}function Ayt(t){return t&&!!t.field&&(ka(t.oneOf)||ka(t.in))}function PTt(t){return Ayt(t)||Eyt(t)||Tyt(t)||OTt(t)||$Tt(t)||LTt(t)||zTt(t)}function zy(t,e){return Yyt(t,{timeUnit:e,wrapTime:!0})}function BTt(t,e=!0){var n;let{field:r}=t,a=(n=Wf(t.timeUnit))===null||n===void 0?void 0:n.unit,s=a?"time("+tKt(a,r)+")":ii(t,{expr:"datum"});if(Eyt(t))return s+"==="+zy(t.equal,a);if(OTt(t))return`${s}<${zy(t.lt,a)}`;if($Tt(t))return`${s}>${zy(t.gt,a)}`;if(LTt(t))return`${s}<=${zy(t.lte,a)}`;if(zTt(t))return`${s}>=${zy(t.gte,a)}`;if(Ayt(t))return`indexof([${function(h,d){return h.map(g=>zy(g,d))}(t.oneOf,a).join(",")}], ${s}) !== -1`;if(function(h){return h&&!!h.field&&h.valid!==void 0}(t))return Iyt(s,t.valid);if(Tyt(t)){let{range:h}=t,d=Ua(h)?{signal:`${h.signal}[0]`}:h[0],g=Ua(h)?{signal:`${h.signal}[1]`}:h[1];if(d!==null&&g!==null&&e)return"inrange("+s+", ["+zy(d,a)+", "+zy(g,a)+"])";let b=[];return d!==null&&b.push(`${s} >= ${zy(d,a)}`),g!==null&&b.push(`${s} <= ${zy(g,a)}`),b.length>0?b.join(" && "):"true"}throw new Error(`Invalid field predicate: ${JSON.stringify(t)}`)}function Iyt(t,e=!0){return e?`isValid(${t}) && isFinite(+${t})`:`!isValid(${t}) || !isFinite(+${t})`}function rKt(t){var e;return PTt(t)&&t.timeUnit?Object.assign(Object.assign({},t),{timeUnit:(e=Wf(t.timeUnit))===null||e===void 0?void 0:e.unit}):t}let vM={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},c9=vM.quantitative,Nyt=vM.ordinal,bM=vM.temporal,Myt=vM.nominal,wM=vM.geojson,iKt=jr(vM),jTt="linear",UTt="log",aKt="pow",oKt="sqrt",sKt="symlog",Dyt="time",Mat="utc",uKt="quantile",lKt="quantize",cKt="threshold",WTt="point",hKt="band",Ryt={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},dKt=jr(Ryt);function fKt(t,e){let n=Ryt[t],r=Ryt[e];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}let pKt={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function VTt(t){return pKt[t]}let GTt=["linear","log","pow","sqrt","symlog","time","utc"],mKt=i9(GTt),gKt=i9(["linear","log","pow","sqrt","symlog"]),yKt=i9(["quantile","quantize","threshold"]),vKt=i9(GTt.concat(["quantile","quantize","threshold","sequential","identity"])),bKt=i9(["ordinal","bin-ordinal","point","band"]);function Xp(t){return t in bKt}function sg(t){return t in vKt}function P1(t){return t in mKt}function Dat(t){return t in yKt}function HTt(t){return t?.selection}let wKt={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},xKt=fa(wKt,["type","domain","range","scheme"]),kKt=jr(xKt);(function(){var t;let e={};for(let n of oTt)for(let r of iKt)for(let a of dKt){let s=SKt(n,r);KTt(n,a)&&XTt(a,r)&&(e[s]=(t=e[s])!==null&&t!==void 0?t:[],e[s].push(a))}})();function YTt(t,e){switch(e){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!Aa(["point","band","identity"],t);case"bins":return!Aa(["point","band","identity","ordinal"],t);case"round":return P1(t)||t==="band"||t==="point";case"padding":return P1(t)||Aa(["point","band"],t);case"paddingOuter":case"align":return Aa(["point","band"],t);case"paddingInner":return t==="band";case"domainMid":case"clamp":return P1(t);case"nice":return P1(t)||t==="quantize"||t==="threshold";case"exponent":return t==="pow";case"base":return t==="log";case"constant":return t==="symlog";case"zero":return sg(t)&&!Aa(["log","time","utc","threshold","quantile"],t)}}function qTt(t,e){switch(e){case"interpolate":case"scheme":case"domainMid":return gM(t)?void 0:`Cannot use the scale property "${t}" with non-color channel.`;case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function XTt(t,e){return Aa([Nyt,Myt],e)?t===void 0||Xp(t):e===bM?Aa([Dyt,Mat,void 0],t):e!==c9||Aa([UTt,aKt,oKt,sKt,uKt,lKt,cKt,jTt,void 0],t)}function KTt(t,e){if(!vk(t))return!1;switch(t){case kl:case oh:case $1:case Ny:return P1(e)||Aa(["band","point"],e);case D3:case pk:case R3:case dk:case fk:case s9:return P1(e)||Dat(e)||Aa(["band","point","ordinal"],e);case Yp:case Ry:case Fy:return e!=="band";case mk:return e==="ordinal"||Dat(e);case qp:return e==="ordinal"}}function SKt(t,e){return t+"_"+e}function Fyt(t){let{channel:e,channelDef:n,markDef:r,scale:a,config:s}=t,h=QTt(t);return gi(n)&&!eTt(n.aggregate)&&a&&P1(a.get("type"))&&a.get("zero")===!1?ZTt({fieldDef:n,channel:e,markDef:r,ref:h,config:s}):h}function ZTt({fieldDef:t,channel:e,markDef:n,ref:r,config:a}){return a9(n.type)||Fs("invalid",n,a)===null?r:[_Kt(t,e),r]}function _Kt(t,e){let n=Oyt(t,!0),r=l9(e)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function Oyt(t,e=!0){return Iyt(bo(t)?t:ii(t,{expr:"datum"}),!e)}function h9(t,e,n,r){let a={};if(e&&(a.scale=e),kk(t)){let{datum:s}=t;yM(s)?a.signal=gW(s):Ua(s)?a.signal=s.signal:a.value=s}else a.field=ii(t,n);if(r){let{offset:s,band:h}=r;s&&(a.offset=s),h&&(a.band=h)}return a}function Rat({scaleName:t,fieldOrDatumDef:e,fieldOrDatumDef2:n,offset:r,startSuffix:a,band:s=.5}){let h=0<s&&s<1?"datum":void 0,d=ii(e,{expr:h,suffix:a}),g=n!==void 0?ii(n,{expr:h}):ii(e,{suffix:"end",expr:h}),b={};if(s===0||s===1){b.scale=t;let _=s===0?d:g;b.field=_}else{let _=`${s} * ${d} + ${1-s} * ${g}`;b.signal=`scale("${t}", ${_})`}return r&&(b.offset=r),b}function QTt({channel:t,channelDef:e,channel2Def:n,markDef:r,config:a,scaleName:s,scale:h,stack:d,offset:g,defaultRef:b,band:_}){var E;if(e){if(Za(e)){if(Z0(e)){_=_??bW({channel:t,fieldDef:e,fieldDef2:n,markDef:r,stack:d,config:a,isMidPoint:!0});let{bin:R,timeUnit:z,type:P}=e;if(Eu(R)||_&&z&&P===bM)return d&&d.impute?h9(e,s,{binSuffix:"mid"},{offset:g}):_?Rat({scaleName:s,fieldOrDatumDef:e,band:_,offset:g}):h9(e,s,wW(e,t)?{binSuffix:"range"}:{},{offset:g});if(Uf(R)){if(gi(n))return Rat({scaleName:s,fieldOrDatumDef:e,fieldOrDatumDef2:n,band:_,offset:g});$r(ATt(t===kl?L1:Iy))}}let I=h?.get("type");return h9(e,s,Xp(I)?{binSuffix:"range"}:{},{offset:g,band:I==="band"?(E=_??e.band)!==null&&E!==void 0?E:.5:void 0})}if(F3(e)){let I=e.value,R=g?{offset:g}:{};return Object.assign(Object.assign({},yW(t,I)),R)}}return typeof b=="function"&&(b=b()),b&&Object.assign(Object.assign({},b),g?{offset:g}:{})}function yW(t,e){return Aa(["x","x2"],t)&&e==="width"?{field:{group:"width"}}:Aa(["y","y2"],t)&&e==="height"?{field:{group:"height"}}:nc(e)}function d9(t){return t&&t!=="number"&&t!=="time"}function JTt(t,e,n){return`${t}(${e}${n?`, ${JSON.stringify(n)}`:""})`}function Lyt({fieldOrDatumDef:t,format:e,formatType:n,expr:r,normalizeStack:a,config:s}){var h,d;if(d9(n))return $yt({fieldOrDatumDef:t,format:e,formatType:n,expr:r,config:s});let g=tAt(t,r,a);if(jat(t)){let b=function(_,E,I,R,z){return!E||I?`${z?"utc":"time"}Format(${_}, '${I=bo(I)?I:R}')`:function(P,rt,ot){if(!P)return;let at=FTt(P);return`${ot||Syt(P)?"utc":"time"}Format(${rt}, ${at})`}(E,_,z)}(g,gi(t)?(h=Wf(t.timeUnit))===null||h===void 0?void 0:h.unit:void 0,e,s.timeFormat,Wyt(t)&&((d=t.scale)===null||d===void 0?void 0:d.type)===Mat);return b?{signal:b}:void 0}return e=rAt(xk(t),e,s),gi(t)&&Eu(t.bin)?{signal:Fat(g,ii(t,{expr:r,binSuffix:"end"}),e,n,s)}:e||xk(t)==="quantitative"?{signal:`${iAt(g,e)}`}:{signal:`isValid(${g}) ? ${g} : ""+${g}`}}function tAt(t,e,n){return gi(t)?n?`${ii(t,{expr:e,suffix:"end"})}-${ii(t,{expr:e,suffix:"start"})}`:ii(t,{expr:e}):function(r){let{datum:a}=r;return yM(a)?gW(a):`${JSON.stringify(a)}`}(t)}function $yt({fieldOrDatumDef:t,format:e,formatType:n,expr:r,normalizeStack:a,config:s,field:h}){return h=h??tAt(t,r,a),gi(t)&&Eu(t.bin)?{signal:Fat(h,ii(t,{expr:r,binSuffix:"end"}),e,n,s)}:{signal:JTt(n,h,e)}}function eAt(t,e,n,r,a,s){var h;if(!d9(r))return jat(t)?function(d,g,b,_){return d||(g?{signal:FTt(g)}:_?void 0:b.timeFormat)}(n,gi(t)?(h=Wf(t.timeUnit))===null||h===void 0?void 0:h.unit:void 0,a,s):rAt(e,n,a)}function nAt(t,e,n){return t&&(Ua(t)||t==="number"||t==="time")?t:jat(e)&&n!=="time"&&n!=="utc"?"time":void 0}function rAt(t,e,n){return bo(e)?e:t===c9?n.numberFormat:void 0}function iAt(t,e){return`format(${t}, "${e||""}")`}function aAt(t,e,n,r){var a;return d9(n)?JTt(n,t,e):iAt(t,(a=bo(e)?e:void 0)!==null&&a!==void 0?a:r.numberFormat)}function Fat(t,e,n,r,a){let s=aAt(t,n,r,a),h=aAt(e,n,r,a);return`${Iyt(t,!1)} ? "null" : ${s} + " \u2013 " + ${h}`}let Oat="min",CKt={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function oAt(t){return t in CKt}function sAt(t){return!!t&&!!t.encoding}function Py(t){return!(!t||t.op!=="count"&&!t.field)}function uAt(t){return!!t&&ka(t)}function vW(t){return"row"in t||"column"in t}function zyt(t){return!!t&&"header"in t}function Lat(t){return"facet"in t}function lAt(t){let{field:e,timeUnit:n,bin:r,aggregate:a}=t;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),a?{aggregate:a}:{}),{field:e})}function cAt(t){return Z0(t)&&"sort"in t}function bW({channel:t,fieldDef:e,fieldDef2:n,markDef:r,stack:a,config:s,isMidPoint:h}){if(Za(e)&&e.band!==void 0)return e.band;if(gi(e)){let{timeUnit:d,bin:g}=e;if(d&&!n)return h?m9("timeUnitBandPosition",r,s):QEt(r.type)?m9("timeUnitBand",r,s):0;if(Eu(g))return QEt(r.type)&&!h?1:.5}return a?.fieldChannel===t&&h?.5:void 0}function Pyt(t,e,n,r,a,s){return!!(Eu(e.bin)||e.timeUnit&&Z0(e)&&e.type==="temporal")&&!!bW({channel:t,fieldDef:e,fieldDef2:n,stack:r,markDef:a,config:s})}function Byt(t){return!!t&&"condition"in t}function $at(t){let e=t&&t.condition;return!!e&&!ka(e)&&gi(e)}function jyt(t){let e=t&&t.condition;return!!e&&!ka(e)&&Za(e)}function gi(t){return!(!t||!t.field&&t.aggregate!=="count")}function xk(t){return t&&t.type}function kk(t){return!!t&&"datum"in t}function By(t){return Z0(t)&&pAt(t)||Uyt(t)}function Uyt(t){return kk(t)&&Ec(t.datum)}function Za(t){return gi(t)||kk(t)}function Z0(t){return!!t&&("field"in t&&"type"in t||t.aggregate==="count")}function F3(t){return t&&"value"in t&&"value"in t}function Wyt(t){return!!t&&("scale"in t||"sort"in t)}function Vyt(t){return t&&("axis"in t||"stack"in t||"impute"in t)}function hAt(t){return!!t&&"legend"in t}function dAt(t){return!!t&&("format"in t||"formatType"in t)}function ii(t,e={}){var n,r,a;let s=t.field,h=e.prefix,d=e.suffix,g="";if(function(_){return _.aggregate==="count"}(t))s=function(_){return _.indexOf("__")===0}(b="count")?b:`__${b}`;else{let _;if(!e.nofn)if(function(E){return"op"in E}(t))_=t.op;else{let{bin:E,aggregate:I,timeUnit:R}=t;Eu(E)?(_=dTt(E),d=((n=e.binSuffix)!==null&&n!==void 0?n:"")+((r=e.suffix)!==null&&r!==void 0?r:"")):I?o9(I)?(g=`["${s}"]`,s=`argmax_${I.argmax}`):hk(I)?(g=`["${s}"]`,s=`argmin_${I.argmin}`):_=String(I):R&&(_=function(z){let P=Wf(z),{utc:rt}=P,ot=fa(P,["utc"]);return ot.unit?(rt?"utc":"")+jr(ot).map(at=>ul(`${at==="unit"?"":`_${at}_`}${ot[at]}`)).join(""):(rt?"utc":"")+"timeunit"+jr(ot).map(at=>ul(`_${at}_${ot[at]}`)).join("")}(R),d=(!Aa(["range","mid"],e.binSuffix)&&e.binSuffix||"")+((a=e.suffix)!==null&&a!==void 0?a:""))}_&&(s=s?`${_}_${s}`:_)}var b;return d&&(s=`${s}_${d}`),h&&(s=`${h}_${s}`),e.forAs?VEt(s):e.expr?function(_,E="datum"){return`${E}[${Vo(n9(_).join("."))}]`}(s,e.expr)+g:ck(s)+g}function fAt(t){switch(t.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return gi(t)&&!!t.bin;case"temporal":return!1}throw new Error(kTt(t.type))}function pAt(t){return!fAt(t)}let mAt=(t,e)=>{switch(e.fieldTitle){case"plain":return t.field;case"functional":return function(n){let{aggregate:r,bin:a,timeUnit:s,field:h}=n;if(o9(r))return`${h} for argmax(${r.argmax})`;if(hk(r))return`${h} for argmin(${r.argmin})`;let d=Wf(s),g=r||d?.unit||d?.maxbins&&"timeunit"||Eu(a)&&"bin";return g?g.toUpperCase()+"("+h+")":h}(t);default:return function(n,r){var a;let{field:s,bin:h,timeUnit:d,aggregate:g}=n;if(g==="count")return r.countTitle;if(Eu(h))return`${s} (binned)`;if(d){let b=(a=Wf(d))===null||a===void 0?void 0:a.unit;if(b)return`${s} (${_yt(b).join("-")})`}else if(g)return o9(g)?`${s} for max ${g.argmax}`:hk(g)?`${s} for min ${g.argmin}`:`${dat(g)} of ${s}`;return s}(t,e)}},gAt=mAt;function yAt(t){gAt=t}function f9(t,e,{allowDisabling:n,includeDefault:r=!0}){var a,s;let h=((a=Gyt(t))!==null&&a!==void 0?a:{}).title;if(!gi(t))return h;let d=t,g=r?vAt(d,e):void 0;return n?Tc(h,d.title,g):(s=h??d.title)!==null&&s!==void 0?s:g}function Gyt(t){return Vyt(t)&&t.axis?t.axis:hAt(t)&&t.legend?t.legend:zyt(t)&&t.header?t.header:void 0}function vAt(t,e){return gAt(t,e)}function zat(t){var e;if(dAt(t)){let{format:n,formatType:r}=t;return{format:n,formatType:r}}{let n=(e=Gyt(t))!==null&&e!==void 0?e:{},{format:r,formatType:a}=n;return{format:r,formatType:a}}}function jy(t){return gi(t)?t:$at(t)?t.condition:void 0}function sh(t){return Za(t)?t:jyt(t)?t.condition:void 0}function Hyt(t,e,n){return bo(t)||Ec(t)||iW(t)?($r(function(r,a,s){return`Channel ${r} is a ${a}. Converted to {value: ${sl(s)}}.`}(e,bo(t)?"string":Ec(t)?"number":"boolean",t)),{value:t}):Za(t)?Pat(t,e,n):jyt(t)?Object.assign(Object.assign({},t),{condition:Pat(t.condition,e,n)}):t}function Pat(t,e,n){if(dAt(t)){let{formatType:r}=t,a=fa(t,["format","formatType"]);if(d9(r)&&!n.customFormatTypes)return $r(xTt(e)),Pat(a,e,n)}else{let r=Vyt(t)?"axis":hAt(t)?"legend":zyt(t)?"header":null;if(r&&t[r]){let a=t[r],{formatType:s}=a,h=fa(a,["format","formatType"]);if(d9(s)&&!n.customFormatTypes)return $r(xTt(e)),Pat(Object.assign(Object.assign({},t),{[r]:h}),e,n)}}return gi(t)?bAt(t,e):function(r){let a=r.type;if(a)return r;let{datum:s}=r;return a=Ec(s)?"quantitative":bo(s)?"nominal":yM(s)?"temporal":void 0,Object.assign(Object.assign({},r),{type:a})}(t)}function bAt(t,e){let{aggregate:n,timeUnit:r,bin:a,field:s}=t,h=Object.assign({},t);if(!n||fyt(n)||o9(n)||hk(n)||($r(function(d){return`Invalid aggregation operator "${d}".`}(n)),delete h.aggregate),r&&(h.timeUnit=Wf(r)),s&&(h.field=`${s}`),Eu(a)&&(h.bin=Bat(a,e)),Uf(a)&&!$y(e)&&$r(`Channel ${e} should not be used with "binned" bin.`),Z0(h)){let{type:d}=h,g=function(b){if(b)switch(b=b.toLowerCase()){case"q":case c9:return"quantitative";case"t":case bM:return"temporal";case"o":case Nyt:return"ordinal";case"n":case Myt:return"nominal";case wM:return"geojson"}}(d);d!==g&&(h.type=g),d!=="quantitative"&&eTt(n)&&($r(function(b,_){return`Invalid field type "${b}" for aggregate: "${_}", using "quantitative" instead.`}(d,n)),h.type="quantitative")}else if(!uTt(e)){let d=function(g,b){if(g.timeUnit)return"temporal";if(Eu(g.bin))return"quantitative";switch(Tat(b)){case"continuous":default:return"quantitative";case"discrete":case"flexible":return"nominal"}}(h,e);$r(function(g,b){return`Missing type for channel "${g}", using "${b}" instead.`}(e,d)),h.type=d}if(Z0(h)){let{compatible:d,warning:g}=function(b,_){let E=b.type;if(E==="geojson"&&_!=="shape")return{compatible:!1,warning:`Channel ${_} should not be used with a geojson data.`};switch(_){case A3:case I3:case wat:return pAt(b)?{compatible:!1,warning:HXt(_)}:p9;case kl:case oh:case Yp:case Ry:case Fy:case hW:case fW:case xat:case u9:case kat:case Sat:case s9:case $1:case Ny:case _at:return p9;case Dy:case ig:case My:case z1:return E!==c9?{compatible:!1,warning:`Channel ${_} should be used with a quantitative field only, not ${b.type} field.`}:p9;case R3:case dk:case fk:case pk:case D3:case M3:case N3:case L1:case Iy:return E!=="nominal"||b.sort?p9:{compatible:!1,warning:`Channel ${_} should not be used with an unsorted discrete field.`};case mk:return Aa(["ordinal","nominal"],b.type)?p9:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case qp:return Aa(["ordinal","nominal","geojson"],b.type)?p9:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case dW:return b.type!=="nominal"||"sort"in b?p9:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(h,e);d||$r(g)}if(cAt(h)&&bo(h.sort)){let{sort:d}=h;if(oAt(d))return Object.assign(Object.assign({},h),{sort:{encoding:d}});let g=d.substr(1);if(d.charAt(0)==="-"&&oAt(g))return Object.assign(Object.assign({},h),{sort:{encoding:g,order:"descending"}})}if(zyt(h)){let{header:d}=h,{orient:g}=d,b=fa(d,["orient"]);if(g)return Object.assign(Object.assign({},h),{header:Object.assign(Object.assign({},b),{labelOrient:d.labelOrient||g,titleOrient:d.titleOrient||g})})}return h}function Bat(t,e){return iW(t)?{maxbins:fTt(e)}:t==="binned"?{binned:!0}:t.maxbins||t.step?t:Object.assign(Object.assign({},t),{maxbins:fTt(e)})}let p9={compatible:!0};function jat(t){let{formatType:e}=zat(t);return e==="time"||!e&&function(n){return n&&(n.type==="temporal"||gi(n)&&!!n.timeUnit)}(t)}function Yyt(t,{timeUnit:e,type:n,wrapTime:r,undefinedIfExprNotRequired:a}){var s;let h=e&&((s=Wf(e))===null||s===void 0?void 0:s.unit),d,g=h||n==="temporal";return Ua(t)?d=t.signal:yM(t)?(g=!0,d=gW(t)):(bo(t)||Ec(t))&&g&&(d=`datetime(${JSON.stringify(t)})`,function(b){return!!DTt[b]}(h)&&(Ec(t)&&t<1e4||bo(t)&&isNaN(Date.parse(t)))&&(d=gW({[h]:t}))),d?r&&g?`time(${d})`:d:a?void 0:JSON.stringify(t)}function wAt(t,e){let{type:n}=t;return e.map(r=>{let a=Yyt(r,{timeUnit:gi(t)?t.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return a!==void 0?{signal:a}:r})}function wW(t,e){return Eu(t.bin)?vk(e)&&Aa(["ordinal","nominal"],t.type):(console.warn("Only call this method for binned field defs."),!1)}function xAt(t){let{anchor:e,frame:n,offset:r,orient:a,color:s,subtitleColor:h,subtitleFont:d,subtitleFontSize:g,subtitleFontStyle:b,subtitleFontWeight:_,subtitleLineHeight:E,subtitlePadding:I}=t,R=fa(t,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),z=Object.assign(Object.assign({},R),s?{fill:s}:{}),P=Object.assign(Object.assign(Object.assign(Object.assign({},e?{anchor:e}:{}),n?{frame:n}:{}),r?{offset:r}:{}),a?{orient:a}:{}),rt=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h?{subtitleColor:h}:{}),d?{subtitleFont:d}:{}),g?{subtitleFontSize:g}:{}),b?{subtitleFontStyle:b}:{}),_?{subtitleFontWeight:_}:{}),E?{subtitleLineHeight:E}:{}),I?{subtitlePadding:I}:{});return{titleMarkConfig:z,subtitleMarkConfig:sW(z,["align","baseline","dx","dy","limit"]),nonMark:P,subtitle:rt}}function Sk(t){return bo(t)||ka(t)&&bo(t[0])}function nc(t){return Ua(t)?t:t!==void 0?{value:t}:void 0}function kAt(t){return Ua(t)?t.signal:Vo(t.value)}function xW(t){return Ua(t)?t.signal:t==null?null:Vo(t)}function SAt(t){var e;return[].concat(t.type,(e=t.style)!==null&&e!==void 0?e:[])}function Fs(t,e,n,r={}){let{vgChannel:a,ignoreVgConfig:s}=r;return a&&e[a]!==void 0?e[a]:e[t]!==void 0?e[t]:!s||a&&a!==t?m9(t,e,n,r):void 0}function m9(t,e,n,{vgChannel:r}={}){return Tc(r?Uat(t,e,n.style):void 0,Uat(t,e,n.style),r?n[e.type][r]:void 0,n[e.type][t],r?n.mark[r]:n.mark[t])}function Uat(t,e,n){return _At(t,SAt(e),n)}function _At(t,e,n){let r;e=ec(e);for(let a of e){let s=n[a];s&&s[t]!==void 0&&(r=s[t])}return r}function CAt(t,e){return ec(t).reduce((n,r)=>{var a;return n.field.push(ii(r,e)),n.order.push((a=r.sort)!==null&&a!==void 0?a:"ascending"),n},{field:[],order:[]})}function EAt(t,e){let n=[...t];return e.forEach(r=>{for(let a of n)if(oW(a,r))return;n.push(r)}),n}function TAt(t,e){return oW(t,e)||!e?t:t?[...ec(t),...ec(e)].join(", "):e}function AAt(t,e){let n=t.value,r=e.value;if(n==null||r===null)return{explicit:t.explicit,value:null};if((Sk(n)||Ua(n))&&(Sk(r)||Ua(r)))return{explicit:t.explicit,value:TAt(n,r)};if(Sk(n)||Ua(n))return{explicit:t.explicit,value:n};if(Sk(r)||Ua(r))return{explicit:t.explicit,value:r};if(!(Sk(n)||Ua(n)||Sk(r)||Ua(r)))return{explicit:t.explicit,value:EAt(n,r)};throw new Error("It should never reach here")}function g9(t,e){let n=t&&t[e];return!!n&&(ka(n)?uW(n,r=>!!r.field):gi(n)||$at(n))}function qyt(t){return uW(oTt,e=>{if(g9(t,e)){let n=t[e];if(ka(n))return uW(n,r=>!!r.aggregate);{let r=jy(n);return r&&!!r.aggregate}}return!1})}function Xyt(t,e){let n=[],r=[],a=[],s=[],h={};return Kyt(t,(d,g)=>{if(gi(d)){let{field:b,aggregate:_,bin:E,timeUnit:I}=d,R=fa(d,["field","aggregate","bin","timeUnit"]);if(_||I||E){let z=Gyt(d),P=z&&z.title,rt=ii(d,{forAs:!0}),ot=Object.assign(Object.assign(Object.assign({},P?[]:{title:f9(d,e,{allowDisabling:!0})}),R),{field:rt});if(_){let at;if(o9(_)?(at="argmax",rt=ii({op:"argmax",field:_.argmax},{forAs:!0}),ot.field=`${rt}.${b}`):hk(_)?(at="argmin",rt=ii({op:"argmin",field:_.argmin},{forAs:!0}),ot.field=`${rt}.${b}`):_!=="boxplot"&&_!=="errorbar"&&_!=="errorband"&&(at=_),at){let dt={op:at,as:rt};b&&(dt.field=b),s.push(dt)}}else if(n.push(rt),Z0(d)&&Eu(E)){if(r.push({bin:E,field:b,as:rt}),n.push(ii(d,{binSuffix:"end"})),wW(d,g)&&n.push(ii(d,{binSuffix:"range"})),$y(g)){let at={field:rt+"_end"};h[g+"2"]=at}ot.bin="binned",uTt(g)||(ot.type=c9)}else if(I){a.push({timeUnit:I,field:b,as:rt});let at=Z0(d)&&d.type!==bM&&"time";at&&(g===hW||g===u9?ot.formatType=at:function(dt){return!!gyt[dt]}(g)?ot.legend=Object.assign({formatType:at},ot.legend):$y(g)&&(ot.axis=Object.assign({formatType:at},ot.axis)))}h[g]=ot}else n.push(b),h[g]=t[g]}else h[g]=t[g]}),{bins:r,timeUnits:a,aggregate:s,groupby:n,encoding:h}}function EKt(t,e,n){let r=e.type;return jr(t).reduce((a,s)=>{if(!sTt(s))return $r(function(d){return`${d}-encoding is dropped as ${d} is not a valid encoding channel.`}(s)),a;let h=t[s];if(s!=="angle"||r!=="arc"||t.theta||($r("Arc marks uses theta channel rather than angle, replacing angle with theta."),s=$1),!function(d,g,b){let _=jXt(g,b);if(!_)return!1;if(_==="binned"){let E=d[g===L1?kl:oh];return!!(gi(E)&&gi(d[g])&&Uf(E.bin))}return!0}(t,s,r))return $r(Iat(s,r)),a;if(s===D3&&r==="line"){let d=jy(t[s]);if(d?.aggregate)return $r("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead."),a}if(s===Yp&&(e.filled?"fill"in t:"stroke"in t))return $r(STt("encoding",{fill:"fill"in t,stroke:"stroke"in t})),a;if(s===fW||s===dW&&!ka(h)&&!F3(h)||s===u9&&ka(h))h&&(a[s]=ec(h).reduce((d,g)=>(gi(g)?d.push(bAt(g,s)):$r(byt(g,s)),d),[]));else{if(s===u9&&h===null)a[s]=null;else if(!(gi(h)||kk(h)||F3(h)||Byt(h)||Ua(h)))return $r(byt(h,s)),a;a[s]=Hyt(h,s,n)}return a},{})}function TKt(t){let e=[];for(let n of jr(t))if(g9(t,n)){let r=ec(t[n]);for(let a of r)gi(a)?e.push(a):$at(a)&&e.push(a.condition)}return e}function Kyt(t,e,n){if(t)for(let r of jr(t)){let a=t[r];if(ka(a))for(let s of a)e.call(n,s,r);else e.call(n,a,r)}}function IAt(t,e,n,r){return t?jr(t).reduce((a,s)=>{let h=t[s];return ka(h)?h.reduce((d,g)=>e.call(r,d,g,s),a):e.call(r,a,h,s)},n):n}function NAt(t,e){return jr(e).reduce((n,r)=>{switch(r){case kl:case oh:case kat:case _at:case Sat:case L1:case Iy:case $1:case M3:case Ny:case N3:case My:case Dy:case z1:case ig:case hW:case qp:case s9:case u9:return n;case dW:if(t==="line"||t==="trail")return n;case fW:case xat:{let a=e[r];if(ka(a)||gi(a))for(let s of ec(a))s.aggregate||n.push(ii(s,{}));return n}case D3:if(t==="trail")return n;case Yp:case Ry:case Fy:case R3:case dk:case fk:case mk:case pk:{let a=jy(e[r]);return a&&!a.aggregate&&n.push(ii(a,{})),n}}},[])}function Zyt(t,e,n,r=!0){return"tooltip"in n?{tooltip:n.tooltip}:{tooltip:[...t.map(({fieldPrefix:a,titlePrefix:s})=>{let h=r?` of ${e.field}`:"";return{field:a+e.field,type:e.type,title:Ua(s)?{signal:s+`"${escape(h)}"`}:s+h}}),...TKt(n)]}}function MAt(t){let{axis:e,title:n,field:r}=t;return e&&e.title!==void 0?void 0:Tc(n,r)}function Qyt(t,e,n,r,a){let{scale:s,axis:h}=n;return({partName:d,mark:g,positionPrefix:b,endPositionPrefix:_,aria:E,extraEncoding:I={}})=>{let R=MAt(n);return DAt(t,d,a,E,{mark:g,encoding:Object.assign(Object.assign(Object.assign({[e]:Object.assign(Object.assign(Object.assign({field:b+"_"+n.field,type:n.type},R!==void 0?{title:R}:{}),s!==void 0?{scale:s}:{}),h!==void 0?{axis:h}:{})},bo(_)?{[e+"2"]:{field:_+"_"+n.field}}:{}),r),I)})}}function DAt(t,e,n,r,a){let{clip:s,color:h,opacity:d}=t,g=t.type;return t[e]||t[e]===void 0&&n[e]?[Object.assign(Object.assign({},a),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[e]),s?{clip:s}:{}),h?{color:h}:{}),d?{opacity:d}:{}),Ay(a.mark)?a.mark:{type:a.mark}),{style:`${g}-${e}`}),iW(t[e])?{}:t[e]),r===!1?{aria:r}:{})})]:[]}function RAt(t,e,n){let{encoding:r}=t,a=e==="vertical"?"y":"x",s=r[a],h=r[a+"2"],d=r[a+"Error"],g=r[a+"Error2"];return{continuousAxisChannelDef:Wat(s,n),continuousAxisChannelDef2:Wat(h,n),continuousAxisChannelDefError:Wat(d,n),continuousAxisChannelDefError2:Wat(g,n),continuousAxis:a}}function Wat(t,e){if(t&&t.aggregate){let{aggregate:n}=t,r=fa(t,["aggregate"]);return n!==e&&$r(function(a,s){return`Continuous axis should not have customized aggregation function ${a}; ${s} already agregates the axis.`}(n,e)),r}return t}function FAt(t,e){let{mark:n,encoding:r}=t,{x:a,y:s}=r;if(By(a)){if(By(s)){let h=gi(a)&&a.aggregate,d=gi(s)&&s.aggregate;if(h||d!==e){if(d||h!==e){if(h===e&&d===e)throw new Error("Both x and y cannot have aggregate");return Ay(n)&&n.orient?n.orient:"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(By(s))return"vertical";throw new Error("Need a valid continuous axis for "+e+"s")}let Vat="boxplot",AKt=new bat(Vat,LAt);function OAt(t){return Ec(t)?"tukey":t}function LAt(t,{config:e}){var n,r;let{mark:a,selection:s}=t,h=fa(t,["mark","encoding","selection","projection"]),d=Ay(a)?a:{type:a};s&&$r(vTt("boxplot"));let g=(n=d.extent)!==null&&n!==void 0?n:e.boxplot.extent,b=Fs("size",d,e),_=OAt(g),{transform:E,continuousAxisChannelDef:I,continuousAxis:R,groupby:z,aggregate:P,encodingWithoutContinuousAxis:rt,ticksOrient:ot,boxOrient:at,customTooltipWithoutAggregatedField:dt}=function(_e,Ve,gn){let $n=FAt(_e,Vat),{continuousAxisChannelDef:Gn,continuousAxis:qe}=RAt(_e,$n,Vat),tr=Gn.field,er=OAt(Ve),An=[...$At(tr),{op:"median",field:tr,as:"mid_box_"+tr},{op:"min",field:tr,as:(er==="min-max"?"lower_whisker_":"min_")+tr},{op:"max",field:tr,as:(er==="min-max"?"upper_whisker_":"max_")+tr}],dn=er==="min-max"||er==="tukey"?[]:[{calculate:`datum["upper_box_${tr}"] - datum["lower_box_${tr}"]`,as:"iqr_"+tr},{calculate:`min(datum["upper_box_${tr}"] + datum["iqr_${tr}"] * ${Ve}, datum["max_${tr}"])`,as:"upper_whisker_"+tr},{calculate:`max(datum["lower_box_${tr}"] - datum["iqr_${tr}"] * ${Ve}, datum["min_${tr}"])`,as:"lower_whisker_"+tr}],nr=_e.encoding,Qn=qe,wr=fa(nr,[typeof Qn=="symbol"?Qn:Qn+""]),{customTooltipWithoutAggregatedField:yi,filteredEncoding:ha}=function(Uh){let{tooltip:rc}=Uh,Do=fa(Uh,["tooltip"]);if(!rc)return{filteredEncoding:Uh};let us,Io;if(ka(rc)){for(let ou of rc)ou.aggregate?(us||(us=[]),us.push(ou)):(Io||(Io=[]),Io.push(ou));us&&(Do.tooltip=us)}else rc.aggregate?Do.tooltip=rc:Io=rc;return ka(Io)&&Io.length===1&&(Io=Io[0]),{customTooltipWithoutAggregatedField:Io,filteredEncoding:Do}}(wr),{bins:mi,timeUnits:si,aggregate:Ei,groupby:ki,encoding:Xi}=Xyt(ha,gn),Fi=$n==="vertical"?"horizontal":"vertical",Go=$n;return{transform:[...mi,...si,{aggregate:[...Ei,...An],groupby:ki},...dn],groupby:ki,aggregate:Ei,continuousAxisChannelDef:Gn,continuousAxis:qe,encodingWithoutContinuousAxis:Xi,ticksOrient:Fi,boxOrient:Go,customTooltipWithoutAggregatedField:yi}}(t,g,e),{size:ct}=rt,Ct=fa(rt,["color","size"]),Et=_e=>Qyt(d,R,I,_e,e.boxplot),Rt=Et(Ct),Ot=Et(rt),Wt=Et(Object.assign(Object.assign({},Ct),ct?{size:ct}:{})),jt=Zyt([{fieldPrefix:_==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:_==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],I,rt),Ht={type:"tick",color:"black",opacity:1,orient:ot,invalid:null},Vt=_==="min-max"?jt:Zyt([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],I,rt),fe=[...Rt({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:Vt}),...Rt({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:Vt}),...Rt({partName:"ticks",mark:Ht,positionPrefix:"lower_whisker",aria:!1,extraEncoding:Vt}),...Rt({partName:"ticks",mark:Ht,positionPrefix:"upper_whisker",aria:!1,extraEncoding:Vt})],se=[..._!=="tukey"?fe:[],...Ot({partName:"box",mark:Object.assign(Object.assign({type:"bar"},b?{size:b}:{}),{orient:at,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:jt}),...Wt({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Bh(e.boxplot.median)&&e.boxplot.median.color?{color:e.boxplot.median.color}:{}),b?{size:b}:{}),{orient:ot,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:jt})],he;if(_!=="min-max"){let _e=`datum["lower_box_${I.field}"]`,Ve=`datum["upper_box_${I.field}"]`,gn=`(${Ve} - ${_e})`,$n=`${_e} - ${g} * ${gn}`,Gn=`${Ve} + ${g} * ${gn}`,qe=`datum["${I.field}"]`,tr={joinaggregate:$At(I.field),groupby:z},er;_==="tukey"&&(er={transform:[{filter:`(${$n} <= ${qe}) && (${qe} <= ${Gn})`},{aggregate:[{op:"min",field:I.field,as:"lower_whisker_"+I.field},{op:"max",field:I.field,as:"upper_whisker_"+I.field},{op:"min",field:"lower_box_"+I.field,as:"lower_box_"+I.field},{op:"max",field:"upper_box_"+I.field,as:"upper_box_"+I.field},...P],groupby:z}],layer:fe});let An=fa(Ct,["tooltip"]),{scale:dn,axis:nr}=I,Qn=MAt(I),wr=DAt(d,"outliers",e.boxplot,!0,{transform:[{filter:`(${qe} < ${$n}) || (${qe} > ${Gn})`}],mark:"point",encoding:Object.assign(Object.assign({[R]:Object.assign(Object.assign(Object.assign({field:I.field,type:I.type},Qn!==void 0?{title:Qn}:{}),dn!==void 0?{scale:dn}:{}),nr!==void 0?{axis:nr}:{})},An),dt?{tooltip:dt}:{})})[0];wr&&er?he={transform:[tr],layer:[wr,er]}:wr?(he=wr,he.transform.unshift(tr)):er&&(he=er,he.transform.unshift(tr))}return he?Object.assign(Object.assign({},h),{layer:[he,{transform:E,layer:se}]}):Object.assign(Object.assign({},h),{transform:((r=h.transform)!==null&&r!==void 0?r:[]).concat(E),layer:se})}function $At(t){return[{op:"q1",field:t,as:"lower_box_"+t},{op:"q3",field:t,as:"upper_box_"+t}]}let Jyt="errorbar",IKt=new bat(Jyt,zAt);function zAt(t,{config:e}){let{transform:n,continuousAxisChannelDef:r,continuousAxis:a,encodingWithoutContinuousAxis:s,ticksOrient:h,markDef:d,outerSpec:g,tooltipEncoding:b}=PAt(t,Jyt,e),_=Qyt(d,a,r,s,e.errorbar),E={type:"tick",orient:h},I=[..._({partName:"ticks",mark:E,positionPrefix:"lower",aria:!1,extraEncoding:b}),..._({partName:"ticks",mark:E,positionPrefix:"upper",aria:!1,extraEncoding:b}),..._({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:b})];return Object.assign(Object.assign(Object.assign({},g),{transform:n}),I.length>1?{layer:I}:Object.assign({},I[0]))}function NKt(t,e){let{encoding:n}=t;if(function(d){return(Za(d.x)||Za(d.y))&&!Za(d.x2)&&!Za(d.y2)&&!Za(d.xError)&&!Za(d.xError2)&&!Za(d.yError)&&!Za(d.yError2)}(n))return{orient:FAt(t,e),inputType:"raw"};let r=function(d){return Za(d.x2)||Za(d.y2)}(n),a=function(d){return Za(d.xError)||Za(d.xError2)||Za(d.yError)||Za(d.yError2)}(n),s=n.x,h=n.y;if(r){if(a)throw new Error(`${e} cannot be both type aggregated-upper-lower and aggregated-error`);let d=n.x2,g=n.y2;if(Za(d)&&Za(g))throw new Error(`${e} cannot have both x2 and y2`);if(Za(d)){if(By(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${e}`)}if(Za(g)){if(By(h))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${e}`)}throw new Error("No ranged axis")}{let d=n.xError,g=n.xError2,b=n.yError,_=n.yError2;if(Za(g)&&!Za(d))throw new Error(`${e} cannot have xError2 without xError`);if(Za(_)&&!Za(b))throw new Error(`${e} cannot have yError2 without yError`);if(Za(d)&&Za(b))throw new Error(`${e} cannot have both xError and yError with both are quantiative`);if(Za(d)){if(By(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(Za(b)){if(By(h))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function PAt(t,e,n){var r;let{mark:a,encoding:s,selection:h}=t,d=fa(t,["mark","encoding","selection","projection"]),g=Ay(a)?a:{type:a};h&&$r(vTt(e));let{orient:b,inputType:_}=NKt(t,e),{continuousAxisChannelDef:E,continuousAxisChannelDef2:I,continuousAxisChannelDefError:R,continuousAxisChannelDefError2:z,continuousAxis:P}=RAt(t,b,e),{errorBarSpecificAggregate:rt,postAggregateCalculates:ot,tooltipSummary:at,tooltipTitleWithFieldName:dt}=function(gn,$n,Gn,qe,tr,er,An,dn){let nr=[],Qn=[],wr=$n.field,yi,ha=!1;if(er==="raw"){let mi=gn.center?gn.center:gn.extent?gn.extent==="iqr"?"median":"mean":dn.errorbar.center,si=gn.extent?gn.extent:mi==="mean"?"stderr":"iqr";if(mi==="median"!=(si==="iqr")&&$r(function(Ei,ki,Xi){return`${Ei} is not usually used with ${ki} for ${Xi}.`}(mi,si,An)),si==="stderr"||si==="stdev")nr=[{op:si,field:wr,as:"extent_"+wr},{op:mi,field:wr,as:"center_"+wr}],Qn=[{calculate:`datum["center_${wr}"] + datum["extent_${wr}"]`,as:"upper_"+wr},{calculate:`datum["center_${wr}"] - datum["extent_${wr}"]`,as:"lower_"+wr}],yi=[{fieldPrefix:"center_",titlePrefix:dat(mi)},{fieldPrefix:"upper_",titlePrefix:BAt(mi,si,"+")},{fieldPrefix:"lower_",titlePrefix:BAt(mi,si,"-")}],ha=!0;else{let Ei,ki,Xi;gn.center&&gn.extent&&$r(function(Fi,Go){return`Center is not needed to be specified in ${Go} when extent is ${Fi}.`}(gn.extent,An)),si==="ci"?(Ei="mean",ki="ci0",Xi="ci1"):(Ei="median",ki="q1",Xi="q3"),nr=[{op:ki,field:wr,as:"lower_"+wr},{op:Xi,field:wr,as:"upper_"+wr},{op:Ei,field:wr,as:"center_"+wr}],yi=[{fieldPrefix:"upper_",titlePrefix:f9({field:wr,aggregate:Xi,type:"quantitative"},dn,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:f9({field:wr,aggregate:ki,type:"quantitative"},dn,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:f9({field:wr,aggregate:Ei,type:"quantitative"},dn,{allowDisabling:!1})}]}}else{(gn.center||gn.extent)&&$r(function(mi,si){return`${si?"extent ":""}${si&&mi?"and ":""}${mi?"center ":""}${si&&mi?"are ":"is "}not needed when data are aggregated.`}(gn.center,gn.extent)),er==="aggregated-upper-lower"?(yi=[],Qn=[{calculate:`datum["${Gn.field}"]`,as:"upper_"+wr},{calculate:`datum["${wr}"]`,as:"lower_"+wr}]):er==="aggregated-error"&&(yi=[{fieldPrefix:"",titlePrefix:wr}],Qn=[{calculate:`datum["${wr}"] + datum["${qe.field}"]`,as:"upper_"+wr}],tr?Qn.push({calculate:`datum["${wr}"] + datum["${tr.field}"]`,as:"lower_"+wr}):Qn.push({calculate:`datum["${wr}"] - datum["${qe.field}"]`,as:"lower_"+wr}));for(let mi of Qn)yi.push({fieldPrefix:mi.as.substring(0,6),titlePrefix:mM(mM(mi.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:Qn,errorBarSpecificAggregate:nr,tooltipSummary:yi,tooltipTitleWithFieldName:ha}}(g,E,I,R,z,_,e,n),ct=s,Ct=P,Et=P==="x"?"x2":"y2",Rt=P==="x"?"xError":"yError",Ot=P==="x"?"xError2":"yError2",Wt=fa(ct,[typeof Ct=="symbol"?Ct:Ct+"",typeof Et=="symbol"?Et:Et+"",typeof Rt=="symbol"?Rt:Rt+"",typeof Ot=="symbol"?Ot:Ot+""]),{bins:jt,timeUnits:Ht,aggregate:Vt,groupby:fe,encoding:se}=Xyt(Wt,n),he=[...Vt,...rt],_e=_!=="raw"?[]:fe,Ve=Zyt(at,E,se,dt);return{transform:[...(r=d.transform)!==null&&r!==void 0?r:[],...jt,...Ht,...he.length===0?[]:[{aggregate:he,groupby:_e}],...ot],groupby:_e,continuousAxisChannelDef:E,continuousAxis:P,encodingWithoutContinuousAxis:se,ticksOrient:b==="vertical"?"horizontal":"vertical",markDef:g,outerSpec:d,tooltipEncoding:Ve}}function BAt(t,e,n){return dat(t)+" "+n+" "+e}let tvt="errorband",MKt=new bat(tvt,jAt);function jAt(t,{config:e}){let{transform:n,continuousAxisChannelDef:r,continuousAxis:a,encodingWithoutContinuousAxis:s,markDef:h,outerSpec:d,tooltipEncoding:g}=PAt(t,tvt,e),b=h,_=Qyt(b,a,r,s,e.errorband),E=t.encoding.x!==void 0&&t.encoding.y!==void 0,I={type:E?"area":"rect"},R={type:E?"line":"rule"},z=Object.assign(Object.assign({},b.interpolate?{interpolate:b.interpolate}:{}),b.tension&&b.interpolate?{tension:b.tension}:{});return E?(I=Object.assign(Object.assign(Object.assign({},I),z),{ariaRoleDescription:"errorband"}),R=Object.assign(Object.assign({},R),z)):b.interpolate?$r(TTt("interpolate")):b.tension&&$r(TTt("tension")),Object.assign(Object.assign({},d),{transform:n,layer:[..._({partName:"band",mark:I,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:g}),..._({partName:"borders",mark:R,positionPrefix:"lower",aria:!1,extraEncoding:g}),..._({partName:"borders",mark:R,positionPrefix:"upper",aria:!1,extraEncoding:g})]})}let UAt={};function evt(t,e,n){let r=new bat(t,e);UAt[t]={normalizer:r,parts:n}}evt(Vat,LAt,["box","median","outliers","rule","ticks"]),evt(Jyt,zAt,["ticks","rule"]),evt(tvt,jAt,["band","borders"]);let DKt=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],WAt=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],RKt={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},FKt={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},xM="_vgsid_",OKt={single:{on:"click",fields:[xM],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[xM],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function nvt(t){return!(!t||t!=="legend"&&!t.legend)}function rvt(t){return nvt(t)&&Bh(t)}function ivt(t){return"concat"in t}function Gat(t){return"vconcat"in t}function avt(t){return"hconcat"in t}function Uy(t){return Bh(t)&&t.step!==void 0}function VAt(t){return t.view||t.width||t.height}let LKt=jr({align:1,bounds:1,center:1,columns:1,spacing:1});function ovt(t,e){var n;return(n=t[e])!==null&&n!==void 0?n:t[e==="width"?"continuousWidth":"continuousHeight"]}function Hat(t,e){let n=kW(t,e);return Uy(n)?n.step:svt}function kW(t,e){var n;return Tc((n=t[e])!==null&&n!==void 0?n:t[e==="width"?"discreteWidth":"discreteHeight"],{step:t.step})}let svt=20,$Kt={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:svt},mark:{color:"#4c78a8",invalid:"filter",timeUnitBand:1},arc:{},area:{},bar:TXt,circle:{},geoshape:{},image:{},line:{},point:{},rect:AXt,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:OKt,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},O3=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],GAt={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},HAt={blue:O3[0],orange:O3[1],red:O3[2],teal:O3[3],green:O3[4],yellow:O3[5],purple:O3[6],pink:O3[7],brown:O3[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function YAt(t={}){let{color:e,font:n,fontSize:r}=t,a=fa(t,["color","font","fontSize"]);return LEt({},$Kt,n?function(s){return{text:{font:s},style:{"guide-label":{font:s},"guide-title":{font:s},"group-title":{font:s},"group-subtitle":{font:s}}}}(n):{},e?function(s={}){return{signals:[{name:"color",value:Bh(s)?Object.assign(Object.assign({},HAt),s):HAt}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(e):{},r?function(s){return{signals:[{name:"fontSize",value:Bh(s)?Object.assign(Object.assign({},GAt),s):GAt}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},a||{})}let zKt=["view",...JEt],PKt=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],BKt=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function jKt(t){t=wo(t);for(let e of PKt)delete t[e];if(t.axis)for(let e in t.axis)lyt(t.axis[e])&&delete t.axis[e];if(t.legend)for(let e of DKt)delete t.legend[e];if(t.mark){for(let e of tTt)delete t.mark[e];t.mark.tooltip&&Bh(t.mark.tooltip)&&delete t.mark.tooltip}for(let e of zKt){for(let r of tTt)delete t[e][r];let n=BKt[e];if(n)for(let r of n)delete t[e][r];UKt(t,e)}for(let e of jr(UAt))delete t[e];(function(e){let{titleMarkConfig:n,subtitleMarkConfig:r,subtitle:a}=xAt(e.title);yu(n)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),n)),yu(r)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),r)),yu(a)?delete e.title:e.title=a})(t);for(let e in t)Bh(t[e])&&yu(t[e])&&delete t[e];return yu(t)?void 0:t}function UKt(t,e,n,r){let a=t[e];e==="view"&&(n="cell");let s=Object.assign(Object.assign({},a),t.style[n??e]);yu(s)||(t.style[n??e]=s),delete t[e]}function Yat(t){return"layer"in t}class qAt{map(e,n){return Lat(e)?this.mapFacet(e,n):function(r){return"repeat"in r}(e)?this.mapRepeat(e,n):avt(e)?this.mapHConcat(e,n):Gat(e)?this.mapVConcat(e,n):ivt(e)?this.mapConcat(e,n):this.mapLayerOrUnit(e,n)}mapLayerOrUnit(e,n){if(Yat(e))return this.mapLayer(e,n);if(T3(e))return this.mapUnit(e,n);throw new Error(vyt(e))}mapLayer(e,n){return Object.assign(Object.assign({},e),{layer:e.layer.map(r=>this.mapLayerOrUnit(r,n))})}mapHConcat(e,n){return Object.assign(Object.assign({},e),{hconcat:e.hconcat.map(r=>this.map(r,n))})}mapVConcat(e,n){return Object.assign(Object.assign({},e),{vconcat:e.vconcat.map(r=>this.map(r,n))})}mapConcat(e,n){let{concat:r}=e,a=fa(e,["concat"]);return Object.assign(Object.assign({},a),{concat:r.map(s=>this.map(s,n))})}mapFacet(e,n){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,n)})}mapRepeat(e,n){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,n)})}}let WKt={zero:1,center:1,normalize:1},VKt=new Set([XEt,mat,pat,vat,yat,hyt,dyt,gat,KEt,cyt]),GKt=new Set([mat,pat,XEt]);function XAt(t,e){var n,r;let a=e==="x"?"y":"radius",s=t[e],h=t[a];if(gi(s)&&gi(h))if(xk(s)==="quantitative"&&xk(h)==="quantitative"){if(s.stack)return e;if(h.stack)return a;let d=gi(s)&&!!s.aggregate;if(d!==(gi(h)&&!!h.aggregate))return d?e:a;{let g=(n=s.scale)===null||n===void 0?void 0:n.type,b=(r=h.scale)===null||r===void 0?void 0:r.type;if(g&&g!=="linear")return a;if(b&&b!=="linear")return e}}else{if(xk(s)==="quantitative")return e;if(xk(h)==="quantitative")return a}else{if(xk(s)==="quantitative")return e;if(xk(h)==="quantitative")return a}}function KAt(t,e,n={}){let r=Ay(t)?t.type:t;if(!VKt.has(r))return null;let a=XAt(e,"x")||XAt(e,"theta");if(!a)return null;let s=e[a],h=gi(s)?ii(s,{}):void 0,d=function(R){switch(R){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(a),g=e[d],b=gi(g)?ii(g,{}):void 0;b===h&&(b=void 0,g=void 0,d=void 0);let _=zXt.reduce((R,z)=>{if(z!=="tooltip"&&g9(e,z)){let P=e[z];for(let rt of ec(P)){let ot=jy(rt);if(ot.aggregate)continue;let at=ii(ot,{});at&&at===b||R.push({channel:z,fieldDef:ot})}}return R},[]),E;if(s.stack!==void 0?E=iW(s.stack)?s.stack?"zero":null:s.stack:_.length>0&&GKt.has(r)&&(E="zero"),!E||!function(R){return R in WKt}(E)||qyt(e)&&_.length===0)return null;if(s.scale&&s.scale.type&&s.scale.type!==jTt){if(n.disallowNonLinearStack)return null;$r(function(R){return`Cannot stack non-linear scale (${R}).`}(s.scale.type))}return Za(e[Oy(a)])?(s.stack!==void 0&&$r(`Cannot stack "${I=a}" if there is already "${I}2".`),null):(gi(s)&&s.aggregate&&!Aa(DXt,s.aggregate)&&$r(`Stacking is applied even though the aggregate function is non-summative ("${s.aggregate}").`),{groupbyChannel:g?d:void 0,groupbyField:b,fieldChannel:a,impute:s.impute!==null&&a9(r),stackBy:_,offset:E});var I}function HKt(t){let e=fa(t,["point","line"]);return jr(e).length>1?e:e.type}function YKt(t){for(let e of["line","area","rule","trail"])t[e]&&(t=Object.assign(Object.assign({},t),{[e]:E3(t[e],["point","line"])}));return t}function uvt(t,e={},n){return t.point==="transparent"?{opacity:0}:t.point?Bh(t.point)?t.point:{}:t.point!==void 0?null:e.point||n.shape?Bh(e.point)?e.point:{}:void 0}function ZAt(t,e={}){return t.line?t.line===!0?{}:t.line:t.line!==void 0?null:e.line?e.line===!0?{}:e.line:void 0}class qKt{constructor(){this.name="path-overlay"}hasMatchingType(e,n){if(T3(e)){let{mark:r,encoding:a}=e,s=Ay(r)?r:{type:r};switch(s.type){case"line":case"rule":case"trail":return!!uvt(s,n[s.type],a);case"area":return!!uvt(s,n[s.type],a)||!!ZAt(s,n[s.type])}}return!1}run(e,n,r){let{config:a}=n,{selection:s,projection:h,encoding:d,mark:g}=e,b=fa(e,["selection","projection","encoding","mark"]),_=Ay(g)?g:{type:g},E=uvt(_,a[_.type],d),I=_.type==="area"&&ZAt(_,a[_.type]),R=[Object.assign(Object.assign({},s?{selection:s}:{}),{mark:HKt(Object.assign(Object.assign({},_.type==="area"&&_.opacity===void 0&&_.fillOpacity===void 0?{opacity:.7}:{}),_)),encoding:E3(d,["shape"])})],z=KAt(_,d),P=d;if(z){let{fieldChannel:rt,offset:ot}=z;P=Object.assign(Object.assign({},d),{[rt]:Object.assign(Object.assign({},d[rt]),ot?{stack:ot}:{})})}return I&&R.push(Object.assign(Object.assign({},h?{projection:h}:{}),{mark:Object.assign(Object.assign({type:"line"},sW(_,["clip","interpolate","tension","tooltip"])),I),encoding:P})),E&&R.push(Object.assign(Object.assign({},h?{projection:h}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},sW(_,["clip","tooltip"])),E),encoding:P})),r(Object.assign(Object.assign({},b),{layer:R}),Object.assign(Object.assign({},n),{config:YKt(a)}))}}class XKt{constructor(){this.name="RangeStep"}hasMatchingType(e){var n;if(T3(e)&&e.encoding)for(let r of og){let a=e.encoding[r];if(a&&Za(a)&&(!((n=a?.scale)===null||n===void 0)&&n.rangeStep))return!0}return!1}run(e){var n;let r={},a=Object.assign({},e.encoding);for(let s of og){let h=Ly(s),d=a[s];if(d&&Za(d)&&(!((n=d?.scale)===null||n===void 0)&&n.rangeStep)){let{scale:g}=d,b=fa(d,["scale"]),_=g,E=fa(_,["rangeStep"]);r[h]={step:g.rangeStep},$r(`Scale's "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.`),a=Object.assign(Object.assign({},a),{[s]:Object.assign(Object.assign({},b),yu(E)?{}:{scale:E})})}}return Object.assign(Object.assign(Object.assign({},r),e),{encoding:a})}}function KKt(t,e){return e?vW(t)?eIt(t,e):QAt(t,e):t}function lvt(t,e){return e?eIt(t,e):t}function cvt(t,e,n){let r=e[t];return function(a){return a&&!bo(a)&&"repeat"in a}(r)?r.repeat in n?Object.assign(Object.assign({},e),{[t]:n[r.repeat]}):void $r(function(a){return`Unknown repeated value "${a}".`}(r.repeat)):e}function QAt(t,e){if((t=cvt("field",t,e))!==void 0){if(t===null)return null;if(cAt(t)&&Py(t.sort)){let n=cvt("field",t.sort,e);t=Object.assign(Object.assign({},t),n?{sort:n}:{})}return t}}function JAt(t,e){if(gi(t))return QAt(t,e);{let n=cvt("datum",t,e);return n===t||n.type||(n.type="nominal"),n}}function tIt(t,e){if(!Za(t)){if(jyt(t)){let n=JAt(t.condition,e);return n?Object.assign(Object.assign({},t),{condition:n}):fa(t,["condition"])}return t}{let n=JAt(t,e);if(n)return n;if(Byt(t))return{condition:t.condition}}}function eIt(t,e){let n={};for(let r in t)if(r9(t,r)){let a=t[r];if(ka(a))n[r]=a.map(s=>tIt(s,e)).filter(s=>s);else{let s=tIt(a,e);s!==void 0&&(n[r]=s)}}return n}class ZKt{constructor(){this.name="RuleForRangedLine"}hasMatchingType(e){if(T3(e)){let{encoding:n,mark:r}=e;if(r==="line")for(let a of $Xt){let s=n[l9(a)];if(n[a]&&(gi(s)&&!Uf(s.bin)||kk(s)))return!0}}return!1}run(e,n,r){let{encoding:a}=e;var s,h;return $r((s=!!a.x2,h=!!a.y2,`Line mark is for continuous lines and thus cannot be used with ${s&&h?"x2 and y2":s?"x2":"y2"}. We will use the rule mark (line segments) instead.`)),r(Object.assign(Object.assign({},e),{mark:"rule"}),n)}}function nIt(t){let{parentEncoding:e,encoding:n}=t;if(e&&n){let s=jr(e).reduce((h,d)=>(n[d]&&h.push(d),h),[]);s.length>0&&$r(`Layer's shared ${(r=s).join(",")} channel ${r.length===1?"is":"are"} overriden.`)}var r;let a=Object.assign(Object.assign({},e??{}),n??{});return yu(a)?void 0:a}function rIt(t){let{parentProjection:e,projection:n}=t;return e&&n&&$r(function(r){let{parentProjection:a,projection:s}=r;return`Layer's shared projection ${sl(a)} is overridden by a child projection ${sl(s)}.`}({parentProjection:e,projection:n})),n??e}function iIt(t,e){e===void 0&&(e=YAt(t.config));let n=function(h,d={}){return QKt.map(h,{config:d})}(t,e),{width:r,height:a}=t,s=function(h,d,g){let{width:b,height:_}=d,E=T3(h)||Yat(h),I={};E?b=="container"&&_=="container"?(I.type="fit",I.contains="padding"):b=="container"?(I.type="fit-x",I.contains="padding"):_=="container"&&(I.type="fit-y",I.contains="padding"):(b=="container"&&($r(pTt("width")),b=void 0),_=="container"&&($r(pTt("height")),_=void 0));let R=Object.assign(Object.assign(Object.assign({type:"pad"},I),g?aIt(g.autosize):{}),aIt(h.autosize));if(R.type!=="fit"||E||($r(WXt),R.type="pad"),b=="container"&&R.type!="fit"&&R.type!="fit-x"&&$r(mTt("width")),_=="container"&&R.type!="fit"&&R.type!="fit-y"&&$r(mTt("height")),!oW(R,{type:"pad"}))return R}(n,{width:r,height:a},e);return Object.assign(Object.assign({},n),s?{autosize:s}:{})}let QKt=new class extends qAt{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[AKt,IKt,MKt,new qKt,new ZKt,new XKt]}map(t,e){if(T3(t)){let n=g9(t.encoding,A3),r=g9(t.encoding,I3),a=g9(t.encoding,wat);if(n||r||a)return this.mapFacetedUnit(t,e)}return super.map(t,e)}mapUnit(t,e){let{parentEncoding:n,parentProjection:r}=e,a=Object.assign(Object.assign({},t),{encoding:lvt(t.encoding,e.repeater)});if(n||r)return this.mapUnitWithParentEncodingOrProjection(a,e);let s=this.mapLayerOrUnit.bind(this);for(let h of this.nonFacetUnitNormalizers)if(h.hasMatchingType(a,e.config))return h.run(a,e,s);return a}mapRepeat(t,e){return function(n){return!ka(n.repeat)&&n.repeat.layer}(t)?this.mapLayerRepeat(t,e):this.mapNonLayerRepeat(t,e)}mapLayerRepeat(t,e){let{repeat:n,spec:r}=t,a=fa(t,["repeat","spec"]),{row:s,column:h,layer:d}=n,{repeater:g={},repeaterPrefix:b=""}=e;return s||h?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},s?{row:s}:{}),h?{column:h}:{}),spec:{repeat:{layer:d},spec:r}}),e):Object.assign(Object.assign({},a),{layer:d.map(_=>{let E=Object.assign(Object.assign({},g),{layer:_}),I=(r.name||"")+b+`child__layer_${ul(_)}`,R=this.mapLayerOrUnit(r,Object.assign(Object.assign({},e),{repeater:E,repeaterPrefix:I}));return R.name=I,R})})}mapNonLayerRepeat(t,e){var n;let{repeat:r,spec:a,data:s}=t,h=fa(t,["repeat","spec","data"]);!ka(r)&&t.columns&&(t=E3(t,["columns"]),$r(bTt("repeat")));let d=[],{repeater:g={},repeaterPrefix:b=""}=e,_=!ka(r)&&r.row||[g?g.row:null],E=!ka(r)&&r.column||[g?g.column:null],I=ka(r)&&r||[g?g.repeat:null];for(let z of I)for(let P of _)for(let rt of E){let ot={repeat:z,row:P,column:rt,layer:g.layer},at=(a.name||"")+b+"child__"+(ka(r)?`${ul(z)}`:(r.row?`row_${ul(P)}`:"")+(r.column?`column_${ul(rt)}`:"")),dt=this.map(a,Object.assign(Object.assign({},e),{repeater:ot,repeaterPrefix:at}));dt.name=at,d.push(E3(dt,["data"]))}let R=ka(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:(n=a.data)!==null&&n!==void 0?n:s,align:"all"},h),{columns:R,concat:d})}mapFacet(t,e){let{facet:n}=t;return vW(n)&&t.columns&&(t=E3(t,["columns"]),$r(bTt("facet"))),super.mapFacet(t,e)}mapUnitWithParentEncodingOrProjection(t,e){let{encoding:n,projection:r}=t,{parentEncoding:a,parentProjection:s,config:h}=e,d=rIt({parentProjection:s,projection:r}),g=nIt({parentEncoding:a,encoding:lvt(n,e.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),d?{projection:d}:{}),g?{encoding:g}:{}),{config:h})}mapFacetedUnit(t,e){let n=t.encoding,{row:r,column:a,facet:s}=n,h=fa(n,["row","column","facet"]),{mark:d,width:g,projection:b,height:_,view:E,selection:I}=t,R=fa(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:z,layout:P}=this.getFacetMappingAndLayout({row:r,column:a,facet:s},e),rt=lvt(h,e.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},R),P),{facet:z,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g?{width:g}:{}),_?{height:_}:{}),E?{view:E}:{}),b?{projection:b}:{}),{mark:d,encoding:rt}),I?{selection:I}:{})}),e)}getFacetMappingAndLayout(t,e){var n;let{row:r,column:a,facet:s}=t;if(r||a){s&&$r(`Facet encoding dropped as ${(h=[...r?[A3]:[],...a?[I3]:[]]).join(" and ")} ${h.length>1?"are":"is"} also specified.`);let d={},g={};for(let b of[A3,I3]){let _=t[b];if(_){let E=fa(_,["align","center","spacing","columns"]);d[b]=E;for(let I of["align","center","spacing"])_[I]!==void 0&&(g[I]=(n=g[I])!==null&&n!==void 0?n:{},g[I][b]=_[I])}}return{facetMapping:d,layout:g}}{let{align:d,center:g,spacing:b,columns:_}=s;return{facetMapping:KKt(fa(s,["align","center","spacing","columns"]),e.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},d?{align:d}:{}),g?{center:g}:{}),b?{spacing:b}:{}),_?{columns:_}:{})}}var h}mapLayer(t,e){var{parentEncoding:n,parentProjection:r}=e,a=fa(e,["parentEncoding","parentProjection"]);let{encoding:s,projection:h}=t,d=fa(t,["encoding","projection"]),g=Object.assign(Object.assign({},a),{parentEncoding:nIt({parentEncoding:n,encoding:s}),parentProjection:rIt({parentProjection:r,projection:h})});return super.mapLayer(d,g)}};function aIt(t){return bo(t)?{type:t}:t??{}}let JKt=["background","padding"];function oIt(t){return JKt.reduce((e,n)=>(t&&t[n]!==void 0&&(e[n]=t[n]),e),{})}class L3{constructor(e={},n={}){this.explicit=e,this.implicit=n}clone(){return new L3(wo(this.explicit),wo(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(e){return Tc(this.explicit[e],this.implicit[e])}getWithExplicit(e){return this.explicit[e]!==void 0?{explicit:!0,value:this.explicit[e]}:this.implicit[e]!==void 0?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}}setWithExplicit(e,n){n.value!==void 0&&this.set(e,n.value,n.explicit)}set(e,n,r){return delete this[r?"implicit":"explicit"][e],this[r?"explicit":"implicit"][e]=n,this}copyKeyFromSplit(e,n){n.explicit[e]!==void 0?this.set(e,n.explicit[e],!0):n.implicit[e]!==void 0&&this.set(e,n.implicit[e],!1)}copyKeyFromObject(e,n){n[e]!==void 0&&this.set(e,n[e],!0)}copyAll(e){for(let n of jr(e.combine())){let r=e.getWithExplicit(n);this.setWithExplicit(n,r)}}}function y9(t){return{explicit:!0,value:t}}function B1(t){return{explicit:!1,value:t}}function sIt(t){return(e,n,r,a)=>{let s=t(e.value,n.value);return s>0?e:s<0?n:qat(e,n,r,a)}}function qat(t,e,n,r){return t.explicit&&e.explicit&&$r(function(a,s,h,d){return`Conflicting ${s.toString()} property "${a.toString()}" (${sl(h)} and ${sl(d)}). Using ${sl(h)}.`}(n,r,t.value,e.value)),t}function _k(t,e,n,r,a=qat){return t===void 0||t.value===void 0?e:t.explicit&&!e.explicit?t:e.explicit&&!t.explicit?e:oW(t.value,e.value)?t:a(t,e,n,r)}class tZt extends L3{constructor(e={},n={},r=!1){super(e,n),this.explicit=e,this.implicit=n,this.parseNothing=r}clone(){let e=super.clone();return e.parseNothing=this.parseNothing,e}}function SW(t){return"url"in t}function Xat(t){return"values"in t}function uIt(t){return"name"in t&&!SW(t)&&!Xat(t)&&!v9(t)}function v9(t){return t&&(lIt(t)||cIt(t)||hvt(t))}function lIt(t){return"sequence"in t}function cIt(t){return"sphere"in t}function hvt(t){return"graticule"in t}let uf="main",Kat="raw";function hIt(t){return"filter"in t}function eZt(t){return"lookup"in t}function nZt(t){return"pivot"in t}function rZt(t){return"density"in t}function iZt(t){return"quantile"in t}function aZt(t){return"regression"in t}function oZt(t){return"loess"in t}function sZt(t){return"sample"in t}function uZt(t){return"window"in t}function lZt(t){return"joinaggregate"in t}function cZt(t){return"flatten"in t}function hZt(t){return"calculate"in t}function dZt(t){return"bin"in t}function fZt(t){return"impute"in t}function pZt(t){return"timeUnit"in t}function mZt(t){return"aggregate"in t}function gZt(t){return"stack"in t}function yZt(t){return"fold"in t}function _W(t,e,n,r){let a=Byt(e)&&e.condition,s=r(e);if(a){let h=ec(a).map(d=>{let g=r(d),b=function(_){return _.selection}(d)?ZIt(t,d.selection):sot(t,d.test);return Object.assign({test:b},g)});return{[n]:[...h,...s!==void 0?[s]:[]]}}return s!==void 0?{[n]:s}:{}}function dvt(t,e="text"){let n=t.encoding[e];return _W(t,n,e,r=>Zat(r,t.config))}function Zat(t,e,n="datum"){if(t){if(F3(t))return nc(t.value);if(Za(t)){let{format:r,formatType:a}=zat(t);return Lyt({fieldOrDatumDef:t,format:r,formatType:a,expr:n,config:e})}}}function dIt(t,e={}){let{encoding:n,markDef:r,config:a,stack:s}=t,h=n.tooltip;if(ka(h))return{tooltip:pIt({tooltip:h},s,a,e)};{let d=e.reactiveGeom?"datum.datum":"datum";return _W(t,h,"tooltip",g=>{let b=Zat(g,a,d);if(b)return b;if(g===null)return;let _=Fs("tooltip",r,a);return _===!0&&(_={content:"encoding"}),bo(_)?{value:_}:Bh(_)?_.content==="encoding"?pIt(n,s,a,e):{signal:d}:void 0})}}function fIt(t,e,n,{reactiveGeom:r}={}){let a={},s=r?"datum.datum":"datum",h=[];function d(b,_){let E=l9(_),I=Z0(b)?b:Object.assign(Object.assign({},b),{type:t[E].type}),R=ec(f9(I,n,{allowDisabling:!1})).join(", "),z;if($y(_)){let P=_==="x"?"x2":"y2",rt=jy(t[P]);if(Uf(I.bin)&&rt){let ot=ii(I,{expr:s}),at=ii(rt,{expr:s}),{format:dt,formatType:ct}=zat(I);z=Fat(ot,at,dt,ct,n),a[P]=!0}else if(e&&e.fieldChannel===_&&e.offset==="normalize"){let{format:ot,formatType:at}=zat(I);z=Lyt({fieldOrDatumDef:I,format:ot,formatType:at,expr:s,config:n,normalizeStack:!0}).signal}}z=z??Zat(I,n,s).signal,h.push({channel:_,key:R,value:z})}Kyt(t,(b,_)=>{gi(b)?d(b,_):$at(b)&&d(b.condition,_)});let g={};for(let{channel:b,key:_,value:E}of h)a[b]||g[_]||(g[Vo(_)]=E);return g}function pIt(t,e,n,{reactiveGeom:r}={}){let a=UEt(fIt(t,e,n,{reactiveGeom:r})).map(({key:s,value:h})=>`${s}: ${h}`);return a.length>0?{signal:`{${a.join(", ")}}`}:void 0}function vZt(t){let{markDef:e,config:n}=t,r=Fs("aria",e,n);return r===!1?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),function(a){let{mark:s,markDef:h,config:d}=a;if(d.aria===!1)return{};let g=Fs("ariaRoleDescription",h,d);return g!=null?{ariaRoleDescription:{value:g}}:s in nKt?{}:{ariaRoleDescription:{value:s}}}(t)),function(a){let{encoding:s,markDef:h,config:d,stack:g}=a,b=s.description;if(b)return _W(a,b,"description",I=>Zat(I,a.config));let _=Fs("description",h,d);if(_!=null)return{description:nc(_)};if(d.aria===!1)return{};let E=fIt(s,g,d);if(!yu(E))return{description:{signal:UEt(E).map(({key:I,value:R})=>`${I} + ": " + (${R})`).join(' + "; " + ')}}}(t))}function jh(t,e,n={}){let{markDef:r,encoding:a,config:s}=e,{vgChannel:h}=n,{defaultRef:d,defaultValue:g}=n;d===void 0&&(g=g??Fs(t,r,s,{vgChannel:h,ignoreVgConfig:!0}),g!==void 0&&(d=nc(g)));let b=a[t];return _W(e,b,h??t,_=>QTt({channel:t,channelDef:_,markDef:r,config:s,scaleName:e.scaleName(t),scale:e.getScaleComponent(t),stack:null,defaultRef:d}))}function mIt(t,e={filled:void 0}){var n,r,a,s;let{markDef:h,encoding:d,config:g}=t,{type:b}=h,_=(n=e.filled)!==null&&n!==void 0?n:Fs("filled",h,g),E=Aa(["bar","point","circle","square","geoshape"],b)?"transparent":void 0,I=(a=(r=Fs(_===!0?"color":void 0,h,g,{vgChannel:"fill"}))!==null&&r!==void 0?r:g.mark[_===!0&&"color"])!==null&&a!==void 0?a:E,R=(s=Fs(_===!1?"color":void 0,h,g,{vgChannel:"stroke"}))!==null&&s!==void 0?s:g.mark[_===!1&&"color"],z=_?"fill":"stroke",P=Object.assign(Object.assign({},I?{fill:nc(I)}:{}),R?{stroke:nc(R)}:{});return h.color&&(_?h.fill:h.stroke)&&$r(STt("property",{fill:"fill"in h,stroke:"stroke"in h})),Object.assign(Object.assign(Object.assign(Object.assign({},P),jh("color",t,{vgChannel:z,defaultValue:_?I:R})),jh("fill",t,{defaultValue:d.fill?I:void 0})),jh("stroke",t,{defaultValue:d.stroke?R:void 0}))}function Qat(t,e){let n=function(a){switch(a){case kl:return"xOffset";case oh:return"yOffset";case L1:return"x2Offset";case Iy:return"y2Offset";case $1:return"thetaOffset";case Ny:return"radiusOffset";case M3:return"theta2Offset";case N3:return"radius2Offset"}}(t),r=e[n];if(r)return r}function lf(t,e,{defaultPos:n,vgChannel:r,isMidPoint:a}){let{encoding:s,markDef:h,config:d,stack:g}=e,b=s[t],_=s[Oy(t)],E=e.scaleName(t),I=e.getScaleComponent(t),R=Qat(t,h),z=fvt({model:e,defaultPos:n,channel:t,scaleName:E,scale:I}),P=!b&&$y(t)&&(s.latitude||s.longitude)?{field:e.getName(t)}:function(rt){let{channel:ot,channelDef:at,isMidPoint:dt,scaleName:ct,stack:Ct,offset:Et,markDef:Rt,config:Ot}=rt;if(Za(at)&&Ct&&ot===Ct.fieldChannel){if(gi(at)){let Wt=bW({channel:ot,fieldDef:at,isMidPoint:dt,markDef:Rt,stack:Ct,config:Ot});if(Wt!==void 0)return Rat({scaleName:ct,fieldOrDatumDef:at,startSuffix:"start",band:Wt,offset:Et})}return h9(at,ct,{suffix:"end"},{offset:Et})}return Fyt(rt)}({channel:t,channelDef:b,channel2Def:_,markDef:h,config:d,isMidPoint:a,scaleName:E,scale:I,stack:g,offset:R,defaultRef:z});return P?{[r||t]:P}:void 0}function fvt({model:t,defaultPos:e,channel:n,scaleName:r,scale:a}){let{markDef:s,config:h}=t;return()=>{let d=l9(n),g=gk(n),b=Fs(n,s,h,{vgChannel:g});if(b!==void 0)return yW(n,b);switch(e){case"zeroOrMin":case"zeroOrMax":if(r){let _=a.get("type");if(!Aa([UTt,Dyt,Mat],_)){if(a.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(e==="zeroOrMin")return d==="y"?{field:{group:"height"}}:{value:0};switch(d){case"radius":return{signal:`min(${t.width.signal},${t.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{let _=t[Ly(n)];return Object.assign(Object.assign({},_),{mult:.5})}}}}let bZt={left:"x",center:"xc",right:"x2"},wZt={top:"y",middle:"yc",bottom:"y2"};function gIt(t,e,n,r="middle"){if(t==="radius"||t==="theta")return gk(t);let a=Fs(t==="x"?"align":"baseline",e,n);return t==="x"?bZt[a||(r==="top"?"left":"center")]:wZt[a||r]}function Jat(t,e,{defaultPos:n,defaultPos2:r,range:a}){return a?yIt(t,e,{defaultPos:n,defaultPos2:r}):lf(t,e,{defaultPos:n})}function yIt(t,e,{defaultPos:n,defaultPos2:r}){let{markDef:a,config:s}=e,h=Oy(t),d=Ly(t),g=function(_,E,I){let{encoding:R,mark:z,markDef:P,stack:rt,config:ot}=_,at=l9(I),dt=Ly(I),ct=gk(I),Ct=R[at],Et=_.scaleName(at),Rt=_.getScaleComponent(at),Ot=Qat(I in R||I in P?I:at,_.markDef);if(!Ct&&(I==="x2"||I==="y2")&&(R.latitude||R.longitude))return{[ct]:{field:_.getName(I)}};let Wt=function({channel:jt,channelDef:Ht,channel2Def:Vt,markDef:fe,config:se,scaleName:he,scale:_e,stack:Ve,offset:gn,defaultRef:$n}){return Za(Ht)&&Ve&&jt.charAt(0)===Ve.fieldChannel.charAt(0)?h9(Ht,he,{suffix:"start"},{offset:gn}):Fyt({channel:jt,channelDef:Vt,scaleName:he,scale:_e,stack:Ve,markDef:fe,config:se,offset:gn,defaultRef:$n})}({channel:I,channelDef:Ct,channel2Def:R[I],markDef:P,config:ot,scaleName:Et,scale:Rt,stack:rt,offset:Ot,defaultRef:void 0});return Wt!==void 0?{[ct]:Wt}:tot(I,P)||tot(I,{[I]:Uat(I,P,ot.style),[dt]:Uat(dt,P,ot.style)})||tot(I,ot[z])||tot(I,ot.mark)||{[ct]:fvt({model:_,defaultPos:E,channel:I,scaleName:Et,scale:Rt})()}}(e,r,h),b=g[d]?gIt(t,a,s):gk(t);return Object.assign(Object.assign({},lf(t,e,{defaultPos:n,vgChannel:b})),g)}function tot(t,e){let n=Ly(t),r=gk(t);return e[r]!==void 0?{[r]:yW(t,e[r])}:e[t]!==void 0?{[r]:yW(t,e[t])}:e[n]?{[n]:yW(t,e[n])}:void 0}function Ck(t,e,n){var r,a,s,h;let{config:d,encoding:g,markDef:b,stack:_}=t,E=Oy(e),I=Ly(e),R=g[e],z=g[E],P=t.getScaleComponent(e),rt=P?P.get("type"):void 0,ot=t.scaleName(e),at=b.orient,dt=(a=(r=g[I])!==null&&r!==void 0?r:g.size)!==null&&a!==void 0?a:Fs("size",b,d,{vgChannel:I}),ct=n==="bar"&&(e==="x"?at==="vertical":at==="horizontal");if(gi(R)&&(Eu(R.bin)||Uf(R.bin)||R.timeUnit&&!z)&&!dt&&!Xp(rt)){let Ct=bW({channel:e,fieldDef:R,stack:_,markDef:b,config:d}),Et=(s=t.component.axes[e])===null||s===void 0?void 0:s[0];return function({fieldDef:Rt,fieldDef2:Ot,channel:Wt,band:jt,scaleName:Ht,markDef:Vt,spacing:fe=0,axisTranslate:se,reverse:he,config:_e}){let Ve=Oy(Wt),gn=gk(Wt),$n=gk(Ve),Gn=Qat(Wt,Vt);if(Eu(Rt.bin)||Rt.timeUnit)return{[$n]:vIt({channel:Wt,fieldDef:Rt,scaleName:Ht,markDef:Vt,band:(1-jt)/2,offset:CW(Ve,fe,he,se,Gn),config:_e}),[gn]:vIt({channel:Wt,fieldDef:Rt,scaleName:Ht,markDef:Vt,band:1-(1-jt)/2,offset:CW(Wt,fe,he,se,Gn),config:_e})};if(Uf(Rt.bin)){let qe=h9(Rt,Ht,{},{offset:CW(Ve,fe,he,se,Gn)});if(gi(Ot))return{[$n]:qe,[gn]:h9(Ot,Ht,{},{offset:CW(Wt,fe,he,se,Gn)})};if(pW(Rt.bin)&&Rt.bin.step)return{[$n]:qe,[gn]:{signal:`scale("${Ht}", ${ii(Rt,{expr:"datum"})} + ${Rt.bin.step})`,offset:CW(Wt,fe,he,se,Gn)}}}return void $r(ATt(Ve))}({fieldDef:R,fieldDef2:z,channel:e,markDef:b,scaleName:ot,band:Ct,axisTranslate:(h=Et?.get("translate"))!==null&&h!==void 0?h:.5,spacing:$y(e)?Fs("binSpacing",b,d):void 0,reverse:P.get("reverse"),config:d})}return(Za(R)&&Xp(rt)||ct)&&!z?function(Ct,Et,Rt,Ot){var Wt;let{markDef:jt,encoding:Ht,config:Vt,stack:fe}=Ot,se=jt.orient,he=Ot.scaleName(Rt),_e=Ot.getScaleComponent(Rt),Ve=Ly(Rt),gn=Oy(Rt),$n=se==="horizontal"&&Rt==="y"||se==="vertical"&&Rt==="x",Gn=Fs($n?"size":Ve,jt,Vt,{vgChannel:Ve}),qe;(Ht.size||Gn!==void 0)&&($n?qe=jh("size",Ot,{vgChannel:Ve,defaultValue:Gn}):$r(function(Qn){return`Cannot apply size to non-oriented mark "${Qn}".`}(jt.type)));let tr=(Wt=Za(Et)?bW({channel:Rt,fieldDef:Et,markDef:jt,stack:fe,config:Vt}):void 0)!==null&&Wt!==void 0?Wt:1;qe=qe||{[Ve]:xZt(Ct,Ve,he,_e,Vt,tr)};let er=_e?.get("type")!=="band"||!("band"in qe[Ve]),An=gIt(Rt,jt,Vt,er?"middle":"top"),dn=Qat(Rt,jt),nr=Fyt({channel:Rt,channelDef:Et,markDef:jt,config:Vt,scaleName:he,scale:_e,stack:fe,offset:dn,defaultRef:fvt({model:Ot,defaultPos:"mid",channel:Rt,scaleName:he,scale:_e}),band:er?.5:(1-tr)/2});if(Ve)return Object.assign({[An]:nr},qe);{let Qn=gk(gn),wr=qe[Ve],yi=dn?Object.assign(Object.assign({},wr),{offset:dn}):wr;return{[An]:nr,[Qn]:ka(nr)?[nr[0],Object.assign(Object.assign({},nr[1]),{offset:yi})]:Object.assign(Object.assign({},nr),{offset:yi})}}}(n,R,e,t):yIt(e,t,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function xZt(t,e,n,r,a,s){if(r){let g=r.get("type");if(g==="point"||g==="band"){if(a[t].discreteBandSize!==void 0)return{value:a[t].discreteBandSize};if(g===WTt){let b=r.get("range");return bk(b)&&Ec(b.step)?{value:b.step-2}:{value:svt-2}}return{scale:n,band:s}}return{value:a[t].continuousBandSize}}let h=Hat(a.view,e),d=Tc(a[t].discreteBandSize,h-2);return d!==void 0?{value:d}:void 0}function CW(t,e,n,r,a){if(rTt(t))return 0;let s=t==="x"||t==="y2"?-e/2:e/2;if(Ua(n)){let h=xW(a);return{signal:`${n.signal} ? ${r-s}${h?"-"+h:""} : ${r+s}${h?"+"+h:""}`}}if(Ua(a)){let h=r+(n?-s:s);return{signal:`${h||""}${n?" - ":h?" + ":""}${a.signal}`}}return a=a||0,r+(n?-a-s:+a+s)}function vIt({channel:t,fieldDef:e,scaleName:n,markDef:r,band:a,offset:s,config:h}){return ZTt({fieldDef:e,channel:t,markDef:r,ref:Rat({scaleName:n,fieldOrDatumDef:e,band:a,offset:s}),config:h})}let kZt=new Set(["aria"]);function ug(t,e){let{fill:n,stroke:r}=e.color==="include"?mIt(t):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(a,s){return eKt.reduce((h,d)=>(kZt.has(d)||a[d]===void 0||s[d]==="ignore"||(h[d]=nc(a[d])),h),{})}(t.markDef,e)),bIt(t,"fill",n)),bIt(t,"stroke",r)),jh("opacity",t)),jh("fillOpacity",t)),jh("strokeOpacity",t)),jh("strokeWidth",t)),jh("strokeDash",t)),dIt(t)),dvt(t,"href")),vZt(t))}function bIt(t,e,n){let{config:r,mark:a,markDef:s}=t;if(Fs("invalid",s,r)==="hide"&&n&&!a9(a)){let h=function(d,{invalid:g=!1,channels:b}){let _=b.reduce((I,R)=>{let z=d.getScaleComponent(R);if(z){let P=z.get("type"),rt=d.vgField(R,{expr:"datum"});rt&&sg(P)&&(I[rt]=!0)}return I},{}),E=jr(_);if(E.length>0){let I=g?"||":"&&";return E.map(R=>Oyt(R,g)).join(` ${I} `)}}(t,{invalid:!0,channels:Eat});if(h)return{[e]:[{test:h,value:null},...ec(n)]}}return n?{[e]:n}:{}}function pvt(t){let{config:e,markDef:n}=t;if(Fs("invalid",n,e)){let r=function(a,{invalid:s=!1,channels:h}){let d=h.reduce((b,_)=>{let E=a.getScaleComponent(_);if(E){let I=E.get("type"),R=a.vgField(_,{expr:"datum"});R&&sg(I)&&(b[R]=!0)}return b},{}),g=jr(d);if(g.length>0){let b=s?"||":"&&";return g.map(_=>Oyt(_,s)).join(` ${b} `)}}(t,{channels:og});if(r)return{defined:{signal:r}}}return{}}function wIt(t,e){if(e!==void 0)return{[t]:nc(e)}}let mvt="voronoi",SZt={has:t=>t.type!=="interval"&&t.nearest,parse:(t,e)=>{if(e.events)for(let n of e.events)n.markname=t.getName(mvt)},marks:(t,e,n)=>{let{x:r,y:a}=e.project.hasChannel,s=t.mark;if(a9(s))return $r(`The "nearest" transform is not supported for ${s} marks.`),n;let h={name:t.getName(mvt),type:"path",interactive:!0,from:{data:t.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},dIt(t,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!a?"datum.datum.x || 0":"0"},y:{expr:a||!r?"datum.datum.y || 0":"0"},size:[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]}]},d=0,g=!1;return n.forEach((b,_)=>{var E;let I=(E=b.name)!==null&&E!==void 0?E:"";I===t.component.mark[0].name?d=_:I.indexOf(mvt)>=0&&(g=!0)}),g||n.splice(d+1,0,h),n}},xIt=SZt;class au{constructor(e,n){this.debugName=n,this._children=[],this._parent=null,e&&(this.parent=e)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(e){this._parent=e,e&&e.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(e,n){this._children.indexOf(e)>-1?console.warn("Attempt to add the same child twice."):n!==void 0?this._children.splice(n,0,e):this._children.push(e)}removeChild(e){let n=this._children.indexOf(e);return this._children.splice(n,1),n}remove(){let e=this._parent.removeChild(this);for(let n of this._children)n._parent=this._parent,this._parent.addChild(n,e++)}insertAsParentOf(e){let n=e.parent;n.removeChild(this),this.parent=n,e.parent=this}swapWithParent(){let e=this._parent,n=e.parent;for(let r of this._children)r.parent=e;this._children=[],e.removeChild(this),e.parent.removeChild(e),this.parent=n,e.parent=this}}class Vf extends au{constructor(e,n,r,a){super(e,n),this.type=r,this.refCounts=a,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){let e=new this.constructor;return e.debugName="clone_"+this.debugName,e._source=this._source,e._name="clone_"+this._name,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${function(e){let n=++bXt;return e?String(e)+n:n}()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(e){this._source=e}}class Wy extends au{constructor(e,n){super(e),this.formula=n}clone(){return new Wy(null,wo(this.formula))}static makeFromEncoding(e,n){let r=n.reduceFieldDef((a,s,h)=>{let{field:d,timeUnit:g}=s,b=Bl(n)?n.encoding[Oy(h)]:void 0,_=Bl(n)&&Pyt(h,s,b,n.stack,n.markDef,n.config);if(g){let E=ii(s,{forAs:!0});a[ss({as:E,field:d,timeUnit:g})]=Object.assign({as:E,field:d,timeUnit:g},_?{band:!0}:{})}return a},{});return yu(r)?null:new Wy(e,r)}static makeFromTransform(e,n){let r=Object.assign({},n),{timeUnit:a}=r,s=fa(r,["timeUnit"]),h=Wf(a),d=Object.assign(Object.assign({},s),{timeUnit:h});return new Wy(e,{[ss(d)]:d})}merge(e){this.formula=Object.assign({},this.formula);for(let n in e.formula)this.formula[n]&&!e.formula[n].band||(this.formula[n]=e.formula[n]);for(let n of e.children)e.removeChild(n),n.parent=this;e.remove()}producedFields(){return new Set(lk(this.formula).map(e=>e.as))}dependentFields(){return new Set(lk(this.formula).map(e=>e.field))}hash(){return`TimeUnit ${ss(this.formula)}`}assemble(){let e=[];for(let n of lk(this.formula)){let{field:r,as:a,timeUnit:s}=n,h=Wf(s),{unit:d,utc:g}=h,b=fa(h,["unit","utc"]);e.push(Object.assign(Object.assign(Object.assign(Object.assign({field:ck(r),type:"timeunit"},d?{units:_yt(d)}:{}),g?{timezone:"utc"}:{}),b),{as:[a,`${a}_end`]}))}return e}}let EW="_tuple_fields";class _Zt{constructor(...e){this.items=e,this.hasChannel={},this.hasField={}}}let CZt={has:()=>!0,parse:(t,e,n)=>{var r,a,s;let h=e.name,d=(r=e.project)!==null&&r!==void 0?r:e.project=new _Zt,g={},b={},_=new Set,E=(I,R)=>{let z=R==="visual"?I.channel:I.field,P=ul(`${h}_${z}`);for(let rt=1;_.has(P);rt++)P=ul(`${h}_${z}_${rt}`);return _.add(P),{[R]:P}};if(!n.fields&&!n.encodings){let I=t.config.selection[n.type];if(n.init)for(let R of ec(n.init))for(let z of jr(R))LXt[z]?(n.encodings||(n.encodings=[])).push(z):n.type==="interval"?($r('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=I.encodings):(n.fields||(n.fields=[])).push(z);else n.encodings=I.encodings,n.fields=I.fields}for(let I of(a=n.fields)!==null&&a!==void 0?a:[]){let R={type:"E",field:I};R.signals=Object.assign({},E(R,"data")),d.items.push(R),d.hasField[I]=R}for(let I of(s=n.encodings)!==null&&s!==void 0?s:[]){let R=t.fieldDef(I);if(R){let z=R.field;if(R.aggregate){$r(VXt(I,R.aggregate));continue}if(!z){$r(yTt(I));continue}if(R.timeUnit){z=t.vgField(I);let P={timeUnit:R.timeUnit,as:z,field:R.field};b[ss(P)]=P}if(!g[z]){let P="E";e.type==="interval"?sg(t.getScaleComponent(I).get("type"))&&(P="R"):R.bin&&(P="R-RE");let rt={field:z,channel:I,type:P};rt.signals=Object.assign(Object.assign({},E(rt,"data")),E(rt,"visual")),d.items.push(g[z]=rt),d.hasField[z]=d.hasChannel[I]=g[z]}}else $r(yTt(I))}if(n.init){let I=R=>d.items.map(z=>R[z.channel]!==void 0?R[z.channel]:R[z.field]);if(n.type==="interval")e.init=I(n.init);else{let R=ec(n.init);e.init=R.map(I)}}yu(b)||(d.timeUnit=new Wy(null,b))},signals:(t,e,n)=>{let r=e.name+EW;return n.filter(s=>s.name===r).length>0?n:n.concat({name:r,value:e.project.items.map(s=>{let h=fa(s,["signals","hasLegend"]);return h.field=ck(h.field),h})})}},EZt={has:t=>t.type==="single"&&t.resolve==="global"&&t.bind&&t.bind!=="scales"&&!nvt(t.bind),parse:(t,e,n,r)=>{r.on||delete e.events,r.clear||delete e.clear},topLevelSignals:(t,e,n)=>{let r=e.name,a=e.project,s=e.bind,h=e.init&&e.init[0],d=xIt.has(e)?"(item().isVoronoi ? datum.datum : datum)":"datum";return a.items.forEach((g,b)=>{var _,E;let I=ul(`${r}_${g.field}`);n.filter(z=>z.name===I).length||n.unshift(Object.assign(Object.assign({name:I},h?{init:kM(h[b])}:{value:null}),{on:e.events?[{events:e.events,update:`datum && item().mark.marktype !== 'group' ? ${d}[${Vo(g.field)}] : null`}]:[],bind:(E=(_=s[g.field])!==null&&_!==void 0?_:s[g.channel])!==null&&E!==void 0?E:s}))}),n},signals:(t,e,n)=>{let r=e.name,a=e.project,s=n.filter(b=>b.name===r+Vy)[0],h=r+EW,d=a.items.map(b=>ul(`${r}_${b.field}`)),g=d.map(b=>`${b} !== null`).join(" && ");return d.length&&(s.update=`${g} ? {fields: ${h}, values: [${d.join(", ")}]} : null`),delete s.value,delete s.on,n}},kIt=EZt,eot="_toggle",SIt={has:t=>t.type==="multi"&&!!t.toggle,signals:(t,e,n)=>n.concat({name:e.name+eot,value:!1,on:[{events:e.events,update:e.toggle}]}),modifyExpr:(t,e)=>{let n=e.name+Vy,r=e.name+eot;return`${r} ? null : ${n}, `+(e.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${$3(t)}}, `)+`${r} ? ${n} : null`}},TZt={has:t=>t.clear!==void 0&&t.clear!==!1,parse:(t,e,n)=>{n.clear&&(e.clear=bo(n.clear)?e9(n.clear,"scope"):n.clear)},topLevelSignals:(t,e,n)=>{if(kIt.has(e))for(let r of e.project.items){let a=n.findIndex(s=>s.name===ul(`${e.name}_${r.field}`));a!==-1&&n[a].on.push({events:e.clear,update:"null"})}return n},signals:(t,e,n)=>{function r(a,s){a!==-1&&n[a].on&&n[a].on.push({events:e.clear,update:s})}if(e.type==="interval")for(let a of e.project.items){let s=n.findIndex(h=>h.name===a.signals.visual);r(s,"[0, 0]"),s===-1&&r(n.findIndex(h=>h.name===a.signals.data),"null")}else{let a=n.findIndex(s=>s.name===e.name+Vy);r(a,"null"),SIt.has(e)&&(a=n.findIndex(s=>s.name===e.name+eot),r(a,"false"))}return n}},AZt={has:t=>t.type==="interval"&&t.resolve==="global"&&t.bind&&t.bind==="scales",parse:(t,e)=>{let n=e.scales=[];for(let r of e.project.items){let a=r.channel;if(!vk(a))continue;let s=t.getScaleComponent(a),h=s?s.get("type"):void 0;if(!s||!sg(h)){$r("Scale bindings are currently only supported for scales with unbinned, continuous domains.");continue}let d={selection:e.name,field:r.field};s.set("selectionExtent",d,!0),n.push(r)}},topLevelSignals:(t,e,n)=>{let r=e.scales.filter(h=>n.filter(d=>d.name===h.signals.data).length===0);if(!t.parent||yvt(t)||r.length===0)return n;let a=n.filter(h=>h.name===e.name)[0],s=a.update;if(s.indexOf(FIt)>=0)a.update=`{${r.map(h=>`${Vo(h.field)}: ${h.signals.data}`).join(", ")}}`;else{for(let h of r){let d=`${Vo(h.field)}: ${h.signals.data}`;s.indexOf(d)<0&&(s=`${s.substring(0,s.length-1)}, ${d}}`)}a.update=s}return n.concat(r.map(h=>({name:h.signals.data})))},signals:(t,e,n)=>{if(t.parent&&!yvt(t))for(let r of e.scales){let a=n.filter(s=>s.name===r.signals.data)[0];a.push="outer",delete a.value,delete a.update}return n}},Ek=AZt;function gvt(t,e){return`domain(${Vo(t.scaleName(e))})`}function yvt(t){var e;return t.parent&&MM(t.parent)&&((e=!t.parent.parent)!==null&&e!==void 0?e:yvt(t.parent.parent))}let _It={has:t=>{let e=t.resolve==="global"&&t.bind&&nvt(t.bind),n=t.project.items.length===1&&t.project.items[0].field!==xM;return e&&!n&&$r("Legend bindings are only supported for selections over an individual field or encoding channel."),e&&n},parse:(t,e,n,r)=>{var a;if(r.on||delete e.events,r.clear||delete e.clear,r.on||r.clear){let d='event.item && indexof(event.item.mark.role, "legend") < 0';for(let g of e.events)g.filter=ec((a=g.filter)!==null&&a!==void 0?a:[]),g.filter.indexOf(d)<0&&g.filter.push(d)}let s=rvt(e.bind)?e.bind.legend:"click",h=bo(s)?e9(s,"view"):ec(s);e.bind={legend:{merge:h}}},topLevelSignals:(t,e,n)=>{let r=e.name,a=rvt(e.bind)&&e.bind.legend,s=h=>d=>{let g=wo(d);return g.markname=h,g};for(let h of e.project.items){if(!h.hasLegend)continue;let d=`${ul(h.field)}_legend`,g=`${r}_${d}`;if(n.filter(_=>_.name===g).length===0){let _=a.merge.map(s(`${d}_symbols`)).concat(a.merge.map(s(`${d}_labels`))).concat(a.merge.map(s(`${d}_entries`)));n.unshift(Object.assign(Object.assign({name:g},e.init?{}:{value:null}),{on:[{events:_,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:a.merge,update:`!event.item || !datum ? null : ${g}`,force:!0}]}))}}return n},signals:(t,e,n)=>{let r=e.name,a=e.project,s=n.find(E=>E.name===r+Vy),h=r+EW,d=a.items.filter(E=>E.hasLegend).map(E=>ul(`${r}_${ul(E.field)}_legend`)),g=`${d.map(E=>`${E} !== null`).join(" && ")} ? {fields: ${h}, values: [${d.join(", ")}]} : null`;e.events&&d.length>0?s.on.push({events:d.map(E=>({signal:E})),update:g}):d.length>0&&(s.update=g,delete s.value,delete s.on);let b=n.find(E=>E.name===r+eot),_=rvt(e.bind)&&e.bind.legend;return b&&(e.events?b.on.push(Object.assign(Object.assign({},b.on[0]),{events:_})):b.on[0].events=_),n}},CIt="_translate_anchor",EIt="_translate_delta",IZt={has:t=>t.type==="interval"&&t.translate,signals:(t,e,n)=>{let r=e.name,a=Ek.has(e),s=r+CIt,{x:h,y:d}=e.project.hasChannel,g=e9(e.translate,"scope");return a||(g=g.map(b=>(b.between[0].markname=r+TW,b))),n.push({name:s,value:{},on:[{events:g.map(b=>b.between[0]),update:"{x: x(unit), y: y(unit)"+(h!==void 0?", extent_x: "+(a?gvt(t,kl):`slice(${h.signals.visual})`):"")+(d!==void 0?", extent_y: "+(a?gvt(t,oh):`slice(${d.signals.visual})`):"")+"}"}]},{name:r+EIt,value:{},on:[{events:g,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),h!==void 0&&TIt(t,e,h,"width",n),d!==void 0&&TIt(t,e,d,"height",n),n}};function TIt(t,e,n,r,a){var s;let h=e.name,d=h+CIt,g=h+EIt,b=n.channel,_=Ek.has(e),E=a.filter(ot=>ot.name===n.signals[_?"data":"visual"])[0],I=t.getSizeSignalRef(r).signal,R=t.getScaleComponent(b),z=R.get("type"),P=`${d}.extent_${b}`,rt=`${_?z==="log"?"panLog":z==="pow"?"panPow":"panLinear":"panLinear"}(${P}, ${`${_&&b===kl?"-":""}${g}.${b} / `+(_?`${I}`:`span(${P})`)}`+(_&&z==="pow"?`, ${(s=R.get("exponent"))!==null&&s!==void 0?s:1}`:"")+")";E.on.push({events:{signal:g},update:_?rt:`clampRange(${rt}, 0, ${I})`})}let AIt="_zoom_anchor",IIt="_zoom_delta",NZt={has:t=>t.type==="interval"&&t.zoom,signals:(t,e,n)=>{let r=e.name,a=Ek.has(e),s=r+IIt,{x:h,y:d}=e.project.hasChannel,g=Vo(t.scaleName(kl)),b=Vo(t.scaleName(oh)),_=e9(e.zoom,"scope");return a||(_=_.map(E=>(E.markname=r+TW,E))),n.push({name:r+AIt,on:[{events:_,update:a?"{"+[g?`x: invert(${g}, x(unit))`:"",b?`y: invert(${b}, y(unit))`:""].filter(E=>!!E).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:_,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),h!==void 0&&NIt(t,e,h,"width",n),d!==void 0&&NIt(t,e,d,"height",n),n}};function NIt(t,e,n,r,a){var s;let h=e.name,d=n.channel,g=Ek.has(e),b=a.filter(rt=>rt.name===n.signals[g?"data":"visual"])[0],_=t.getSizeSignalRef(r).signal,E=t.getScaleComponent(d),I=E.get("type"),R=g?gvt(t,d):b.name,z=h+IIt,P=`${g?I==="log"?"zoomLog":I==="pow"?"zoomPow":"zoomLinear":"zoomLinear"}(${R}, ${`${h}${AIt}.${d}`}, ${z}`+(g&&I==="pow"?`, ${(s=E.get("exponent"))!==null&&s!==void 0?s:1}`:"")+")";b.on.push({events:{signal:z},update:g?P:`clampRange(${P}, 0, ${_})`})}let MZt=[CZt,SIt,Ek,_It,IZt,NZt,kIt,xIt,TZt];function not(t,e){for(let n of MZt)n.has(t)&&e(n)}function kM(t,e=!0,n=lXt){if(ka(t)){let r=t.map(a=>kM(a,e,n));return e?`[${r.join(", ")}]`:r}return yM(t)?n(e?gW(t):function(r){let a=xyt(r,!0);return r.utc?+new Date(Date.UTC(...a)):+new Date(...a)}(t)):e?n(JSON.stringify(t)):t}function MIt(t,e){return w9(t,(n,r)=>{e=r.marks?r.marks(t,n,e):e,not(n,a=>{a.marks&&(e=a.marks(t,n,e))})}),e}function vvt(t){return t.map(e=>(e.on&&!e.on.length&&delete e.on,e))}let TW="_brush",bvt="_scale_trigger",DZt={signals:(t,e)=>{let n=e.name,r=n+EW,a=Ek.has(e),s=[],h=[],d=[];if(e.translate&&!a){let _=`!event.item || event.item.mark.name !== ${Vo(n+TW)}`;DIt(e,(E,I)=>{var R;let z=ec((R=I.between[0].filter)!==null&&R!==void 0?R:I.between[0].filter=[]);return z.indexOf(_)<0&&z.push(_),E})}e.project.items.forEach((_,E)=>{let I=_.channel;if(I!==kl&&I!==oh)return void $r("Interval selections only support x and y encoding channels.");let R=e.init?e.init[E]:null,z=function(dt,ct,Ct,Et){let Rt=Ct.channel,Ot=Ct.signals.visual,Wt=Ct.signals.data,jt=Ek.has(ct),Ht=Vo(dt.scaleName(Rt)),Vt=dt.getScaleComponent(Rt),fe=Vt?Vt.get("type"):void 0,se=gn=>`scale(${Ht}, ${gn})`,he=dt.getSizeSignalRef(Rt===kl?"width":"height").signal,_e=`${Rt}(unit)`,Ve=DIt(ct,(gn,$n)=>[...gn,{events:$n.between[0],update:`[${_e}, ${_e}]`},{events:$n,update:`[${Ot}[0], clamp(${_e}, 0, ${he})]`}]);return Ve.push({events:{signal:ct.name+bvt},update:sg(fe)?`[${se(`${Wt}[0]`)}, ${se(`${Wt}[1]`)}]`:"[0, 0]"}),jt?[{name:Wt,on:[]}]:[Object.assign(Object.assign({name:Ot},Et?{init:kM(Et,!0,se)}:{value:[]}),{on:Ve}),Object.assign(Object.assign({name:Wt},Et?{init:kM(Et)}:{}),{on:[{events:{signal:Ot},update:`${Ot}[0] === ${Ot}[1] ? null : invert(${Ht}, ${Ot})`}]})]}(t,e,_,R),P=_.signals.data,rt=_.signals.visual,ot=Vo(t.scaleName(I)),at=sg(t.getScaleComponent(I).get("type"))?"+":"";s.push(...z),h.push(P),d.push({scaleName:t.scaleName(I),expr:`(!isArray(${P}) || (${at}invert(${ot}, ${rt})[0] === ${at}${P}[0] && ${at}invert(${ot}, ${rt})[1] === ${at}${P}[1]))`})}),a||s.push({name:n+bvt,value:{},on:[{events:d.map(_=>({scale:_.scaleName})),update:d.map(_=>_.expr).join(" && ")+` ? ${n+bvt} : {}`}]});let g=e.init,b=`unit: ${$3(t)}, fields: ${r}, values`;return s.concat(Object.assign(Object.assign({name:n+Vy},g?{init:`{${b}: ${kM(g)}}`}:{}),{on:[{events:[{signal:h.join(" || ")}],update:h.join(" && ")+` ? {${b}: [${h}]} : null`}]}))},modifyExpr:(t,e)=>e.name+Vy+", "+(e.resolve==="global"?"true":`{unit: ${$3(t)}}`),marks:(t,e,n)=>{let r=e.name,{x:a,y:s}=e.project.hasChannel,h=a&&a.signals.visual,d=s&&s.signals.visual,g=`data(${Vo(e.name+b9)})`;if(Ek.has(e))return n;let b={x:a!==void 0?{signal:`${h}[0]`}:{value:0},y:s!==void 0?{signal:`${d}[0]`}:{value:0},x2:a!==void 0?{signal:`${h}[1]`}:{field:{group:"width"}},y2:s!==void 0?{signal:`${d}[1]`}:{field:{group:"height"}}};if(e.resolve==="global")for(let rt of jr(b))b[rt]=[Object.assign({test:`${g}.length && ${g}[0].unit === ${$3(t)}`},b[rt]),{value:0}];let _=e.mark,{fill:E,fillOpacity:I,cursor:R}=_,z=fa(_,["fill","fillOpacity","cursor"]),P=jr(z).reduce((rt,ot)=>(rt[ot]=[{test:[a!==void 0&&`${h}[0] !== ${h}[1]`,s!==void 0&&`${d}[0] !== ${d}[1]`].filter(at=>at).join(" && "),value:z[ot]},{value:null}],rt),{});return[{name:r+TW+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:E},fillOpacity:{value:I}},update:b}},...n,{name:r+TW,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},R?{cursor:{value:R}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},b),P)}}]}};function DIt(t,e){return t.events.reduce((n,r)=>r.between?e(n,r):($r(`${r} is not an ordered event stream for interval selections.`),n),[])}function RIt(t,e){let n=e.name,r=n+EW,a=e.project,s="(item().isVoronoi ? datum.datum : datum)",h=a.items.map(b=>{let _=t.fieldDef(b.channel);return _&&_.bin?`[${s}[${Vo(t.vgField(b.channel,{}))}], ${s}[${Vo(t.vgField(b.channel,{binSuffix:"end"}))}]]`:`${s}[${Vo(b.field)}]`}).join(", "),d=`unit: ${$3(t)}, fields: ${r}, values`,g=e.events;return[{name:n+Vy,on:g?[{events:g,update:`datum && item().mark.marktype !== 'group' ? {${d}: [${h}]} : null`,force:!0}]:[]}]}let RZt={signals:RIt,modifyExpr:(t,e)=>e.name+Vy+", "+(e.resolve==="global"?"null":`{unit: ${$3(t)}}`)},FZt={signals:RIt,modifyExpr:(t,e)=>e.name+Vy+", "+(e.resolve==="global"?"true":`{unit: ${$3(t)}}`)},b9="_store",Vy="_tuple",OZt="_modify",FIt="vlSelectionResolve",LZt={single:FZt,multi:RZt,interval:DZt};function w9(t,e){let n=t.component.selection;if(n){for(let r of lk(n))if(e(r,LZt[r.type])===!0)break}}function $3(t,{escape:e}={escape:!0}){let n=e?Vo(t.name):t.name,r=function(a){let s=a.parent;for(;s&&!V1(s);)s=s.parent;return s}(t);if(r){let{facet:a}=r;for(let s of ag)a[s]&&(n+=` + '__facet_${s}_' + (facet[${Vo(r.vgField(s))}])`)}return n}function wvt(t){let e=!1;return w9(t,n=>{e=e||n.project.items.some(r=>r.field===xM)}),e}let $Zt="Property",zZt="ArrayExpression",PZt="BinaryExpression",BZt="CallExpression",jZt="ConditionalExpression",UZt="LogicalExpression",WZt="MemberExpression",VZt="ObjectExpression",GZt="UnaryExpression";function j1(t){this.type=t}var z3,Ji,yr,cf,Xs;j1.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(a){switch(a.type){case zZt:return a.elements;case PZt:case UZt:return[a.left,a.right];case BZt:return[a.callee].concat(a.arguments);case jZt:return[a.test,a.consequent,a.alternate];case WZt:return[a.object,a.property];case VZt:return a.properties;case $Zt:return[a.key,a.value];case GZt:return[a.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1},(z3={})[1]="Boolean",z3[2]="<end>",z3[3]="Identifier",z3[4]="Keyword",z3[5]="Null",z3[6]="Numeric",z3[7]="Punctuator",z3[8]="String",z3[9]="RegularExpression";var OIt="Identifier",md="Unexpected token %0",LIt="Invalid regular expression",xvt="Invalid regular expression: missing /",$It="Octal literals are not allowed in strict mode.",hf="ILLEGAL",AW="Disabled.",HZt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),YZt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function rot(t,e){if(!t)throw new Error("ASSERT: "+e)}function P3(t){return t>=48&&t<=57}function kvt(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function IW(t){return"01234567".indexOf(t)>=0}function qZt(t){return t===32||t===9||t===11||t===12||t===160||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function NW(t){return t===10||t===13||t===8232||t===8233}function MW(t){return t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t===92||t>=128&&HZt.test(String.fromCharCode(t))}function iot(t){return t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||t===92||t>=128&&YZt.test(String.fromCharCode(t))}var XZt={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function zIt(){for(var t;yr<cf&&(qZt(t=Ji.charCodeAt(yr))||NW(t));)++yr}function Svt(t){var e,n,r,a=0;for(n=t==="u"?4:2,e=0;e<n;++e)yr<cf&&kvt(Ji[yr])?(r=Ji[yr++],a=16*a+"0123456789abcdef".indexOf(r.toLowerCase())):Os({},md,hf);return String.fromCharCode(a)}function KZt(){var t,e,n,r;for(e=0,(t=Ji[yr])==="}"&&Os({},md,hf);yr<cf&&kvt(t=Ji[yr++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||t!=="}")&&Os({},md,hf),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function PIt(){var t,e;for(t=Ji.charCodeAt(yr++),e=String.fromCharCode(t),t===92&&(Ji.charCodeAt(yr)!==117&&Os({},md,hf),++yr,(t=Svt("u"))&&t!=="\\"&&MW(t.charCodeAt(0))||Os({},md,hf),e=t);yr<cf&&iot(t=Ji.charCodeAt(yr));)++yr,e+=String.fromCharCode(t),t===92&&(e=e.substr(0,e.length-1),Ji.charCodeAt(yr)!==117&&Os({},md,hf),++yr,(t=Svt("u"))&&t!=="\\"&&iot(t.charCodeAt(0))||Os({},md,hf),e+=t);return e}function ZZt(){var t,e;return t=yr,e=Ji.charCodeAt(yr)===92?PIt():function(){var n,r;for(n=yr++;yr<cf;){if((r=Ji.charCodeAt(yr))===92)return yr=n,PIt();if(!iot(r))break;++yr}return Ji.slice(n,yr)}(),{type:e.length===1?3:XZt.hasOwnProperty(e)?4:e==="null"?5:e==="true"||e==="false"?1:3,value:e,start:t,end:yr}}function _vt(){var t,e,n,r,a=yr,s=Ji.charCodeAt(yr),h=Ji[yr];switch(s){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++yr,{type:7,value:String.fromCharCode(s),start:a,end:yr};default:if((t=Ji.charCodeAt(yr+1))===61)switch(s){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return yr+=2,{type:7,value:String.fromCharCode(s)+String.fromCharCode(t),start:a,end:yr};case 33:case 61:return yr+=2,Ji.charCodeAt(yr)===61&&++yr,{type:7,value:Ji.slice(a,yr),start:a,end:yr}}}return(r=Ji.substr(yr,4))===">>>="?{type:7,value:r,start:a,end:yr+=4}:(n=r.substr(0,3))===">>>"||n==="<<="||n===">>="?{type:7,value:n,start:a,end:yr+=3}:h===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(h)>=0||e==="=>"?{type:7,value:e,start:a,end:yr+=2}:"<>=!+-*%&|^/".indexOf(h)>=0?{type:7,value:h,start:a,end:++yr}:void Os({},md,hf)}function BIt(){var t,e,n;if(rot(P3((n=Ji[yr]).charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),e=yr,t="",n!=="."){if(t=Ji[yr++],n=Ji[yr],t==="0"){if(n==="x"||n==="X")return++yr,function(r){for(var a="";yr<cf&&kvt(Ji[yr]);)a+=Ji[yr++];return a.length===0&&Os({},md,hf),MW(Ji.charCodeAt(yr))&&Os({},md,hf),{type:6,value:parseInt("0x"+a,16),start:r,end:yr}}(e);if(IW(n))return function(r){for(var a="0"+Ji[yr++];yr<cf&&IW(Ji[yr]);)a+=Ji[yr++];return(MW(Ji.charCodeAt(yr))||P3(Ji.charCodeAt(yr)))&&Os({},md,hf),{type:6,value:parseInt(a,8),octal:!0,start:r,end:yr}}(e);n&&P3(n.charCodeAt(0))&&Os({},md,hf)}for(;P3(Ji.charCodeAt(yr));)t+=Ji[yr++];n=Ji[yr]}if(n==="."){for(t+=Ji[yr++];P3(Ji.charCodeAt(yr));)t+=Ji[yr++];n=Ji[yr]}if(n==="e"||n==="E")if(t+=Ji[yr++],(n=Ji[yr])!=="+"&&n!=="-"||(t+=Ji[yr++]),P3(Ji.charCodeAt(yr)))for(;P3(Ji.charCodeAt(yr));)t+=Ji[yr++];else Os({},md,hf);return MW(Ji.charCodeAt(yr))&&Os({},md,hf),{type:6,value:parseFloat(t),start:e,end:yr}}function QZt(){var t,e,n,r;return Xs=null,zIt(),t=yr,e=function(){var a,s,h,d;for(rot((a=Ji[yr])==="/","Regular expression literal must start with a slash"),s=Ji[yr++],h=!1,d=!1;yr<cf;)if(s+=a=Ji[yr++],a==="\\")NW((a=Ji[yr++]).charCodeAt(0))&&Os({},xvt),s+=a;else if(NW(a.charCodeAt(0)))Os({},xvt);else if(h)a==="]"&&(h=!1);else{if(a==="/"){d=!0;break}a==="["&&(h=!0)}return d||Os({},xvt),{value:s.substr(1,s.length-2),literal:s}}(),n=function(){var a,s,h;for(s="",h="";yr<cf&&iot((a=Ji[yr]).charCodeAt(0));)++yr,a==="\\"&&yr<cf?Os({},md,hf):(h+=a,s+=a);return h.search(/[^gimuy]/g)>=0&&Os({},LIt,h),{value:h,literal:s}}(),r=function(a,s){var h=a;s.indexOf("u")>=0&&(h=h.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(d,g){if(parseInt(g,16)<=1114111)return"x";Os({},LIt)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{return new RegExp(a,s)}catch{return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:yr}}function jIt(){var t;return zIt(),yr>=cf?{type:2,start:yr,end:yr}:MW(t=Ji.charCodeAt(yr))?ZZt():t===40||t===41||t===59?_vt():t===39||t===34?function(){var e,n,r,a,s="",h=!1;for(rot((e=Ji[yr])==="'"||e==='"',"String literal must starts with a quote"),n=yr,++yr;yr<cf;){if((r=Ji[yr++])===e){e="";break}if(r==="\\")if((r=Ji[yr++])&&NW(r.charCodeAt(0)))r==="\r"&&Ji[yr]===`
`&&++yr;else switch(r){case"u":case"x":Ji[yr]==="{"?(++yr,s+=KZt()):s+=Svt(r);break;case"n":s+=`
`;break;case"r":s+="\r";break;case"t":s+="	";break;case"b":s+="\b";break;case"f":s+="\f";break;case"v":s+="\v";break;default:IW(r)?((a="01234567".indexOf(r))!==0&&(h=!0),yr<cf&&IW(Ji[yr])&&(h=!0,a=8*a+"01234567".indexOf(Ji[yr++]),"0123".indexOf(r)>=0&&yr<cf&&IW(Ji[yr])&&(a=8*a+"01234567".indexOf(Ji[yr++]))),s+=String.fromCharCode(a)):s+=r}else{if(NW(r.charCodeAt(0)))break;s+=r}}return e!==""&&Os({},md,hf),{type:8,value:s,octal:h,start:n,end:yr}}():t===46?P3(Ji.charCodeAt(yr+1))?BIt():_vt():P3(t)?BIt():_vt()}function Kp(){var t;return yr=(t=Xs).end,Xs=jIt(),yr=t.end,t}function UIt(){var t;t=yr,Xs=jIt(),yr=t}function WIt(t,e,n){var r=new j1(t==="||"||t==="&&"?"LogicalExpression":"BinaryExpression");return r.operator=t,r.left=e,r.right=n,r}function JZt(t,e){var n=new j1("CallExpression");return n.callee=t,n.arguments=e,n}function Cvt(t){var e=new j1(OIt);return e.name=t,e}function DW(t){var e=new j1("Literal");return e.value=t.value,e.raw=Ji.slice(t.start,t.end),t.regex&&(e.raw==="//"&&(e.raw="/(?:)/"),e.regex=t.regex),e}function VIt(t,e,n){var r=new j1("MemberExpression");return r.computed=t==="[",r.object=e,r.property=n,r.computed||(n.member=!0),r}function GIt(t,e,n){var r=new j1("Property");return r.key=e,r.value=n,r.kind=t,r}function Os(t,e){var n,r=Array.prototype.slice.call(arguments,2),a=e.replace(/%(\d)/g,function(s,h){return rot(h<r.length,"Message reference must be in range"),r[h]});throw(n=new Error(a)).index=yr,n.description=a,n}function aot(t){t.type===2&&Os(t,"Unexpected end of input"),t.type===6&&Os(t,"Unexpected number"),t.type===8&&Os(t,"Unexpected string"),t.type===3&&Os(t,"Unexpected identifier"),t.type===4&&Os(t,"Unexpected reserved word"),Os(t,md,t.value)}function df(t){var e=Kp();e.type===7&&e.value===t||aot(e)}function Yu(t){return Xs.type===7&&Xs.value===t}function Evt(t){return Xs.type===4&&Xs.value===t}function tQt(){var t=[];for(yr=Xs.start,df("[");!Yu("]");)Yu(",")?(Kp(),t.push(null)):(t.push(x9()),Yu("]")||df(","));return Kp(),function(e){var n=new j1("ArrayExpression");return n.elements=e,n}(t)}function HIt(){var t;return yr=Xs.start,(t=Kp()).type===8||t.type===6?(t.octal&&Os(t,$It),DW(t)):Cvt(t.value)}function eQt(){var t,e,n;return yr=Xs.start,(t=Xs).type===3?(n=HIt(),df(":"),GIt("init",n,x9())):t.type!==2&&t.type!==7?(e=HIt(),df(":"),GIt("init",e,x9())):void aot(t)}function nQt(){var t,e,n=[],r={},a=String;for(yr=Xs.start,df("{");!Yu("}");)e="$"+((t=eQt()).key.type===OIt?t.key.name:a(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?Os({},"Duplicate data property in object literal not allowed in strict mode"):r[e]=!0,n.push(t),Yu("}")||df(",");return df("}"),function(s){var h=new j1("ObjectExpression");return h.properties=s,h}(n)}var rQt={if:1};function iQt(){var t,e,n;if(Yu("("))return function(){var r;return df("("),r=Tvt(),df(")"),r}();if(Yu("["))return tQt();if(Yu("{"))return nQt();if(t=Xs.type,yr=Xs.start,t===3||rQt[Xs.value])n=Cvt(Kp().value);else if(t===8||t===6)Xs.octal&&Os(Xs,$It),n=DW(Kp());else{if(t===4)throw new Error(AW);t===1?((e=Kp()).value=e.value==="true",n=DW(e)):t===5?((e=Kp()).value=null,n=DW(e)):Yu("/")||Yu("/=")?(n=DW(QZt()),UIt()):aot(Kp())}return n}function aQt(){var t=[];if(df("("),!Yu(")"))for(;yr<cf&&(t.push(x9()),!Yu(")"));)df(",");return df(")"),t}function oQt(){return df("."),yr=Xs.start,function(e){return e.type===3||e.type===4||e.type===1||e.type===5}(t=Kp())||aot(t),Cvt(t.value);var t}function sQt(){var t;return df("["),t=Tvt(),df("]"),t}function YIt(){var t=function(){var e;for(e=iQt();;)if(Yu("."))e=VIt(".",e,oQt());else if(Yu("("))e=JZt(e,aQt());else{if(!Yu("["))break;e=VIt("[",e,sQt())}return e}();if(Xs.type===7&&(Yu("++")||Yu("--")))throw new Error(AW);return t}function oot(){var t,e;if(Xs.type!==7&&Xs.type!==4)e=YIt();else{if(Yu("++")||Yu("--"))throw new Error(AW);if(Yu("+")||Yu("-")||Yu("~")||Yu("!"))t=Kp(),e=oot(),e=function(n,r){var a=new j1("UnaryExpression");return a.operator=n,a.argument=r,a.prefix=!0,a}(t.value,e);else{if(Evt("delete")||Evt("void")||Evt("typeof"))throw new Error(AW);e=YIt()}}return e}function qIt(t){var e=0;if(t.type!==7&&t.type!==4)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function x9(){var t,e;return t=function(){var n,r,a,s,h,d,g,b,_,E;if(n=Xs,_=oot(),(h=qIt(s=Xs))===0)return _;for(s.prec=h,Kp(),r=[n,Xs],d=[_,s,g=oot()];(h=qIt(Xs))>0;){for(;d.length>2&&h<=d[d.length-2].prec;)g=d.pop(),b=d.pop().value,_=d.pop(),r.pop(),a=WIt(b,_,g),d.push(a);(s=Kp()).prec=h,d.push(s),r.push(Xs),a=oot(),d.push(a)}for(a=d[E=d.length-1],r.pop();E>1;)r.pop(),a=WIt(d[E-1].value,d[E-2],a),E-=2;return a}(),Yu("?")&&(Kp(),e=x9(),df(":"),t=function(n,r,a){var s=new j1("ConditionalExpression");return s.test=n,s.consequent=r,s.alternate=a,s}(t,e,x9())),t}function Tvt(){var t=x9();if(Yu(","))throw new Error(AW);return t}function SM(t,e,n){return t.fields=e||[],t.fname=n,t}function uQt(t){return t.length===1?lQt(t[0]):cQt(t)}let lQt=t=>function(e){return e[t]},cQt=t=>{let e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Avt(t){throw Error(t)}function hQt(t){let e=[],n=t.length,r,a,s,h=null,d=0,g="";function b(){e.push(g+t.substring(r,a)),g="",r=a+1}for(t+="",r=a=0;a<n;++a)if(s=t[a],s==="\\")g+=t.substring(r,a++),r=a;else if(s===h)b(),h=null,d=-1;else{if(h)continue;r===d&&s==='"'||r===d&&s==="'"?(r=a+1,h=s):s!=="."||d?s==="["?(a>r&&b(),d=r=a+1):s==="]"&&(d||Avt("Access path missing open bracket: "+t),d>0&&b(),d=0,r=a+1):a>r?b():r=a+1}return d&&Avt("Access path missing closing bracket: "+t),h&&Avt("Access path missing closing quote: "+t),a>r&&(a++,b()),e}function dQt(t,e,n){let r=hQt(t);return t=r.length===1?r[0]:t,SM(uQt(r),[t],t)}dQt("id"),SM(t=>t,[],"identity"),SM(()=>0,[],"zero"),SM(()=>1,[],"one"),SM(()=>!0,[],"true"),SM(()=>!1,[],"false");function Ivt(t){let e=[];return t.type==="Identifier"?[t.name]:t.type==="Literal"?[t.value]:(t.type==="MemberExpression"&&(e.push(...Ivt(t.object)),e.push(...Ivt(t.property))),e)}function XIt(t){return t.object.type==="MemberExpression"?XIt(t.object):t.object.name==="datum"}function KIt(t){let e=function(r){yr=0,cf=(Ji=r).length,Xs=null,UIt();var a=Tvt();if(Xs.type!==2)throw new Error("Unexpect token after expression.");return a}(t),n=new Set;return e.visit(r=>{r.type==="MemberExpression"&&XIt(r)&&n.add(Ivt(r).slice(1).join("."))}),n}class _M extends au{constructor(e,n,r){super(e),this.model=n,this.filter=r,this.expr=sot(this.model,this.filter,this),this._dependentFields=KIt(this.expr)}clone(){return new _M(null,this.model,wo(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function ZIt(t,e,n,r="datum"){let a=[],s=lW(e,function(h){let d=ul(h),g=t.getSelectionComponent(d,h),b=Vo(d+b9);if(g.project.timeUnit){let _=n??t.component.data.raw,E=g.project.timeUnit.clone();_.parent?E.insertAsParentOf(_):_.parent=E}return g.empty!=="none"&&a.push(b),`vlSelectionTest(${b}, ${r}`+(g.resolve==="global"?")":`, ${Vo(g.resolve)})`)});return(a.length?"!("+a.map(h=>`length(data(${h}))`).join(" || ")+") || ":"")+`(${s})`}function QIt(t,e){let n=e.encoding,r=e.field;if(n||r){if(n&&!r){let a=t.project.items.filter(s=>s.channel===n);!a.length||a.length>1?(r=t.project.items[0].field,$r((a.length?"Multiple ":"No ")+`matching ${Vo(n)} encoding found for selection ${Vo(e.selection)}. Using "field": ${Vo(r)}.`)):r=a[0].field}}else r=t.project.items[0].field,t.project.items.length>1&&$r(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${Vo(r)}.`);return`${t.name}[${Vo(r)}]`}function sot(t,e,n){return lW(e,r=>bo(r)?r:function(a){return a?.selection}(r)?ZIt(t,r.selection,n):BTt(r))}function Nvt(t,e,n,r){var a,s,h;t.encode=(a=t.encode)!==null&&a!==void 0?a:{},t.encode[e]=(s=t.encode[e])!==null&&s!==void 0?s:{},t.encode[e].update=(h=t.encode[e].update)!==null&&h!==void 0?h:{},t.encode[e].update[n]=r}function RW(t,e,n,r={header:!1}){var a,s;let h=t.combine(),{disable:d,orient:g,scale:b,labelExpr:_,title:E,zindex:I}=h,R=fa(h,["disable","orient","scale","labelExpr","title","zindex"]);if(!d){for(let z in R){let P=wXt[z],rt=R[z];if(P&&P!==e&&P!=="both")delete R[z];else if(lyt(rt)){let{condition:ot}=rt,at=fa(rt,["condition"]),dt=ec(ot),ct=GEt[z];if(ct){let{vgProp:Ct,part:Et}=ct,Rt=[...dt.map(Ot=>{let{test:Wt}=Ot,jt=fa(Ot,["test"]);return Object.assign({test:sot(null,Wt)},jt)}),at];Nvt(R,Et,Ct,Rt),delete R[z]}else if(ct===null){let Ct={signal:dt.map(Et=>{let{test:Rt}=Et,Ot=fa(Et,["test"]);return`${sot(null,Rt)} ? ${kAt(Ot)} : `}).join("")+kAt(at)};R[z]=Ct}}else if(Ua(rt)){let ot=GEt[z];if(ot){let{vgProp:at,part:dt}=ot;Nvt(R,dt,at,rt),delete R[z]}}}if(e==="grid"){if(!R.grid)return;if(R.encode){let{grid:z}=R.encode;R.encode=Object.assign({},z?{grid:z}:{}),yu(R.encode)&&delete R.encode}return Object.assign(Object.assign({scale:b,orient:g},R),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Tc(I,0)})}{if(!r.header&&t.mainExtracted)return;if(_!==void 0){let P=_;!((s=(a=R.encode)===null||a===void 0?void 0:a.labels)===null||s===void 0)&&s.update&&Ua(R.encode.labels.update.text)&&(P=mM(_,"datum.label",R.encode.labels.update.text.signal)),Nvt(R,"labels","text",{signal:P})}if(R.labelAlign===null&&delete R.labelAlign,R.encode){for(let P of HEt)t.hasAxisPart(P)||delete R.encode[P];yu(R.encode)&&delete R.encode}let z=function(P,rt){if(P)return ka(P)&&!Sk(P)?P.map(ot=>vAt(ot,rt)).join(", "):P}(E,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:b,orient:g,grid:!1},z?{title:z}:{}),R),n.aria===!1?{aria:!1}:{}),{zindex:Tc(I,0)})}}}function JIt(t){let{axes:e}=t.component,n=[];for(let r of og)if(e[r]){for(let a of e[r])if(!a.get("disable")&&!a.get("gridScale")){let s=r==="x"?"height":"width",h=t.getSizeSignalRef(s).signal;s!==h&&n.push({name:s,update:h})}}return n}let t7t={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},e7t={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},fQt=jr(t7t),pQt=jr(e7t);function n7t(t,e,n,r){return Object.assign.apply(null,[{},...t.map(a=>{if(a==="axisOrient"){let s=n==="x"?"bottom":"left",h=e[n==="x"?"axisBottom":"axisLeft"]||{},d=e[n==="x"?"axisTop":"axisRight"]||{},g=new Set([...jr(h),...jr(d)]),b={};for(let _ of g.values())b[_]={signal:`${r.signal} === "${s}" ? ${xW(h[_])} : ${xW(d[_])}`};return b}return e[a]})])}function mQt(t,e,n,r){let a=e==="band"?["axisDiscrete","axisBand"]:e==="point"?["axisDiscrete","axisPoint"]:function(b){return b in gKt}(e)?["axisQuantitative"]:e==="time"||e==="utc"?["axisTemporal"]:[],s=t==="x"?"axisX":"axisY",h=Ua(n)?"axisOrient":"axis"+dat(n),d=[...a,...a.map(b=>s+b.substr(4))],g=["axis",h,s];return{vlOnlyAxisConfig:n7t(d,r,t,n),vgAxisConfig:n7t(g,r,t,n),axisConfigStyle:gQt([...g,...d],r)}}function gQt(t,e){var n;let r=[{}];for(let a of t){let s=(n=e[a])===null||n===void 0?void 0:n.style;if(s){s=ec(s);for(let h of s)r.push(e.style[h])}}return Object.assign.apply(null,r)}function Mvt(t,e,n,r={}){var a;let s=_At(t,n,e.style);if(s!==void 0)return{configFrom:"style",configValue:s};for(let h of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((a=r[h])===null||a===void 0?void 0:a[t])!==void 0)return{configFrom:h,configValue:r[h][t]};return{}}let r7t={scale:({model:t,channel:e})=>t.scaleName(e),format:({fieldOrDatumDef:t,config:e,axis:n})=>{let{format:r,formatType:a}=n;return eAt(t,t.type,r,a,e,!0)},formatType:({axis:t,fieldOrDatumDef:e,scaleType:n})=>{let{formatType:r}=t;return nAt(r,e,n)},grid:({fieldOrDatumDef:t,axis:e,scaleType:n})=>{var r;return(!gi(t)||!Uf(t.bin))&&((r=e.grid)!==null&&r!==void 0?r:function(a,s){return!Xp(a)&&gi(s)&&!Eu(s?.bin)}(n,t))},gridScale:({model:t,channel:e})=>function(n,r){let a=r==="x"?"y":"x";if(n.getScaleComponent(a))return n.scaleName(a)}(t,e),labelAlign:({axis:t,labelAngle:e,orient:n,channel:r})=>t.labelAlign||a7t(e,n,r),labelAngle:({labelAngle:t})=>t,labelBaseline:({axis:t,labelAngle:e,orient:n,channel:r})=>t.labelBaseline||i7t(e,n,r),labelFlush:({axis:t,fieldOrDatumDef:e,channel:n})=>{var r;return(r=t.labelFlush)!==null&&r!==void 0?r:function(a,s){if(s==="x"&&Aa(["quantitative","temporal"],a))return!0}(e.type,n)},labelOverlap:({axis:t,fieldOrDatumDef:e,scaleType:n})=>{var r;return(r=t.labelOverlap)!==null&&r!==void 0?r:function(a,s){if(a!=="nominal")return s!=="log"||"greedy"}(e.type,n)},orient:({orient:t})=>t,tickCount:({channel:t,model:e,axis:n,fieldOrDatumDef:r,scaleType:a})=>{var s;let h=t==="x"?"width":t==="y"?"height":void 0,d=h?e.getSizeSignalRef(h):void 0;return(s=n.tickCount)!==null&&s!==void 0?s:function({fieldOrDatumDef:g,scaleType:b,size:_,values:E}){var I;if(!E&&!Xp(b)&&b!=="log"){if(gi(g)){if(Eu(g.bin))return{signal:`ceil(${_.signal}/10)`};if(g.timeUnit&&Aa(["month","hours","day","quarter"],(I=Wf(g.timeUnit))===null||I===void 0?void 0:I.unit))return}return{signal:`ceil(${_.signal}/40)`}}}({fieldOrDatumDef:r,scaleType:a,size:d,values:n.values})},title:({axis:t,model:e,channel:n})=>{if(t.title!==void 0)return t.title;let r=o7t(e,n);if(r!==void 0)return r;let a=e.typedFieldDef(n),s=n==="x"?"x2":"y2",h=e.fieldDef(s);return EAt(a?[lAt(a)]:[],gi(h)?[lAt(h)]:[])},values:({axis:t,fieldOrDatumDef:e})=>function(n,r){let a=n.values;if(ka(a))return wAt(r,a);if(Ua(a))return a}(t,e),zindex:({axis:t,fieldOrDatumDef:e,mark:n})=>{var r;return(r=t.zindex)!==null&&r!==void 0?r:function(a,s){return a==="rect"&&fAt(s)?1:0}(n,e)}};function Dvt(t){return`(((${t.signal} % 360) + 360) % 360)`}function i7t(t,e,n,r){if(t!==void 0){if(n==="x"){if(Ua(t)){let a=Dvt(t);return{signal:`(45 < ${a} && ${a} < 135) || (225 < ${a} && ${a} < 315) ? "middle" :(${a} <= 45 || 315 <= ${a}) === ${Ua(e)?`(${e.signal} === "top")`:e==="top"} ? "bottom" : "top"`}}if(45<t&&t<135||225<t&&t<315)return"middle";if(Ua(e)){let a=t<=45||315<=t?"===":"!==";return{signal:`${e.signal} ${a} "top" ? "bottom" : "top"`}}return(t<=45||315<=t)==(e==="top")?"bottom":"top"}if(Ua(t)){let a=Dvt(t);return{signal:`${a} <= 45 || 315 <= ${a} || (135 <= ${a} && ${a} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${a} && ${a} <= 135) === ${Ua(e)?`(${e.signal} === "left")`:e==="left"} ? "top" : "bottom"`}}if(t<=45||315<=t||135<=t&&t<=225)return r?"middle":null;if(Ua(e)){let a=45<=t&&t<=135?"===":"!==";return{signal:`${e.signal} ${a} "left" ? "top" : "bottom"`}}return(45<=t&&t<=135)==(e==="left")?"top":"bottom"}}function a7t(t,e,n){if(t===void 0)return;let r=n==="x",a=r?0:90,s=r?"bottom":"left";if(Ua(t)){let h=Dvt(t);return{signal:`(${a?"("+h+" + 90)":h} % 180 === 0) ? ${r?null:'"center"'} :(${a} < ${h} && ${h} < ${180+a}) === ${Ua(e)?`(${e.signal} === "${s}")`:e===s} ? "left" : "right"`}}if((t+a)%180==0)return r?null:"center";if(Ua(e)){let h=a<t&&t<180+a?"===":"!==";return{signal:`${`${e.signal} ${h} "${s}"`} ? "left" : "right"`}}return(a<t&&t<180+a)==(e===s)?"left":"right"}function o7t(t,e){let n=e==="x"?"x2":"y2",r=t.fieldDef(e),a=t.fieldDef(n),s=r?r.title:void 0,h=a?a.title:void 0;return s&&h?TAt(s,h):s||h||(s!==void 0?s:h!==void 0?h:void 0)}class CM extends au{constructor(e,n){super(e),this.transform=n,this._dependentFields=KIt(this.transform.calculate)}clone(){return new CM(null,wo(this.transform))}static parseAllForSortIndex(e,n){return n.forEachFieldDef((r,a)=>{if(Wyt(r)&&uAt(r.sort)){let{field:s,timeUnit:h}=r,d=r.sort,g=d.map((b,_)=>`${BTt({field:s,timeUnit:h,equal:b})} ? ${_} : `).join("")+d.length;e=new CM(e,{calculate:g,as:EM(r,a,{forAs:!0})})}}),e}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${ss(this.transform)}`}}function EM(t,e,n){return ii(t,Object.assign({prefix:e,suffix:"sort_index"},n??{}))}function uot(t,e){return Aa(["top","bottom"],e)?"column":Aa(["left","right"],e)||t==="row"?"row":"column"}function TM(t,e,n,r){let a=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return Tc((e?.header||{})[t],a[t],n.header[t])}function lot(t,e,n,r){let a={};for(let s of t){let h=TM(s,e,n,r);h!==void 0&&(a[s]=h)}return a}let Rvt=["row","column"],Fvt=["header","footer"];function yQt(t,e){let n=t.component.layoutHeaders[e].title,r=t.config?t.config:void 0,a=t.component.layoutHeaders[e].facetFieldDef?t.component.layoutHeaders[e].facetFieldDef:void 0,{titleAnchor:s,titleAngle:h,titleOrient:d}=lot(["titleAnchor","titleAngle","titleOrient"],a,r,e),g=uot(e,d),b=fat(h);return{name:`${e}-title`,type:"group",role:`${g}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},e==="row"?{orient:"left"}:{}),{style:"guide-title"}),u7t(b,g)),s7t(g,b,s)),l7t(r,a,e,fQt,t7t))}}function s7t(t,e,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}let r=a7t(e,t==="row"?"left":"top",t==="row"?"y":"x");return r?{align:r}:{}}function u7t(t,e){let n=i7t(t,e==="row"?"left":"top",e==="row"?"y":"x",!0);return n?{baseline:n}:{}}function vQt(t,e){let n=t.component.layoutHeaders[e],r=[];for(let a of Fvt)if(n[a])for(let s of n[a]){let h=wQt(t,e,a,n,s);h!=null&&r.push(h)}return r}function bQt(t,e){var n;let{sort:r}=t;return Py(r)?{field:ii(r,{expr:"datum"}),order:(n=r.order)!==null&&n!==void 0?n:"ascending"}:ka(r)?{field:EM(t,e,{expr:"datum"}),order:"ascending"}:{field:ii(t,{expr:"datum"}),order:r??"ascending"}}function Ovt(t,e,n){let{format:r,formatType:a,labelAngle:s,labelAnchor:h,labelOrient:d,labelExpr:g}=lot(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],t,n,e),b=Lyt({fieldOrDatumDef:t,format:r,formatType:a,expr:"parent",config:n}).signal,_=uot(e,d);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:g?mM(mM(g,"datum.label",b),"datum.value",ii(t,{expr:"parent"})):b}},e==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),u7t(s,_)),s7t(_,s,h)),l7t(n,t,e,pQt,e7t))}function wQt(t,e,n,r,a){if(a){let s=null,{facetFieldDef:h}=r,d=t.config?t.config:void 0;if(h&&a.labels){let{labelOrient:E}=lot(["labelOrient"],h,d,e);(e==="row"&&!Aa(["top","bottom"],E)||e==="column"&&!Aa(["left","right"],E))&&(s=Ovt(h,e,d))}let g=V1(t)&&!vW(t.facet),b=a.axes,_=b?.length>0;if(s||_){let E=e==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:t.getName(`${e}_${n}`),type:"group",role:`${e}-${n}`},r.facetFieldDef?{from:{data:t.getName(e+"_domain")},sort:bQt(h,e)}:{}),_&&g?{from:{data:t.getName(`facet_domain_${e}`)}}:{}),s?{title:s}:{}),a.sizeSignal?{encode:{update:{[E]:a.sizeSignal}}}:{}),_?{axes:b}:{})}}return null}let xQt={column:{start:0,end:1},row:{start:1,end:0}};function kQt(t,e){return xQt[e][t]}function l7t(t,e,n,r,a){let s={};for(let h of r){if(!a[h])continue;let d=TM(h,e,t,n);d!==void 0&&(s[a[h]]=d)}return s}function Lvt(t){return[...cot(t,"width"),...cot(t,"height"),...cot(t,"childWidth"),...cot(t,"childHeight")]}function cot(t,e){let n=e==="width"?"x":"y",r=t.component.layoutSize.get(e);if(!r||r==="merged")return[];let a=t.getSizeSignalRef(e).signal;if(r==="step"){let s=t.getScaleComponent(n);if(s){let h=s.get("type"),d=s.get("range");if(Xp(h)&&bk(d)){let g=t.scaleName(n);return V1(t.parent)&&t.parent.component.resolve.scale[n]==="independent"?[c7t(g,d)]:[c7t(g,d),{name:a,update:h7t(g,s,`domain('${g}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if(r=="container"){let s=a.endsWith("width"),h=s?"containerSize()[0]":"containerSize()[1]",d=`isFinite(${h}) ? ${h} : ${ovt(t.config.view,s?"width":"height")}`;return[{name:a,init:d,on:[{update:d,events:"window:resize"}]}]}return[{name:a,value:r}]}function c7t(t,e){return{name:t+"_step",value:e.step}}function h7t(t,e,n){let r=e.get("type"),a=e.get("padding"),s=Tc(e.get("paddingOuter"),a),h=e.get("paddingInner");return h=r==="band"?h!==void 0?h:a:1,`bandspace(${n}, ${h}, ${s}) * ${t}_step`}function d7t(t){return t==="childWidth"?"width":t==="childHeight"?"height":t}function f7t(t,e){return jr(t).reduce((n,r)=>{let a=t[r];return Object.assign(Object.assign({},n),_W(e,a,r,s=>Ua(s)?s:{value:s.value}))},{})}function SQt(t,e){if(MM(e)||V1(e))return"shared";if(Xvt(e))return $y(t)?"independent":"shared";throw new Error("invalid model type for resolve")}function $vt(t,e){let n=t.scale[e],r=$y(e)?"axis":"legend";return n==="independent"?(t[r][e]==="shared"&&$r(function(a){return`Setting the scale to be independent for "${a}" means we also have to set the guide (axis or legend) to be independent.`}(e)),"independent"):t[r][e]||"shared"}let _Qt=Object.assign(Object.assign({},FKt),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),p7t=jr(_Qt);class CQt extends L3{}let m7t={symbols:function(t,{fieldOrDatumDef:e,model:n,channel:r,legendCmpt:a,legendType:s}){var h,d,g,b,_;if(s!=="symbol")return;let{markDef:E,encoding:I,config:R,mark:z}=n,P=E.filled&&z!=="trail",rt=Object.assign(Object.assign({},function(at,dt,ct){for(let Ct of ct){let Et=m9(Ct,dt.markDef,dt.config);Et!==void 0&&(at[Ct]=nc(Et))}return at}({},n,CXt)),mIt(n,{filled:P})),ot=(h=g7t(I.opacity))!==null&&h!==void 0?h:E.opacity;if(rt.fill){if(r==="fill"||P&&r===Yp)delete rt.fill;else if(rt.fill.field)a.get("symbolFillColor")?delete rt.fill:(rt.fill=nc((d=R.legend.symbolBaseFillColor)!==null&&d!==void 0?d:"black"),rt.fillOpacity=nc(ot??1));else if(ka(rt.fill)){let at=(_=(b=zvt((g=I.fill)!==null&&g!==void 0?g:I.color))!==null&&b!==void 0?b:E.fill)!==null&&_!==void 0?_:P&&E.color;at&&(rt.fill=nc(at))}}if(rt.stroke){if(r==="stroke"||!P&&r===Yp)delete rt.stroke;else if(rt.stroke.field)delete rt.stroke;else if(ka(rt.stroke)){let at=Tc(zvt(I.stroke||I.color),E.stroke,P?E.color:void 0);at&&(rt.stroke={value:at})}}if(r!==R3){let at=gi(e)&&v7t(n,a,e);at?rt.opacity=[Object.assign({test:at},nc(ot??1)),nc(R.legend.unselectedOpacity)]:ot&&(rt.opacity=nc(ot))}return rt=Object.assign(Object.assign({},rt),t),yu(rt)?void 0:rt},gradient:function(t,{model:e,legendType:n}){if(n!=="gradient")return;let r={},a=g7t(e.encoding.opacity)||e.markDef.opacity;return a&&(r.opacity=nc(a)),r=Object.assign(Object.assign({},r),t),yu(r)?void 0:r},labels:function(t,{fieldOrDatumDef:e,model:n,channel:r,legendCmpt:a}){let s=n.legend(r)||{},h=n.config,d=gi(e)?v7t(n,a,e):void 0,g=d?[{test:d,value:1},{value:h.legend.unselectedOpacity}]:void 0,{format:b,formatType:_}=s,E=d9(_)?$yt({fieldOrDatumDef:e,field:"datum.value",format:b,formatType:_,config:h}):void 0,I=Object.assign(Object.assign(Object.assign({},g?{opacity:g}:{}),E?{text:E}:{}),t);return yu(I)?void 0:I},entries:function(t,{legendCmpt:e}){let n=e.get("selections");return n?.length?Object.assign(Object.assign({},t),{fill:{value:"transparent"}}):t}};function g7t(t){return y7t(t,(e,n)=>Math.max(e,n.value))}function zvt(t){return y7t(t,(e,n)=>Tc(e,n.value))}function y7t(t,e){return function(n){let r=n&&n.condition;return!!r&&(ka(r)||F3(r))}(t)?ec(t.condition).reduce(e,t.value):F3(t)?t.value:void 0}function v7t(t,e,n){let r=e.get("selections");if(!r?.length)return;let a=Vo(n.field);return r.map(s=>`(!length(data(${Vo(ul(s)+b9)})) || (${s}[${a}] && indexof(${s}[${a}], datum.value) >= 0))`).join(" || ")}let b7t={direction:({direction:t})=>t,format:({fieldOrDatumDef:t,legend:e,config:n})=>{let{format:r,formatType:a}=e;return eAt(t,t.type,r,a,n,!1)},formatType:({legend:t,fieldOrDatumDef:e,scaleType:n})=>{let{formatType:r}=t;return nAt(r,e,n)},gradientLength:t=>{var e,n;let{legend:r,legendConfig:a}=t;return(n=(e=r.gradientLength)!==null&&e!==void 0?e:a.gradientLength)!==null&&n!==void 0?n:function({legendConfig:s,model:h,direction:d,orient:g,scaleType:b}){let{gradientHorizontalMaxLength:_,gradientHorizontalMinLength:E,gradientVerticalMaxLength:I,gradientVerticalMinLength:R}=s;if(P1(b))return d==="horizontal"?g==="top"||g==="bottom"?w7t(h,"width",E,_):E:w7t(h,"height",R,I)}(t)},labelOverlap:({legend:t,legendConfig:e,scaleType:n})=>{var r,a;return(a=(r=t.labelOverlap)!==null&&r!==void 0?r:e.labelOverlap)!==null&&a!==void 0?a:function(s){if(Aa(["quantile","threshold","log"],s))return"greedy"}(n)},symbolType:({legend:t,markDef:e,channel:n,encoding:r})=>{var a;return(a=t.symbolType)!==null&&a!==void 0?a:function(s,h,d,g){var b;if(h!=="shape"){let _=(b=zvt(d))!==null&&b!==void 0?b:g;if(_)return _}switch(s){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(e.type,n,r.shape,e.shape)},title:({fieldOrDatumDef:t,config:e})=>f9(t,e,{allowDisabling:!0}),type:({legendType:t,scaleType:e,channel:n})=>{if(gM(n)&&P1(e)){if(t==="gradient")return}else if(t==="symbol")return;return t},values:({fieldOrDatumDef:t,legend:e})=>function(n,r){let a=n.values;if(ka(a))return wAt(r,a);if(Ua(a))return a}(e,t)};function EQt(t){let{legend:e}=t;return Tc(e.type,function({channel:n,timeUnit:r,scaleType:a}){if(gM(n)){if(Aa(["quarter","month","day"],r))return"symbol";if(P1(a))return"gradient"}return"symbol"}(t))}function TQt({legendConfig:t,legendType:e,orient:n,legend:r}){var a,s;return(s=(a=r.direction)!==null&&a!==void 0?a:t[e?"gradientDirection":"symbolDirection"])!==null&&s!==void 0?s:function(h,d){switch(h){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return d==="gradient"?"horizontal":void 0}}(n,e)}function w7t(t,e,n,r){return{signal:`clamp(${t.getSizeSignalRef(e).signal}, ${n}, ${r})`}}function x7t(t){let e=Bl(t)?function(n){let{encoding:r}=n,a={};for(let s of[Yp,...WAt]){let h=sh(r[s]);h&&n.getScaleComponent(s)&&(s===qp&&gi(h)&&h.type===wM||(a[s]=IQt(n,s)))}return a}(t):function(n){let{legends:r,resolve:a}=n.component;for(let s of n.children){x7t(s);for(let h of jr(s.component.legends))a.legend[h]=$vt(n.component.resolve,h),a.legend[h]==="shared"&&(r[h]=k7t(r[h],s.component.legends[h]),r[h]||(a.legend[h]="independent",delete r[h]))}for(let s of jr(r))for(let h of n.children)h.component.legends[s]&&a.legend[s]==="shared"&&delete h.component.legends[s];return r}(t);return t.component.legends=e,e}function AQt(t,e,n,r){switch(e){case"disable":return n!==void 0;case"values":return!!n?.values;case"title":if(e==="title"&&t===r?.title)return!0}return t===(n||{})[e]}function IQt(t,e){var n,r,a;let s=t.legend(e),{markDef:h,encoding:d,config:g}=t,b=g.legend,_=new CQt({},function(Et,Rt){let Ot=Et.scaleName(Rt);if(Et.mark==="trail"){if(Rt==="color")return{stroke:Ot};if(Rt==="size")return{strokeWidth:Ot}}return Rt==="color"?Et.markDef.filled?{fill:Ot}:{stroke:Ot}:{[Rt]:Ot}}(t,e));(function(Et,Rt,Ot){var Wt;let jt=(Wt=Et.fieldDef(Rt))===null||Wt===void 0?void 0:Wt.field;w9(Et,Ht=>{var Vt,fe;let se=(Vt=Ht.project.hasField[jt])!==null&&Vt!==void 0?Vt:Ht.project.hasChannel[Rt];if(se&&_It.has(Ht)){let he=(fe=Ot.get("selections"))!==null&&fe!==void 0?fe:[];he.push(Ht.name),Ot.set("selections",he,!1),se.hasLegend=!0}})})(t,e,_);let E=s!==void 0?!s:b.disable;if(_.set("disable",E,s!==void 0),E)return _;s=s||{};let I=t.getScaleComponent(e).get("type"),R=sh(d[e]),z=gi(R)?(n=Wf(R.timeUnit))===null||n===void 0?void 0:n.unit:void 0,P=s.orient||g.legend.orient||"right",rt=EQt({legend:s,channel:e,timeUnit:z,scaleType:I}),ot={legend:s,channel:e,model:t,markDef:h,encoding:d,fieldOrDatumDef:R,legendConfig:b,config:g,scaleType:I,orient:P,legendType:rt,direction:TQt({legend:s,legendType:rt,orient:P,legendConfig:b})};for(let Et of p7t){let Rt=Et in b7t?b7t[Et](ot):s[Et];if(Rt!==void 0){let Ot=AQt(Rt,Et,s,t.fieldDef(e));(Ot||g.legend[Et]===void 0)&&_.set(Et,Rt,Ot)}}let at=(r=s?.encoding)!==null&&r!==void 0?r:{},dt=_.get("selections"),ct={},Ct={fieldOrDatumDef:R,model:t,channel:e,legendCmpt:_,legendType:rt};for(let Et of["labels","legend","title","symbols","gradient","entries"]){let Rt=f7t((a=at[Et])!==null&&a!==void 0?a:{},t),Ot=Et in m7t?m7t[Et](Rt,Ct):Rt;Ot===void 0||yu(Ot)||(ct[Et]=Object.assign(Object.assign(Object.assign({},dt?.length&&gi(R)?{name:`${ul(R.field)}_legend_${Et}`}:{}),dt?.length?{interactive:!!dt}:{}),{update:Ot}))}return yu(ct)||_.set("encode",ct,!!s?.encoding),_}function k7t(t,e){var n,r,a,s;if(!t)return e.clone();let h=t.getWithExplicit("orient"),d=e.getWithExplicit("orient");if(h.explicit&&d.explicit&&h.value!==d.value)return;let g=!1;for(let b of p7t){let _=_k(t.getWithExplicit(b),e.getWithExplicit(b),b,"legend",(E,I)=>{switch(b){case"symbolType":return NQt(E,I);case"title":return AAt(E,I);case"type":return g=!0,B1("symbol")}return qat(E,I,b,"legend")});t.setWithExplicit(b,_)}return g&&(!((r=(n=t.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0)&&r.gradient&&syt(t.implicit,["encode","gradient"]),!((s=(a=t.explicit)===null||a===void 0?void 0:a.encode)===null||s===void 0)&&s.gradient&&syt(t.explicit,["encode","gradient"])),t}function NQt(t,e){return e.value==="circle"?e:t}function S7t(t,e,n,r){var a,s,h;t.encode=(a=t.encode)!==null&&a!==void 0?a:{},t.encode[e]=(s=t.encode[e])!==null&&s!==void 0?s:{},t.encode[e].update=(h=t.encode[e].update)!==null&&h!==void 0?h:{},t.encode[e].update[n]=r}function _7t(t){let e=t.component.legends,n={};for(let a of jr(e)){let s=t.getScaleComponent(a),h=sl(s.get("domains"));if(n[h])for(let d of n[h])k7t(d,e[a])||n[h].push(e[a]);else n[h]=[e[a].clone()]}return lk(n).flat().map(a=>function(s,h){var d,g,b;let _=s.combine(),{disable:E,labelExpr:I}=_,R=fa(_,["disable","labelExpr","selections"]);if(!E){if(h.aria===!1&&R.aria==null&&(R.aria=!1),!((d=R.encode)===null||d===void 0)&&d.symbols){let z=R.encode.symbols.update;!z.fill||z.fill.value==="transparent"||z.stroke||R.stroke||(z.stroke={value:"transparent"});for(let P of WAt)R[P]&&delete z[P]}if(R.title||delete R.title,I!==void 0){let z=I;!((b=(g=R.encode)===null||g===void 0?void 0:g.labels)===null||b===void 0)&&b.update&&Ua(R.encode.labels.update.text)&&(z=mM(I,"datum.label",R.encode.labels.update.text.signal)),S7t(R,"labels","text",{signal:z})}for(let z in R){let P=R[z];if(Ua(P)){let rt=RKt[z];if(rt){let{vgProp:ot,part:at}=rt;S7t(R,at,ot,P),delete R[z]}}}return R}}(a,t.config)).filter(a=>a!==void 0)}function MQt(t){return MM(t)||Xvt(t)?function(e){return e.children.reduce((n,r)=>n.concat(r.assembleProjections()),C7t(e))}(t):C7t(t)}function C7t(t){let e=t.component.projection;if(!e||e.merged)return[];let n=e.combine(),{name:r}=n;if(e.data){let a={signal:`[${e.size.map(h=>h.signal).join(", ")}]`},s=e.data.reduce((h,d)=>{let g=Ua(d)?d.signal:`data('${t.lookupDataSource(d)}')`;return Aa(h,g)||h.push(g),h},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:a,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]}},n)]}return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}let DQt=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class E7t extends L3{constructor(e,n,r,a){super(Object.assign({},n),{name:e}),this.specifiedProjection=n,this.size=r,this.data=a,this.merged=!1}get isFit(){return!!this.data}}function T7t(t){t.component.projection=Bl(t)?function(e){var n;if(e.hasProjection){let r=e.specifiedProjection,a=!(r&&(r.scale!=null||r.translate!=null)),s=a?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,h=a?function(d){let g=[],{encoding:b}=d;for(let _ of[[Dy,My],[ig,z1]])(sh(b[_[0]])||sh(b[_[1]]))&&g.push({signal:d.getName(`geojson_${g.length}`)});return d.channelHasField(qp)&&d.typedFieldDef(qp).type===wM&&g.push({signal:d.getName(`geojson_${g.length}`)}),g.length===0&&g.push(d.requestDataName(uf)),g}(e):void 0;return new E7t(e.projectionName(!0),Object.assign(Object.assign({},(n=e.config.projection)!==null&&n!==void 0?n:{}),r??{}),s,h)}}(t):function(e){if(e.children.length===0)return;let n;for(let a of e.children)T7t(a);let r=zEt(e.children,a=>{let s=a.component.projection;if(s){if(n){let h=function(d,g){let b=zEt(DQt,E=>!r9(d.explicit,E)&&!r9(g.explicit,E)||!(!r9(d.explicit,E)||!r9(g.explicit,E)||sl(d.get(E))!==sl(g.get(E))));if(sl(d.size)===sl(g.size)){if(b)return d;if(sl(d.explicit)===sl({}))return g;if(sl(g.explicit)===sl({}))return d}return null}(n,s);return h&&(n=h),!!h}return n=s,!0}return!0});if(n&&r){let a=e.projectionName(!0),s=new E7t(a,n.specifiedProjection,n.size,wo(n.data));for(let h of e.children){let d=h.component.projection;d&&(d.isFit&&s.data.push(...h.component.projection.data),h.renameProjection(d.get("name"),a),d.merged=!0)}return s}}(t)}function A7t(t,e){return`${dTt(t)}_${e}`}function Pvt(t,e,n){var r;let a=A7t((r=Bat(n,void 0))!==null&&r!==void 0?r:{},e);return t.getName(`${a}_bins`)}function I7t(t,e,n){let r,a;r=function(b){return"as"in b}(t)?bo(t.as)?[t.as,`${t.as}_end`]:[t.as[0],t.as[1]]:[ii(t,{forAs:!0}),ii(t,{binSuffix:"end",forAs:!0})];let s=Object.assign({},Bat(e,void 0)),h=A7t(s,t.field),{signal:d,extentSignal:g}=function(b,_){return{signal:b.getName(`${_}_bins`),extentSignal:b.getName(`${_}_extent`)}}(n,h);if(Aat(s.extent)){let b=s.extent,_=b.selection;a=QIt(n.getSelectionComponent(ul(_),_),b),delete s.extent}return{key:h,binComponent:Object.assign(Object.assign(Object.assign({bin:s,field:t.field,as:[r]},d?{signal:d}:{}),g?{extentSignal:g}:{}),a?{span:a}:{})}}class Gy extends au{constructor(e,n){super(e),this.bins=n}clone(){return new Gy(null,wo(this.bins))}static makeFromEncoding(e,n){let r=n.reduceFieldDef((a,s,h)=>{if(Z0(s)&&Eu(s.bin)){let{key:d,binComponent:g}=I7t(s,s.bin,n);a[d]=Object.assign(Object.assign(Object.assign({},g),a[d]),function(b,_,E,I){var R,z;if(wW(_,E)){let P=Bl(b)&&(z=(R=b.axis(E))!==null&&R!==void 0?R:b.legend(E))!==null&&z!==void 0?z:{},rt=ii(_,{expr:"datum"}),ot=ii(_,{expr:"datum",binSuffix:"end"});return{formulaAs:ii(_,{binSuffix:"range",forAs:!0}),formula:Fat(rt,ot,P.format,P.formatType,I)}}return{}}(n,s,h,n.config))}return a},{});return yu(r)?null:new Gy(e,r)}static makeFromTransform(e,n,r){let{key:a,binComponent:s}=I7t(n,n.bin,r);return new Gy(e,{[a]:s})}merge(e,n){for(let r of jr(e.bins))r in this.bins?(n(e.bins[r].signal,this.bins[r].signal),this.bins[r].as=uk([...this.bins[r].as,...e.bins[r].as],ss)):this.bins[r]=e.bins[r];for(let r of e.children)e.removeChild(r),r.parent=this;e.remove()}producedFields(){return new Set(lk(this.bins).map(e=>e.as).flat(2))}dependentFields(){return new Set(lk(this.bins).map(e=>e.field))}hash(){return`Bin ${ss(this.bins)}`}assemble(){return lk(this.bins).flatMap(e=>{let n=[],[r,...a]=e.as,s=e.bin,{extent:h}=s,d=fa(s,["extent"]),g=Object.assign(Object.assign(Object.assign({type:"bin",field:ck(e.field),as:r,signal:e.signal},Aat(h)?{extent:null}:{extent:h}),e.span?{span:{signal:`span(${e.span})`}}:{}),d);!h&&e.extentSignal&&(n.push({type:"extent",field:ck(e.field),signal:e.extentSignal}),g.extent={signal:e.extentSignal}),n.push(g);for(let b of a)for(let _=0;_<2;_++)n.push({type:"formula",expr:ii({field:r[_]},{expr:"datum"}),as:b[_]});return e.formula&&n.push({type:"formula",expr:e.formula,as:e.formulaAs}),n})}}class AM extends au{constructor(e){let n;if(super(null),v9(e=e??{name:"source"})||(n=e.format?Object.assign({},E3(e.format,["parse"])):{}),Xat(e))this._data={values:e.values};else if(SW(e)){if(this._data={url:e.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(e.url)[1];Aa(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else cIt(e)?this._data={values:[{type:"Sphere"}]}:(uIt(e)||v9(e))&&(this._data={});this._generator=v9(e),e.name&&(this._name=e.name),n&&!yu(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(e){this._name=e}set parent(e){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function Bvt(t){for(let e of t){for(let n of e.children)if(n.parent!==e)return console.error("Dataflow graph is inconsistent.",e,n),!1;if(!Bvt(e.children))return!1}return!0}class FW extends au{constructor(e,n){super(e),this.params=n}clone(){return new FW(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${ss(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class OW extends au{constructor(e,n){super(e),this.params=n}clone(){return new OW(null,this.params)}dependentFields(){return new Set}producedFields(){var e;return new Set([(e=this.params.as)!==null&&e!==void 0?e:"data"])}hash(){return`Hash ${ss(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}function hot(t){return t instanceof AM||t instanceof FW||t instanceof OW}class N7t{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class B3 extends N7t{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:e,mutatedFlag:n}){e&&this.setContinue(),n&&this.setMutated()}reset(){}optimizeNextFromLeaves(e){if(hot(e))return!1;let n=e.parent,{continueFlag:r}=this.run(e);return r&&this.optimizeNextFromLeaves(n),this.mutatedFlag}}class jvt extends N7t{}function RQt(t,e,n,r){let a=Bl(r)?r.encoding[Oy(e)]:void 0;if(Z0(n)&&Bl(r)&&Pyt(e,n,a,r.stack,r.markDef,r.config))t.add(ii(n,{})),t.add(ii(n,{suffix:"end"})),n.bin&&wW(n,e)&&t.add(ii(n,{binSuffix:"range"}));else if(function(s){return s in pyt}(e)){let s=function(h){switch(h){case My:return"y";case z1:return"y2";case Dy:return"x";case ig:return"x2"}}(e);t.add(r.getName(s))}else t.add(ii(n));return t}class U1 extends au{constructor(e,n,r){super(e),this.dimensions=n,this.measures=r}clone(){return new U1(null,new Set(this.dimensions),wo(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(e,n){let r=!1;n.forEachFieldDef(h=>{h.aggregate&&(r=!0)});let a={},s=new Set;return r?(n.forEachFieldDef((h,d)=>{var g,b,_,E;let{aggregate:I,field:R}=h;if(I)if(I==="count")a["*"]=(g=a["*"])!==null&&g!==void 0?g:{},a["*"].count=new Set([ii(h,{forAs:!0})]);else{if(hk(I)||o9(I)){let z=hk(I)?"argmin":"argmax",P=I[z];a[P]=(b=a[P])!==null&&b!==void 0?b:{},a[P][z]=new Set([ii({op:z,field:P},{forAs:!0})])}else a[R]=(_=a[R])!==null&&_!==void 0?_:{},a[R][I]=new Set([ii(h,{forAs:!0})]);vk(d)&&n.scaleDomain(d)==="unaggregated"&&(a[R]=(E=a[R])!==null&&E!==void 0?E:{},a[R].min=new Set([ii({field:R,aggregate:"min"},{forAs:!0})]),a[R].max=new Set([ii({field:R,aggregate:"max"},{forAs:!0})]))}else RQt(s,d,h,n)}),s.size+jr(a).length===0?null:new U1(e,s,a)):null}static makeFromTransform(e,n){var r,a,s;let h=new Set,d={};for(let g of n.aggregate){let{op:b,field:_,as:E}=g;b&&(b==="count"?(d["*"]=(r=d["*"])!==null&&r!==void 0?r:{},d["*"].count=new Set([E||ii(g,{forAs:!0})])):(d[_]=(a=d[_])!==null&&a!==void 0?a:{},d[_][b]=new Set([E||ii(g,{forAs:!0})])))}for(let g of(s=n.groupby)!==null&&s!==void 0?s:[])h.add(g);return h.size+jr(d).length===0?null:new U1(e,h,d)}merge(e){return function(n,r){if(n.size!==r.size)return!1;for(let a of n)if(!r.has(a))return!1;return!0}(this.dimensions,e.dimensions)?(function(n,r){var a;for(let s of jr(r)){let h=r[s];for(let d of jr(h))s in n?n[s][d]=new Set([...(a=n[s][d])!==null&&a!==void 0?a:[],...h[d]]):n[s]={[d]:h[d]}}}(this.measures,e.measures),!0):(function(...n){mW.debug(...n)}("different dimensions, cannot merge"),!1)}addDimensions(e){e.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...jr(this.measures)])}producedFields(){let e=new Set;for(let n of jr(this.measures))for(let r of jr(this.measures[n])){let a=this.measures[n][r];a.size===0?e.add(`${r}_${n}`):a.forEach(e.add,e)}return e}hash(){return`Aggregate ${ss({dimensions:this.dimensions,measures:this.measures})}`}assemble(){let e=[],n=[],r=[];for(let a of jr(this.measures))for(let s of jr(this.measures[a]))for(let h of this.measures[a][s])r.push(h),e.push(s),n.push(a==="*"?null:ck(a));return{type:"aggregate",groupby:[...this.dimensions].map(ck),ops:e,fields:n,as:r}}}class IM extends au{constructor(e,n,r,a){super(e),this.model=n,this.name=r,this.data=a;for(let s of ag){let h=n.facet[s];if(h){let{bin:d,sort:g}=h;this[s]=Object.assign({name:n.getName(`${s}_domain`),fields:[ii(h),...Eu(d)?[ii(h,{binSuffix:"end"})]:[]]},Py(g)?{sortField:g}:ka(g)?{sortIndexField:EM(h,s)}:{})}}this.childModel=n.child}hash(){let e="Facet";for(let n of ag)this[n]&&(e+=` ${n.charAt(0)}:${ss(this[n])}`);return e}get fields(){var e;let n=[];for(let r of ag)!((e=this[r])===null||e===void 0)&&e.fields&&n.push(...this[r].fields);return n}dependentFields(){let e=new Set(this.fields);for(let n of ag)this[n]&&(this[n].sortField&&e.add(this[n].sortField.field),this[n].sortIndexField&&e.add(this[n].sortIndexField));return e}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){let e={};for(let n of og){let r=this.childModel.component.scales[n];if(r&&!r.merged){let a=r.get("type"),s=r.get("range");if(Xp(a)&&bk(s)){let h=Yvt(fot(this.childModel,n));h?e[n]=h:$r(`Unknown field for ${n}. Cannot calculate view size.`)}}}return e}assembleRowColumnHeaderData(e,n,r){let a={row:"y",column:"x"}[e],s=[],h=[],d=[];r&&r[a]&&(n?(s.push(`distinct_${r[a]}`),h.push("max")):(s.push(r[a]),h.push("distinct")),d.push(`distinct_${r[a]}`));let{sortField:g,sortIndexField:b}=this[e];if(g){let{op:_=Oat,field:E}=g;s.push(E),h.push(_),d.push(ii(g,{forAs:!0}))}else b&&(s.push(b),h.push("max"),d.push(b));return{name:this[e].name,source:n??this.data,transform:[Object.assign({type:"aggregate",groupby:this[e].fields},s.length?{fields:s,ops:h,as:d}:{})]}}assembleFacetHeaderData(e){var n,r;let{columns:a}=this.model.layout,{layoutHeaders:s}=this.model.component,h=[],d={};for(let _ of Rvt){for(let E of Fvt){let I=(n=s[_]&&s[_][E])!==null&&n!==void 0?n:[];for(let R of I)if(((r=R.axes)===null||r===void 0?void 0:r.length)>0){d[_]=!0;break}}if(d[_]){let E=`length(data("${this.facet.name}"))`,I=_==="row"?a?{signal:`ceil(${E} / ${a})`}:1:a?{signal:`min(${E}, ${a})`}:{signal:E};h.push({name:`${this.facet.name}_${_}`,transform:[{type:"sequence",start:0,stop:I}]})}}let{row:g,column:b}=d;return(g||b)&&h.unshift(this.assembleRowColumnHeaderData("facet",null,e)),h}assemble(){var e,n;let r=[],a=null,s=this.getChildIndependentFieldsWithStep(),{column:h,row:d,facet:g}=this;if(h&&d&&(s.x||s.y)){a=`cross_${this.column.name}_${this.row.name}`;let b=[].concat((e=s.x)!==null&&e!==void 0?e:[],(n=s.y)!==null&&n!==void 0?n:[]),_=b.map(()=>"distinct");r.push({name:a,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:b,ops:_}]})}for(let b of[I3,A3])this[b]&&r.push(this.assembleRowColumnHeaderData(b,a,s));if(g){let b=this.assembleFacetHeaderData(s);b&&r.push(...b)}return r}}function M7t(t){return t[0]==="'"&&t[t.length-1]==="'"||t[0]==='"'&&t[t.length-1]==='"'?t.slice(1,-1):t}function FQt(t){let e={};return lat(t.filter,n=>{var r;if(PTt(n)){let a=null;Eyt(n)?a=n.equal:Tyt(n)?a=n.range[0]:Ayt(n)&&(a=((r=n.oneOf)!==null&&r!==void 0?r:n.in)[0]),a&&(yM(a)?e[n.field]="date":Ec(a)?e[n.field]="number":bo(a)&&(e[n.field]="string")),n.timeUnit&&(e[n.field]="date")}}),e}function OQt(t){let e={};function n(r){var a;jat(r)?e[r.field]="date":r.type==="quantitative"&&bo(a=r.aggregate)&&Aa(["min","max"],a)?e[r.field]="number":cW(r.field)>1?r.field in e||(e[r.field]="flatten"):Wyt(r)&&Py(r.sort)&&cW(r.sort.field)>1&&(r.sort.field in e||(e[r.sort.field]="flatten"))}if((Bl(t)||V1(t))&&t.forEachFieldDef((r,a)=>{if(Z0(r))n(r);else{let s=l9(a),h=t.fieldDef(s);n(Object.assign(Object.assign({},r),{type:h.type}))}}),Bl(t)){let{mark:r,markDef:a,encoding:s}=t;if(a9(r)&&!t.encoding.order){let h=s[a.orient==="horizontal"?"y":"x"];gi(h)&&h.type==="quantitative"&&!(h.field in e)&&(e[h.field]="number")}}return e}class ff extends au{constructor(e,n){super(e),this._parse=n}clone(){return new ff(null,wo(this._parse))}hash(){return`Parse ${ss(this._parse)}`}static makeExplicit(e,n,r){let a={},s=n.data;return!v9(s)&&s&&s.format&&s.format.parse&&(a=s.format.parse),this.makeWithAncestors(e,a,{},r)}static makeWithAncestors(e,n,r,a){for(let d of jr(r)){let g=a.getWithExplicit(d);g.value!==void 0&&(g.explicit||g.value===r[d]||g.value==="derived"||r[d]==="flatten"?delete r[d]:$r(wTt(d,r[d],g.value)))}for(let d of jr(n)){let g=a.get(d);g!==void 0&&(g===n[d]?delete n[d]:$r(wTt(d,n[d],g)))}let s=new L3(n,r);a.copyAll(s);let h={};for(let d of jr(s.combine())){let g=s.get(d);g!==null&&(h[d]=g)}return jr(h).length===0||a.parseNothing?null:new ff(e,h)}get parse(){return this._parse}merge(e){this._parse=Object.assign(Object.assign({},this._parse),e.parse),e.remove()}assembleFormatParse(){let e={};for(let n of jr(this._parse)){let r=this._parse[n];cW(n)===1&&(e[n]=r)}return e}producedFields(){return new Set(jr(this._parse))}dependentFields(){return new Set(jr(this._parse))}assembleTransforms(e=!1){return jr(this._parse).filter(n=>!e||cW(n)>1).map(n=>{let r=function(a,s){let h=WEt(a);return s==="number"?`toNumber(${h})`:s==="boolean"?`toBoolean(${h})`:s==="string"?`toString(${h})`:s==="date"?`toDate(${h})`:s==="flatten"?h:s.indexOf("date:")===0?`timeParse(${h},'${M7t(s.slice(5,s.length))}')`:s.indexOf("utc:")===0?`utcParse(${h},'${M7t(s.slice(4,s.length))}')`:($r(`Unrecognized parse "${s}".`),null)}(n,this._parse[n]);return r?{type:"formula",expr:r,as:VEt(n)}:null}).filter(n=>n!==null)}}class Tk extends au{clone(){return new Tk(null)}constructor(e){super(e)}dependentFields(){return new Set}producedFields(){return new Set([xM])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:xM}}}class k9 extends au{constructor(e,n){super(e),this.transform=n}clone(){return new k9(null,wo(this.transform))}addDimensions(e){this.transform.groupby=uk(this.transform.groupby.concat(e),n=>n)}dependentFields(){let e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(e.add,e),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(e.add,e),e}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(e){var n;return(n=e.as)!==null&&n!==void 0?n:ii(e)}hash(){return`JoinAggregateTransform ${ss(this.transform)}`}assemble(){let e=[],n=[],r=[];for(let s of this.transform.joinaggregate)n.push(s.op),r.push(this.getDefaultName(s)),e.push(s.field===void 0?null:s.field);let a=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:e},a!==void 0?{groupby:a}:{})}}class j3 extends au{constructor(e,n){super(e),this._stack=n}clone(){return new j3(null,wo(this._stack))}static makeFromTransform(e,n){let{stack:r,groupby:a,as:s,offset:h="zero"}=n,d=[],g=[];if(n.sort!==void 0)for(let E of n.sort)d.push(E.field),g.push(Tc(E.order,"ascending"));let b={field:d,order:g},_;return _=function(E){return ka(E)&&E.every(I=>bo(I))&&E.length>1}(s)?s:bo(s)?[s,s+"_end"]:[n.stack+"_start",n.stack+"_end"],new j3(e,{stackField:r,groupby:a,offset:h,sort:b,facetby:[],as:_})}static makeFromEncoding(e,n){let r=n.stack,{encoding:a}=n;if(!r)return null;let{groupbyChannel:s,fieldChannel:h,offset:d,impute:g}=r,b;s&&(b=jy(a[s]));let _=function(R){return R.stack.stackBy.reduce((z,P)=>{let rt=ii(P.fieldDef);return rt&&z.push(rt),z},[])}(n),E=n.encoding.order,I;return I=ka(E)||gi(E)?CAt(E):_.reduce((R,z)=>(R.field.push(z),R.order.push(h==="y"?"descending":"ascending"),R),{field:[],order:[]}),new j3(e,{dimensionFieldDef:b,stackField:n.vgField(h),facetby:[],stackby:_,sort:I,offset:d,impute:g,as:[n.vgField(h,{suffix:"start",forAs:!0}),n.vgField(h,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(e){this._stack.facetby.push(...e)}dependentFields(){let e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(e.add,e),this._stack.facetby.forEach(e.add,e),this._stack.sort.field.forEach(e.add,e),e}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${ss(this._stack)}`}getGroupbyFields(){let{dimensionFieldDef:e,impute:n,groupby:r}=this._stack;return e?e.bin?n?[ii(e,{binSuffix:"mid"})]:[ii(e,{}),ii(e,{binSuffix:"end"})]:[ii(e)]:r??[]}assemble(){let e=[],{facetby:n,dimensionFieldDef:r,stackField:a,stackby:s,sort:h,offset:d,impute:g,as:b}=this._stack;if(g&&r){let{band:_=.5,bin:E}=r;E&&e.push({type:"formula",expr:`${_}*`+ii(r,{expr:"datum"})+`+${1-_}*`+ii(r,{expr:"datum",binSuffix:"end"}),as:ii(r,{binSuffix:"mid",forAs:!0})}),e.push({type:"impute",field:a,groupby:[...s,...n],key:ii(r,{binSuffix:"mid"}),method:"value",value:0})}return e.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:a,sort:h,as:b,offset:d}),e}}class NM extends au{constructor(e,n){super(e),this.transform=n}clone(){return new NM(null,wo(this.transform))}addDimensions(e){this.transform.groupby=uk(this.transform.groupby.concat(e),n=>n)}dependentFields(){var e,n;let r=new Set;return((e=this.transform.groupby)!==null&&e!==void 0?e:[]).forEach(r.add,r),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(a=>r.add(a.field)),this.transform.window.map(a=>a.field).filter(a=>a!==void 0).forEach(r.add,r),r}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(e){var n;return(n=e.as)!==null&&n!==void 0?n:ii(e)}hash(){return`WindowTransform ${ss(this.transform)}`}assemble(){var e;let n=[],r=[],a=[],s=[];for(let I of this.transform.window)r.push(I.op),a.push(this.getDefaultName(I)),s.push(I.param===void 0?null:I.param),n.push(I.field===void 0?null:I.field);let h=this.transform.frame,d=this.transform.groupby;if(h&&h[0]===null&&h[1]===null&&r.every(I=>fyt(I)))return Object.assign({type:"joinaggregate",as:a,ops:r,fields:n},d!==void 0?{groupby:d}:{});let g=[],b=[];if(this.transform.sort!==void 0)for(let I of this.transform.sort)g.push(I.field),b.push((e=I.order)!==null&&e!==void 0?e:"ascending");let _={field:g,order:b},E=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:s,as:a,ops:r,fields:n,sort:_},E!==void 0?{ignorePeers:E}:{}),d!==void 0?{groupby:d}:{}),h!==void 0?{frame:h}:{})}}class LQt extends B3{run(e){let n=e.parent;if(e instanceof ff){if(hot(n))return this.flags;if(n.numChildren()>1)return this.setContinue(),this.flags;if(n instanceof ff)this.setMutated(),n.merge(e);else{if(jEt(n.producedFields(),e.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),e.swapWithParent()}}return this.setContinue(),this.flags}}class $Qt extends jvt{mergeNodes(e,n){let r=n.shift();for(let a of n)e.removeChild(a),a.parent=r,a.remove()}run(e){let n=e.children.map(a=>a.hash()),r={};for(let a=0;a<n.length;a++)r[n[a]]===void 0?r[n[a]]=[e.children[a]]:r[n[a]].push(e.children[a]);for(let a of jr(r))r[a].length>1&&(this.setMutated(),this.mergeNodes(e,r[a]));for(let a of e.children)this.run(a);return this.mutatedFlag}}class zQt extends B3{run(e){return e instanceof Vf||e.numChildren()>0||e instanceof IM||(this.setMutated(),e.remove()),this.flags}}class PQt extends B3{constructor(){super(...arguments),this.fields=new Set,this.prev=null}run(e){if(this.setContinue(),e instanceof Wy){let n=e.producedFields();PEt(n,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...n]),this.prev=e}return this.flags}reset(){this.fields.clear()}}class BQt extends B3{run(e){this.setContinue();let n=e.parent.children.filter(a=>a instanceof Wy),r=n.pop();for(let a of n)this.setMutated(),r.merge(a);return this.flags}}function Uvt(t){if(t instanceof IM)if(t.numChildren()!==1||t.children[0]instanceof Vf){let n=t.model.component.data.main;D7t(n);let r=(e=t,function s(h){if(!(h instanceof IM)){let d=h.clone();if(d instanceof Vf){let g=Wvt+d.getSource();d.setSource(g),e.model.component.data.outputNodes[g]=d}else(d instanceof U1||d instanceof j3||d instanceof NM||d instanceof k9)&&d.addDimensions(e.fields);for(let g of h.children.flatMap(s))g.parent=d;return[d]}return h.children.flatMap(s)}),a=t.children.map(r).flat();for(let s of a)s.parent=n}else{let n=t.children[0];(n instanceof U1||n instanceof j3||n instanceof NM||n instanceof k9)&&n.addDimensions(t.fields),n.swapWithParent(),Uvt(t)}else t.children.map(Uvt);var e}function D7t(t){if(t instanceof Vf&&t.type===uf&&t.numChildren()===1){let e=t.children[0];e instanceof IM||(e.swapWithParent(),D7t(t))}}class jQt extends jvt{constructor(){super()}run(e){e instanceof Vf&&!e.isRequired()&&(this.setMutated(),e.remove());for(let n of e.children)this.run(n);return this.mutatedFlag}}class UQt extends jvt{constructor(e){super(),this.requiresSelectionId=e&&wvt(e)}run(e){e instanceof Tk&&(this.requiresSelectionId&&(hot(e.parent)||e.parent instanceof U1||e.parent instanceof ff)||(this.setMutated(),e.remove()));for(let n of e.children)this.run(n);return this.mutatedFlag}}class WQt extends B3{run(e){let n=e.parent,r=[...n.children],a=n.children.filter(s=>s instanceof ff);if(n.numChildren()>1&&a.length>=1){let s={},h=new Set;for(let d of a){let g=d.parse;for(let b of jr(g))b in s?s[b]!==g[b]&&h.add(b):s[b]=g[b]}for(let d of h)delete s[d];if(!yu(s)){this.setMutated();let d=new ff(n,s);for(let g of r){if(g instanceof ff)for(let b of jr(s))delete g.parse[b];n.removeChild(g),g.parent=d,g instanceof ff&&jr(g.parse).length===0&&g.remove()}}}return this.setContinue(),this.flags}}class VQt extends B3{run(e){let n=e.parent,r=n.children.filter(s=>s instanceof U1),a={};for(let s of r){let h=ss(s.groupBy);h in a||(a[h]=[]),a[h].push(s)}for(let s of jr(a)){let h=a[s];if(h.length>1){let d=h.pop();for(let g of h)d.merge(g)&&(n.removeChild(g),g.parent=d,g.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class GQt extends B3{constructor(e){super(),this.model=e}run(e){let n=e.parent,r=!(hot(n)||n instanceof _M||n instanceof ff||n instanceof Tk),a=[],s=[];for(let h of n.children)h instanceof Gy&&(r&&!jEt(n.producedFields(),h.dependentFields())?a.push(h):s.push(h));if(a.length>0){let h=a.pop();for(let d of a)h.merge(d,this.model.renameSignal.bind(this.model));this.setMutated(),n instanceof Gy?n.merge(h,this.model.renameSignal.bind(this.model)):h.swapWithParent()}if(s.length>1){let h=s.pop();for(let d of s)h.merge(d,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class HQt extends B3{run(e){let n=e.parent,r=[...n.children];if(!uW(r,h=>h instanceof Vf)||n.numChildren()<=1)return this.setContinue(),this.flags;let a=[],s;for(let h of r)if(h instanceof Vf){let d=h;for(;d.numChildren()===1;){let g=d.children[0];if(!(g instanceof Vf))break;d=g}a.push(...d.children),s?(n.removeChild(h),h.parent=s.parent,s.parent.removeChild(s),s.parent=d,this.setMutated()):s=d}else a.push(h);if(a.length){this.setMutated();for(let h of a)h.parent.removeChild(h),h.parent=s}return this.setContinue(),this.flags}}let Wvt="scale_",dot=5;function Ak(t){let e=[];function n(r){if(r.numChildren()===0)e.push(r);else for(let a of r.children)n(a)}for(let r of t)n(r);return e}function YQt(t){return t}function W1(t,e){return e.map(n=>{if(t instanceof B3){let r=t.optimizeNextFromLeaves(n);return t.reset(),r}return t.run(n)}).some(YQt)}function R7t(t,e){let n=t.sources,r=new Set;return r.add(W1(new jQt,n)),r.add(W1(new UQt(e),n)),n=n.filter(a=>a.numChildren()>0),r.add(W1(new zQt,Ak(n))),n=n.filter(a=>a.numChildren()>0),r.add(W1(new LQt,Ak(n))),r.add(W1(new GQt(e),Ak(n))),r.add(W1(new PQt,Ak(n))),r.add(W1(new WQt,Ak(n))),r.add(W1(new VQt,Ak(n))),r.add(W1(new BQt,Ak(n))),r.add(W1(new $Qt,n)),r.add(W1(new HQt,Ak(n))),t.sources=n,r.has(!0)}class Q0{constructor(e){Object.defineProperty(this,"signal",{enumerable:!0,get:e})}static fromName(e,n){return new Q0(()=>e(n))}}function F7t(t){Bl(t)?function(e){let n=e.component.scales;for(let r of jr(n)){let a=qQt(e,r);if(n[r].setWithExplicit("domains",a),XQt(e,r),e.component.data.isFaceted){let s=e;for(;!V1(s)&&s.parent;)s=s.parent;if(s.component.resolve.scale[r]==="shared")for(let h of a.value)wk(h)&&(h.data=Wvt+h.data.replace(Wvt,""))}}}(t):function(e){for(let r of e.children)F7t(r);let n=e.component.scales;for(let r of jr(n)){let a,s=null;for(let h of e.children){let d=h.component.scales[r];if(d){a=a===void 0?d.getWithExplicit("domains"):_k(a,d.getWithExplicit("domains"),"domains","scale",Hvt);let g=d.get("selectionExtent");s&&g&&s.selection!==g.selection&&$r("The same selection must be used to override scale domains in a layered view."),s=g}}n[r].setWithExplicit("domains",a),s&&n[r].set("selectionExtent",s,!0)}}(t)}function qQt(t,e){let n=t.getScaleComponent(e).get("type"),{encoding:r}=t,a=function(s,h,d,g){if(s==="unaggregated"){let{valid:b,reason:_}=O7t(h,d);if(!b)return void $r(_)}else if(s===void 0&&g.useUnaggregatedDomain){let{valid:b}=O7t(h,d);if(b)return"unaggregated"}return s}(t.scaleDomain(e),t.typedFieldDef(e),n,t.config.scale);return a!==t.scaleDomain(e)&&(t.specifiedScales[e]=Object.assign(Object.assign({},t.specifiedScales[e]),{domain:a})),e==="x"&&sh(r.x2)?sh(r.x)?_k(Ik(n,a,t,"x"),Ik(n,a,t,"x2"),"domain","scale",Hvt):Ik(n,a,t,"x2"):e==="y"&&sh(r.y2)?sh(r.y)?_k(Ik(n,a,t,"y"),Ik(n,a,t,"y2"),"domain","scale",Hvt):Ik(n,a,t,"y2"):Ik(n,a,t,e)}function Vvt(t,e,n){var r;let a=(r=Wf(n))===null||r===void 0?void 0:r.unit;return e==="temporal"||a?function(s,h,d){return s.map(g=>({signal:`{data: ${Yyt(g,{timeUnit:d,type:h})}}`}))}(t,e,a):[t]}function Ik(t,e,n,r){let{encoding:a}=n,s=sh(a[r]),{type:h}=s,d=s.timeUnit;if(function(E){return E&&E.unionWith}(e)){let E=Ik(t,void 0,n,r),I=Vvt(e.unionWith,h,d);return y9([...E.value,...I])}if(Ua(e))return y9([e]);if(e&&e!=="unaggregated"&&!HTt(e))return y9(Vvt(e,h,d));let g=n.stack;if(g&&r===g.fieldChannel){if(g.offset==="normalize")return B1([[0,1]]);let E=n.requestDataName(uf);return B1([{data:E,field:n.vgField(r,{suffix:"start"})},{data:E,field:n.vgField(r,{suffix:"end"})}])}let b=vk(r)&&gi(s)?function(E,I,R){if(!Xp(R))return;let z=E.fieldDef(I),P=z.sort;if(uAt(P))return{op:"min",field:EM(z,I),order:"ascending"};let{stack:rt}=E,ot=rt?[...rt.groupbyField?[rt.groupbyField]:[],...rt.stackBy.map(at=>at.fieldDef.field)]:void 0;if(Py(P))return Gvt(P,rt&&!Aa(ot,P.field));if(sAt(P)){let{encoding:at,order:dt}=P,ct=E.fieldDef(at),{aggregate:Ct,field:Et}=ct,Rt=rt&&!Aa(ot,Et);if(hk(Ct)||o9(Ct))return Gvt({field:ii(ct),order:dt},Rt);if(fyt(Ct)||!Ct)return Gvt({op:Ct,field:Et,order:dt},Rt)}else{if(P==="descending")return{op:"min",field:E.vgField(I),order:"descending"};if(Aa(["ascending",void 0],P))return!0}}(n,r,t):void 0;if(kk(s))return B1(Vvt([s.datum],h,d));let _=s;if(e==="unaggregated"){let E=n.requestDataName(uf),{field:I}=s;return B1([{data:E,field:ii({field:I,aggregate:"min"})},{data:E,field:ii({field:I,aggregate:"max"})}])}if(Eu(_.bin)){if(Xp(t))return B1(t==="bin-ordinal"?[]:[{data:hat(b)?n.requestDataName(uf):n.requestDataName(Kat),field:n.vgField(r,wW(_,r)?{binSuffix:"range"}:{}),sort:b!==!0&&Bh(b)?b:{field:n.vgField(r,{}),op:"min"}}]);{let{bin:E}=_;if(Eu(E)){let I=Pvt(n,_.field,E);return B1([new Q0(()=>{let R=n.getSignalName(I);return`[${R}.start, ${R}.stop]`})])}return B1([{data:n.requestDataName(uf),field:n.vgField(r,{})}])}}if(_.timeUnit&&Aa(["time","utc"],t)&&Pyt(r,_,Bl(n)?n.encoding[Oy(r)]:void 0,n.stack,n.markDef,n.config)){let E=n.requestDataName(uf);return B1([{data:E,field:n.vgField(r)},{data:E,field:n.vgField(r,{suffix:"end"})}])}return B1(b?[{data:hat(b)?n.requestDataName(uf):n.requestDataName(Kat),field:n.vgField(r),sort:b}]:[{data:n.requestDataName(uf),field:n.vgField(r)}])}function Gvt(t,e){let{op:n,field:r,order:a}=t;return Object.assign(Object.assign({op:n??(e?"sum":Oat)},r?{field:ck(r)}:{}),a?{order:a}:{})}function XQt(t,e){var n;let r=t.component.scales[e],a=t.specifiedScales[e].domain,s=(n=t.fieldDef(e))===null||n===void 0?void 0:n.bin,h=HTt(a)&&a,d=pW(s)&&Aat(s.extent)&&s.extent;(h||d)&&r.set("selectionExtent",h??d,!0)}function O7t(t,e){let{aggregate:n,type:r}=t;return n?bo(n)&&!RXt[n]?{valid:!1,reason:qXt(n)}:r==="quantitative"&&e==="log"?{valid:!1,reason:XXt(t)}:{valid:!0}:{valid:!1,reason:YXt(t)}}function Hvt(t,e,n,r){return t.explicit&&e.explicit&&$r(function(a,s,h,d){return`Conflicting ${s.toString()} property "${a.toString()}" (${sl(h)} and ${sl(d)}). Using the union of the two domains.`}(n,r,t.value,e.value)),{explicit:t.explicit,value:[...t.value,...e.value]}}function KQt(t){let e=uk(t.map(h=>wk(h)?fa(h,["sort"]):h),ss),n=uk(t.map(h=>{if(wk(h)){let d=h.sort;return d===void 0||hat(d)||("op"in d&&d.op==="count"&&delete d.field,d.order==="ascending"&&delete d.order),d}}).filter(h=>h!==void 0),ss);if(e.length===0)return;if(e.length===1){let h=t[0];if(wk(h)&&n.length>0){let d=n[0];if(n.length>1)$r(ETt),d=!0;else if(Bh(d)&&"field"in d){let g=d.field;h.field===g&&(d=!d.order||{order:d.order})}return Object.assign(Object.assign({},h),{sort:d})}return h}let r=uk(n.map(h=>hat(h)||!("op"in h)||h.op in NXt?h:($r(function(d){return`Dropping sort property ${sl(d)} as unioned domains only support boolean or op "count", "min", and "max".`}(h)),!0)),ss),a;r.length===1?a=r[0]:r.length>1&&($r(ETt),a=!0);let s=uk(t.map(h=>wk(h)?h.data:null),h=>h);return s.length===1&&s[0]!==null?Object.assign({data:s[0],fields:e.map(h=>h.field)},a?{sort:a}:{}):Object.assign({fields:e},a?{sort:a}:{})}function Yvt(t){if(wk(t)&&bo(t.field))return t.field;if(function(e){return!ka(e)&&"fields"in e&&!("data"in e)}(t)){let e;for(let n of t.fields)if(wk(n)&&bo(n.field))if(e){if(e!==n.field)return $r("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),e}else e=n.field;return $r("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),e}if(function(e){return!ka(e)&&"fields"in e&&"data"in e}(t)){$r("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");let e=t.fields[0];return bo(e)?e:void 0}}function fot(t,e){let n=t.component.scales[e].get("domains").map(r=>(wk(r)&&(r.data=t.lookupDataSource(r.data)),r));return KQt(n)}function L7t(t){return MM(t)||Xvt(t)?t.children.reduce((e,n)=>e.concat(L7t(n)),$7t(t)):$7t(t)}function $7t(t){return jr(t.component.scales).reduce((e,n)=>{let r=t.component.scales[n];if(r.merged)return e;let a=r.combine(),{name:s,type:h,selectionExtent:d,reverse:g}=a,b=fa(a,["name","type","selectionExtent","domains","range","reverse"]),_=function(R,z,P){return $y(P)&&bk(R)?{step:{signal:z+"_step"}}:R}(a.range,s,n),E;d&&(E=function(R,z){let P=z.selection;return{signal:QIt(R.getSelectionComponent(P,ul(P)),z)}}(t,d));let I=fot(t,n);return e.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:s,type:h},I?{domain:I}:{}),E?{domainRaw:E}:{}),{range:_}),g!==void 0?{reverse:g}:{}),b)),e},[])}class z7t extends L3{constructor(e,n){super({},{name:e}),this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1||uW(this.get("domains"),e=>ka(e)&&e.length===2&&e[0]<=0&&e[1]>=0)}}let ZQt=["range","scheme"];function P7t(t){return t==="x"?"width":t==="y"?"height":void 0}function B7t(t,e){let n=t.fieldDef(e);if(n&&n.bin&&Eu(n.bin)){let r=Pvt(t,n.field,n.bin),a=P7t(e),s=t.getName(a);return new Q0(()=>{let h=t.getSignalName(r),d=`(${h}.stop - ${h}.start) / ${h}.step`;return`${t.getSignalName(s)} / (${d})`})}}function QQt(t,e){let n=e.specifiedScales[t],{size:r}=e,a=e.getScaleComponent(t).get("type");for(let s of ZQt)if(n[s]!==void 0){let h=YTt(a,s),d=qTt(t,s);if(h)if(d)$r(d);else switch(s){case"range":return ka(n.range)&&$y(t)?y9(n.range.map(g=>{if(g==="width"||g==="height"){let b=e.getName(g),_=e.getSignalName.bind(e);return Q0.fromName(_,b)}return g})):y9(n.range);case"scheme":return y9(JQt(n[s]))}else $r(_Tt(a,s,t))}if(t===kl||t===oh){let s=t===kl?"width":"height",h=r[s];if(Uy(h)){if(Xp(a))return y9({step:h.step});$r(CTt(s))}}return B1(function(s,h){let{size:d,config:g,mark:b,encoding:_}=h,E=h.getSignalName.bind(h),{type:I}=sh(_[s]),R=h.getScaleComponent(s),z=R.get("type"),{domain:P,domainMid:rt}=h.specifiedScales[s];switch(s){case kl:case oh:{if(Aa(["point","band"],z))if(s!==kl||d.width){if(s===oh&&!d.height){let dt=kW(g.view,"height");if(Uy(dt))return dt}}else{let dt=kW(g.view,"width");if(Uy(dt))return dt}let ot=P7t(s),at=h.getName(ot);return s===oh&&sg(z)?[Q0.fromName(E,at),0]:[0,Q0.fromName(E,at)]}case D3:{let ot=j7t(b,h.component.scales[s].get("zero"),g),at=function(dt,ct,Ct,Et){let Rt={x:B7t(Ct,"x"),y:B7t(Ct,"y")};switch(dt){case"bar":case"tick":{if(Et.scale.maxBandSize!==void 0)return Et.scale.maxBandSize;let Ot=W7t(ct,Rt,Et.view);return Ec(Ot)?Ot-1:new Q0(()=>`${Ot.signal} - 1`)}case"line":case"trail":case"rule":return Et.scale.maxStrokeWidth;case"text":return Et.scale.maxFontSize;case"point":case"square":case"circle":{if(Et.scale.maxSize)return Et.scale.maxSize;let Ot=W7t(ct,Rt,Et.view);return Ec(Ot)?Math.pow(U7t*Ot,2):new Q0(()=>`pow(${U7t} * ${Ot.signal}, 2)`)}}throw new Error(Iat("size",dt))}(b,d,h,g);return Dat(z)?function(dt,ct,Ct){let Et=()=>{let Rt=xW(ct),Ot=xW(dt),Wt=`(${Rt} - ${Ot}) / (${Ct} - 1)`;return`sequence(${Ot}, ${Rt} + ${Wt}, ${Wt})`};return Ua(ct)?new Q0(Et):{signal:Et()}}(ot,at,function(dt,ct,Ct,Et){switch(dt){case"quantile":return ct.scale.quantileCount;case"quantize":return ct.scale.quantizeCount;case"threshold":return Ct!==void 0&&ka(Ct)?Ct.length+1:($r(function(Rt){return`Domain for ${Rt} is required for threshold scale.`}(Et)),3)}}(z,g,P,s)):[ot,at]}case $1:return[0,2*Math.PI];case s9:return[0,360];case Ny:return[0,new Q0(()=>`min(${h.getSignalName("width")},${h.getSignalName("height")})/2`)];case pk:return[g.scale.minStrokeWidth,g.scale.maxStrokeWidth];case mk:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case qp:return"symbol";case Yp:case Ry:case Fy:return z==="ordinal"?I==="nominal"?"category":"ordinal":rt!==void 0?"diverging":b==="rect"||b==="geoshape"?"heatmap":"ramp";case R3:case dk:case fk:return[g.scale.minOpacity,g.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${s}`)}(t,e))}function JQt(t){return function(e){return!bo(e)&&!!e.name}(t)?Object.assign({scheme:t.name},E3(t,["name"])):{scheme:t}}function j7t(t,e,n){if(e)return Ua(e)?{signal:`${e.signal} ? 0 : ${j7t(t,!1,n)}`}:0;switch(t){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(Iat("size",t))}let U7t=.95;function W7t(t,e,n){let r=Uy(t.width)?t.width.step:Hat(n,"width"),a=Uy(t.height)?t.height.step:Hat(n,"height");return e.x||e.y?new Q0(()=>`min(${[e.x?e.x.signal:r,e.y?e.y.signal:a].join(", ")})`):Math.min(r,a)}function V7t(t,e){Bl(t)?function(n,r){let a=n.component.scales,{config:s,encoding:h,markDef:d,specifiedScales:g}=n;for(let b of jr(a)){let _=g[b],E=a[b],I=n.getScaleComponent(b),R=sh(h[b]),z=_[r],P=I.get("type"),rt=I.get("padding"),ot=I.get("paddingInner"),at=YTt(P,r),dt=qTt(b,r);if(z!==void 0&&(at?dt&&$r(dt):$r(_Tt(P,r,b))),at&&dt===void 0)if(z!==void 0)E.copyKeyFromObject(r,_);else{let ct=r in G7t?G7t[r]({model:n,channel:b,fieldOrDatumDef:R,scaleType:P,scalePadding:rt,scalePaddingInner:ot,domain:_.domain,markDef:d,config:s}):s.scale[r];ct!==void 0&&E.set(r,ct,!1)}}}(t,e):Y7t(t,e)}let G7t={bins:({model:t,fieldOrDatumDef:e})=>gi(e)?function(n,r){let a=r.bin;if(Eu(a)){let s=Pvt(n,r.field,a);return new Q0(()=>n.getSignalName(s))}if(Uf(a)&&pW(a)&&a.step!==void 0)return{step:a.step}}(t,e):void 0,interpolate:({channel:t,fieldOrDatumDef:e})=>function(n,r){if(Aa([Yp,Ry,Fy],n)&&r!=="nominal")return"hcl"}(t,e.type),nice:({scaleType:t,channel:e,fieldOrDatumDef:n})=>function(r,a,s){var h;if(!(!((h=jy(s))===null||h===void 0)&&h.bin||Aa([Dyt,Mat],r)))return a in yk||void 0}(t,e,n),padding:({channel:t,scaleType:e,fieldOrDatumDef:n,markDef:r,config:a})=>function(s,h,d,g,b,_){if(s in yk){if(P1(h)){if(d.continuousPadding!==void 0)return d.continuousPadding;let{type:E,orient:I}=b;if(E==="bar"&&(!gi(g)||!g.bin&&!g.timeUnit)&&(I==="vertical"&&s==="x"||I==="horizontal"&&s==="y"))return _.continuousBandSize}if(h===WTt)return d.pointPadding}}(t,e,a.scale,n,r,a.bar),paddingInner:({scalePadding:t,channel:e,markDef:n,config:r})=>function(a,s,h,d){if(a===void 0&&s in yk){let{bandPaddingInner:g,barBandPaddingInner:b,rectBandPaddingInner:_}=d;return Tc(g,h==="bar"?b:_)}}(t,e,n.type,r.scale),paddingOuter:({scalePadding:t,channel:e,scaleType:n,markDef:r,scalePaddingInner:a,config:s})=>function(h,d,g,b,_,E){if(h===void 0&&d in yk&&g===hKt){let{bandPaddingOuter:I}=E;return Tc(I,Ua(_)?{signal:`${_.signal}/2`}:_/2)}}(t,e,n,r.type,a,s.scale),reverse:({fieldOrDatumDef:t,scaleType:e,channel:n,config:r})=>function(a,s,h,d){if(h==="x"&&d.xReverse!==void 0)return sg(a)&&s==="descending"?Ua(d.xReverse)?{signal:`!${d.xReverse.signal}`}:!d.xReverse:d.xReverse;if(sg(a)&&s==="descending")return!0}(e,gi(t)?t.sort:void 0,n,r.scale),zero:({channel:t,fieldOrDatumDef:e,domain:n,markDef:r,scaleType:a})=>function(s,h,d,g,b){if(d&&d!=="unaggregated"&&sg(b)){if(ka(d)){let _=d[0],E=d[d.length-1];if(_<=0&&E>=0)return!0}return!1}if(s==="size"&&h.type==="quantitative"&&!Dat(b))return!0;if((!gi(h)||!h.bin)&&Aa([...og,...PXt],s)){let{orient:_,type:E}=g;return!Aa(["bar","area","line","trail"],E)||!(_==="horizontal"&&s==="y"||_==="vertical"&&s==="x")}return!1}(t,e,n,r,a)};function H7t(t){Bl(t)?function(e){let n=e.component.scales;for(let r of Eat){let a=n[r];if(!a)continue;let s=QQt(r,e);a.setWithExplicit("range",s)}}(t):Y7t(t,"range")}function Y7t(t,e){let n=t.component.scales;for(let r of t.children)e==="range"?H7t(r):V7t(r,e);for(let r of jr(n)){let a;for(let s of t.children){let h=s.component.scales[r];h&&(a=_k(a,h.getWithExplicit(e),e,"scale",sIt((d,g)=>e==="range"&&d.step&&g.step?d.step-g.step:0)))}n[r].setWithExplicit(e,a)}}function tJt(t,e,n,r){let a=function(h,d,g){var b;switch(d.type){case"nominal":case"ordinal":if(gM(h)||Tat(h)==="discrete")return h==="shape"&&d.type==="ordinal"&&$r(wyt(h,"ordinal")),"ordinal";if(h in yk){if(Aa(["rect","bar","image","rule"],g))return"band"}else if(g==="arc"&&h in yyt)return"band";return d.band!==void 0||Vyt(d)&&(!((b=d.axis)===null||b===void 0)&&b.tickBand)?"band":"point";case"temporal":return gM(h)?"time":Tat(h)==="discrete"?($r(wyt(h,"temporal")),"ordinal"):gi(d)&&d.timeUnit&&Wf(d.timeUnit).utc?"utc":"time";case"quantitative":return gM(h)?gi(d)&&Eu(d.bin)?"bin-ordinal":"linear":Tat(h)==="discrete"?($r(wyt(h,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(kTt(d.type))}(e,n,r),{type:s}=t;return vk(e)?s!==void 0?KTt(e,s)?gi(n)&&!XTt(s,n.type)?($r(function(h,d){return`FieldDef does not work with "${h}" scale. We are using "${d}" scale instead.`}(s,a)),a):s:($r(function(h,d,g){return`Channel "${h}" does not work with "${d}" scale. We are using "${g}" scale instead.`}(e,s,a)),a):a:null}function q7t(t){Bl(t)?t.component.scales=function(e){let{encoding:n,mark:r}=e;return Eat.reduce((a,s)=>{let h=sh(n[s]);if(h&&r===ZEt&&s===qp&&h.type===wM)return a;let d=h&&h.scale;if(h&&d!==null&&d!==!1){d=d??{};let g=tJt(d,s,h,r);a[s]=new z7t(e.scaleName(s+"",!0),{value:g,explicit:d.type===g})}return a},{})}(t):t.component.scales=function(e){var n;let r=e.component.scales={},a={},s=e.component.resolve;for(let h of e.children){q7t(h);for(let d of jr(h.component.scales))if(s.scale[d]=(n=s.scale[d])!==null&&n!==void 0?n:SQt(d,e),s.scale[d]==="shared"){let g=a[d],b=h.component.scales[d].getWithExplicit("type");g?fKt(g.value,b.value)?a[d]=_k(g,b,"type","scale",eJt):(s.scale[d]="independent",delete a[d]):a[d]=b}}for(let h of jr(a)){let d=e.scaleName(h,!0),g=a[h];r[h]=new z7t(d,g);for(let b of e.children){let _=b.component.scales[h];_&&(b.renameScale(_.get("name"),d),_.merged=!0)}}return r}(t)}let eJt=sIt((t,e)=>VTt(t)-VTt(e));class qvt{constructor(){this.nameMap={}}rename(e,n){this.nameMap[e]=n}has(e){return this.nameMap[e]!==void 0}get(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e}}function Bl(t){return t?.type==="unit"}function V1(t){return t?.type==="facet"}function Xvt(t){return t?.type==="concat"}function MM(t){return t?.type==="layer"}class Kvt{constructor(e,n,r,a,s,h,d){var g,b;this.type=n,this.parent=r,this.config=s,this.view=d,this.children=[],this.correctDataNames=_=>(_.from&&_.from.data&&(_.from.data=this.lookupDataSource(_.from.data)),_.from&&_.from.facet&&_.from.facet.data&&(_.from.facet.data=this.lookupDataSource(_.from.facet.data)),_),this.parent=r,this.config=s,this.name=(g=e.name)!==null&&g!==void 0?g:a,this.title=Sk(e.title)?{text:e.title}:e.title,this.scaleNameMap=r?r.scaleNameMap:new qvt,this.projectionNameMap=r?r.projectionNameMap:new qvt,this.signalNameMap=r?r.signalNameMap:new qvt,this.data=e.data,this.description=e.description,this.transforms=function(_){return _.map(E=>hIt(E)?{filter:cat(E.filter,rKt)}:E)}((b=e.transform)!==null&&b!==void 0?b:[]),this.layout=n==="layer"||n==="unit"?{}:function(_,E,I){var R,z;let P=I[E],rt={},{spacing:ot,columns:at}=P;ot!==void 0&&(rt.spacing=ot),at!==void 0&&(Lat(_)&&!vW(_.facet)||ivt(_))&&(rt.columns=at),Gat(_)&&(rt.columns=1);for(let dt of LKt)if(_[dt]!==void 0)if(dt==="spacing"){let ct=_[dt];rt[dt]=Ec(ct)?ct:{row:(R=ct.row)!==null&&R!==void 0?R:ot,column:(z=ct.column)!==null&&z!==void 0?z:ot}}else rt[dt]=_[dt];return rt}(e,n,s),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:Lat(e)||r&&r.component.data.isFaceted&&e.data===void 0},layoutSize:new L3,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},h?wo(h):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){(function(e,{ignoreRange:n}={}){q7t(e),F7t(e);for(let r of kKt)V7t(e,r);n||H7t(e)})(this)}parseProjection(){T7t(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){x7t(this)}assembleGroupStyle(){var e,n;if(this.type==="unit"||this.type==="layer")return(n=(e=this.view)===null||e===void 0?void 0:e.style)!==null&&n!==void 0?n:"cell"}assembleEncodeFromView(e){let n=fa(e,["style"]),r={};for(let a of jr(n)){let s=n[a];s!==void 0&&(r[a]=nc(s))}return r}assembleGroupEncodeEntry(e){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),e||(this.description&&(n.description=nc(this.description)),this.type!=="unit"&&this.type!=="layer")?yu(n)?void 0:n:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n??{})}assembleLayout(){if(!this.layout)return;let e=this.layout,{spacing:n}=e,r=fa(e,["spacing"]),{component:a,config:s}=this,h=function(d,g){let b={};for(let _ of ag){let E=d[_];if(E?.facetFieldDef){let{titleAnchor:I,titleOrient:R}=lot(["titleAnchor","titleOrient"],E.facetFieldDef,g,_),z=uot(_,R),P=kQt(I,z);P!==void 0&&(b[z]=P)}}return yu(b)?void 0:b}(a.layoutHeaders,s);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),r),h?{titleBand:h}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){let{layoutHeaders:e}=this.component,n=[];for(let r of ag)e[r].title&&n.push(yQt(this,r));for(let r of Rvt)n=n.concat(vQt(this,r));return n}assembleAxes(){return function(e,n){let{x:r=[],y:a=[]}=e;return[...r.map(s=>RW(s,"grid",n)),...a.map(s=>RW(s,"grid",n)),...r.map(s=>RW(s,"main",n)),...a.map(s=>RW(s,"main",n))].filter(s=>s)}(this.component.axes,this.config)}assembleLegends(){return _7t(this)}assembleProjections(){return MQt(this)}assembleTitle(){var e,n,r;let a=(e=this.title)!==null&&e!==void 0?e:{},{encoding:s}=a,h=fa(a,["encoding"]),d=Object.assign(Object.assign(Object.assign({},xAt(this.config.title).nonMark),h),s?{encode:{update:s}}:{});if(d.text)return Aa(["unit","layer"],this.type)?Aa(["middle",void 0],d.anchor)&&(d.frame=(n=d.frame)!==null&&n!==void 0?n:"group"):d.anchor=(r=d.anchor)!==null&&r!==void 0?r:"start",yu(d)?void 0:d}assembleGroup(e=[]){let n={};(e=e.concat(this.assembleSignals())).length>0&&(n.signals=e);let r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());let a=!this.parent||V1(this.parent)?L7t(this):[];a.length>0&&(n.scales=a);let s=this.assembleAxes();s.length>0&&(n.axes=s);let h=this.assembleLegends();return h.length>0&&(n.legends=h),n}getName(e){return ul((this.name?this.name+"_":"")+e)}requestDataName(e){var n;let r=this.getName(e),a=this.component.data.outputNodeRefCounts;return a[r]=((n=a[r])!==null&&n!==void 0?n:0)+1,r}getSizeSignalRef(e){if(V1(this.parent)){let n=Cat(d7t(e)),r=this.component.scales[n];if(r&&!r.merged){let a=r.get("type"),s=r.get("range");if(Xp(a)&&bk(s)){let h=r.get("name"),d=Yvt(fot(this,n));return d?{signal:h7t(h,r,ii({aggregate:"distinct",field:d},{expr:"datum"}))}:($r(`Unknown field for ${n}. Cannot calculate view size.`),null)}}}return{signal:this.signalNameMap.get(this.getName(e))}}lookupDataSource(e){let n=this.component.data.outputNodes[e];return n?n.getSource():e}getSignalName(e){return this.signalNameMap.get(e)}renameSignal(e,n){this.signalNameMap.rename(e,n)}renameScale(e,n){this.scaleNameMap.rename(e,n)}renameProjection(e,n){this.projectionNameMap.rename(e,n)}scaleName(e,n){return n?this.getName(e):sTt(e)&&vk(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0}projectionName(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");let n=this.component.scales[e];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(e):void 0}getSelectionComponent(e,n){let r=this.component.selection[e];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(e,n)),!r)throw new Error(`Cannot find a selection named "${n}".`);return r}hasAxisOrientSignalRef(){var e,n;return((e=this.component.axes.x)===null||e===void 0?void 0:e.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(r=>r.hasOrientSignalRef()))}}class X7t extends Kvt{vgField(e,n={}){let r=this.fieldDef(e);if(r)return ii(r,n)}reduceFieldDef(e,n){return IAt(this.getMapping(),(r,a,s)=>{let h=jy(a);return h?e(r,h,s):r},n)}forEachFieldDef(e,n){Kyt(this.getMapping(),(r,a)=>{let s=jy(r);s&&e(s,a)},n)}}class pot extends au{constructor(e,n){var r,a,s;super(e),this.transform=n,this.transform=wo(n);let h=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(a=h[0])!==null&&a!==void 0?a:"value",(s=h[1])!==null&&s!==void 0?s:"density"]}clone(){return new pot(null,wo(this.transform))}dependentFields(){var e;return new Set([this.transform.density,...(e=this.transform.groupby)!==null&&e!==void 0?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${ss(this.transform)}`}assemble(){let e=this.transform,{density:n}=e,r=fa(e,["density"]);return Object.assign({type:"kde",field:n},r)}}class LW extends au{constructor(e,n){super(e),this.filter=n}clone(){return new LW(null,Object.assign({},this.filter))}static make(e,n){let{config:r,mark:a,markDef:s}=n;if(Fs("invalid",s,r)!=="filter")return null;let h=n.reduceFieldDef((d,g,b)=>{let _=vk(b)&&n.getScaleComponent(b);return _&&sg(_.get("type"))&&g.aggregate!=="count"&&!a9(a)&&(d[g.field]=g),d},{});return jr(h).length?new LW(e,h):null}dependentFields(){return new Set(jr(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${ss(this.filter)}`}assemble(){let e=jr(this.filter).reduce((n,r)=>{let a=this.filter[r],s=ii(a,{expr:"datum"});return a!==null&&(a.type==="temporal"?n.push(`(isDate(${s}) || (isValid(${s}) && isFinite(+${s})))`):a.type==="quantitative"&&(n.push(`isValid(${s})`),n.push(`isFinite(+${s})`))),n},[]);return e.length>0?{type:"filter",expr:e.join(" && ")}:null}}class mot extends au{constructor(e,n){super(e),this.transform=n,this.transform=wo(n);let{flatten:r,as:a=[]}=this.transform;this.transform.as=r.map((s,h)=>{var d;return(d=a[h])!==null&&d!==void 0?d:s})}clone(){return new mot(this.parent,wo(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${ss(this.transform)}`}assemble(){let{flatten:e,as:n}=this.transform;return{type:"flatten",fields:e,as:n}}}class got extends au{constructor(e,n){var r,a,s;super(e),this.transform=n,this.transform=wo(n);let h=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(a=h[0])!==null&&a!==void 0?a:"key",(s=h[1])!==null&&s!==void 0?s:"value"]}clone(){return new got(null,wo(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${ss(this.transform)}`}assemble(){let{fold:e,as:n}=this.transform;return{type:"fold",fields:e,as:n}}}class DM extends au{constructor(e,n,r,a){super(e),this.fields=n,this.geojson=r,this.signal=a}clone(){return new DM(null,wo(this.fields),this.geojson,this.signal)}static parseAll(e,n){if(n.component.projection&&!n.component.projection.isFit)return e;let r=0;for(let a of[[Dy,My],[ig,z1]]){let s=a.map(h=>{let d=sh(n.encoding[h]);return gi(d)?d.field:kk(d)?{expr:`${d.datum}`}:F3(d)?{expr:`${d.value}`}:void 0});(s[0]||s[1])&&(e=new DM(e,s,null,n.getName("geojson_"+r++)))}if(n.channelHasField(qp)){let a=n.typedFieldDef(qp);a.type===wM&&(e=new DM(e,null,a.field,n.getName("geojson_"+r++)))}return e}dependentFields(){var e;let n=((e=this.fields)!==null&&e!==void 0?e:[]).filter(bo);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${ss(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class $W extends au{constructor(e,n,r,a){super(e),this.projection=n,this.fields=r,this.as=a}clone(){return new $W(null,this.projection,wo(this.fields),wo(this.as))}static parseAll(e,n){if(!n.projectionName())return e;for(let r of[[Dy,My],[ig,z1]]){let a=r.map(h=>{let d=sh(n.encoding[h]);return gi(d)?d.field:kk(d)?{expr:`${d.datum}`}:F3(d)?{expr:`${d.value}`}:void 0}),s=r[0]===ig?"2":"";(a[0]||a[1])&&(e=new $W(e,n.projectionName(),a,[n.getName("x"+s),n.getName("y"+s)]))}return e}dependentFields(){return new Set(this.fields.filter(bo))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${ss(this.fields)} ${ss(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class S9 extends au{constructor(e,n){super(e),this.transform=n}clone(){return new S9(null,wo(this.transform))}dependentFields(){var e;return new Set([this.transform.impute,this.transform.key,...(e=this.transform.groupby)!==null&&e!==void 0?e:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(e){let{start:n=0,stop:r,step:a}=e;return{signal:`sequence(${[n,r,...a?[a]:[]].join(",")})`}}static makeFromTransform(e,n){return new S9(e,n)}static makeFromEncoding(e,n){let r=n.encoding,a=r.x,s=r.y;if(gi(a)&&gi(s)){let h=a.impute?a:s.impute?s:void 0;if(h===void 0)return;let d=a.impute?s:s.impute?a:void 0,{method:g,value:b,frame:_,keyvals:E}=h.impute,I=NAt(n.mark,r);return new S9(e,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:h.field,key:d.field},g?{method:g}:{}),b!==void 0?{value:b}:{}),_?{frame:_}:{}),E!==void 0?{keyvals:E}:{}),I.length?{groupby:I}:{}))}return null}hash(){return`Impute ${ss(this.transform)}`}assemble(){let{impute:e,key:n,keyvals:r,method:a,groupby:s,value:h,frame:d=[null,null]}=this.transform,g=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:e,key:n},r?{keyvals:(b=r,b?.stop!==void 0?this.processSequence(r):r)}:{}),{method:"value"}),s?{groupby:s}:{}),{value:a&&a!=="value"?null:h});var b;return a&&a!=="value"?[g,Object.assign({type:"window",as:[`imputed_${e}_value`],ops:[a],fields:[e],frame:d,ignorePeers:!1},s?{groupby:s}:{}),{type:"formula",expr:`datum.${e} === null ? datum.imputed_${e}_value : datum.${e}`,as:e}]:[g]}}class yot extends au{constructor(e,n){var r,a,s;super(e),this.transform=n,this.transform=wo(n);let h=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(a=h[0])!==null&&a!==void 0?a:n.on,(s=h[1])!==null&&s!==void 0?s:n.loess]}clone(){return new yot(null,wo(this.transform))}dependentFields(){var e;return new Set([this.transform.loess,this.transform.on,...(e=this.transform.groupby)!==null&&e!==void 0?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${ss(this.transform)}`}assemble(){let e=this.transform,{loess:n,on:r}=e,a=fa(e,["loess","on"]);return Object.assign({type:"loess",x:r,y:n},a)}}class zW extends au{constructor(e,n,r){super(e),this.transform=n,this.secondary=r}clone(){return new zW(null,wo(this.transform),this.secondary)}static make(e,n,r,a){let s=n.component.data.sources,{from:h}=r,d=null;if(function(g){return"data"in g}(h)){let g=J7t(h.data,s);g||(g=new AM(h.data),s.push(g));let b=n.getName(`lookup_${a}`);d=new Vf(g,b,"lookup",n.component.data.outputNodeRefCounts),n.component.data.outputNodes[b]=d}else if(function(g){return"selection"in g}(h)){let g=h.selection;if(r=Object.assign({as:g},r),d=n.getSelectionComponent(ul(g),g).materialized,!d)throw new Error(`Cannot define and lookup the "${g}" selection in the same view. Try moving the lookup into a second, layered view?`)}return new zW(e,r,d.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?ec(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${ss({transform:this.transform,secondary:this.secondary})}`}assemble(){let e;if(this.transform.from.fields)e=Object.assign({values:this.transform.from.fields},this.transform.as?{as:ec(this.transform.as)}:{});else{let n=this.transform.as;bo(n)||($r('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),n="_lookup"),e={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e),this.transform.default?{default:this.transform.default}:{})}}class vot extends au{constructor(e,n){var r,a,s;super(e),this.transform=n,this.transform=wo(n);let h=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(a=h[0])!==null&&a!==void 0?a:"prob",(s=h[1])!==null&&s!==void 0?s:"value"]}clone(){return new vot(null,wo(this.transform))}dependentFields(){var e;return new Set([this.transform.quantile,...(e=this.transform.groupby)!==null&&e!==void 0?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${ss(this.transform)}`}assemble(){let e=this.transform,{quantile:n}=e,r=fa(e,["quantile"]);return Object.assign({type:"quantile",field:n},r)}}class bot extends au{constructor(e,n){var r,a,s;super(e),this.transform=n,this.transform=wo(n);let h=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(a=h[0])!==null&&a!==void 0?a:n.on,(s=h[1])!==null&&s!==void 0?s:n.regression]}clone(){return new bot(null,wo(this.transform))}dependentFields(){var e;return new Set([this.transform.regression,this.transform.on,...(e=this.transform.groupby)!==null&&e!==void 0?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${ss(this.transform)}`}assemble(){let e=this.transform,{regression:n,on:r}=e,a=fa(e,["regression","on"]);return Object.assign({type:"regression",x:r,y:n},a)}}class wot extends au{constructor(e,n){super(e),this.transform=n}clone(){return new wot(null,wo(this.transform))}addDimensions(e){var n;this.transform.groupby=uk(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(e),r=>r)}producedFields(){}dependentFields(){var e;return new Set([this.transform.pivot,this.transform.value,...(e=this.transform.groupby)!==null&&e!==void 0?e:[]])}hash(){return`PivotTransform ${ss(this.transform)}`}assemble(){let{pivot:e,value:n,groupby:r,limit:a,op:s}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:e,value:n},a!==void 0?{limit:a}:{}),s!==void 0?{op:s}:{}),r!==void 0?{groupby:r}:{})}}class xot extends au{constructor(e,n){super(e),this.transform=n}clone(){return new xot(null,wo(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${ss(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function K7t(t){let e=0;return function n(r,a){var s;if(r instanceof AM&&!r.isGenerator&&!SW(r.data)&&(t.push(a),a={name:null,source:a.name,transform:[]}),r instanceof ff&&(r.parent instanceof AM&&!a.source?(a.format=Object.assign(Object.assign({},(s=a.format)!==null&&s!==void 0?s:{}),{parse:r.assembleFormatParse()}),a.transform.push(...r.assembleTransforms(!0))):a.transform.push(...r.assembleTransforms())),r instanceof IM){a.name||(a.name="data_"+e++),!a.source||a.transform.length>0?(t.push(a),r.data=a.name):r.data=a.source;for(let h of r.assemble())t.push(h)}else switch((r instanceof FW||r instanceof OW||r instanceof LW||r instanceof _M||r instanceof CM||r instanceof $W||r instanceof DM||r instanceof U1||r instanceof zW||r instanceof NM||r instanceof k9||r instanceof got||r instanceof mot||r instanceof pot||r instanceof yot||r instanceof vot||r instanceof bot||r instanceof Tk||r instanceof xot||r instanceof wot)&&a.transform.push(r.assemble()),(r instanceof Gy||r instanceof Wy||r instanceof S9||r instanceof j3)&&a.transform.push(...r.assemble()),r instanceof Vf&&(a.source&&a.transform.length===0?r.setSource(a.source):r.parent instanceof Vf?r.setSource(a.name):(a.name||(a.name="data_"+e++),r.setSource(a.name),r.numChildren()===1&&(t.push(a),a={name:null,source:a.name,transform:[]}))),r.numChildren()){case 0:r instanceof Vf&&(!a.source||a.transform.length>0)&&t.push(a);break;case 1:n(r.children[0],a);break;default:{a.name||(a.name="data_"+e++);let h=a.name;!a.source||a.transform.length>0?t.push(a):h=a.source;for(let d of r.children)n(d,{name:null,source:h,transform:[]});break}}}}function nJt(t){return t==="top"||t==="left"||Ua(t)?"header":"footer"}function rJt(t,e){var n;let{facet:r,config:a,child:s,component:h}=t;if(t.channelHasField(e)){let d=r[e],g=TM("title",null,a,e),b=f9(d,a,{allowDisabling:!0,includeDefault:g===void 0||!!g});s.component.layoutHeaders[e].title&&(b=ka(b)?b.join(", "):b,b+=" / "+s.component.layoutHeaders[e].title,s.component.layoutHeaders[e].title=null);let _=TM("labelOrient",d,a,e),E=Tc(((n=d.header)!==null&&n!==void 0?n:{}).labels,a.header.labels,!0),I=Aa(["bottom","right"],_)?"footer":"header";h.layoutHeaders[e]={title:b,facetFieldDef:d,[I]:e==="facet"?[]:[Z7t(t,e,E)]}}}function Z7t(t,e,n){let r=e==="row"?"height":"width";return{labels:n,sizeSignal:t.child.component.layoutSize.get(r)?t.child.getSizeSignalRef(r):void 0,axes:[]}}function Q7t(t,e){var n;let{child:r}=t;if(r.component.axes[e]){let{layoutHeaders:a,resolve:s}=t.component;if(s.axis[e]=$vt(s,e),s.axis[e]==="shared"){let h=e==="x"?"column":"row",d=a[h];for(let g of r.component.axes[e]){let b=nJt(g.get("orient"));d[b]=(n=d[b])!==null&&n!==void 0?n:[Z7t(t,h,!1)];let _=RW(g,"main",t.config,{header:!0});_&&d[b][0].axes.push(_),g.mainExtracted=!0}}}}function iJt(t){Zvt(t);let e=t.layout.columns===1?"width":"childWidth",n=t.layout.columns===void 0?"height":"childHeight";kot(t,e),kot(t,n)}function Zvt(t){for(let e of t.children)e.parseLayoutSize()}function kot(t,e){let n=d7t(e),r=Cat(n),a=t.component.resolve,s=t.component.layoutSize,h;for(let d of t.children){let g=d.component.layoutSize.getWithExplicit(n),b=a.scale[r];if(b==="independent"&&g.value==="step"){h=void 0;break}if(h){if(b==="independent"&&h.value!==g.value){h=void 0;break}h=_k(h,g,n,"")}else h=g}if(h){for(let d of t.children)t.renameSignal(d.getName(n),t.getName(e)),d.component.layoutSize.set(n,"merged",!1);s.setWithExplicit(e,h)}else s.setWithExplicit(e,{explicit:!1,value:void 0})}function aJt(t,e){let n=e==="width"?"x":"y",r=t.config,a=t.getScaleComponent(n);if(a){let s=a.get("type"),h=a.get("range");if(Xp(s)){let d=kW(r.view,e);return bk(h)||Uy(d)?"step":d}return ovt(r.view,e)}if(t.hasProjection||t.mark==="arc")return ovt(r.view,e);{let s=kW(r.view,e);return Uy(s)?s.step:s}}function Qvt(t,e,n){return ii(e,Object.assign({suffix:`by_${ii(t)}`},n??{}))}class PW extends X7t{constructor(e,n,r,a){super(e,"facet",n,r,a,e.resolve),this.child=nbt(e.spec,this,this.getName("child"),void 0,a),this.children=[this.child],this.facet=this.initFacet(e.facet,a)}initFacet(e,n){return vW(e)?IAt(e,(r,a,s)=>Aa([A3,I3],s)?a.field===void 0?($r(byt(a,s)),r):(r[s]=Hyt(a,s,n),r):($r(Iat(s,"facet")),r),{}):{facet:Hyt(e,"facet",n)}}channelHasField(e){return!!this.facet[e]}fieldDef(e){return this.facet[e]}parseData(){this.component.data=Sot(this),this.child.parseData()}parseLayoutSize(){Zvt(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(e){for(let n of ag)rJt(e,n);Q7t(e,"x"),Q7t(e,"y")}(this)}assembleSelectionTopLevelSignals(e){return this.child.assembleSelectionTopLevelSignals(e)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(e){return this.child.assembleSelectionData(e)}getHeaderLayoutMixins(){var e,n,r;let a={};for(let s of ag)for(let h of Fvt){let d=this.component.layoutHeaders[s],g=d[h],{facetFieldDef:b}=d;if(b){let _=TM("titleOrient",b,this.config,s);if(Aa(["right","bottom"],_)){let E=uot(s,_);a.titleAnchor=(e=a.titleAnchor)!==null&&e!==void 0?e:{},a.titleAnchor[E]="end"}}if(g?.[0]){let _=s==="row"?"height":"width",E=h==="header"?"headerBand":"footerBand";s==="facet"||this.child.component.layoutSize.get(_)||(a[E]=(n=a[E])!==null&&n!==void 0?n:{},a[E][s]=.5),d.title&&(a.offset=(r=a.offset)!==null&&r!==void 0?r:{},a.offset[s==="row"?"rowTitle":"columnTitle"]=10)}}return a}assembleDefaultLayout(){let{column:e,row:n}=this.facet,r=e?this.columnDistinctSignal():n?1:void 0,a="all";return(n||this.component.resolve.scale.x!=="independent")&&(e||this.component.resolve.scale.y!=="independent")||(a="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:a})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof PW))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(e){return this.parent&&this.parent instanceof PW?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:ii(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(e)):super.assembleGroup(e)}getCardinalityAggregateForChild(){let e=[],n=[],r=[];if(this.child instanceof PW){if(this.child.channelHasField("column")){let a=ii(this.child.facet.column);e.push(a),n.push("distinct"),r.push(`distinct_${a}`)}}else for(let a of og){let s=this.child.component.scales[a];if(s&&!s.merged){let h=s.get("type"),d=s.get("range");if(Xp(h)&&bk(d)){let g=Yvt(fot(this.child,a));g?(e.push(g),n.push("distinct"),r.push(`distinct_${g}`)):$r(`Unknown field for ${a}. Cannot calculate view size.`)}}}return{fields:e,ops:n,as:r}}assembleFacet(){let{name:e,data:n}=this.component.data.facetRoot,{row:r,column:a}=this.facet,{fields:s,ops:h,as:d}=this.getCardinalityAggregateForChild(),g=[];for(let _ of ag){let E=this.facet[_];if(E){g.push(ii(E));let{bin:I,sort:R}=E;if(Eu(I)&&g.push(ii(E,{binSuffix:"end"})),Py(R)){let{field:z,op:P=Oat}=R,rt=Qvt(E,R);r&&a?(s.push(rt),h.push("max"),d.push(rt)):(s.push(z),h.push(P),d.push(rt))}else if(ka(R)){let z=EM(E,_);s.push(z),h.push("max"),d.push(z)}}}let b=!!r&&!!a;return Object.assign({name:e,data:n,groupby:g},b||s.length>0?{aggregate:Object.assign(Object.assign({},b?{cross:b}:{}),s.length?{fields:s,ops:h,as:d}:{})}:{})}facetSortFields(e){let{facet:n}=this,r=n[e];return r?Py(r.sort)?[Qvt(r,r.sort,{expr:"datum"})]:ka(r.sort)?[EM(r,e,{expr:"datum"})]:[ii(r,{expr:"datum"})]:[]}facetSortOrder(e){let{facet:n}=this,r=n[e];if(r){let{sort:a}=r;return[(Py(a)?a.order:!ka(a)&&a)||"ascending"]}return[]}assembleLabelTitle(){let{facet:e,config:n}=this;if(e.facet)return Ovt(e.facet,"facet",n);let r={row:["top","bottom"],column:["left","right"]};for(let a of Rvt)if(e[a]){let s=TM("labelOrient",e[a],n,a);if(Aa(r[a],s))return Ovt(e[a],a,n)}}assembleMarks(){let{child:e}=this,n=function(d){let g=[],b=K7t(g);for(let _ of d.children)b(_,{source:d.name,name:null,transform:[]});return g}(this.component.data.facetRoot),r=e.assembleGroupEncodeEntry(!1),a=this.assembleLabelTitle()||e.assembleTitle(),s=e.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},a?{title:a}:{}),s?{style:s}:{}),{from:{facet:this.assembleFacet()},sort:{field:ag.map(d=>this.facetSortFields(d)).flat(),order:ag.map(d=>this.facetSortOrder(d)).flat()}}),n.length>0?{data:n}:{}),r?{encode:{update:r}}:{}),e.assembleGroup(function(d,g){if(d.component.selection&&jr(d.component.selection).length){let b=Vo(d.getName("cell"));g.unshift({name:"facet",value:{},on:[{events:e9("mousemove","scope"),update:`isTuple(facet) ? facet : group(${b}).datum`}]})}return vvt(g)}(this,[])))]}getMapping(){return this.facet}}function J7t(t,e){var n,r,a,s,h,d,g,b,_,E;for(let I of e){let R=I.data;if((!t.name||!I.hasName()||t.name===I.dataName)&&!(!((n=t.format)===null||n===void 0)&&n.mesh&&(!((r=R.format)===null||r===void 0)&&r.feature)||(!((a=t.format)===null||a===void 0)&&a.feature||!((s=R.format)===null||s===void 0)&&s.feature)&&((h=t.format)===null||h===void 0?void 0:h.feature)!==((d=R.format)===null||d===void 0?void 0:d.feature)||(!((g=t.format)===null||g===void 0)&&g.mesh||!((b=R.format)===null||b===void 0)&&b.mesh)&&((_=t.format)===null||_===void 0?void 0:_.mesh)!==((E=R.format)===null||E===void 0?void 0:E.mesh))){if(Xat(t)&&Xat(R)){if(oW(t.values,R.values))return I}else if(SW(t)&&SW(R)){if(t.url===R.url)return I}else if(uIt(t)&&t.name===I.dataName)return I}}return null}function oJt(t,e){if(t.data||!t.parent){if(t.data===null){let r=new AM({values:[]});return e.push(r),r}let n=J7t(t.data,e);if(n)return v9(t.data)||(n.data.format=function(r,...a){for(let s of a)yXt(r,s??{});return r}({},t.data.format,n.data.format)),!n.hasName()&&t.data.name&&(n.dataName=t.data.name),n;{let r=new AM(t.data);return e.push(r),r}}return t.parent.component.data.facetRoot?t.parent.component.data.facetRoot:t.parent.component.data.main}function Sot(t){var e,n,r,a,s,h,d,g,b,_;let E=oJt(t,t.component.data.sources),{outputNodes:I,outputNodeRefCounts:R}=t.component.data,z=t.parent?t.parent.component.data.ancestorParse.clone():new tZt,P=t.data;v9(P)?(lIt(P)?E=new OW(E,P.sequence):hvt(P)&&(E=new FW(E,P.graticule)),z.parseNothing=!0):((e=P?.format)===null||e===void 0?void 0:e.parse)===null&&(z.parseNothing=!0),E=(n=ff.makeExplicit(E,t,z))!==null&&n!==void 0?n:E,E=new Tk(E);let rt=t.parent&&MM(t.parent);(Bl(t)||V1(t))&&rt&&(E=(r=Gy.makeFromEncoding(E,t))!==null&&r!==void 0?r:E),t.transforms.length>0&&(E=function(Ot,Wt,jt){var Ht,Vt;let fe=0;for(let se of Wt.transforms){let he,_e;if(hZt(se))_e=Ot=new CM(Ot,se),he="derived";else if(hIt(se)){let Ve=FQt(se);_e=Ot=(Ht=ff.makeWithAncestors(Ot,{},Ve,jt))!==null&&Ht!==void 0?Ht:Ot,Ot=new _M(Ot,Wt,se.filter)}else if(dZt(se))_e=Ot=Gy.makeFromTransform(Ot,se,Wt),he="number";else if(pZt(se))he="date",jt.getWithExplicit(se.field).value===void 0&&(Ot=new ff(Ot,{[se.field]:he}),jt.set(se.field,he,!1)),_e=Ot=Wy.makeFromTransform(Ot,se);else if(mZt(se))_e=Ot=U1.makeFromTransform(Ot,se),he="number",wvt(Wt)&&(Ot=new Tk(Ot));else if(eZt(se))_e=Ot=zW.make(Ot,Wt,se,fe++),he="derived";else if(uZt(se))_e=Ot=new NM(Ot,se),he="number";else if(lZt(se))_e=Ot=new k9(Ot,se),he="number";else if(gZt(se))_e=Ot=j3.makeFromTransform(Ot,se),he="derived";else if(yZt(se))_e=Ot=new got(Ot,se),he="derived";else if(cZt(se))_e=Ot=new mot(Ot,se),he="derived";else if(nZt(se))_e=Ot=new wot(Ot,se),he="derived";else if(sZt(se))Ot=new xot(Ot,se);else if(fZt(se))_e=Ot=S9.makeFromTransform(Ot,se),he="derived";else if(rZt(se))_e=Ot=new pot(Ot,se),he="derived";else if(iZt(se))_e=Ot=new vot(Ot,se),he="derived";else if(aZt(se))_e=Ot=new bot(Ot,se),he="derived";else{if(!oZt(se)){$r(GXt(se));continue}_e=Ot=new yot(Ot,se),he="derived"}if(_e&&he!==void 0)for(let Ve of(Vt=_e.producedFields())!==null&&Vt!==void 0?Vt:[])jt.set(Ve,he,!1)}return Ot}(E,t,z));let ot=function(Ot){let Wt={};if(Bl(Ot)&&Ot.component.selection)for(let jt of jr(Ot.component.selection)){let Ht=Ot.component.selection[jt];for(let Vt of Ht.project.items)!Vt.channel&&cW(Vt.field)>1&&(Wt[Vt.field]="flatten")}return Wt}(t),at=OQt(t);E=(a=ff.makeWithAncestors(E,{},Object.assign(Object.assign({},ot),at),z))!==null&&a!==void 0?a:E,Bl(t)&&(E=DM.parseAll(E,t),E=$W.parseAll(E,t)),(Bl(t)||V1(t))&&(rt||(E=(s=Gy.makeFromEncoding(E,t))!==null&&s!==void 0?s:E),E=(h=Wy.makeFromEncoding(E,t))!==null&&h!==void 0?h:E,E=CM.parseAllForSortIndex(E,t));let dt=t.getName(Kat),ct=new Vf(E,dt,Kat,R);if(I[dt]=ct,E=ct,Bl(t)){let Ot=U1.makeFromEncoding(E,t);Ot&&(E=Ot,wvt(t)&&(E=new Tk(E))),E=(d=S9.makeFromEncoding(E,t))!==null&&d!==void 0?d:E,E=(g=j3.makeFromEncoding(E,t))!==null&&g!==void 0?g:E}Bl(t)&&(E=(b=LW.make(E,t))!==null&&b!==void 0?b:E);let Ct=t.getName(uf),Et=new Vf(E,Ct,uf,R);I[Ct]=Et,E=Et,Bl(t)&&function(Ot,Wt){w9(Ot,jt=>{let Ht=jt.name,Vt=Ot.getName(`lookup_${Ht}`);Ot.component.data.outputNodes[Vt]=jt.materialized=new Vf(new _M(Wt,Ot,{selection:Ht}),Vt,"lookup",Ot.component.data.outputNodeRefCounts)})}(t,Et);let Rt=null;if(V1(t)){let Ot=t.getName("facet");E=(_=function(Wt,jt){let{row:Ht,column:Vt}=jt;if(Ht&&Vt){let fe=null;for(let se of[Ht,Vt])if(Py(se.sort)){let{field:he,op:_e=Oat}=se.sort;Wt=fe=new k9(Wt,{joinaggregate:[{op:_e,field:he,as:Qvt(se,se.sort,{forAs:!0})}],groupby:[ii(se)]})}return fe}return null}(E,t.facet))!==null&&_!==void 0?_:E,Rt=new IM(E,t,Ot,Et.getSource()),I[Ot]=Rt}return Object.assign(Object.assign({},t.component.data),{outputNodes:I,outputNodeRefCounts:R,raw:ct,main:Et,facetRoot:Rt,ancestorParse:z})}class sJt extends Kvt{constructor(e,n,r,a){var s,h,d,g;super(e,"concat",n,r,a,e.resolve),((h=(s=e.resolve)===null||s===void 0?void 0:s.axis)===null||h===void 0?void 0:h.x)!=="shared"&&((g=(d=e.resolve)===null||d===void 0?void 0:d.axis)===null||g===void 0?void 0:g.y)!=="shared"||$r("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(e).map((b,_)=>nbt(b,this,this.getName("concat_"+_),void 0,a))}parseData(){this.component.data=Sot(this);for(let e of this.children)e.parseData()}parseSelections(){this.component.selection={};for(let e of this.children){e.parseSelections();for(let n of jr(e.component.selection))this.component.selection[n]=e.component.selection[n]}}parseMarkGroup(){for(let e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){for(let e of this.children)e.parseAxesAndHeaders()}getChildren(e){return Gat(e)?e.vconcat:avt(e)?e.hconcat:e.concat}parseLayoutSize(){iJt(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(e){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),e)}assembleSignals(){return this.children.forEach(e=>e.assembleSignals()),[]}assembleLayoutSignals(){let e=Lvt(this);for(let n of this.children)e.push(...n.assembleLayoutSignals());return e}assembleSelectionData(e){return this.children.reduce((n,r)=>r.assembleSelectionData(n),e)}assembleMarks(){return this.children.map(e=>{let n=e.assembleTitle(),r=e.assembleGroupStyle(),a=e.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:e.getName("group")},n?{title:n}:{}),r?{style:r}:{}),a?{encode:{update:a}}:{}),e.assembleGroup())})}assembleDefaultLayout(){let e=this.layout.columns;return Object.assign(Object.assign({},e!=null?{columns:e}:{}),{bounds:"full",align:"each"})}}let uJt=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},YEt),{labelExpr:1,encode:1}),tNt=jr(uJt);class Jvt extends L3{constructor(e={},n={},r=!1){super(),this.explicit=e,this.implicit=n,this.mainExtracted=r}clone(){return new Jvt(wo(this.explicit),wo(this.implicit),this.mainExtracted)}hasAxisPart(e){return e==="axis"||(e==="grid"||e==="title"?!!this.get(e):!((n=this.get(e))===!1||n===null));var n}hasOrientSignalRef(){return Ua(this.explicit.orient)}}let lJt={bottom:"top",top:"bottom",left:"right",right:"left"};function cJt(t,e){if(!t)return e.map(n=>n.clone());{if(t.length!==e.length)return;let n=t.length;for(let r=0;r<n;r++){let a=t[r],s=e[r];if(!!a!=!!s)return;if(a&&s){let h=a.getWithExplicit("orient"),d=s.getWithExplicit("orient");if(h.explicit&&d.explicit&&h.value!==d.value)return;t[r]=hJt(a,s)}}}return t}function hJt(t,e){for(let n of tNt){let r=_k(t.getWithExplicit(n),e.getWithExplicit(n),n,"axis",(a,s)=>{switch(n){case"title":return AAt(a,s);case"gridScale":return{explicit:a.explicit,value:Tc(a.value,s.value)}}return qat(a,s,n,"axis")});t.setWithExplicit(n,r)}return t}function dJt(t,e,n,r,a){if(e==="disable")return n!==void 0;switch(n=n||{},e){case"titleAngle":case"labelAngle":return t===(Ua(n.labelAngle)?n.labelAngle:fat(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(t===o7t(r,a))return!0}return t===n[e]}let fJt=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function pJt(t,e){var n,r,a;let s=e.axis(t),h=new Jvt,d=sh(e.encoding[t]),{mark:g,config:b}=e,_=s?.orient||((n=b[t==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((r=b.axis)===null||r===void 0?void 0:r.orient)||function(at){return at==="x"?"bottom":"left"}(t),E=e.getScaleComponent(t).get("type"),I=mQt(t,E,_,e.config),R=s!==void 0?!s:Mvt("disable",b,s?.style,I).configValue;if(h.set("disable",R,s!==void 0),R)return h;s=s||{};let z=function(at,dt,ct,Ct,Et){let Rt=dt?.labelAngle;if(Rt!==void 0)return Ua(Rt)?Rt:fat(Rt);{let{configValue:Ot}=Mvt("labelAngle",at.config,dt?.style,Et);return Ot!==void 0?fat(Ot):ct===kl&&Aa([Myt,Nyt],Ct.type)?270:void 0}}(e,s,t,d,I),P={fieldOrDatumDef:d,axis:s,channel:t,model:e,scaleType:E,orient:_,labelAngle:z,mark:g,config:b};for(let at of tNt){let dt=at in r7t?r7t[at](P):qEt(at)?s[at]:void 0,ct=dt!==void 0,Ct=dJt(dt,at,s,e,t);if(ct&&Ct)h.set(at,dt,Ct);else{let{configValue:Et,configFrom:Rt}=qEt(at)&&at!=="values"?Mvt(at,e.config,s.style,I):{},Ot=Et!==void 0;ct&&!Ot?h.set(at,dt,Ct):(Rt!=="vgAxisConfig"||fJt.has(at)&&Ot||lyt(Et)||Ua(Et))&&h.set(at,Et,!1)}}let rt=(a=s.encoding)!==null&&a!==void 0?a:{},ot=HEt.reduce((at,dt)=>{var ct;if(!h.hasAxisPart(dt))return at;let Ct=f7t((ct=rt[dt])!==null&&ct!==void 0?ct:{},e),Et=dt==="labels"?function(Rt,Ot,Wt){var jt;let{encoding:Ht,config:Vt}=Rt,fe=(jt=sh(Ht[Ot]))!==null&&jt!==void 0?jt:sh(Ht[Oy(Ot)]),se=Rt.axis(Ot)||{},{format:he,formatType:_e}=se;return d9(_e)?Object.assign({text:$yt({fieldOrDatumDef:fe,field:"datum.value",format:he,formatType:_e,config:Vt})},Wt):Wt}(e,t,Ct):Ct;return Et===void 0||yu(Et)||(at[dt]={update:Et}),at},{});return yu(ot)||h.set("encode",ot,!!s.encoding||s.labelAngle!==void 0),h}function mJt(t,e,n,{graticule:r}){let a=Ay(t)?Object.assign({},t):{type:t},s=Fs("orient",a,n);if(a.orient=function(h,d,g){switch(h){case yat:case hyt:case dyt:case KEt:case SXt:case kXt:return}let{x:b,y:_,x2:E,y2:I}=d;switch(h){case mat:if(gi(b)&&(Uf(b.bin)||gi(_)&&_.aggregate&&!b.aggregate))return"vertical";if(gi(_)&&(Uf(_.bin)||gi(b)&&b.aggregate&&!_.aggregate))return"horizontal";if(I||E){if(g)return g;if(!E&&(gi(b)&&b.type===c9&&!Eu(b.bin)||Uyt(b)))return"horizontal";if(!I&&(gi(_)&&_.type===c9&&!Eu(_.bin)||Uyt(_)))return"vertical"}case vat:if(E&&(!gi(b)||!Uf(b.bin))&&I&&(!gi(_)||!Uf(_.bin)))return;case pat:if(I)return gi(_)&&Uf(_.bin)?"horizontal":"vertical";if(E)return gi(b)&&Uf(b.bin)?"vertical":"horizontal";if(h===vat){if(b&&!_)return"vertical";if(_&&!b)return"horizontal"}case gat:case cyt:{let R=By(b),z=By(_);if(R&&!z)return h!=="tick"?"horizontal":"vertical";if(!R&&z)return h!=="tick"?"vertical":"horizontal";if(R&&z){let P=b,rt=_,ot=P.type===bM,at=rt.type===bM;return ot&&!at?h!=="tick"?"vertical":"horizontal":!ot&&at?h!=="tick"?"horizontal":"vertical":!P.aggregate&&rt.aggregate?h!=="tick"?"vertical":"horizontal":P.aggregate&&!rt.aggregate?h!=="tick"?"horizontal":"vertical":g||"vertical"}return g||void 0}}return"vertical"}(a.type,e,s),s!==void 0&&s!==a.orient&&$r(`Specified orient "${a.orient}" overridden with "${s}".`),a.type==="bar"&&a.orient){let h=Fs("cornerRadiusEnd",a,n);if(h!==void 0){let d=a.orient==="horizontal"&&e.x2||a.orient==="vertical"&&e.y2?["cornerRadius"]:EXt[a.orient];for(let g of d)a[g]=h;a.cornerRadiusEnd!==void 0&&delete a.cornerRadiusEnd}}return Fs("opacity",a,n)===void 0&&(a.opacity=function(h,d){if(Aa([yat,cyt,hyt,dyt],h)&&!qyt(d))return .7}(a.type,e)),a.filled===void 0&&(a.filled=!r&&function(h,d){let g=m9("filled",h,d),b=h.type;return Tc(g,b!==yat&&b!==gat&&b!==vat)}(a,n)),Fs("cursor",a,n)===void 0&&(a.cursor=function(h,d,g){return d.href||h.href||Fs("href",h,g)?"pointer":h.cursor}(a,e,n)),a}function tbt(t,e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ug(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),lf("x",t,{defaultPos:"mid"})),lf("y",t,{defaultPos:"mid"})),jh("size",t)),jh("angle",t)),function(n,r,a){return a?{shape:{value:a}}:jh("shape",n)}(t,0,e))}let gJt={vgMark:"rule",encodeEntry:t=>{let{markDef:e}=t,n=e.orient;return t.encoding.x||t.encoding.y||t.encoding.latitude||t.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},ug(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Jat("x",t,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),Jat("y",t,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),jh("size",t,{vgChannel:"strokeWidth"})):{}}},yJt={vgMark:"text",encodeEntry:t=>{let{config:e}=t;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ug(t,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),lf("x",t,{defaultPos:"mid"})),lf("y",t,{defaultPos:"mid"})),dvt(t)),jh("size",t,{vgChannel:"fontSize"})),jh("angle",t)),wIt("align",function(n,r,a){if(Fs("align",n,a)===void 0)return"center"}(t.markDef,0,e))),wIt("baseline",function(n,r,a){if(Fs("baseline",n,a)===void 0)return"middle"}(t.markDef,0,e))),lf("radius",t,{defaultPos:null,isMidPoint:!0})),lf("theta",t,{defaultPos:null,isMidPoint:!0}))}},vJt={vgMark:"rect",encodeEntry:t=>{let{config:e,markDef:n}=t,r=n.orient,a=r==="horizontal"?"width":"height",s=r==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ug(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),lf("x",t,{defaultPos:"mid",vgChannel:"xc"})),lf("y",t,{defaultPos:"mid",vgChannel:"yc"})),jh("size",t,{defaultValue:bJt(t),vgChannel:a})),{[s]:nc(Fs("thickness",n,e))})}};function bJt(t){var e;let{config:n,markDef:r}=t,{orient:a}=r,s=a==="horizontal"?"width":"height",h=t.getScaleComponent(a==="horizontal"?"x":"y"),d=(e=Fs("size",r,n,{vgChannel:s}))!==null&&e!==void 0?e:n.tick.bandSize;if(d!==void 0)return d;{let g=h?h.get("range"):void 0;return g&&bk(g)&&Ec(g.step)?3*g.step/4:3*Hat(n.view,s)/4}}let _ot={arc:{vgMark:"arc",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ug(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),lf("x",t,{defaultPos:"mid"})),lf("y",t,{defaultPos:"mid"})),Ck(t,"radius","arc")),Ck(t,"theta","arc"))},area:{vgMark:"area",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign({},ug(t,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),Jat("x",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:t.markDef.orient==="horizontal"})),Jat("y",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:t.markDef.orient==="vertical"})),pvt(t))},bar:{vgMark:"rect",encodeEntry:t=>Object.assign(Object.assign(Object.assign({},ug(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Ck(t,"x","bar")),Ck(t,"y","bar"))},circle:{vgMark:"symbol",encodeEntry:t=>tbt(t,"circle")},geoshape:{vgMark:"shape",encodeEntry:t=>Object.assign({},ug(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:t=>{let{encoding:e}=t,n=e.shape;return[Object.assign({type:"geoshape",projection:t.projectionName()},n&&gi(n)&&n.type===wM?{field:ii(n,{expr:"datum"})}:{})]}},image:{vgMark:"image",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign({},ug(t,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),Ck(t,"x","image")),Ck(t,"y","image")),dvt(t,"url"))},line:{vgMark:"line",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ug(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),lf("x",t,{defaultPos:"mid"})),lf("y",t,{defaultPos:"mid"})),jh("size",t,{vgChannel:"strokeWidth"})),pvt(t))},point:{vgMark:"symbol",encodeEntry:t=>tbt(t)},rect:{vgMark:"rect",encodeEntry:t=>Object.assign(Object.assign(Object.assign({},ug(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Ck(t,"x","rect")),Ck(t,"y","rect"))},rule:gJt,square:{vgMark:"symbol",encodeEntry:t=>tbt(t,"square")},text:yJt,tick:vJt,trail:{vgMark:"trail",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ug(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),lf("x",t,{defaultPos:"mid"})),lf("y",t,{defaultPos:"mid"})),jh("size",t)),pvt(t))}};function wJt(t){return Aa([gat,pat,_Xt],t.mark)?function(e){let n=NAt(e.mark,e.encoding),r=Cot(e,{fromPrefix:n.length>0?eNt:""});return n.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:eNt+e.requestDataName(uf),data:e.requestDataName(uf),groupby:n}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:r}]:r}(t):Aa([mat],t.mark)?function(e){let n=Cyt.some(r=>Fs(r,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&n){let[r]=Cot(e,{fromPrefix:nNt}),a=e.scaleName(e.stack.fieldChannel),s=(E={})=>e.vgField(e.stack.fieldChannel,E),h=(E,I)=>`${E}(${[s({prefix:"min",suffix:"start",expr:I}),s({prefix:"max",suffix:"start",expr:I}),s({prefix:"min",suffix:"end",expr:I}),s({prefix:"max",suffix:"end",expr:I})].map(R=>`scale('${a}',${R})`).join(",")})`,d,g;e.stack.fieldChannel==="x"?(d=Object.assign(Object.assign({},sW(r.encode.update,["y","yc","y2","height",...Cyt])),{x:{signal:h("min","datum")},x2:{signal:h("max","datum")},clip:{value:!0}}),g={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},r.encode.update=Object.assign(Object.assign({},E3(r.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(d=Object.assign(Object.assign({},sW(r.encode.update,["x","xc","x2","width"])),{y:{signal:h("min","datum")},y2:{signal:h("max","datum")},clip:{value:!0}}),g={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},r.encode.update=Object.assign(Object.assign({},E3(r.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(let E of Cyt){let I=m9(E,e.markDef,e.config);r.encode.update[E]?(d[E]=r.encode.update[E],delete r.encode.update[E]):I&&(d[E]=nc(I)),I&&(r.encode.update[E]={value:0})}let b=e.fieldDef(e.stack.groupbyChannel),_=ii(b)?[ii(b)]:[];return(b?.bin||b?.timeUnit)&&_.push(ii(b,{binSuffix:"end"})),d=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((E,I)=>{if(r.encode.update[I])return Object.assign(Object.assign({},E),{[I]:r.encode.update[I]});{let R=m9(I,e.markDef,e.config);return R!==void 0?Object.assign(Object.assign({},E),{[I]:nc(R)}):E}},d),d.stroke&&(d.strokeForeground={value:!0},d.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(uf),name:nNt+e.requestDataName(uf),groupby:_,aggregate:{fields:[s({suffix:"start"}),s({suffix:"start"}),s({suffix:"end"}),s({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:d},marks:[{type:"group",encode:{update:g},marks:[r]}]}]}return Cot(e)}(t):Cot(t)}let eNt="faceted_path_",nNt="stack_group_";function Cot(t,e={fromPrefix:""}){let{mark:n,markDef:r,config:a}=t,s=Tc(r.clip,function(I){let R=I.getScaleComponent("x"),z=I.getScaleComponent("y");return!!(R&&R.get("selectionExtent")||z&&z.get("selectionExtent"))||void 0}(t),function(I){let R=I.component.projection;return!(!R||R.isFit)||void 0}(t)),h=SAt(r),d=t.encoding.key,g=function(I){let{encoding:R,stack:z,mark:P,markDef:rt,config:ot}=I,at=R.order;if(!(!ka(at)&&F3(at)&&$Et(at.value)||!at&&$Et(Fs("order",rt,ot)))){if((ka(at)||gi(at))&&!z)return CAt(at,{expr:"datum"});if(a9(P)){let dt=rt.orient==="horizontal"?"y":"x",ct=R[dt];if(gi(ct)){let Ct=ct.sort;return ka(Ct)?{field:ii(ct,{prefix:dt,suffix:"sort_index",expr:"datum"})}:Py(Ct)?{field:ii({aggregate:qyt(I.encoding)?Ct.op:void 0,field:Ct.field},{expr:"datum"})}:sAt(Ct)?{field:ii(I.fieldDef(Ct.encoding),{expr:"datum"}),order:Ct.order}:Ct===null?void 0:{field:ii(ct,{binSuffix:I.stack&&I.stack.impute?"mid":void 0,expr:"datum"})}}}}}(t),b=function(I){if(!I.component.selection)return null;let R=jr(I.component.selection).length,z=R,P=I.parent;for(;P&&z===0;)z=jr(P.component.selection).length,P=P.parent;return z?{interactive:R>0}:null}(t),_=Fs("aria",r,a),E=_ot[n].postEncodingTransform?_ot[n].postEncodingTransform(t):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:t.getName("marks"),type:_ot[n].vgMark},s?{clip:!0}:{}),h?{style:h}:{}),d?{key:d.field}:{}),g?{sort:g}:{}),b||{}),_===!1?{aria:_}:{}),{from:{data:e.fromPrefix+t.requestDataName(uf)},encode:{update:_ot[n].encodeEntry(t)}}),E?{transform:E}:{})]}class rNt extends X7t{constructor(e,n,r,a={},s){var h,d;super(e,"unit",n,r,s,void 0,VAt(e)?e.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];let g=Ay(e.mark)?e.mark.type:e.mark;this.markDef=mJt(e.mark,(h=e.encoding)!==null&&h!==void 0?h:{},s,{graticule:e.data&&hvt(e.data)});let b=this.encoding=EKt((d=e.encoding)!==null&&d!==void 0?d:{},this.markDef,s);this.size=function({encoding:_,size:E}){for(let I of og){let R=Ly(I);Uy(E[R])&&By(_[I])&&(delete E[R],$r(CTt(R)))}return E}({encoding:b,size:VAt(e)?Object.assign(Object.assign(Object.assign({},a),e.width?{width:e.width}:{}),e.height?{height:e.height}:{}):a}),this.stack=KAt(g,b),this.specifiedScales=this.initScales(g,b),this.specifiedAxes=this.initAxes(b),this.specifiedLegends=this.initLegend(b),this.specifiedProjection=e.projection,this.selection=e.selection}get hasProjection(){let{encoding:e}=this,n=this.mark===ZEt,r=e&&FXt.some(a=>Za(e[a]));return n||r}scaleDomain(e){let n=this.specifiedScales[e];return n?n.domain:void 0}axis(e){return this.specifiedAxes[e]}legend(e){return this.specifiedLegends[e]}initScales(e,n){return Eat.reduce((r,a)=>{var s;let h=sh(n[a]);return h&&(r[a]=(s=h.scale)!==null&&s!==void 0?s:{}),r},{})}initAxes(e){return og.reduce((n,r)=>{let a=e[r];if(Za(a)||r===kl&&Za(e.x2)||r===oh&&Za(e.y2)){let s=Za(a)?a.axis:void 0;n[r]=s&&Object.assign({},s)}return n},{})}initLegend(e){return BXt.reduce((n,r)=>{let a=sh(e[r]);if(a&&function(s){switch(s){case Yp:case Ry:case Fy:case D3:case qp:case R3:case pk:case mk:return!0;case dk:case fk:case s9:return!1}}(r)){let s=a.legend;n[r]=s&&Object.assign({},s)}return n},{})}parseData(){this.component.data=Sot(this)}parseLayoutSize(){(function(e){let{size:n,component:r}=e;for(let a of og){let s=Ly(a);if(n[s]){let h=n[s];r.layoutSize.set(s,Uy(h)?"step":h,!0)}else{let h=aJt(e,s);r.layoutSize.set(s,h,!1)}}})(this)}parseSelections(){this.component.selection=function(e,n){var r;let a={},s=e.config.selection;for(let h of jr(n??{})){let d=wo(n[h]),g=s[d.type],b=fa(g,["fields","encodings"]);for(let I in b)I==="encodings"&&d.fields||I==="fields"&&d.encodings||(I==="mark"&&(d[I]=Object.assign(Object.assign({},b[I]),d[I])),d[I]!==void 0&&d[I]!==!0||(d[I]=(r=b[I])!==null&&r!==void 0?r:d[I]));let _=ul(h),E=a[_]=Object.assign(Object.assign({},d),{name:_,events:bo(d.on)?e9(d.on,"scope"):wo(d.on)});not(E,I=>{I.has(E)&&I.parse&&I.parse(e,E,d,n[h])})}return a}(this,this.selection)}parseMarkGroup(){this.component.mark=wJt(this)}parseAxesAndHeaders(){var e;this.component.axes=(e=this,og.reduce((n,r)=>(e.component.scales[r]&&(n[r]=[pJt(r,e)]),n),{}))}assembleSelectionTopLevelSignals(e){return function(n,r){let a=!1;return w9(n,(s,h)=>{let d=s.name,g=Vo(d+b9);if(r.filter(_=>_.name===d).length===0){let _=s.resolve==="global"?"union":s.resolve,E=s.type==="multi"?", true)":")";r.push({name:s.name,update:`${FIt}(${g}, ${Vo(_)}${E}`})}a=!0,h.topLevelSignals&&(r=h.topLevelSignals(n,s,r)),not(s,_=>{_.topLevelSignals&&(r=_.topLevelSignals(n,s,r))})}),a&&r.filter(h=>h.name==="unit").length===0&&r.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),vvt(r)}(this,e)}assembleSignals(){return[...JIt(this),...(e=this,n=[],w9(e,(r,a)=>{let s=r.name,h=a.modifyExpr(e,r);n.push(...a.signals(e,r)),not(r,d=>{d.signals&&(n=d.signals(e,r,n)),d.modifyExpr&&(h=d.modifyExpr(e,r,h))}),n.push({name:s+OZt,on:[{events:{signal:r.name+Vy},update:`modify(${Vo(r.name+b9)}, ${h})`}]})}),vvt(n))];var e,n}assembleSelectionData(e){return function(n,r){let a=[...r];return w9(n,s=>{let h={name:s.name+b9};if(s.init){let d=s.project.items.map(b=>fa(b,["signals"])),g=s.init.map(b=>kM(b,!1));h.values=s.type==="interval"?[{unit:$3(n,{escape:!1}),fields:d,values:g}]:g.map(b=>({unit:$3(n,{escape:!1}),fields:d,values:b}))}a.filter(d=>d.name===s.name+b9).length||a.push(h)}),a}(this,e)}assembleLayout(){return null}assembleLayoutSignals(){return Lvt(this)}assembleMarks(){var e;let n=(e=this.component.mark)!==null&&e!==void 0?e:[];return this.parent&&MM(this.parent)||(n=MIt(this,n)),n.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(e){return g9(this.encoding,e)}fieldDef(e){return jy(this.encoding[e])}typedFieldDef(e){let n=this.fieldDef(e);return Z0(n)?n:null}}class ebt extends Kvt{constructor(e,n,r,a,s){super(e,"layer",n,r,s,e.resolve,e.view);let h=Object.assign(Object.assign(Object.assign({},a),e.width?{width:e.width}:{}),e.height?{height:e.height}:{});this.children=e.layer.map((d,g)=>{if(Yat(d))return new ebt(d,this,this.getName("layer_"+g),h,s);if(T3(d))return new rNt(d,this,this.getName("layer_"+g),h,s);throw new Error(vyt(d))})}parseData(){this.component.data=Sot(this);for(let e of this.children)e.parseData()}parseLayoutSize(){var e;Zvt(e=this),kot(e,"width"),kot(e,"height")}parseSelections(){this.component.selection={};for(let e of this.children){e.parseSelections();for(let n of jr(e.component.selection))this.component.selection[n]=e.component.selection[n]}}parseMarkGroup(){for(let e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){(function(e){var n;let{axes:r,resolve:a}=e.component,s={top:0,bottom:0,right:0,left:0};for(let h of e.children){h.parseAxesAndHeaders();for(let d of jr(h.component.axes))a.axis[d]=$vt(e.component.resolve,d),a.axis[d]==="shared"&&(r[d]=cJt(r[d],h.component.axes[d]),r[d]||(a.axis[d]="independent",delete r[d]))}for(let h of og){for(let d of e.children)if(d.component.axes[h]){if(a.axis[h]==="independent"){r[h]=((n=r[h])!==null&&n!==void 0?n:[]).concat(d.component.axes[h]);for(let g of d.component.axes[h]){let{value:b,explicit:_}=g.getWithExplicit("orient");if(!Ua(b)){if(s[b]>0&&!_){let E=lJt[b];s[b]>s[E]&&g.set("orient",E,!1)}s[b]++}}}delete d.component.axes[h]}if(a.axis[h]==="independent"&&r[h]&&r[h].length>1)for(let d of r[h])d.get("grid")&&!d.explicit.grid&&(d.implicit.grid=!1)}})(this)}assembleSelectionTopLevelSignals(e){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),e)}assembleSignals(){return this.children.reduce((e,n)=>e.concat(n.assembleSignals()),JIt(this))}assembleLayoutSignals(){return this.children.reduce((e,n)=>e.concat(n.assembleLayoutSignals()),Lvt(this))}assembleSelectionData(e){return this.children.reduce((n,r)=>r.assembleSelectionData(n),e)}assembleTitle(){let e=super.assembleTitle();if(e)return e;for(let n of this.children)if(e=n.assembleTitle(),e)return e}assembleLayout(){return null}assembleMarks(){return function(e,n){for(let r of e.children)Bl(r)&&(n=MIt(r,n));return n}(this,this.children.flatMap(e=>e.assembleMarks()))}assembleLegends(){return this.children.reduce((e,n)=>e.concat(n.assembleLegends()),_7t(this))}}function nbt(t,e,n,r,a){if(Lat(t))return new PW(t,e,n,a);if(Yat(t))return new ebt(t,e,n,r,a);if(T3(t))return new rNt(t,e,n,r,a);if(function(s){return Gat(s)||avt(s)||ivt(s)}(t))return new sJt(t,e,n,a);throw new Error(vyt(t))}function xJt(t,e={}){var n;e.logger&&(n=e.logger,mW=n),e.fieldTitle&&yAt(e.fieldTitle);try{let r=YAt(LEt(e.config,t.config)),a=iIt(t,r),s=nbt(a,null,"",void 0,r);return s.parse(),function(d,g){Bvt(d.sources);let b=0,_=0;for(let E=0;E<dot&&R7t(d,g);E++)b++;d.sources.map(Uvt);for(let E=0;E<dot&&R7t(d,g);E++)_++;Bvt(d.sources),Math.max(b,_)===dot&&$r(`Maximum optimization runs(${dot}) reached.`)}(s.component.data,s),{spec:function(d,g,b={},_){let E=d.config?jKt(d.config):void 0,I=[].concat(d.assembleSelectionData([]),function(at,dt){var ct,Ct;let Et=[],Rt=K7t(Et),Ot=0;for(let jt of at.sources){jt.hasName()||(jt.dataName="source_"+Ot++);let Ht=jt.assemble();Rt(jt,Ht)}for(let jt of Et)jt.transform.length===0&&delete jt.transform;let Wt=0;for(let[jt,Ht]of Et.entries())((ct=Ht.transform)!==null&&ct!==void 0?ct:[]).length!==0||Ht.source||Et.splice(Wt++,0,Et.splice(jt,1)[0]);for(let jt of Et)for(let Ht of(Ct=jt.transform)!==null&&Ct!==void 0?Ct:[])Ht.type==="lookup"&&(Ht.from=at.outputNodes[Ht.from].getSource());for(let jt of Et)jt.name in dt&&(jt.values=dt[jt.name]);return Et}(d.component.data,b)),R=d.assembleProjections(),z=d.assembleTitle(),P=d.assembleGroupStyle(),rt=d.assembleGroupEncodeEntry(!0),ot=d.assembleLayoutSignals();return ot=ot.filter(at=>at.name!=="width"&&at.name!=="height"||at.value===void 0||(g[at.name]=+at.value,!1)),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},d.description?{description:d.description}:{}),g),z?{title:z}:{}),P?{style:P}:{}),rt?{encode:{update:rt}}:{}),{data:I}),R.length>0?{projections:R}:{}),d.assembleGroup([...ot,...d.assembleSelectionTopLevelSignals([])])),E?{config:E}:{}),_?{usermeta:_}:{})}(s,function(d,g,b,_){let E=_.component.layoutSize.get("width"),I=_.component.layoutSize.get("height");if(g===void 0?(g={type:"pad"},_.hasAxisOrientSignalRef()&&(g.resize=!0)):bo(g)&&(g={type:g}),E&&I&&(R=g.type,R==="fit"||R==="fit-x"||R==="fit-y")){if(E==="step"&&I==="step")$r(gTt()),g.type="pad";else if(E==="step"||I==="step"){let z=E==="step"?"width":"height";$r(gTt(Cat(z)));let P=z==="width"?"height":"width";g.type=function(rt){return rt?`fit-${Cat(rt)}`:"fit"}(P)}}var R;return Object.assign(Object.assign(Object.assign({},jr(g).length===1&&g.type?g.type==="pad"?{}:{autosize:g.type}:{autosize:g}),oIt(b)),oIt(d))}(t,a.autosize,r,s),t.datasets,t.usermeta),normalized:a}}finally{e.logger&&KXt(),e.fieldTitle&&yAt(mAt)}}let kJt=new class extends qAt{mapUnit(t,{config:e}){if(t.encoding){let{encoding:n,transform:r}=t,{bins:a,timeUnits:s,aggregate:h,groupby:d,encoding:g}=Xyt(n,e),b=[...r||[],...a,...s,...h.length===0?[]:[{aggregate:h,groupby:d}]];return Object.assign(Object.assign(Object.assign({},t),b.length>0?{transform:b}:{}),{encoding:g})}return t}};function SJt(t,e){return kJt.map(t,{config:e})}let _Jt="4.13.1",iNt=function(t){let[e,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(t).slice(1,3);return{library:e,version:n}};var CJt="2.15.0";let RM="#fff",aNt="#888",EJt={background:"#333",view:{stroke:aNt},title:{color:RM,subtitleColor:RM},style:{"guide-label":{fill:RM},"guide-title":{fill:RM}},axis:{domainColor:RM,gridColor:aNt,tickColor:RM}},_9="#4572a7",TJt={background:"#fff",arc:{fill:_9},area:{fill:_9},line:{stroke:_9,strokeWidth:2},path:{stroke:_9},rect:{fill:_9},shape:{stroke:_9},symbol:{fill:_9,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},C9="#30a2da",rbt="#cbcbcb",oNt="#f0f0f0",sNt="#333",AJt={arc:{fill:C9},area:{fill:C9},axis:{domainColor:rbt,grid:!0,gridColor:rbt,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:rbt,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:oNt,group:{fill:oNt},legend:{labelColor:sNt,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:sNt,titleFontSize:14,titlePadding:10},line:{stroke:C9,strokeWidth:2},path:{stroke:C9,strokeWidth:.5},rect:{fill:C9},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:C9},bar:{binSpacing:2,fill:C9,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},E9="#000",IJt={group:{fill:"#e5e5e5"},arc:{fill:E9},area:{fill:E9},line:{stroke:E9},path:{stroke:E9},rect:{fill:E9},shape:{stroke:E9},symbol:{fill:E9,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},uNt="Benton Gothic, sans-serif",T9="#82c6df",ibt="Benton Gothic Bold, sans-serif",lNt="normal",BW={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"]},NJt={background:"#ffffff",title:{anchor:"start",color:"#000000",font:ibt,fontSize:22,fontWeight:"normal"},arc:{fill:T9},area:{fill:T9},line:{stroke:T9,strokeWidth:2},path:{stroke:T9},rect:{fill:T9},shape:{stroke:T9},symbol:{fill:T9,size:30},axis:{labelFont:uNt,labelFontSize:11.5,labelFontWeight:"normal",titleFont:ibt,titleFontSize:13,titleFontWeight:lNt},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:uNt,labelFontSize:11.5,symbolType:"square",titleFont:ibt,titleFontSize:13,titleFontWeight:lNt},range:{category:BW["category-6"],diverging:BW["fireandice-6"],heatmap:BW["fire-7"],ordinal:BW["fire-7"],ramp:BW["fire-7"]}},A9="#ab5787",Eot="#979797",MJt={background:"#f9f9f9",arc:{fill:A9},area:{fill:A9},line:{stroke:A9},path:{stroke:A9},rect:{fill:A9},shape:{stroke:A9},symbol:{fill:A9,size:30},axis:{domainColor:Eot,domainWidth:.5,gridWidth:.2,labelColor:Eot,tickColor:Eot,tickWidth:.2,titleColor:Eot},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},I9="#3e5c69",DJt={background:"#fff",arc:{fill:I9},area:{fill:I9},line:{stroke:I9},path:{stroke:I9},rect:{fill:I9},shape:{stroke:I9},symbol:{fill:I9},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},lg="#1696d2",cNt="#000000",Tot="Lato",abt="Lato",jW={"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},RJt={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:Tot},axisX:{domain:!0,domainColor:cNt,domainWidth:1,grid:!1,labelFontSize:12,labelFont:abt,labelAngle:0,tickColor:cNt,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Tot},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:abt,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Tot,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:abt,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Tot,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:jW["six-groups-cat-1"],diverging:jW["diverging-colors"],heatmap:jW["diverging-colors"],ordinal:jW["six-groups-seq"],ramp:jW["shades-blue"]},area:{fill:lg},rect:{fill:lg},line:{color:lg,stroke:lg,strokeWidth:5},trail:{color:lg,stroke:lg,strokeWidth:0,size:1},path:{stroke:lg,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:lg,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:lg,stroke:null}},arc:{fill:lg},shape:{stroke:lg},symbol:{fill:lg,size:30}},N9="#3366CC",hNt="#ccc",Aot="Arial, sans-serif",FJt={arc:{fill:N9},area:{fill:N9},path:{stroke:N9},rect:{fill:N9},shape:{stroke:N9},symbol:{stroke:N9},circle:{fill:N9},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Aot,fontSize:12},"guide-title":{font:Aot,fontSize:12},"group-title":{font:Aot,fontSize:12}},title:{font:Aot,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:hNt,tickColor:hNt,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},obt=t=>t*(1/3+1),dNt=obt(9),fNt=obt(10),pNt=obt(12),UW="Segoe UI",mNt="wf_standard-font, helvetica, arial, sans-serif",gNt="#252423",WW="#605E5C",yNt="transparent",cg="#118DFF",vNt="#DEEFFF",bNt=[vNt,cg],OJt={view:{stroke:yNt},background:yNt,font:UW,header:{titleFont:mNt,titleFontSize:pNt,titleColor:gNt,labelFont:UW,labelFontSize:fNt,labelColor:WW},axis:{ticks:!1,grid:!1,domain:!1,labelColor:WW,labelFontSize:dNt,titleFont:mNt,titleColor:gNt,titleFontSize:pNt,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:"#C8C6C4",gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:cg},line:{stroke:cg,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:UW,fontSize:dNt,fill:WW},arc:{fill:cg},area:{fill:cg,line:!0,opacity:.6},path:{stroke:cg},rect:{fill:cg},point:{fill:cg,filled:!0,size:75},shape:{stroke:cg},symbol:{fill:cg,strokeWidth:1.5,size:50},legend:{titleFont:UW,titleFontWeight:"bold",titleColor:WW,labelFont:UW,labelFontSize:fNt,labelColor:WW,symbolType:"circle",symbolSize:75},range:{category:[cg,"#12239E","#E66C37","#6B007B","#E044A7","#744EC2","#D9B300","#D64550"],diverging:bNt,heatmap:bNt,ordinal:[vNt,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",cg]}},sbt='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',Iot={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},LJt=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],$Jt=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function Not({theme:t,background:e}){let n=["white","g10"].includes(t)?"light":"dark",r=Iot.gridBg[t],a=Iot.textPrimary[t],s=Iot.textSecondary[t],h=n==="dark"?LJt:$Jt,d=n==="dark"?"#d4bbff":"#6929c4";return{background:e,arc:{fill:d},area:{fill:d},path:{stroke:d},rect:{fill:d},shape:{stroke:d},symbol:{stroke:d},circle:{fill:d},view:{fill:r,stroke:r},group:{fill:r},title:{color:a,anchor:"start",dy:-15,fontSize:16,font:sbt,fontWeight:600},axis:{labelColor:s,labelFontSize:12,labelFont:'IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',labelFontWeight:400,titleColor:a,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:Iot.layerAccent01[t],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:sbt,fill:s,fontWeight:400},"guide-title":{font:sbt,fill:s,fontWeight:400}},range:{category:h,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}let zJt=Not({theme:"white",background:"#ffffff"}),PJt=Not({theme:"g10",background:"#f4f4f4"}),BJt=Not({theme:"g90",background:"#262626"}),jJt=Not({theme:"g100",background:"#161616"}),UJt=CJt;var WJt=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;let wNt="vg-tooltip-element",VJt={offsetX:10,offsetY:10,id:wNt,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};function GJt(t,e,n){if(ni(t))return`[${t.map(r=>e(wi(r)?r:xNt(r,n))).join(", ")}]`;if(Zr(t)){let r="",a=t,{title:s,image:h}=a,d=function(b,_){var E={};for(var I in b)Object.prototype.hasOwnProperty.call(b,I)&&_.indexOf(I)<0&&(E[I]=b[I]);if(b!=null&&typeof Object.getOwnPropertySymbols=="function"){var R=0;for(I=Object.getOwnPropertySymbols(b);R<I.length;R++)_.indexOf(I[R])<0&&Object.prototype.propertyIsEnumerable.call(b,I[R])&&(E[I[R]]=b[I[R]])}return E}(a,["title","image"]);s&&(r+=`<h2>${e(s)}</h2>`),h&&(r+=`<img src="${e(h)}">`);let g=Object.keys(d);if(g.length>0){r+="<table>";for(let b of g){let _=d[b];_!==void 0&&(Zr(_)&&(_=xNt(_,n)),r+=`<tr><td class="key">${e(b)}:</td><td class="value">${e(_)}</td></tr>`)}r+="</table>"}return r||"{}"}return e(t)}function xNt(t,e){return JSON.stringify(t,function(n){let r=[];return function(a,s){if(typeof s!="object"||s===null)return s;let h=r.indexOf(this)+1;return r.length=h,r.length>n?"[Object]":r.indexOf(s)>=0?"[Circular]":(r.push(s),s)}}(e))}class HJt{constructor(e){this.options=Object.assign(Object.assign({},VJt),e);let n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){let r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=function(s){if(!/^[A-Za-z]+[-:.\w]*$/.test(s))throw new Error("Invalid HTML ID");return WJt.toString().replace(wNt,s)}(n);let a=document.head;a.childNodes.length>0?a.insertBefore(r,a.childNodes[0]):a.appendChild(r)}}tooltipHandler(e,n,r,a){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(document.fullscreenElement!=null?document.fullscreenElement:document.body).appendChild(this.el),a==null||a==="")return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=GJt(a,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);let{x:s,y:h}=function(d,g,b,_){let E=d.clientX+b;E+g.width>window.innerWidth&&(E=+d.clientX-b-g.width);let I=d.clientY+_;return I+g.height>window.innerHeight&&(I=+d.clientY-_-g.height),{x:E,y:I}}(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${h}px; left: ${s}px`)}}function Mot(t,e,n,r){return new(n||(n=Promise))(function(a,s){function h(b){try{g(r.next(b))}catch(_){s(_)}}function d(b){try{g(r.throw(b))}catch(_){s(_)}}function g(b){b.done?a(b.value):function(_){return _ instanceof n?_:new n(function(E){E(_)})}(b.value).then(h,d)}g((r=r.apply(t,[])).next())})}var ubt,YJt=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper {
    width: 100%;
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;function kNt(t,...e){for(let n of e)qJt(t,n);return t}function qJt(t,e){for(let n of Object.keys(e))bn(t,n,e[n],!0)}String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t});let U3=bt,FM=Tt,lbt=typeof window<"u"?window:void 0;FM===void 0&&(!((ubt=lbt?.vl)===null||ubt===void 0)&&ubt.compile)&&(FM=lbt.vl);let SNt={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},XJt={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},VW={vega:"Vega","vega-lite":"Vega-Lite"},Dot={vega:U3.version,"vega-lite":FM?FM.version:"not available"},KJt={vega:t=>t,"vega-lite":(t,e)=>FM.compile(t,{config:e}).spec},ZJt=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,QJt="chart-wrapper";function _Nt(t,e,n,r){let a=`<html><head>${e}</head><body><pre><code class="json">`,s=`</code></pre>${n}</body></html>`,h=window.open("");h.document.write(a+t+s),h.document.title=`${VW[r]} JSON Source`}function CNt(t,e){var n;if(t.$schema){let r=iNt(t.$schema);e&&e!==r.library&&console.warn(`The given visualization spec is written in ${VW[r.library]}, but mode argument sets ${(n=VW[e])!==null&&n!==void 0?n:e}.`);let a=r.library;return(0,tn.satisfies)(Dot[a],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${VW[a]} ${r.version}, but the current version of ${VW[a]} is v${Dot[a]}.`),a}return"mark"in t||"encoding"in t||"layer"in t||"hconcat"in t||"vconcat"in t||"facet"in t||"repeat"in t?"vega-lite":"marks"in t||"signals"in t||"scales"in t||"axes"in t?"vega":e??"vega"}function ENt(t){return(e=t)&&"load"in e?t:U3.loader(t);var e}function TNt(t){var e;return(e=t.usermeta&&t.usermeta.embedOptions)!==null&&e!==void 0?e:{}}function ANt(t,e){var n;return Mot(this,void 0,void 0,function*(){let r=Ce(t.config)?JSON.parse(yield e.load(t.config)):(n=t.config)!==null&&n!==void 0?n:{},a=Ce(t.patch)?JSON.parse(yield e.load(t.patch)):t.patch;return Object.assign(Object.assign(Object.assign({},t),a?{patch:a}:{}),r?{config:r}:{})})}let JJt=function(t,e,n={}){var r,a,s;return Mot(this,void 0,void 0,function*(){let h,d;Ce(e)?(d=ENt(n.loader),h=JSON.parse(yield d.load(e))):h=e;let g=TNt(h).loader;d&&!g||(d=ENt((r=n.loader)!==null&&r!==void 0?r:g));let b=yield ANt(TNt(h),d),_=yield ANt(n,d),E=Object.assign(Object.assign({},kNt(_,b)),{config:Le((a=_.config)!==null&&a!==void 0?a:{},(s=b.config)!==null&&s!==void 0?s:{})});return yield function(I,R,z={},P){var rt,ot,at,dt,ct,Ct;return Mot(this,void 0,void 0,function*(){let Et=z.theme?Le(qt[z.theme],(rt=z.config)!==null&&rt!==void 0?rt:{}):z.config,Rt=pa(z.actions)?z.actions:kNt({},SNt,(ot=z.actions)!==null&&ot!==void 0?ot:{}),Ot=Object.assign(Object.assign({},XJt),z.i18n),Wt=(at=z.renderer)!==null&&at!==void 0?at:"canvas",jt=(dt=z.logLevel)!==null&&dt!==void 0?dt:U3.Warn,Ht=(ct=z.downloadFileName)!==null&&ct!==void 0?ct:"visualization",Vt=typeof I=="string"?document.querySelector(I):I;if(!Vt)throw new Error(`${I} does not exist`);if(z.defaultStyle!==!1){let er="vega-embed-style",{root:An,rootContainer:dn}=function(nr){var Qn;let wr=nr.getRootNode?nr.getRootNode():document;return wr instanceof ShadowRoot?{root:wr,rootContainer:wr}:{root:document,rootContainer:(Qn=document.head)!==null&&Qn!==void 0?Qn:document.body}}(Vt);if(!An.getElementById(er)){let nr=document.createElement("style");nr.id=er,nr.innerText=z.defaultStyle===void 0||z.defaultStyle===!0?YJt.toString():z.defaultStyle,dn.appendChild(nr)}}let fe=CNt(R,z.mode),se=KJt[fe](R,Et);if(fe==="vega-lite"&&se.$schema){let er=iNt(se.$schema);(0,tn.satisfies)(Dot.vega,`^${er.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${er.version}, but current version is v${Dot.vega}.`)}Vt.classList.add("vega-embed"),Rt&&Vt.classList.add("has-actions"),Vt.innerHTML="";let he=Vt;if(Rt){let er=document.createElement("div");er.classList.add(QJt),Vt.appendChild(er),he=er}let _e=z.patch;_e&&(se=_e instanceof Function?_e(se):Me(se,_e,!0,!1).newDocument),z.formatLocale&&U3.formatLocale(z.formatLocale),z.timeFormatLocale&&U3.timeFormatLocale(z.timeFormatLocale);let{ast:Ve}=z,gn=U3.parse(se,fe==="vega-lite"?{}:Et,{ast:Ve}),$n=new(z.viewClass||U3.View)(gn,Object.assign({loader:P,logLevel:jt,renderer:Wt},Ve?{expr:U3.expressionInterpreter}:{}));if(z.tooltip!==!1){let er;er=function(An){return typeof An=="function"}(z.tooltip)?z.tooltip:new HJt(z.tooltip===!0?{}:z.tooltip).call,$n.tooltip(er)}let Gn,{hover:qe}=z;if(qe===void 0&&(qe=fe==="vega"),qe){let{hoverSet:er,updateSet:An}=typeof qe=="boolean"?{}:qe;$n.hover(er,An)}if(z&&(z.width!=null&&$n.width(z.width),z.height!=null&&$n.height(z.height),z.padding!=null&&$n.padding(z.padding)),yield $n.initialize(he,z.bind).runAsync(),Rt!==!1){let er=Vt;if(z.defaultStyle!==!1){let dn=document.createElement("details");dn.title=Ot.CLICK_TO_VIEW_ACTIONS,Vt.append(dn),er=dn;let nr=document.createElement("summary");nr.innerHTML=ZJt,dn.append(nr),Gn=Qn=>{dn.contains(Qn.target)||dn.removeAttribute("open")},document.addEventListener("click",Gn)}let An=document.createElement("div");if(er.append(An),An.classList.add("vega-actions"),Rt===!0||Rt.export!==!1){for(let dn of["svg","png"])if(Rt===!0||Rt.export===!0||Rt.export[dn]){let nr=Ot[`${dn.toUpperCase()}_ACTION`],Qn=document.createElement("a");Qn.text=nr,Qn.href="#",Qn.target="_blank",Qn.download=`${Ht}.${dn}`,Qn.addEventListener("mousedown",function(wr){return Mot(this,void 0,void 0,function*(){wr.preventDefault();let yi=yield $n.toImageURL(dn,z.scaleFactor);this.href=yi})}),An.append(Qn)}}if(Rt===!0||Rt.source!==!1){let dn=document.createElement("a");dn.text=Ot.SOURCE_ACTION,dn.href="#",dn.addEventListener("click",function(nr){var Qn,wr;_Nt($e()(R),(Qn=z.sourceHeader)!==null&&Qn!==void 0?Qn:"",(wr=z.sourceFooter)!==null&&wr!==void 0?wr:"",fe),nr.preventDefault()}),An.append(dn)}if(fe==="vega-lite"&&(Rt===!0||Rt.compiled!==!1)){let dn=document.createElement("a");dn.text=Ot.COMPILED_ACTION,dn.href="#",dn.addEventListener("click",function(nr){var Qn,wr;_Nt($e()(se),(Qn=z.sourceHeader)!==null&&Qn!==void 0?Qn:"",(wr=z.sourceFooter)!==null&&wr!==void 0?wr:"","vega"),nr.preventDefault()}),An.append(dn)}if(Rt===!0||Rt.editor!==!1){let dn=(Ct=z.editorUrl)!==null&&Ct!==void 0?Ct:"https://vega.github.io/editor/",nr=document.createElement("a");nr.text=Ot.EDITOR_ACTION,nr.href="#",nr.addEventListener("click",function(Qn){(function(wr,yi,ha){let mi=wr.open(yi),{origin:si}=new URL(yi),Ei=40;wr.addEventListener("message",function ki(Xi){Xi.source===mi&&(Ei=0,wr.removeEventListener("message",ki,!1))},!1),setTimeout(function ki(){Ei<=0||(mi.postMessage(ha,si),setTimeout(ki,250),Ei-=1)},250)})(window,dn,{config:Et,mode:fe,renderer:Wt,spec:$e()(R)}),Qn.preventDefault()}),An.append(nr)}}function tr(){Gn&&document.removeEventListener("click",Gn),$n.finalize()}return{view:$n,spec:R,vgSpec:se,finalize:tr}})}(t,h,E,d)})}},147:(L,O,S)=>{let B=Symbol("SemVer ANY");class j{static get ANY(){return B}constructor(st,lt){if(lt=K(lt),st instanceof j){if(st.loose===!!lt.loose)return st;st=st.value}st=st.trim().split(/\s+/).join(" "),J("comparator",st,lt),this.options=lt,this.loose=!!lt.loose,this.parse(st),this.semver===B?this.value="":this.value=this.operator+this.semver.version,J("comp",this)}parse(st){let lt=this.options.loose?Z[Y.COMPARATORLOOSE]:Z[Y.COMPARATOR],ft=st.match(lt);if(!ft)throw new TypeError(`Invalid comparator: ${st}`);this.operator=ft[1]!==void 0?ft[1]:"",this.operator==="="&&(this.operator=""),ft[2]?this.semver=new q(ft[2],this.options.loose):this.semver=B}toString(){return this.value}test(st){if(J("Comparator.test",st,this.options.loose),this.semver===B||st===B)return!0;if(typeof st=="string")try{st=new q(st,this.options)}catch{return!1}return X(st,this.operator,this.semver,this.options)}intersects(st,lt){if(!(st instanceof j))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""||new H(st.value,lt).test(this.value):st.operator===""?st.value===""||new H(this.value,lt).test(st.semver):(!(lt=K(lt)).includePrerelease||this.value!=="<0.0.0-0"&&st.value!=="<0.0.0-0")&&!(!lt.includePrerelease&&(this.value.startsWith("<0.0.0")||st.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!st.operator.startsWith(">"))||!(!this.operator.startsWith("<")||!st.operator.startsWith("<"))||!(this.semver.version!==st.semver.version||!this.operator.includes("=")||!st.operator.includes("="))||!!(X(this.semver,"<",st.semver,lt)&&this.operator.startsWith(">")&&st.operator.startsWith("<"))||!!(X(this.semver,">",st.semver,lt)&&this.operator.startsWith("<")&&st.operator.startsWith(">")))}}L.exports=j;let K=S(8324),{safeRe:Z,t:Y}=S(6063),X=S(4806),J=S(9847),q=S(6283),H=S(2894)},2894:(L,O,S)=>{let B=/\s+/g;class j{constructor(Xt,we){if(we=Z(we),Xt instanceof j)return Xt.loose===!!we.loose&&Xt.includePrerelease===!!we.includePrerelease?Xt:new j(Xt.raw,we);if(Xt instanceof Y)return this.raw=Xt.value,this.set=[[Xt]],this.formatted=void 0,this;if(this.options=we,this.loose=!!we.loose,this.includePrerelease=!!we.includePrerelease,this.raw=Xt.trim().replace(B," "),this.set=this.raw.split("||").map(ie=>this.parseRange(ie.trim())).filter(ie=>ie.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let ie=this.set[0];if(this.set=this.set.filter(m=>!xt(m[0])),this.set.length===0)this.set=[ie];else if(this.set.length>1){for(let m of this.set)if(m.length===1&&wt(m[0])){this.set=[m];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let Xt=0;Xt<this.set.length;Xt++){Xt>0&&(this.formatted+="||");let we=this.set[Xt];for(let ie=0;ie<we.length;ie++)ie>0&&(this.formatted+=" "),this.formatted+=we[ie].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(Xt){let we=((this.options.includePrerelease&&ft)|(this.options.loose&&gt))+":"+Xt,ie=K.get(we);if(ie)return ie;let m=this.options.loose,ye=m?q[H.HYPHENRANGELOOSE]:q[H.HYPHENRANGE];Xt=Xt.replace(ye,ee(this.options.includePrerelease)),X("hyphen replace",Xt),Xt=Xt.replace(q[H.COMPARATORTRIM],tt),X("comparator trim",Xt),Xt=Xt.replace(q[H.TILDETRIM],st),X("tilde trim",Xt),Xt=Xt.replace(q[H.CARETTRIM],lt),X("caret trim",Xt);let Ge=Xt.split(" ").map(Ue=>bt(Ue,this.options)).join(" ").split(/\s+/).map(Ue=>ge(Ue,this.options));m&&(Ge=Ge.filter(Ue=>(X("loose invalid filter",Ue,this.options),!!Ue.match(q[H.COMPARATORLOOSE])))),X("range list",Ge);let te=new Map,Me=Ge.map(Ue=>new Y(Ue,this.options));for(let Ue of Me){if(xt(Ue))return[Ue];te.set(Ue.value,Ue)}te.size>1&&te.has("")&&te.delete("");let Ye=[...te.values()];return K.set(we,Ye),Ye}intersects(Xt,we){if(!(Xt instanceof j))throw new TypeError("a Range is required");return this.set.some(ie=>_t(ie,we)&&Xt.set.some(m=>_t(m,we)&&ie.every(ye=>m.every(Ge=>ye.intersects(Ge,we)))))}test(Xt){if(!Xt)return!1;if(typeof Xt=="string")try{Xt=new J(Xt,this.options)}catch{return!1}for(let we=0;we<this.set.length;we++)if(Ee(this.set[we],Xt,this.options))return!0;return!1}}L.exports=j;let K=new(S(4967)),Z=S(8324),Y=S(147),X=S(9847),J=S(6283),{safeRe:q,t:H,comparatorTrimReplace:tt,tildeTrimReplace:st,caretTrimReplace:lt}=S(6063),{FLAG_INCLUDE_PRERELEASE:ft,FLAG_LOOSE:gt}=S(3101),xt=Bt=>Bt.value==="<0.0.0-0",wt=Bt=>Bt.value==="",_t=(Bt,Xt)=>{let we=!0,ie=Bt.slice(),m=ie.pop();for(;we&&ie.length;)we=ie.every(ye=>m.intersects(ye,Xt)),m=ie.pop();return we},bt=(Bt,Xt)=>(X("comp",Bt,Xt),Bt=St(Bt,Xt),X("caret",Bt),Bt=qt(Bt,Xt),X("tildes",Bt),Bt=Ft(Bt,Xt),X("xrange",Bt),Bt=Gt(Bt,Xt),X("stars",Bt),Bt),Tt=Bt=>!Bt||Bt.toLowerCase()==="x"||Bt==="*",qt=(Bt,Xt)=>Bt.trim().split(/\s+/).map(we=>It(we,Xt)).join(" "),It=(Bt,Xt)=>{let we=Xt.loose?q[H.TILDELOOSE]:q[H.TILDE];return Bt.replace(we,(ie,m,ye,Ge,te)=>{let Me;return X("tilde",Bt,ie,m,ye,Ge,te),Tt(m)?Me="":Tt(ye)?Me=`>=${m}.0.0 <${+m+1}.0.0-0`:Tt(Ge)?Me=`>=${m}.${ye}.0 <${m}.${+ye+1}.0-0`:te?(X("replaceTilde pr",te),Me=`>=${m}.${ye}.${Ge}-${te} <${m}.${+ye+1}.0-0`):Me=`>=${m}.${ye}.${Ge} <${m}.${+ye+1}.0-0`,X("tilde return",Me),Me})},St=(Bt,Xt)=>Bt.trim().split(/\s+/).map(we=>vt(we,Xt)).join(" "),vt=(Bt,Xt)=>{X("caret",Bt,Xt);let we=Xt.loose?q[H.CARETLOOSE]:q[H.CARET],ie=Xt.includePrerelease?"-0":"";return Bt.replace(we,(m,ye,Ge,te,Me)=>{let Ye;return X("caret",Bt,m,ye,Ge,te,Me),Tt(ye)?Ye="":Tt(Ge)?Ye=`>=${ye}.0.0${ie} <${+ye+1}.0.0-0`:Tt(te)?Ye=ye==="0"?`>=${ye}.${Ge}.0${ie} <${ye}.${+Ge+1}.0-0`:`>=${ye}.${Ge}.0${ie} <${+ye+1}.0.0-0`:Me?(X("replaceCaret pr",Me),Ye=ye==="0"?Ge==="0"?`>=${ye}.${Ge}.${te}-${Me} <${ye}.${Ge}.${+te+1}-0`:`>=${ye}.${Ge}.${te}-${Me} <${ye}.${+Ge+1}.0-0`:`>=${ye}.${Ge}.${te}-${Me} <${+ye+1}.0.0-0`):(X("no pr"),Ye=ye==="0"?Ge==="0"?`>=${ye}.${Ge}.${te}${ie} <${ye}.${Ge}.${+te+1}-0`:`>=${ye}.${Ge}.${te}${ie} <${ye}.${+Ge+1}.0-0`:`>=${ye}.${Ge}.${te} <${+ye+1}.0.0-0`),X("caret return",Ye),Ye})},Ft=(Bt,Xt)=>(X("replaceXRanges",Bt,Xt),Bt.split(/\s+/).map(we=>Qt(we,Xt)).join(" ")),Qt=(Bt,Xt)=>{Bt=Bt.trim();let we=Xt.loose?q[H.XRANGELOOSE]:q[H.XRANGE];return Bt.replace(we,(ie,m,ye,Ge,te,Me)=>{X("xRange",Bt,ie,m,ye,Ge,te,Me);let Ye=Tt(ye),Ue=Ye||Tt(Ge),kn=Ue||Tt(te),mn=kn;return m==="="&&mn&&(m=""),Me=Xt.includePrerelease?"-0":"",Ye?ie=m===">"||m==="<"?"<0.0.0-0":"*":m&&mn?(Ue&&(Ge=0),te=0,m===">"?(m=">=",Ue?(ye=+ye+1,Ge=0,te=0):(Ge=+Ge+1,te=0)):m==="<="&&(m="<",Ue?ye=+ye+1:Ge=+Ge+1),m==="<"&&(Me="-0"),ie=`${m+ye}.${Ge}.${te}${Me}`):Ue?ie=`>=${ye}.0.0${Me} <${+ye+1}.0.0-0`:kn&&(ie=`>=${ye}.${Ge}.0${Me} <${ye}.${+Ge+1}.0-0`),X("xRange return",ie),ie})},Gt=(Bt,Xt)=>(X("replaceStars",Bt,Xt),Bt.trim().replace(q[H.STAR],"")),ge=(Bt,Xt)=>(X("replaceGTE0",Bt,Xt),Bt.trim().replace(q[Xt.includePrerelease?H.GTE0PRE:H.GTE0],"")),ee=Bt=>(Xt,we,ie,m,ye,Ge,te,Me,Ye,Ue,kn,mn)=>`${we=Tt(ie)?"":Tt(m)?`>=${ie}.0.0${Bt?"-0":""}`:Tt(ye)?`>=${ie}.${m}.0${Bt?"-0":""}`:Ge?`>=${we}`:`>=${we}${Bt?"-0":""}`} ${Me=Tt(Ye)?"":Tt(Ue)?`<${+Ye+1}.0.0-0`:Tt(kn)?`<${Ye}.${+Ue+1}.0-0`:mn?`<=${Ye}.${Ue}.${kn}-${mn}`:Bt?`<${Ye}.${Ue}.${+kn+1}-0`:`<=${Me}`}`.trim(),Ee=(Bt,Xt,we)=>{for(let ie=0;ie<Bt.length;ie++)if(!Bt[ie].test(Xt))return!1;if(Xt.prerelease.length&&!we.includePrerelease){for(let ie=0;ie<Bt.length;ie++)if(X(Bt[ie].semver),Bt[ie].semver!==Y.ANY&&Bt[ie].semver.prerelease.length>0){let m=Bt[ie].semver;if(m.major===Xt.major&&m.minor===Xt.minor&&m.patch===Xt.patch)return!0}return!1}return!0}},6283:(L,O,S)=>{let B=S(9847),{MAX_LENGTH:j,MAX_SAFE_INTEGER:K}=S(3101),{safeRe:Z,t:Y}=S(6063),X=S(8324),{compareIdentifiers:J}=S(8884);class q{constructor(tt,st){if(st=X(st),tt instanceof q){if(tt.loose===!!st.loose&&tt.includePrerelease===!!st.includePrerelease)return tt;tt=tt.version}else if(typeof tt!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof tt}".`);if(tt.length>j)throw new TypeError(`version is longer than ${j} characters`);B("SemVer",tt,st),this.options=st,this.loose=!!st.loose,this.includePrerelease=!!st.includePrerelease;let lt=tt.trim().match(st.loose?Z[Y.LOOSE]:Z[Y.FULL]);if(!lt)throw new TypeError(`Invalid Version: ${tt}`);if(this.raw=tt,this.major=+lt[1],this.minor=+lt[2],this.patch=+lt[3],this.major>K||this.major<0)throw new TypeError("Invalid major version");if(this.minor>K||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>K||this.patch<0)throw new TypeError("Invalid patch version");lt[4]?this.prerelease=lt[4].split(".").map(ft=>{if(/^[0-9]+$/.test(ft)){let gt=+ft;if(gt>=0&&gt<K)return gt}return ft}):this.prerelease=[],this.build=lt[5]?lt[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(tt){if(B("SemVer.compare",this.version,this.options,tt),!(tt instanceof q)){if(typeof tt=="string"&&tt===this.version)return 0;tt=new q(tt,this.options)}return tt.version===this.version?0:this.compareMain(tt)||this.comparePre(tt)}compareMain(tt){return tt instanceof q||(tt=new q(tt,this.options)),J(this.major,tt.major)||J(this.minor,tt.minor)||J(this.patch,tt.patch)}comparePre(tt){if(tt instanceof q||(tt=new q(tt,this.options)),this.prerelease.length&&!tt.prerelease.length)return-1;if(!this.prerelease.length&&tt.prerelease.length)return 1;if(!this.prerelease.length&&!tt.prerelease.length)return 0;let st=0;do{let lt=this.prerelease[st],ft=tt.prerelease[st];if(B("prerelease compare",st,lt,ft),lt===void 0&&ft===void 0)return 0;if(ft===void 0)return 1;if(lt===void 0)return-1;if(lt!==ft)return J(lt,ft)}while(++st)}compareBuild(tt){tt instanceof q||(tt=new q(tt,this.options));let st=0;do{let lt=this.build[st],ft=tt.build[st];if(B("build compare",st,lt,ft),lt===void 0&&ft===void 0)return 0;if(ft===void 0)return 1;if(lt===void 0)return-1;if(lt!==ft)return J(lt,ft)}while(++st)}inc(tt,st,lt){switch(tt){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",st,lt);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",st,lt);break;case"prepatch":this.prerelease.length=0,this.inc("patch",st,lt),this.inc("pre",st,lt);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",st,lt),this.inc("pre",st,lt);break;case"major":this.minor===0&&this.patch===0&&this.prerelease.length!==0||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":this.patch===0&&this.prerelease.length!==0||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let ft=Number(lt)?1:0;if(!st&&lt===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[ft];else{let gt=this.prerelease.length;for(;--gt>=0;)typeof this.prerelease[gt]=="number"&&(this.prerelease[gt]++,gt=-2);if(gt===-1){if(st===this.prerelease.join(".")&&lt===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(ft)}}if(st){let gt=[st,ft];lt===!1&&(gt=[st]),J(this.prerelease[0],st)===0?isNaN(this.prerelease[1])&&(this.prerelease=gt):this.prerelease=gt}break}default:throw new Error(`invalid increment argument: ${tt}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}L.exports=q},9479:(L,O,S)=>{let B=S(7262);L.exports=(j,K)=>{let Z=B(j.trim().replace(/^[=v]+/,""),K);return Z?Z.version:null}},4806:(L,O,S)=>{let B=S(2314),j=S(6638),K=S(4311),Z=S(2228),Y=S(528),X=S(7645);L.exports=(J,q,H,tt)=>{switch(q){case"===":return typeof J=="object"&&(J=J.version),typeof H=="object"&&(H=H.version),J===H;case"!==":return typeof J=="object"&&(J=J.version),typeof H=="object"&&(H=H.version),J!==H;case"":case"=":case"==":return B(J,H,tt);case"!=":return j(J,H,tt);case">":return K(J,H,tt);case">=":return Z(J,H,tt);case"<":return Y(J,H,tt);case"<=":return X(J,H,tt);default:throw new TypeError(`Invalid operator: ${q}`)}}},5177:(L,O,S)=>{let B=S(6283),j=S(7262),{safeRe:K,t:Z}=S(6063);L.exports=(Y,X)=>{if(Y instanceof B)return Y;if(typeof Y=="number"&&(Y=String(Y)),typeof Y!="string")return null;let J=null;if((X=X||{}).rtl){let ft=X.includePrerelease?K[Z.COERCERTLFULL]:K[Z.COERCERTL],gt;for(;(gt=ft.exec(Y))&&(!J||J.index+J[0].length!==Y.length);)J&&gt.index+gt[0].length===J.index+J[0].length||(J=gt),ft.lastIndex=gt.index+gt[1].length+gt[2].length;ft.lastIndex=-1}else J=Y.match(X.includePrerelease?K[Z.COERCEFULL]:K[Z.COERCE]);if(J===null)return null;let q=J[2],H=J[3]||"0",tt=J[4]||"0",st=X.includePrerelease&&J[5]?`-${J[5]}`:"",lt=X.includePrerelease&&J[6]?`+${J[6]}`:"";return j(`${q}.${H}.${tt}${st}${lt}`,X)}},4320:(L,O,S)=>{let B=S(6283);L.exports=(j,K,Z)=>{let Y=new B(j,Z),X=new B(K,Z);return Y.compare(X)||Y.compareBuild(X)}},6330:(L,O,S)=>{let B=S(9349);L.exports=(j,K)=>B(j,K,!0)},9349:(L,O,S)=>{let B=S(6283);L.exports=(j,K,Z)=>new B(j,Z).compare(new B(K,Z))},9127:(L,O,S)=>{let B=S(7262);L.exports=(j,K)=>{let Z=B(j,null,!0),Y=B(K,null,!0),X=Z.compare(Y);if(X===0)return null;let J=X>0,q=J?Z:Y,H=J?Y:Z,tt=!!q.prerelease.length;if(H.prerelease.length&&!tt)return H.patch||H.minor?q.patch?"patch":q.minor?"minor":"major":"major";let st=tt?"pre":"";return Z.major!==Y.major?st+"major":Z.minor!==Y.minor?st+"minor":Z.patch!==Y.patch?st+"patch":"prerelease"}},2314:(L,O,S)=>{let B=S(9349);L.exports=(j,K,Z)=>B(j,K,Z)===0},4311:(L,O,S)=>{let B=S(9349);L.exports=(j,K,Z)=>B(j,K,Z)>0},2228:(L,O,S)=>{let B=S(9349);L.exports=(j,K,Z)=>B(j,K,Z)>=0},5810:(L,O,S)=>{let B=S(6283);L.exports=(j,K,Z,Y,X)=>{typeof Z=="string"&&(X=Y,Y=Z,Z=void 0);try{return new B(j instanceof B?j.version:j,Z).inc(K,Y,X).version}catch{return null}}},528:(L,O,S)=>{let B=S(9349);L.exports=(j,K,Z)=>B(j,K,Z)<0},7645:(L,O,S)=>{let B=S(9349);L.exports=(j,K,Z)=>B(j,K,Z)<=0},9823:(L,O,S)=>{let B=S(6283);L.exports=(j,K)=>new B(j,K).major},3915:(L,O,S)=>{let B=S(6283);L.exports=(j,K)=>new B(j,K).minor},6638:(L,O,S)=>{let B=S(9349);L.exports=(j,K,Z)=>B(j,K,Z)!==0},7262:(L,O,S)=>{let B=S(6283);L.exports=(j,K,Z=!1)=>{if(j instanceof B)return j;try{return new B(j,K)}catch(Y){if(!Z)return null;throw Y}}},3236:(L,O,S)=>{let B=S(6283);L.exports=(j,K)=>new B(j,K).patch},7810:(L,O,S)=>{let B=S(7262);L.exports=(j,K)=>{let Z=B(j,K);return Z&&Z.prerelease.length?Z.prerelease:null}},4989:(L,O,S)=>{let B=S(9349);L.exports=(j,K,Z)=>B(K,j,Z)},6920:(L,O,S)=>{let B=S(4320);L.exports=(j,K)=>j.sort((Z,Y)=>B(Y,Z,K))},5435:(L,O,S)=>{let B=S(2894);L.exports=(j,K,Z)=>{try{K=new B(K,Z)}catch{return!1}return K.test(j)}},3616:(L,O,S)=>{let B=S(4320);L.exports=(j,K)=>j.sort((Z,Y)=>B(Z,Y,K))},2348:(L,O,S)=>{let B=S(7262);L.exports=(j,K)=>{let Z=B(j,K);return Z?Z.version:null}},6392:(L,O,S)=>{let B=S(6063),j=S(3101),K=S(6283),Z=S(8884),Y=S(7262),X=S(2348),J=S(9479),q=S(5810),H=S(9127),tt=S(9823),st=S(3915),lt=S(3236),ft=S(7810),gt=S(9349),xt=S(4989),wt=S(6330),_t=S(4320),bt=S(3616),Tt=S(6920),qt=S(4311),It=S(528),St=S(2314),vt=S(6638),Ft=S(2228),Qt=S(7645),Gt=S(4806),ge=S(5177),ee=S(147),Ee=S(2894),Bt=S(5435),Xt=S(6718),we=S(5753),ie=S(7939),m=S(3802),ye=S(7569),Ge=S(8584),te=S(7508),Me=S(4285),Ye=S(5929),Ue=S(6076),kn=S(1969);L.exports={parse:Y,valid:X,clean:J,inc:q,diff:H,major:tt,minor:st,patch:lt,prerelease:ft,compare:gt,rcompare:xt,compareLoose:wt,compareBuild:_t,sort:bt,rsort:Tt,gt:qt,lt:It,eq:St,neq:vt,gte:Ft,lte:Qt,cmp:Gt,coerce:ge,Comparator:ee,Range:Ee,satisfies:Bt,toComparators:Xt,maxSatisfying:we,minSatisfying:ie,minVersion:m,validRange:ye,outside:Ge,gtr:te,ltr:Me,intersects:Ye,simplifyRange:Ue,subset:kn,SemVer:K,re:B.re,src:B.src,tokens:B.t,SEMVER_SPEC_VERSION:j.SEMVER_SPEC_VERSION,RELEASE_TYPES:j.RELEASE_TYPES,compareIdentifiers:Z.compareIdentifiers,rcompareIdentifiers:Z.rcompareIdentifiers}},3101:L=>{let O=Number.MAX_SAFE_INTEGER||9007199254740991;L.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:O,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},9847:L=>{let O=typeof Iu=="object"&&Iu.env&&Iu.env.NODE_DEBUG&&/\bsemver\b/i.test(Iu.env.NODE_DEBUG)?(...S)=>console.error("SEMVER",...S):()=>{};L.exports=O},8884:L=>{let O=/^[0-9]+$/,S=(B,j)=>{let K=O.test(B),Z=O.test(j);return K&&Z&&(B=+B,j=+j),B===j?0:K&&!Z?-1:Z&&!K?1:B<j?-1:1};L.exports={compareIdentifiers:S,rcompareIdentifiers:(B,j)=>S(j,B)}},4967:L=>{L.exports=class{constructor(){this.max=1e3,this.map=new Map}get(O){let S=this.map.get(O);return S===void 0?void 0:(this.map.delete(O),this.map.set(O,S),S)}delete(O){return this.map.delete(O)}set(O,S){if(!this.delete(O)&&S!==void 0){if(this.map.size>=this.max){let B=this.map.keys().next().value;this.delete(B)}this.map.set(O,S)}return this}}},8324:L=>{let O=Object.freeze({loose:!0}),S=Object.freeze({});L.exports=B=>B?typeof B!="object"?O:B:S},6063:(L,O,S)=>{let{MAX_SAFE_COMPONENT_LENGTH:B,MAX_SAFE_BUILD_LENGTH:j,MAX_LENGTH:K}=S(3101),Z=S(9847),Y=(O=L.exports={}).re=[],X=O.safeRe=[],J=O.src=[],q=O.t={},H=0,tt="[a-zA-Z0-9-]",st=[["\\s",1],["\\d",K],[tt,j]],lt=(ft,gt,xt)=>{let wt=(bt=>{for(let[Tt,qt]of st)bt=bt.split(`${Tt}*`).join(`${Tt}{0,${qt}}`).split(`${Tt}+`).join(`${Tt}{1,${qt}}`);return bt})(gt),_t=H++;Z(ft,_t,gt),q[ft]=_t,J[_t]=gt,Y[_t]=new RegExp(gt,xt?"g":void 0),X[_t]=new RegExp(wt,xt?"g":void 0)};lt("NUMERICIDENTIFIER","0|[1-9]\\d*"),lt("NUMERICIDENTIFIERLOOSE","\\d+"),lt("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${tt}*`),lt("MAINVERSION",`(${J[q.NUMERICIDENTIFIER]})\\.(${J[q.NUMERICIDENTIFIER]})\\.(${J[q.NUMERICIDENTIFIER]})`),lt("MAINVERSIONLOOSE",`(${J[q.NUMERICIDENTIFIERLOOSE]})\\.(${J[q.NUMERICIDENTIFIERLOOSE]})\\.(${J[q.NUMERICIDENTIFIERLOOSE]})`),lt("PRERELEASEIDENTIFIER",`(?:${J[q.NUMERICIDENTIFIER]}|${J[q.NONNUMERICIDENTIFIER]})`),lt("PRERELEASEIDENTIFIERLOOSE",`(?:${J[q.NUMERICIDENTIFIERLOOSE]}|${J[q.NONNUMERICIDENTIFIER]})`),lt("PRERELEASE",`(?:-(${J[q.PRERELEASEIDENTIFIER]}(?:\\.${J[q.PRERELEASEIDENTIFIER]})*))`),lt("PRERELEASELOOSE",`(?:-?(${J[q.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${J[q.PRERELEASEIDENTIFIERLOOSE]})*))`),lt("BUILDIDENTIFIER",`${tt}+`),lt("BUILD",`(?:\\+(${J[q.BUILDIDENTIFIER]}(?:\\.${J[q.BUILDIDENTIFIER]})*))`),lt("FULLPLAIN",`v?${J[q.MAINVERSION]}${J[q.PRERELEASE]}?${J[q.BUILD]}?`),lt("FULL",`^${J[q.FULLPLAIN]}$`),lt("LOOSEPLAIN",`[v=\\s]*${J[q.MAINVERSIONLOOSE]}${J[q.PRERELEASELOOSE]}?${J[q.BUILD]}?`),lt("LOOSE",`^${J[q.LOOSEPLAIN]}$`),lt("GTLT","((?:<|>)?=?)"),lt("XRANGEIDENTIFIERLOOSE",`${J[q.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),lt("XRANGEIDENTIFIER",`${J[q.NUMERICIDENTIFIER]}|x|X|\\*`),lt("XRANGEPLAIN",`[v=\\s]*(${J[q.XRANGEIDENTIFIER]})(?:\\.(${J[q.XRANGEIDENTIFIER]})(?:\\.(${J[q.XRANGEIDENTIFIER]})(?:${J[q.PRERELEASE]})?${J[q.BUILD]}?)?)?`),lt("XRANGEPLAINLOOSE",`[v=\\s]*(${J[q.XRANGEIDENTIFIERLOOSE]})(?:\\.(${J[q.XRANGEIDENTIFIERLOOSE]})(?:\\.(${J[q.XRANGEIDENTIFIERLOOSE]})(?:${J[q.PRERELEASELOOSE]})?${J[q.BUILD]}?)?)?`),lt("XRANGE",`^${J[q.GTLT]}\\s*${J[q.XRANGEPLAIN]}$`),lt("XRANGELOOSE",`^${J[q.GTLT]}\\s*${J[q.XRANGEPLAINLOOSE]}$`),lt("COERCEPLAIN",`(^|[^\\d])(\\d{1,${B}})(?:\\.(\\d{1,${B}}))?(?:\\.(\\d{1,${B}}))?`),lt("COERCE",`${J[q.COERCEPLAIN]}(?:$|[^\\d])`),lt("COERCEFULL",J[q.COERCEPLAIN]+`(?:${J[q.PRERELEASE]})?(?:${J[q.BUILD]})?(?:$|[^\\d])`),lt("COERCERTL",J[q.COERCE],!0),lt("COERCERTLFULL",J[q.COERCEFULL],!0),lt("LONETILDE","(?:~>?)"),lt("TILDETRIM",`(\\s*)${J[q.LONETILDE]}\\s+`,!0),O.tildeTrimReplace="$1~",lt("TILDE",`^${J[q.LONETILDE]}${J[q.XRANGEPLAIN]}$`),lt("TILDELOOSE",`^${J[q.LONETILDE]}${J[q.XRANGEPLAINLOOSE]}$`),lt("LONECARET","(?:\\^)"),lt("CARETTRIM",`(\\s*)${J[q.LONECARET]}\\s+`,!0),O.caretTrimReplace="$1^",lt("CARET",`^${J[q.LONECARET]}${J[q.XRANGEPLAIN]}$`),lt("CARETLOOSE",`^${J[q.LONECARET]}${J[q.XRANGEPLAINLOOSE]}$`),lt("COMPARATORLOOSE",`^${J[q.GTLT]}\\s*(${J[q.LOOSEPLAIN]})$|^$`),lt("COMPARATOR",`^${J[q.GTLT]}\\s*(${J[q.FULLPLAIN]})$|^$`),lt("COMPARATORTRIM",`(\\s*)${J[q.GTLT]}\\s*(${J[q.LOOSEPLAIN]}|${J[q.XRANGEPLAIN]})`,!0),O.comparatorTrimReplace="$1$2$3",lt("HYPHENRANGE",`^\\s*(${J[q.XRANGEPLAIN]})\\s+-\\s+(${J[q.XRANGEPLAIN]})\\s*$`),lt("HYPHENRANGELOOSE",`^\\s*(${J[q.XRANGEPLAINLOOSE]})\\s+-\\s+(${J[q.XRANGEPLAINLOOSE]})\\s*$`),lt("STAR","(<|>)?=?\\s*\\*"),lt("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),lt("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},7508:(L,O,S)=>{let B=S(8584);L.exports=(j,K,Z)=>B(j,K,">",Z)},5929:(L,O,S)=>{let B=S(2894);L.exports=(j,K,Z)=>(j=new B(j,Z),K=new B(K,Z),j.intersects(K,Z))},4285:(L,O,S)=>{let B=S(8584);L.exports=(j,K,Z)=>B(j,K,"<",Z)},5753:(L,O,S)=>{let B=S(6283),j=S(2894);L.exports=(K,Z,Y)=>{let X=null,J=null,q=null;try{q=new j(Z,Y)}catch{return null}return K.forEach(H=>{q.test(H)&&(X&&J.compare(H)!==-1||(X=H,J=new B(X,Y)))}),X}},7939:(L,O,S)=>{let B=S(6283),j=S(2894);L.exports=(K,Z,Y)=>{let X=null,J=null,q=null;try{q=new j(Z,Y)}catch{return null}return K.forEach(H=>{q.test(H)&&(X&&J.compare(H)!==1||(X=H,J=new B(X,Y)))}),X}},3802:(L,O,S)=>{let B=S(6283),j=S(2894),K=S(4311);L.exports=(Z,Y)=>{Z=new j(Z,Y);let X=new B("0.0.0");if(Z.test(X)||(X=new B("0.0.0-0"),Z.test(X)))return X;X=null;for(let J=0;J<Z.set.length;++J){let q=Z.set[J],H=null;q.forEach(tt=>{let st=new B(tt.semver.version);switch(tt.operator){case">":st.prerelease.length===0?st.patch++:st.prerelease.push(0),st.raw=st.format();case"":case">=":H&&!K(st,H)||(H=st);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${tt.operator}`)}}),!H||X&&!K(X,H)||(X=H)}return X&&Z.test(X)?X:null}},8584:(L,O,S)=>{let B=S(6283),j=S(147),{ANY:K}=j,Z=S(2894),Y=S(5435),X=S(4311),J=S(528),q=S(7645),H=S(2228);L.exports=(tt,st,lt,ft)=>{let gt,xt,wt,_t,bt;switch(tt=new B(tt,ft),st=new Z(st,ft),lt){case">":gt=X,xt=q,wt=J,_t=">",bt=">=";break;case"<":gt=J,xt=H,wt=X,_t="<",bt="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Y(tt,st,ft))return!1;for(let Tt=0;Tt<st.set.length;++Tt){let qt=st.set[Tt],It=null,St=null;if(qt.forEach(vt=>{vt.semver===K&&(vt=new j(">=0.0.0")),It=It||vt,St=St||vt,gt(vt.semver,It.semver,ft)?It=vt:wt(vt.semver,St.semver,ft)&&(St=vt)}),It.operator===_t||It.operator===bt||(!St.operator||St.operator===_t)&&xt(tt,St.semver)||St.operator===bt&&wt(tt,St.semver))return!1}return!0}},6076:(L,O,S)=>{let B=S(5435),j=S(9349);L.exports=(K,Z,Y)=>{let X=[],J=null,q=null,H=K.sort((ft,gt)=>j(ft,gt,Y));for(let ft of H)B(ft,Z,Y)?(q=ft,J||(J=ft)):(q&&X.push([J,q]),q=null,J=null);J&&X.push([J,null]);let tt=[];for(let[ft,gt]of X)ft===gt?tt.push(ft):gt||ft!==H[0]?gt?ft===H[0]?tt.push(`<=${gt}`):tt.push(`${ft} - ${gt}`):tt.push(`>=${ft}`):tt.push("*");let st=tt.join(" || "),lt=typeof Z.raw=="string"?Z.raw:String(Z);return st.length<lt.length?st:Z}},1969:(L,O,S)=>{let B=S(2894),j=S(147),{ANY:K}=j,Z=S(5435),Y=S(9349),X=[new j(">=0.0.0-0")],J=[new j(">=0.0.0")],q=(st,lt,ft)=>{if(st===lt)return!0;if(st.length===1&&st[0].semver===K){if(lt.length===1&&lt[0].semver===K)return!0;st=ft.includePrerelease?X:J}if(lt.length===1&&lt[0].semver===K){if(ft.includePrerelease)return!0;lt=J}let gt=new Set,xt,wt,_t,bt,Tt,qt,It;for(let Ft of st)Ft.operator===">"||Ft.operator===">="?xt=H(xt,Ft,ft):Ft.operator==="<"||Ft.operator==="<="?wt=tt(wt,Ft,ft):gt.add(Ft.semver);if(gt.size>1||xt&&wt&&(_t=Y(xt.semver,wt.semver,ft),_t>0||_t===0&&(xt.operator!==">="||wt.operator!=="<=")))return null;for(let Ft of gt){if(xt&&!Z(Ft,String(xt),ft)||wt&&!Z(Ft,String(wt),ft))return null;for(let Qt of lt)if(!Z(Ft,String(Qt),ft))return!1;return!0}let St=!(!wt||ft.includePrerelease||!wt.semver.prerelease.length)&&wt.semver,vt=!(!xt||ft.includePrerelease||!xt.semver.prerelease.length)&&xt.semver;St&&St.prerelease.length===1&&wt.operator==="<"&&St.prerelease[0]===0&&(St=!1);for(let Ft of lt){if(It=It||Ft.operator===">"||Ft.operator===">=",qt=qt||Ft.operator==="<"||Ft.operator==="<=",xt){if(vt&&Ft.semver.prerelease&&Ft.semver.prerelease.length&&Ft.semver.major===vt.major&&Ft.semver.minor===vt.minor&&Ft.semver.patch===vt.patch&&(vt=!1),Ft.operator===">"||Ft.operator===">="){if(bt=H(xt,Ft,ft),bt===Ft&&bt!==xt)return!1}else if(xt.operator===">="&&!Z(xt.semver,String(Ft),ft))return!1}if(wt){if(St&&Ft.semver.prerelease&&Ft.semver.prerelease.length&&Ft.semver.major===St.major&&Ft.semver.minor===St.minor&&Ft.semver.patch===St.patch&&(St=!1),Ft.operator==="<"||Ft.operator==="<="){if(Tt=tt(wt,Ft,ft),Tt===Ft&&Tt!==wt)return!1}else if(wt.operator==="<="&&!Z(wt.semver,String(Ft),ft))return!1}if(!Ft.operator&&(wt||xt)&&_t!==0)return!1}return!(xt&&qt&&!wt&&_t!==0)&&!(wt&&It&&!xt&&_t!==0)&&!vt&&!St},H=(st,lt,ft)=>{if(!st)return lt;let gt=Y(st.semver,lt.semver,ft);return gt>0?st:gt<0||lt.operator===">"&&st.operator===">="?lt:st},tt=(st,lt,ft)=>{if(!st)return lt;let gt=Y(st.semver,lt.semver,ft);return gt<0?st:gt>0||lt.operator==="<"&&st.operator==="<="?lt:st};L.exports=(st,lt,ft={})=>{if(st===lt)return!0;st=new B(st,ft),lt=new B(lt,ft);let gt=!1;t:for(let xt of st.set){for(let wt of lt.set){let _t=q(xt,wt,ft);if(gt=gt||_t!==null,_t)continue t}if(gt)return!1}return!0}},6718:(L,O,S)=>{let B=S(2894);L.exports=(j,K)=>new B(j,K).set.map(Z=>Z.map(Y=>Y.value).join(" ").trim().split(" "))},7569:(L,O,S)=>{let B=S(2894);L.exports=(j,K)=>{try{return new B(j,K).range||"*"}catch{return null}}},7571:()=>{},7006:()=>{},5817:()=>{},8590:()=>{},4530:()=>{},8108:()=>{},551:()=>{},1234:()=>{},8487:L=>{var O=/("(?:[^\\"]|\\.)*")|[:,]/g;L.exports=function(S,B){var j,K,Z;return B=B||{},j=JSON.stringify([1],void 0,B.indent===void 0?2:B.indent).slice(2,-3),K=j===""?1/0:B.maxLength===void 0?80:B.maxLength,Z=B.replacer,function Y(X,J,q){var H,tt,st,lt,ft,gt,xt,wt,_t,bt,Tt,qt;if(X&&typeof X.toJSON=="function"&&(X=X.toJSON()),(Tt=JSON.stringify(X,Z))===void 0)return Tt;if(xt=K-J.length-q,Tt.length<=xt&&(_t=Tt.replace(O,function(It,St){return St||It+" "})).length<=xt)return _t;if(Z!=null&&(X=JSON.parse(Tt),Z=void 0),typeof X=="object"&&X!==null){if(wt=J+j,st=[],tt=0,Array.isArray(X))for(bt="[",H="]",xt=X.length;tt<xt;tt++)st.push(Y(X[tt],wt,tt===xt-1?0:1)||"null");else for(bt="{",H="}",xt=(gt=Object.keys(X)).length;tt<xt;tt++)lt=gt[tt],ft=JSON.stringify(lt)+": ",(qt=Y(X[lt],wt,ft.length+(tt===xt-1?0:1)))!==void 0&&st.push(ft+qt);if(st.length>0)return[bt,j+st.join(`,
`+wt),H].join(`
`+J)}return Tt}(S,"",0)}}},N={};function F(L){var O=N[L];if(O!==void 0)return O.exports;var S=N[L]={id:L,loaded:!1,exports:{}};return k[L].call(S.exports,S,S.exports,F),S.loaded=!0,S.exports}F.amdD=function(){throw new Error("define cannot be used indirect")},F.amdO={},F.n=L=>{var O=L&&L.__esModule?()=>L.default:()=>L;return F.d(O,{a:O}),O},F.d=(L,O)=>{for(var S in O)F.o(O,S)&&!F.o(L,S)&&Object.defineProperty(L,S,{enumerable:!0,get:O[S]})},F.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),F.o=(L,O)=>Object.prototype.hasOwnProperty.call(L,O),F.r=L=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(L,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(L,"__esModule",{value:!0})},F.nmd=L=>(L.paths=[],L.children||(L.children=[]),L);var W={};return(()=>{F.d(W,{default:()=>Ket});var L={};F.r(L),F.d(L,{maxNorm:()=>O5,minMaxNorm:()=>RG,nonNeg:()=>klt,unitNorm:()=>L5});var O={};F.r(O),F.d(O,{constant:()=>Slt,glorotNormal:()=>sR,glorotUniform:()=>Z8,heNormal:()=>Q8,heUniform:()=>uR,identity:()=>oR,leCunNormal:()=>OG,leCunUniform:()=>cc,ones:()=>$5,orthogonal:()=>_lt,randomNormal:()=>aR,randomUniform:()=>iR,truncatedNormal:()=>z5,varianceScaling:()=>P5,zeros:()=>FG});var S={};F.r(S),F.d(S,{Layer:()=>Hi,RNN:()=>f0,RNNCell:()=>Y5,activation:()=>Wc,add:()=>EH,alphaDropout:()=>WH,average:()=>TH,averagePooling1d:()=>uF,averagePooling2d:()=>$w,averagePooling3d:()=>oS,avgPool1d:()=>lF,avgPool2d:()=>DH,avgPool3d:()=>hF,avgPooling1d:()=>cF,avgPooling2d:()=>Vlt,avgPooling3d:()=>dF,batchNormalization:()=>oF,bidirectional:()=>yF,categoryEncoding:()=>uS,centerCrop:()=>GH,concatenate:()=>AH,conv1d:()=>aS,conv2d:()=>xH,conv2dTranspose:()=>kH,conv3d:()=>zlt,conv3dTranspose:()=>Plt,convLstm2d:()=>Hlt,convLstm2dCell:()=>zH,cropping2D:()=>jlt,dense:()=>Fg,depthwiseConv2d:()=>tF,dot:()=>NH,dropout:()=>eF,elu:()=>rS,embedding:()=>iF,flatten:()=>nF,gaussianDropout:()=>xF,gaussianNoise:()=>wF,globalAveragePooling1d:()=>fF,globalAveragePooling2d:()=>RH,globalMaxPool1d:()=>vF,globalMaxPool2d:()=>jH,globalMaxPooling1d:()=>sS,globalMaxPooling2d:()=>FH,gru:()=>OH,gruCell:()=>Glt,input:()=>uE,inputLayer:()=>wf,layerNormalization:()=>sF,leakyReLU:()=>wH,lstm:()=>LH,lstmCell:()=>mF,masking:()=>kF,maxPool1d:()=>bF,maxPool2d:()=>UH,maxPooling1d:()=>FE,maxPooling2d:()=>OE,maxPooling3d:()=>pF,maximum:()=>aF,minimum:()=>IH,multiply:()=>Wlt,permute:()=>rF,prelu:()=>JR,randomWidth:()=>qlt,reLU:()=>QR,repeatVector:()=>CH,rescaling:()=>VH,reshape:()=>Ult,resizing:()=>HH,rnn:()=>Ylt,separableConv2d:()=>Blt,simpleRNN:()=>gF,simpleRNNCell:()=>$H,softmax:()=>$lt,spatialDropout1d:()=>_H,stackedRNNCells:()=>PH,thresholdedReLU:()=>iS,timeDistributed:()=>BH,upSampling2d:()=>SH,zeroPadding2d:()=>MH});var B={};F.r(B),F.d(B,{MAPE:()=>KH,MSE:()=>JH,binaryAccuracy:()=>YH,binaryCrossentropy:()=>qH,categoricalAccuracy:()=>Xlt,categoricalCrossentropy:()=>Klt,cosineProximity:()=>$E,mape:()=>ZH,meanAbsoluteError:()=>XH,meanAbsolutePercentageError:()=>v2,meanSquaredError:()=>QH,mse:()=>tY,precision:()=>Zlt,r2Score:()=>eY,recall:()=>LE,sparseCategoricalAccuracy:()=>SF});var j={};F.r(j),F.d(j,{modelFromJSON:()=>rH});var K={};F.r(K),F.d(K,{l1:()=>_F,l1l2:()=>zE,l2:()=>nY});var Z={};F.r(Z),F.d(Z,{json:()=>aY});var Y={};F.r(Y),F.d(Y,{json:()=>oY});var X={};F.r(X),F.d(X,{json:()=>sY});var J={};F.r(J),F.d(J,{json:()=>uY});var q={};F.r(q),F.d(q,{json:()=>BE});var H={};F.r(H),F.d(H,{json:()=>lY});var tt={};F.r(tt),F.d(tt,{json:()=>cY});var st={};F.r(st),F.d(st,{json:()=>hY});var lt={};F.r(lt),F.d(lt,{json:()=>dY});var ft={};F.r(ft),F.d(ft,{json:()=>fY});var gt={};F.r(gt),F.d(gt,{json:()=>AF});var xt={};F.r(xt),F.d(xt,{json:()=>jE});var wt={};F.r(wt),F.d(wt,{json:()=>pY});var _t={};F.r(_t),F.d(_t,{json:()=>mY});var bt={};F.r(bt),F.d(bt,{json:()=>gY});var Tt={};F.r(Tt),F.d(Tt,{json:()=>yY});var qt={};F.r(qt),F.d(qt,{json:()=>vY});var It={};F.r(It),F.d(It,{json:()=>bY});var St={};F.r(St),F.d(St,{json:()=>wY});var vt={};F.r(vt),F.d(vt,{OP_SCOPE_SUFFIX:()=>pn.BTT,abs:()=>pn.tnl,acos:()=>pn.HQu,acosh:()=>pn.FqL,add:()=>pn.WQq,addN:()=>pn.QiD,all:()=>pn.Q7R,any:()=>pn.bzn,argMax:()=>pn.FLi,argMin:()=>pn.XRg,asin:()=>pn.qRo,asinh:()=>pn.yHs,atan:()=>pn.rYl,atan2:()=>pn.FPz,atanh:()=>pn.rfv,avgPool:()=>pn.$jT,avgPool3d:()=>pn.sub,basicLSTMCell:()=>pn.lZX,batchNorm:()=>pn.$v7,batchNorm2d:()=>pn.BFc,batchNorm3d:()=>pn.kSi,batchNorm4d:()=>pn.T5N,batchToSpaceND:()=>pn.GTe,bincount:()=>pn.HbZ,bitwiseAnd:()=>pn.vjT,booleanMaskAsync:()=>pn.ftb,broadcastArgs:()=>pn.ROE,broadcastTo:()=>pn.hOW,buffer:()=>pn.ra8,cast:()=>pn.wgE,ceil:()=>pn.mkO,clipByValue:()=>pn.zQh,clone:()=>pn.o8B,complex:()=>pn.faB,concat:()=>pn.xWs,concat1d:()=>pn.I1m,concat2d:()=>pn.RPU,concat3d:()=>pn.O5O,concat4d:()=>pn.P1l,conv1d:()=>pn.kA9,conv2d:()=>pn.Xtf,conv2dTranspose:()=>pn.wX9,conv3d:()=>pn.IPL,conv3dTranspose:()=>pn.jIJ,cos:()=>pn.gnS,cosh:()=>pn.yIG,cosineWindow:()=>pn._jP,cumprod:()=>pn.Lp0,cumsum:()=>pn.rCv,denseBincount:()=>pn.aOp,depthToSpace:()=>pn.Rj8,depthwiseConv2d:()=>pn.Gl3,diag:()=>pn.smy,dilation2d:()=>pn.X7t,div:()=>pn.y4m,divNoNan:()=>pn.ek5,dot:()=>pn.Omf,dropout:()=>pn.EZY,einsum:()=>pn._3C,elu:()=>pn.Pqc,enclosingPowerOfTwo:()=>pn.FJY,ensureShape:()=>pn.QP2,equal:()=>pn.LCg,erf:()=>pn.Y12,euclideanNorm:()=>pn.p4S,exp:()=>pn.oNF,expandDims:()=>pn.UG6,expm1:()=>pn.IYd,eye:()=>pn.y5U,fft:()=>pn.hVP,fill:()=>pn.GSj,floor:()=>pn.RIf,floorDiv:()=>pn.wh_,fused:()=>pn.cZk,gather:()=>pn.kgh,gatherND:()=>pn.SY9,greater:()=>pn.rhj,greaterEqual:()=>pn.DQN,ifft:()=>pn.KGM,imag:()=>pn.ngS,image:()=>pn.Slp,inTopKAsync:()=>pn.U4u,irfft:()=>pn.ggX,isFinite:()=>pn.MIs,isInf:()=>pn.EN4,isNaN:()=>pn.yrW,leakyRelu:()=>pn.H8d,less:()=>pn.M7h,lessEqual:()=>pn.InN,linalg:()=>pn.mPL,linspace:()=>pn.mT8,localResponseNormalization:()=>pn.Kgs,log:()=>pn.Rm2,log1p:()=>pn.Kko,logSigmoid:()=>pn.nqI,logSoftmax:()=>pn.HPB,logSumExp:()=>pn.VZ,logicalAnd:()=>pn.n76,logicalNot:()=>pn.NSZ,logicalOr:()=>pn.ztW,logicalXor:()=>pn.rxB,losses:()=>pn.YYh,lowerBound:()=>pn.yzS,matMul:()=>pn.NoW,max:()=>pn.T9B,maxPool:()=>pn.jgi,maxPool3d:()=>pn.NYV,maxPoolWithArgmax:()=>pn.RO,maximum:()=>pn.PhQ,mean:()=>pn.i2o,meshgrid:()=>pn.OYQ,min:()=>pn.jkA,minimum:()=>pn.BpO,mirrorPad:()=>pn.FFZ,mod:()=>pn.ziu,moments:()=>pn.Clk,movingAverage:()=>pn.CRk,mul:()=>pn.lKK,multiRNNCell:()=>pn.YDF,multinomial:()=>pn.OjQ,neg:()=>pn.HZy,norm:()=>pn.xbf,notEqual:()=>pn.Ec,oneHot:()=>pn.Mw0,ones:()=>pn.SaS,onesLike:()=>pn.P61,op:()=>pn.op,outerProduct:()=>pn.X4o,pad:()=>pn.eVF,pad1d:()=>pn.BZs,pad2d:()=>pn.grY,pad3d:()=>pn.XHu,pad4d:()=>pn.WLX,pool:()=>pn.dzn,pow:()=>pn.n7C,prelu:()=>pn.NsG,print:()=>pn.yyV,prod:()=>pn._eU,raggedGather:()=>pn.whe,raggedRange:()=>pn.iyU,raggedTensorToTensor:()=>pn.Q0_,rand:()=>pn._9M,randomGamma:()=>pn.pR9,randomNormal:()=>pn.FE$,randomStandardNormal:()=>pn.m0H,randomUniform:()=>pn.YeY,randomUniformInt:()=>pn.HYA,range:()=>pn.y17,real:()=>pn.xav,reciprocal:()=>pn.VOZ,relu:()=>pn.VVh,relu6:()=>pn.j__,reshape:()=>pn.tQQ,reverse:()=>pn.BEg,reverse1d:()=>pn.QD2,reverse2d:()=>pn.LMr,reverse3d:()=>pn.I2l,reverse4d:()=>pn.JYU,rfft:()=>pn.z8$,round:()=>pn.LIG,rsqrt:()=>pn.Z$r,scalar:()=>pn.d_2,scatterND:()=>pn.NFr,searchSorted:()=>pn.sZg,selu:()=>pn.WfX,separableConv2d:()=>pn.wdz,setdiff1dAsync:()=>pn.F12,sigmoid:()=>pn.ry7,sign:()=>pn._SZ,signal:()=>pn.vPA,sin:()=>pn.F8e,sinh:()=>pn.L0l,slice:()=>pn.dik,slice1d:()=>pn.Q$M,slice2d:()=>pn.zAd,slice3d:()=>pn.wck,slice4d:()=>pn.R0O,softmax:()=>pn.Vs9,softplus:()=>pn.lw0,spaceToBatchND:()=>pn.eDJ,sparse:()=>pn.lMo,sparseToDense:()=>pn.Zhr,spectral:()=>pn.lOn,split:()=>pn.lDo,sqrt:()=>pn.RZD,square:()=>pn.EwI,squaredDifference:()=>pn.Pbu,squeeze:()=>pn.r2V,stack:()=>pn.t$z,step:()=>pn.PMw,stridedSlice:()=>pn.Ym9,string:()=>pn.YjP,sub:()=>pn.jbE,sum:()=>pn.czq,tan:()=>pn.Mlm,tanh:()=>pn.ymU,tensor:()=>pn.OEK,tensor1d:()=>pn.tGX,tensor2d:()=>pn.KtR,tensor3d:()=>pn.$_$,tensor4d:()=>pn.g9W,tensor5d:()=>pn.Lpo,tensor6d:()=>pn.yxw,tensorScatterUpdate:()=>pn.NNh,tile:()=>pn.Vsq,topk:()=>pn.rfw,transpose:()=>pn.mgz,truncatedNormal:()=>pn.efE,unique:()=>pn.AmM,unsortedSegmentSum:()=>pn.zAU,unstack:()=>pn.K$i,upperBound:()=>pn.rni,variable:()=>pn.bvq,where:()=>pn._M9,whereAsync:()=>pn.YJN,zeros:()=>pn.Ul9,zerosLike:()=>pn.POl});var Ft={};F.r(Ft),F.d(Ft,{CSVDataset:()=>DY,Dataset:()=>vh,FileDataSource:()=>qw,TextLineDataset:()=>MY,URLDataSource:()=>TS,array:()=>k2,csv:()=>ZF,func:()=>bm,generator:()=>S2,microphone:()=>zv,version_data:()=>AS,webcam:()=>eT,zip:()=>SS});var Qt={};F.r(Qt),F.d(Qt,{addImpl:()=>iT,bincountImpl:()=>tO,bincountReduceImpl:()=>BY,bitwiseAndImpl:()=>jY,castImpl:()=>nT,ceilImpl:()=>WY,concatImpl:()=>VY,equalImpl:()=>GY,expImpl:()=>oT,expm1Impl:()=>zg,floorDivImpl:()=>MS,floorImpl:()=>IS,gatherNdImpl:()=>DS,gatherV2Impl:()=>Zw,greaterEqualImpl:()=>RS,greaterImpl:()=>dT,lessEqualImpl:()=>qY,lessImpl:()=>rO,linSpaceImpl:()=>Uv,logImpl:()=>Qw,maxImpl:()=>Vv,maximumImpl:()=>Gv,minimumImpl:()=>XY,multiplyImpl:()=>aO,negImpl:()=>oO,notEqualImpl:()=>sO,prodImpl:()=>ql,raggedGatherImpl:()=>E2,raggedRangeImpl:()=>lO,raggedTensorToTensorImpl:()=>yT,rangeImpl:()=>hO,rsqrtImpl:()=>dO,scatterImpl:()=>T2,sigmoidImpl:()=>bT,simpleAbsImpl:()=>QF,sliceImpl:()=>wT,sparseFillEmptyRowsImpl:()=>nq,sparseReshapeImpl:()=>xT,sparseSegmentReductionImpl:()=>kT,sqrtImpl:()=>kct,squaredDifferenceImpl:()=>v0,staticRegexReplaceImpl:()=>ST,stridedSliceImpl:()=>pO,stringNGramsImpl:()=>sq,stringSplitImpl:()=>zS,stringToHashBucketFastImpl:()=>mO,subImpl:()=>CT,tileImpl:()=>lq,topKImpl:()=>gO,transposeImpl:()=>Jw,uniqueImpl:()=>hq});var Gt={};F.r(Gt),F.d(Gt,{assertNotComplex:()=>ab,bindCanvasToFramebuffer:()=>QT,bindColorTextureToFramebuffer:()=>fx,bindTextureToProgramUniformSampler:()=>Ug,bindTextureUnit:()=>Tm,bindVertexBufferToProgramAttribute:()=>ZT,callAndCheck:()=>ti,canBeRepresented:()=>fX,createFragmentShader:()=>yL,createFramebuffer:()=>KT,createProgram:()=>gX,createStaticIndexBuffer:()=>pp,createStaticVertexBuffer:()=>vL,createTexture:()=>e_,createVertexShader:()=>mX,getBatchDim:()=>nb,getExtensionOrThrow:()=>P2,getFramebufferErrorMessage:()=>px,getMaxTexturesInShader:()=>kL,getNumChannels:()=>vX,getProgramUniformLocation:()=>wL,getProgramUniformLocationOrThrow:()=>dx,getRowsCols:()=>rb,getShapeAs3D:()=>bh,getTextureShapeFromLogicalShape:()=>xL,getWebGLDisjointQueryTimerVersion:()=>Zl,getWebGLErrorMessage:()=>pX,getWebGLMaxTextureSize:()=>bX,hasExtension:()=>zu,isCapableOfRenderingToFloatTexture:()=>nA,isDownloadFloatTextureEnabled:()=>SL,isReshapeFree:()=>a_,isWebGLFenceEnabled:()=>s_,isWebGLVersionEnabled:()=>eA,linkProgram:()=>yX,logShaderSourceAndInfoLog:()=>qT,resetMaxTextureSize:()=>wX,resetMaxTexturesInShader:()=>ib,unbindColorTextureFromFramebuffer:()=>n_,unbindTextureUnit:()=>eb,validateFramebuffer:()=>r_,validateProgram:()=>XT,validateTextureSize:()=>bL});var ge={};F.r(ge),F.d(ge,{bindVertexProgramAttributeStreams:()=>LL,createBufferFromOutputTexture:()=>$L,createFloat16MatrixTexture:()=>RL,createFloat16PackedMatrixTexture:()=>_X,createFloat32MatrixTexture:()=>DL,createIndexBuffer:()=>dA,createPackedMatrixTexture:()=>OL,createUnsignedBytesMatrixTexture:()=>FL,createVertexBuffer:()=>NL,createVertexShader:()=>hA,downloadByteEncodedFloatMatrixFromOutputTexture:()=>Ml,downloadFloat32MatrixFromBuffer:()=>zL,downloadMatrixFromPackedOutputTexture:()=>BL,downloadPackedMatrixFromBuffer:()=>PL,getInternalFormatForFloat16MatrixTexture:()=>fA,getInternalFormatForFloat16PackedMatrixTexture:()=>gA,getInternalFormatForFloat32MatrixTexture:()=>ML,getInternalFormatForPackedMatrixTexture:()=>mA,getInternalFormatForUnsignedBytesMatrixTexture:()=>pA,uploadDenseMatrixToTexture:()=>c_,uploadPixelDataToTexture:()=>h_});var ee={};F.r(ee),F.d(ee,{Abs:()=>m.Abs,Acos:()=>m.Acos,Acosh:()=>m.Acosh,AdadeltaOptimizer:()=>m.AdadeltaOptimizer,AdagradOptimizer:()=>m.AdagradOptimizer,AdamOptimizer:()=>m.AdamOptimizer,AdamaxOptimizer:()=>m.AdamaxOptimizer,Add:()=>m.Add,AddN:()=>m.AddN,All:()=>m.All,Any:()=>m.Any,ArgMax:()=>m.ArgMax,ArgMin:()=>m.ArgMin,Asin:()=>m.Asin,Asinh:()=>m.Asinh,Atan:()=>m.Atan,Atan2:()=>m.Atan2,Atanh:()=>m.Atanh,AvgPool:()=>m.AvgPool,AvgPool3D:()=>m.AvgPool3D,AvgPool3DGrad:()=>m.AvgPool3DGrad,AvgPoolGrad:()=>m.AvgPoolGrad,BatchMatMul:()=>m.BatchMatMul,BatchToSpaceND:()=>m.BatchToSpaceND,Bincount:()=>m.Bincount,BitwiseAnd:()=>m.BitwiseAnd,BroadcastArgs:()=>m.BroadcastArgs,BroadcastTo:()=>m.BroadcastTo,Callback:()=>PE,CallbackList:()=>$G,Cast:()=>m.Cast,Ceil:()=>m.Ceil,ClipByValue:()=>m.ClipByValue,Complex:()=>m.Complex,ComplexAbs:()=>m.ComplexAbs,Concat:()=>m.Concat,Conv2D:()=>m.Conv2D,Conv2DBackpropFilter:()=>m.Conv2DBackpropFilter,Conv2DBackpropInput:()=>m.Conv2DBackpropInput,Conv3D:()=>m.Conv3D,Conv3DBackpropFilterV2:()=>m.Conv3DBackpropFilterV2,Conv3DBackpropInputV2:()=>m.Conv3DBackpropInputV2,Cos:()=>m.Cos,Cosh:()=>m.Cosh,CropAndResize:()=>m.CropAndResize,Cumprod:()=>m.Cumprod,Cumsum:()=>m.Cumsum,CustomCallback:()=>PG,DataStorage:()=>m.DataStorage,DenseBincount:()=>m.DenseBincount,DepthToSpace:()=>m.DepthToSpace,DepthwiseConv2dNative:()=>m.DepthwiseConv2dNative,DepthwiseConv2dNativeBackpropFilter:()=>m.DepthwiseConv2dNativeBackpropFilter,DepthwiseConv2dNativeBackpropInput:()=>m.DepthwiseConv2dNativeBackpropInput,Diag:()=>m.Diag,Dilation2D:()=>m.Dilation2D,Dilation2DBackpropFilter:()=>m.Dilation2DBackpropFilter,Dilation2DBackpropInput:()=>m.Dilation2DBackpropInput,Draw:()=>m.Draw,ENV:()=>m.ENV,EarlyStopping:()=>EF,Einsum:()=>m.Einsum,Elu:()=>m.Elu,EluGrad:()=>m.EluGrad,Environment:()=>m.Environment,Equal:()=>m.Equal,Erf:()=>m.Erf,Exp:()=>m.Exp,ExpandDims:()=>m.ExpandDims,Expm1:()=>m.Expm1,FFT:()=>m.FFT,Fill:()=>m.Fill,FlipLeftRight:()=>m.FlipLeftRight,Floor:()=>m.Floor,FloorDiv:()=>m.FloorDiv,FromPixels:()=>m.FromPixels,FusedBatchNorm:()=>m.FusedBatchNorm,FusedConv2D:()=>m.FusedConv2D,FusedDepthwiseConv2D:()=>m.FusedDepthwiseConv2D,GPGPUContext:()=>yA,GatherNd:()=>m.GatherNd,GatherV2:()=>m.GatherV2,GraphModel:()=>BF,Greater:()=>m.Greater,GreaterEqual:()=>m.GreaterEqual,History:()=>zG,IFFT:()=>m.IFFT,Identity:()=>m.Identity,Imag:()=>m.Imag,InputSpec:()=>La,IsFinite:()=>m.IsFinite,IsInf:()=>m.IsInf,IsNan:()=>m.IsNan,KernelBackend:()=>m.KernelBackend,LRN:()=>m.LRN,LRNGrad:()=>m.LRNGrad,LayerVariable:()=>To,LayersModel:()=>fm,LeakyRelu:()=>m.LeakyRelu,Less:()=>m.Less,LessEqual:()=>m.LessEqual,LinSpace:()=>m.LinSpace,Log:()=>m.Log,Log1p:()=>m.Log1p,LogSoftmax:()=>m.LogSoftmax,LogicalAnd:()=>m.LogicalAnd,LogicalNot:()=>m.LogicalNot,LogicalOr:()=>m.LogicalOr,LogicalXor:()=>m.LogicalXor,LowerBound:()=>m.LowerBound,MathBackendCPU:()=>Xw,MathBackendWebGL:()=>m_,MatrixBandPart:()=>m.MatrixBandPart,Max:()=>m.Max,MaxPool:()=>m.MaxPool,MaxPool3D:()=>m.MaxPool3D,MaxPool3DGrad:()=>m.MaxPool3DGrad,MaxPoolGrad:()=>m.MaxPoolGrad,MaxPoolWithArgmax:()=>m.MaxPoolWithArgmax,Maximum:()=>m.Maximum,Mean:()=>m.Mean,Min:()=>m.Min,Minimum:()=>m.Minimum,MirrorPad:()=>m.MirrorPad,Mod:()=>m.Mod,MomentumOptimizer:()=>m.MomentumOptimizer,Multinomial:()=>m.Multinomial,Multiply:()=>m.Multiply,Neg:()=>m.Neg,NonMaxSuppressionV3:()=>m.NonMaxSuppressionV3,NonMaxSuppressionV4:()=>m.NonMaxSuppressionV4,NonMaxSuppressionV5:()=>m.NonMaxSuppressionV5,NotEqual:()=>m.NotEqual,OP_SCOPE_SUFFIX:()=>m.OP_SCOPE_SUFFIX,OneHot:()=>m.OneHot,OnesLike:()=>m.OnesLike,Optimizer:()=>m.Optimizer,OptimizerConstructors:()=>m.OptimizerConstructors,Pack:()=>m.Pack,PadV2:()=>m.PadV2,Pool:()=>m.Pool,Pow:()=>m.Pow,Prelu:()=>m.Prelu,Prod:()=>m.Prod,RMSPropOptimizer:()=>m.RMSPropOptimizer,RNN:()=>f0,RaggedGather:()=>m.RaggedGather,RaggedRange:()=>m.RaggedRange,RaggedTensorToTensor:()=>m.RaggedTensorToTensor,Range:()=>m.Range,Rank:()=>m.Rank,Real:()=>m.Real,RealDiv:()=>m.RealDiv,Reciprocal:()=>m.Reciprocal,Reduction:()=>m.Reduction,Relu:()=>m.Relu,Relu6:()=>m.Relu6,Reshape:()=>m.Reshape,ResizeBilinear:()=>m.ResizeBilinear,ResizeBilinearGrad:()=>m.ResizeBilinearGrad,ResizeNearestNeighbor:()=>m.ResizeNearestNeighbor,ResizeNearestNeighborGrad:()=>m.ResizeNearestNeighborGrad,Reverse:()=>m.Reverse,RotateWithOffset:()=>m.RotateWithOffset,Round:()=>m.Round,Rsqrt:()=>m.Rsqrt,SGDOptimizer:()=>m.SGDOptimizer,ScatterNd:()=>m.ScatterNd,SearchSorted:()=>m.SearchSorted,Select:()=>m.Select,Selu:()=>m.Selu,Sequential:()=>Ig,Sigmoid:()=>m.Sigmoid,Sign:()=>m.Sign,Sin:()=>m.Sin,Sinh:()=>m.Sinh,Slice:()=>m.Slice,Softmax:()=>m.Softmax,Softplus:()=>m.Softplus,SpaceToBatchND:()=>m.SpaceToBatchND,SparseFillEmptyRows:()=>m.SparseFillEmptyRows,SparseReshape:()=>m.SparseReshape,SparseSegmentMean:()=>m.SparseSegmentMean,SparseSegmentSum:()=>m.SparseSegmentSum,SparseToDense:()=>m.SparseToDense,SplitV:()=>m.SplitV,Sqrt:()=>m.Sqrt,Square:()=>m.Square,SquaredDifference:()=>m.SquaredDifference,StaticRegexReplace:()=>m.StaticRegexReplace,Step:()=>m.Step,StridedSlice:()=>m.StridedSlice,StringNGrams:()=>m.StringNGrams,StringSplit:()=>m.StringSplit,StringToHashBucketFast:()=>m.StringToHashBucketFast,Sub:()=>m.Sub,Sum:()=>m.Sum,SymbolicTensor:()=>no,Tan:()=>m.Tan,Tanh:()=>m.Tanh,Tensor:()=>m.Tensor,TensorBuffer:()=>m.TensorBuffer,TensorScatterUpdate:()=>m.TensorScatterUpdate,Tile:()=>m.Tile,TopK:()=>m.TopK,Transform:()=>m.Transform,Transpose:()=>m.Transpose,Unique:()=>m.Unique,Unpack:()=>m.Unpack,UnsortedSegmentSum:()=>m.UnsortedSegmentSum,UpperBound:()=>m.UpperBound,Variable:()=>m.Variable,ZerosLike:()=>m.ZerosLike,_FusedMatMul:()=>m._FusedMatMul,abs:()=>m.abs,acos:()=>m.acos,acosh:()=>m.acosh,add:()=>m.add,addN:()=>m.addN,all:()=>m.all,any:()=>m.any,argMax:()=>m.argMax,argMin:()=>m.argMin,asin:()=>m.asin,asinh:()=>m.asinh,atan:()=>m.atan,atan2:()=>m.atan2,atanh:()=>m.atanh,avgPool:()=>m.avgPool,avgPool3d:()=>m.avgPool3d,backend:()=>m.backend,backend_util:()=>m.backend_util,basicLSTMCell:()=>m.basicLSTMCell,batchNorm:()=>m.batchNorm,batchNorm2d:()=>m.batchNorm2d,batchNorm3d:()=>m.batchNorm3d,batchNorm4d:()=>m.batchNorm4d,batchToSpaceND:()=>m.batchToSpaceND,bincount:()=>m.bincount,bitwiseAnd:()=>m.bitwiseAnd,booleanMaskAsync:()=>m.booleanMaskAsync,broadcastArgs:()=>m.broadcastArgs,broadcastTo:()=>m.broadcastTo,broadcast_util:()=>m.broadcast_util,browser:()=>m.browser,buffer:()=>m.buffer,callbacks:()=>rY,cast:()=>m.cast,ceil:()=>m.ceil,clipByValue:()=>m.clipByValue,clone:()=>m.clone,complex:()=>m.complex,concat:()=>m.concat,concat1d:()=>m.concat1d,concat2d:()=>m.concat2d,concat3d:()=>m.concat3d,concat4d:()=>m.concat4d,constraints:()=>L,conv1d:()=>m.conv1d,conv2d:()=>m.conv2d,conv2dTranspose:()=>m.conv2dTranspose,conv3d:()=>m.conv3d,conv3dTranspose:()=>m.conv3dTranspose,copyRegisteredKernels:()=>m.copyRegisteredKernels,cos:()=>m.cos,cosh:()=>m.cosh,cosineWindow:()=>m.cosineWindow,cumprod:()=>m.cumprod,cumsum:()=>m.cumsum,customGrad:()=>m.customGrad,data:()=>Ft,denseBincount:()=>m.denseBincount,deprecationWarn:()=>m.deprecationWarn,depthToSpace:()=>m.depthToSpace,depthwiseConv2d:()=>m.depthwiseConv2d,deregisterOp:()=>yh,device_util:()=>m.device_util,diag:()=>m.diag,dilation2d:()=>m.dilation2d,disableDeprecationWarnings:()=>m.disableDeprecationWarnings,dispose:()=>m.dispose,disposeVariables:()=>m.disposeVariables,div:()=>m.div,divNoNan:()=>m.divNoNan,dot:()=>m.dot,dropout:()=>m.dropout,einsum:()=>m.einsum,elu:()=>m.elu,enableDebugMode:()=>m.enableDebugMode,enableProdMode:()=>m.enableProdMode,enclosingPowerOfTwo:()=>m.enclosingPowerOfTwo,engine:()=>m.engine,ensureShape:()=>m.ensureShape,env:()=>m.env,equal:()=>m.equal,erf:()=>m.erf,euclideanNorm:()=>m.euclideanNorm,exp:()=>m.exp,expandDims:()=>m.expandDims,expm1:()=>m.expm1,eye:()=>m.eye,fft:()=>m.fft,fill:()=>m.fill,findBackend:()=>m.findBackend,findBackendFactory:()=>m.findBackendFactory,floor:()=>m.floor,floorDiv:()=>m.floorDiv,forceHalfFloat:()=>i$,fused:()=>m.fused,gather:()=>m.gather,gatherND:()=>m.gatherND,gather_util:()=>m.gather_util,getBackend:()=>m.getBackend,getGradient:()=>m.getGradient,getKernel:()=>m.getKernel,getKernelsForBackend:()=>m.getKernelsForBackend,gpgpu_util:()=>ge,grad:()=>m.grad,grads:()=>m.grads,greater:()=>m.greater,greaterEqual:()=>m.greaterEqual,ifft:()=>m.ifft,imag:()=>m.imag,image:()=>m.image,inTopKAsync:()=>m.inTopKAsync,initializers:()=>O,input:()=>uE,io:()=>m.io,irfft:()=>m.irfft,isFinite:()=>m.isFinite,isInf:()=>m.isInf,isNaN:()=>m.isNaN,keep:()=>m.keep,kernel_impls:()=>m.kernel_impls,layers:()=>S,leakyRelu:()=>m.leakyRelu,less:()=>m.less,lessEqual:()=>m.lessEqual,linalg:()=>m.linalg,linspace:()=>m.linspace,loadGraphModel:()=>Vc,loadGraphModelSync:()=>ict,loadLayersModel:()=>Dd,localResponseNormalization:()=>m.localResponseNormalization,log:()=>m.log,log1p:()=>m.log1p,logSigmoid:()=>m.logSigmoid,logSoftmax:()=>m.logSoftmax,logSumExp:()=>m.logSumExp,logicalAnd:()=>m.logicalAnd,logicalNot:()=>m.logicalNot,logicalOr:()=>m.logicalOr,logicalXor:()=>m.logicalXor,losses:()=>m.losses,lowerBound:()=>m.lowerBound,matMul:()=>m.matMul,math:()=>m.math,max:()=>m.max,maxPool:()=>m.maxPool,maxPool3d:()=>m.maxPool3d,maxPoolWithArgmax:()=>m.maxPoolWithArgmax,maximum:()=>m.maximum,mean:()=>m.mean,memory:()=>m.memory,meshgrid:()=>m.meshgrid,metrics:()=>B,min:()=>m.min,minimum:()=>m.minimum,mirrorPad:()=>m.mirrorPad,mod:()=>m.mod,model:()=>SR,models:()=>j,moments:()=>m.moments,movingAverage:()=>m.movingAverage,mul:()=>m.mul,multiRNNCell:()=>m.multiRNNCell,multinomial:()=>m.multinomial,neg:()=>m.neg,nextFrame:()=>m.nextFrame,norm:()=>m.norm,notEqual:()=>m.notEqual,oneHot:()=>m.oneHot,ones:()=>m.ones,onesLike:()=>m.onesLike,op:()=>m.op,outerProduct:()=>m.outerProduct,pad:()=>m.pad,pad1d:()=>m.pad1d,pad2d:()=>m.pad2d,pad3d:()=>m.pad3d,pad4d:()=>m.pad4d,pool:()=>m.pool,pow:()=>m.pow,prelu:()=>m.prelu,print:()=>m.print,prod:()=>m.prod,profile:()=>m.profile,raggedGather:()=>m.raggedGather,raggedRange:()=>m.raggedRange,raggedTensorToTensor:()=>m.raggedTensorToTensor,rand:()=>m.rand,randomGamma:()=>m.randomGamma,randomNormal:()=>m.randomNormal,randomStandardNormal:()=>m.randomStandardNormal,randomUniform:()=>m.randomUniform,randomUniformInt:()=>m.randomUniformInt,range:()=>m.range,ready:()=>m.ready,real:()=>m.real,reciprocal:()=>m.reciprocal,registerBackend:()=>m.registerBackend,registerCallbackConstructor:()=>iH,registerGradient:()=>m.registerGradient,registerKernel:()=>m.registerKernel,registerOp:()=>gm,regularizers:()=>K,relu:()=>m.relu,relu6:()=>m.relu6,removeBackend:()=>m.removeBackend,reshape:()=>m.reshape,reverse:()=>m.reverse,reverse1d:()=>m.reverse1d,reverse2d:()=>m.reverse2d,reverse3d:()=>m.reverse3d,reverse4d:()=>m.reverse4d,rfft:()=>m.rfft,round:()=>m.round,rsqrt:()=>m.rsqrt,scalar:()=>m.scalar,scatterND:()=>m.scatterND,scatter_util:()=>m.scatter_util,searchSorted:()=>m.searchSorted,selu:()=>m.selu,separableConv2d:()=>m.separableConv2d,sequential:()=>sE,serialization:()=>m.serialization,setBackend:()=>m.setBackend,setPlatform:()=>m.setPlatform,setWebGLContext:()=>dX,setdiff1dAsync:()=>m.setdiff1dAsync,shared:()=>Qt,sigmoid:()=>m.sigmoid,sign:()=>m.sign,signal:()=>m.signal,sin:()=>m.sin,sinh:()=>m.sinh,slice:()=>m.slice,slice1d:()=>m.slice1d,slice2d:()=>m.slice2d,slice3d:()=>m.slice3d,slice4d:()=>m.slice4d,slice_util:()=>m.slice_util,softmax:()=>m.softmax,softplus:()=>m.softplus,spaceToBatchND:()=>m.spaceToBatchND,sparse:()=>m.sparse,sparseToDense:()=>m.sparseToDense,spectral:()=>m.spectral,split:()=>m.split,sqrt:()=>m.sqrt,square:()=>m.square,squaredDifference:()=>m.squaredDifference,squeeze:()=>m.squeeze,stack:()=>m.stack,step:()=>m.step,stridedSlice:()=>m.stridedSlice,string:()=>m.string,sub:()=>m.sub,sum:()=>m.sum,sumOutType:()=>m.sumOutType,tan:()=>m.tan,tanh:()=>m.tanh,tensor:()=>m.tensor,tensor1d:()=>m.tensor1d,tensor2d:()=>m.tensor2d,tensor3d:()=>m.tensor3d,tensor4d:()=>m.tensor4d,tensor5d:()=>m.tensor5d,tensor6d:()=>m.tensor6d,tensorScatterUpdate:()=>m.tensorScatterUpdate,tensor_util:()=>m.tensor_util,test_util:()=>m.test_util,tidy:()=>m.tidy,tile:()=>m.tile,time:()=>m.time,topk:()=>m.topk,train:()=>m.train,transpose:()=>m.transpose,truncatedNormal:()=>m.truncatedNormal,unique:()=>m.unique,unregisterGradient:()=>m.unregisterGradient,unregisterKernel:()=>m.unregisterKernel,unsortedSegmentSum:()=>m.unsortedSegmentSum,unstack:()=>m.unstack,upcastType:()=>m.upcastType,upperBound:()=>m.upperBound,util:()=>m.util,valueAndGrad:()=>m.valueAndGrad,valueAndGrads:()=>m.valueAndGrads,variable:()=>m.variable,variableGrads:()=>m.variableGrads,version:()=>kdt,version_converter:()=>jF,version_core:()=>m.version_core,version_cpu:()=>dq,version_layers:()=>oE,version_webgl:()=>r$,webgl:()=>_ht,webgl_util:()=>Gt,where:()=>m.where,whereAsync:()=>m.whereAsync,zeros:()=>m.zeros,zerosLike:()=>m.zerosLike});var Ee={};F.r(Ee),F.d(Ee,{hasBrowserEnv:()=>gz,hasStandardBrowserEnv:()=>eQ,hasStandardBrowserWebWorkerEnv:()=>Zx,navigator:()=>yz,origin:()=>Mdt});var Bt={};F.r(Bt),F.d(Bt,{load:()=>IB,version:()=>L4});var Xt={};F.r(Xt),F.d(Xt,{Darknet:()=>K7,load:()=>X0t});var we={};F.r(we),F.d(we,{Doodlenet:()=>oet,load:()=>K0t});var ie={};F.r(ie),F.d(ie,{SpeechCommands:()=>lC,load:()=>bet});var m=F(5838),ye=F(5441),Ge=F(9809),te=F(9258),Me=F(700);let Ye={kernelName:ye.ljI,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,te.l)(l,(0,Me.P)((0,Ge.w)(o,"float32"),-1))}}};var Ue=F(9359),kn=F(6522),mn=F(5702),Kn=F(9348),Sn=F(5793),Wn=F(7126);let Ze={kernelName:ye.Vvy,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>{let u=(0,Sn.E)((0,Ge.w)(o,"float32")),c=(0,Kn.R)((0,Wn.j)((0,mn.d)(1),u));return(0,kn.H)((0,Ue.y)(l,c))}}}},de={kernelName:ye.PH8,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>{let u=(0,Kn.R)((0,Wn.j)((0,Sn.E)((0,Ge.w)(o,"float32")),1));return(0,Ue.y)(l,u)}}}};var Re=F(2198),Kt=F(2302),Jt=F(3791);let Ae={kernelName:ye.OMN,inputsToSave:["a","b"],gradFunc:(l,i)=>{let[o,u]=i,c=Re.assertAndGetBroadcastShape(o.shape,u.shape);return{a:()=>{let f=l,y=Re.getReductionAxes(o.shape,c);return y.length>0&&(f=(0,Jt.c)(f,y)),(0,Kt.t)(f,o.shape)},b:()=>{let f=l,y=Re.getReductionAxes(u.shape,c);return y.length>0&&(f=(0,Jt.c)(f,y)),(0,Kt.t)(f,u.shape)}}}},$e={kernelName:ye.EkD,saveAllInputs:!0,gradFunc:(l,i)=>{let o={};return i.forEach((u,c)=>{o[c]=()=>l.clone()}),o}};var tn=F(5537);let wn={kernelName:ye.Jp_,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,tn.P)(o)}}},Mn={kernelName:ye.p_m,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,tn.P)(o)}}},Hn={kernelName:ye.QKF,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,Ue.y)(l,(0,Kn.R)((0,Wn.j)((0,mn.d)(1),(0,Sn.E)((0,Ge.w)(o,"float32")))))}}};var Zn=F(7523);let _r={kernelName:ye.epO,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>{let u=(0,Kn.R)((0,Zn.W)((0,mn.d)(1),(0,Sn.E)((0,Ge.w)(o,"float32"))));return(0,Ue.y)(l,u)}}}},Sr={kernelName:ye.lxb,inputsToSave:["a","b"],gradFunc:(l,i)=>{let[o,u]=i,c=(0,Re.assertAndGetBroadcastShape)(o.shape,u.shape);return{a:()=>{let f=(0,Zn.W)((0,Sn.E)(o),(0,Sn.E)(u)),y=(0,te.l)(l,(0,Ue.y)(u,f)),w=(0,Re.getReductionAxes)(o.shape,c);return w.length>0&&(y=(0,Jt.c)(y,w)),(0,Kt.t)(y,o.shape)},b:()=>{let f=(0,Zn.W)((0,Sn.E)(o),(0,Sn.E)(u)),y=(0,kn.H)((0,te.l)(l,(0,Ue.y)(o,f))),w=(0,Re.getReductionAxes)(u.shape,c);return w.length>0&&(y=(0,Jt.c)(y,w)),(0,Kt.t)(y,u.shape)}}}},Mr={kernelName:ye.TyE,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,Ue.y)(l,(0,Zn.W)((0,Sn.E)((0,Ge.w)(o,"float32")),1))}}},ai={kernelName:ye.zP9,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,Ue.y)(l,(0,Wn.j)((0,mn.d)(1),(0,Sn.E)((0,Ge.w)(o,"float32"))))}}};var ea=F(1585),Pi=F(8189),Cr=F(5119),Ti=F(7195),Be=F(929);let En=(0,Be.op)({avgPool3dGrad_:function(l,i,o,u,c,f){let y=(0,Pi.YT)(l,"dy","avgPool3dGrad"),w=(0,Pi.YT)(i,"input","avgPool3dGrad"),C=y,T=w,x=!1;w.rank===4&&(x=!0,C=(0,Kt.t)(y,[1,y.shape[0],y.shape[1],y.shape[2],y.shape[3]]),T=(0,Kt.t)(w,[1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]])),Cr.vA(C.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${C.rank}.`),Cr.vA(T.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${T.rank}.`),(0,Ti.s_)("avgPool3dGrad",c,f);let A={dy:C,input:T},M={filterSize:o,strides:u,pad:c,dimRoundingMode:f},$=ea.T2.runKernel(ye.wwC,A,M);return x?(0,Kt.t)($,[$.shape[1],$.shape[2],$.shape[3],$.shape[4]]):$}}),lr={kernelName:ye.cS,inputsToSave:["x"],gradFunc:(l,i,o)=>{let[u]=i,{filterSize:c,strides:f,pad:y,dimRoundingMode:w}=o;return{x:()=>En(l,u,c,f,y,w)}}},qn=(0,Be.op)({avgPoolGrad_:function(l,i,o,u,c){let f=(0,Pi.YT)(l,"dy","avgPoolGrad"),y=(0,Pi.YT)(i,"input","avgPoolGrad");Cr.vA(y.rank===f.rank,()=>`Rank of input (${y.rank}) does not match rank of dy (${f.rank})`);let w=y,C=f,T=!1;y.rank===3&&(T=!0,w=(0,Kt.t)(y,[1,y.shape[0],y.shape[1],y.shape[2]]),C=(0,Kt.t)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),Cr.vA(C.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${C.rank}.`),Cr.vA(w.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${w.rank}.`);let x={dy:C,input:w},A={filterSize:o,strides:u,pad:c},M=ea.T2.runKernel(ye.VCH,x,A);return T?(0,Kt.t)(M,[M.shape[1],M.shape[2],M.shape[3]]):M}}),fr={kernelName:ye.ho8,inputsToSave:["x"],gradFunc:(l,i,o)=>{let[u]=i,{filterSize:c,strides:f,pad:y}=o;return{x:()=>qn(l,u,c,f,y)}}};var Er=F(5703);let Qr={kernelName:ye.jAQ,inputsToSave:["a","b"],gradFunc:(l,i,o)=>{let[u,c]=i,{transposeA:f,transposeB:y}=o;return f||y?!f&&y?{a:()=>(0,Er.N)(l,c,!1,!1),b:()=>(0,Er.N)(l,u,!0,!1)}:f&&!y?{a:()=>(0,Er.N)(c,l,!1,!0),b:()=>(0,Er.N)(u,l,!1,!1)}:{a:()=>(0,Er.N)(c,l,!0,!0),b:()=>(0,Er.N)(l,u,!0,!0)}:{a:()=>(0,Er.N)(l,c,!1,!0),b:()=>(0,Er.N)(u,l,!0,!1)}}};var vi=F(776);let ua={kernelName:ye.Ik2,gradFunc:(l,i,o)=>{let{blockShape:u,crops:c}=o;return{x:()=>(0,vi.e)(l,u,c)}}},br={kernelName:ye.LB5,gradFunc:(l,i,o)=>{let u=o,c=u.inputShape,f=u.shape,y=Array.from(f);for(let C=c.length-1;C>=0;C--)if(c[C]===f[C])y[C]=1;else if(c[C]!==1)throw new Error(`broadcastTo(): [${c}] cannot be broadcast to [${f}].`);let w=[];for(let C=0;C<y.length;C++)y[C]>1&&w.push(C);return{x:()=>(0,Jt.c)(l,w,!0)}}},eo={kernelName:ye.KXH,gradFunc:l=>({x:()=>l.clone()})},Fo={kernelName:ye.QDP,gradFunc:l=>({x:()=>(0,tn.P)(l)})};var Wa=F(3337),Le=F(6508),bn=F(3789),jn=F(2151);let Jn={kernelName:ye.vaV,inputsToSave:["x"],gradFunc:(l,i,o)=>{let[u]=i,{clipValueMin:c,clipValueMax:f}=o;return{x:()=>(0,jn._)((0,bn.n)((0,Wa.D)(u,c),(0,Le.I)(u,f)),l,(0,tn.P)(l))}}},dr={kernelName:ye.$zE,inputsToSave:["x"],gradFunc:Ye.gradFunc};var Ur=F(6512);let or={kernelName:ye.$dB,saveAllInputs:!0,gradFunc:(l,i,o)=>{let u=i.map(w=>w.shape),{axis:c}=o,f=(0,Cr.Y6)(c,i[0].shape)[0],y=u.map(w=>w[f]);return(0,Ur.l)(l,y,f).map(w=>()=>w)}};var Yn=F(5248),li=F(252);let Ki={kernelName:ye.p2J,inputsToSave:["x","filter"],gradFunc:(l,i,o)=>{let[u,c]=i,{dilations:f,strides:y,pad:w,dataFormat:C}=o;return Cr.vA(Ti.Dh(f),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${f}'`),{x:()=>(0,li.v)(u.shape,l,c,y,w,C),filter:()=>(0,Yn.H)(u,l,c.shape,y,w,C)}}};var Si=F(8794);let Da={kernelName:ye.jfg,inputsToSave:["dy","filter"],gradFunc:(l,i,o)=>{let[u,c]=i,{strides:f,pad:y,dataFormat:w,dimRoundingMode:C}=o;return{dy:()=>(0,Si.X)(l,c,f,y,w,1,C),filter:()=>(0,Yn.H)(l,u,c.shape,f,y,w,C)}}},_i=(0,Be.op)({conv3DBackpropFilter_:function(l,i,o,u,c){let f=l;l.rank===4&&(f=(0,Kt.t)(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]));let y=i;y.rank===4&&(y=(0,Kt.t)(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),Cr.vA(f.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${f.shape}.`),Cr.vA(y.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${y.shape}.`),Cr.vA(o.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${o}.`),Cr.vA(f.shape[4]===o[3],()=>`Error in conv3dDerFilter: depth of input ${f.shape[4]}) must match input depth in filter (${o[3]}.`),Cr.vA(y.shape[4]===o[4],()=>`Error in conv3dDerFilter: depth of dy (${y.shape[4]}) must match output depth for filter (${o[4]}).`);let w={x:f,dy:y},C={strides:u,pad:c,filterShape:o};return ea.T2.runKernel(ye.iGz,w,C)}});var la=F(1895);let so={kernelName:ye.A1h,inputsToSave:["x","filter"],gradFunc:(l,i,o)=>{let{dilations:u,strides:c,pad:f}=o;Cr.vA((0,Ti.Dh)(u),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${u}'`);let[y,w]=i;return{x:()=>(0,la.c)(y.shape,l,w,c,f),filter:()=>_i(y,l,w.shape,c,f)}}};var ys=F(3726);let vs={kernelName:ye.Mn0,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,te.l)((0,kn.H)((0,ys.F)((0,Ge.w)(o,"float32"))),l)}}};var qo=F(8276);let bs={kernelName:ye.MnK,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,te.l)((0,qo.L)((0,Ge.w)(o,"float32")),l)}}};var na=F(1078),va=F(6808),Ya=F(7703);let Xo={kernelName:ye.nY8,inputsToSave:["x"],gradFunc:(l,i,o)=>{let[u]=i,{axis:c,exclusive:f,reverse:y}=o;return{x:()=>{let w=(0,na.Em)([c],u.rank),C=(0,va.r)(l,c,f,!y);return w!=null&&(C=(0,Ya.m)(C,w)),C}}}};var Du=F(1890),uu=F(3134);let ws={kernelName:ye.tGH,inputsToSave:["x","filter"],gradFunc:(l,i,o)=>{let{dilations:u,strides:c,pad:f,dimRoundingMode:y}=o,w=u??[1,1];Cr.vA(Ti.Dh(w),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${w}'`);let[C,T]=i;return Cr.vA(C.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${C.rank}.`),Cr.vA(T.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${T.rank}.`),Cr.vA(C.shape[3]===T.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${C.shape[3]}) must match the inChannels dimension in filter ${T.shape[2]}.`),Cr.vA(Ti.G0(c,w),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${c} and dilations '${w}'.`),Ti.s_("depthwiseConv2d",f,y),{x:()=>(0,uu.l)(C.shape,l,T,c,f,w,y),filter:()=>(0,Du.x)(C,l,T.shape,c,f,w,y)}}},Ra={kernelName:ye.jxD,inputsToSave:["x","filter"],gradFunc:(l,i,o)=>{let[u,c]=i,f={x:u,filter:c,dy:l},y={x:u,filter:c,dy:l};return{x:()=>ea.T2.runKernel(ye.bP9,f,o),filter:()=>ea.T2.runKernel(ye.pk0,y,o)}}},Ru={kernelName:ye.Pah,outputsToSave:[!0],gradFunc:(l,i)=>{let[o]=i,u={dy:l,y:o};return{x:()=>ea.T2.runKernel(ye.rsH,u)}}};var Ko=F(8631);let Ga={kernelName:ye._s9,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i,u=(0,te.l)((0,Ko.o)((0,kn.H)((0,Sn.E)(o))),2/Math.sqrt(Math.PI));return{x:()=>(0,te.l)(l,u)}}},Fu={kernelName:ye.ox3,outputsToSave:[!0],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,te.l)(l,o)}}},Zs={kernelName:ye.ybN,inputsToSave:["input"],gradFunc:(l,i)=>{let[o]=i;return{input:()=>(0,Kt.t)(l,o.shape)}}},Rc={kernelName:ye.ybj,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,te.l)(l,(0,Ko.o)(o))}}},bu={kernelName:ye.ZgB,gradFunc:l=>({x:()=>(0,tn.P)(l)})},Qs={kernelName:ye.ElG,inputsToSave:["a","b"],gradFunc:(l,i)=>{let[o,u]=i,c=(0,Re.assertAndGetBroadcastShape)(o.shape,u.shape);return{a:()=>{let f=(0,Ue.y)(l,(0,Ge.w)(u,"float32")),y=(0,Re.getReductionAxes)(o.shape,c);return y.length>0?(0,Kt.t)((0,Jt.c)(f,y),o.shape):f},b:()=>{let f=(0,te.l)(l,(0,Ge.w)(o,"float32")),y=(0,Re.getReductionAxes)(u.shape,c);y.length>0&&(f=(0,Kt.t)((0,Jt.c)(f,y),u.shape));let w=(0,Sn.E)(u);return(0,kn.H)((0,Ue.y)(f,(0,Ge.w)(w,"float32")))}}}};var wu=F(7820),Tl=F(4826);let Zo={kernelName:ye.i5R,inputsToSave:["x","mean","variance","scale"],gradFunc:(l,i,o)=>{let{varianceEpsilon:u}=o,[c,f,y,w]=i,C=w??(0,mn.d)(1),T=(0,Re.getReductionAxes)(f.shape,c.shape),x=[];if(f.rank===1){for(let G=0;G<c.shape.length-1;++G)x.push(c.shape[G]);x.push(1)}let A=(0,Wn.j)(c,f),M=(0,te.l)(l,C),$=(0,wu.Z)((0,Zn.W)(y,(0,mn.d)(u))),V=(0,te.l)((0,te.l)((0,te.l)($,$),$),(0,mn.d)(-.5));return{x:()=>f.rank===1?(0,Kt.t)((0,te.l)((0,te.l)(l,(0,Tl.V)((0,Kt.t)($,[1,1,1,f.shape[0]]),x)),C),c.shape):(0,Kt.t)((0,te.l)((0,te.l)(l,$),C),c.shape),mean:()=>{let G=(0,te.l)((0,te.l)($,(0,mn.d)(-1)),M);return f.rank===1&&(G=(0,Jt.c)(G,T)),(0,Kt.t)(G,f.shape)},variance:()=>{let G=(0,te.l)((0,te.l)(V,A),M);return f.rank===1&&(G=(0,Jt.c)(G,T)),(0,Kt.t)(G,f.shape)},scale:()=>{let G=(0,te.l)(A,$),Q=(0,te.l)(l,G);return f.rank===1&&(Q=(0,Jt.c)(Q,T)),(0,Kt.t)(Q,f.shape)},offset:()=>{let G=l;return f.rank===1&&(G=(0,Jt.c)(G,T)),(0,Kt.t)(G,f.shape)}}}};var ji=F(4268),Ku=F(7706);let Zu={kernelName:ye.mxL,inputsToSave:["x","indices"],gradFunc:(l,i,o)=>{let[u,c]=i,{axis:f,batchDims:y}=o,w=(0,Cr.Y6)(f,u.shape)[0],C=(T,x,A)=>()=>{let M=T.shape,$=x.size,V=M.slice(0,w),G=V.length,Q=M.slice(f,M.length).slice(1),nt=Q.length,it=xs(0,G),ht=xs(G+1,G+1+nt),kt=xu([V,[$],Q]),Nt=(0,Kt.t)(A,kt),$t=(0,Kt.t)(x,[$]),Ut=xu([[G],it,ht]),Pt=(0,Ya.m)(Nt,Ut),re=(0,Ku.z)(Pt,$t,T.shape[w]),ue=(0,na.gx)(Ut);return re=(0,Ya.m)(re,ue),re};if(y===1){let T=u.shape[0],x=u.split(T,0);return{x:()=>(0,ji.t)(x.map((M,$)=>C(M,c.slice($,1),l.slice($,1))())).reshape(u.shape),indices:()=>c}}return{x:C(u,c,l),indices:()=>c}}};function xs(l,i){let o=[];for(let u=l;u<i;++u)o.push(u);return o}function xu(l){let i=[];for(let o=0;o<l.length;++o)for(let u=0;u<l[o].length;++u)i.push(l[o][u]);return i}let pa={kernelName:ye.lLS,inputsToSave:["a","b"],gradFunc:(l,i)=>{let[o,u]=i;return{a:()=>(0,tn.P)(o),b:()=>(0,tn.P)(u)}}},_n={kernelName:ye.lzr,gradFunc:l=>({x:()=>(0,Ge.w)(l,"float32")})},ls={kernelName:ye.gIW,gradFunc:l=>({x:()=>(0,tn.P)(l)})},Dt={kernelName:ye.E3$,gradFunc:l=>({x:()=>(0,tn.P)(l)})},Zt={kernelName:ye.iPs,gradFunc:l=>({x:()=>(0,tn.P)(l)})};var Ce=F(2058);let le={kernelName:ye.X0$,inputsToSave:["x"],gradFunc:(l,i,o)=>{let[u]=i,{alpha:c}=o,f=(0,Ce.r)(u,0);return{x:()=>(0,jn._)(f,l,(0,te.l)(l,c))}}},Pe={kernelName:ye.Cg$,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,Ue.y)(l,(0,Zn.W)(o,1))}}},rn={kernelName:ye.tG8,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,Ue.y)(l,(0,Ge.w)(o,"float32"))}}},Cn={kernelName:ye.zfU,inputsToSave:[],outputsToSave:[!0],gradFunc:(l,i,o)=>{let[u]=i,{axis:c}=o;return{logits:()=>{let f=(0,Ko.o)(u);return(0,Wn.j)(l,(0,te.l)((0,Jt.c)(l,c,!0),f))}}}},Vn=(0,Be.op)({localResponseNormalizationBackprop_:function(l,i,o,u=5,c=1,f=1,y=.5){let w={x:l,y:i,dy:o},C={depthRadius:u,bias:c,alpha:f,beta:y};return ea.T2.runKernel(ye.ToN,w,C)}}),hr={kernelName:ye.jM4,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(l,i,o)=>{let[u,c]=i,{depthRadius:f,bias:y,alpha:w,beta:C}=o;return{x:()=>Vn(u,c,l,f,y,w,C)}}};var Kr=F(3020);function $i(l,i,o,u){return i.rank<o.rank&&(i=(0,Kt.t)(i,na.SM(i.shape,u))),l.rank<o.rank&&(l=(0,Kt.t)(l,na.SM(l.shape,u))),{x:()=>(0,te.l)(l,(0,Ge.w)((0,Kr.L)(o,i),l.dtype))}}let Ai={kernelName:ye.VAI,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(l,i,o)=>{let u=o,{reductionIndices:c}=u,f=i[0],y=$i(l,i[1],f,Cr.Y6(c,f.shape));return{x:()=>y.x()}}};var Rr=F(1303);let Jr={kernelName:ye.LDN,inputsToSave:["a","b"],gradFunc:(l,i)=>{let[o,u]=i;return{a:()=>(0,te.l)(l,(0,Ge.w)((0,Wa.D)(o,u),"float32")),b:()=>(0,te.l)(l,(0,Ge.w)((0,Rr.M)(o,u),"float32"))}}},di=(0,Be.op)({maxPool3dGrad_:function(l,i,o,u,c,f,y){let w=(0,Pi.YT)(l,"dy","maxPool3dGrad"),C=(0,Pi.YT)(i,"input","maxPool3dGrad"),T=(0,Pi.YT)(o,"output","maxPool3dGrad"),x=w,A=C,M=T,$=!1;C.rank===4&&($=!0,x=(0,Kt.t)(w,[1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]]),A=(0,Kt.t)(C,[1,C.shape[0],C.shape[1],C.shape[2],C.shape[3]]),M=(0,Kt.t)(T,[1,T.shape[0],T.shape[1],T.shape[2],T.shape[3]])),Cr.vA(x.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${x.rank}.`),Cr.vA(A.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${A.rank}.`),Cr.vA(M.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${M.rank}.`),(0,Ti.s_)("maxPool3dGrad",f,y);let V={dy:x,input:A,output:M},G={filterSize:u,strides:c,pad:f,dimRoundingMode:y},Q=ea.T2.runKernel(ye.cHb,V,G);return $?(0,Kt.t)(Q,[Q.shape[1],Q.shape[2],Q.shape[3],Q.shape[4]]):Q}}),bi={kernelName:ye.ySp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(l,i,o)=>{let[u,c]=i,{filterSize:f,strides:y,pad:w,dimRoundingMode:C}=o;return{x:()=>di(l,u,c,f,y,w,C)}}},Ci=(0,Be.op)({maxPoolGrad_:function(l,i,o,u,c,f,y){let w=(0,Pi.YT)(l,"dy","maxPoolGrad"),C=(0,Pi.YT)(i,"input","maxPoolGrad"),T=(0,Pi.YT)(o,"output","maxPoolGrad");Cr.vA(C.rank===w.rank,()=>`Rank of input (${C.rank}) does not match rank of dy (${w.rank})`),Cr.vA(w.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${w.rank}.`),Cr.vA(C.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${C.rank}.`),Ti.s_("maxPoolGrad",f,y);let x={dy:w,input:C,output:T},A={filterSize:u,strides:c,pad:f,dimRoundingMode:y};return ea.T2.runKernel(ye.RXX,x,A)}}),ra={kernelName:ye.t3d,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(l,i,o)=>{let[u,c]=i,{filterSize:f,strides:y,pad:w}=o;return{x:()=>Ci(l,u,c,f,y,w)}}};var oa=F(1411);let Wr={kernelName:ye.g5A,inputsToSave:["x"],gradFunc:(l,i,o)=>{let[u]=i,{axis:c}=o,f=Cr.Y6(c,u.shape),y=(0,na.lb)(u.shape,f)[1],w=Cr.Ze(y);return{x:()=>{let C=u.shape.slice();f.forEach(x=>{C[x]=1});let T=(0,Kt.t)(l,C);return(0,Ue.y)((0,te.l)(T,(0,oa.S)(u.shape,"float32")),w)}}}},_a={kernelName:ye.lNG,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(l,i,o)=>{let u=o,{axis:c}=u,[f,y]=i,w=$i(l,y,f,Cr.Y6(c,f.shape));return{x:()=>w.x()}}},Ca={kernelName:ye.LG0,inputsToSave:["a","b"],gradFunc:(l,i)=>{let[o,u]=i;return{a:()=>(0,te.l)(l,(0,Ge.w)((0,Le.I)(o,u),"float32")),b:()=>(0,te.l)(l,(0,Ge.w)((0,Ce.r)(o,u),"float32"))}}};var Gi=F(7986);let Ea={kernelName:ye.x7F,inputsToSave:["x"],gradFunc:(l,i,o)=>{let u=i[0],{paddings:c}=o,f=c.map(y=>y[0]);return{x:()=>(0,Gi.d)(l,f,u.shape)}}};var Ta=F(5606);let Dn={kernelName:ye.BLA,inputsToSave:["a","b"],gradFunc:(l,i)=>{let[o,u]=i,c=(0,Re.assertAndGetBroadcastShape)(o.shape,u.shape);return{a:()=>{let f=(0,Re.getReductionAxes)(o.shape,c);return f.length>0?(0,Kt.t)((0,Jt.c)(l,f),o.shape):l},b:()=>{let f=(0,te.l)(l,(0,kn.H)((0,Ta.R)((0,Ue.y)(o,u)))),y=(0,Re.getReductionAxes)(u.shape,c);return y.length>0?(0,Kt.t)((0,Jt.c)(f,y),u.shape):f}}}},Ui={kernelName:ye.xu7,inputsToSave:["a","b"],gradFunc:(l,i)=>{let[o,u]=i,c=(0,Re.assertAndGetBroadcastShape)(o.shape,u.shape);return{a:()=>{let f=(0,te.l)(l,(0,Ge.w)(u,"float32")),y=(0,Re.getReductionAxes)(o.shape,c);return y.length>0?(0,Kt.t)((0,Jt.c)(f,y),o.shape):f},b:()=>{let f=(0,te.l)(l,(0,Ge.w)(o,"float32")),y=(0,Re.getReductionAxes)(u.shape,c);return y.length>0?(0,Kt.t)((0,Jt.c)(f,y),u.shape):f}}}},sa={kernelName:ye.l0G,gradFunc:l=>({x:()=>(0,kn.H)(l)})};var ks=F(2855);let Po={kernelName:ye.urI,inputsToSave:["indices"],gradFunc:(l,i)=>{let o=i[0];return{indices:()=>(0,ks.U)(o.shape,"float32")}}},ku={kernelName:ye.LWX,gradFunc:l=>({x:()=>(0,tn.P)(l)})};var io=F(7261);let an={kernelName:ye.mM$,saveAllInputs:!0,gradFunc:(l,i,o)=>{let{axis:u}=o;return(0,io.K)(l,u).map(c=>()=>c)}},Ms={kernelName:ye.ODT,inputsToSave:["x"],gradFunc:(l,i,o)=>{let u=i[0],{paddings:c}=o,f=c.map(y=>y[0]);return{x:()=>(0,Gi.d)(l,f,u.shape)}}};var lu=F(4010),Ul=F(8990);let Ou={kernelName:ye.pyJ,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(l,i)=>{let[o,u,c]=i,f=o,y=u,w=Re.assertAndGetBroadcastShape(f.shape,y.shape);return{a:()=>{let C=(0,Ge.w)(y,"float32"),T=(0,te.l)(l,(0,te.l)(C,(0,Ul.n)(f,(0,Wn.j)(C,(0,mn.d)(1))))),x=Re.getReductionAxes(f.shape,w);return x.length>0&&(T=(0,Jt.c)(T,x)),(0,Kt.t)(T,f.shape)},b:()=>{let C=(0,Ce.r)(f,0),T=(0,jn._)(C,(0,lu.R)(f),(0,tn.P)(f)),x=(0,te.l)(l,(0,te.l)(c,T)),A=Re.getReductionAxes(y.shape,w);return A.length>0&&(x=(0,Jt.c)(x,A)),(0,Kt.t)(x,y.shape)}}}},Lu={kernelName:ye.Ncv,inputsToSave:["x","alpha"],gradFunc:(l,i)=>{let[o,u]=i,c=(0,Ce.r)(o,0);return{x:()=>(0,jn._)(c,l,(0,te.l)(l,u)),alpha:()=>{let f=(0,jn._)(c,(0,tn.P)(l),(0,te.l)(l,o)),y=(0,Re.getReductionAxes)(u.shape,l.shape);return y.length>0&&(f=(0,Jt.c)(f,y)),(0,Kt.t)(f,u.shape)}}}};var Ed=F(302);function Fc(l,i,o){let u=l.shape.length,c=u-o.length,f=na.Em(o,u),y=l;f!=null&&(y=(0,Ya.m)(l,f));let w=y.shape.slice(),C=w.splice(u-o.length,o.length).reduce((x,A)=>x*A,1);w.push(C);let T=function(x,A,M){let $=x.shape.slice();$[M]=1;let V=(0,Kt.t)(A,$),G=(0,Ed.L)(x,M,!0,!1),Q=(0,Ed.L)(x,M,!0,!0),nt=(0,te.l)(G,Q);return(0,te.l)(V,nt)}(y.reshape(w),i,c);if(T=T.reshape(y.shape),f!=null){let x=na.gx(f);T=(0,Ya.m)(T,x)}return T}let ni={kernelName:ye.kdj,inputsToSave:["x"],gradFunc:(l,i,o)=>{let[u]=i,{axis:c}=o,f=[];return f=c==null?u.shape.map((y,w)=>w):typeof c=="number"?[c]:c,{x:()=>Fc(u,l,f)}}},Zr={kernelName:ye.sDr,inputsToSave:["a","b"],gradFunc:(l,i)=>{let[o,u]=i,c=Re.assertAndGetBroadcastShape(o.shape,u.shape);return{a:()=>{let f=(0,Ue.y)(l,(0,Ge.w)(u,"float32")),y=Re.getReductionAxes(o.shape,c);return y.length>0?(0,Kt.t)((0,Jt.c)(f,y),o.shape):f},b:()=>{let f=(0,te.l)(l,(0,Ge.w)(o,"float32")),y=Re.getReductionAxes(u.shape,c);y.length>0&&(f=(0,Kt.t)((0,Jt.c)(f,y),u.shape));let w=(0,Sn.E)(u);return(0,kn.H)((0,Ue.y)(f,(0,Ge.w)(w,"float32")))}}}},Qu={kernelName:ye.huO,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,Ue.y)(l,(0,kn.H)((0,Sn.E)(o)))}}},Wl={kernelName:ye.P_L,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i,u=(0,te.l)((0,Le.I)(o,6),(0,Me.P)(o));return{x:()=>(0,te.l)(l,(0,Ge.w)(u,"float32"))}}},Yh={kernelName:ye.fUj,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,te.l)(l,(0,Ge.w)((0,Me.P)(o),"float32"))}}},Ba={kernelName:ye.R23,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,Kt.t)(l,o.shape)}}},$s={kernelName:ye.hgw,inputsToSave:["images"],gradFunc:(l,i,o)=>{let[u]=i,c={dy:l,images:u};return{images:()=>ea.T2.runKernel(ye.FCQ,c,o)}}},Oc={kernelName:ye.jOE,inputsToSave:["images"],gradFunc:(l,i,o)=>{let[u]=i,c={dy:l,images:u};return{images:()=>ea.T2.runKernel(ye.XQy,c,o)}}};var oc=F(3262);let sc={kernelName:ye.D7i,gradFunc:(l,i,o)=>{let{dims:u}=o,c=(0,Cr.Y6)(u,l.shape);return{x:()=>(0,oc.B)(l,c)}}},Lc={kernelName:ye.hVg,gradFunc:l=>({x:()=>(0,tn.P)(l)})},Ju={kernelName:ye.TOR,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,kn.H)((0,Ue.y)(l,(0,te.l)((0,Ul.n)(o,1.5),2)))}}};var ph=F(9881);let $c={kernelName:ye.l6P,inputsToSave:["condition"],gradFunc:(l,i)=>{let[o]=i;return{condition:()=>(0,Ge.w)((0,tn.P)(o),"float32"),t:()=>(0,te.l)(l,(0,Ge.w)(o,l.dtype)),e:()=>(0,te.l)(l,(0,Ge.w)((0,ph.N)(o),l.dtype))}}};var uc=F(8576);let yt={kernelName:ye.u$b,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>{let u=(0,Ce.r)(o,(0,mn.d)(0)),c=(0,mn.d)(uc.j),f=(0,mn.d)(uc.X),y=(0,te.l)(l,f),w=(0,te.l)((0,te.l)(l,c),(0,Ko.o)((0,Ge.w)(o,"float32")));return(0,jn._)(u,y,w)}}}},D={kernelName:ye.vI1,outputsToSave:[!0],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,te.l)(l,(0,te.l)(o,(0,Wn.j)((0,mn.d)(1),o)))}}},U={kernelName:ye.YVe,gradFunc:l=>({x:()=>(0,tn.P)(l)})};var et=F(9907);let ut={kernelName:ye.hql,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,te.l)((0,et.g)((0,Ge.w)(o,"float32")),l)}}};var pt=F(7451);let mt={kernelName:ye.J3C,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,te.l)((0,pt.y)((0,Ge.w)(o,"float32")),l)}}};var At=F(5661),zt=F(4969);let pe={kernelName:ye.JiE,inputsToSave:["x"],gradFunc:(l,i,o)=>{let[u]=i,{begin:c,size:f}=o,y=u.shape,[w,C]=(0,zt.parseSliceParams)(u,c,f),T=[];for(let x=0;x<l.rank;x++)T.push([w[x],y[x]-w[x]-C[x]]);return{x:()=>(0,At.e)(l,T)}}},We={kernelName:ye.rFG,outputsToSave:[!0],gradFunc:(l,i,o)=>{let[u]=i,{dim:c}=o,f=(0,te.l)(l,u);return{logits:()=>(0,Wn.j)(f,(0,te.l)((0,Jt.c)(f,[c],!0),u))}}};var Ke=F(8968);let Tn={kernelName:ye.Fin,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,te.l)(l,(0,Ke.r)(o))}}};var nn=F(9772);let un={kernelName:ye.A8B,gradFunc:(l,i,o)=>{let{blockShape:u,paddings:c}=o;return{x:()=>(0,nn.G)(l,u,c)}}};var zn=F(5030);let In={kernelName:ye.Blb,gradFunc:(l,i,o)=>{let{axis:u}=o;return{x:()=>(0,zn.x)(l,u)}}},Or={kernelName:ye.dFH,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,Ue.y)(l,(0,te.l)((0,Kn.R)((0,Ge.w)(o,"float32")),2))}}},oi={kernelName:ye.M6A,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,te.l)(l,(0,te.l)((0,Ge.w)(o,"float32"),2))}}},ur={kernelName:ye.Ddj,inputsToSave:["a","b"],gradFunc:(l,i)=>{let[o,u]=i,c=(0,mn.d)(2);return{a:()=>(0,te.l)(l,(0,te.l)(c,(0,Wn.j)(o,u))),b:()=>(0,te.l)(l,(0,te.l)(c,(0,Wn.j)(u,o)))}}},Na={kernelName:ye.pnw,gradFunc:l=>({x:()=>(0,tn.P)(l)})},fi={kernelName:ye.PbM,inputsToSave:["a","b"],gradFunc:(l,i)=>{let[o,u]=i,c=Re.assertAndGetBroadcastShape(o.shape,u.shape);return{a:()=>{let f=l,y=Re.getReductionAxes(o.shape,c);return y.length>0&&(f=(0,Jt.c)(f,y)),(0,Kt.t)(f,o.shape)},b:()=>{let f=l,y=Re.getReductionAxes(u.shape,c);return y.length>0&&(f=(0,Jt.c)(f,y)),(0,Kt.t)((0,kn.H)(f),u.shape)}}}},Lr={kernelName:ye.WuN,inputsToSave:["x"],gradFunc:(l,i,o)=>{let[u]=i,c=u.shape.slice(),{axis:f}=o;(0,Cr.Y6)(f,u.shape).forEach(C=>{c[C]=1});let y=(0,Kt.t)(l,c),w=(0,te.l)(y,(0,oa.S)(u.shape,"float32"));return{x:()=>w}}},wi={kernelName:ye.oFs,inputsToSave:["x"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,Ue.y)(l,(0,Sn.E)((0,et.g)(o)))}}},cs={kernelName:ye.iuW,outputsToSave:[!0],gradFunc:(l,i)=>{let[o]=i;return{x:()=>(0,te.l)((0,Wn.j)((0,mn.d)(1),(0,Sn.E)(o)),l)}}},Js={kernelName:ye.FAs,inputsToSave:["x"],gradFunc:(l,i,o)=>{let[u]=i,{reps:c}=o;return{x:()=>{let f=(0,tn.P)(u);if(u.rank===1)for(let y=0;y<c[0];++y)f=(0,Zn.W)(f,(0,Gi.d)(l,[y*u.shape[0]],[u.shape[0]]));else if(u.rank===2)for(let y=0;y<c[0];++y)for(let w=0;w<c[1];++w)f=(0,Zn.W)(f,(0,Gi.d)(l,[y*u.shape[0],w*u.shape[1]],[u.shape[0],u.shape[1]]));else if(u.rank===3)for(let y=0;y<c[0];++y)for(let w=0;w<c[1];++w)for(let C=0;C<c[2];++C)f=(0,Zn.W)(f,(0,Gi.d)(l,[y*u.shape[0],w*u.shape[1],C*u.shape[2]],[u.shape[0],u.shape[1],u.shape[2]]));else{if(u.rank!==4)throw new Error(`Gradient for tile operation is not implemented for rank-${u.rank} tensors yet.`);for(let y=0;y<c[0];++y)for(let w=0;w<c[1];++w)for(let C=0;C<c[2];++C)for(let T=0;T<c[3];++T)f=(0,Zn.W)(f,(0,Gi.d)(l,[y*u.shape[0],w*u.shape[1],C*u.shape[2],T*u.shape[3]],[u.shape[0],u.shape[1],u.shape[2],u.shape[3]]))}return f}}}},zs={kernelName:ye.wx0,gradFunc:(l,i,o)=>{let u=o,{perm:c}=u,f=na.gx(c);return{x:()=>(0,Ya.m)(l,f)}}},pi={kernelName:ye.dXR,gradFunc:(l,i,o)=>{let u=o,{axis:c}=u;return{value:()=>(0,ji.t)(l,c)}}};var cu=F(8710),Vl=F(8229),Al=F(178);let yw={kernelName:ye.pPe,inputsToSave:["segmentIds"],gradFunc:(l,i)=>{let[o]=i;return{x:()=>function(u,c){let f=(0,Al.P)(c,(0,tn.P)(c)),y=(0,Vl.k)(u,f),w=(0,Wa.D)(c,(0,mn.d)(0,"int32")),C=y.rank-w.rank;for(let x=0;x<C;++x)w=(0,cu.U)(w,x+1);w=(0,bn.n)(w,(0,oa.S)(y.shape,"bool"));let T=(0,tn.P)(y);return(0,jn._)(w,y,T)}(l,o)}}};let zc={kernelName:ye.xJ3,gradFunc:l=>({x:()=>(0,tn.P)(l)})};var r0=F(7074);let vw=[Ye,Ze,de,Ae,$e,wn,Mn,Hn,_r,Sr,Mr,ai,lr,fr,Qr,ua,br,eo,Fo,Jn,dr,or,Da,Ki,so,vs,bs,Xo,ws,Ra,Zr,Ru,Ga,Fu,Zs,Rc,Qs,bu,Zo,Zu,pa,_n,ls,Dt,Zt,le,Pe,rn,Cn,hr,Ai,Ai,Jr,bi,ra,Wr,_a,Ca,Ea,Dn,Ui,sa,Po,ku,an,Ms,Ms,Ou,Lu,ni,Qu,Wl,Yh,Ba,$s,Oc,sc,Lc,Ju,$c,yt,D,U,ut,mt,pe,We,Tn,un,un,In,In,Or,ur,oi,Na,fi,Lr,wi,cs,Js,zs,pi,yw,zc];for(let l of vw)(0,r0.kr)(l);F(455);class mh extends Error{constructor(i){super(i),Object.setPrototypeOf(this,mh.prototype)}}class Gl extends Error{constructor(i){super(i),Object.setPrototypeOf(this,Gl.prototype)}}class yn extends Error{constructor(i){super(i),Object.setPrototypeOf(this,yn.prototype)}}class Wi extends Error{constructor(i){super(i),Object.setPrototypeOf(this,Wi.prototype)}}class bv extends Error{constructor(i){super(i),Object.setPrototypeOf(this,bv.prototype)}}class bw{constructor(i){this.maxEntries=i||100,this.cache=new Map}get(i){let o;return this.cache.has(i)&&(o=this.cache.get(i),this.cache.delete(i),this.cache.set(i,o)),o}put(i,o){if(this.cache.has(i))this.cache.delete(i);else if(this.cache.size>=this.maxEntries){let u=this.cache.keys().next().value;this.cache.delete(u)}this.cache.set(i,o)}getMaxEntries(){return this.maxEntries}setMaxEntries(i){if(i<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${i}.`);if(this.maxEntries>i)for(let o=0;o<this.maxEntries-i;o++){let u=this.cache.keys().next().value;this.cache.delete(u)}this.maxEntries=i}}function i0(l,i){if(Array.isArray(l)){let o=[];for(let u=0;u<i;u++)o=o.concat(l);return o}{let o=new Array(i);return o.fill(l),o}}function qh(l,i){if(!l)throw new bv(i)}function wv(l,i){let o=0;for(let u of l)u===i&&o++;return o}function $u(l){return l.length===1?l[0]:l}function xo(l){return Array.isArray(l)?l:[l]}function Xh(l){let i=l.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return i[0]!=="_"?i:"private"+i}function oe(l){return l.length<=1||l.indexOf("_")===-1?l:l.replace(/[_]+(\w|$)/g,(i,o)=>o.toUpperCase())}let Lt={};function ne(l){if(l==null)return null;let i={};return i.className=l.getClassName(),i.config=l.getConfig(),i}function xe(l){if(l!=null&&typeof l=="object")if(Array.isArray(l))l.forEach(i=>xe(i));else{let i=Object.keys(l);for(let o of i){let u=l[o];u!=null&&typeof u=="object"&&(Array.isArray(u)||u.type!=="ndarray"||typeof u.value!="number"?xe(u):l[o]=u.value)}}}function Oe(l,i={},o={},u="object",c=!1){if(typeof l=="string"){let f=l,y;if(f in o)y=o[f];else if(f in Lt)y=Lt[f];else if(y=i[f],y==null)throw new yn(`Unknown ${u}: ${l}. This may be due to one of the following reasons:
1. The ${u} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${u} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return y}{let f=l;if(f.className==null||f.config==null)throw new yn(`${u}: Improper config format: ${JSON.stringify(f)}.
'className' and 'config' must set.`);let y=f.className,w,C;if(y in o?[w,C]=o[y]:y in Lt?[w,C]=Lt.className:y in i&&([w,C]=i[y]),w==null)throw new yn(`Unknown ${u}: ${y}. This may be due to one of the following reasons:
1. The ${u} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${u} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(C!=null){let T={};for(let M of Object.keys(Lt))T[M]=Lt[M];for(let M of Object.keys(o))T[M]=o[M];f.config.customObjects=T;let x=Object.assign({},Lt);for(let M of Object.keys(o))Lt[M]=o[M];xe(f.config);let A=C(w,f.config,o,c);return Lt=Object.assign({},x),A}{let T=Object.assign({},Lt);for(let A of Object.keys(o))Lt[A]=o[A];let x=new w(f.config);return Lt=Object.assign({},T),x}}}function fn(l,i){return-1*function(o,u){return o<u?-1:o>u?1:0}(l,i)}function vn(l){if(l==null)return l;let i=[];for(let o of l)i.indexOf(o)===-1&&i.push(o);return i}function rr(l){if(l==null)throw new yn(`Invalid value in obj: ${JSON.stringify(l)}`);for(let i in l)if(l.hasOwnProperty(i))return!1;return!0}function pr(l,i,o){if(o!=null&&l.indexOf(o)<0)throw new yn(`${o} is not a valid ${i}.  Valid values are ${l} or null/undefined.`)}function Yr(l,i,o=0,u=1/0){return qh(o>=0),qh(u>=o),Array.isArray(l)&&l.length>=o&&l.length<=u&&l.every(c=>typeof c===i)}function qr(l,i){Array.isArray(l)?(m.util.assert(l.length>0,()=>`${i} is unexpectedly an empty array.`),l.forEach((o,u)=>qr(o,`element ${u+1} of ${i}`))):m.util.assert(Number.isInteger(l)&&l>0,()=>`Expected ${i} to be a positive integer, but got ${xr(l)}.`)}function xr(l){return l===null?"null":Array.isArray(l)?"["+l.map(i=>xr(i)).join(",")+"]":typeof l=="string"?`"${l}"`:`${l}`}function ma(l){return l==="relu"?"relu":l==="linear"?"linear":l==="elu"?"elu":null}let ca=0;function uo(){return ca++}let Qo={};function Ps(l=""){return l in Qo||(Qo[l]=0),Qo[l]+=1,l+Qo[l].toString()}let Cg=["channelsFirst","channelsLast"],a0=["nearest","bilinear"],Pc=["valid","same","causal"],xv=["max","avg"],u2=["sum","mul","concat","ave"],Eg=new Map;function hu(l){pr(Cg,"DataFormat",l)}function Bc(l){pr(Pc,"PaddingMode",l)}function ww(l){pr(xv,"PoolMode",l)}let du=[];function yf(l,i){du.push(l);try{let o=i();return du.pop(),o}catch(o){throw du.pop(),o}}function o0(l){if(!xw(l))throw new Error("Not a valid tensor name: '"+l+"'");return(du.length===0?"":du.join("/")+"/")+l}function l2(l){if(!xw(l))throw new Error("Not a valid tensor name: '"+l+"'");Eg.has(l)||Eg.set(l,0);let i=Eg.get(l);if(Eg.set(l,Eg.get(l)+1),i>0){let o=`${l}_${i}`;return Eg.set(o,1),o}return l}let kv=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function xw(l){return!!l.match(kv)}function lm(l,i,o){i==null&&(i=0),o==null&&(o=l.length);let u=1;for(let c=i;c<o;++c)u*=l[c];return u}function cm(l){if(l.length===0)return Number.NaN;let i=Number.POSITIVE_INFINITY;for(let o=0;o<l.length;o++){let u=l[o];u<i&&(i=u)}return i}function Ds(l){if(l.length===0)return Number.NaN;let i=Number.NEGATIVE_INFINITY;for(let o=0;o<l.length;o++){let u=l[o];u>i&&(i=u)}return i}function Ss(l,i){if(i<l)throw new yn(`end (${i}) < begin (${l}) is forbidden.`);let o=[];for(let u=l;u<i;++u)o.push(u);return o}let jc;function ko(){return jc==null&&(jc=(0,m.backend)().epsilon()),jc}function Hl(l,i){return m.cast(l,i)}function Tg(l,i=-1){let o=l.shape.slice();return i<0&&(i=o.length+i+1),o.splice(i,0,1),m.reshape(l,o)}function vf(l,i,o){return(0,m.tidy)(()=>{switch(l.rank){case 1:return m.slice1d(l,i,o);case 2:return m.slice2d(l,[i,0],[o,l.shape[1]]);case 3:return m.slice3d(l,[i,0,0],[o,l.shape[1],l.shape[2]]);case 4:return m.slice4d(l,[i,0,0,0],[o,l.shape[1],l.shape[2],l.shape[3]]);case 5:return m.slice(l,[i,0,0,0,0],[o,l.shape[1],l.shape[2],l.shape[3],l.shape[4]]);case 6:return m.slice(l,[i,0,0,0,0,0],[o,l.shape[1],l.shape[2],l.shape[3],l.shape[4],l.shape[5]]);default:throw new yn(`sliceAlongFirstAxis() received an unsupported tensor rank: ${l.rank}`)}})}function s0(l,i,o){return(0,m.tidy)(()=>{switch(l.rank){case 1:return m.slice1d(l,i,o);case 2:return m.slice2d(l,[0,i],[l.shape[0],o]);case 3:return m.slice3d(l,[0,0,i],[l.shape[0],l.shape[1],o]);case 4:return m.slice4d(l,[0,0,0,i],[l.shape[0],l.shape[1],l.shape[2],o]);default:throw new yn(`sliceAlongLastAxis() received an unsupported tensor rank: ${l.rank}`)}})}function Td(l,i,o,u){return(0,m.tidy)(()=>{switch(l.rank){case 1:return m.slice1d(l,i,o);case 2:switch(u){case 1:return vf(l,i,o);case 2:return s0(l,i,o);default:throw new yn(`The axis is not within the rank of the tensor ${u}`)}case 3:switch(u){case 1:return vf(l,i,o);case 2:return m.slice3d(l,[0,i,0],[l.shape[0],o,l.shape[2]]);case 3:return s0(l,i,o);default:throw new yn(`The axis is not within the rank of the tensor ${u}`)}case 4:switch(u){case 1:return vf(l,i,o);case 2:return m.slice4d(l,[0,i,0,0],[l.shape[0],o,l.shape[2],l.shape[3]]);case 3:return m.slice4d(l,[0,0,i,0],[l.shape[0],l.shape[1],o,l.shape[3]]);case 4:return s0(l,i,o);default:throw new yn(`The axis is not within the rank of the tensor ${u}`)}default:throw new yn(`sliceAlongLastAxis() received an unsupported tensor rank: ${l.rank}`)}})}function Sv(l,i=-1){let o;return i<0&&(o=l[0].rank,i=o!==0?o:0),i===l[0].rank&&(i=-1),m.concat(l,i)}function c2(l,i){switch(l.rank){case 1:return m.concat1d([l,i]);case 2:return m.concat2d([l,i],0);case 3:return m.concat3d([l,i],0);case 4:return m.concat4d([l,i],0);default:throw new yn(`concatAlongFirstAxis() received an unsupported tensor rank: ${l.rank}`)}}function gh(l,i){if(Array.isArray(i)||(i=[i]),l.rank!==i.length)throw new yn(`The length of input n (${i.length}) does not match the number of dimensions in input x (${l.rank})`);return m.tile(l,i)}function Uc(l,i=0,o=1,u,c){return m.randomNormal(l,i,o,u,c)}function tl(l,i,o,u){if(l.rank<2||i.rank<2)throw new Wi(`dot requires both inputs to be rank >= 2 but got x shape = ${l.shape} and y shape = ${i.shape}`);if(i.rank>=3&&l.shape.slice(-1)[0]!==i.shape.slice(-2)[0])throw new Wi(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${l.shape} and  y shape = ${i.shape}`);if(l.rank===2&&i.rank===2)return m.fused.matMul({a:l,b:i,transposeA:!1,transposeB:!1,bias:u?hm(l.rank,u,"channelsLast"):null,activation:o});{let c=l.shape.slice(),f=c.pop();l=m.reshape(l,[-1,f]);let y=i.shape.slice(),w=y.pop(),C=y.pop(),T=[...y,w],x=Array.from({length:i.rank},(V,G)=>G===0?i.rank-2:G<=i.rank-2?G-1:G);i=m.reshape(m.transpose(i,x),[C,-1]);let A=[...c,...T];return m.reshape(m.fused.matMul({a:l,b:i,transposeA:!1,transposeB:!1,bias:u?hm(l.rank,u,"channelsLast"):null,activation:o}),A)}}function Kh(l,i,o){return(0,m.tidy)(()=>(i=Array.isArray(i)?(0,m.tensor1d)(i,"int32"):m.cast(i,"int32"),m.gather(l,i,o)))}function ip(l){return m.mul(l,l)}function hm(l,i,o){let u=i.shape;if(i.rank!==1&&i.rank!==l)throw new yn(`Unexpected bias dimensions: ${i.rank}; expected it to be 1 or ${l}`);if(l===5){if(o==="channelsFirst")return u.length===1?m.reshape(i,[1,u[0],1,1,1]):m.reshape(i,[1,u[3],u[0],u[1],u[2]]);if(o==="channelsLast")return u.length===1?m.reshape(i,[1,1,1,1,u[0]]):m.reshape(i,[1].concat(u))}else if(l===4){if(o==="channelsFirst")return u.length===1?m.reshape(i,[1,u[0],1,1]):m.reshape(i,[1,u[2],u[0],u[1]]);if(o==="channelsLast")return u.length===1?m.reshape(i,[1,1,1,u[0]]):m.reshape(i,[1].concat(u))}else if(l===3){if(o==="channelsFirst")return u.length===1?m.reshape(i,[1,u[0],1]):m.reshape(i,[1,u[1],u[0]]);if(o==="channelsLast")return u.length===1?m.reshape(i,[1,1,u[0]]):m.reshape(i,[1].concat(u))}else if(l<3)return i;throw new yn(`Unsupported input rank by biasAdd: ${i.rank}`)}function lc(l,i,o){return(0,m.tidy)(()=>(o==null&&(o="channelsLast"),hu(o),m.add(l,hm(l.rank,i,o))))}function Ag(l,i,o,u){return(0,m.tidy)(()=>m.dropout(l,i,o,u))}function Il(l,i,o=!1){return o?l():i()}let bf=["fanIn","fanOut","fanAvg"],I5=["normal","uniform","truncatedNormal"];class Ad extends m.serialization.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class N5 extends Ad{apply(i,o){return(0,m.zeros)(i,o)}}N5.className="Zeros",m.serialization.registerClass(N5);class kw extends Ad{apply(i,o){return(0,m.ones)(i,o)}}kw.className="Ones",m.serialization.registerClass(kw);class M5 extends Ad{constructor(i){if(super(),typeof i!="object")throw new yn(`Expected argument of type ConstantConfig but got ${i}`);if(i.value===void 0)throw new yn(`config must have value set but got ${i}`);this.value=i.value}apply(i,o){return(0,m.tidy)(()=>(0,m.mul)((0,m.scalar)(this.value),(0,m.ones)(i,o)))}getConfig(){return{value:this.value}}}M5.className="Constant",m.serialization.registerClass(M5);class D5 extends Ad{constructor(i){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=i.minval||this.DEFAULT_MINVAL,this.maxval=i.maxval||this.DEFAULT_MAXVAL,this.seed=i.seed}apply(i,o){return(0,m.randomUniform)(i,this.minval,this.maxval,o,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}D5.className="RandomUniform",m.serialization.registerClass(D5);class Ne extends Ad{constructor(i){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=i.mean||this.DEFAULT_MEAN,this.stddev=i.stddev||this.DEFAULT_STDDEV,this.seed=i.seed}apply(i,o){if((o=o||"float32")!=="float32"&&o!=="int32")throw new Wi(`randomNormal does not support dType ${o}.`);return Uc(i,this.mean,this.stddev,o,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Ne.className="RandomNormal",m.serialization.registerClass(Ne);class Se extends Ad{constructor(i){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=i.mean||this.DEFAULT_MEAN,this.stddev=i.stddev||this.DEFAULT_STDDEV,this.seed=i.seed}apply(i,o){if((o=o||"float32")!=="float32"&&o!=="int32")throw new Wi(`truncatedNormal does not support dType ${o}.`);return(0,m.truncatedNormal)(i,this.mean,this.stddev,o,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Se.className="TruncatedNormal",m.serialization.registerClass(Se);class ke extends Ad{constructor(i){super(),this.gain=i.gain!=null?i.gain:1}apply(i,o){return(0,m.tidy)(()=>{if(i.length!==2||i[0]!==i[1])throw new yn("Identity matrix initializer can only be used for 2D square matrices.");return(0,m.mul)(this.gain,(0,m.eye)(i[0]))})}getConfig(){return{gain:this.gain}}}ke.className="Identity",m.serialization.registerClass(ke);class ve extends Ad{constructor(i){if(super(),i.scale<0)throw new yn(`scale must be a positive float. Got: ${i.scale}`);var o;this.scale=i.scale==null?1:i.scale,this.mode=i.mode==null?"fanIn":i.mode,o=this.mode,pr(bf,"FanMode",o),this.distribution=i.distribution==null?"normal":i.distribution,function(u){pr(I5,"Distribution",u)}(this.distribution),this.seed=i.seed}apply(i,o){let u=function(w,C="channelsLast"){let T,x;if(hu(C),w.length===2)T=w[0],x=w[1];else if([3,4,5].indexOf(w.length)!==-1){if(C==="channelsFirst"){let A=lm(w,2);T=w[1]*A,x=w[0]*A}else if(C==="channelsLast"){let A=lm(w,0,w.length-2);T=w[w.length-2]*A,x=w[w.length-1]*A}}else{let A=lm(w);T=Math.sqrt(A),x=Math.sqrt(A)}return[T,x]}(i),c=u[0],f=u[1],y=this.scale;if(this.mode==="fanIn"?y/=Math.max(1,c):this.mode==="fanOut"?y/=Math.max(1,f):y/=Math.max(1,(c+f)/2),this.distribution==="normal"){let w=Math.sqrt(y);if((o=o||"float32")!=="float32"&&o!=="int32")throw new Wi(`${this.getClassName()} does not support dType ${o}.`);return(0,m.truncatedNormal)(i,0,w,o,this.seed)}{let w=Math.sqrt(3*y);return(0,m.randomUniform)(i,-w,w,o,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}ve.className="VarianceScaling",m.serialization.registerClass(ve);class Te extends ve{constructor(i){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:i==null?null:i.seed})}getClassName(){return ve.className}}Te.className="GlorotUniform",m.serialization.registerClass(Te);class Fe extends ve{constructor(i){super({scale:1,mode:"fanAvg",distribution:"normal",seed:i==null?null:i.seed})}getClassName(){return ve.className}}Fe.className="GlorotNormal",m.serialization.registerClass(Fe);class je extends ve{constructor(i){super({scale:2,mode:"fanIn",distribution:"normal",seed:i==null?null:i.seed})}getClassName(){return ve.className}}je.className="HeNormal",m.serialization.registerClass(je);class hn extends ve{constructor(i){super({scale:2,mode:"fanIn",distribution:"uniform",seed:i==null?null:i.seed})}getClassName(){return ve.className}}hn.className="HeUniform",m.serialization.registerClass(hn);class Pn extends ve{constructor(i){super({scale:1,mode:"fanIn",distribution:"normal",seed:i==null?null:i.seed})}getClassName(){return ve.className}}Pn.className="LeCunNormal",m.serialization.registerClass(Pn);class On extends ve{constructor(i){super({scale:1,mode:"fanIn",distribution:"uniform",seed:i==null?null:i.seed})}getClassName(){return ve.className}}On.className="LeCunUniform",m.serialization.registerClass(On);class sr extends Ad{constructor(i){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=i.gain==null?this.DEFAULT_GAIN:i.gain,this.seed=i.seed}apply(i,o){return(0,m.tidy)(()=>{if(i.length<2)throw new Wi("Shape must be at least 2D.");if(o!=="int32"&&o!=="float32"&&o!==void 0)throw new TypeError(`Unsupported data type ${o}.`);let u=m.util.sizeFromShape(i.slice(0,-1)),c=i[i.length-1],f=u*c;f>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${f}) elements: Slowness may result.`);let y=Uc([Math.max(c,u),Math.min(c,u)],0,1,o,this.seed),w=m.linalg.qr(y,!1),C=w[0],T=w[1].flatten().stridedSlice([0],[Math.min(c,u)*Math.min(c,u)],[Math.min(c,u)+1]);return C=(0,m.mul)(C,T.sign()),u<c&&(C=C.transpose()),(0,m.mul)((0,m.scalar)(this.gain),C.reshape(i))})}getConfig(){return{gain:this.gain,seed:this.seed}}}sr.className="Orthogonal",m.serialization.registerClass(sr);let ir={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Xr(l,i={}){return Oe(l,m.serialization.SerializationMap.getMap().classNameMap,i,"initializer")}function Pr(l){return ne(l)}function ci(l){if(typeof l=="string"){let i=l in ir?ir[l]:l;if(i==="GlorotNormal")return new Fe;if(i==="GlorotUniform")return new Te;if(i==="HeNormal")return new je;if(i==="HeUniform")return new hn;if(i==="LeCunNormal")return new Pn;if(i==="LeCunUniform")return new On;{let o={};return o.className=i,o.config={},Xr(o)}}return l instanceof Ad?l:Xr(l)}function Fa(l){return Array.isArray(l)&&Array.isArray(l[0])}function Ha(l){return l.length===0?[]:Array.isArray(l[0])?l:[l]}function Vr(l){let i;if(Array.isArray(l)){if(l.length!==1)throw new yn(`Expected Tensor length to be 1; got ${l.length}`);i=l[0]}else i=l;return i}function Vi(l){if(Array.isArray(l)&&Array.isArray(l[0])){if(l.length===1)return l[0];throw new yn(`Expected exactly 1 Shape; got ${l.length}`)}return l}function Bs(l){let i=0;for(let o of l)o.shape.length===0?i+=1:i+=o.shape.reduce((u,c)=>u*c);return i}let tu="Variable";class To{constructor(i,o="float32",u=tu,c=!0,f=null){this.dtype=o??"float32",this.shape=i.shape,this.id=uo(),u=u??tu,this.originalName=o0(u),this.name=l2(this.originalName),this.trainable_=c,this.constraint=f,this.val=m.variable(i,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(i){return this.assertNotDisposed(),function(o,u){if(o.shape.toString()!==u.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(o.shape)+" vs. "+JSON.stringify(u.shape))}(this.val,i),this.val.id!==i.id&&(this.val.assign(i),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(i){this.trainable_=i,this.val.trainable=i}}function ja(l){return l.map(i=>i.read())}function Bo(l){l.forEach(i=>{i[0].write(i[1])})}class La{constructor(i){this.dtype=i.dtype,this.shape=i.shape,i.shape!=null?this.ndim=i.shape.length:this.ndim=i.ndim,this.maxNDim=i.maxNDim,this.minNDim=i.minNDim,this.axes=i.axes||{}}}class no{constructor(i,o,u,c,f,y,w){this.dtype=i,this.shape=o,this.sourceLayer=u,this.inputs=c,this.callArgs=f,this.outputTensorIndex=w,this.id=uo(),y!=null&&(this.originalName=o0(y),this.name=l2(this.originalName)),this.rank=o.length}}let Ao=0;class js{constructor(i,o){this.callArgs=o,this.id=Ao++,this.outboundLayer=i.outboundLayer,this.inboundLayers=i.inboundLayers,this.nodeIndices=i.nodeIndices,this.tensorIndices=i.tensorIndices,this.inputTensors=i.inputTensors,this.outputTensors=i.outputTensors,this.inputMasks=i.inputMasks,this.outputMasks=i.outputMasks,this.inputShapes=i.inputShapes,this.outputShapes=i.outputShapes;for(let u of i.inboundLayers)u?.outboundNodes.push(this);i.outboundLayer.inboundNodes.push(this)}getConfig(){let i=[];for(let o of this.inboundLayers)o!=null?i.push(o.name):i.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:i,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Nl=0;class Hi extends m.serialization.Serializable{constructor(i={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Nl++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let o=i.name;if(!o){let u=this.getClassName();o=Xh(u)+"_"+Ps(u)}if(this.name=o,this.trainable_=i.trainable==null||i.trainable,i.inputShape!=null||i.batchInputShape!=null){let u;if(i.batchInputShape!=null)u=i.batchInputShape;else if(i.inputShape!=null){let f=null;i.batchSize!=null&&(f=i.batchSize),u=[f].concat(i.inputShape)}this.batchInputShape=u;let c=i.dtype;c==null&&(c=i.inputDType),c==null&&(c="float32"),this.dtype=c}i.weights!=null?this.initialWeights=i.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(i,o){return i.name+"_ib-"+o.toString()}getNodeAtIndex(i,o){if(this.inboundNodes.length===0)throw new Gl(`The layer has never been called and thus has no defined ${o}.`);if(this.inboundNodes.length<=i)throw new yn(`Asked to get ${o} at node ${i}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[i]}getInputAt(i){return $u(this.getNodeAtIndex(i,"input").inputTensors)}getOutputAt(i){return $u(this.getNodeAtIndex(i,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new mh(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new mh(`Layer ${this.name} is not connected, no input to return.`);return $u(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new mh(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new mh(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return $u(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(i=>i())}get updates(){return this._updates}get built(){return this._built}set built(i){this._built=i}get trainable(){return this.trainable_}set trainable(i){this._trainableWeights.forEach(o=>o.trainable=i),this.trainable_=i}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(i=>i.trainable):[]}set trainableWeights(i){this._trainableWeights=i}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(i=>!i.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(i){this._nonTrainableWeights=i}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(i){let o=xo(i);if(this.inputSpec==null||this.inputSpec.length===0)return;let u=xo(this.inputSpec);if(o.length!==u.length)throw new yn(`Layer ${this.name} expects ${u.length} inputs, but it received ${o.length} input tensors. Input received: ${i}`);for(let c=0;c<o.length;c++){let f=o[c],y=u[c];if(y==null)continue;let w=f.rank;if(y.ndim!=null&&w!==y.ndim)throw new yn(`Input ${c} is incompatible with layer ${this.name}: expected ndim=${y.ndim}, found ndim=${w}`);if(y.maxNDim!=null&&w>y.maxNDim)throw new yn(`Input ${c} is incompatible with layer ${this.name}: expected max_ndim=${y.maxNDim}, found ndim=${w}`);if(y.minNDim!=null&&w<y.minNDim)throw new yn(`Input ${c} is incompatible with layer ${this.name}: expected min_ndim=${y.minNDim}, found ndim=${w}.`);if(y.dtype!=null&&f.dtype!==y.dtype)throw new yn(`Input ${c} is incompatible with layer ${this.name} : expected dtype=${y.dtype}, found dtype=${f.dtype}.`);if(y.axes){let C=f.shape;for(let T in y.axes){let x=Number(T),A=y.axes[T],M=x>=0?C[x]:C[C.length+x];if(A!=null&&[A,null].indexOf(M)===-1)throw new yn(`Input ${c} is incompatible with layer ${this.name}: expected axis ${x} of input shape to have value ${A} but got shape ${C}.`)}}if(y.shape!=null)for(let C=0;C<y.shape.length;++C){let T=y.shape[C],x=f.shape[C];if(T!=null&&x!=null&&T!==x)throw new yn(`Input ${c} is incompatible with layer ${this.name}: expected shape=${y.shape}, found shape=${f.shape}.`)}}}call(i,o){return i}invokeCallHook(i,o){this._callHook!=null&&this._callHook(i,o)}setCallHook(i){this._callHook=i}clearCallHook(){this._callHook=null}apply(i,o){o=o||{},this.assertNotDisposed();let u=xo(i),c=function(y){let w=!0;for(let C of xo(y))if(!(C instanceof no)){w=!1;break}return w}(i),f=function(y){let w=!0;for(let C of xo(y))if(C instanceof no){w=!1;break}return w}(i);if(c===f)throw new yn("Arguments to apply() must be all SymbolicTensors or all Tensors");return yf(this.name,()=>{if(!this.built){this.assertInputCompatibility(i);let y=[];for(let w of xo(i))y.push(w.shape);this.build($u(y)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&f&&(this._refCount=1)}if(this.assertInputCompatibility(i),f){let y=this.call(i,o);this.supportsMasking&&this.setMaskMetadata(i,y);let w=xo(y),C=[];for(let T of w)u.indexOf(T)!==-1&&(T=T.clone()),C.push(T);if(y=$u(C),this.activityRegularizer!=null)throw new Wi("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return y}{let y=function(x){x=xo(x);let A=[];for(let M of x)A.push(M.shape);return $u(A)}(i),w=this.computeOutputShape(y),C,T="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(i)?y[0]:y),C=w!=null&&w.length>0&&Array.isArray(w[0])?w.map((x,A)=>new no(T,x,this,xo(i),o,this.name,A)):new no(T,w,this,xo(i),o,this.name),this.addInboundNode(i,C,null,null,y,w,o),this._refCount++,this.activityRegularizer!=null)throw new Wi("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return C}})}warnOnIncompatibleInputShape(i){if(this.batchInputShape!=null)if(i.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(i)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let o=!1;this.batchInputShape.forEach((u,c)=>{u!=null&&i[c]!=null&&i[c]!==u&&(o=!0)}),o&&console.warn(`The shape of the input tensor (${JSON.stringify(i)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new mh(`The layer ${this.name} has never been called and thus has no defined output shape.`);let i=[];for(let o of this.inboundNodes){let u=JSON.stringify(o.outputShapes);i.indexOf(u)===-1&&i.push(u)}if(i.length===1){let o=this.inboundNodes[0].outputShapes;return Array.isArray(o)&&Array.isArray(o[0])&&o.length===1?o[0]:o}throw new mh(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Gl(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Bs(this.weights)}build(i){this.built=!0}getWeights(i=!1){return ja(i?this.trainableWeights:this.weights)}setWeights(i){(0,m.tidy)(()=>{let o=this.weights;if(o.length!==i.length)throw new yn(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${i.length}, but the layer was expecting ${o.length} weights. Provided weights: ${i}...`);if(o.length===0)return;let u=[],c=ja(o);for(let f=0;f<c.length;++f){let y=c[f],w=o[f],C=i[f];if(!m.util.arraysEqual(y.shape,C.shape))throw new yn(`Layer weight shape ${y.shape} not compatible with provided weight shape ${C.shape}`);u.push([w,C])}Bo(u)})}addWeight(i,o,u,c,f,y,w,C){if(this._addedWeightNames.indexOf(i)!==-1)throw new yn(`Duplicate weight name ${i} for layer ${this.name}`);this._addedWeightNames.push(i),u==null&&(u="float32"),this.fastWeightInitDuringBuild&&(c=C!=null?C():ci("zeros"));let T=c.apply(o,u),x=new To(T,u,i,y,w);return T.dispose(),f!=null&&this.addLoss(()=>f.apply(x.read())),y==null&&(y=!0),y?this._trainableWeights.push(x):this._nonTrainableWeights.push(x),x}setFastWeightInitDuringBuild(i){this.fastWeightInitDuringBuild=i}addLoss(i){i==null||Array.isArray(i)&&i.length===0||(i=xo(i),this._losses!==void 0&&this._losses!==null&&this.losses.push(...i))}computeOutputShape(i){return i}computeMask(i,o){if(!this.supportsMasking){if(o!=null){if(!Array.isArray(o))throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);o.forEach(u=>{if(u!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)})}return null}return o}setMaskMetadata(i,o,u){if(!this.supportsMasking)return;let c=this.computeMask(i,u),f=xo(o),y=xo(c);if(f.length!==y.length)throw new Error(`${this.name} outputs ${f.length} tensors but ${f.length} masks for those tensors`);for(let w=0;w<f.length;w++)f[w].kerasMask=y[w]}addInboundNode(i,o,u,c,f,y,w=null){let C=xo(i);o=xo(o),u=xo(u),c=xo(c),f=Ha(f),y=Ha(y);let T=[],x=[],A=[];for(let M of C)T.push(M.sourceLayer),x.push(M.nodeIndex),A.push(M.tensorIndex);new js({outboundLayer:this,inboundLayers:T,nodeIndices:x,tensorIndices:A,inputTensors:C,outputTensors:o,inputMasks:u,outputMasks:c,inputShapes:f,outputShapes:y},w);for(let M=0;M<o.length;M++)o[M].sourceLayer=this,o[M].nodeIndex=this.inboundNodes.length-1,o[M].tensorIndex=M}getConfig(){let i={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(i.batchInputShape=this.batchInputShape),this.dtype!=null&&(i.dtype=this.dtype),i}disposeWeights(){return this.weights.forEach(i=>i.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let i=0;return--this._refCount==0&&(i=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:i}}}function Id(l,i,o){if((i==null||o!=null&&o>0)&&(i=l.sourceLayer,o=l.nodeIndex),i.inboundNodes.length===0)return[l];{let u=i.inboundNodes[o];if(u.inboundLayers.length===0)return u.inputTensors;{let c=[];for(let f=0;f<u.inboundLayers.length;f++){let y=Id(u.inputTensors[f],u.inboundLayers[f],u.nodeIndices[f]);for(let w of y)c.indexOf(w)===-1&&c.push(w)}return c}}}class Nd extends Hi{constructor(i){if(super({dtype:i.dtype,name:i.name!=null?i.name:Ps("input").toString()}),i.batchSize==null&&(i.batchSize=null),i.sparse==null&&(i.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=i.sparse,i.inputShape!=null&&i.batchInputShape!=null)throw new yn("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let o=i.batchInputShape;if(o==null){if(i.inputShape==null)throw new yn("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");o=[i.batchSize].concat(i.inputShape)}else if(i.batchSize!=null)throw new yn("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let u=i.dtype||"float32";this.batchInputShape=o,this.dtype=u,this.inputSpec=[{shape:o}];let c=new no(this.dtype,this.batchInputShape,this,[],{},this.name);c.nodeIndex=0,c.tensorIndex=0,new js({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[c],outputTensors:[c],inputMasks:[null],outputMasks:[null],inputShapes:[o],outputShapes:[o]})}apply(i,o){throw new yn(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}function ap(l){if(l.batchShape==null&&l.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(l.batchShape!=null&&l.shape!=null)throw new yn("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let i=l.batchShape;l.shape!=null&&i==null&&(i=[null].concat(l.shape));let o=l.dtype;return o==null&&(o="float32"),new Nd({batchInputShape:i,name:l.name,dtype:o,sparse:l.sparse}).inboundNodes[0].outputTensors[0]}Nd.className="InputLayer",m.serialization.registerClass(Nd);class Zh{constructor(i){if(this.id2Value={},this.id2Mask={},this.name2Id={},i instanceof Zh)for(let o in i.id2Value)this.id2Value[o]=i.id2Value[o],o in i.id2Mask&&(this.id2Mask[o]=i.id2Mask[o]);else{if(i==null)return;for(let o of i)this.add(o.key,o.value)}}add(i,o,u){if(this.id2Value[i.id]!=null)throw new yn(`Duplicate key: name=${i.name}, id=${i.id}`);return this.id2Value[i.id]=function(c,f){if(c.dtype==null||c.dtype===f.dtype)return f;try{return(0,m.cast)(f,c.dtype)}catch{throw new yn(`The dtype of the feed (${f.dtype}) can not be cast to the dtype of the key '${c.name}' (${c.dtype}).`)}}(i,o),this.name2Id[i.name]=i.id,u!=null&&(this.id2Mask[i.id]=u),this}addFeed(i){this.add(i.key,i.value)}hasKey(i){return this.id2Value[i.id]!=null}names(){return Object.keys(this.name2Id)}getValue(i){if(i instanceof no){if(this.id2Value[i.id]==null)throw new yn(`Nonexistent key: ${i.name}`);return this.id2Value[i.id]}{let o=this.name2Id[i];if(o==null)throw new yn(`Feed dict has no SymbolicTensor name: ${i}`);return this.id2Value[o]}}getMask(i){if(i instanceof no){if(this.id2Value[i.id]==null)throw new yn(`Nonexistent key: ${i.name}`);return this.id2Mask[i.id]}{let o=this.name2Id[i];if(o==null)throw new yn(`Feed dict has no SymbolicTensor name: ${i}`);return this.id2Mask[o]}}disposeMasks(){this.id2Mask!=null&&(0,m.dispose)(this.id2Mask)}}let u0=new bw,X8=new bw;function R5(l,i,o,u){let c=o!=null&&o.training,f=Array.isArray(l),y=f?l:[l],w=y.map(V=>V.name),C=[],T=i.names();for(let V of w)T.indexOf(V)!==-1?C.push(i.getValue(V)):C.push(null);let x=w.join(",")+"|"+i.names().sort().join(","),A,M=u0.get(x);if(M==null){let V=function(G,Q){m.util.assert(G!=null&&G.length>0,()=>"Expected at least one fetch, got none");let nt=[],it={};if(G.length===1){let ht=Sw(G[0],Q);nt=ht.sorted,it=ht.recipientMap}else{let ht=new Set;for(let kt of G){let{sorted:Nt,recipientMap:$t}=Sw(kt,Q);for(let Ut of Nt)ht.has(Ut.name)||(nt.push(Ut),ht.add(Ut.name));for(let Ut in $t)it[Ut]==null&&(it[Ut]=new Set),$t[Ut].forEach(Pt=>it[Ut].add(Pt))}}return{sorted:nt,recipientCounts:xlt(it)}}(y,i);M=V.sorted,A=V.recipientCounts,u0.put(x,M),X8.put(x,A)}A={},c||Object.assign(A,X8.get(x));let $=new Zh(i);for(let V=0;V<M.length;++V){let G=M[V],Q=G.sourceLayer;if(Q instanceof Nd)continue;let nt=[],it=[],ht=[],kt=!1;for(let re of G.inputs){let ue=$.getValue(re),be=$.getMask(re);nt.push(ue),it.push(be),be!=null&&(kt=!0),c||(A[re.name]--,A[re.name]!==0||i.hasKey(re)||w.indexOf(re.name)!==-1||ue.isDisposed||re.sourceLayer.stateful===!0||ht.push(ue))}kt&&((o=o||{}).mask=it[0]);let Nt=xo(Q.apply(nt,o)),$t=null;Q.supportsMasking&&($t=Q.computeMask(nt,it));let Ut=F5(G),Pt=Array.isArray(Ut)?Ut:[Ut];for(let re=0;re<Pt.length;++re){$.hasKey(Pt[re])||$.add(Pt[re],Nt[re],Array.isArray($t)?$t[0]:$t);let ue=w.indexOf(Pt[re].name);ue!==-1&&(C[ue]=Nt[re])}c||(0,m.dispose)(ht)}return $.disposeMasks(),f?C:C[0]}function xlt(l){let i={};for(let o in l)i[o]=l[o].size;return i}function Sw(l,i){let o=new Set,u=[],c={};for(let w of i.names())o.add(w);let f=[],y=[];for(f.push(l);f.length>0;){let w=f[f.length-1];if(o.has(w.name)){f.pop();continue}let C=y[y.length-1]===f.length-1;if(w.inputs.length===0||C)f.pop(),u.push(w),o.add(w.name),C&&y.pop();else{y.push(f.length-1);for(let T of w.inputs)c[T.name]==null&&(c[T.name]=new Set),c[T.name].add(w.name),o.has(T.name)||f.push(T)}}return{sorted:u,recipientMap:c}}function F5(l){let i;if(l.sourceLayer.inboundNodes.length===1)i=l.sourceLayer.output;else{let o=null;for(let u=0;u<l.sourceLayer.inboundNodes.length;++u)for(let c of l.sourceLayer.inboundNodes[u].outputTensors)if(c.id===l.id){o=u;break}i=l.sourceLayer.getOutputAt(o)}return i}function K8(l,i){return(0,m.tidy)(()=>m.sqrt(m.sum(m.mul(l,l),i,!0)))}(0,m.env)().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,function(l){u0?.setMaxEntries(l),X8?.setMaxEntries(l)});class _w extends m.serialization.Serializable{getConfig(){return{}}}class JD extends _w{constructor(i){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=i.maxValue!=null?i.maxValue:this.defaultMaxValue,this.axis=i.axis!=null?i.axis:this.defaultAxis}apply(i){return(0,m.tidy)(()=>{let o=K8(i,this.axis),u=m.clipByValue(o,0,this.maxValue);return m.mul(i,m.div(u,m.add(ko(),o)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}JD.className="MaxNorm",m.serialization.registerClass(JD);class tR extends _w{constructor(i){super(),this.defaultAxis=0,this.axis=i.axis!=null?i.axis:this.defaultAxis}apply(i){return(0,m.tidy)(()=>m.div(i,m.add(ko(),K8(i,this.axis))))}getConfig(){return{axis:this.axis}}}tR.className="UnitNorm",m.serialization.registerClass(tR);class eR extends _w{apply(i){return m.relu(i)}}eR.className="NonNeg",m.serialization.registerClass(eR);class nR extends _w{constructor(i){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=i.minValue!=null?i.minValue:this.defaultMinValue,this.maxValue=i.maxValue!=null?i.maxValue:this.defaultMaxValue,this.rate=i.rate!=null?i.rate:this.defaultRate,this.axis=i.axis!=null?i.axis:this.defaultAxis}apply(i){return(0,m.tidy)(()=>{let o=K8(i,this.axis),u=m.add(m.mul(this.rate,m.clipByValue(o,this.minValue,this.maxValue)),m.mul(1-this.rate,o));return m.mul(i,m.div(u,m.add(ko(),o)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}nR.className="MinMaxNorm",m.serialization.registerClass(nR);let DG={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function el(l){return ne(l)}function rR(l,i={}){return Oe(l,m.serialization.SerializationMap.getMap().classNameMap,i,"constraint")}function Su(l){return l==null?null:typeof l=="string"?rR({className:l in DG?DG[l]:l,config:{}}):l instanceof _w?l:rR(l)}function O5(l){return new JD(l)}function L5(l){return new tR(l)}function klt(){return new eR}function RG(l){return new nR(l)}function FG(){return new N5}function $5(){return new kw}function Slt(l){return new M5(l)}function iR(l){return new D5(l)}function aR(l){return new Ne(l)}function z5(l){return new Se(l)}function oR(l){return new ke(l)}function P5(l){return new ve(l)}function Z8(l){return new Te(l)}function sR(l){return new Fe(l)}function Q8(l){return new je(l)}function uR(l){return new hn(l)}function OG(l){return new Pn(l)}function cc(l){return new On(l)}function _lt(l){return new sr(l)}function h2(l){return ce(this,null,function*(){if(l==null)return;let i=[],o=[],u=[];for(let c in l){let f=l[c];if(typeof f!="number"){let y=f;i.push(y.data()),o.push(c),u.push(y)}}if(i.length>0){let c=yield Promise.all(i);for(let f=0;f<c.length;++f)l[o[f]]=c[f][0];(0,m.dispose)(u)}})}function Oo(l){if(l!=null)for(let i in l){let o=l[i];typeof o!="number"&&o.dispose()}}var LG,d2;(d2=LG||(LG={}))[d2.SILENT=0]="SILENT",d2[d2.VERBOSE=1]="VERBOSE";class dm{constructor(){this.validationData=null}setParams(i){this.params=i}onEpochBegin(i,o){return ce(this,null,function*(){})}onEpochEnd(i,o){return ce(this,null,function*(){})}onBatchBegin(i,o){return ce(this,null,function*(){})}onBatchEnd(i,o){return ce(this,null,function*(){})}onTrainBegin(i){return ce(this,null,function*(){})}onTrainEnd(i){return ce(this,null,function*(){})}setModel(i){}}class $G{constructor(i,o=10){i==null&&(i=[]),this.callbacks=i,this.queueLength=o}append(i){this.callbacks.push(i)}setParams(i){for(let o of this.callbacks)o.setParams(i)}setModel(i){for(let o of this.callbacks)o.setModel(i)}onEpochBegin(i,o){return ce(this,null,function*(){o==null&&(o={});for(let u of this.callbacks)yield u.onEpochBegin(i,o)})}onEpochEnd(i,o){return ce(this,null,function*(){o==null&&(o={});for(let u of this.callbacks)yield u.onEpochEnd(i,o)})}onBatchBegin(i,o){return ce(this,null,function*(){o==null&&(o={});for(let u of this.callbacks)yield u.onBatchBegin(i,o)})}onBatchEnd(i,o){return ce(this,null,function*(){o==null&&(o={});for(let u of this.callbacks)yield u.onBatchEnd(i,o)})}onTrainBegin(i){return ce(this,null,function*(){i==null&&(i={});for(let o of this.callbacks)yield o.onTrainBegin(i)})}onTrainEnd(i){return ce(this,null,function*(){i==null&&(i={});for(let o of this.callbacks)yield o.onTrainEnd(i)})}}class Clt extends dm{constructor(){super()}onEpochBegin(i){return ce(this,null,function*(){this.seen=0,this.totals={}})}onBatchEnd(i,o){return ce(this,null,function*(){o==null&&(o={});let u=o.size==null?0:o.size;this.seen+=u;for(let c in o){let f=o[c];if(typeof f=="number")this.totals.hasOwnProperty(c)||(this.totals[c]=0),this.totals[c]=this.totals[c]+f*u;else{let y;c in this.totals?y=this.totals[c]:this.totals[c]=0;let w=(0,m.tidy)(()=>(0,m.add)(this.totals[c],(0,m.mul)(f,u)));this.totals[c]=w,y?.dispose()}}})}onEpochEnd(i,o){return ce(this,null,function*(){if(o!=null)for(let u of this.params.metrics)this.totals[u]!=null&&(typeof this.totals[u]=="number"?o[u]=this.totals[u]/this.seen:(0,m.tidy)(()=>{let c=(0,m.mul)((0,m.div)(1,this.seen),this.totals[u]);o[u]=c,this.totals[u].dispose(),(0,m.keep)(o[u])}))})}}class zG extends dm{onTrainBegin(i){return ce(this,null,function*(){this.epoch=[],this.history={}})}onEpochEnd(i,o){return ce(this,null,function*(){o==null&&(o={}),this.epoch.push(i);for(let u in o)this.history[u]==null&&(this.history[u]=[]),this.history[u].push(o[u])})}syncData(){return ce(this,null,function*(){let i=[],o=[],u=[];for(let f in this.history){let y=this.history[f];for(let w=0;w<y.length;++w)if(typeof y[w]!="number"){let C=y[w];i.push(C.data()),o.push(f),u.push(w)}}let c=yield Promise.all(i);for(let f=0;f<c.length;++f)this.history[o[f]][u[f]].dispose(),this.history[o[f]][u[f]]=c[f][0]})}}class PG extends dm{constructor(i,o){if(super(),this.currentEpoch=0,this.nowFunc=i.nowFunc,this.nextFrameFunc=i.nextFrameFunc||m.nextFrame,this.yieldEvery=o||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=125),this.yieldEvery==="never"&&i.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");m.util.isNumber(this.yieldEvery)&&(this.maybeWait=function(u,c,f){let y,w=f!=null?f():m.util.now();return(...C)=>{let T=f!=null?f():m.util.now();return T-w<c||(w=T,y=u(...C)),y}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=i.onTrainBegin,this.trainEnd=i.onTrainEnd,this.epochBegin=i.onEpochBegin,this.epochEnd=i.onEpochEnd,this.batchBegin=i.onBatchBegin,this.batchEnd=i.onBatchEnd,this.yield=i.onYield}maybeWait(i,o,u){return ce(this,null,function*(){let c=[];this.yield!=null&&(yield h2(u),c.push(this.yield(i,o,u))),c.push(this.nextFrameFunc()),yield Promise.all(c)})}onEpochBegin(i,o){return ce(this,null,function*(){this.currentEpoch=i,this.epochBegin!=null&&(yield h2(o),yield this.epochBegin(i,o))})}onEpochEnd(i,o){return ce(this,null,function*(){let u=[];this.epochEnd!=null&&(yield h2(o),u.push(this.epochEnd(i,o))),this.yieldEvery==="epoch"&&u.push(this.nextFrameFunc()),yield Promise.all(u)})}onBatchBegin(i,o){return ce(this,null,function*(){this.batchBegin!=null&&(yield h2(o),yield this.batchBegin(i,o))})}onBatchEnd(i,o){return ce(this,null,function*(){let u=[];this.batchEnd!=null&&(yield h2(o),u.push(this.batchEnd(i,o))),this.yieldEvery==="batch"?u.push(this.nextFrameFunc()):m.util.isNumber(this.yieldEvery)&&u.push(this.maybeWait(this.currentEpoch,i,o)),yield Promise.all(u)})}onTrainBegin(i){return ce(this,null,function*(){this.trainBegin!=null&&(yield h2(i),yield this.trainBegin(i))})}onTrainEnd(i){return ce(this,null,function*(){this.trainEnd!=null&&(yield h2(i),yield this.trainEnd(i))})}}function BG(l,i){return l==null&&(l={}),l instanceof dm?[l]:Array.isArray(l)&&l[0]instanceof dm?l:xo(l).map(o=>new PG(o,i))}class Md{constructor(){}static registerCallbackConstructor(i,o){m.util.assert(i>=0&&Number.isInteger(i),()=>`Verbosity level is expected to be an integer >= 0, but got ${i}`),Md.checkForDuplicate(o),Md.constructors[i]==null&&(Md.constructors[i]=[]),Md.constructors[i].push(o)}static checkForDuplicate(i){for(let o in Md.constructors)Md.constructors[+o].forEach(u=>{if(u===i)throw new yn("Duplicate callback constructor.")})}static clear(){Md.constructors={}}static createCallbacks(i){let o=[];for(let u in Md.constructors){let c=+u;i>=c&&o.push(...Md.constructors[c])}return o.map(u=>new u)}}function lR(l,i,o,u,c,f,y,w,C){let T=new zG,x=[new Clt,...Md.createCallbacks(i)];l!=null&&x.push(...l),x.push(T);let A=new $G(x);return A.setParams({epochs:o,initialEpoch:u,samples:c,steps:f,batchSize:y,verbose:i,doValidation:w,metrics:C}),{callbackList:A,history:T}}function l0(l,i={},o=!1){return Oe(l,m.serialization.SerializationMap.getMap().classNameMap,i,"layer",o)}function J8(l,i){return(0,m.tidy)(()=>{l.dtype!=="float32"&&(l=m.cast(l,"float32"));let o=m.sum(ip(l),i,!0),u=m.fill(o.shape,ko()),c=m.sqrt(m.maximum(o,u));return m.div(l,c)})}function _v(l,i){return(0,m.tidy)(()=>m.mean(ip(m.sub(i,l)),-1))}function B5(l,i){return(0,m.tidy)(()=>m.mean(m.abs(m.sub(i,l)),-1))}function Cw(l,i){return(0,m.tidy)(()=>{let o=m.sub(l,i),u=m.clipByValue(m.abs(l),ko(),Number.MAX_VALUE),c=m.abs(m.div(o,u));return m.mul(100,m.mean(c,-1))})}function jG(l,i){return(0,m.tidy)(()=>{let o=m.clipByValue(i,ko(),Number.MAX_VALUE),u=m.log(m.add(1,o)),c=m.clipByValue(l,ko(),Number.MAX_VALUE),f=m.log(m.add(1,c));return m.mean(ip(m.sub(u,f)),-1)})}function j5(l,i,o=!1){return(0,m.tidy)(()=>{if(o)i=m.softmax(i);else{let u=m.sum(i,i.shape.length-1,!0);i=m.div(i,u)}return i=m.clipByValue(i,ko(),1-ko()),m.neg(m.sum(m.mul(m.cast(l,"float32"),m.log(i)),i.shape.length-1))})}function tE(l,i,o=!1){return(0,m.tidy)(()=>{let u=m.cast(m.floor(function(f){let y=[lm(f.shape)];return m.reshape(f,y)}(l)),"int32"),c=(i=m.clipByValue(i,ko(),1-ko())).shape;return j5(m.reshape(m.oneHot(u,c[c.length-1]),c),i,o)})}function eE(l,i){return(0,m.tidy)(()=>{let o;return o=m.clipByValue(i,ko(),1-ko()),o=m.log(m.div(o,m.sub(1,o))),m.mean(function(u,c){if(!m.util.arraysEqual(u.shape,c.shape))throw new yn(`logits and labels must have the same shape, but got shapes ${JSON.stringify(u.shape)} and ${JSON.stringify(c.shape)}`);return(0,m.tidy)(()=>{let f=m.relu(c),y=m.neg(m.abs(c));return m.add(m.sub(f,m.mul(c,u)),m.log1p(m.exp(y)))})}(l,o),-1)})}function Elt(l,i){return(0,m.tidy)(()=>{let o=m.clipByValue(l,ko(),1),u=m.clipByValue(i,ko(),1);return m.sum(m.mul(l,m.log(m.div(o,u))),-1)})}function cR(l,i){return(0,m.tidy)(()=>{let o=J8(l,-1),u=J8(i,-1),c=m.mul(o,u);return m.neg(m.sum(c,-1))})}Md.constructors={};let nE={meanSquaredError:_v,meanAbsoluteError:B5,meanAbsolutePercentageError:Cw,meanSquaredLogarithmicError:jG,squaredHinge:function(l,i){return(0,m.tidy)(()=>{let o=m.maximum(0,m.sub(1,m.mul(l,i)));return m.mean(ip(o),-1)})},hinge:function(l,i){return(0,m.tidy)(()=>{let o=m.maximum(0,m.sub(1,m.mul(l,i)));return m.mean(o,-1)})},categoricalHinge:function(l,i){return(0,m.tidy)(()=>{let o=m.sum(m.mul(l,i),-1),u=m.max(m.mul(m.sub(1,l),i),-1);return m.maximum(0,m.add(1,m.sub(u,o)))})},logcosh:function(l,i){return(0,m.tidy)(()=>{let o=Math.log(2),u=m.sub(i,l),c=m.sub(m.add(u,m.softplus(m.mul(-2,u))),o);return m.mean(c,-1)})},categoricalCrossentropy:j5,sparseCategoricalCrossentropy:tE,binaryCrossentropy:eE,kullbackLeiblerDivergence:Elt,poisson:function(l,i){return(0,m.tidy)(()=>{let o=m.log(m.add(ko(),i));return m.mean(m.sub(i,m.mul(l,o)),-1)})},cosineProximity:cR};function hR(l){if(typeof l=="string"){if(l in nE)return nE[l];let i=`Unknown loss ${l}`;throw l.toLowerCase().includes("softmaxcrossentropy")&&(i=`Unknown loss ${l}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new yn(i)}return l}function rE(l,i){return(0,m.tidy)(()=>{let o=m.mul(.5,m.onesLike(i)),u=Hl(m.greater(i,o),l.dtype);return m.mean(m.equal(l,u),-1)})}function dR(l,i){return(0,m.tidy)(()=>Hl(m.equal(m.argMax(l,-1),m.argMax(i,-1)),"float32"))}function UG(l,i){return(0,m.tidy)(()=>m.cast(m.sum(m.logicalAnd(m.equal(l,1),m.equal(i,1))),"float32"))}function WG(l,i){return(0,m.tidy)(()=>{let o=UG(l,i),u=function(f,y){return(0,m.tidy)(()=>m.cast(m.sum(m.logicalAnd(m.equal(f,0),m.equal(y,1))),"float32"))}(l,i),c=m.add(o,u);return m.cast(m.where(m.greater(c,0),m.div(o,c),0),"float32")})}function VG(l,i){return(0,m.tidy)(()=>{let o=UG(l,i),u=function(f,y){return(0,m.tidy)(()=>m.cast(m.sum(m.logicalAnd(m.equal(f,1),m.equal(y,0))),"float32"))}(l,i),c=m.add(o,u);return m.cast(m.where(m.greater(c,0),m.div(o,c),0),"float32")})}function GG(l,i){return eE(l,i)}function HG(l,i){return l.rank===i.rank&&(l=m.squeeze(l,[l.rank-1])),(i=m.argMax(i,-1)).dtype!==l.dtype&&(i=m.cast(i,l.dtype)),m.cast(m.equal(l,i),"float32")}let fR=j5,YG=tE,iE={binaryAccuracy:rE,categoricalAccuracy:dR,precision:WG,categoricalCrossentropy:fR,sparseCategoricalCrossentropy:YG,mse:_v,MSE:_v,mae:B5,MAE:B5,mape:Cw,MAPE:Cw,cosine:cR};function Tlt(l){if(typeof l=="string"&&l in iE)return iE[l];if(typeof l!="string"&&l!=null)return l;throw new yn(`Unknown metric ${l}`)}function U5(l){if(qh(l!==null,`Unknown LossOrMetricFn ${l}`),typeof l=="string")return l;{let i;for(let o of Object.keys(nE))if(nE[o]===l){i=o;break}if(i!==void 0)return i;for(let o of Object.keys(iE))if(iE[o]===l){i=o;break}return i!==void 0?i:l.name}}let Alt=1048576;function qG(l,i,o=!1){if(l==null||typeof l!="object"||Object.getPrototypeOf(l)!==Object.prototype||!pR(l))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(o){let u=JSON.stringify(l);u.length>Alt&&console.warn(`User-defined metadata of model "${i}" is too large in size (length=${u.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function pR(l){if(l===null)return!0;if(typeof l=="object"){if(Object.getPrototypeOf(l)===Object.prototype){let i=Object.keys(l);for(let o of i)if(typeof o!="string"||!pR(l[o]))return!1;return!0}if(Array.isArray(l)){for(let i of l)if(!pR(i))return!1;return!0}return!1}{let i=typeof l;return i==="string"||i==="number"||i==="boolean"}}function Ilt(l,i,o,u=console.log){let c=function(x){let A=!0,M=[],$=[];for(let V in x.nodesByDepth)M.push(x.nodesByDepth[V]);for(let V of M){if(V.length>1||V.length===1&&V[0].inboundLayers.length>1){A=!1;break}$.push(...V)}if(A)for(let V of x.layers){let G=!1;for(let Q of V.inboundNodes)if($.indexOf(Q)!==-1){if(G){A=!1;break}G=!0}if(!A)break}return A}(l),f=["Layer (type)","Input Shape","Output shape","Param #"],y;if(c?(i=i||90,o=o||[.32,.61,.89,1]):(i=i||115,o=o||[.24,.48,.7,.8,1]),o[o.length-1]<=1&&(o=o.map(x=>Math.floor(i*x))),!c){f.push("Receives inputs"),y=[];for(let x in l.nodesByDepth)y.push(...l.nodesByDepth[x])}u("_".repeat(i)),aE(f,o,u),u("=".repeat(i));let w=l.layers;for(let x=0;x<w.length;++x)c?Nlt(w[x],o,u):Mlt(w[x],o,y,u),u((x===w.length-1?"=":"_").repeat(i));l.checkTrainableWeightsConsistency();let C=function(x){let A;return A=x.collectedTrainableWeights!=null?Bs(x.collectedTrainableWeights):Bs(x.trainableWeights),A}(l),T=Bs(l.nonTrainableWeights);u(`Total params: ${C+T}`),u(`Trainable params: ${C}`),u(`Non-trainable params: ${T}`),u("_".repeat(i))}function aE(l,i,o=console.log){let u="";for(let c=0;c<l.length;++c)c>0&&(u=u.slice(0,u.length-1)+" "),u+=l[c],u=u.slice(0,i[c]),u+=" ".repeat(i[c]-u.length);o(u)}function Nlt(l,i,o){let u,c;try{c=l.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch{c="multiple"}try{u=JSON.stringify(l.outputShape)}catch{u="multiple"}aE([`${l.name} (${l.getClassName()})`,c,u,l.countParams().toString()],i,o)}function Mlt(l,i,o,u){let c,f;try{f=l.inboundNodes.map(x=>JSON.stringify(x.inputShapes)).join(",")}catch{f="multiple"}try{c=JSON.stringify(l.outputShape)}catch{c="multiple"}let y=[];for(let x of l.inboundNodes)if(!(o!=null&&o.length>0&&o.indexOf(x)===-1))for(let A=0;A<x.inboundLayers.length;++A){let M=x.inboundLayers[A].name,$=x.nodeIndices[A],V=x.tensorIndices[A];y.push(`${M}[${$}][${V}]`)}let w=l.name,C=l.getClassName(),T=y.length===0?"":y[0];aE([`${w} (${C})`,f,c,l.countParams().toString(),T],i,u);for(let x=1;x<y.length;++x)aE(["","","","",y[x]],i,u)}function XG(l,i,o){return(l==="inboundNodes"||l==="outputLayers"||l==="inputLayers")&&i===0&&typeof o=="string"}function Ew(l,i){if(l===null)return null;if(typeof l=="string")return oe(l);if(typeof l=="number"||typeof l=="boolean")return l;if(l instanceof Array){let o=[],u=l.length;for(let c=0;c<u;++c){let f=l[c];XG(i,c,f)?o.push(f):o.push(Ew(f,i))}return o}{let o={};for(let u of Object.keys(l)){let c=l[u];if(u==="name"&&typeof c=="string")o[u]=c;else{let f=oe(u);o[f]=Ew(c,f)}}return o}}function mR(l,i){if(l==null)return null;if(typeof l=="string")return Xh(l);if(typeof l=="number"||typeof l=="boolean")return l;if(l instanceof Array){let o=[],u=l.length;for(let c=0;c<u;++c){let f=l[c];XG(i,c,f)?o.push(f):o.push(mR(f,i))}return o}{let o={};for(let u of Object.keys(l)){let c=l[u],f=Xh(u);o[f]=u!=="name"&&u!=="className"||typeof c!="string"?mR(c,u):c}return o}}let oE="4.22.0";class c0 extends Hi{constructor(i){if(super({}),this.containerNodes=new Set,this.name=i.name,this.name==null){let it=this.getClassName().toLowerCase();this.name=Ps(it)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(i.inputs)?this.inputs=i.inputs.slice():this.inputs=[i.inputs],Array.isArray(i.outputs)?this.outputs=i.outputs.slice():this.outputs=[i.outputs],vn(this.inputs).length!==this.inputs.length)throw new yn(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(it=>it.name)}`);vn(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(it=>it.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(let it of this.outputs){let ht=it.sourceLayer,kt=it.nodeIndex,Nt=it.tensorIndex;this.outputLayers.push(ht),this.outputLayersNodeIndices.push(kt),this.outputLayersTensorIndices.push(Nt)}for(let it of this.inputs){let ht=it.sourceLayer,kt=it.nodeIndex,Nt=it.tensorIndex;qh(kt===0,"input layer has >1 nodes"),qh(Nt===0,"input layer has >1 tensors"),this.inputLayers.push(ht),this.inputLayersNodeIndices.push(kt),this.inputLayersTensorIndices.push(Nt)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let it=0;it<this.inputLayers.length;it++){let ht=this.inputLayers[it];if(!(ht instanceof Nd))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${i.inputs}. Input ${it} (0-based) originates from layer type ${ht.getClassName()}.`);this.inputNames.push(ht.name),this.feedInputShapes.push(ht.batchInputShape),this.feedInputNames.push(ht.name)}for(let it of this.outputLayers)this.outputNames.push(it.name);this.internalInputShapes=this.inputs.map(it=>it.shape),this.internalOutputShapes=this.outputs.map(it=>it.shape);let o={},u={},c={},f={},y={},w=[],C=(it,ht,kt,Nt,$t,Ut)=>{Nt!=null&&$t!=null&&Ut!=null||(Nt=it.sourceLayer,$t=it.nodeIndex,Ut=it.tensorIndex);let Pt=Nt.inboundNodes[$t];if(kt.indexOf(Pt)!==-1)throw new Gl(`The tensor ${it.name} at layer "${Nt.name}" is part of a cycle.`);if(ht.indexOf(Pt)!==-1)return;this.containerNodes.add(c0.nodeKey(Nt,$t)),Nt.id in y||(y[Nt.id]=Object.keys(y).length),kt.indexOf(Pt)===-1&&kt.push(Pt);let re=Pt.inboundLayers.length;for(let ue=0;ue<re;ue++){let be=Pt.inputTensors[ue],De=Pt.inboundLayers[ue],ze=Pt.nodeIndices[ue],Qe=Pt.tensorIndices[ue];C(be,ht,kt,De,ze,Qe)}for(ht.push(Pt);kt.indexOf(Pt)>=0;)kt.splice(kt.indexOf(Pt),1);w.push(Pt)},T=[],x=[];for(let it of this.outputs)C(it,T,x);let A=w.slice().reverse();for(let it of A){u[it.id]=it,it.id in o||(o[it.id]=0);let ht=o[it.id],kt=c[it.outboundLayer.id]==null?0:c[it.outboundLayer.id];ht=Math.max(ht,kt),c[it.outboundLayer.id]=ht,f[it.outboundLayer.id]=it.outboundLayer,o[it.id]=ht;for(let Nt=0;Nt<it.inboundLayers.length;Nt++){let $t=it.inboundLayers[Nt],Ut=it.nodeIndices[Nt],Pt=$t.inboundNodes[Ut],re=o[Pt.id]==null?0:o[Pt.id];o[Pt.id]=Math.max(ht+1,re),u[Pt.id]=Pt}}let M={};for(let it in o){let ht=o[it];ht in M||(M[ht]=[]),M[ht].push(u[it])}let $={};for(let it in c){let ht=c[it];ht in $||($[ht]=[]),$[ht].push(f[it])}let V=Object.keys($).map(it=>parseInt(it,10)).sort(fn);this.layers=[];for(let it of V){let ht=$[it];ht.sort((kt,Nt)=>{let $t=y[kt.id],Ut=y[Nt.id];return $t<Ut?-1:$t>Ut?1:0});for(let kt of ht)kt instanceof c0&&this.internalContainerRefs.push(kt),this.layers.push(kt)}this.layersByDepth=$,V=Object.keys(M).map(it=>parseInt(it,10)).sort(fn);let G=this.inputs.slice(),Q=[];for(let it of V)for(let ht of M[it]){let kt=ht.outboundLayer;if(kt!=null){for(let Nt of ht.inputTensors)if(G.indexOf(Nt)===-1)throw new Gl(`Graph disconnected: cannot obtain value for tensor ${Nt} at layer "${kt.name}". The following previous layers were accessed without issue: ${Q}`);for(let Nt of ht.outputTensors)G.push(Nt);Q.push(kt.name)}}this.nodesByDepth=M;let nt=this.layers.map(it=>it.name);for(let it of nt){let ht=nt.filter(kt=>kt===it).length;if(ht!==1)throw new Gl(`The name "${it}" is used ${ht} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(nt))}this.outboundNodes=[],this.inboundNodes=[],new js({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(it=>null),outputMasks:this.outputs.map(it=>null),inputShapes:this.inputs.map(it=>it.shape),outputShapes:this.outputs.map(it=>it.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();let i={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount==0){for(let o of this.layers)i.numDisposedVariables+=o.dispose().numDisposedVariables;for(let o of this.internalContainerRefs)i.numDisposedVariables+=o.dispose().numDisposedVariables}return i.refCountAfterDispose=this._refCount,i}get trainable(){return this.trainable_}set trainable(i){this.layers.forEach(o=>{o._trainableWeights.forEach(u=>u.trainable=i)}),this.trainable_=i}get trainableWeights(){if(this._trainableWeights.length>0)throw new yn("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let i=[];for(let o of this.layers)i=i.concat(o.trainableWeights);return i}get nonTrainableWeights(){let i=[];for(let o of this.layers)i.push(...o.nonTrainableWeights);if(!this.trainable){let o=[];for(let u of this.layers)o.push(...u.trainableWeights);return o.concat(i)}return i}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(i,o=!0){let u={},c=0,f=(w=>{let C=Object.keys(w);if(C.length===0)return!1;let T=C[0].split("/");return!isNaN(parseInt(T[T.length-1],10))})(i);f&&this.parseWeights(i);for(let w of this.layers)for(let[C,T]of w.weights.entries()){let x=f?`${T.name.split("/").slice(0,-1).join("/")+"/"}${C}`:T.originalName;if(u[x]!=null)throw new yn(`Duplicate weight name: ${x}`);u[x]=T,c++}let y=[];for(let w in i){let C=w;if(u[w]==null){let T=w.split("/");C=T.slice(0,-2).concat([T[T.length-1]]).join("/")}if(u[C]!=null)y.push([u[C],i[w]]);else if(o)throw new yn(`Provided weight data has no target variable: ${w}`);delete u[C]}if(o){let w=[];for(let C in u)w.push(C);if(w.length>0)throw new yn(`${w.length} of ${c} weights are not set: ${w}`)}Bo(y)}parseWeights(i){for(let o in Object.keys(i)){let u=o.split("/"),c=["vars","layer_checkpoint_dependencies"],f=u.map(y=>y.startsWith("_")?y.slice(1):y).filter(y=>!c.includes(y)).join("/");f!==o&&(i[f]=i[o],delete i[o])}}updatedConfig(){let i=this.getConfig(),o={};return o.className=this.getClassName(),o.config=i,o.kerasVersion=`tfjs-layers ${oE}`,o.backend="TensorFlow.js",o}toJSON(i,o=!0){let u=mR(this.updatedConfig());return o?JSON.stringify(u):u}call(i,o){return(0,m.tidy)(()=>{i=xo(i);let u=new Zh;for(let c=0;c<this.inputs.length;++c)u.add(this.inputs[c],i[c]);return R5(this.outputs,u,o)})}computeMask(i,o){return(0,m.tidy)(()=>{let u;return i=xo(i),u=o==null?i0(null,i.length):xo(o),this.runInternalGraph(i,u)[1]})}computeOutputShape(i){let o=Ha(i);if(o.length!==this.inputLayers.length)throw new yn(`Invalid inputShape argument ${i}: model has ${this.inputLayers.length} tensor inputs.`);let u={};for(let w=0;w<o.length;w++){let C=this.inputLayers[w],T=o[w];u[C.name+"_0_0"]=T}let c=Object.keys(this.nodesByDepth).map(w=>parseInt(w,10)).sort(fn);if(c.length>1)for(let w of c){let C=this.nodesByDepth[w];for(let T of C){let x=T.outboundLayer;if(this.inputLayers.map(V=>V.id).indexOf(x.id)!==-1)continue;let A=[];for(let V=0;V<T.inboundLayers.length;V++){let G=T.inboundLayers[V],Q=T.nodeIndices[V],nt=T.tensorIndices[V],it=u[`${G.name}_${Q}_${nt}`];A.push(it)}let M=Ha(x.computeOutputShape($u(A))),$=x.inboundNodes.indexOf(T);for(let V=0;V<M.length;V++)u[`${x.name}_${$}_${V}`]=M[V]}}let f=[],y=[];for(let w=0;w<this.outputLayers.length;w++){let C=this.outputLayers[w],T=this.outputLayersNodeIndices[w],x=this.outputLayersTensorIndices[w],A=`${C.name}_${T}_${x}`;y.push(A)}for(let w=0;w<y.length;w++){let C=y[w];qh(C in u),f.push(u[C])}return $u(f)}runInternalGraph(i,o){o==null&&(o=i0(null,i.length));let u={};for(let C=0;C<this.inputs.length;++C){let T=this.inputs[C],x=i[C],A=o[C];u[T.id]=[x,A]}let c=Object.keys(this.nodesByDepth).map(C=>parseInt(C,10)).sort(fn);for(let C of c){let T=this.nodesByDepth[C];for(let x of T){let A=x.outboundLayer,M=x.inputTensors,$=x.outputTensors,V=new Array;for(let G of M)G.id in u&&V.push(u[G.id]);if(V.length===M.length){let G,Q,nt,it,ht={};if(x.callArgs!=null&&(ht=x.callArgs),V.length===1){let[kt,Nt]=V[0];ht.mask==null&&(ht.mask=Nt),nt=xo(A.call(kt,ht)),it=xo(A.computeMask(kt,Nt)),G=[kt],Q=[Nt]}else G=V.map(kt=>kt[0]),Q=V.map(kt=>kt[1]),ht.mask==null&&(ht.mask=Q),nt=xo(A.call(G,ht)),it=xo(A.computeMask(G,Q));if(A.activityRegularizer)throw new Wi("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let kt=0;kt<$.length;++kt){let Nt=$[kt],$t=nt[kt],Ut=it[kt];u[Nt.id]=[$t,Ut]}}}}let f=[],y=[],w=[];for(let C of this.outputs){qh(C.id in u,`Could not compute output ${C.name} : ${C.id}`);let[T,x]=u[C.id];w.push(T.shape),f.push(T),y.push(x)}return[f,y,w]}buildNodeConversionMap(i){let o={},u;for(let c of this.layers){u=c instanceof c0?1:0;for(let f=0;f<c.inboundNodes.length;f++){let y=c0.nodeKey(c,f);this.containerNodes.has(y)&&(o[y]=u,u+=1)}}return o}getLayer(i,o){if(o!=null)return this.findLayer(o);if(i==null)throw new yn("Provide either a layer name or layer index");if(typeof i=="number")return this.findLayer(i);for(let u of this.layers)if(u.name===i)return u;throw new yn(`No such layer: ${i}`)}findLayer(i){if(this.layers.length<=i)throw new yn(`Was asked to retrieve layer at index ${i}, but model only has ${this.layers.length} layer(s).`);return this.layers[i]}calculateLosses(){return(0,m.tidy)(()=>{let i=[];for(let o of this.layers)for(let u=0;u<o.inboundNodes.length;++u){let c=c0.nodeKey(o,u);this.containerNodes.has(c)&&i.push(...o.calculateLosses())}return i})}getConfig(){let i={name:this.name},o=this.buildNodeConversionMap(this.layers),u=[];for(let y of this.layers){let w=y.getClassName(),C=y.getConfig(),T=[];for(let A=0;A<y.inboundNodes.length;A++){let M=y.inboundNodes[A],$=c0.nodeKey(y,A),V={};if(this.containerNodes.has($)){if(M.callArgs)try{JSON.stringify(M.callArgs),V=M.callArgs}catch{console.warn(`Layer ${y.name} was passed non-serializable keyword arguments: ${M.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),V={}}if(M.inboundLayers.length>0){let G=[];for(let Q=0;Q<M.inboundLayers.length;Q++){let nt=M.inboundLayers[Q],it=M.nodeIndices[Q],ht=M.tensorIndices[Q],kt=o[c0.nodeKey(nt,it)];kt==null&&(kt=0),G.push([nt.name,kt,ht,V])}T.push(G)}}}let x={};x.name=y.name,x.className=w,x.config=C,x.inboundNodes=T,u.push(x)}i.layers=u;let c=[];for(let y=0;y<this.inputLayers.length;y++){let w=this.inputLayers[y],C=this.inputLayersNodeIndices[y],T=c0.nodeKey(w,C);if(!this.containerNodes.has(T))continue;let x=o[T];x==null&&(x=0);let A=this.inputLayersTensorIndices[y];c.push([w.name,x,A])}i.inputLayers=c;let f=[];for(let y=0;y<this.outputLayers.length;y++){let w=this.outputLayers[y],C=this.outputLayersNodeIndices[y],T=c0.nodeKey(w,C);if(!this.containerNodes.has(T))continue;let x=o[T];x==null&&(x=0);let A=this.outputLayersTensorIndices[y];f.push([w.name,x,A])}return i.outputLayers=f,i}static fromConfig(i,o,u={},c=!1){let f={},y={};function w(Q,nt){Q.name in y?y[Q.name].push(nt):y[Q.name]=[nt]}function C(Q,nt){let it=[],ht;for(let kt of nt){let Nt=kt[0],$t=kt[1],Ut=kt[2];if(ht=kt[3]==null?{}:kt[3],!(Nt in f))return void w(Q,nt);let Pt=f[Nt];if(Pt.inboundNodes.length<=$t)return void w(Q,nt);let re=Pt.inboundNodes[$t];it.push(re.outputTensors[Ut])}it.length>0&&Q.apply($u(it),ht)}function T(Q){let nt=Q.name,it=l0(Q,o.customObjects!=null?o.customObjects:{});it.setFastWeightInitDuringBuild(c),f[nt]=it,Q.inboundNodes.forEach(ht=>{if(!(ht instanceof Array))throw new yn(`Corrupted configuration, expected array for nodeData: ${ht}`);w(it,ht)})}let x=o.name,A=o.layers;for(let Q of A)T(Q);for(;!rr(y);)for(let Q of A){let nt=f[Q.name];if(nt.name in y){let it=y[nt.name];delete y[nt.name];for(let ht of it)C(nt,ht)}}let M=[],$=[],V=o.inputLayers;for(let Q of V){let nt=Q[0],it=Q[1],ht=Q[2];qh(nt in f);let kt=f[nt].inboundNodes[it].outputTensors;M.push(kt[ht])}let G=o.outputLayers;for(let Q of G){let nt=Q[0],it=Q[1],ht=Q[2];qh(nt in f);let kt=f[nt].inboundNodes[it].outputTensors;$.push(kt[ht])}return new i({inputs:M,outputs:$,name:x})}get stateful(){if(this._stateful)throw new yn("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(let i of this.layers)if(i.stateful)return!0;return!1}resetStates(){(0,m.tidy)(()=>{this.layers.forEach(i=>{i.stateful&&i.resetStates()})})}}function KG(l,i,o){let u=i.length;if(l==null||Array.isArray(l)&&l.length===0)return i.map(c=>null);if(u===1)return Array.isArray(l)&&l.length===1?l:typeof l=="object"&&i[0]in l?[l[i[0]]]:[l];if(Array.isArray(l)){if(l.length!==u)throw new Error(`Provided ${o} is an array of ${l.length} element(s), but the model has ${u} outputs. Make sure a set of weights is provided for each model output.`);return l}if(typeof l=="object"&&Object.keys(l).length>0&&typeof l[Object.keys(l)[0]]=="object"){let c=[];return i.forEach(f=>{f in l?c.push(l[f]):c.push(null)}),c}throw new Error(`The model has multiple (${u}) outputs, so ${o} must be either an array with ${u} elements or an object with ${i} keys. Provided ${o} not understood: ${JSON.stringify(l)}`)}function ZG(l,i){return KG(l,i,"classWeight")}function QG(l,i,o,u){return ce(this,null,function*(){if(o!=null){let c=(0,m.tidy)(()=>{if(l.shape.length===1)return(0,m.clone)(l);if(l.shape.length===2){if(l.shape[1]>1)return(0,m.argMax)(l,1);if(l.shape[1]===1)return(0,m.reshape)(l,[l.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${l.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw new Error(`Unexpected rank of target (y) tensor (${l.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),f=Array.from(yield c.data());(0,m.dispose)(c);let y=[];return f.forEach(w=>{if(o[w]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${w} exists in the data but not in classWeight`);y.push(o[w])}),(0,m.tensor1d)(y,"float32")}return null})}function Dlt(l,i){return(0,m.mul)(l,i)}function JG(l,i){let o,u,c=i;o=c.xs,u=c.ys,m.util.assert(o!=null&&u!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${i}`);let f=tH("input",l.inputNames,o),y=tH("output",l.outputNames,u),w=f[0].shape[0];m.util.assert(f.length===l.inputs.length,()=>`LayersModel has ${l.inputs.length} inputs, but the dataset provides ${f.length} inputs.  (Expected input keys: ${JSON.stringify(l.inputNames)})`),m.util.assert(y.length===l.outputs.length,()=>`LayersModel has ${l.outputs.length} outputs, but the dataset provides ${y.length} outputs.  (Expected output keys: ${JSON.stringify(l.outputNames)})`);for(let C=0;C<f.length;C++)m.util.assert(f[C].shape[0]===w,()=>`Batch size mismatch: input ${l.inputNames[C]} has ${f[C].shape[0]}; expected  ${w} based on input ${l.inputNames[0]}.`);for(let C=0;C<y.length;C++)m.util.assert(y[C].shape[0]===w,()=>`Batch size mismatch: output ${l.outputNames[C]} has ${y[C].shape[0]}; expected  ${w} based on input ${l.inputNames[0]}.`);return{xs:f,ys:y}}function tH(l,i,o){if(o instanceof m.Tensor)return[o];if(Array.isArray(o))return m.util.assert(o.length===i.length,()=>`Received an array of ${o.length} Tensors, but expected ${i.length} to match the ${l} keys ${i}.`),o;{let u=[];for(let c of i){if(o[c]==null)throw new yn(`The feature data generated by the dataset lacks the required ${l} key '${c}'.`);u.push(o[c])}return u}}function Rlt(l,i,o){return ce(this,null,function*(){let u=o.batchesPerEpoch!=null;if(m.util.assert(l.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),m.util.assert(o!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),m.util.assert(o.epochs!=null&&o.epochs>0&&Number.isInteger(o.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${o.epochs}`),m.util.assert(!u||o.batchesPerEpoch>0&&Number.isInteger(o.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${o.batchesPerEpoch}`),m.util.assert(o.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),l.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");l.isTraining=!0;try{let c=o.validationData!=null,f,y;if(c)if(gR(o.validationData))m.util.assert(o.validationBatches==null||o.validationBatches>0&&Number.isInteger(o.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${o.validationBatches}`);else{let Q=function(nt){if(nt.length===3)throw new Wi("Validation with sample weights is not implemented yet.");return{xs:nt[0],ys:nt[1]}}(o.validationData);f=Q.xs,y=Q.ys}let w=l.makeTrainFunction(),C=l.getDedupedMetricsNames(),T;T=c?C.slice().concat(C.map(Q=>"val_"+Q)):C.slice();let x=BG(o.callbacks,o.yieldEvery),A=o.verbose==null?1:o.verbose,{callbackList:M,history:$}=lR(x,A,o.epochs,null,null,function(Q,nt){let it=null;return nt.batchesPerEpoch!=null?it=nt.batchesPerEpoch:Number.isFinite(Q.size)&&(it=Q.size),it}(i,o),null,c,T);M.setModel(l),l.history=$,yield M.onTrainBegin(),l.stopTraining_=!1;let V=o.initialEpoch==null?0:o.initialEpoch,G=yield i.iterator();for(;V<o.epochs;){let Q={};yield M.onEpochBegin(V);let nt=0,it=0;for(u||(G=yield i.iterator());!u||nt<o.batchesPerEpoch;){let ht=yield G.next();if(u&&ht.done){console.warn(`You provided \`batchesPerEpoch\` as ${o.batchesPerEpoch}, but your dataset iterator ran out of data after ${nt} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, `+o.batchesPerEpoch*o.epochs+" batches). You may need to use the repeat() function when building your dataset.");break}if(ht.value!=null){let{xs:kt,ys:Nt}=JG(l,ht.value),$t={};$t.batch=it,$t.size=kt[0].shape[0],yield M.onBatchBegin(it,$t);let Ut=[];if(o.classWeight!=null){let ue=ZG(o.classWeight,l.outputNames);for(let be=0;be<ue.length;++be)Ut.push(yield QG(Nt[be],null,ue[be]))}let Pt=kt.concat(Nt).concat(Ut),re=w(Pt);m.dispose(Pt);for(let ue=0;ue<C.length;++ue){let be=C[ue],De=re[ue];$t[be]=De,m.keep(De)}yield M.onBatchEnd(it,$t),Oo($t),it++,nt++}if(u?nt>=o.batchesPerEpoch:ht.done){if(c){let kt;kt=gR(o.validationData)?xo(yield l.evaluateDataset(o.validationData,{batches:o.validationBatches})):xo(l.evaluate(f,y,{batchSize:o.validationBatchSize==null?32:o.validationBatchSize,verbose:0}));for(let Nt=0;Nt<l.metricsNames.length;++Nt)Q[`val_${l.metricsNames[Nt]}`]=kt[Nt]}break}if(l.stopTraining_)break}if(yield M.onEpochEnd(V,Q),V++,l.stopTraining_)break}return yield M.onTrainEnd(),yield l.history.syncData(),l.history}finally{l.isTraining=!1}})}function gR(l){return typeof l.iterator=="function"}function yR(l){m.util.assert(l>0&&Number.isInteger(l),()=>`batchSize is required to be a positive integer, but got ${l}`)}function W5(l,i,o){return l==null?[null]:Array.isArray(l)?l.map(u=>vf(u,i,o-i)):vf(l,i,o-i)}function vR(l,i){return m.tidy(()=>l==null?null:Array.isArray(l)?l.map(o=>vR(o,i)):Kh(l,i.dtype==="int32"?i:m.cast(i,"int32")))}function bR(l,i){let o=[],u=0,c=null;for(;u<l;)c=u+i,c>=l&&(c=l),o.push([u,c]),u=c;return o}function eH(l){let i=[];l instanceof m.Tensor&&(l=[l]);for(let o=0;o<l.length;++o){let u=l[o];if(u.rank===1)i.push(Tg(u,1));else{if(u.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");i.push(u)}}return i}function h0(l,i){if(l==null)return;let o=[];if(i instanceof m.Tensor)o.push(i.id);else if(Array.isArray(i))i.forEach(c=>o.push(c.id));else if(i!=null)for(let c in i){let f=i[c];o.push(f.id)}let u=[];if(l instanceof m.Tensor)o.indexOf(l.id)===-1&&u.push(l);else if(Array.isArray(l))l.forEach(c=>{o.indexOf(c.id)===-1&&u.push(c)});else if(l!=null)for(let c in l){let f=l[c];o.indexOf(f.id)===-1&&u.push(f)}u.forEach(c=>{c.isDisposed||c.dispose()})}function wR(l){return Array.isArray(l)}function nH(l){return!function(i){return i instanceof m.Tensor}(l)&&!wR(l)}function xR(l,i,o,u=!0,c=""){if(i==null||i.length===0){if(l!=null){let y=!1;if(wR(l)&&l.length>0)y=!0;else if(nH(l)){for(let w in l)if(l.hasOwnProperty(w)){y=!0;break}}else y=!0;if(y)throw new yn(`Error when checking model ${c} expected no data, but got ${l}`)}return[]}if(l==null)return i.map(y=>null);let f;if(nH(l)){f=[];for(let y of i){if(l[y]==null)throw new yn(`No data provided for "${y}". Need data for each key in: ${i}`);f.push(l[y])}}else if(wR(l)){if(l.length!==i.length)throw new yn(`Error when checking model ${c}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${i.length} Tensor(s), but instead got the following list of Tensor(s): ${l}`);f=l}else{if(i.length>1)throw new yn(`The model ${c} expects ${i.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${l.shape}`);f=[l]}if(f=eH(f),o!=null)for(let y=0;y<i.length;++y){if(o[y]==null)continue;let w=f[y];if(w.shape.length!==o[y].length)throw new yn(`Error when checking ${c}: expected ${i[y]} to have ${o[y].length} dimension(s). but got array with shape ${w.shape}`);for(let C=0;C<o[y].length;++C){if(C===0&&!u)continue;let T=w.shape[C],x=o[y][C];if(x!=null&&x>=0&&T!==x)throw new yn(`${c} expected a batch of elements where each example has shape [${o[y].slice(1,o[y].length)}] (i.e.,tensor shape [*,${o[y].slice(1,o[y].length)}]) but the ${c} received an input with ${w.shape[0]} examples, each with shape [${w.shape.slice(1,w.shape.length)}] (tensor shape [${w.shape}])`)}}return f}function kR(l,i,o,u=!0,c=""){let f;if(Array.isArray(l)){if(l.length!==i.length)throw new yn(`Error when checking model ${c}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${i.length} Tensor(s), but instead got ${l.length} Tensors(s).`);f=l}else{if(i.length>1)throw new yn(`The model expects ${i.length} ${c} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(l.shape)}.`);f=[l]}if(o!=null)for(let y=0;y<i.length;++y){if(o[y]==null)continue;let w=f[y];if(w.shape.length!==o[y].length)throw new yn(`Error when checking ${c}: expected ${i[y]} to have ${o[y].length} dimension(s), but got array with shape ${JSON.stringify(w.shape)}`);for(let C=0;C<o[y].length;++C){if(C===0&&!u)continue;let T=w.shape[C],x=o[y][C];if(x!=null&&x!==T)throw new yn(`Error when checking ${c}: expected ${i[y]} to have shape ${JSON.stringify(o[y])} but got array with shape ${JSON.stringify(w.shape)}.`)}}}class fm extends c0{constructor(i){super(i),this.isTraining=!1}summary(i,o,u=console.log){if(!this.built)throw new yn("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Ilt(this,i,o,u)}compile(i){if(i.loss==null&&(i.loss=[]),this.loss=i.loss,typeof i.optimizer=="string")this.optimizer_=function(y){let w={Adagrad:()=>m.train.adagrad(.01),Adadelta:()=>m.train.adadelta(1,.95,ko()),Adam:()=>m.train.adam(.001,.9,.999,ko()),Adamax:()=>m.train.adamax(.002,.9,.999,ko(),0),RMSProp:()=>m.train.rmsprop(.001,.9,0,ko()),SGD:()=>m.train.sgd(.01)};if(w.adagrad=w.Adagrad,w.adadelta=w.Adadelta,w.adam=w.Adam,w.adamax=w.Adamax,w.rmsprop=w.RMSProp,w.sgd=w.SGD,y in w)return w[y]();throw new yn(`Unknown Optimizer ${y}`)}(i.optimizer),this.isOptimizerOwned=!0;else{if(!(i.optimizer instanceof m.Optimizer))throw new yn("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=i.optimizer,this.isOptimizerOwned=!1}let o=[];if(Array.isArray(i.loss)||typeof i.loss=="string"||typeof i.loss=="function")if(Array.isArray(i.loss)){if(i.loss.length!==this.outputs.length)throw new yn(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${i.loss}.`);o=i.loss.map(w=>hR(w))}else{let y=hR(i.loss);this.outputs.forEach(w=>{o.push(y)})}else{i.loss=i.loss;for(let y in i.loss)if(this.outputNames.indexOf(y)===-1)throw new yn(`Unknown entry in loss dictionary: "${y}". Only expected the following keys: ${this.outputNames}`);for(let y of this.outputNames)i.loss[y]==null&&console.warn(`Output "${y}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${y} during training`),o.push(hR(i.loss[y]))}this.lossFunctions=o,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let y=0;y<this.outputs.length;++y){let w=this.internalOutputShapes[y],C=this.outputNames[y];this.feedOutputNames.push(C),this.feedOutputShapes.push(w),this.feedLossFns.push(this.lossFunctions[y])}let u=[];this.metrics=i.metrics,this.metricsNames=["loss"],this.metricsTensors=[],yf("loss",()=>{for(let y=0;y<this.outputs.length;++y){if(u.indexOf(y)!==-1)continue;let w=this.lossFunctions[y];this.outputs.length>1&&(this.metricsTensors.push([w,y]),this.metricsNames.push(this.outputNames[y]+"_loss"))}});let c=function(y,w){if(y==null||Array.isArray(y)&&y.length===0)return w.map(T=>[]);let C;if(typeof y=="string"||typeof y=="function")C=[y];else{if(!Array.isArray(y)&&typeof y!="object")throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${y}`);C=y}if(Array.isArray(C))return w.map(T=>C);{let T=[];for(let x of w){let A=C.hasOwnProperty(x)?C[x]:[];Array.isArray(A)||(A=[A]),T.push(A)}return T}}(i.metrics,this.outputNames),f=(y,w,C)=>{this.outputNames.length>1&&(w=this.outputNames[y]+"_"+w),this.metricsNames.push(w),this.metricsTensors.push([C,y])};yf("metric",()=>{for(let y=0;y<this.outputs.length;++y)u.indexOf(y)===-1&&(w=>{let C,T,x;for(let A of w){if(typeof A=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(A)!==-1){let $=this.internalOutputShapes[y],V;$[$.length-1]===1||this.lossFunctions[y]===eE?["accuracy","acc"].indexOf(A)!==-1?T=rE:["crossentropy","ce"].indexOf(A)!==-1&&(T=GG):this.lossFunctions[y]===tE?["accuracy","acc"].indexOf(A)!==-1?T=HG:["crossentropy","ce"].indexOf(A)!==-1&&(T=YG):["accuracy","acc"].indexOf(A)!==-1?T=dR:["crossentropy","ce"].indexOf(A)!==-1&&(T=fR),["accuracy","acc"].indexOf(A)!==-1?V="acc":["crossentropy","ce"].indexOf(A)!==-1&&(V="ce"),x=T,C=""+V}else x=Tlt(A),C=""+U5(A);let M;yf(C,()=>{M=x}),f(y,C,M)}})(c[y])}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(i,o,u={}){let c=u.batchSize==null?32:u.batchSize;yR(c);let f=this.standardizeUserDataXY(i,o,!0,c);try{let y=f[0].concat(f[1]);this.makeTestFunction();let w=this.testFunction;return $u(this.testLoop(w,y,c,u.verbose,u.steps))}finally{h0(f[0],i),h0(f[1],o)}}evaluateDataset(i,o){return ce(this,null,function*(){return this.makeTestFunction(),function(u,c,f){return ce(this,null,function*(){let y=(f=f||{}).batches!=null,w=u.testFunction,C=[];if(f.verbose>0)throw new Wi("Verbose mode is not implemented yet.");m.util.assert(!y||f.batches>0&&Number.isInteger(f.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(f.batches)}`);let T=typeof c.next=="function"?c:yield c.iterator(),x=0,A=0;for(;!y||A<f.batches;){let M=yield T.next();if(C=m.tidy(()=>{if(M.value){let{xs:$,ys:V}=JG(u,M.value),G=$.concat(V),Q=m.tidy(()=>w(G));if(m.dispose(G),A===0)for(let it=0;it<Q.length;++it)C.push((0,m.scalar)(0));let nt=G[0].shape[0];for(let it=0;it<Q.length;++it){let ht=Q[it],kt=C[it];C[it]=m.tidy(()=>m.add(C[it],m.mul(nt,ht))),A>0&&m.dispose(kt)}m.dispose(Q),x+=nt,++A}return C}),M.done){y&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${f.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let M=0;M<C.length;++M){let $=C[M];C[M]=m.div(C[M],x),m.dispose($)}return $u(C)})}(this,i,o)})}checkNumSamples(i,o,u,c="steps"){let f;if(u!=null){if(f=null,o!=null)throw new yn(`If ${c} is set, batchSize must be null or undefined.Got batchSize = ${o}`)}else{if(i==null)throw new yn(`Either the input data should have a defined shape, or ${c} shoud be specified.`);f=Array.isArray(i)?i[0].shape[0]:i.shape[0]}return f}execute(i,o){if(Array.isArray(o)&&o.length===0)throw new yn("`outputs` is an empty Array, which is not allowed.");let u=Array.isArray(o),c=u?o:[o],f=this.retrieveSymbolicTensors(c),y=new Zh;if(i instanceof m.Tensor&&(i=[i]),Array.isArray(i)){if(i.length!==this.inputs.length)throw new yn(`The number of inputs provided (${i.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let C=0;C<this.inputs.length;++C)y.add(this.inputs[C],i[C])}else for(let C of this.inputs){let T=i[C.name];if(T==null)throw new yn(`No value is provided for the model's input ${C.name}`);y.add(C,T)}let w=R5(f,y);return u?w:w[0]}retrieveSymbolicTensors(i){let o=i0(null,i.length),u=i.length;for(let c of this.layers){let f=Array.isArray(c.output)?c.output:[c.output],y=f.map(w=>w.name);for(let w=0;w<i.length;++w){let C=y.indexOf(i[w]);if(C!==-1&&(o[w]=f[C],u--),u===0)break}if(u===0)break}if(u>0){let c=[];throw o.forEach((f,y)=>{f==null&&c.push(i[y])}),new yn(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(c)}`)}return o}predictLoop(i,o=32,u=!1){return m.tidy(()=>{let c=this.checkNumSamples(i);if(u)throw new Wi("Verbose predictLoop() is not implemented yet.");let f=bR(c,o),y=this.outputs.map(w=>[]);for(let w=0;w<f.length;++w)m.tidy(()=>{let C=f[w][0],T=f[w][1],x=W5(i,C,T),A=[];if(Array.isArray(x))for(let $=0;$<x.length;++$)A.push({key:this.inputs[$],value:x[$]});else A.push({key:this.inputs[0],value:x});let M=new Zh(A);return R5(this.outputs,M)}).forEach((C,T)=>y[T].push(C));return $u(y.map(w=>m.concat(w,0)))})}predict(i,o={}){let u=eH(i);kR(u,this.inputNames,this.feedInputShapes,!1);try{let c=o.batchSize==null?32:o.batchSize;return yR(c),this.predictLoop(u,c)}finally{h0(u,i)}}predictOnBatch(i){kR(i,this.inputNames,this.feedInputShapes,!0);let o=(Array.isArray(i)?i[0]:i).shape[0];return this.predictLoop(i,o)}standardizeUserDataXY(i,o,u=!0,c){if(this.optimizer_==null)throw new Gl("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");let f=[];for(let y=0;y<this.feedOutputShapes.length;++y){let w=this.feedOutputShapes[y];this.feedLossFns[y]===tE?f.push(w.slice(0,w.length-1).concat([1])):f.push(w)}if(function(y,w){let C=vn(y.map(x=>x.shape[0]));C.sort();let T=vn(w.map(x=>x.shape[0]));if(T.sort(),C.length>1)throw new yn(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(y.map(x=>x.shape))}`);if(T.length>1)throw new yn(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(w.map(x=>x.shape))}`);if(C.length>0&&T.length>0&&!m.util.arraysEqual(C,T))throw new yn(`Input Tensors should have the same number of samples as target Tensors. Found ${C[0]} input sample(s) and ${T[0]} target sample(s).`)}(i=xR(i,this.feedInputNames,this.feedInputShapes,!1,"input"),o=xR(o,this.feedOutputNames,f,!1,"target")),function(y,w,C){let T=[_v,eE,j5];for(let x=0;x<y.length;++x){let A=y[x],M=w[x],$=C[x];if(M!=null){if(M===j5&&A.shape[A.shape.length-1]===1)throw new yn(`You are passing a target array of shape ${A.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(T.indexOf(M)!==-1){let V=A.shape.slice(1),G=$.slice(1);for(let Q=0;Q<V.length;++Q){let nt=V[Q],it=G[Q];if(it!=null&&nt!==it)throw new yn(`A target Tensor with shape ${A.shape} was passed for an output of shape ${$}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}(o,this.feedLossFns,this.feedOutputShapes),this.stateful&&c!=null&&c>0&&i[0].shape[0]%c!=0)throw new yn(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${c}. Found: ${i[0].shape[0]} sample(s).`);return[i,o]}standardizeUserData(i,o,u,c,f=!0,y){return ce(this,null,function*(){let[w,C]=this.standardizeUserDataXY(i,o,f,y);if(u!=null)throw new Error("sample weight is not supported yet.");let T=null;if(c!=null){let x=ZG(c,this.outputNames);T=[];for(let A=0;A<x.length;++A)T.push(yield QG(C[A],null,x[A]))}return[w,C,T]})}testLoop(i,o,u,c=0,f){return m.tidy(()=>{let y=this.checkNumSamples(o,u,f,"steps"),w=[];if(c>0)throw new Wi("Verbose mode is not implemented yet.");if(f!=null)throw new Wi("steps mode in testLoop() is not implemented yet");{let C=bR(y,u),T=(0,m.tensor1d)(Ss(0,y));for(let x=0;x<C.length;++x){let A=C[x][0],M=C[x][1],$=vf(T,A,M-A),V=vR(o,$),G=i(V);if(x===0)for(let Q=0;Q<G.length;++Q)w.push((0,m.scalar)(0));for(let Q=0;Q<G.length;++Q){let nt=G[Q];w[Q]=m.add(w[Q],m.mul(M-A,nt))}}for(let x=0;x<w.length;++x)w[x]=m.div(w[x],y)}return w})}getDedupedMetricsNames(){let i=this.metricsNames,o=[];for(let u=0;u<i.length;++u){let c=i[u],f=c;wv(i,c)>1&&(f+=`_${wv(i.slice(0,u),c)}`),o.push(f)}return o}makeTrainFunction(){return i=>{let o=[],u=i.slice(0,this.inputs.length),c=i.slice(this.inputs.length,this.inputs.length+this.outputs.length),f=i.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),y=[],w=this.collectedTrainableWeights.map(C=>C.read());return[this.optimizer_.minimize(()=>{let C=[];for(let M=0;M<this.inputs.length;++M)C.push({key:this.inputs[M],value:u[M]});let T=new Zh(C),x=R5(this.outputs,T,{training:!0}),A;for(let M=0;M<this.lossFunctions.length;++M){let $=(0,this.lossFunctions[M])(c[M],x[M]);f[M]!=null&&($=Dlt($,f[M]));let V=m.mean($);o.push(V),A=M===0?$:m.add(A,$)}for(let M=0;M<this.metricsTensors.length;++M){let $;if(this.outputs.length>1&&M<this.outputs.length)$=o[M];else{let V=this.metricsTensors[M][0],G=this.metricsTensors[M][1];$=m.mean(V(c[G],x[G]))}m.keep($),y.push($)}return A=m.mean(A),this.calculateLosses().forEach(M=>{A=m.add(A,M)}),A},!0,w)].concat(y)}}makeTestFunction(){this.testFunction=i=>m.tidy(()=>{let o=[],u,c=i.slice(0,this.inputs.length),f=i.slice(this.inputs.length,this.inputs.length+this.outputs.length),y=[];for(let T=0;T<this.inputs.length;++T)y.push({key:this.inputs[T],value:c[T]});let w=new Zh(y),C=R5(this.outputs,w);for(let T=0;T<this.lossFunctions.length;++T){let x=this.lossFunctions[T],A=m.mean(x(f[T],C[T]));u=T===0?A:m.add(u,A),o.push(u)}for(let T=0;T<this.metricsTensors.length;++T){let x=this.metricsTensors[T][0],A=this.metricsTensors[T][1],M=m.mean(x(f[A],C[A]));o.push(M)}return o})}fit(c,f){return ce(this,arguments,function*(i,o,u={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");let y,w,C,T,x,A,M,$,V;this.isTraining=!0;try{let G=u.batchSize==null?32:u.batchSize;yR(G);let Q=!1,nt=yield this.standardizeUserData(i,o,u.sampleWeight,u.classWeight,Q,G);y=nt[0],w=nt[1],V=nt[2];let it,ht=!1;if(u.validationData!=null&&u.validationData.length>0){if(ht=!0,u.validationData.length!==2)throw u.validationData.length===3?new Wi("validationData including sample weights is not supported yet."):new yn(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${u.validationData} is invalid.`);x=u.validationData[0],A=u.validationData[1];let ue=!0,be=yield this.standardizeUserData(x,A,null,null,ue,G);M=be[0],$=be[1],it=M.concat($)}else if(u.validationSplit!=null&&u.validationSplit>0&&u.validationSplit<1){ht=!0;let ue=Math.floor(y[0].shape[0]*(1-u.validationSplit)),be=y[0].shape[0];M=W5(y,ue,be),C=y,y=W5(y,0,ue),$=W5(w,ue,be),T=w,w=W5(w,0,ue),it=M.concat($)}else u.validationSteps!=null&&(ht=!0);let kt=y.concat(w).concat(V);this.checkTrainableWeightsConsistency();let Nt=this.makeTrainFunction(),$t=this.getDedupedMetricsNames(),Ut,Pt;ht?(this.makeTestFunction(),Ut=this.testFunction,Pt=$t.slice().concat($t.map(ue=>"val_"+ue))):(Ut=null,it=[],Pt=$t.slice());let re=BG(u.callbacks,u.yieldEvery);return yield this.fitLoop(Nt,kt,$t,G,u.epochs,u.verbose,re,Ut,it,u.shuffle,Pt,u.initialEpoch,null,null)}finally{this.isTraining=!1,h0(y,i),h0(w,o),h0(C,i),h0(T,o),h0(M,x),h0($,A),V!=null&&m.dispose(V)}})}fitLoop(i,o,u,c,f,y,w,C,T,x,A,M,$,V){return ce(this,null,function*(){c==null&&(c=32),f==null&&(f=1),x==null&&(x=!0),M==null&&(M=0);let G=!1;if(C!=null&&T!=null&&(G=!0),V!=null&&(G=!0,$==null))throw new yn("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let Q=this.checkNumSamples(o,c,$,"steps_per_epoch"),nt;Q!=null&&(nt=Ss(0,Q)),y==null&&(y=1);let{callbackList:it,history:ht}=lR(w,y,f,M,Q,$,c,G,A);it.setModel(this),this.history=ht,yield it.onTrainBegin(),this.stopTraining_=!1;for(let kt=M;kt<f;++kt){yield it.onEpochBegin(kt);let Nt={};if($!=null)throw new Wi("stepsPerEpoch mode is not implemented yet.");{if(x==="batch")throw new Wi("batch shuffling is not implemneted yet");x&&m.util.shuffle(nt);let $t=(0,m.tensor1d)(nt),Ut=bR(Q,c);for(let Pt=0;Pt<Ut.length;++Pt){let re={};if(yield it.onBatchBegin(Pt,re),m.tidy(()=>{let ue=Ut[Pt][0],be=Ut[Pt][1],De=vf($t,ue,be-ue);re.batch=Pt,re.size=be-ue;let ze=vR(o,De),Qe=i(ze);for(let cn=0;cn<u.length;++cn){let en=u[cn],sn=Qe[cn];re[en]=sn,m.keep(sn)}if(Pt===Ut.length-1&&G){let cn=this.testLoop(C,T,c);for(let en=0;en<u.length;++en){let sn=u[en],xn=cn[en];m.keep(xn),Nt["val_"+sn]=xn}}}),yield it.onBatchEnd(Pt,re),Oo(re),this.stopTraining_)break}$t.dispose()}if(yield it.onEpochEnd(kt,Nt),this.stopTraining_)break}return yield it.onTrainEnd(),yield this.history.syncData(),this.history})}fitDataset(i,o){return ce(this,null,function*(){return Rlt(this,i,o)})}trainOnBatch(i,o){return ce(this,null,function*(){let u=yield this.standardizeUserData(i,o),c=u[0],f=u[1],y=this.makeTrainFunction()(c.concat(f)),w=[];for(let C of y){let T=yield C.data();w.push(T[0])}return m.dispose(y),h0(u[0],i),h0(u[1],o),$u(w)})}getNamedWeights(i){let o=[],u=i!=null&&i.trainableOnly,c=u?this.trainableWeights:this.weights,f=this.getWeights(u);for(let y=0;y<c.length;++y)u&&!c[y].trainable||o.push({name:c[y].originalName,tensor:f[y]});return o}set stopTraining(i){this.stopTraining_=i}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(i){this.optimizer_!==i&&(this.optimizer_=i,this.isOptimizerOwned=!1)}dispose(){let i=super.dispose();if(i.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){let o=m.memory().numTensors;this.optimizer_.dispose(),i.numDisposedVariables+=o-m.memory().numTensors}return i}getLossIdentifiers(){let i;if(typeof this.loss=="string")i=Xh(this.loss);else if(Array.isArray(this.loss)){for(let o of this.loss)if(typeof o!="string")throw new Error("Serialization of non-string loss is not supported.");i=this.loss.map(o=>Xh(o))}else{let o=Object.keys(this.loss);i={};let u=this.loss;for(let c of o){if(typeof u[c]!="string")throw new Error("Serialization of non-string loss is not supported.");i[c]=Xh(u[c])}}return i}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Xh(U5(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(i=>Xh(U5(i)));{let i={};for(let o in this.metrics)i[o]=Xh(U5(this.metrics[o]));return i}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(i){if(i.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(i.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(i.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");let o=l0(Ew(i.optimizer_config)),u,c;if(typeof i.loss=="string")u=oe(i.loss);else if(Array.isArray(i.loss))u=i.loss.map(f=>oe(f));else if(i.loss!=null){u={};for(let f in i.loss)u[f]=oe(i.loss[f])}if(Array.isArray(i.metrics))c=i.metrics.map(f=>oe(f));else if(i.metrics!=null){c={};for(let f in i.metrics)c[f]=oe(i.metrics[f])}this.compile({loss:u,metrics:c,optimizer:o})}save(i,o){return ce(this,null,function*(){if(typeof i=="string"){let f=m.io.getSaveHandlers(i);if(f.length===0)throw new yn(`Cannot find any save handlers for URL '${i}'`);if(f.length>1)throw new yn(`Found more than one (${f.length}) save handlers for URL '${i}'`);i=f[0]}if(i.save==null)throw new yn("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let u=yield m.io.encodeWeights(this.getNamedWeights(o)),c={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:`TensorFlow.js tfjs-layers v${oE}`,convertedBy:null};if(o!=null&&o.includeOptimizer&&this.optimizer!=null){c.trainingConfig=this.getTrainingConfig();let f="optimizer",{data:y,specs:w}=yield m.io.encodeWeights(yield this.optimizer.getWeights(),f);u.specs.push(...w),u.data=m.io.concatenateArrayBuffers([u.data,y])}return this.userDefinedMetadata!=null&&(qG(this.userDefinedMetadata,this.name,!0),c.userDefinedMetadata=this.userDefinedMetadata),c.weightData=u.data,c.weightSpecs=u.specs,i.save(c)})}setUserDefinedMetadata(i){qG(i,this.name),this.userDefinedMetadata=i}getUserDefinedMetadata(){return this.userDefinedMetadata}}fm.className="Model",m.serialization.registerClass(fm);class Tw extends fm{}function rH(l,i){return ce(this,null,function*(){"modelTopology"in l||(l={modelTopology:l});let o=l.modelTopology;o.model_config!=null&&(o=o.model_config);let u=l0(Ew(o),i);if(l.weightsManifest!=null){let c=yield m.io.loadWeights(l.weightsManifest,l.pathPrefix,u.weights.map(y=>y.originalName)),f={};for(let y of u.weights)f[y.originalName]=c[y.originalName];u.loadWeights(f),(0,m.dispose)(c)}return u})}function Dd(l,i){return ce(this,null,function*(){if(i==null&&(i={}),typeof l=="string"){let o=m.io.getLoadHandlers(l,i);if(o.length===0)o.push(m.io.browserHTTPRequest(l,i));else if(o.length>1)throw new yn(`Found more than one (${o.length}) load handlers for URL '${l}'`);l=o[0]}return function(o,u,c){return ce(this,null,function*(){if(c==null&&(c={}),o.load==null)throw new yn("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let f=yield o.load(),y=f.modelTopology;y.model_config!=null&&(y=y.model_config);let w=c.strict==null||c.strict,C=f.weightData!=null&&f.weightSpecs!=null&&w,T=l0(Ew(y),u,C),x=f.trainingConfig;if(x!=null&&T.loadTrainingConfig(x),f.userDefinedMetadata!=null&&T.setUserDefinedMetadata(f.userDefinedMetadata),f.weightData!=null){if(f.weightSpecs==null)throw new yn("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");let{modelWeights:A,optimizerWeights:M}=function($,V){let G=m.io.decodeWeights($,V),Q={},nt=[];return V.forEach(it=>{it.group==="optimizer"?nt.push({name:it.name,tensor:G[it.name]}):Q[it.name]=G[it.name]}),{modelWeights:Q,optimizerWeights:nt}}(f.weightData,f.weightSpecs);T.loadWeights(A,w),T.optimizer!=null&&M.length>0&&(yield T.optimizer.setWeights(M)),(0,m.dispose)(A),(0,m.dispose)(M.map($=>$.tensor))}return T})}(l,void 0,i)})}Tw.className="Functional",m.serialization.registerClass(Tw);class Ig extends fm{constructor(i){if(super({inputs:[],outputs:[]}),i=i||{},this.trainable=!0,this.built=!1,this.name=i.name!=null?i.name:Ps("sequential_"),i.layers!=null)for(let o of i.layers)this.add(o)}checkShape(i){if(i.inboundNodes[0].outputTensors[0].shape.some(o=>o<0))throw new yn(`Negative dimension size caused by adding layer ${i.name} with input shape [${i.inboundNodes[0].inputTensors[0].shape}]`)}add(i){let o=i instanceof Ig||i instanceof fm,u;if(o){if(u=i,u.outputs.length!==1)throw new yn("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(u.inputs.length!==1)throw new yn("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(i.inboundNodes.length===0){if(i.batchInputShape==null)throw new yn("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let c=ap({batchShape:i.batchInputShape,dtype:i.dtype,name:i.name+"_input"});i.apply(c)}if(o)this.outputs=u.outputs,this.inputs=u.inputs;else{if(i.inboundNodes.length!==1)throw new yn(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${i.name} which has ${i.inboundNodes.length} pre-existing inbound connections.`);if(i.inboundNodes[0].outputTensors.length!==1)throw new yn("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(i),this.outputs=[i.inboundNodes[0].outputTensors[0]],this.inputs=Id(this.outputs[0])}this.inboundNodes=[],new js({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:i0(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(c=>c.shape),outputShapes:this.outputs[0].shape})}else{let c=i.apply(this.outputs[0]);if(Array.isArray(c))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(i),this.outputs=[c],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(i),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let i=this.layers.length-1;this.layers[i].outboundNodes=[],this.outputs=[this.layers[i].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(i,o){return this.model==null&&this.build(),this.model.call(i,o)}build(i){if(Vi(i),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new fm({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(i,o,u=console.log){this.built||this.build(),super.summary(i,o,u)}setWeights(i){this.model==null&&this.build(),this.model.setWeights(i)}evaluate(i,o,u={}){if(!this.built)throw new Gl("The model needs to be compiled before being used.");return this.model.evaluate(i,o,u)}evaluateDataset(i,o){return ce(this,null,function*(){if(!this.built)throw new Gl("The model needs to be compiled before being used.");return this.model.evaluateDataset(i,o)})}predict(i,o={}){return this.model==null&&this.build(),this.model.predict(i,o)}predictOnBatch(i){return this.model==null&&this.build(),this.model.predictOnBatch(i)}compile(i){this.build(),this.model.compile(i),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(i){this.model.optimizer=i}fit(c,f){return ce(this,arguments,function*(i,o,u={}){if(!this.built)throw new Gl("The model needs to be compiled before being used.");return this.model.fit(i,o,u)})}fitDataset(i,o){return ce(this,null,function*(){if(!this.built)throw new Gl("The model needs to be compiled before being used.");return this.model.fitDataset(i,o)})}trainOnBatch(i,o){return ce(this,null,function*(){return this.model.trainOnBatch(i,o)})}static fromConfig(i,o,u={},c=!1){let f,y={};if(o instanceof Array){if(o[0].className==null||o[0].className==="Merge")throw new yn("Legacy serialization format not supported yet.");f=o}else m.util.assert(o.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),f=o.layers,delete o.layers,y=o;let w=new i(y);if(!(w instanceof Ig))throw new Wi(`Sequential.fromConfig called on non-Sequential input: ${w}`);for(let C of f){let T=l0(C,void 0,c);c&&T.setFastWeightInitDuringBuild(!0),w.add(T)}return w}set stopTraining(i){if(this.model==null)throw new yn("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=i}get stopTraining(){if(this.model==null)throw new yn("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let i=[];for(let o of this.layers){let u={};u.className=o.getClassName(),u.config=o.getConfig(),i.push(u)}return{name:this.name,layers:i}}}function SR(l){return new fm(l)}function sE(l){return new Ig(l)}function uE(l){return ap(l)}function iH(l,i){Md.registerCallbackConstructor(l,i)}Ig.className="Sequential",m.serialization.registerClass(Ig);class hc extends m.serialization.Serializable{getConfig(){return{}}}class aH extends hc{apply(i,o=1){return function(u,c=1){if(c!==1)throw new Wi(`Support for alpha values other than 1 (${c}) is not implemented yet.`);return m.elu(u)}(i,o)}}aH.className="elu",m.serialization.registerClass(aH);class _R extends hc{apply(i){return m.selu(i)}}_R.className="selu",m.serialization.registerClass(_R);class V5 extends hc{apply(i){return m.relu(i)}}V5.className="relu",m.serialization.registerClass(V5);class lE extends hc{apply(i){return(0,m.tidy)(()=>m.minimum(6,m.relu(i)))}}lE.className="relu6",m.serialization.registerClass(lE);class oH extends hc{apply(i){return i}}oH.className="linear",m.serialization.registerClass(oH);class sH extends hc{apply(i){return m.sigmoid(i)}}sH.className="sigmoid",m.serialization.registerClass(sH);class uH extends hc{apply(i){return function(o){return(0,m.tidy)(()=>{let u=m.add(.5,m.mul(.2,o));return m.clipByValue(u,0,1)})}(i)}}uH.className="hardSigmoid",m.serialization.registerClass(uH);class lH extends hc{apply(i){return m.softplus(i)}}lH.className="softplus",m.serialization.registerClass(lH);class cH extends hc{apply(i){return function(o){return(0,m.tidy)(()=>m.div(o,m.add(m.abs(o),1)))}(i)}}cH.className="softsign",m.serialization.registerClass(cH);class hH extends hc{apply(i){return m.tanh(i)}}hH.className="tanh",m.serialization.registerClass(hH);class CR extends hc{apply(i,o=-1){return m.softmax(i,o)}}CR.className="softmax",m.serialization.registerClass(CR);class dH extends hc{apply(i,o=-1){return m.logSoftmax(i,o)}}dH.className="logSoftmax",m.serialization.registerClass(dH);class fH extends hc{apply(i){return(0,m.tidy)(()=>m.tidy(()=>{let o=Math.sqrt(2),u=m.mul(.5,m.add(1,m.erf(m.div(i,o))));return m.mul(i,u)}))}}fH.className="gelu",m.serialization.registerClass(fH);class pH extends hc{apply(i){return(0,m.tidy)(()=>m.mul(.5,m.mul(i,m.add(1,m.tanh(m.mul(m.sqrt(m.div(2,Math.PI)),m.add(i,m.mul(.044715,m.pow(i,3)))))))))}}pH.className="gelu_new",m.serialization.registerClass(pH);class mH extends hc{apply(i){return(0,m.tidy)(()=>m.mul(i,m.tanh(m.softplus(i))))}}mH.className="mish",m.serialization.registerClass(mH);class ER extends hc{apply(i,o=1){return(0,m.tidy)(()=>m.mul(m.sigmoid(m.mul(i,o)),i))}}function Ng(l){return l.getClassName()}function Aw(l,i={}){return Oe(l,m.serialization.SerializationMap.getMap().classNameMap,i,"activation")}function f2(l){if(l==null)return Aw({className:"linear",config:{}});if(typeof l=="string"){let i={};return i.className=l,i.config={},Aw(i)}return l instanceof hc?l:Aw(l)}function TR(l){if(l!=null&&typeof l!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${l}`)}ER.className="swish",m.serialization.registerClass(ER);class AR extends m.serialization.Serializable{}class Cv extends AR{constructor(i){super(),TR(i),this.l1=i==null||i.l1==null?.01:i.l1,this.l2=i==null||i.l2==null?.01:i.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(i){return(0,m.tidy)(()=>{let o=(0,m.zeros)([1]);return this.hasL1&&(o=(0,m.add)(o,(0,m.sum)(m.mul(this.l1,(0,m.abs)(i))))),this.hasL2&&(o=(0,m.add)(o,(0,m.sum)(m.mul(this.l2,ip(i))))),m.reshape(o,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(i,o){return new i({l1:o.l1,l2:o.l2})}}Cv.className="L1L2",m.serialization.registerClass(Cv);let cE={l1l2:"L1L2"};function Rs(l){return ne(l)}function IR(l,i={}){return Oe(l,m.serialization.SerializationMap.getMap().classNameMap,i,"regularizer")}function Us(l){return l==null?null:typeof l=="string"?IR({className:l in cE?cE[l]:l,config:{}}):l instanceof AR?l:IR(l)}class hE extends Hi{constructor(i){super(i??{}),this.supportsMasking=!0,i!=null&&(this.maxValue=i.maxValue)}call(i,o){i=Vr(i);let u=(0,m.relu)(i);return this.maxValue!=null&&(u=(0,m.clipByValue)(u,0,this.maxValue)),u}computeOutputShape(i){return i}getConfig(){let i={maxValue:this.maxValue},o=super.getConfig();return Object.assign(i,o),i}}hE.className="ReLU",m.serialization.registerClass(hE);class NR extends Hi{constructor(i){super(i??{}),this.DEFAULT_ALPHA=.3,i==null&&(i={}),this.alpha=i.alpha==null?this.DEFAULT_ALPHA:i.alpha}call(i,o){let u=Vr(i);return(0,m.leakyRelu)(u,this.alpha)}computeOutputShape(i){return i}getConfig(){let i={alpha:this.alpha},o=super.getConfig();return Object.assign(i,o),i}}NR.className="LeakyReLU",m.serialization.registerClass(NR);class MR extends Hi{constructor(i){if(super(i??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",i==null&&(i={}),this.supportsMasking=!0,this.alphaInitializer=ci(i.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Us(i.alphaRegularizer),this.alphaConstraint=Su(i.alphaConstraint),i.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(i.sharedAxes))this.sharedAxes=i.sharedAxes;else{if(typeof i.sharedAxes!="number")throw new yn(`Expected sharedAxes to be a number or an array of numbers, but got ${i.sharedAxes}`);this.sharedAxes=[i.sharedAxes]}}build(i){let o=(i=Vi(i)).slice(1);if(this.sharedAxes!=null)for(let c of this.sharedAxes)o[c-1]=1;this.alpha=this.addWeight("alpha",o,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let u={};if(this.sharedAxes!=null)for(let c=1;c<i.length;++c)u[c]=i[c];this.inputSpec=[new La({ndim:i.length,axes:u})],this.built=!0}call(i,o){return i=Vr(i),(0,m.prelu)(i,this.alpha.read())}getConfig(){let i={alphaInitializer:Pr(this.alphaInitializer),alphaRegularizer:Rs(this.alphaRegularizer),alphaConstraint:el(this.alphaConstraint),sharedAxes:this.sharedAxes},o=super.getConfig();return Object.assign(i,o),i}}MR.className="PReLU",m.serialization.registerClass(MR);class G5 extends Hi{constructor(i){if(super(i??{}),this.DEFAULT_ALPHA=1,i==null&&(i={}),i.alpha!=null&&i.alpha!==this.DEFAULT_ALPHA)throw new Wi(`Non-default alpha value (${i.alpha}) is not supported by the ELU layer yet.`);this.alpha=i.alpha==null?this.DEFAULT_ALPHA:i.alpha}call(i,o){let u=Vr(i);return(0,m.elu)(u)}computeOutputShape(i){return i}getConfig(){let i={alpha:this.alpha},o=super.getConfig();return Object.assign(i,o),i}}G5.className="ELU",m.serialization.registerClass(G5);class Iw extends Hi{constructor(i){super(i??{}),this.DEFAULT_THETA=1,i==null&&(i={}),this.theta=i.theta==null?this.DEFAULT_THETA:i.theta}call(i,o){let u=Vr(i);return(0,m.mul)(u,(0,m.cast)((0,m.greater)(u,this.theta),"float32"))}computeOutputShape(i){return i}getConfig(){let i={theta:this.theta},o=super.getConfig();return Object.assign(i,o),i}}Iw.className="ThresholdedReLU",m.serialization.registerClass(Iw);class Nw extends Hi{constructor(i){super(i??{}),this.DEFAULT_AXIS=1,i==null&&(i={}),this.softmax=new CR().apply,this.axis=i.axis==null?this.DEFAULT_AXIS:i.axis}call(i,o){return(0,m.tidy)(()=>{let u=Vr(i),c=o.mask;if(c!=null){let f=(0,m.mul)((0,m.sub)((0,m.ones)(u.shape),(0,m.cast)(c,u.dtype)),(0,m.scalar)(-1e9));u=(0,m.add)(u,f)}return this.axis instanceof Array?this.axis.length>1?(0,m.exp)((0,m.sub)(u,(0,m.logSumExp)(u,this.axis,!0))):this.softmax(u,this.axis[0]):this.softmax(u,this.axis)})}computeOutputShape(i){return i}getConfig(){let i={axis:this.axis},o=super.getConfig();return Object.assign(i,o),i}}function Ev(l,i,o){if(typeof l=="number")return i0(l,i);if(l.length!==i)throw new yn(`The ${o} argument must be an integer or tuple of ${i} integers. Received: ${l.length} elements.`);for(let c=0;c<i;++c){let f=l[c];if((u=f)!==parseInt(u.toString(),10))throw new yn(`The ${o} argument must be an integer or tuple of ${i} integers. Received: ${JSON.stringify(l)} including a non-integer number ${f}`)}return l;var u}function d0(l,i,o,u,c=1){if(l==null)return l;let f;return f=o==="same"?l:l-(i+(i-1)*(c-1))+1,Math.floor((f+u-1)/u)}function Qh(l,i,o,u){if(l==null)return null;if(u==="valid")l=l*i+Ds([o-i,0]);else{if(u!=="same")throw new yn(`Unsupport padding mode: ${u}.`);l*=i}return l}function qi(l,i){return(0,m.tidy)(()=>(hu(i),i==="channelsFirst"?m.transpose(l,[0,2,3,1]):l))}function DR(l,i){return(0,m.tidy)(()=>(hu(i),i==="channelsFirst"?m.transpose(l,[0,2,3,4,1]):l))}function Jo(l,i,o,u=1,c="valid",f,y=1){return(0,m.tidy)(()=>{if(f==null&&(f="channelsLast"),hu(f),l.shape.length!==3)throw new yn(`The input of a conv1dWithBias operation should be 3, but is ${l.shape.length} instead.`);if(i.shape.length!==3)throw new yn(`The kernel for a conv1dWithBias operation should be 3, but is ${i.shape.length} instead`);if(o!=null&&o.shape.length!==1)throw new yn(`The bias for a conv1dWithBias operation should be 1, but is ${o.shape.length} instead`);if(f==="channelsFirst"&&(l=m.transpose(l,[0,2,1])),c==="causal")throw new Wi("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let w=m.conv1d(l,i,u,c==="same"?"same":"valid","NWC",y);return o!=null&&(w=lc(w,o)),w})}function dE(l,i,o,u=[1,1],c="valid",f,y,w=null){return(0,m.tidy)(()=>{if(f==null&&(f="channelsLast"),hu(f),l.rank!==3&&l.rank!==4)throw new yn(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${l.rank}.`);if(i.rank!==3&&i.rank!==4)throw new yn(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${l.rank}.`);let C=qi(l,f);if(c==="causal")throw new Wi("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return C=m.fused.conv2d({x:C,filter:i,strides:u,pad:c==="same"?"same":"valid",dilations:y,dataFormat:"NHWC",bias:o,activation:w}),f==="channelsFirst"&&(C=m.transpose(C,[0,3,1,2])),C})}function fE(l,i,o,u=[1,1,1],c="valid",f,y){return(0,m.tidy)(()=>{if(f==null&&(f="channelsLast"),hu(f),l.rank!==4&&l.rank!==5)throw new yn(`conv3dWithBias expects input to be of rank 4 or 5, but received ${l.rank}.`);if(i.rank!==4&&i.rank!==5)throw new yn(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${l.rank}.`);let w=DR(l,f);if(c==="causal")throw new Wi("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return w=m.conv3d(w,i,u,c==="same"?"same":"valid","NDHWC",y),o!=null&&(w=lc(w,o)),f==="channelsFirst"&&(w=m.transpose(w,[0,4,1,2,3])),w})}Nw.className="Softmax",m.serialization.registerClass(Nw);class H5 extends Hi{constructor(i,o){if(super(o),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",H5.verifyArgs(o),this.rank=i,qr(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Wi(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Ev(o.kernelSize,i,"kernelSize"),this.strides=Ev(o.strides==null?1:o.strides,i,"strides"),this.padding=o.padding==null?"valid":o.padding,Bc(this.padding),this.dataFormat=o.dataFormat==null?"channelsLast":o.dataFormat,hu(this.dataFormat),this.activation=f2(o.activation),this.useBias=o.useBias==null||o.useBias,this.biasInitializer=ci(o.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Su(o.biasConstraint),this.biasRegularizer=Us(o.biasRegularizer),this.activityRegularizer=Us(o.activityRegularizer),this.dilationRate=Ev(o.dilationRate==null?1:o.dilationRate,i,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new yn(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new yn(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new yn(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(i){if(qh("kernelSize"in i,"required key 'kernelSize' not in config"),typeof i.kernelSize!="number"&&!Yr(i.kernelSize,"number",1,3))throw new yn(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(i.kernelSize)}.`)}getConfig(){let i={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Ng(this.activation),useBias:this.useBias,biasInitializer:Pr(this.biasInitializer),biasRegularizer:Rs(this.biasRegularizer),activityRegularizer:Rs(this.activityRegularizer),biasConstraint:el(this.biasConstraint)},o=super.getConfig();return Object.assign(i,o),i}}class op extends H5{constructor(i,o){super(i,o),this.kernel=null,op.verifyArgs(o),this.filters=o.filters,qr(this.filters,"filters"),this.kernelInitializer=ci(o.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Su(o.kernelConstraint),this.kernelRegularizer=Us(o.kernelRegularizer)}build(i){i=Vi(i);let o=this.dataFormat==="channelsFirst"?1:i.length-1;if(i[o]==null)throw new yn(`The channel dimension of the input should be defined. Found ${i[o]}`);let u=i[o],c=this.kernelSize.concat([u,this.filters]);this.kernel=this.addWeight("kernel",c,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[o]:u}}],this.built=!0}call(i,o){return(0,m.tidy)(()=>{let u;i=Vr(i);let c=this.bias==null?null:this.bias.read(),f=ma(this.activation.getClassName());if(f!=null&&this.rank===2)u=dE(i,this.kernel.read(),c,this.strides,this.padding,this.dataFormat,this.dilationRate,f);else{if(this.rank===1)u=Jo(i,this.kernel.read(),c,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)u=dE(i,this.kernel.read(),c,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(this.rank!==3)throw new Wi("convolutions greater than 3D are not implemented yet.");u=fE(i,this.kernel.read(),c,this.strides,this.padding,this.dataFormat,this.dilationRate)}this.activation!=null&&(u=this.activation.apply(u))}return u})}computeOutputShape(i){i=Vi(i);let o=[],u=this.dataFormat==="channelsLast"?i.slice(1,i.length-1):i.slice(2);for(let f=0;f<u.length;++f){let y=d0(u[f],this.kernelSize[f],this.padding,this.strides[f],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[f]);o.push(y)}let c=[i[0]];return this.dataFormat==="channelsLast"?(c=c.concat(o),c.push(this.filters)):(c.push(this.filters),c=c.concat(o)),c}getConfig(){let i={filters:this.filters,kernelInitializer:Pr(this.kernelInitializer),kernelRegularizer:Rs(this.kernelRegularizer),kernelConstraint:el(this.kernelConstraint)},o=super.getConfig();return Object.assign(i,o),i}static verifyArgs(i){if(!("filters"in i)||typeof i.filters!="number"||i.filters<1)throw new yn(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(i.filters)}`)}}class Tv extends op{constructor(i){super(2,i),Tv.verifyArgs(i)}getConfig(){let i=super.getConfig();return delete i.rank,i}static verifyArgs(i){if(typeof i.kernelSize!="number"&&!Yr(i.kernelSize,"number",1,2))throw new yn(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(i.kernelSize)}.`)}}Tv.className="Conv2D",m.serialization.registerClass(Tv);class sp extends op{constructor(i){super(3,i),sp.verifyArgs(i)}getConfig(){let i=super.getConfig();return delete i.rank,i}static verifyArgs(i){if(typeof i.kernelSize!="number"&&(!Array.isArray(i.kernelSize)||i.kernelSize.length!==1&&i.kernelSize.length!==3))throw new yn(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(i.kernelSize)}.`)}}sp.className="Conv3D",m.serialization.registerClass(sp);class Mw extends Tv{constructor(i){if(super(i),this.inputSpec=[new La({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new yn(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(i){if((i=Vi(i)).length!==4)throw new yn("Input should have rank 4; Received input shape: "+JSON.stringify(i));let o=this.dataFormat==="channelsFirst"?1:i.length-1;if(i[o]==null)throw new yn("The channel dimension of the inputs should be defined. Found `None`.");let u=i[o],c=this.kernelSize.concat([this.filters,u]);this.kernel=this.addWeight("kernel",c,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new La({ndim:4,axes:{[o]:u}})],this.built=!0}call(i,o){return m.tidy(()=>{let u=Vr(i);if(u.shape.length!==4)throw new yn(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${u.shape.length}`);let c=u.shape,f=c[0],y,w;this.dataFormat==="channelsFirst"?(y=2,w=3):(y=1,w=2);let C=c[y],T=c[w],x=this.kernelSize[0],A=this.kernelSize[1],M=this.strides[0],$=this.strides[1],V=[f,Qh(C,M,x,this.padding),Qh(T,$,A,this.padding),this.filters];this.dataFormat!=="channelsLast"&&(u=m.transpose(u,[0,2,3,1]));let G=m.conv2dTranspose(u,this.kernel.read(),V,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(G=m.transpose(G,[0,3,1,2])),this.bias!=null&&(G=lc(G,this.bias.read(),this.dataFormat)),this.activation!=null&&(G=this.activation.apply(G)),G})}computeOutputShape(i){let o=(i=Vi(i)).slice(),u,c,f;this.dataFormat==="channelsFirst"?(u=1,c=2,f=3):(u=3,c=1,f=2);let y=this.kernelSize[0],w=this.kernelSize[1],C=this.strides[0],T=this.strides[1];return o[u]=this.filters,o[c]=Qh(o[c],C,y,this.padding),o[f]=Qh(o[f],T,w,this.padding),o}getConfig(){let i=super.getConfig();return delete i.dilationRate,i}}Mw.className="Conv2DTranspose",m.serialization.registerClass(Mw);class Dw extends sp{constructor(i){if(super(i),this.inputSpec=[new La({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new yn(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(i){if((i=Vi(i)).length!==5)throw new yn("Input should have rank 5; Received input shape: "+JSON.stringify(i));let o=this.dataFormat==="channelsFirst"?1:i.length-1;if(i[o]==null)throw new yn("The channel dimension of the inputs should be defined. Found `None`.");let u=i[o],c=this.kernelSize.concat([this.filters,u]);this.kernel=this.addWeight("kernel",c,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new La({ndim:5,axes:{[o]:u}})],this.built=!0}call(i,o){return m.tidy(()=>{let u=Vr(i);if(u.shape.length!==5)throw new yn(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${u.shape.length}`);let c=u.shape,f=c[0],y,w,C;this.dataFormat==="channelsFirst"?(C=2,y=3,w=4):(C=1,y=2,w=3);let T=c[C],x=c[y],A=c[w],M=this.kernelSize[0],$=this.kernelSize[1],V=this.kernelSize[2],G=this.strides[0],Q=this.strides[1],nt=this.strides[2],it=[f,Qh(T,G,M,this.padding),Qh(x,Q,$,this.padding),Qh(A,nt,V,this.padding),this.filters];this.dataFormat!=="channelsLast"&&(u=m.transpose(u,[0,2,3,4,1]));let ht=m.conv3dTranspose(u,this.kernel.read(),it,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(ht=m.transpose(ht,[0,4,1,2,3])),this.bias!==null&&(ht=lc(ht,this.bias.read(),this.dataFormat)),this.activation!==null&&(ht=this.activation.apply(ht)),ht})}computeOutputShape(i){let o=(i=Vi(i)).slice(),u,c,f,y;this.dataFormat==="channelsFirst"?(u=1,c=2,f=3,y=4):(u=4,c=1,f=2,y=3);let w=this.kernelSize[0],C=this.kernelSize[1],T=this.kernelSize[2],x=this.strides[0],A=this.strides[1],M=this.strides[2];return o[u]=this.filters,o[c]=Qh(o[c],x,w,this.padding),o[f]=Qh(o[f],A,C,this.padding),o[y]=Qh(o[y],M,T,this.padding),o}getConfig(){let i=super.getConfig();return delete i.dilationRate,i}}Dw.className="Conv3DTranspose",m.serialization.registerClass(Dw);let Flt=(()=>{class l extends op{constructor(o,u){if(super(o,u),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,u.filters==null)throw new yn("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(u.kernelInitializer!=null||u.kernelRegularizer!=null||u.kernelConstraint!=null)throw new yn("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(u.padding!=null&&u.padding!=="same"&&u.padding!=="valid")throw new yn(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(u.padding)}`);this.depthMultiplier=u.depthMultiplier==null?1:u.depthMultiplier,this.depthwiseInitializer=ci(u.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Us(u.depthwiseRegularizer),this.depthwiseConstraint=Su(u.depthwiseConstraint),this.pointwiseInitializer=ci(u.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Us(u.pointwiseRegularizer),this.pointwiseConstraint=Su(u.pointwiseConstraint)}build(o){if((o=Vi(o)).length<this.rank+2)throw new yn(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(o)}`);let u=this.dataFormat==="channelsFirst"?1:o.length-1;if(o[u]==null||o[u]<0)throw new yn(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(o[u])}`);let c=o[u],f=this.kernelSize.concat([c,this.depthMultiplier]),y=[];for(let C=0;C<this.rank;++C)y.push(1);y.push(c*this.depthMultiplier,this.filters);let w=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",f,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,w,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",y,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,w,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,w,this.biasConstraint):this.bias=null,this.inputSpec=[new La({ndim:this.rank+2,axes:{[u]:c}})],this.built=!0}call(o,u){return(0,m.tidy)(()=>{let c;if(o=Vr(o),this.rank===1)throw new Wi("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(o=m.transpose(o,[0,2,3,1])),c=m.separableConv2d(o,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(c=lc(c,this.bias.read(),this.dataFormat)),this.activation!=null&&(c=this.activation.apply(c)),this.dataFormat==="channelsFirst"&&(c=m.transpose(c,[0,3,1,2])),c})}getConfig(){let o=super.getConfig();return delete o.rank,delete o.kernelInitializer,delete o.kernelRegularizer,delete o.kernelConstraint,o.depthwiseInitializer=Pr(this.depthwiseInitializer),o.pointwiseInitializer=Pr(this.pointwiseInitializer),o.depthwiseRegularizer=Rs(this.depthwiseRegularizer),o.pointwiseRegularizer=Rs(this.pointwiseRegularizer),o.depthwiseConstraint=el(this.depthwiseConstraint),o.pointwiseConstraint=el(this.pointwiseConstraint),o}}return l.className="SeparableConv",l})();class RR extends Flt{constructor(i){super(2,i)}}RR.className="SeparableConv2D",m.serialization.registerClass(RR);class ts extends op{constructor(i){super(1,i),ts.verifyArgs(i),this.inputSpec=[{ndim:3}]}getConfig(){let i=super.getConfig();return delete i.rank,delete i.dataFormat,i}static verifyArgs(i){if(typeof i.kernelSize!="number"&&!Yr(i.kernelSize,"number",1,1))throw new yn(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(i.kernelSize)}.`)}}ts.className="Conv1D",m.serialization.registerClass(ts);class pE extends Hi{constructor(i){super(i),typeof i.cropping=="number"?this.cropping=[[i.cropping,i.cropping],[i.cropping,i.cropping]]:typeof i.cropping[0]=="number"?this.cropping=[[i.cropping[0],i.cropping[0]],[i.cropping[1],i.cropping[1]]]:this.cropping=i.cropping,this.dataFormat=i.dataFormat===void 0?"channelsLast":i.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(i){return this.dataFormat==="channelsFirst"?[i[0],i[1],i[2]-this.cropping[0][0]-this.cropping[0][1],i[3]-this.cropping[1][0]-this.cropping[1][1]]:[i[0],i[1]-this.cropping[0][0]-this.cropping[0][1],i[2]-this.cropping[1][0]-this.cropping[1][1],i[3]]}call(i,o){return(0,m.tidy)(()=>{if(i=Vr(i),this.dataFormat==="channelsLast"){let u=Td(i,this.cropping[0][0],i.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Td(u,this.cropping[1][0],i.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{let u=Td(i,this.cropping[0][0],i.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Td(u,this.cropping[1][0],i.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){let i={cropping:this.cropping,dataFormat:this.dataFormat},o=super.getConfig();return Object.assign(i,o),i}}pE.className="Cropping2D",m.serialization.registerClass(pE);class FR extends Hi{constructor(i){var o;super(i),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=i.size==null?this.DEFAULT_SIZE:i.size,this.dataFormat=i.dataFormat==null?"channelsLast":i.dataFormat,hu(this.dataFormat),this.interpolation=i.interpolation==null?"nearest":i.interpolation,o=this.interpolation,pr(a0,"InterpolationFormat",o)}computeOutputShape(i){if(this.dataFormat==="channelsFirst"){let o=i[2]==null?null:this.size[0]*i[2],u=i[3]==null?null:this.size[1]*i[3];return[i[0],i[1],o,u]}{let o=i[1]==null?null:this.size[0]*i[1],u=i[2]==null?null:this.size[1]*i[2];return[i[0],o,u,i[3]]}}call(i,o){return m.tidy(()=>{let u=Vr(i),c=u.shape;if(this.dataFormat==="channelsFirst"){u=m.transpose(u,[0,2,3,1]);let f=this.size[0]*c[2],y=this.size[1]*c[3],w=this.interpolation==="nearest"?m.image.resizeNearestNeighbor(u,[f,y]):m.image.resizeBilinear(u,[f,y]);return m.transpose(w,[0,3,1,2])}{let f=this.size[0]*c[1],y=this.size[1]*c[2];return this.interpolation==="nearest"?m.image.resizeNearestNeighbor(u,[f,y]):m.image.resizeBilinear(u,[f,y])}})}getConfig(){let i={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},o=super.getConfig();return Object.assign(i,o),i}}FR.className="UpSampling2D",m.serialization.registerClass(FR);class Rw extends H5{constructor(i){super(2,i),this.depthwiseKernel=null,this.depthMultiplier=i.depthMultiplier==null?1:i.depthMultiplier,this.depthwiseInitializer=ci(i.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Su(i.depthwiseConstraint),this.depthwiseRegularizer=Us(i.depthwiseRegularizer)}build(i){if((i=Vi(i)).length<4)throw new yn(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(i)}.`);let o=this.dataFormat==="channelsFirst"?1:3;if(i[o]==null||i[o]<0)throw new yn(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${i[o]}).`);let u=i[o],c=[this.kernelSize[0],this.kernelSize[1],u,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",c,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[u*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(i,o){return(0,m.tidy)(()=>{let u=function(c,f,y=[1,1],w="valid",C,T){return(0,m.tidy)(()=>{C==null&&(C="channelsLast"),hu(C);let x=qi(c,C);if(c.rank!==4)throw new yn(`Input for depthwiseConv2d is required to be 4-D, but is instead ${c.rank}-D`);if(f.rank!==4)throw new yn(`depthwiseKernel is required to be 4-D, but is instead ${f.rank}-D`);return x=m.depthwiseConv2d(x,f,y,w==="same"?"same":"valid","NHWC",T),C==="channelsFirst"&&(x=m.transpose(x,[0,3,1,2])),x})}(i=Vr(i),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(u=lc(u,this.bias.read(),this.dataFormat)),this.activation!=null&&(u=this.activation.apply(u)),u})}computeOutputShape(i){i=Vi(i);let o=this.dataFormat==="channelsFirst"?i[2]:i[1],u=this.dataFormat==="channelsFirst"?i[3]:i[2],c=this.dataFormat==="channelsFirst"?i[1]*this.depthMultiplier:i[3]*this.depthMultiplier,f=d0(o,this.kernelSize[0],this.padding,this.strides[0]),y=d0(u,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[i[0],c,f,y]:[i[0],f,y,c]}getConfig(){let i=super.getConfig();return i.depthMultiplier=this.depthMultiplier,i.depthwiseInitializer=Pr(this.depthwiseInitializer),i.depthwiseRegularizer=Rs(this.depthwiseRegularizer),i.depthwiseConstraint=el(this.depthwiseRegularizer),i}}function Mg(l,i,o,u){if(Array.isArray(l)){if(i!=null||o!=null)throw new yn("When inputs is an array, neither initialState or constants should be provided");u!=null&&(o=l.slice(l.length-u,l.length),l=l.slice(0,l.length-u)),l.length>1&&(i=l.slice(1,l.length)),l=l[0]}function c(f){return f==null||Array.isArray(f)?f:[f]}return{inputs:l,initialState:i=c(i),constants:o=c(o)}}function gH(l,i,o,u=!1,c,f,y=!1,w=!1){return m.tidy(()=>{let C=i.shape.length;if(C<3)throw new yn(`Input should be at least 3D, but is ${C}D.`);let T=[1,0].concat(Ss(2,C));i=m.transpose(i,T),f!=null,y&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),c!=null&&((c=m.cast(m.cast(c,"bool"),"float32")).rank===C-1&&(c=m.expandDims(c,-1)),c=m.transpose(c,T)),u&&(i=m.reverse(i,0),c!=null&&(c=m.reverse(c,0)));let x=[],A,M=o,$=i.shape[0],V=m.unstack(i),G,Q;c!=null&&(G=m.unstack(c));for(let nt=0;nt<$;++nt){let it=V[nt],ht=m.tidy(()=>l(it,M));if(c==null)A=ht[0],M=ht[1];else{let kt=m.tidy(()=>{let Nt=G[nt],$t=m.sub(m.onesLike(Nt),Nt);return{output:m.add(m.mul(ht[0],Nt),m.mul(M[0],$t)),newStates:M.map((Ut,Pt)=>m.add(m.mul(ht[1][Pt],Nt),m.mul(Ut,$t)))}});A=kt.output,M=kt.newStates}w&&x.push(A)}return w&&(Q=m.stack(x,1)),[A,Q,M]})}Rw.className="DepthwiseConv2D",m.serialization.registerClass(Rw);class f0 extends Hi{constructor(i){let o;if(super(i),i.cell==null)throw new yn("cell property is missing for the constructor of RNN.");if(o=Array.isArray(i.cell)?new X5({cells:i.cell}):i.cell,o.stateSize==null)throw new yn("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=o,this.returnSequences=i.returnSequences!=null&&i.returnSequences,this.returnState=i.returnState!=null&&i.returnState,this.goBackwards=i.goBackwards!=null&&i.goBackwards,this._stateful=i.stateful!=null&&i.stateful,this.unroll=i.unroll!=null&&i.unroll,this.supportsMasking=!0,this.inputSpec=[new La({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){return this.states_==null?Ss(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(i=>null):this.states_}setStates(i){this.states_=i}computeOutputShape(i){Fa(i)&&(i=i[0]);let o=this.cell.stateSize;Array.isArray(o)||(o=[o]);let u=o[0],c;if(c=this.returnSequences?[i[0],i[1],u]:[i[0],u],this.returnState){let f=[];for(let y of o)f.push([i[0],y]);return[c].concat(f)}return c}computeMask(i,o){return m.tidy(()=>{Array.isArray(o)&&(o=o[0]);let u=this.returnSequences?o:null;if(this.returnState){let c=this.states.map(f=>null);return[u].concat(c)}return u})}get states(){if(this.states_==null){let i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,o=[];for(let u=0;u<i;++u)o.push(null);return o}return this.states_}set states(i){this.states_=i}build(i){if(this.numConstants!=null)throw new Wi("Constants support is not implemented in RNN yet.");Fa(i)&&(i=i[0]);let o=this.stateful?i[0]:null,u=i.slice(2);this.inputSpec[0]=new La({shape:[o,null,...u]});let c=[i[0]].concat(i.slice(2)),f;if(this.cell.build(c),f=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],this.stateSpec!=null){if(!m.util.arraysEqual(this.stateSpec.map(y=>y.shape[y.shape.length-1]),f))throw new yn(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=f.map(y=>new La({shape:[null,y]}));this.stateful&&this.resetStates()}resetStates(i,o=!1){(0,m.tidy)(()=>{if(!this.stateful)throw new mh("Cannot call resetStates() on an RNN Layer that is not stateful.");let u=this.inputSpec[0].shape[0];if(u==null)throw new yn("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(c=>m.zeros([u,c])):this.states_=[m.zeros([u,this.cell.stateSize])];else if(i==null)m.dispose(this.states_),this.keptStates!=null&&(m.dispose(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(c=>m.zeros([u,c])):this.states_[0]=m.zeros([u,this.cell.stateSize]);else{if(Array.isArray(i)||(i=[i]),i.length!==this.states_.length)throw new yn(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${i.length} state value(s). Input received: ${i}`);o===!0?this.keptStates.push(this.states_.slice()):m.dispose(this.states_);for(let c=0;c<this.states_.length;++c){let f=i[c],y=Array.isArray(this.cell.stateSize)?this.cell.stateSize[c]:this.cell.stateSize,w=[u,y];if(!m.util.arraysEqual(f.shape,w))throw new yn(`State ${c} is incompatible with layer ${this.name}: expected shape=${w}, received shape=${f.shape}`);this.states_[c]=f}}this.states_=this.states_.map(c=>m.keep(c.clone()))})}apply(i,o){let u=o==null?null:o.initialState,c=o==null?null:o.constants;o==null&&(o={});let f=Mg(i,u,c,this.numConstants);i=f.inputs,u=f.initialState,c=f.constants;let y=[],w=[];if(u!=null){o.initialState=u,y=y.concat(u),this.stateSpec=[];for(let C of u)this.stateSpec.push(new La({shape:C.shape}));w=w.concat(this.stateSpec)}if(c!=null&&(o.constants=c,y=y.concat(c),this.numConstants=c.length),y[0]instanceof no){let C=[i].concat(y),T=this.inputSpec.concat(w),x=this.inputSpec;this.inputSpec=T;let A=super.apply(C,o);return this.inputSpec=x,A}return super.apply(i,o)}call(i,o){return(0,m.tidy)(()=>{let u=o==null?null:o.mask,c=o==null?null:o.training,f=o==null?null:o.initialState;i=Vr(i),f==null&&(f=this.stateful?this.states_:this.getInitialState(i));let y=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(f.length!==y)throw new yn(`RNN Layer has ${y} state(s) but was passed ${f.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");let w={training:c},C=gH(($,V)=>{let G=this.cell.call([$].concat(V),w);return[G[0],G.slice(1)]},i,f,this.goBackwards,u,null,this.unroll,this.returnSequences),T=C[0],x=C[1],A=C[2];this.stateful&&this.resetStates(A,c);let M=this.returnSequences?x:T;return this.returnState?[M].concat(A):M})}getInitialState(i){return(0,m.tidy)(()=>{let o=m.zeros(i.shape);return o=m.sum(o,[1,2]),o=Tg(o),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(u=>u>1?gh(o,[1,u]):o):this.cell.stateSize>1?[gh(o,[1,this.cell.stateSize])]:[o]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(i){super.setFastWeightInitDuringBuild(i),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(i)}getConfig(){let i=super.getConfig(),o={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(o.numConstants=this.numConstants);let u=this.cell.getConfig();return this.getClassName()===f0.className&&(o.cell={className:this.cell.getClassName(),config:u}),Object.assign(Object.assign(Object.assign({},u),i),o)}static fromConfig(i,o,u={}){let c=l0(o.cell,u);return new i(Object.assign(o,{cell:c}))}}f0.className="RNN",m.serialization.registerClass(f0);class Y5 extends Hi{}class Av extends Y5{constructor(i){super(i),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=i.units,qr(this.units,"units"),this.activation=f2(i.activation==null?this.DEFAULT_ACTIVATION:i.activation),this.useBias=i.useBias==null||i.useBias,this.kernelInitializer=ci(i.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ci(i.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ci(i.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Us(i.kernelRegularizer),this.recurrentRegularizer=Us(i.recurrentRegularizer),this.biasRegularizer=Us(i.biasRegularizer),this.kernelConstraint=Su(i.kernelConstraint),this.recurrentConstraint=Su(i.recurrentConstraint),this.biasConstraint=Su(i.biasConstraint),this.dropout=cm([1,Ds([0,i.dropout==null?0:i.dropout])]),this.recurrentDropout=cm([1,Ds([0,i.recurrentDropout==null?0:i.recurrentDropout])]),this.dropoutFunc=i.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(i){i=Vi(i),this.kernel=this.addWeight("kernel",[i[i.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(i,o){return(0,m.tidy)(()=>{if(i.length!==2)throw new yn(`SimpleRNNCell expects 2 input Tensors, got ${i.length}.`);let u=i[1];i=i[0];let c=o.training!=null&&o.training,f;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=mm({ones:()=>m.onesLike(i),rate:this.dropout,training:c,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=mm({ones:()=>m.onesLike(u),rate:this.recurrentDropout,training:c,dropoutFunc:this.dropoutFunc}));let y=this.dropoutMask,w=this.recurrentDropoutMask;f=tl(y!=null?m.mul(i,y):i,this.kernel.read()),this.bias!=null&&(f=lc(f,this.bias.read())),w!=null&&(u=m.mul(u,w));let C=m.add(f,tl(u,this.recurrentKernel.read()));return this.activation!=null&&(C=this.activation.apply(C)),[C,C]})}getConfig(){let i=super.getConfig(),o={units:this.units,activation:Ng(this.activation),useBias:this.useBias,kernelInitializer:Pr(this.kernelInitializer),recurrentInitializer:Pr(this.recurrentInitializer),biasInitializer:Pr(this.biasInitializer),kernelRegularizer:Rs(this.kernelRegularizer),recurrentRegularizer:Rs(this.recurrentRegularizer),biasRegularizer:Rs(this.biasRegularizer),activityRegularizer:Rs(this.activityRegularizer),kernelConstraint:el(this.kernelConstraint),recurrentConstraint:el(this.recurrentConstraint),biasConstraint:el(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},i),o)}}Av.className="SimpleRNNCell",m.serialization.registerClass(Av);class pm extends f0{constructor(i){i.cell=new Av(i),super(i)}call(i,o){return(0,m.tidy)(()=>{this.cell.dropoutMask!=null&&(m.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(m.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let u=o==null?null:o.mask,c=o==null?null:o.training,f=o==null?null:o.initialState;return super.call(i,{mask:u,training:c,initialState:f})})}static fromConfig(i,o){return new i(o)}}pm.className="SimpleRNN",m.serialization.registerClass(pm);class Fw extends Y5{constructor(i){if(super(i),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",i.resetAfter)throw new yn("GRUCell does not support reset_after parameter set to true.");this.units=i.units,qr(this.units,"units"),this.activation=f2(i.activation===void 0?this.DEFAULT_ACTIVATION:i.activation),this.recurrentActivation=f2(i.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:i.recurrentActivation),this.useBias=i.useBias==null||i.useBias,this.kernelInitializer=ci(i.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ci(i.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ci(i.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Us(i.kernelRegularizer),this.recurrentRegularizer=Us(i.recurrentRegularizer),this.biasRegularizer=Us(i.biasRegularizer),this.kernelConstraint=Su(i.kernelConstraint),this.recurrentConstraint=Su(i.recurrentConstraint),this.biasConstraint=Su(i.biasConstraint),this.dropout=cm([1,Ds([0,i.dropout==null?0:i.dropout])]),this.recurrentDropout=cm([1,Ds([0,i.recurrentDropout==null?0:i.recurrentDropout])]),this.dropoutFunc=i.dropoutFunc,this.implementation=i.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(i){let o=(i=Vi(i))[i.length-1];this.kernel=this.addWeight("kernel",[o,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(i,o){return(0,m.tidy)(()=>{if(i.length!==2)throw new yn(`GRUCell expects 2 input Tensors (inputs, h, c), got ${i.length}.`);let u=o.training!=null&&o.training,c=i[1];i=i[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=mm({ones:()=>m.onesLike(i),rate:this.dropout,training:u,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=mm({ones:()=>m.onesLike(c),rate:this.recurrentDropout,training:u,count:3,dropoutFunc:this.dropoutFunc}));let f=this.dropoutMask,y=this.recurrentDropoutMask,w,C,T;0<this.dropout&&this.dropout<1&&(i=m.mul(i,f[0]));let x=tl(i,this.kernel.read());this.useBias&&(x=lc(x,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(c=m.mul(c,y[0]));let A=this.recurrentKernel.read(),[M,$]=m.split(A,[2*this.units,this.units],A.rank-1),V=tl(c,M),[G,Q,nt]=m.split(x,3,x.rank-1),[it,ht]=m.split(V,2,V.rank-1);w=this.recurrentActivation.apply(m.add(G,it)),C=this.recurrentActivation.apply(m.add(Q,ht));let kt=tl(m.mul(C,c),$);T=this.activation.apply(m.add(nt,kt));let Nt=m.add(m.mul(w,c),m.mul(m.add(1,m.neg(w)),T));return[Nt,Nt]})}getConfig(){let i=super.getConfig(),o={units:this.units,activation:Ng(this.activation),recurrentActivation:Ng(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Pr(this.kernelInitializer),recurrentInitializer:Pr(this.recurrentInitializer),biasInitializer:Pr(this.biasInitializer),kernelRegularizer:Rs(this.kernelRegularizer),recurrentRegularizer:Rs(this.recurrentRegularizer),biasRegularizer:Rs(this.biasRegularizer),activityRegularizer:Rs(this.activityRegularizer),kernelConstraint:el(this.kernelConstraint),recurrentConstraint:el(this.recurrentConstraint),biasConstraint:el(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},i),o)}}Fw.className="GRUCell",m.serialization.registerClass(Fw);class mE extends f0{constructor(i){i.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),i.cell=new Fw(i),super(i)}call(i,o){return(0,m.tidy)(()=>{this.cell.dropoutMask!=null&&(m.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(m.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let u=o==null?null:o.mask,c=o==null?null:o.training,f=o==null?null:o.initialState;return super.call(i,{mask:u,training:c,initialState:f})})}static fromConfig(i,o){return o.implmentation===0&&(o.implementation=1),new i(o)}}mE.className="GRU",m.serialization.registerClass(mE);class p2 extends Y5{constructor(i){super(i),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=i.units,qr(this.units,"units"),this.activation=f2(i.activation===void 0?this.DEFAULT_ACTIVATION:i.activation),this.recurrentActivation=f2(i.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:i.recurrentActivation),this.useBias=i.useBias==null||i.useBias,this.kernelInitializer=ci(i.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ci(i.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ci(i.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=i.unitForgetBias,this.kernelRegularizer=Us(i.kernelRegularizer),this.recurrentRegularizer=Us(i.recurrentRegularizer),this.biasRegularizer=Us(i.biasRegularizer),this.kernelConstraint=Su(i.kernelConstraint),this.recurrentConstraint=Su(i.recurrentConstraint),this.biasConstraint=Su(i.biasConstraint),this.dropout=cm([1,Ds([0,i.dropout==null?0:i.dropout])]),this.recurrentDropout=cm([1,Ds([0,i.recurrentDropout==null?0:i.recurrentDropout])]),this.dropoutFunc=i.dropoutFunc,this.implementation=i.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(i){var o;let u=(i=Vi(i))[i.length-1],c;if(this.kernel=this.addWeight("kernel",[u,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){let f=this.biasInitializer,y=this.units;c=new((o=class extends Ad{apply(w,C){let T=f.apply([y]),x=new kw().apply([y]),A=f.apply([2*y]);return c2(c2(T,x),A)}}).className="CustomInit",o)}else c=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,c,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(i,o){return(0,m.tidy)(()=>{let u=o.training!=null&&o.training;if(i.length!==3)throw new yn(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${i.length}.`);let c=i[1],f=i[2];i=i[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=mm({ones:()=>m.onesLike(i),rate:this.dropout,training:u,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=mm({ones:()=>m.onesLike(c),rate:this.recurrentDropout,training:u,count:4,dropoutFunc:this.dropoutFunc}));let y=this.dropoutMask,w=this.recurrentDropoutMask,C,T,x,A;0<this.dropout&&this.dropout<1&&(i=m.mul(i,y[0]));let M=tl(i,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(c=m.mul(c,w[0])),M=m.add(M,tl(c,this.recurrentKernel.read())),this.useBias&&(M=lc(M,this.bias.read()));let[$,V,G,Q]=m.split(M,4,M.rank-1);C=this.recurrentActivation.apply($),T=this.recurrentActivation.apply(V),x=m.add(m.mul(T,f),m.mul(C,this.activation.apply(G))),A=this.recurrentActivation.apply(Q);let nt=m.mul(A,this.activation.apply(x));return[nt,nt,x]})}getConfig(){let i=super.getConfig(),o={units:this.units,activation:Ng(this.activation),recurrentActivation:Ng(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Pr(this.kernelInitializer),recurrentInitializer:Pr(this.recurrentInitializer),biasInitializer:Pr(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Rs(this.kernelRegularizer),recurrentRegularizer:Rs(this.recurrentRegularizer),biasRegularizer:Rs(this.biasRegularizer),activityRegularizer:Rs(this.activityRegularizer),kernelConstraint:el(this.kernelConstraint),recurrentConstraint:el(this.recurrentConstraint),biasConstraint:el(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},i),o)}}p2.className="LSTMCell",m.serialization.registerClass(p2);class q5 extends f0{constructor(i){i.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),i.cell=new p2(i),super(i)}call(i,o){return(0,m.tidy)(()=>{this.cell.dropoutMask!=null&&(m.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(m.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let u=o==null?null:o.mask,c=o==null?null:o.training,f=o==null?null:o.initialState;return super.call(i,{mask:u,training:c,initialState:f})})}static fromConfig(i,o){return o.implmentation===0&&(o.implementation=1),new i(o)}}q5.className="LSTM",m.serialization.registerClass(q5);class X5 extends Y5{constructor(i){super(i),this.cells=i.cells}get stateSize(){let i=[];for(let o of this.cells.slice().reverse())Array.isArray(o.stateSize)?i.push(...o.stateSize):i.push(o.stateSize);return i}call(i,o){return(0,m.tidy)(()=>{let u=i.slice(1),c=[];for(let w of this.cells.slice().reverse())Array.isArray(w.stateSize)?c.push(u.splice(0,w.stateSize.length)):c.push(u.splice(0,1));c.reverse();let f=[],y;for(let w=0;w<this.cells.length;++w){let C=this.cells[w];u=c[w],y=w===0?[i[0]].concat(u):[y[0]].concat(u),y=C.call(y,o),f.push(y.slice(1))}u=[];for(let w of f.slice().reverse())u.push(...w);return[y[0]].concat(u)})}build(i){let o;Fa(i)&&(i=i[0]),this.cells.forEach((u,c)=>{yf(`RNNCell_${c}`,()=>{u.build(i),o=Array.isArray(u.stateSize)?u.stateSize[0]:u.stateSize,i=[i[0],o]})}),this.built=!0}getConfig(){let i=super.getConfig(),o={cells:this.cells.map(u=>({className:u.getClassName(),config:u.getConfig()}))};return Object.assign(Object.assign({},i),o)}static fromConfig(i,o,u={}){let c=[];for(let f of o.cells)c.push(l0(f,u));return new i({cells:c})}get trainableWeights(){if(!this.trainable)return[];let i=[];for(let o of this.cells)i.push(...o.trainableWeights);return i}get nonTrainableWeights(){let i=[];for(let o of this.cells)i.push(...o.nonTrainableWeights);if(!this.trainable){let o=[];for(let u of this.cells)o.push(...u.trainableWeights);return o.concat(i)}return i}getWeights(){let i=[];for(let o of this.cells)i.push(...o.weights);return ja(i)}setWeights(i){let o=[];for(let u of this.cells){let c=u.weights.length,f=i.splice(c);for(let y=0;y<u.weights.length;++y)o.push([u.weights[y],f[y]])}Bo(o)}}function mm(l){let{ones:i,rate:o,training:u=!1,count:c=1,dropoutFunc:f}=l,y=()=>f!=null?f(i(),o):Ag(i(),o),w=()=>Il(y,i,u);return!c||c<=1?m.keep(w().clone()):Array(c).fill(void 0).map(w).map(C=>m.keep(C.clone()))}X5.className="StackedRNNCells",m.serialization.registerClass(X5);var Olt=function(l,i){var o={};for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&i.indexOf(u)<0&&(o[u]=l[u]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function"){var c=0;for(u=Object.getOwnPropertySymbols(l);c<u.length;c++)i.indexOf(u[c])<0&&Object.prototype.propertyIsEnumerable.call(l,u[c])&&(o[u[c]]=l[u[c]])}return o};let yH=(()=>{class l extends f0{constructor(o){if(o.unroll)throw new Wi("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(o.cell))throw new Wi("It is not possible at the moment to stack convolutional cells.");super(o),this.inputSpec=[new La({ndim:5})]}call(o,u){return m.tidy(()=>{if(this.cell.dropoutMask!=null&&(m.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(m.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),u&&u.constants)throw new yn("ConvRNN2D cell does not support constants");let c=u==null?null:u.mask,f=u==null?null:u.training,y=u==null?null:u.initialState;return super.call(o,{mask:c,training:f,initialState:y})})}computeOutputShape(o){let u=this.computeSingleOutputShape(o);return this.returnSequences||(u=[u[0],...u.slice(2)]),this.returnState&&(u=[u,...Array(2).fill([o[0],...u.slice(-3)])]),u}getInitialState(o){return m.tidy(()=>{let{stateSize:u}=this.cell,c=o.shape,f=this.computeSingleOutputShape(c),y=[f[0],...f.slice(2)],w=m.zeros(y);return Array.isArray(u)?Array(u.length).fill(w):[w]})}resetStates(o,u=!1){m.tidy(()=>{if(!this.stateful)throw new mh("Cannot call resetStates() on an RNN Layer that is not stateful.");let c=this.inputSpec[0].shape,f=this.computeSingleOutputShape(c),y=[f[0],...f.slice(2)];if(c[0]==null)throw new yn("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>m.zeros(y)):this.states_=[m.zeros(y)];else if(o==null)m.dispose(this.states_),this.keptStates!=null&&(m.dispose(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>m.zeros(y)):this.states_[0]=m.zeros(y);else{if(Array.isArray(o)||(o=[o]),o.length!==this.states_.length)throw new yn(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${o.length} state value(s). Input received: ${o}`);u?this.keptStates.push(this.states_.slice()):m.dispose(this.states_);for(let w=0;w<this.states_.length;++w){let C=o[w],T=y;if(!m.util.arraysEqual(C.shape,T))throw new yn(`State ${w} is incompatible with layer ${this.name}: expected shape=${T}, received shape=${C.shape}`);this.states_[w]=C}}this.states_=this.states_.map(w=>m.keep(w.clone()))})}computeSingleOutputShape(o){let{dataFormat:u,filters:c,kernelSize:f,padding:y,strides:w,dilationRate:C}=this.cell,T=u==="channelsFirst",x=o[T?3:2],A=o[T?4:3],M=d0(x,f[0],y,w[0],C[0]),$=d0(A,f[1],y,w[1],C[1]);return[...o.slice(0,2),...T?[c,M,$]:[M,$,c]]}}return l.className="ConvRNN2D",l})();class Dg extends p2{constructor(i){let{filters:o,kernelSize:u,strides:c,padding:f,dataFormat:y,dilationRate:w}=i;super(Object.assign(Object.assign({},i),{units:o})),this.filters=o,qr(this.filters,"filters"),this.kernelSize=Ev(u,2,"kernelSize"),this.kernelSize.forEach(C=>qr(C,"kernelSize")),this.strides=Ev(c||1,2,"strides"),this.strides.forEach(C=>qr(C,"strides")),this.padding=f||"valid",Bc(this.padding),this.dataFormat=y||"channelsLast",hu(this.dataFormat),this.dilationRate=Ev(w||1,2,"dilationRate"),this.dilationRate.forEach(C=>qr(C,"dilationRate"))}build(i){var o;i=Vi(i);let u=this.dataFormat==="channelsFirst"?1:i.length-1;if(i[u]==null)throw new yn(`The channel dimension of the input should be defined. Found ${i[u]}`);let c=i[u],f=this.kernelSize.concat([c,4*this.filters]);this.kernel=this.addWeight("kernel",f,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let y=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",y,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let w;if(this.unitForgetBias){let C=this.biasInitializer,T=this.filters;w=new((o=class extends Ad{apply(x,A){return Sv([C.apply([T]),m.ones([T]),C.apply([2*T])])}}).className="CustomInit",o)}else w=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,w,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(i,o){return m.tidy(()=>{if(i.length!==3)throw new yn(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${i.length}.`);let u=o.training||!1,c=i[0],f=i[1],y=i[2];0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=mm({ones:()=>m.onesLike(c),rate:this.dropout,training:u,count:4,dropoutFunc:this.dropoutFunc}));let w=this.dropoutMask,C=(xn,Rn,Bn)=>Rn&&Rn[Bn]?m.mul(Rn[Bn],xn):xn,T=C(c,w,0),x=C(c,w,1),A=C(c,w,2),M=C(c,w,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=mm({ones:()=>m.onesLike(f),rate:this.recurrentDropout,training:u,count:4,dropoutFunc:this.dropoutFunc}));let $=this.recurrentDropoutMask,V=C(f,$,0),G=C(f,$,1),Q=C(f,$,2),nt=C(f,$,3),[it,ht,kt,Nt]=m.split(this.kernel.read(),4,3),[$t,Ut,Pt,re]=this.useBias?m.split(this.bias.read(),4):[null,null,null,null];T=this.inputConv(T,it,$t,this.padding),x=this.inputConv(x,ht,Ut,this.padding),A=this.inputConv(A,kt,Pt,this.padding),M=this.inputConv(M,Nt,re,this.padding);let[ue,be,De,ze]=m.split(this.recurrentKernel.read(),4,3);V=this.recurrentConv(V,ue),G=this.recurrentConv(G,be),Q=this.recurrentConv(Q,De),nt=this.recurrentConv(nt,ze);let Qe=this.recurrentActivation.apply(m.add(T,V)),cn=this.recurrentActivation.apply(m.add(x,G)),en=m.add(m.mul(cn,y),m.mul(Qe,this.activation.apply(m.add(A,Q)))),sn=m.mul(this.recurrentActivation.apply(m.add(M,nt)),this.activation.apply(en));return[sn,sn,en]})}getConfig(){let i=super.getConfig(),o=Olt(i,["units"]),u={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},o),u)}inputConv(i,o,u,c){let f=m.conv2d(i,o,this.strides,c||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return u?lc(f,u,this.dataFormat):f}recurrentConv(i,o){return m.conv2d(i,o,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}Dg.className="ConvLSTM2DCell",m.serialization.registerClass(Dg);class Iv extends yH{constructor(i){let o=new Dg(i);super(Object.assign(Object.assign({},i),{cell:o}))}static fromConfig(i,o){return new i(o)}}Iv.className="ConvLSTM2D",m.serialization.registerClass(Iv);class ar extends Hi{constructor(i){super(i),this.rate=Math.max(Math.min(i.rate,1),0),this.noiseShape=i.noiseShape,this.seed=i.seed,this.supportsMasking=!0}getNoiseShape(i){if(this.noiseShape==null)return this.noiseShape;let o=i.shape,u=[];for(let c=0;c<this.noiseShape.length;++c)u.push(this.noiseShape[c]==null?o[c]:this.noiseShape[c]);return u}call(i,o){return(0,m.tidy)(()=>{this.invokeCallHook(i,o);let u=Vr(i);if(0<this.rate&&this.rate<1){let c=o.training!=null&&o.training,f=this.getNoiseShape(u);return Il(()=>Ag(u,this.rate,f,this.seed),()=>u,c)}return i})}getConfig(){let i={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},o=super.getConfig();return Object.assign(i,o),i}dispose(){return super.dispose()}}ar.className="Dropout",m.serialization.registerClass(ar);class m2 extends ar{constructor(i){super(i),this.inputSpec=[{ndim:3}]}getNoiseShape(i){let o=i.shape;return[o[0],1,o[2]]}}m2.className="SpatialDropout1D",m.serialization.registerClass(m2);class gE extends Hi{constructor(i){if(super(i),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",i.batchInputShape==null&&i.inputShape==null&&i.inputDim!=null){let o=null;i.batchSize!=null&&(o=i.batchSize),this.batchInputShape=[o,i.inputDim]}this.units=i.units,qr(this.units,"units"),this.activation=f2(i.activation),i.useBias!=null&&(this.useBias=i.useBias),this.kernelInitializer=ci(i.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=ci(i.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Su(i.kernelConstraint),this.biasConstraint=Su(i.biasConstraint),this.kernelRegularizer=Us(i.kernelRegularizer),this.biasRegularizer=Us(i.biasRegularizer),this.activityRegularizer=Us(i.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(i){let o=(i=Vi(i))[i.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[o,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:o}}],this.built=!0}computeOutputShape(i){let o=(i=Vi(i)).slice();return o[o.length-1]=this.units,o}call(i,o){return(0,m.tidy)(()=>{this.invokeCallHook(i,o);let u=Vr(i),c=ma(this.activation.getClassName()),f;return c!=null?f=tl(u,this.kernel.read(),c,this.bias?this.bias.read():null):(f=tl(u,this.kernel.read()),this.bias!=null&&(f=lc(f,this.bias.read())),this.activation!=null&&(f=this.activation.apply(f))),f})}getConfig(){let i={units:this.units,activation:Ng(this.activation),useBias:this.useBias,kernelInitializer:Pr(this.kernelInitializer),biasInitializer:Pr(this.biasInitializer),kernelRegularizer:Rs(this.kernelRegularizer),biasRegularizer:Rs(this.biasRegularizer),activityRegularizer:Rs(this.activityRegularizer),kernelConstraint:el(this.kernelConstraint),biasConstraint:el(this.biasConstraint)},o=super.getConfig();return Object.assign(i,o),i}}gE.className="Dense",m.serialization.registerClass(gE);class yE extends Hi{constructor(i){super(i=i||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=i.dataFormat}computeOutputShape(i){i=Vi(i);for(let o of i.slice(1))if(o==null)throw new yn(`The shape of the input to "Flatten" is not fully defined (got ${i.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[i[0],lm(i,1)]}call(i,o){return(0,m.tidy)(()=>{this.invokeCallHook(i,o);let u=Vr(i);if(this.dataFormat==="channelsFirst"&&u.rank>1){let c=[0];for(let f=2;f<u.rank;++f)c.push(f);c.push(1),u=(0,m.transpose)(u,c)}return function(c){if(c.rank<=1)throw new yn(`batchFlatten requires a minimum rank of 2. Got rank: ${c.rank}.`);let f=[c.shape[0],lm(c.shape,1)];return m.reshape(c,f)}(u)})}getConfig(){let i={};this.dataFormat!=null&&(i.dataFormat=this.dataFormat);let o=super.getConfig();return Object.assign(i,o),i}}yE.className="Flatten",m.serialization.registerClass(yE);class Ow extends Hi{constructor(i){super(i),this.supportsMasking=!0,this.activation=f2(i.activation)}call(i,o){return(0,m.tidy)(()=>{this.invokeCallHook(i,o);let u=Vr(i);return this.activation.apply(u)})}getConfig(){let i={activation:Ng(this.activation)},o=super.getConfig();return Object.assign(i,o),i}}Ow.className="Activation",m.serialization.registerClass(Ow);class vE extends Hi{constructor(i){super(i),this.n=i.n,this.inputSpec=[{ndim:2}]}computeOutputShape(i){return[i[0],this.n,i[1]]}call(i,o){return(0,m.tidy)(()=>function(u,c){return(0,m.tidy)(()=>{if(u.shape.length!==2)throw new yn(`repeat() expects a rank-2 tensor, but received a rank-${u.shape.length} tensor.`);return gh(Tg(u,1),[1,c,1])})}(i=Vr(i),this.n))}getConfig(){let i={n:this.n},o=super.getConfig();return Object.assign(i,o),i}}vE.className="RepeatVector",m.serialization.registerClass(vE);class bE extends Hi{constructor(i){super(i),this.targetShape=i.targetShape;for(let o=0;o<this.targetShape.length;++o)this.isUnknown(this.targetShape[o])&&(this.targetShape[o]=null)}isUnknown(i){return i<0||i==null}fixUnknownDimension(i,o){let u="Total size of new array must be unchanged.",c=o.slice(),f=1,y=null;for(let C=0;C<c.length;++C){let T=c[C];if(this.isUnknown(T)){if(y!==null)throw new yn("Can only specifiy one unknown dimension.");y=C}else f*=T}let w=lm(i);if(y!==null){if(f===0||w%f!=0)throw new yn(u);c[y]=w/f}else if(w!==f)throw new yn(u);return c}computeOutputShape(i){let o=!1;for(let u=0;u<i.length;++u)if(this.isUnknown(i[u])){o=!0;break}return o?i.slice(0,1).concat(this.targetShape):i.slice(0,1).concat(this.fixUnknownDimension(i.slice(1),this.targetShape))}call(i,o){return(0,m.tidy)(()=>{this.invokeCallHook(i,o);let u=Vr(i),c=u.shape,f=c.slice(0,1).concat(this.fixUnknownDimension(c.slice(1),this.targetShape));return(0,m.reshape)(u,f)})}getConfig(){let i={targetShape:this.targetShape},o=super.getConfig();return Object.assign(i,o),i}}bE.className="Reshape",m.serialization.registerClass(bE);class OR extends Hi{constructor(i){if(super(i),i.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(i.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${i.dims} instead.`);let o=Ss(1,i.dims.length+1);if(!m.util.arraysEqual(i.dims.slice().sort(),o))throw new Error("Invalid permutation `dims`: "+JSON.stringify(i.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=i.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new La({ndim:this.dims.length+1})]}computeOutputShape(i){let o=(i=Vi(i)).slice();return this.dims.forEach((u,c)=>{o[c+1]=i[u]}),o}call(i,o){return(0,m.transpose)(Vr(i),this.dimsIncludingBatch)}getConfig(){let i={dims:this.dims},o=super.getConfig();return Object.assign(i,o),i}}OR.className="Permute",m.serialization.registerClass(OR);class wE extends Hi{constructor(i){super(i??{}),this.supportsMasking=!0,this.maskValue=i!=null?i.maskValue==null?0:i.maskValue:0}computeOutputShape(i){return i}getConfig(){let i=super.getConfig(),o={maskValue:this.maskValue};return Object.assign(o,i),o}computeMask(i,o){let u=Vr(i);return(0,m.any)((0,m.notEqual)(u,this.maskValue),-1)}call(i,o){return(0,m.tidy)(()=>{this.invokeCallHook(i,o);let u=Vr(i),c=(0,m.any)((0,m.notEqual)(u,this.maskValue),-1,!0);return(0,m.mul)(u,(0,m.cast)(c,u.dtype))})}}wE.className="Masking",m.serialization.registerClass(wE);class xE extends Hi{constructor(i){if(super(i),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",i.batchInputShape==null&&i.inputShape==null){let o=null;i.batchSize!=null&&(o=i.batchSize),i.inputLength==null?this.batchInputShape=[o,null]:this.batchInputShape=[o].concat(xo(i.inputLength))}this.inputDim=i.inputDim,qr(this.inputDim,"inputDim"),this.outputDim=i.outputDim,qr(this.outputDim,"outputDim"),this.embeddingsInitializer=ci(i.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Us(i.embeddingsRegularizer),this.activityRegularizer=Us(i.activityRegularizer),this.embeddingsConstraint=Su(i.embeddingsConstraint),this.maskZero=i.maskZero,this.supportsMasking=i.maskZero,this.inputLength=i.inputLength}build(i){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(i){}computeMask(i,o){return(0,m.tidy)(()=>this.maskZero?(i=Vr(i),(0,m.notEqual)(i,(0,m.zerosLike)(i))):null)}computeOutputShape(i){if(i=Vi(i),this.inputLength==null)return[...i,this.outputDim];let o=xo(this.inputLength);if(o.length!==i.length-1)throw new yn(`"inputLength" is ${this.inputLength}, but received input shape has shape ${i}`);{let u=0;for(let c=0;c<o.length;++c){let f=o[c],y=i[c+1];if(f!=null&&y!=null&&f!==y)throw new yn(`"inputLength" is ${this.inputLength}, but received input shape has shape ${i}`);f==null&&(o[u]=y),u++}}return[i[0],...o,this.outputDim]}call(i,o){return(0,m.tidy)(()=>{this.invokeCallHook(i,o);let u=Vr(i);u.dtype!=="int32"&&(u=Hl(u,"int32"));let c=Kh(this.embeddings.read(),(0,m.reshape)(u,[u.size]));return(0,m.reshape)(c,Vi(this.computeOutputShape(u.shape)))})}getConfig(){let i={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Pr(this.embeddingsInitializer),embeddingsRegularizer:Rs(this.embeddingsRegularizer),activityRegularizer:Rs(this.activityRegularizer),embeddingsConstraint:el(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},o=super.getConfig();return Object.assign(i,o),i}}xE.className="Embedding",m.serialization.registerClass(xE);class p0 extends Hi{constructor(i){super(i||{}),this.supportsMasking=!0}mergeFunction(i){throw new Wi}computeElementwiseOpOutputShape(i,o){if(i==null||o==null)return null;if(i.length<o.length)return this.computeElementwiseOpOutputShape(o,i);if(o.length===0)return i;let u=i.slice(0,i.length-o.length);for(let c=0;c<o.length;++c){let f=i[i.length-o.length+c],y=o[c];if(f==null||y==null||f<0||y<0)u.push(null);else if(f===1)u.push(y);else if(y===1)u.push(f);else{if(f!==y)throw new yn("Operands could not be broadcast together with shapes "+JSON.stringify(i)+" "+JSON.stringify(o));u.push(f)}}return u}build(i){if(Array.isArray(i)&&!Array.isArray(i[0])&&(i=[Vi(i)]),i.length<2)throw new yn(`A merge layer should be called on an Array of at least 2 inputs. Got ${i.length} input(s).`);let o=[];for(let f of i)f!=null&&f[0]!==null&&o.push(f[0]);if(o=vn(o),o.length>1)throw new yn(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(i)}.`);let u=i[0]==null?null:i[0].slice(1);for(let f=1;f<i.length;++f){let y=i[f]==null?null:i[f].slice(1);u=this.computeElementwiseOpOutputShape(u,y)}let c=i.map(f=>f.length);i.indexOf(null)===-1&&vn(c).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(i,o){return(0,m.tidy)(()=>{if(this.reshapeRequired){let u=[],c=i.map(f=>f.rank);if(c.indexOf(null)===-1){let f=Ds(c);for(let y of i){let w=y.rank;for(let C=0;C<f-w;++C)y=Tg(y,1);u.push(y)}return this.mergeFunction(u)}{let f=!1;for(let C of i){let T=C.rank;if(T==null){let x=C.shape,A=x[0],M=x.slice(1).concat([A]),$=m.reshape(C,[A].concat(lm(x.slice(1))));$=m.transpose($,[1,0]),$=m.reshape($,M),u.push($),f=!0}else if(T>1){let x=Ss(1,T).concat([0]);u.push(m.transpose(C,x)),f=!0}else u.push(C)}let y=this.mergeFunction(u),w=y.rank;if(f){if(w==null){let C=y.shape,T=C[C.length-1],x=[T].concat(C.slice(0,C.length-1));y=m.reshape(m.transpose(m.reshape(y,[-1,T]),[1,0]),x)}else if(w>1){let C=[w-1].concat(Ss(0,w-1));y=m.transpose(y,C)}}return y}}return this.mergeFunction(i)})}computeOutputShape(i){let o;o=i[0]==null?null:i[0].slice(1);for(let c=1;c<i.length;++c){let f=i[c]==null?null:i[c].slice(1);o=this.computeElementwiseOpOutputShape(o,f)}let u=[];for(let c of i)c!=null&&c[0]!==null&&u.push(c[0]);return u=vn(u),o=u.length===1?u.concat(o):[null].concat(o),o}computeMask(i,o){return m.tidy(()=>{if(o==null)return null;if(!Array.isArray(o))throw new yn("`mask` should be an Array");if(!Array.isArray(i))throw new yn("`inputs` should be an Array");if(o.length!==i.length)throw new yn(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${i.length} vs ${o.length})`);if(o.every(c=>c==null))return null;let u=(o=o.map(c=>c==null?c:m.expandDims(c,0)))[0];for(let c=1;c<o.length-1;++c)u=m.logicalAnd(u,o[c]);return u})}}class LR extends p0{constructor(i){super(i)}mergeFunction(i){return(0,m.tidy)(()=>{let o=i[0].clone();for(let u=1;u<i.length;++u)o=m.add(o,i[u]);return o})}}LR.className="Add",m.serialization.registerClass(LR);class K5 extends p0{constructor(i){super(i)}mergeFunction(i){return(0,m.tidy)(()=>{let o=i[0].clone();for(let u=1;u<i.length;++u)o=m.mul(o,i[u]);return o})}}K5.className="Multiply",m.serialization.registerClass(K5);class $R extends p0{constructor(i){super(i)}mergeFunction(i){return(0,m.tidy)(()=>{let o=i[0].clone();for(let u=1;u<i.length;++u)o=m.add(o,i[u]);return m.mul(1/i.length,o)})}}$R.className="Average",m.serialization.registerClass($R);class kE extends p0{constructor(i){super(i)}mergeFunction(i){return(0,m.tidy)(()=>{let o=i[0];for(let u=1;u<i.length;++u)o=m.maximum(o,i[u]);return o})}}kE.className="Maximum",m.serialization.registerClass(kE);class SE extends p0{constructor(i){super(i)}mergeFunction(i){return(0,m.tidy)(()=>{let o=i[0];for(let u=1;u<i.length;++u)o=m.minimum(o,i[u]);return o})}}SE.className="Minimum",m.serialization.registerClass(SE);class _E extends p0{constructor(i){super(i),this.DEFAULT_AXIS=-1,i==null&&(i={}),this.axis=i.axis==null?this.DEFAULT_AXIS:i.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(i){if(!Array.isArray(i)||!Array.isArray(i[0])||i.length===1)throw new yn("A `Concatenate` layer should be called on a list of at least 2 inputs");let o=!0;for(let c of i)if(c!=null){o=!1;break}if(o)return;let u=[];for(let c=0;c<i.length;++c){let f=i[c].slice();f.splice(this.axis,1);let y=!1;for(let w of u)if(m.util.arraysEqual(w,f)){y=!0;break}y||u.push(f)}if(u.length>1)throw new yn("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(i))}mergeFunction(i){return(0,m.tidy)(()=>Sv(i,this.axis))}computeOutputShape(i){if(!Array.isArray(i)||!Array.isArray(i[0]))throw new yn("A `Concatenate` layer should be called on a list of inputs.");let o=i,u=o[0].slice(),c=this.axis<0?u.length+this.axis:this.axis;for(let f of o.slice(1)){if(u[c]==null||f[c]==null){u[c]=null;break}u[c]+=f[c]}return u}computeMask(i,o){if(o==null)return null;if(!Array.isArray(o))throw new yn("`mask` should be an array for Concatenate");if(!Array.isArray(i))throw new yn("`inputs` should be an array for Concatenate");if(o.length!==i.length)throw new yn(`Mismatch in the length of mask (${o.length}) and the legnth of inputs (${i.length})`);return m.tidy(()=>{let u=!0;if(o.forEach(y=>{y==null||(u=!1)}),u)return null;let c=[];for(let y=0;y<i.length;++y)o[y]==null?c.push(m.cast(m.onesLike(i[y]),"bool")):o[y].rank<i[y].rank?c.push(m.expandDims(o[y],-1)):c.push(o[y]);let f=m.concat(c,this.axis);return m.all(f,-1,!1)})}getConfig(){let i={axis:this.axis},o=super.getConfig();return Object.assign(i,o),i}}function Lw(l,i){for(;l<0;)l+=i;return l}_E.className="Concatenate",m.serialization.registerClass(_E);class m0 extends p0{constructor(i){super(i),this.axes=i.axes,this.normalize=i.normalize!=null&&i.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(i){m.util.assert(Array.isArray(i)&&i.length===2&&Array.isArray(i[0])&&Array.isArray(i[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let o=i[0],u=i[1];if(o.length>3||u.length>3)throw new Wi("Dot layer does not support tensors of 4D or higher rank yet.");let c=this.interpretAxes(o,u);if(o[c[0]]!==u[c[1]])throw new yn(`Dimension incompatibility: ${o[c[0]]} !== ${u[c[1]]}`)}mergeFunction(i){if(i.length!==2)throw new yn(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${i.length} input(s).`);let o,u=i[0],c=i[1];return o=Array.isArray(this.axes)?this.axes.map((f,y)=>Lw(f,i[y].shape.length)):[Lw(this.axes,u.shape.length),Lw(this.axes,c.shape.length)],this.normalize&&(u=J8(u,o[0]),c=J8(c,o[1])),function(f,y,w){if(f.shape.length>3||y.shape.length>3)throw new Wi("batchDot is not implemented for tensors of 4D or higher rank yet");if(m.util.assert(f.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${f.shape.length}`),m.util.assert(f.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${y.shape.length}`),typeof w=="number"&&(w=[w,w]),f.dtype==="complex64"||y.dtype==="complex64")throw new Wi("batchDot is not implemented for complex64-type Tensors yet.");let C=f.shape.length,T=y.shape.length;w==null&&(w=[C-1,T-2]);let x=w;return m.tidy(()=>{let A,M;if(C>T){A=C-T;let $=[];for(let V=0;V<A;++V)$.push(1);y=m.reshape(y,y.shape.concat($))}else if(T>C){A=T-C;let $=[];for(let V=0;V<A;++V)$.push(1);f=m.reshape(f,f.shape.concat($))}else A=0;if(f.shape.length===2&&y.shape.length===2)M=x[0]===x[1]?m.sum(m.mul(f,y),x[0]):m.sum(m.mul(m.transpose(f,[1,0]),y),x[1]);else{let $=x[0]!==f.shape.length-1,V=x[1]===y.shape.length-1;M=m.matMul(f,y,$,V)}if(A>0){let $;$=C>T?C+T-3:C-1;let V=[];for(let G=$;G<$+A;++G)V.push(G);M=m.squeeze(M,V)}return M.shape.length===1&&(M=m.expandDims(M,1)),M})}(u,c,o)}interpretAxes(i,o){let u;return u=Array.isArray(this.axes)?this.axes:[Lw(this.axes,i.length),Lw(this.axes,o.length)],u}computeOutputShape(i){m.util.assert(Array.isArray(i)&&i.length===2&&Array.isArray(i[0])&&Array.isArray(i[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let o=i[0].slice(),u=i[1].slice();if(o.length>3||u.length>3)throw new Wi("Dot layer does not support tensors of 4D or higher rank yet.");let c=this.interpretAxes(o,u);o.splice(c[0],1),u.splice(c[1],1),u.splice(0,1);let f=o.concat(u);return f.length===1&&f.push(1),f}computeMask(i,o){return null}getConfig(){let i={axes:this.axes,normalize:this.normalize},o=super.getConfig();return Object.assign(i,o),i}}m0.className="Dot",m.serialization.registerClass(m0);class zR extends Hi{constructor(i){super(i),this.supportsMasking=!0,this.stddev=i.stddev}computeOutputShape(i){return i}getConfig(){let i=super.getConfig(),o={stddev:this.stddev};return Object.assign(o,i),o}call(i,o){return(0,m.tidy)(()=>{this.invokeCallHook(i,o);let u=Vr(i);return Il(()=>(0,m.add)(Uc(u.shape,0,this.stddev),u),()=>u,o.training||!1)})}}zR.className="GaussianNoise",m.serialization.registerClass(zR);class CE extends Hi{constructor(i){super(i),this.supportsMasking=!0,this.rate=i.rate}computeOutputShape(i){return i}getConfig(){let i=super.getConfig(),o={rate:this.rate};return Object.assign(o,i),o}call(i,o){return(0,m.tidy)(()=>{this.invokeCallHook(i,o);let u=Vr(i);return this.rate>0&&this.rate<1?Il(()=>{let c=Math.sqrt(this.rate/(1-this.rate));return(0,m.mul)(u,Uc(u.shape,1,c))},()=>u,o.training||!1):u})}}CE.className="GaussianDropout",m.serialization.registerClass(CE);class PR extends Hi{constructor(i){super(i),this.supportsMasking=!0,this.rate=i.rate,this.noiseShape=i.noiseShape}_getNoiseShape(i){return this.noiseShape||Vr(i).shape}computeOutputShape(i){return i}getConfig(){let i=super.getConfig(),o={rate:this.rate};return Object.assign(o,i),o}call(i,o){return(0,m.tidy)(()=>{if(this.rate<1&&this.rate>0){let u=this._getNoiseShape(i);return Il(()=>{let c=Vr(i),f=-1.7580993408473766,y=(0,m.greaterEqual)((0,m.randomUniform)(u),this.rate);y=Hl(y,"float32");let w=((1-this.rate)*(1+this.rate*f**2))**-.5,C=-w*f*this.rate,T=(0,m.add)((0,m.mul)(c,y),(0,m.mul)((0,m.add)(y,-1),f));return(0,m.add)((0,m.mul)(T,w),C)},()=>Vr(i),o.training||!1)}return i})}}function Rg(l,i,o,u,c,f=.001){let y;if(l.rank===2)y=m.batchNorm2d(l,i,o,u,c,f);else if(l.rank===3)y=m.batchNorm3d(l,i,o,u,c,f);else{if(l.rank!==4)throw new Wi(`batchNormalization is not implemented for array of rank ${l.rank} yet`);y=m.batchNorm4d(l,i,o,u,c,f)}return y}function BR(l,i,o,u,c=.001){return m.util.arraysEqual(u.slice().sort(),Ss(0,l.rank-1))?function(f,y,w,C,T=.001){return(0,m.tidy)(()=>{let x=m.moments(f,C),A=x.mean,M=x.variance;return[Rg(f,A,M,w,y,T),A,M]})}(l,i,o,u,c):function(f,y,w,C,T=.001){return(0,m.tidy)(()=>{let x=m.moments(f,C),A=x.mean,M=x.variance,$=[];for(let it of Ss(0,f.rank))C.indexOf(it)!==-1?$.push(1):$.push(f.shape[it]);let V=(0,m.reshape)(A,$),G=(0,m.reshape)(M,$),Q=y==null?null:(0,m.reshape)(y,$),nt=w==null?null:(0,m.reshape)(w,$);return[Rg(f,V,G,nt,Q,T),A,M]})}(l,i,o,u,c)}PR.className="AlphaDropout",m.serialization.registerClass(PR);class EE extends Hi{constructor(i){i==null&&(i={}),super(i),this.supportsMasking=!0,this.axis=i.axis==null?-1:i.axis,this.momentum=i.momentum==null?.99:i.momentum,this.epsilon=i.epsilon==null?.001:i.epsilon,this.center=i.center==null||i.center,this.scale=i.scale==null||i.scale,this.betaInitializer=ci(i.betaInitializer||"zeros"),this.gammaInitializer=ci(i.gammaInitializer||"ones"),this.movingMeanInitializer=ci(i.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=ci(i.movingVarianceInitializer||"ones"),this.betaConstraint=Su(i.betaConstraint),this.gammaConstraint=Su(i.gammaConstraint),this.betaRegularizer=Us(i.betaRegularizer),this.gammaRegularizer=Us(i.gammaRegularizer)}build(i){i=Vi(i);let o=this.axis>=0?this.axis:this.axis+i.length,u=i[o];if(u==null)throw new yn(`Axis ${o} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(i)}.`);this.inputSpec=[new La({ndim:i.length,axes:{[o]:u}})];let c=[u];this.scale&&(this.gamma=this.addWeight("gamma",c,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",c,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",c,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",c,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(i,o){return(0,m.tidy)(()=>{let u=o.training!=null&&o.training,c=Vr(i),f=c.shape,y=f.length,w=Ss(0,y),C=this.axis>=0?this.axis:this.axis+y;w.splice(C,1);let T=i0(1,y);T[C]=f[C];let x=w.slice();x.sort();let A=!m.util.arraysEqual(x,Ss(0,y).slice(0,y-1));if(!u)return(()=>{if(A){let Q=(0,m.reshape)(this.movingMean.read(),T),nt=(0,m.reshape)(this.movingVariance.read(),T),it=this.center?(0,m.reshape)(this.beta.read(),T):null,ht=this.scale?(0,m.reshape)(this.gamma.read(),T):null;return Rg(c,Q,nt,it,ht,this.epsilon)}return Rg(c,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)})();let[M,$,V]=BR(c,this.gamma.read(),this.beta.read(),w,this.epsilon),G=(Q,nt,it)=>{m.tidy(()=>{let ht=1-it,kt=Q.read(),Nt=m.mul(m.sub(kt,nt),ht);Q.write(m.sub(kt,Nt))})};return G(this.movingMean,$,this.momentum),G(this.movingVariance,V,this.momentum),M})}getConfig(){let i={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Pr(this.betaInitializer),gammaInitializer:Pr(this.gammaInitializer),movingMeanInitializer:Pr(this.movingMeanInitializer),movingVarianceInitializer:Pr(this.movingVarianceInitializer),betaRegularizer:Rs(this.betaRegularizer),gammaRegularizer:Rs(this.gammaRegularizer),betaConstraint:el(this.betaConstraint),gammaConstraint:el(this.gammaConstraint)},o=super.getConfig();return Object.assign(i,o),i}}EE.className="BatchNormalization",m.serialization.registerClass(EE);class Z5 extends Hi{constructor(i){if(i==null&&(i={}),super(i),this.axis=i.axis==null?-1:i.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else{if(!Array.isArray(this.axis))throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);for(let o of this.axis)if(!Number.isInteger(o))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}this.epsilon=i.epsilon==null?.001:i.epsilon,this.center=i.center==null||i.center,this.scale=i.scale==null||i.scale,this.betaInitializer=ci(i.betaInitializer||"zeros"),this.gammaInitializer=ci(i.gammaInitializer||"ones"),this.betaRegularizer=Us(i.betaRegularizer),this.gammaRegularizer=Us(i.gammaRegularizer),this.supportsMasking=!0}build(i){let o=(i=Vi(i)).length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let f=0;f<this.axis.length;++f)this.axis[f]<0&&(this.axis[f]+=o);for(let f of this.axis)if(f<0||f>=o)throw new Error(`Invalid axis: ${f}`);if(this.axis.length!==vn(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);let u=this.axis.map(f=>i[f]),c=!0;this.scale?this.gamma=this.addWeight("gamma",u,"float32",this.gammaInitializer,this.gammaRegularizer,c):this.gamma=null,this.center?this.beta=this.addWeight("beta",u,"float32",this.betaInitializer,this.betaRegularizer,c):this.beta=null,this.built=!0}call(i,o){let u=Vr(i),c=u.shape,f=c.length;return(0,m.tidy)(()=>{let{mean:y,variance:w}=(0,m.moments)(u,this.axis,!0),C=i0(1,f);for(let V of this.axis)C[V]=c[V];let T=V=>V!=null&&V.shape.length!==f?m.reshape(V,C):V,x=this.scale?T(this.gamma.read()):null,A=this.center?T(this.beta.read()):null,M=[],$=[];for(let V=0;V<f;++V)this.axis.indexOf(V)!==-1?(M.push(c[V]),$.push(1)):(M.push(1),$.push(c[V]));return y=m.tile(y,M),w=m.tile(w,M),x!=null&&(x=m.tile(x,$)),A!=null&&(A=m.tile(A,$)),Rg(u,y,w,A,x,this.epsilon)})}getConfig(){let i={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Pr(this.betaInitializer),gammaInitializer:Pr(this.gammaInitializer),betaRegularizer:Rs(this.betaRegularizer),gammaRegularizer:Rs(this.gammaRegularizer)},o=super.getConfig();return Object.assign(i,o),i}}Z5.className="LayerNormalization",m.serialization.registerClass(Z5);class Q5 extends Hi{constructor(i){if(i==null&&(i={}),super(i),this.dataFormat=i.dataFormat==null?"channelsLast":i.dataFormat,i.padding==null)this.padding=[[1,1],[1,1]];else if(typeof i.padding=="number")this.padding=[[i.padding,i.padding],[i.padding,i.padding]];else{if(i.padding=i.padding,i.padding.length!==2)throw new yn(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${i.padding.length} array.`);let o,u;if(typeof i.padding[0]=="number")o=[i.padding[0],i.padding[0]],u=[i.padding[1],i.padding[1]];else{if(i.padding=i.padding,i.padding[0].length!==2)throw new yn(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${i.padding[0].length} array.`);if(o=i.padding[0],i.padding[1].length!==2)throw new yn(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${i.padding[1].length} array.`);u=i.padding[1]}this.padding=[o,u]}this.inputSpec=[new La({ndim:4})]}computeOutputShape(i){let o,u;return i=Vi(i),this.dataFormat==="channelsFirst"?(o=i[2]!=null&&i[2]>=0?i[2]+this.padding[0][0]+this.padding[0][1]:null,u=i[3]!=null&&i[3]>=0?i[3]+this.padding[1][0]+this.padding[1][1]:null,[i[0],i[1],o,u]):(o=i[1]!=null&&i[1]>=0?i[1]+this.padding[0][0]+this.padding[0][1]:null,u=i[2]!=null&&i[2]>=0?i[2]+this.padding[1][0]+this.padding[1][1]:null,[i[0],o,u,i[3]])}call(i,o){return(0,m.tidy)(()=>{return u=Vr(i),c=this.padding,f=this.dataFormat,(0,m.tidy)(()=>{if(u.rank!==4)throw new yn(`temporalPadding expects input tensor to be 4-D, but received a ${u.rank}-D tensor.`);if(c==null&&(c=[[1,1],[1,1]]),c.length!==2||c[0].length!==2||c[1].length!==2)throw new yn("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(f==null&&(f="channelsLast"),f!=="channelsLast"&&f!=="channelsFirst")throw new yn(`Unknown data format: ${f}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let y;return y=f==="channelsFirst"?[[0,0],[0,0],c[0],c[1]]:[[0,0],c[0],c[1],[0,0]],m.pad(u,y)});var u,c,f})}getConfig(){let i={padding:this.padding,dataFormat:this.dataFormat},o=super.getConfig();return Object.assign(i,o),i}}function J5(l,i,o,u,c,f){return(0,m.tidy)(()=>{let y;hu(c),ww(f),Bc(u),o==null&&(o=[1,1]),u==null&&(u="valid"),c==null&&(c="channelsLast"),f==null&&(f="max"),l=qi(l,c);let w=u==="same"?"same":"valid";return y=f==="max"?m.maxPool(l,i,o,w):m.avgPool(l,i,o,w),c==="channelsFirst"&&(y=m.transpose(y,[0,3,1,2])),y})}function jR(l,i,o,u,c,f){return(0,m.tidy)(()=>{let y;hu(c),ww(f),Bc(u),o==null&&(o=[1,1,1]),u==null&&(u="valid"),c==null&&(c="channelsLast"),f==null&&(f="max"),l=DR(l,c);let w=u==="same"?"same":"valid";return y=f==="max"?m.maxPool3d(l,i,o,w):m.avgPool3d(l,i,o,w),c==="channelsFirst"&&(y=m.transpose(y,[0,4,1,2,3])),y})}Q5.className="ZeroPadding2D",m.serialization.registerClass(Q5);class UR extends Hi{constructor(i){if(i.poolSize==null&&(i.poolSize=2),super(i),typeof i.poolSize=="number")this.poolSize=[i.poolSize];else{if(!Array.isArray(i.poolSize)||i.poolSize.length!==1||typeof i.poolSize[0]!="number")throw new yn(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(i.poolSize)}`);this.poolSize=i.poolSize}if(qr(this.poolSize,"poolSize"),i.strides==null)this.strides=this.poolSize;else if(typeof i.strides=="number")this.strides=[i.strides];else{if(!Array.isArray(i.strides)||i.strides.length!==1||typeof i.strides[0]!="number")throw new yn(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(i.strides)}`);this.strides=i.strides}qr(this.strides,"strides"),this.padding=i.padding==null?"valid":i.padding,Bc(this.padding),this.inputSpec=[new La({ndim:3})]}computeOutputShape(i){let o=d0((i=Vi(i))[1],this.poolSize[0],this.padding,this.strides[0]);return[i[0],o,i[2]]}call(i,o){return(0,m.tidy)(()=>{this.invokeCallHook(i,o),i=Tg(Vr(i),2);let u=this.poolingFunction(Vr(i),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return m.squeeze(u,[2])})}getConfig(){let i={poolSize:this.poolSize,padding:this.padding,strides:this.strides},o=super.getConfig();return Object.assign(i,o),i}}class TE extends UR{constructor(i){super(i)}poolingFunction(i,o,u,c,f){return hu(f),Bc(c),J5(i,o,u,c,f,"max")}}TE.className="MaxPooling1D",m.serialization.registerClass(TE);class AE extends UR{constructor(i){super(i)}poolingFunction(i,o,u,c,f){return hu(f),Bc(c),J5(i,o,u,c,f,"avg")}}AE.className="AveragePooling1D",m.serialization.registerClass(AE);class WR extends Hi{constructor(i){if(i.poolSize==null&&(i.poolSize=[2,2]),super(i),this.poolSize=Array.isArray(i.poolSize)?i.poolSize:[i.poolSize,i.poolSize],i.strides==null)this.strides=this.poolSize;else if(Array.isArray(i.strides)){if(i.strides.length!==2)throw new yn(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${i.strides.length}.`);this.strides=i.strides}else this.strides=[i.strides,i.strides];qr(this.poolSize,"poolSize"),qr(this.strides,"strides"),this.padding=i.padding==null?"valid":i.padding,this.dataFormat=i.dataFormat==null?"channelsLast":i.dataFormat,hu(this.dataFormat),Bc(this.padding),this.inputSpec=[new La({ndim:4})]}computeOutputShape(i){i=Vi(i);let o=this.dataFormat==="channelsFirst"?i[2]:i[1],u=this.dataFormat==="channelsFirst"?i[3]:i[2];return o=d0(o,this.poolSize[0],this.padding,this.strides[0]),u=d0(u,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[i[0],i[1],o,u]:[i[0],o,u,i[3]]}call(i,o){return(0,m.tidy)(()=>(this.invokeCallHook(i,o),this.poolingFunction(Vr(i),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let i={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},o=super.getConfig();return Object.assign(i,o),i}}class IE extends WR{constructor(i){super(i)}poolingFunction(i,o,u,c,f){return hu(f),Bc(c),J5(i,o,u,c,f,"max")}}IE.className="MaxPooling2D",m.serialization.registerClass(IE);class NE extends WR{constructor(i){super(i)}poolingFunction(i,o,u,c,f){return hu(f),Bc(c),J5(i,o,u,c,f,"avg")}}NE.className="AveragePooling2D",m.serialization.registerClass(NE);class VR extends Hi{constructor(i){if(i.poolSize==null&&(i.poolSize=[2,2,2]),super(i),this.poolSize=Array.isArray(i.poolSize)?i.poolSize:[i.poolSize,i.poolSize,i.poolSize],i.strides==null)this.strides=this.poolSize;else if(Array.isArray(i.strides)){if(i.strides.length!==3)throw new yn(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${i.strides.length}.`);this.strides=i.strides}else this.strides=[i.strides,i.strides,i.strides];qr(this.poolSize,"poolSize"),qr(this.strides,"strides"),this.padding=i.padding==null?"valid":i.padding,this.dataFormat=i.dataFormat==null?"channelsLast":i.dataFormat,hu(this.dataFormat),Bc(this.padding),this.inputSpec=[new La({ndim:5})]}computeOutputShape(i){i=Vi(i);let o=this.dataFormat==="channelsFirst"?i[2]:i[1],u=this.dataFormat==="channelsFirst"?i[3]:i[2],c=this.dataFormat==="channelsFirst"?i[4]:i[3];return o=d0(o,this.poolSize[0],this.padding,this.strides[0]),u=d0(u,this.poolSize[1],this.padding,this.strides[1]),c=d0(c,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[i[0],i[1],o,u,c]:[i[0],o,u,c,i[4]]}call(i,o){return(0,m.tidy)(()=>(this.invokeCallHook(i,o),this.poolingFunction(Vr(i),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let i={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},o=super.getConfig();return Object.assign(i,o),i}}class ME extends VR{constructor(i){super(i)}poolingFunction(i,o,u,c,f){return hu(f),Bc(c),jR(i,o,u,c,f,"max")}}ME.className="MaxPooling3D",m.serialization.registerClass(ME);class Nv extends VR{constructor(i){super(i)}poolingFunction(i,o,u,c,f){return hu(f),Bc(c),jR(i,o,u,c,f,"avg")}}Nv.className="AveragePooling3D",m.serialization.registerClass(Nv);class tS extends Hi{constructor(i){super(i),this.inputSpec=[new La({ndim:3})]}computeOutputShape(i){return[i[0],i[2]]}call(i,o){throw new Wi}}class Mv extends tS{constructor(i){super(i||{})}call(i,o){return(0,m.tidy)(()=>{let u=Vr(i);return m.mean(u,1)})}}Mv.className="GlobalAveragePooling1D",m.serialization.registerClass(Mv);class g2 extends tS{constructor(i){super(i||{})}call(i,o){return(0,m.tidy)(()=>{let u=Vr(i);return m.max(u,1)})}}g2.className="GlobalMaxPooling1D",m.serialization.registerClass(g2);class GR extends Hi{constructor(i){super(i),this.dataFormat=i.dataFormat==null?"channelsLast":i.dataFormat,hu(this.dataFormat),this.inputSpec=[new La({ndim:4})]}computeOutputShape(i){return this.dataFormat==="channelsLast"?[i[0],i[3]]:[i[0],i[1]]}call(i,o){throw new Wi}getConfig(){let i={dataFormat:this.dataFormat},o=super.getConfig();return Object.assign(i,o),i}}class DE extends GR{call(i,o){return(0,m.tidy)(()=>{let u=Vr(i);return this.dataFormat==="channelsLast"?m.mean(u,[1,2]):m.mean(u,[2,3])})}}DE.className="GlobalAveragePooling2D",m.serialization.registerClass(DE);class HR extends GR{call(i,o){return(0,m.tidy)(()=>{let u=Vr(i);return this.dataFormat==="channelsLast"?m.max(u,[1,2]):m.max(u,[2,3])})}}HR.className="GlobalMaxPooling2D",m.serialization.registerClass(HR);class vH extends Hi{constructor(i){super(i),this.layer=i.layer}build(i){this.built=!0}get trainable(){return this.layer!=null&&this.layer.trainable}set trainable(i){this.layer!=null&&(this.layer.trainable=i)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(i){this.layer.setWeights(i)}getConfig(){let i={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},o=super.getConfig();return Object.assign(i,o),i}setFastWeightInitDuringBuild(i){super.setFastWeightInitDuringBuild(i),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(i)}static fromConfig(i,o,u={}){let c=l0(o.layer,u);delete o.layer;let f={layer:c};return Object.assign(f,o),new i(f)}}class YR extends vH{constructor(i){super(i),this.supportsMasking=!0}build(i){if((i=Vi(i)).length<3)throw new yn(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(i)}`);this.inputSpec=[{shape:i}];let o=[i[0]].concat(i.slice(2));this.layer.built||(this.layer.build(o),this.layer.built=!0),super.build(i)}computeOutputShape(i){let o=[(i=Vi(i))[0]].concat(i.slice(2)),u=this.layer.computeOutputShape(o),c=i[1];return[u[0],c].concat(u.slice(1))}call(i,o){return(0,m.tidy)(()=>gH((u,c)=>[Vr(this.layer.call(u,o)),[]],i=Vr(i),[],!1,null,null,!1,!0)[1])}}YR.className="TimeDistributed",m.serialization.registerClass(YR);class qR extends vH{constructor(i){super(i);let o=i.layer.getConfig(),u={};u.className=i.layer.getClassName(),u.config=o,this.forwardLayer=l0(u),o.goBackwards=o.goBackwards!==!0;let c={};var f;if(c.className=i.layer.getClassName(),c.config=o,this.backwardLayer=l0(c),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=i.mergeMode===void 0?"concat":i.mergeMode,f=this.mergeMode,pr(u2,"BidirectionalMergeMode",f),i.weights)throw new Wi("weights support is not implemented for Bidirectional layer yet.");this._stateful=i.layer.stateful,this.returnSequences=i.layer.returnSequences,this.returnState=i.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=i.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(i){this._trainable=i,this.forwardLayer!=null&&(this.forwardLayer.trainable=i),this.backwardLayer!=null&&(this.backwardLayer.trainable=i)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(i){let o=i.length,u=Math.floor(o/2);this.forwardLayer.setWeights(i.slice(0,u)),this.backwardLayer.setWeights(i.slice(u))}computeOutputShape(i){let o,u,c,f=this.forwardLayer.computeOutputShape(i);return Array.isArray(f)&&Array.isArray(f[0])||(f=[f]),this.returnState&&(c=f.slice(1)),o=f[0],this.mergeMode==="concat"?(o[o.length-1]*=2,u=[o]):u=this.mergeMode==null?[o,o.slice()]:[o],this.returnState?this.mergeMode==null?u.concat(c).concat(c.slice()):[o].concat(c).concat(c.slice()):$u(u)}apply(i,o){let u=o==null?null:o.initialState,c=o==null?null:o.constants;o==null&&(o={});let f=Mg(i,u,c,this.numConstants);if(i=f.inputs,u=f.initialState,c=f.constants,Array.isArray(i)&&(u=i.slice(1),i=i[0]),(u==null||u.length===0)&&c==null)return super.apply(i,o);let y=[],w=[];if(u!=null){let T=u.length;if(T%2>0)throw new yn("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");o.initialState=u,y.push(...u);let x=u.map(A=>new La({shape:A.shape}));this.forwardLayer.stateSpec=x.slice(0,T/2),this.backwardLayer.stateSpec=x.slice(T/2),w.push(...x)}if(c!=null)throw new Wi("Support for constants in Bidirectional layers is not implemented yet.");let C=y[0]instanceof no;for(let T of y)if(T instanceof no!==C)throw new yn("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(C){let T=[i].concat(y),x=this.inputSpec.concat(w),A=this.inputSpec;this.inputSpec=x;let M=super.apply(T,o);return this.inputSpec=A,M}return super.apply(i,o)}call(i,o){return(0,m.tidy)(()=>{let u=o.initialState,c,f,y,w;if(u==null)c=this.forwardLayer.call(i,o),f=this.backwardLayer.call(i,o);else{let C=u.slice(0,u.length/2),T=u.slice(u.length/2);c=this.forwardLayer.call(i,Object.assign(o,{initialState:C})),f=this.backwardLayer.call(i,Object.assign(o,{initialState:T}))}return this.returnState&&(Array.isArray(c)&&(y=c.slice(1).concat(f.slice(1))),c=c[0],f=f[0]),this.returnSequences&&(f=m.reverse(f,1)),this.mergeMode==="concat"?w=Sv([c,f]):this.mergeMode==="sum"?w=m.add(c,f):this.mergeMode==="ave"?w=m.mul(.5,m.add(c,f)):this.mergeMode==="mul"?w=m.mul(c,f):this.mergeMode==null&&(w=[c,f]),this.returnState?this.mergeMode==null?w.concat(y):[w].concat(y):w})}resetStates(i){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(i){yf(this.forwardLayer.name,()=>{this.forwardLayer.build(i)}),yf(this.backwardLayer.name,()=>{this.backwardLayer.build(i)}),this.built=!0}computeMask(i,o){let u;if(Array.isArray(o)&&(o=o[0]),u=this.returnSequences?this.mergeMode==null?[o,o]:o:this.mergeMode==null?[null,null]:null,this.returnState){let c=this.forwardLayer.states.map(f=>null);return Array.isArray(u)?u.concat(c).concat(c):[u].concat(c).concat(c)}return u}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(i){super.setFastWeightInitDuringBuild(i),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(i),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(i)}getConfig(){let i={mergeMode:this.mergeMode},o=super.getConfig();return Object.assign(i,o),i}static fromConfig(i,o){let u=l0(o.layer);if(delete o.layer,o.numConstants!=null)throw new Wi("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");let c=o;return c.layer=u,new i(c)}}qR.className="Bidirectional",m.serialization.registerClass(qR);class eS extends Hi{constructor(i){super(i),this.scale=i.scale,i.offset?this.offset=i.offset:this.offset=0}getConfig(){let i={scale:this.scale,offset:this.offset},o=super.getConfig();return Object.assign(i,o),i}call(i,o){return(0,m.tidy)(()=>((i=Vr(i)).dtype!=="float32"&&(i=Hl(i,"float32")),(0,m.add)((0,m.mul)(i,this.scale),this.offset)))}}eS.className="Rescaling",m.serialization.registerClass(eS);let{resizeBilinear:Llt,cropAndResize:Dv}=m.image;class nS extends Hi{constructor(i){super(i),this.height=i.height,this.width=i.width}centerCrop(i,o,u,c,f,y,w,C){return(0,m.tidy)(()=>{let T,x=!1,A=[o/y,u/w,(c+o)/y,(f+u)/w],M=[];i.rank===3?(x=!0,T=(0,m.stack)([i])):T=i;for(let Q=0;Q<T.shape[0];Q++)M.push(A);let $=(0,m.tensor)(M,[M.length,4]),V=(0,m.range)(0,M.length,1,"int32"),G=Dv(T,$,V,[c,f],"nearest");return Hl(x?Vr((0,m.unstack)(G)):G,C)})}upsize(i,o,u,c){return(0,m.tidy)(()=>Hl(Llt(i,[o,u]),c))}call(i,o){return(0,m.tidy)(()=>{let u=Vr(i),c=u.dtype,f=u.shape,y=f[f.length-3],w=f[f.length-2],C=0;y!==this.height&&(C=Math.floor((y-this.height)/2));let T=0;return w!==this.width&&(T=Math.floor((w-this.width)/2),T===0&&(T=1)),C>=0&&T>=0?this.centerCrop(u,C,T,this.height,this.width,y,w,c):this.upsize(i,this.height,this.width,c)})}getConfig(){let i={height:this.height,width:this.width},o=super.getConfig();return Object.assign(i,o),i}computeOutputShape(i){let o=(i=Vi(i)).length-3,u=i.length-2;return i[o]=this.height,i[u]=this.width,i}}nS.className="CenterCrop",m.serialization.registerClass(nS);class y2 extends Hi{constructor(i){super(i),this.numTokens=i.numTokens,i.outputMode?this.outputMode=i.outputMode:this.outputMode="multiHot"}getConfig(){let i={numTokens:this.numTokens,outputMode:this.outputMode},o=super.getConfig();return Object.assign(i,o),i}computeOutputShape(i){return(i=Vi(i))==null?[this.numTokens]:this.outputMode==="oneHot"&&i[i.length-1]!==1?(i.push(this.numTokens),i):(i[i.length-1]=this.numTokens,i)}call(i,o){return(0,m.tidy)(()=>{let u;if((i=Vr(i)).dtype!=="int32"&&(i=Hl(i,"int32")),o.countWeights!==void 0){if(this.outputMode!=="count")throw new yn(`countWeights is not used when outputMode !== count.
              Received countWeights=${o.countWeights}`);u=Vr(o.countWeights)}let c=(0,m.max)(i),f=(0,m.min)(i),y=(0,m.greater)(this.numTokens,c).bufferSync().get(0),w=(0,m.greaterEqual)(f,0).bufferSync().get(0);if(!y||!w)throw new yn(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return function(C,T,x,A){let M=Vr(C);if(M.dtype!=="int32"&&(M=Hl(M,"int32")),T==="int")return M;let $=M.shape;if(M.rank===0&&(M=(0,m.expandDims)(M,-1)),T==="oneHot"&&M.shape[M.shape.length-1]!==1&&(M=(0,m.expandDims)(M,-1)),M.rank>2)throw new yn(`When outputMode is not int, maximum output rank is 2 Received outputMode ${T} and input shape ${$} which would result in output rank ${M.rank}.`);let V=["multiHot","oneHot"].includes(T),G=M,Q;if(Q=A!==void 0&&T==="count"?(0,m.denseBincount)(G,A,x,V):(0,m.denseBincount)(G,[],x,V),T!=="tfIdf")return Q;if(A)return(0,m.mul)(Q,A);throw new yn("When outputMode is 'tfIdf', weights must be provided.")}(i,this.outputMode,this.numTokens,u)})}}y2.className="CategoryEncoding",m.serialization.registerClass(y2);let XR=new Set(["bilinear","nearest"]);class Rv extends Hi{constructor(i){if(super(i),this.height=i.height,this.width=i.width,i.interpolation){if(!XR.has(i.interpolation))throw new yn(`Invalid interpolation parameter: ${i.interpolation} is not implemented`);this.interpolation=i.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=!!i.cropToAspectRatio}computeOutputShape(i){let o=(i=Vi(i))[2];return[this.height,this.width,o]}getConfig(){let i={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},o=super.getConfig();return Object.assign(i,o),i}call(i,o){return(0,m.tidy)(()=>{let u=[this.height,this.width];if(this.interpolation==="bilinear")return m.image.resizeBilinear(i,u,!this.cropToAspectRatio);if(this.interpolation==="nearest")return m.image.resizeNearestNeighbor(i,u,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...XR]} are supported`)})}}Rv.className="Resizing",m.serialization.registerClass(Rv);let bH=(()=>{class l{constructor(o){this.seed=o}next(){if(this.seed!==void 0)return this.seed++}}l.className="RandomSeed";return l})(),KR=(()=>{class l extends Hi{constructor(o){super(o),this.randomGenerator=new bH(o.seed)}getConfig(){let o={seed:this.randomGenerator.seed},u=super.getConfig();return Object.assign(o,u),o}}l.className="BaseRandomLayer";return l})(),ZR=new Set(["bilinear","nearest"]);class RE extends KR{constructor(i){super(i);let{factor:o,interpolation:u="bilinear"}=i;if(this.factor=o,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new yn(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new yn(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new yn(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(u){if(!ZR.has(u))throw new yn(`Invalid interpolation parameter: ${u} is not implemented`);this.interpolation=u}}getConfig(){let i={factor:this.factor,interpolation:this.interpolation},o=super.getConfig();return Object.assign(i,o),i}computeOutputShape(i){let o=(i=Vi(i))[2];return[this.imgHeight,-1,o]}call(i,o){return(0,m.tidy)(()=>{let u=Vr(i);this.imgHeight=u.shape[u.shape.length-3];let c=u.shape[u.shape.length-2];this.widthFactor=(0,m.randomUniform)([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let f=this.widthFactor.dataSync()[0]*c;f=Math.round(f);let y=[this.imgHeight,f];switch(this.interpolation){case"bilinear":return m.image.resizeBilinear(i,y);case"nearest":return m.image.resizeNearestNeighbor(i,y);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...ZR]} are supported`)}})}}function wf(l){return new Nd(l)}function rS(l){return new G5(l)}function QR(l){return new hE(l)}function wH(l){return new NR(l)}function JR(l){return new MR(l)}function $lt(l){return new Nw(l)}function iS(l){return new Iw(l)}function aS(l){return new ts(l)}function xH(l){return new Tv(l)}function kH(l){return new Mw(l)}function zlt(l){return new sp(l)}function Plt(l){return new Dw(l)}function Blt(l){return new RR(l)}function jlt(l){return new pE(l)}function SH(l){return new FR(l)}function tF(l){return new Rw(l)}function Wc(l){return new Ow(l)}function Fg(l){return new gE(l)}function eF(l){return new ar(l)}function _H(l){return new m2(l)}function nF(l){return new yE(l)}function CH(l){return new vE(l)}function Ult(l){return new bE(l)}function rF(l){return new OR(l)}function iF(l){return new xE(l)}function EH(l){return new LR(l)}function TH(l){return new $R(l)}function AH(l){return new _E(l)}function aF(l){return new kE(l)}function IH(l){return new SE(l)}function Wlt(l){return new K5(l)}function NH(l){return new m0(l)}function oF(l){return new EE(l)}function sF(l){return new Z5(l)}function MH(l){return new Q5(l)}function uF(l){return new AE(l)}function lF(l){return uF(l)}function cF(l){return uF(l)}function $w(l){return new NE(l)}function DH(l){return $w(l)}function Vlt(l){return $w(l)}function oS(l){return new Nv(l)}function hF(l){return oS(l)}function dF(l){return oS(l)}function fF(l){return new Mv(l)}function RH(l){return new DE(l)}function sS(l){return new g2(l)}function FH(l){return new HR(l)}function FE(l){return new TE(l)}function OE(l){return new IE(l)}function pF(l){return new ME(l)}function OH(l){return new mE(l)}function Glt(l){return new Fw(l)}function LH(l){return new q5(l)}function mF(l){return new p2(l)}function gF(l){return new pm(l)}function $H(l){return new Av(l)}function Hlt(l){return new Iv(l)}function zH(l){return new Dg(l)}function Ylt(l){return new f0(l)}function PH(l){return new X5(l)}function yF(l){return new qR(l)}function BH(l){return new YR(l)}RE.className="RandomWidth",m.serialization.registerClass(RE);let vF=sS,jH=FH,bF=FE,UH=OE;function wF(l){return new zR(l)}function xF(l){return new CE(l)}function WH(l){return new PR(l)}function kF(l){return new wE(l)}function VH(l){return new eS(l)}function GH(l){return new nS(l)}function HH(l){return new Rv(l)}function uS(l){return new y2(l)}function qlt(l){return new RE(l)}function YH(l,i){return rE(l,i)}function qH(l,i){return GG(l,i)}function SF(l,i){return HG(l,i)}function Xlt(l,i){return dR(l,i)}function Klt(l,i){return fR(l,i)}function Zlt(l,i){return WG(l,i)}function LE(l,i){return VG(l,i)}function $E(l,i){return cR(l,i)}function XH(l,i){return B5(l,i)}function v2(l,i){return Cw(l,i)}function KH(l,i){return Cw(l,i)}function ZH(l,i){return Cw(l,i)}function QH(l,i){return _v(l,i)}function JH(l,i){return _v(l,i)}function tY(l,i){return _v(l,i)}function eY(l,i){return function(o,u){return(0,m.tidy)(()=>{let c=o.sub(u).square().sum(),f=o.sub(o.mean()).square().sum();return m.scalar(1).sub(c.div(f))})}(l,i)}function zE(l){return new Cv(l)}function _F(l){return TR(i=l),new Cv({l1:i!=null?i.l1:null,l2:0});var i}function nY(l){return TR(i=l),new Cv({l2:i!=null?i.l2:null,l1:0});var i}class PE extends dm{constructor(){super(...arguments),this.model=null}setModel(i){if(!(i instanceof fm))throw new Error("model must be a LayersModel, not some other Container");this.model=i}}function lS(l,i){return l<i}function CF(l,i){return l>i}class EF extends PE{constructor(i){if(super(),i==null&&(i={}),i.restoreBestWeights)throw new Wi("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=i.monitor||"val_loss",this.minDelta=Math.abs(i.minDelta||0),this.patience=i.patience||0,this.verbose=i.verbose||0,this.mode=i.mode||"auto",this.baseline=i.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=lS:this.mode==="max"||this.monitor.indexOf("acc")!==-1?this.monitorFunc=CF:this.monitorFunc=lS,this.monitorFunc===lS&&(this.minDelta*=-1)}onTrainBegin(i){return ce(this,null,function*(){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===lS?1/0:-1/0})}onEpochEnd(i,o){return ce(this,null,function*(){yield h2(o);let u=this.getMonitorValue(o);u!=null&&(this.monitorFunc(u-this.minDelta,this.best)?(this.best=u,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=i,this.model.stopTraining=!0)))})}onTrainEnd(i){return ce(this,null,function*(){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)})}getMonitorValue(i){i==null&&(i={});let o=i[this.monitor];return o==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(i)}`),o}}let rY={earlyStopping:function(l){return new EF(l)}};var _s,Ir,iY;(0,m.env)().registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,l=>{l&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")}),(Ir=_s||(_s={}))[Ir.DT_INVALID=0]="DT_INVALID",Ir[Ir.DT_FLOAT=1]="DT_FLOAT",Ir[Ir.DT_DOUBLE=2]="DT_DOUBLE",Ir[Ir.DT_INT32=3]="DT_INT32",Ir[Ir.DT_UINT8=4]="DT_UINT8",Ir[Ir.DT_INT16=5]="DT_INT16",Ir[Ir.DT_INT8=6]="DT_INT8",Ir[Ir.DT_STRING=7]="DT_STRING",Ir[Ir.DT_COMPLEX64=8]="DT_COMPLEX64",Ir[Ir.DT_INT64=9]="DT_INT64",Ir[Ir.DT_BOOL=10]="DT_BOOL",Ir[Ir.DT_QINT8=11]="DT_QINT8",Ir[Ir.DT_QUINT8=12]="DT_QUINT8",Ir[Ir.DT_QINT32=13]="DT_QINT32",Ir[Ir.DT_BFLOAT16=14]="DT_BFLOAT16",Ir[Ir.DT_QINT16=15]="DT_QINT16",Ir[Ir.DT_QUINT16=16]="DT_QUINT16",Ir[Ir.DT_UINT16=17]="DT_UINT16",Ir[Ir.DT_COMPLEX128=18]="DT_COMPLEX128",Ir[Ir.DT_HALF=19]="DT_HALF",Ir[Ir.DT_RESOURCE=20]="DT_RESOURCE",Ir[Ir.DT_VARIANT=21]="DT_VARIANT",Ir[Ir.DT_UINT32=22]="DT_UINT32",Ir[Ir.DT_UINT64=23]="DT_UINT64",Ir[Ir.DT_FLOAT_REF=101]="DT_FLOAT_REF",Ir[Ir.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",Ir[Ir.DT_INT32_REF=103]="DT_INT32_REF",Ir[Ir.DT_UINT8_REF=104]="DT_UINT8_REF",Ir[Ir.DT_INT16_REF=105]="DT_INT16_REF",Ir[Ir.DT_INT8_REF=106]="DT_INT8_REF",Ir[Ir.DT_STRING_REF=107]="DT_STRING_REF",Ir[Ir.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",Ir[Ir.DT_INT64_REF=109]="DT_INT64_REF",Ir[Ir.DT_BOOL_REF=110]="DT_BOOL_REF",Ir[Ir.DT_QINT8_REF=111]="DT_QINT8_REF",Ir[Ir.DT_QUINT8_REF=112]="DT_QUINT8_REF",Ir[Ir.DT_QINT32_REF=113]="DT_QINT32_REF",Ir[Ir.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",Ir[Ir.DT_QINT16_REF=115]="DT_QINT16_REF",Ir[Ir.DT_QUINT16_REF=116]="DT_QUINT16_REF",Ir[Ir.DT_UINT16_REF=117]="DT_UINT16_REF",Ir[Ir.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",Ir[Ir.DT_HALF_REF=119]="DT_HALF_REF",Ir[Ir.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",Ir[Ir.DT_VARIANT_REF=121]="DT_VARIANT_REF",Ir[Ir.DT_UINT32_REF=122]="DT_UINT32_REF",Ir[Ir.DT_UINT64_REF=123]="DT_UINT64_REF",function(l){(function(i){i[i.LEGACY=0]="LEGACY",i[i.V1=1]="V1",i[i.V2=2]="V2"})(l.CheckpointFormatVersion||(l.CheckpointFormatVersion={}))}(iY||(iY={}));let cS={};function gm(l,i){let o={tfOpName:l,category:"custom",inputs:[],attrs:[],customExecutor:i};cS[l]=o}function b2(l){return cS[l]}function yh(l){delete cS[l]}function Yt(l,i,o,u,c){let f=i.inputParams[l];if(f&&f.inputIndexStart!==void 0){let w=f.inputIndexStart,C=f.inputIndexEnd===0?void 0:f.inputIndexEnd===void 0?w+1:f.inputIndexEnd,T=w<0?i.inputNames.length+w:w;if(f.type==="tensor")return pl(i.inputNames[T],o,u,c);if(f.type==="tensors"){let M=i.inputs.slice(w,C);return i.inputNames.slice(w,C).filter(($,V)=>{var G;return((G=M[V])===null||G===void 0?void 0:G.op)!=="NoOp"}).map($=>pl($,o,u,c))}let x=pl(i.inputNames[T],o,u,c),A=x.dataSync();return f.type==="number"?A[0]:m.util.toNestedArray(x.shape,A)}let y=i.attrParams[l];return y&&y.value}function pl(l,i,o,u){let[c,f]=Jh(l,o);if(u!=null){let w=u.getHashTableHandleByName(c);if(w!=null)return w}let y=o.currentContextIds.find(w=>!!i[zw(c,w)]);return y!==void 0?i[zw(c,y)][f]:void 0}function TF(l,i,o){return i[zw(l,o.currentContextId)]}function ym(l,i){let[o,u,c]=Jh(l,i);return[zw(o,i&&i.currentContextId),u,c]}function zw(l,i){return i?`${l}-${i}`:l}function Jh(l,i){if(l==="")return["",0,void 0];let o=i!=null&&i.parseNodeNameCache!=null;if(o){let f=i.parseNodeNameCache.get(l);if(f!=null)return f}let u=l.split(":"),c;if(u.length===1)c=[l,0,void 0];else{let f=u[0],y=u.length===3?u[1]:void 0;c=[f,Number(u[u.length-1]),y]}return o&&i.parseNodeNameCache.set(l,c),c}function hS(l,i,o){let u=Yt("pad",l,i,o);if(u==="explicit"){u=Yt("explicitPaddings",l,i,o);let c=[[0,0],[0,0],[0,0],[0,0]];for(let f=0;f<4;f++)c[f][0]=u[2*f],c[f][1]=u[2*f+1];return c}return u}function Og(l){return l.kept?l:(0,m.clone)(l)}let aY=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],oY=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],sY=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],uY=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],BE=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],lY=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],cY=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],hY=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],dY=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],fY=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],AF=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],jE=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],pY=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],mY=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],gY=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],yY=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],vY=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],bY=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],wY=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];class dS{static get Instance(){return this._instance||(this._instance=new this)}constructor(){let i=[].concat(...[Z,Y,X,J,q,H,tt,st,lt,ft,gt,xt,wt,_t,bt,Tt,qt,It,St].map(o=>o.json));this.opMappers=i.reduce((o,u)=>(o[u.tfOpName]=u,o),{})}transformGraph(i,o={}){let u=i.node,c=[],f=[],y=[],w=u.reduce((G,Q)=>(G[Q.name]=this.mapNode(Q),Q.op.startsWith("Placeholder")?c.push(G[Q.name]):Q.op==="Const"?f.push(G[Q.name]):Q.input!=null&&Q.input.length!==0||y.push(G[Q.name]),G),{}),C=[],T=[],x={},A={};o!=null&&(x=this.mapSignatureEntries(o.inputs),A=this.mapSignatureEntries(o.outputs));let M=Object.keys(w);M.forEach(G=>{let Q=w[G];Q.inputNames.forEach((nt,it)=>{let[ht,,kt]=ym(nt),Nt=w[ht];if(Nt.outputs!=null){let $t=Nt.outputs.indexOf(kt);if($t!==-1){let Ut=`${ht}:${$t}`;Q.inputNames[it]=Ut}}Q.inputs.push(Nt),Nt.children.push(Q)})}),Object.keys(A).length===0?M.forEach(G=>{let Q=w[G];Q.children.length===0&&T.push(Q)}):Object.keys(A).forEach(G=>{let[Q]=ym(G),nt=w[Q];nt!=null&&(nt.signatureKey=A[G],T.push(nt))}),Object.keys(x).length>0?Object.keys(x).forEach(G=>{let[Q]=ym(G),nt=w[Q];nt&&(nt.signatureKey=x[G],C.push(nt))}):C=c;let $={};i.library!=null&&i.library.function!=null&&($=i.library.function.reduce((G,Q)=>(G[Q.signature.name]=this.mapFunction(Q),G),{}));let V={nodes:w,inputs:C,outputs:T,weights:f,placeholders:c,signature:o,functions:$};return y.length>0&&(V.initNodes=y),V}mapSignatureEntries(i){return Object.keys(i||{}).reduce((o,u)=>(o[i[u].name]=u,o),{})}mapNode(i){let o=b2(i.op)||this.opMappers[i.op]||{};i.attr==null&&(i.attr={});let u={name:i.name,op:i.op,category:o.category,inputNames:(i.input||[]).map(c=>c.startsWith("^")?c.slice(1):c),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:i.attr,outputs:o.outputs};return o.inputs!=null&&(u.inputParams=o.inputs.reduce((c,f)=>(c[f.name]={type:f.type,inputIndexStart:f.start,inputIndexEnd:f.end},c),{})),o.attrs!=null&&(u.attrParams=o.attrs.reduce((c,f)=>{let y=f.type,w;switch(f.type){case"string":w=UE(i.attr,f.tfName,f.defaultValue),w===void 0&&f.tfDeprecatedName&&(w=UE(i.attr,f.tfDeprecatedName,f.defaultValue));break;case"string[]":w=Pw(i.attr,f.tfName,f.defaultValue),w===void 0&&f.tfDeprecatedName&&(w=Pw(i.attr,f.tfDeprecatedName,f.defaultValue));break;case"number":w=es(i.attr,f.tfName,f.defaultValue||0),w===void 0&&f.tfDeprecatedName&&(w=es(i.attr,f.tfDeprecatedName,f.defaultValue));break;case"number[]":w=Fv(i.attr,f.tfName,f.defaultValue),w===void 0&&f.tfDeprecatedName&&(w=Fv(i.attr,f.tfDeprecatedName,f.defaultValue));break;case"bool":w=WE(i.attr,f.tfName,f.defaultValue),w===void 0&&f.tfDeprecatedName&&(w=WE(i.attr,f.tfDeprecatedName,f.defaultValue));break;case"bool[]":w=RF(i.attr,f.tfName,f.defaultValue),w===void 0&&f.tfDeprecatedName&&(w=RF(i.attr,f.tfDeprecatedName,f.defaultValue));break;case"shape":w=pS(i.attr,f.tfName,f.defaultValue),w===void 0&&f.tfDeprecatedName&&(w=pS(i.attr,f.tfDeprecatedName,f.defaultValue));break;case"shape[]":w=DF(i.attr,f.tfName,f.defaultValue),w===void 0&&f.tfDeprecatedName&&(w=DF(i.attr,f.tfDeprecatedName,f.defaultValue));break;case"dtype":w=Lg(i.attr,f.tfName,f.defaultValue),w===void 0&&f.tfDeprecatedName&&(w=Lg(i.attr,f.tfDeprecatedName,f.defaultValue));break;case"dtype[]":w=NF(i.attr,f.tfName,f.defaultValue),w===void 0&&f.tfDeprecatedName&&(w=NF(i.attr,f.tfDeprecatedName,f.defaultValue));break;case"func":w=VE(i.attr,f.tfName,f.defaultValue),w===void 0&&f.tfDeprecatedName&&(w=VE(i.attr,f.tfDeprecatedName,f.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${f.type} for op: ${i.op}`)}return c[f.name]={value:w,type:y},c},{})),u}mapFunction(i){let o=i.nodeDef,u=[],c={};o!=null&&(c=o.reduce((T,x)=>(T[x.name]=this.mapNode(x),x.op==="Const"&&u.push(T[x.name]),T),{}));let f=[],y=[];i.signature.inputArg.forEach(T=>{let[x]=ym(T.name),A={name:x,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:fS(T.type),type:"dtype"}},children:[]};A.signatureKey=T.name,f.push(A),c[x]=A}),Object.keys(c).forEach(T=>{let x=c[T];x.inputNames.forEach((A,M)=>{let[$,,V]=ym(A),G=c[$];if(G.outputs!=null){let Q=G.outputs.indexOf(V);if(Q!==-1){let nt=`${$}:${Q}`;x.inputNames[M]=nt}}x.inputs.push(G),G.children.push(x)})});let w=i.ret;i.signature.outputArg.forEach(T=>{let[x,A]=ym(w[T.name]),M=c[x];M!=null&&(M.defaultOutput=A,y.push(M))});let C=this.mapArgsToSignature(i);return{nodes:c,inputs:f,outputs:y,weights:u,placeholders:[],signature:C}}mapArgsToSignature(i){return{methodName:i.signature.name,inputs:i.signature.inputArg.reduce((o,u)=>(o[u.name]=this.mapArgToTensorInfo(u),o),{}),outputs:i.signature.outputArg.reduce((o,u)=>(o[u.name]=this.mapArgToTensorInfo(u,i.ret),o),{})}}mapArgToTensorInfo(i,o){let u=i.name;return o!=null&&(u=o[u]),{name:u,dtype:i.type}}}function IF(l,i){let o=Array.isArray(l)?String.fromCharCode.apply(null,l):function(u){let c=(0,m.env)().global;if(c.atob!==void 0)return c.atob(u);if(typeof Un<"u")return new Un(u,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(l);return i?o:o.toLowerCase()}function UE(l,i,o,u=!1){let c=l[i];return c!=null?IF(c.s,u):o}function WE(l,i,o){let u=l[i];return u?u.b:o}function es(l,i,o){let u=l[i]||{},c=u.i!=null?u.i:u.f!=null?u.f:o;return typeof c=="number"?c:parseInt(c,10)}function fS(l){switch(typeof l=="string"&&(l=_s[l]),l){case _s.DT_FLOAT:case _s.DT_HALF:return"float32";case _s.DT_INT32:case _s.DT_INT64:case _s.DT_INT8:case _s.DT_UINT8:return"int32";case _s.DT_BOOL:return"bool";case _s.DT_DOUBLE:return"float32";case _s.DT_STRING:return"string";case _s.DT_COMPLEX64:case _s.DT_COMPLEX128:return"complex64";default:return null}}function VE(l,i,o){let u=l[i];return u&&u.func?u.func.name:o}function Lg(l,i,o){let u=l[i];return u&&u.type?fS(u.type):o}function NF(l,i,o){let u=l[i];return u&&u.list&&u.list.type?u.list.type.map(c=>fS(c)):o}function MF(l){if(!l.unknownRank)return l.dim!=null?l.dim.map(i=>typeof i.size=="number"?i.size:parseInt(i.size,10)):[]}function pS(l,i,o){let u=l[i];return u&&u.shape?MF(u.shape):o}function Fv(l,i,o){let u=l[i];return u?((u.list.f&&u.list.f.length?u.list.f:u.list.i)||[]).map(c=>typeof c=="number"?c:parseInt(c,10)):o}function Pw(l,i,o,u=!1){let c=l[i];return c&&c.list&&c.list.s?c.list.s.map(f=>IF(f,u)):o}function DF(l,i,o){let u=l[i];return u&&u.list&&u.list.shape?u.list.shape.map(c=>MF(c)):o}function RF(l,i,o){let u=l[i];return u&&u.list&&u.list.b?u.list.b:o}class Qlt{constructor(i,o,u){this.node=i,this.tensorMap=o,this.context=u,this.inputs=[],this.attrs={},this.inputs=i.inputNames.map(c=>this.getInput(c)),i.rawAttrs!=null&&(this.attrs=Object.keys(i.rawAttrs).reduce((c,f)=>(c[f]=this.getAttr(f),c),{}))}getInput(i){return pl(i,this.tensorMap,this.context)}getAttr(i,o){let u=this.node.rawAttrs[i];if(u.tensor!=null)return pl(i,this.tensorMap,this.context);if(u.i!=null||u.f!=null)return es(this.node.rawAttrs,i,o);if(u.s!=null)return UE(this.node.rawAttrs,i,o);if(u.b!=null)return WE(this.node.rawAttrs,i,o);if(u.shape!=null)return pS(this.node.rawAttrs,i,o);if(u.type!=null)return Lg(this.node.rawAttrs,i,o);if(u.list!=null){if(u.list.i!=null||u.list.f!=null)return Fv(this.node.rawAttrs,i,o);if(u.list.s!=null)return Pw(this.node.rawAttrs,i,o);if(u.list.shape!=null)return DF(this.node.rawAttrs,i,o);if(u.list.b!=null)return RF(this.node.rawAttrs,i,o);if(u.list.type!=null)return NF(this.node.rawAttrs,i,o)}return o}}var pn=F(7270);function up(l,i,o=""){if(typeof l!="number"&&typeof i!="number"){m.util.assert(l.length===i.length,()=>o+` Shapes ${l} and ${i} must match`);for(let u=0;u<l.length;u++){let c=l[u],f=i[u];m.util.assert(c<0||f<0||c===f,()=>o+` Shapes ${l} and ${i} must match`)}}}function mS(l){return typeof l!="number"&&!l.some(i=>i<0)}function Bw(l,i,o){let u=GE(l,o),c=!mS(u);if(c&&i.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${u}`);if(c&&i.forEach(f=>{u=GE(f.shape,u)}),!mS(u))throw new Error(`Non-fully-defined elementShape: ${u}`);return u}function GE(l,i){if(typeof l=="number")return i;if(typeof i=="number")return l;if(l.length!==i.length)throw new Error(`Incompatible ranks during merge: ${l} vs. ${i}`);let o=[];for(let u=0;u<l.length;++u){let c=l[u],f=i[u];if(c>=0&&f>=0&&c!==f)throw new Error(`Incompatible shape during merge: ${l} vs. ${i}`);o[u]=c>=0?c:f}return o}class xY{constructor(i,o,u,c,f,y,w){this.name=i,this.dtype=o,this.maxSize=u,this.elementShape=c,this.identicalElementShapes=f,this.dynamicSize=y,this.clearAfterRead=w,this.tensors=[],this.closed_=!1,this.idTensor=(0,m.scalar)(0),(0,m.keep)(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(i){this.tensors.forEach(o=>{i!=null&&i.has(o.tensor.id)||o.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(i){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(i<0||i>=this.size())throw new Error(`Tried to read from index ${i}, but array size is: ${this.size()}`);let o=this.tensors[i];if(o.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${i} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(o.cleared=!0),o.read=!0,o.tensor}readMany(i){return i.map(o=>this.read(o))}write(i,o){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(i<0||!this.dynamicSize&&i>=this.maxSize)throw new Error(`Tried to write to index ${i}, but array is not resizeable and size is: ${this.maxSize}`);let u=this.tensors[i]||{};if(o.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${i},
          because the value dtype is ${o.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()!==0||this.elementShape!=null&&this.elementShape.length!==0||(this.elementShape=o.shape),up(this.elementShape,o.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${i}.`),u.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${i}, because it has already been read.`);if(u.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${i}, because it has already been written.`);u.tensor=o,(0,m.keep)(o),u.written=!0,this.tensors[i]=u}writeMany(i,o){if(i.length!==o.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${i.length} is not the same as tensors size: ${o.length}.`);i.forEach((u,c)=>this.write(u,o[c]))}gather(i,o){if(o&&o!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${o}`);if(i)i=i.slice(0,this.size());else{i=[];for(let c=0;c<this.size();c++)i.push(c)}if(i.length===0)return(0,m.tensor)([],[0].concat(this.elementShape));let u=this.readMany(i);return up(this.elementShape,u[0].shape,"TensorArray shape mismatch: "),(0,m.stack)(u,0)}concat(i){if(i&&i!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${i}`);if(this.size()===0)return(0,m.tensor)([],[0].concat(this.elementShape));let o=[];for(let c=0;c<this.size();c++)o.push(c);let u=this.readMany(o);return up(this.elementShape,u[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${u[0].shape})`),(0,m.concat)(u,0)}scatter(i,o){if(o.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${o.dtype}`);if(i.length!==o.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${i.length} vs. ${o.shape[0]}`);let u=Math.max(...i);if(!this.dynamicSize&&u>=this.maxSize)throw new Error(`Max index must be < array size (${u}  vs. ${this.maxSize})`);this.writeMany(i,(0,m.unstack)(o,0))}split(i,o){if(o.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${o.dtype}`);let u=0,c=i.map(C=>(u+=C,u));if(u!==o.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${u}, and tensor's shape is: ${o.shape}`);if(!this.dynamicSize&&i.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${i.length}), and the TensorArray is not marked as dynamically resizeable`);let f=u===0?0:o.size/u,y=[];(0,m.tidy)(()=>{o=(0,m.reshape)(o,[1,u,f]);for(let C=0;C<i.length;++C){let T=[0,C===0?0:c[C-1],0],x=[1,i[C],f];y[C]=(0,m.reshape)((0,m.slice)(o,T,x),this.elementShape)}return y});let w=[];for(let C=0;C<i.length;C++)w[C]=C;this.writeMany(w,y)}}class w2{get id(){return this.idTensor.id}constructor(i,o,u,c=-1){this.tensors=i,this.elementShape=o,this.elementDtype=u,i?.forEach(f=>{if(u!==f.dtype)throw new Error(`Invalid data types; op elements ${u}, but list elements ${f.dtype}`);up(o,f.shape,"TensorList shape mismatch: "),(0,m.keep)(f)}),this.idTensor=(0,m.scalar)(0),this.maxNumElements=c,(0,m.keep)(this.idTensor)}copy(){return new w2([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(i){this.tensors.forEach(o=>{i!=null&&i.has(o.id)||o.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(i,o,u=-1){if(o!==this.elementDtype)throw new Error(`Invalid data types; op elements ${o}, but list elements ${this.elementDtype}`);if(u!==-1&&this.tensors.length!==u)throw new Error(`Operation expected a list with ${u} elements but got a list with ${this.tensors.length} elements.`);up(i,this.elementShape,"TensorList shape mismatch: ");let c=Bw(this.elementShape,this.tensors,i);return(0,m.tidy)(()=>{let f=this.tensors.map(y=>(0,m.reshape)(y,c));return(0,m.stack)(f,0)})}popBack(i,o){if(o!==this.elementDtype)throw new Error(`Invalid data types; op elements ${o}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");let u=Bw(this.elementShape,this.tensors,i),c=this.tensors.pop();return c.kept=!1,up(c.shape,i,"TensorList shape mismatch: "),(0,m.reshape)(c,u)}pushBack(i){if(i.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${i.dtype}, but list elements ${this.elementDtype}`);if(up(i.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");(0,m.keep)(i),this.tensors.push(i)}resize(i){if(i<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${i}`);if(this.maxNumElements!==-1&&i>this.maxNumElements)throw new Error(`TensorListResize input size ${i} is greater maxNumElement ${this.maxNumElements}.`);let o=new w2([],this.elementShape,this.elementDtype,this.maxNumElements);o.tensors.length=i;for(let u=0;u<Math.min(this.tensors.length,i);++u)o.tensors[u]=this.tensors[u];return o}getItem(i,o,u){if(u!==this.elementDtype)throw new Error(`Invalid data types; op elements ${u}, but list elements ${this.elementDtype}`);if(i<0||i>this.tensors.length)throw new Error(`Trying to access element ${i} in a list with ${this.tensors.length} elements.`);if(this.tensors[i]==null)throw new Error(`element at index ${i} is null.`);up(this.tensors[i].shape,o,"TensorList shape mismatch: ");let c=Bw(this.elementShape,this.tensors,o);return(0,m.reshape)(this.tensors[i],c)}setItem(i,o){if(o.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${o.dtype}, but list elements ${this.elementDtype}`);if(i<0||this.maxNumElements!==-1&&i>=this.maxNumElements)throw new Error(`Trying to set element ${i} in a list with max ${this.maxNumElements} elements.`);up(this.elementShape,o.shape,"TensorList shape mismatch: "),(0,m.keep)(o),this.tensors[i]!=null&&(this.tensors[i].kept=!1),this.tensors[i]=o}gather(i,o,u){if(o!==this.elementDtype)throw new Error(`Invalid data types; op elements ${o}, but list elements ${this.elementDtype}`);up(this.elementShape,u,"TensorList shape mismatch: "),i=i.slice(0,this.size());let c=Bw(this.elementShape,this.tensors,u);return i.length===0?(0,m.tensor)([],[0].concat(c)):(0,m.tidy)(()=>{let f=i.map(y=>(0,m.reshape)(this.tensors[y],c));return(0,m.stack)(f,0)})}concat(i,o){if(i&&i!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${i}`);up(this.elementShape,o,"TensorList shape mismatch: ");let u=Bw(this.elementShape,this.tensors,o);return this.size()===0?(0,m.tensor)([],[0].concat(u)):(0,m.tidy)(()=>{let c=this.tensors.map(f=>(0,m.reshape)(f,u));return(0,m.concat)(c,0)})}}let FF=(l,i,o)=>ce(this,null,function*(){switch(l.op){case"If":case"StatelessIf":{let u=Yt("thenBranch",l,i,o),c=Yt("elseBranch",l,i,o),f=Yt("cond",l,i,o),y=Yt("args",l,i,o);return(yield f.data())[0]?o.functionMap[u].executeFunctionAsync(y,o.tensorArrayMap,o.tensorListMap):o.functionMap[c].executeFunctionAsync(y,o.tensorArrayMap,o.tensorListMap)}case"While":case"StatelessWhile":{let u=Yt("body",l,i,o),c=Yt("cond",l,i,o),f=Yt("args",l,i,o),y=yield o.functionMap[c].executeFunctionAsync(f,o.tensorArrayMap,o.tensorListMap),w=f.map(x=>x.id),C=yield y[0].data();y.forEach(x=>{x.kept||w.indexOf(x.id)!==-1||x.dispose()});let T=f;for(;C[0];){let x=T;T=yield o.functionMap[u].executeFunctionAsync(T,o.tensorArrayMap,o.tensorListMap);let A=T.map($=>$.id);x.forEach($=>{$.kept||w.indexOf($.id)!==-1||A.indexOf($.id)!==-1||$.dispose()});let M=yield o.functionMap[c].executeFunctionAsync(T,o.tensorArrayMap,o.tensorListMap);C=yield M[0].data(),M.forEach($=>{$.kept||w.indexOf($.id)!==-1||A.indexOf($.id)!==-1||$.dispose()})}return T}case"LoopCond":return[Og(Yt("pred",l,i,o))];case"Switch":{let u=Yt("pred",l,i,o),c=Yt("data",l,i,o);return c.kept||(c=Og(c)),(yield u.data())[0]?[void 0,c]:[c,void 0]}case"Merge":{let u=l.inputNames.find(c=>pl(c,i,o)!==void 0);return u?[Og(pl(u,i,o))]:void 0}case"Enter":{let u=Yt("frameName",l,i,o),c=Yt("tensor",l,i,o);return o.enterFrame(u),[Og(c)]}case"Exit":{let u=Yt("tensor",l,i,o);return o.exitFrame(),[Og(u)]}case"NextIteration":{let u=Yt("tensor",l,i,o);return o.nextIteration(),[Og(u)]}case"TensorArrayV3":{let u=Yt("size",l,i,o),c=Yt("dtype",l,i,o),f=Yt("elementShape",l,i,o),y=Yt("dynamicSize",l,i,o),w=Yt("clearAfterRead",l,i,o),C=Yt("identicalElementShapes",l,i,o),T=Yt("name",l,i,o),x=new xY(T,c,u,f,C,y,w);return o.addTensorArray(x),[x.idTensor,(0,m.scalar)(1)]}case"TensorArrayWriteV3":{let u=Yt("tensorArrayId",l,i,o),c=Yt("index",l,i,o),f=Yt("tensor",l,i,o),y=o.getTensorArray(u.id);return y.write(c,f),[y.idTensor]}case"TensorArrayReadV3":{let u=Yt("tensorArrayId",l,i,o),c=Yt("index",l,i,o);return[o.getTensorArray(u.id).read(c)]}case"TensorArrayGatherV3":{let u=Yt("tensorArrayId",l,i,o),c=Yt("indices",l,i,o),f=Yt("dtype",l,i,o);return[o.getTensorArray(u.id).gather(c,f)]}case"TensorArrayScatterV3":{let u=Yt("tensorArrayId",l,i,o),c=Yt("indices",l,i,o),f=Yt("tensor",l,i,o),y=o.getTensorArray(u.id);return y.scatter(c,f),[y.idTensor]}case"TensorArrayConcatV3":{let u=Yt("tensorArrayId",l,i,o),c=o.getTensorArray(u.id),f=Yt("dtype",l,i,o);return[c.concat(f)]}case"TensorArraySplitV3":{let u=Yt("tensorArrayId",l,i,o),c=Yt("tensor",l,i,o),f=Yt("lengths",l,i,o),y=o.getTensorArray(u.id);return y.split(f,c),[y.idTensor]}case"TensorArraySizeV3":{let u=Yt("tensorArrayId",l,i,o),c=o.getTensorArray(u.id);return[(0,m.scalar)(c.size(),"int32")]}case"TensorArrayCloseV3":{let u=Yt("tensorArrayId",l,i,o),c=o.getTensorArray(u.id);return c.clearAndClose(),[c.idTensor]}case"TensorListSetItem":{let u=Yt("tensorListId",l,i,o),c=Yt("index",l,i,o),f=Yt("tensor",l,i,o),y=o.getTensorList(u.id);return y.setItem(c,f),[y.idTensor]}case"TensorListGetItem":{let u=Yt("tensorListId",l,i,o),c=Yt("index",l,i,o),f=Yt("elementShape",l,i,o),y=Yt("elementDType",l,i,o);return[o.getTensorList(u.id).getItem(c,f,y)]}case"TensorListScatterV2":case"TensorListScatter":{let u=Yt("indices",l,i,o),c=function(f,y,w,C){if(y.length!==f.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${y.length} vs. ${f.shape[0]}`);let T=Math.max(...y);if(C!=null&&C!==-1&&T>=C)throw new Error(`Max index must be < array size (${T}  vs. ${C})`);let x=new w2([],w,f.dtype,C),A=(0,m.unstack)(f,0);return y.forEach((M,$)=>{x.setItem(M,A[$])}),x}(Yt("tensor",l,i,o),u,Yt("elementShape",l,i,o),Yt("numElements",l,i,o));return o.addTensorList(c),[c.idTensor]}case"TensorListReserve":case"EmptyTensorList":{let u=Yt("elementShape",l,i,o),c=Yt("elementDType",l,i,o),f;f=l.op==="TensorListReserve"?"numElements":"maxNumElements";let y=Yt(f,l,i,o),w=function(C,T,x,A){return new w2([],C,T,A)}(u,c,0,l.op==="TensorListReserve"?-1:y);return o.addTensorList(w),[w.idTensor]}case"TensorListGather":{let u=Yt("tensorListId",l,i,o),c=Yt("indices",l,i,o),f=Yt("elementShape",l,i,o),y=Yt("elementDType",l,i,o);return[o.getTensorList(u.id).gather(c,y,f)]}case"TensorListStack":{let u=Yt("tensorListId",l,i,o),c=Yt("elementShape",l,i,o),f=Yt("elementDType",l,i,o),y=Yt("numElements",l,i,o);return[o.getTensorList(u.id).stack(c,f,y)]}case"TensorListFromTensor":{let u=function(c,f,y){let w=c.dtype;if(c.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${c.shape}`);if(c.dtype!==y)throw new Error(`Invalid data types; op elements ${c.dtype}, but list elements ${y}`);up(c.shape.slice(1),f,"TensorList shape mismatch: ");let C=(0,m.unstack)(c);return new w2(C,f,w)}(Yt("tensor",l,i,o),Yt("elementShape",l,i,o),Yt("elementDType",l,i,o));return o.addTensorList(u),[u.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{let u=Yt("tensorListId",l,i,o),c=o.getTensorList(u.id),f=Yt("dtype",l,i,o),y=Yt("elementShape",l,i,o);return[c.concat(f,y)]}case"TensorListPushBack":{let u=Yt("tensorListId",l,i,o),c=Yt("tensor",l,i,o),f=o.getTensorList(u.id);return f.pushBack(c),[f.idTensor]}case"TensorListPopBack":{let u=Yt("tensorListId",l,i,o),c=Yt("elementShape",l,i,o),f=Yt("elementDType",l,i,o);return[o.getTensorList(u.id).popBack(c,f)]}case"TensorListSplit":{let u=Yt("tensor",l,i,o),c=Yt("elementShape",l,i,o),f=function(y,w,C){let T=0,x=w.map(G=>(T+=G,T));if(T!==y.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${T}, and tensor's shape is: ${y.shape}`);let A=GE(y.shape.slice(1),C),M=T===0?0:y.size/T,$=(0,m.tidy)(()=>{let G=[];y=(0,m.reshape)(y,[1,T,M]);for(let Q=0;Q<w.length;++Q){let nt=[0,Q===0?0:x[Q-1],0],it=[1,w[Q],M];G[Q]=(0,m.reshape)((0,m.slice)(y,nt,it),A)}return y.dispose(),G}),V=new w2([],C,y.dtype,w.length);for(let G=0;G<$.length;G++)V.setItem(G,$[G]);return V}(u,Yt("lengths",l,i,o),c);return o.addTensorList(f),[f.idTensor]}case"TensorListLength":{let u=Yt("tensorListId",l,i,o),c=o.getTensorList(u.id);return[(0,m.scalar)(c.size(),"int32")]}case"TensorListResize":{let u=Yt("tensorListId",l,i,o),c=Yt("size",l,i,o),f=o.getTensorList(u.id).resize(c);return o.addTensorList(f),[f.idTensor]}default:throw TypeError(`Node type ${l.op} is not implemented`)}});function gS(l,i,o){let[u,c]=Yt("fusedOps",l,i,o),f=u==="biasadd",y=!f,w=c==="prelu",C=u==="fusedbatchnorm",T=Yt("numArgs",l,i,o);if(f){if(w&&T!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!w&&f&&T!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(C)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");let x=Yt("strides",l,i,o),A=hS(l,i,o),M=Yt("dataFormat",l,i,o).toUpperCase(),$=Yt("dilations",l,i,o),[V,G]=Yt("args",l,i,o);return y&&(G=V,V=void 0),{stride:x,pad:A,dataFormat:M,dilations:$,biasArg:V,preluArg:G,activationFunc:c,leakyreluAlpha:Yt("leakyreluAlpha",l,i,o)}}function OF(l,i,o){return{boxes:Yt("boxes",l,i,o),scores:Yt("scores",l,i,o),maxOutputSize:Yt("maxOutputSize",l,i,o),iouThreshold:Yt("iouThreshold",l,i,o),scoreThreshold:Yt("scoreThreshold",l,i,o),softNmsSigma:Yt("softNmsSigma",l,i,o)}}class kY{get id(){return this.handle.id}constructor(i,o){this.keyDType=i,this.valueDType=o,this.handle=(0,m.scalar)(0),this.tensorMap=new Map,(0,m.keep)(this.handle)}clearAndClose(){this.tensorMap.forEach(i=>i.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return mn.d(this.size(),"int32")}import(i,o){return ce(this,null,function*(){this.checkKeyAndValueTensor(i,o);let u=yield i.data();return this.tensorMap.forEach(c=>c.dispose()),this.tensorMap.clear(),(0,m.tidy)(()=>{let c=(0,m.unstack)(o),f=u.length,y=c.length;m.util.assert(f===y,()=>`The number of elements doesn't match, keys has ${f} elements, the values has ${y} elements.`);for(let w=0;w<f;w++){let C=u[w],T=c[w];(0,m.keep)(T),this.tensorMap.set(C,T)}return this.handle})})}find(i,o){return ce(this,null,function*(){this.checkKeyAndValueTensor(i,o);let u=yield i.data();return(0,m.tidy)(()=>{let c=[];for(let f=0;f<u.length;f++){let y=u[f],w=this.findWithDefault(y,o);c.push(w)}return(0,m.stack)(c)})})}findWithDefault(i,o){let u=this.tensorMap.get(i);return u??o}checkKeyAndValueTensor(i,o){if(i.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${i.dtype}`);if(o.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${o.dtype}`)}}function lp(l,i,o,u,c=m.tidy){let f=((y,w,C)=>{switch(y.category){case"arithmetic":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"BiasAdd":case"AddV2":case"Add":return[$.add(Yt("a",x,A,M),Yt("b",x,A,M))];case"AddN":return[$.addN(Yt("tensors",x,A,M))];case"FloorMod":case"Mod":return[$.mod(Yt("a",x,A,M),Yt("b",x,A,M))];case"Mul":return[$.mul(Yt("a",x,A,M),Yt("b",x,A,M))];case"RealDiv":case"Div":return[$.div(Yt("a",x,A,M),Yt("b",x,A,M))];case"DivNoNan":return[$.divNoNan(Yt("a",x,A,M),Yt("b",x,A,M))];case"FloorDiv":return[$.floorDiv(Yt("a",x,A,M),Yt("b",x,A,M))];case"Sub":return[$.sub(Yt("a",x,A,M),Yt("b",x,A,M))];case"Minimum":return[$.minimum(Yt("a",x,A,M),Yt("b",x,A,M))];case"Maximum":return[$.maximum(Yt("a",x,A,M),Yt("b",x,A,M))];case"Pow":return[$.pow(Yt("a",x,A,M),Yt("b",x,A,M))];case"SquaredDifference":return[$.squaredDifference(Yt("a",x,A,M),Yt("b",x,A,M))];default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"basic_math":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"Abs":case"ComplexAbs":return[$.abs(Yt("x",x,A,M))];case"Acos":return[$.acos(Yt("x",x,A,M))];case"Acosh":return[$.acosh(Yt("x",x,A,M))];case"Asin":return[$.asin(Yt("x",x,A,M))];case"Asinh":return[$.asinh(Yt("x",x,A,M))];case"Atan":return[$.atan(Yt("x",x,A,M))];case"Atan2":return[$.atan2(Yt("x",x,A,M),Yt("y",x,A,M))];case"Atanh":return[$.atanh(Yt("x",x,A,M))];case"Ceil":return[$.ceil(Yt("x",x,A,M))];case"Complex":return[$.complex(Yt("real",x,A,M),Yt("imag",x,A,M))];case"Cos":return[$.cos(Yt("x",x,A,M))];case"Cosh":return[$.cosh(Yt("x",x,A,M))];case"Elu":return[$.elu(Yt("x",x,A,M))];case"Erf":return[$.erf(Yt("x",x,A,M))];case"Exp":return[$.exp(Yt("x",x,A,M))];case"Expm1":return[$.expm1(Yt("x",x,A,M))];case"Floor":return[$.floor(Yt("x",x,A,M))];case"Log":return[$.log(Yt("x",x,A,M))];case"Log1p":return[$.log1p(Yt("x",x,A,M))];case"Imag":return[$.imag(Yt("x",x,A,M))];case"Neg":return[$.neg(Yt("x",x,A,M))];case"Reciprocal":return[$.reciprocal(Yt("x",x,A,M))];case"Real":return[$.real(Yt("x",x,A,M))];case"Relu":return[$.relu(Yt("x",x,A,M))];case"Round":return[$.round(Yt("x",x,A,M))];case"Selu":return[$.selu(Yt("x",x,A,M))];case"Sigmoid":return[$.sigmoid(Yt("x",x,A,M))];case"Sin":return[$.sin(Yt("x",x,A,M))];case"Sign":return[$.sign(Yt("x",x,A,M))];case"Sinh":return[$.sinh(Yt("x",x,A,M))];case"Softplus":return[$.softplus(Yt("x",x,A,M))];case"Sqrt":return[$.sqrt(Yt("x",x,A,M))];case"Square":return[$.square(Yt("x",x,A,M))];case"Tanh":return[$.tanh(Yt("x",x,A,M))];case"Tan":return[$.tan(Yt("x",x,A,M))];case"ClipByValue":return[$.clipByValue(Yt("x",x,A,M),Yt("clipValueMin",x,A,M),Yt("clipValueMax",x,A,M))];case"Relu6":return[$.relu6(Yt("x",x,A,M))];case"Rsqrt":return[$.rsqrt(pl(x.inputNames[0],A,M))];case"LeakyRelu":return[$.leakyRelu(Yt("x",x,A,M),Yt("alpha",x,A,M))];case"Prelu":return[$.prelu(Yt("x",x,A,M),Yt("alpha",x,A,M))];case"IsNan":return[$.isNaN(pl(x.inputNames[0],A,M))];case"IsInf":return[$.isInf(pl(x.inputNames[0],A,M))];case"IsFinite":return[$.isFinite(pl(x.inputNames[0],A,M))];default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"control":return FF(y,w,C);case"convolution":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"Conv1D":{let V=Yt("stride",x,A,M),G=Yt("pad",x,A,M),Q=Yt("dataFormat",x,A,M).toUpperCase(),nt=Yt("dilation",x,A,M);return[$.conv1d(Yt("x",x,A,M),Yt("filter",x,A,M),V,G,Q,nt)]}case"Conv2D":{let V=Yt("strides",x,A,M),G=hS(x,A,M),Q=Yt("dataFormat",x,A,M).toUpperCase(),nt=Yt("dilations",x,A,M);return[$.conv2d(Yt("x",x,A,M),Yt("filter",x,A,M),[V[1],V[2]],G,Q,[nt[1],nt[2]])]}case"_FusedConv2D":{let{stride:V,pad:G,dataFormat:Q,dilations:nt,biasArg:it,preluArg:ht,activationFunc:kt,leakyreluAlpha:Nt}=gS(x,A,M);return[$.fused.conv2d({x:Yt("x",x,A,M),filter:Yt("filter",x,A,M),strides:[V[1],V[2]],pad:G,dataFormat:Q,dilations:[nt[1],nt[2]],bias:it,activation:kt,preluActivationWeights:ht,leakyreluAlpha:Nt})]}case"FusedDepthwiseConv2dNative":{let{stride:V,pad:G,dataFormat:Q,dilations:nt,biasArg:it,preluArg:ht,activationFunc:kt,leakyreluAlpha:Nt}=gS(x,A,M);return[$.fused.depthwiseConv2d({x:Yt("x",x,A,M),filter:Yt("filter",x,A,M),strides:[V[1],V[2]],pad:G,dataFormat:Q,dilations:[nt[1],nt[2]],bias:it,activation:kt,preluActivationWeights:ht,leakyreluAlpha:Nt})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{let V=Yt("outputShape",x,A,M),G=Yt("strides",x,A,M),Q=hS(x,A,M);return[$.conv2dTranspose(Yt("x",x,A,M),Yt("filter",x,A,M),V,[G[1],G[2]],Q)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{let V=Yt("strides",x,A,M),G=hS(x,A,M),Q=Yt("dilations",x,A,M),nt=Yt("dataFormat",x,A,M).toUpperCase();return[$.depthwiseConv2d(Yt("input",x,A,M),Yt("filter",x,A,M),[V[1],V[2]],G,nt,[Q[1],Q[2]])]}case"Conv3D":{let V=Yt("strides",x,A,M),G=Yt("pad",x,A,M),Q=Yt("dataFormat",x,A,M).toUpperCase(),nt=Yt("dilations",x,A,M);return[$.conv3d(Yt("x",x,A,M),Yt("filter",x,A,M),[V[1],V[2],V[3]],G,Q,[nt[1],nt[2],nt[3]])]}case"AvgPool":{let V=Yt("strides",x,A,M),G=Yt("pad",x,A,M),Q=Yt("kernelSize",x,A,M);return[$.avgPool(Yt("x",x,A,M),[Q[1],Q[2]],[V[1],V[2]],G)]}case"MaxPool":{let V=Yt("strides",x,A,M),G=Yt("pad",x,A,M),Q=Yt("kernelSize",x,A,M);return[$.maxPool(Yt("x",x,A,M),[Q[1],Q[2]],[V[1],V[2]],G)]}case"MaxPoolWithArgmax":{let V=Yt("strides",x,A,M),G=Yt("pad",x,A,M),Q=Yt("kernelSize",x,A,M),nt=Yt("includeBatchInIndex",x,A,M),{result:it,indexes:ht}=$.maxPoolWithArgmax(Yt("x",x,A,M),[Q[1],Q[2]],[V[1],V[2]],G,nt);return[it,ht]}case"AvgPool3D":{let V=Yt("strides",x,A,M),G=Yt("pad",x,A,M),Q=Yt("kernelSize",x,A,M);return[$.avgPool3d(Yt("x",x,A,M),[Q[1],Q[2],Q[3]],[V[1],V[2],V[3]],G)]}case"MaxPool3D":{let V=Yt("strides",x,A,M),G=Yt("pad",x,A,M),Q=Yt("kernelSize",x,A,M);return[$.maxPool3d(Yt("x",x,A,M),[Q[1],Q[2],Q[3]],[V[1],V[2],V[3]],G)]}case"Dilation2D":{let V=Yt("strides",x,A,M),G=Yt("pad",x,A,M),Q=Yt("dilations",x,A,M),nt=V[1],it=V[2],ht=Q[1],kt=Q[2];return[$.dilation2d(Yt("x",x,A,M),Yt("filter",x,A,M),[nt,it],G,[ht,kt],"NHWC")]}default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"creation":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"Fill":{let V=Yt("shape",x,A,M),G=Yt("dtype",x,A,M),Q=Yt("value",x,A,M);return[$.fill(V,Q,G)]}case"LinSpace":{let V=Yt("start",x,A,M),G=Yt("stop",x,A,M),Q=Yt("num",x,A,M);return[$.linspace(V,G,Q)]}case"Multinomial":{let V=Yt("logits",x,A,M),G=Yt("numSamples",x,A,M),Q=Yt("seed",x,A,M);return[$.multinomial(V,G,Q)]}case"OneHot":{let V=Yt("indices",x,A,M),G=Yt("depth",x,A,M),Q=Yt("onValue",x,A,M),nt=Yt("offValue",x,A,M),it=Yt("dtype",x,A,M);return[$.oneHot(V,G,Q,nt,it)]}case"Ones":return[$.ones(Yt("shape",x,A,M),Yt("dtype",x,A,M))];case"OnesLike":return[$.onesLike(Yt("x",x,A,M))];case"RandomStandardNormal":return[$.randomStandardNormal(Yt("shape",x,A,M),Yt("dtype",x,A,M),Yt("seed",x,A,M))];case"RandomUniform":return[$.randomUniform(Yt("shape",x,A,M),Yt("minval",x,A,M),Yt("maxval",x,A,M),Yt("dtype",x,A,M))];case"RandomUniformInt":return[$.randomUniformInt(Yt("shape",x,A,M),Yt("minval",x,A,M),Yt("maxval",x,A,M),Yt("seed",x,A,M))];case"Range":{let V=Yt("start",x,A,M),G=Yt("stop",x,A,M),Q=Yt("step",x,A,M);return[$.range(V,G,Q,Yt("dtype",x,A,M))]}case"TruncatedNormal":{let V=Yt("shape",x,A,M),G=Yt("mean",x,A,M),Q=Yt("stdDev",x,A,M),nt=Yt("seed",x,A,M);return[$.truncatedNormal(V,G,Q,Yt("dtype",x,A,M),nt)]}case"Zeros":return[$.zeros(Yt("shape",x,A,M),Yt("dtype",x,A,M))];case"ZerosLike":return[$.zerosLike(Yt("x",x,A,M))];default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"dynamic":return((G,Q,nt,it,...ht)=>ce(this,[G,Q,nt,it,...ht],function*(x,A,M,$,V=vt){switch(x.op){case"NonMaxSuppressionV5":{let{boxes:kt,scores:Nt,maxOutputSize:$t,iouThreshold:Ut,scoreThreshold:Pt,softNmsSigma:re}=OF(x,A,M),ue=yield V.image.nonMaxSuppressionWithScoreAsync(kt,Nt,$t,Ut,Pt,re);return[ue.selectedIndices,ue.selectedScores]}case"NonMaxSuppressionV4":{let{boxes:kt,scores:Nt,maxOutputSize:$t,iouThreshold:Ut,scoreThreshold:Pt}=OF(x,A,M),re=Yt("padToMaxOutputSize",x,A,M),ue=yield V.image.nonMaxSuppressionPaddedAsync(kt,Nt,$t,Ut,Pt,re);return[ue.selectedIndices,ue.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{let{boxes:kt,scores:Nt,maxOutputSize:$t,iouThreshold:Ut,scoreThreshold:Pt}=OF(x,A,M);return[yield V.image.nonMaxSuppressionAsync(kt,Nt,$t,Ut,Pt)]}case"Where":{let kt=V.cast(Yt("condition",x,A,M),"bool"),Nt=[yield V.whereAsync(kt)];return kt.dispose(),Nt}case"ListDiff":return V.setdiff1dAsync(Yt("x",x,A,M),Yt("y",x,A,M));default:throw TypeError(`Node type ${x.op} is not implemented`)}}))(y,w,C);case"evaluation":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"LowerBound":{let V=Yt("sortedSequence",x,A,M),G=Yt("values",x,A,M);return[$.lowerBound(V,G)]}case"TopKV2":{let V=Yt("x",x,A,M),G=Yt("k",x,A,M),Q=Yt("sorted",x,A,M),nt=$.topk(V,G,Q);return[nt.values,nt.indices]}case"UpperBound":{let V=Yt("sortedSequence",x,A,M),G=Yt("values",x,A,M);return[$.upperBound(V,G)]}case"Unique":{let V=Yt("x",x,A,M),G=$.unique(V);return[G.values,G.indices]}case"UniqueV2":{let V=Yt("x",x,A,M),G=Yt("axis",x,A,M),Q=$.unique(V,G);return[Q.values,Q.indices]}default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"image":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"ResizeBilinear":{let V=Yt("images",x,A,M),G=Yt("size",x,A,M),Q=Yt("alignCorners",x,A,M),nt=Yt("halfPixelCenters",x,A,M);return[$.image.resizeBilinear(V,[G[0],G[1]],Q,nt)]}case"ResizeNearestNeighbor":{let V=Yt("images",x,A,M),G=Yt("size",x,A,M),Q=Yt("alignCorners",x,A,M),nt=Yt("halfPixelCenters",x,A,M);return[$.image.resizeNearestNeighbor(V,[G[0],G[1]],Q,nt)]}case"CropAndResize":{let V=Yt("image",x,A,M),G=Yt("boxes",x,A,M),Q=Yt("boxInd",x,A,M),nt=Yt("cropSize",x,A,M),it=Yt("method",x,A,M),ht=Yt("extrapolationValue",x,A,M);return[$.image.cropAndResize(V,G,Q,nt,it,ht)]}case"ImageProjectiveTransformV3":{let V=Yt("images",x,A,M),G=Yt("transforms",x,A,M),Q=Yt("outputShape",x,A,M),nt=Yt("fillValue",x,A,M),it=Yt("interpolation",x,A,M),ht=Yt("fillMode",x,A,M);return[$.image.transform(V,G,it.toLowerCase(),ht.toLowerCase(),nt,Q)]}default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"graph":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"Const":return A[x.name];case"PlaceholderWithDefault":let V=Yt("default",x,A,M);return[pl(x.name,A,M)||V];case"Placeholder":return[pl(x.name,A,M)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[Og(Yt("x",x,A,M))];case"IdentityN":return Yt("x",x,A,M).map(ht=>Og(ht));case"Shape":return[$.tensor1d(Yt("x",x,A,M).shape,"int32")];case"ShapeN":return Yt("x",x,A,M).map(ht=>$.tensor1d(ht.shape));case"Size":return[$.scalar(Yt("x",x,A,M).size,"int32")];case"Rank":return[$.scalar(Yt("x",x,A,M).rank,"int32")];case"NoOp":return[$.scalar(1)];case"Print":let G=Yt("x",x,A,M),Q=Yt("data",x,A,M),nt=Yt("message",x,A,M),it=Yt("summarize",x,A,M);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(nt);for(let ht=0;ht<Q.length;ht++)console.log(Array.prototype.slice.call(Q[ht].dataSync()).slice(0,it));return[G];default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"logical":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"Equal":return[$.equal(Yt("a",x,A,M),Yt("b",x,A,M))];case"NotEqual":return[$.notEqual(Yt("a",x,A,M),Yt("b",x,A,M))];case"Greater":return[$.greater(Yt("a",x,A,M),Yt("b",x,A,M))];case"GreaterEqual":return[$.greaterEqual(Yt("a",x,A,M),Yt("b",x,A,M))];case"Less":return[$.less(Yt("a",x,A,M),Yt("b",x,A,M))];case"LessEqual":return[$.lessEqual(Yt("a",x,A,M),Yt("b",x,A,M))];case"LogicalAnd":return[$.logicalAnd(Yt("a",x,A,M),Yt("b",x,A,M))];case"LogicalNot":return[$.logicalNot(Yt("a",x,A,M))];case"LogicalOr":return[$.logicalOr(Yt("a",x,A,M),Yt("b",x,A,M))];case"Select":case"SelectV2":return[$.where(Yt("condition",x,A,M),Yt("a",x,A,M),Yt("b",x,A,M))];case"BitwiseAnd":return[$.bitwiseAnd(Yt("a",x,A,M),Yt("b",x,A,M))];default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"matrices":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[$.matMul(Yt("a",x,A,M),Yt("b",x,A,M),Yt("transposeA",x,A,M),Yt("transposeB",x,A,M))];case"Einsum":return[$.einsum(Yt("equation",x,A,M),...Yt("tensors",x,A,M))];case"Transpose":return[$.transpose(Yt("x",x,A,M),Yt("perm",x,A,M))];case"_FusedMatMul":let[V,G]=Yt("fusedOps",x,A,M),Q=V==="biasadd",nt=G==="prelu",it=Yt("numArgs",x,A,M),ht=Yt("leakyreluAlpha",x,A,M);if(Q){if(nt&&it!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!nt&&it!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}let[kt,Nt]=Yt("args",x,A,M);return[$.fused.matMul({a:Yt("a",x,A,M),b:Yt("b",x,A,M),transposeA:Yt("transposeA",x,A,M),transposeB:Yt("transposeB",x,A,M),bias:kt,activation:G,preluActivationWeights:Nt,leakyreluAlpha:ht})];case"MatrixBandPart":return[$.linalg.bandPart(Yt("a",x,A,M),Yt("numLower",x,A,M),Yt("numUpper",x,A,M))];default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"normalization":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"EuclideanNorm":return[$.euclideanNorm(Yt("x",x,A,M),Yt("axis",x,A,M),Yt("keepDims",x,A,M))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[$.batchNorm(Yt("x",x,A,M),Yt("mean",x,A,M),Yt("variance",x,A,M),Yt("offset",x,A,M),Yt("scale",x,A,M),Yt("epsilon",x,A,M))];case"LRN":return[$.localResponseNormalization(Yt("x",x,A,M),Yt("radius",x,A,M),Yt("bias",x,A,M),Yt("alpha",x,A,M),Yt("beta",x,A,M))];case"Softmax":return[$.softmax(Yt("x",x,A,M))];case"LogSoftmax":return[$.logSoftmax(Yt("x",x,A,M))];default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"ragged":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"RaggedGather":{let{outputNestedSplits:V,outputDenseValues:G}=$.raggedGather(Yt("paramsNestedSplits",x,A,M),Yt("paramsDenseValues",x,A,M),Yt("indices",x,A,M),Yt("outputRaggedRank",x,A,M));return V.concat(G)}case"RaggedRange":{let{rtNestedSplits:V,rtDenseValues:G}=$.raggedRange(Yt("starts",x,A,M),Yt("limits",x,A,M),Yt("splits",x,A,M));return[V,G]}case"RaggedTensorToTensor":return[$.raggedTensorToTensor(Yt("shape",x,A,M),Yt("values",x,A,M),Yt("defaultValue",x,A,M),Yt("rowPartitionTensors",x,A,M),Yt("rowPartitionTypes",x,A,M))];default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"reduction":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"Max":{let nt=Yt("axis",x,A,M),it=Yt("keepDims",x,A,M);return[$.max(Yt("x",x,A,M),nt,it)]}case"Mean":{let nt=Yt("axis",x,A,M),it=Yt("keepDims",x,A,M);return[$.mean(Yt("x",x,A,M),nt,it)]}case"Min":{let nt=Yt("axis",x,A,M),it=Yt("keepDims",x,A,M);return[$.min(Yt("x",x,A,M),nt,it)]}case"Sum":{let nt=Yt("axis",x,A,M),it=Yt("keepDims",x,A,M);return[$.sum(Yt("x",x,A,M),nt,it)]}case"All":{let nt=Yt("axis",x,A,M),it=Yt("keepDims",x,A,M);return[$.all(Yt("x",x,A,M),nt,it)]}case"Any":{let nt=Yt("axis",x,A,M),it=Yt("keepDims",x,A,M);return[$.any(Yt("x",x,A,M),nt,it)]}case"ArgMax":{let nt=Yt("axis",x,A,M);return[$.argMax(Yt("x",x,A,M),nt)]}case"ArgMin":{let nt=Yt("axis",x,A,M);return[$.argMin(Yt("x",x,A,M),nt)]}case"Prod":{let nt=Yt("axis",x,A,M),it=Yt("keepDims",x,A,M);return[$.prod(Yt("x",x,A,M),nt,it)]}case"Cumprod":{let nt=Yt("axis",x,A,M),it=Yt("exclusive",x,A,M),ht=Yt("reverse",x,A,M);return[$.cumprod(Yt("x",x,A,M),nt,it,ht)]}case"Cumsum":{let nt=Yt("axis",x,A,M),it=Yt("exclusive",x,A,M),ht=Yt("reverse",x,A,M);return[$.cumsum(Yt("x",x,A,M),nt,it,ht)]}case"Bincount":let V=Yt("x",x,A,M),G=Yt("weights",x,A,M),Q=Yt("size",x,A,M);return[$.bincount(V,G,Q)];case"DenseBincount":{let nt=Yt("x",x,A,M),it=Yt("weights",x,A,M),ht=Yt("size",x,A,M),kt=Yt("binaryOutput",x,A,M);return[$.denseBincount(nt,it,ht,kt)]}default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"slice_join":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"ConcatV2":case"Concat":{let V=Yt("n",x,A,M),G=Yt("axis",x,A,M),Q=Yt("tensors",x,A,M);return Q=Q.slice(0,V),[$.concat(Q,G)]}case"Gather":{let V=Yt("x",x,A,M),G=Yt("indices",x,A,M);return[$.gather(V,$.cast(G,"int32"),0)]}case"GatherV2":{let V=Yt("axis",x,A,M),G=Yt("batchDims",x,A,M),Q=Yt("x",x,A,M),nt=Yt("indices",x,A,M);return[$.gather(Q,$.cast(nt,"int32"),V,G)]}case"Reverse":{let V=Yt("dims",x,A,M),G=[];for(let nt=0;nt<V.length;nt++)V[nt]&&G.push(nt);let Q=Yt("x",x,A,M);return[$.reverse(Q,G)]}case"ReverseV2":{let V=Yt("axis",x,A,M),G=Yt("x",x,A,M);return[$.reverse(G,V)]}case"Slice":{let V=Yt("begin",x,A,M),G=Yt("size",x,A,M);return[$.slice(Yt("x",x,A,M),V,G)]}case"StridedSlice":{let V=Yt("begin",x,A,M),G=Yt("end",x,A,M),Q=Yt("strides",x,A,M),nt=Yt("beginMask",x,A,M),it=Yt("endMask",x,A,M),ht=Yt("ellipsisMask",x,A,M),kt=Yt("newAxisMask",x,A,M),Nt=Yt("shrinkAxisMask",x,A,M),$t=Yt("x",x,A,M);return[$.stridedSlice($t,V,G,Q,nt,it,ht,kt,Nt)]}case"Pack":return(0,m.tidy)(()=>{let V=Yt("axis",x,A,M),G=Yt("tensors",x,A,M),Q=G[0].shape,nt=$.squeeze(G[0]).shape,it=G.map(ht=>{let kt=m.util.arraysEqual(ht.shape,Q);if(!kt&&!m.util.arraysEqual($.squeeze(ht).shape,nt))throw new Error("the input tensors shape does not match");return kt?ht:$.reshape(ht,Q)});return[$.stack(it,V)]});case"Unpack":{let V=Yt("axis",x,A,M),G=Yt("tensor",x,A,M);return $.unstack(G,V)}case"Tile":{let V=Yt("reps",x,A,M);return[$.tile(Yt("x",x,A,M),V)]}case"Split":case"SplitV":{let V=Yt("axis",x,A,M),G=Yt("numOrSizeSplits",x,A,M),Q=Yt("x",x,A,M);return $.split(Q,G,V)}case"ScatterNd":{let V=Yt("indices",x,A,M),G=Yt("values",x,A,M),Q=Yt("shape",x,A,M);return[$.scatterND(V,G,Q)]}case"GatherNd":{let V=Yt("x",x,A,M),G=Yt("indices",x,A,M);return[$.gatherND(V,G)]}case"SparseToDense":{let V=Yt("sparseIndices",x,A,M),G=Yt("outputShape",x,A,M),Q=Yt("sparseValues",x,A,M),nt=Yt("defaultValue",x,A,M);return[$.sparseToDense(V,Q,G,Q.dtype===nt.dtype?nt:$.cast(nt,Q.dtype))]}case"TensorScatterUpdate":{let V=Yt("indices",x,A,M),G=Yt("values",x,A,M),Q=Yt("tensor",x,A,M);return[$.tensorScatterUpdate(Q,V,G)]}default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"sparse":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"SparseFillEmptyRows":{let{outputIndices:V,outputValues:G,emptyRowIndicator:Q,reverseIndexMap:nt}=$.sparse.sparseFillEmptyRows(Yt("indices",x,A,M),Yt("values",x,A,M),Yt("denseShape",x,A,M),Yt("defaultValue",x,A,M));return[V,G,Q,nt]}case"SparseReshape":{let{outputIndices:V,outputShape:G}=$.sparse.sparseReshape(Yt("inputIndices",x,A,M),Yt("inputShape",x,A,M),Yt("newShape",x,A,M));return[V,G]}case"SparseSegmentMean":return[$.sparse.sparseSegmentMean(Yt("data",x,A,M),Yt("indices",x,A,M),Yt("segmentIds",x,A,M))];case"SparseSegmentSum":return[$.sparse.sparseSegmentSum(Yt("data",x,A,M),Yt("indices",x,A,M),Yt("segmentIds",x,A,M))];default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"spectral":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"FFT":return[$.fft(Yt("x",x,A,M))];case"IFFT":return[$.ifft(Yt("x",x,A,M))];case"RFFT":return[$.rfft(Yt("x",x,A,M))];case"IRFFT":return[$.irfft(Yt("x",x,A,M))];default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"string":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"StaticRegexReplace":return[$.string.staticRegexReplace(Yt("input",x,A,M),Yt("pattern",x,A,M),Yt("rewrite",x,A,M),Yt("replaceGlobal",x,A,M))];case"StringNGrams":{let{nGrams:V,nGramsSplits:G}=$.string.stringNGrams(Yt("data",x,A,M),Yt("dataSplits",x,A,M),Yt("separator",x,A,M),Yt("nGramWidths",x,A,M),Yt("leftPad",x,A,M),Yt("rightPad",x,A,M),Yt("padWidth",x,A,M),Yt("preserveShortSequences",x,A,M));return[V,G]}case"StringSplit":{let{indices:V,values:G,shape:Q}=$.string.stringSplit(Yt("input",x,A,M),Yt("delimiter",x,A,M),Yt("skipEmpty",x,A,M));return[V,G,Q]}case"StringToHashBucketFast":return[$.string.stringToHashBucketFast(Yt("input",x,A,M),Yt("numBuckets",x,A,M))];default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"transformation":return c(()=>((x,A,M,$=vt)=>{switch(x.op){case"Cast":return[$.cast(Yt("x",x,A,M),Yt("dtype",x,A,M))];case"ExpandDims":{let V=Yt("axis",x,A,M);return[$.expandDims(Yt("x",x,A,M),V)]}case"Squeeze":{let V=Yt("axis",x,A,M);return[$.squeeze(Yt("x",x,A,M),V)]}case"Reshape":return[$.reshape(Yt("x",x,A,M),Yt("shape",x,A,M))];case"EnsureShape":return[$.ensureShape(Yt("x",x,A,M),Yt("shape",x,A,M))];case"MirrorPad":return[$.mirrorPad(Yt("x",x,A,M),Yt("padding",x,A,M),Yt("mode",x,A,M))];case"PadV2":case"Pad":return[$.pad(Yt("x",x,A,M),Yt("padding",x,A,M),Yt("constantValue",x,A,M))];case"SpaceToBatchND":{let V=Yt("blockShape",x,A,M),G=Yt("paddings",x,A,M);return[$.spaceToBatchND(Yt("x",x,A,M),V,G)]}case"BatchToSpaceND":{let V=Yt("blockShape",x,A,M),G=Yt("crops",x,A,M);return[$.batchToSpaceND(Yt("x",x,A,M),V,G)]}case"DepthToSpace":{let V=Yt("blockSize",x,A,M),G=Yt("dataFormat",x,A,M).toUpperCase();return[$.depthToSpace(Yt("x",x,A,M),V,G)]}case"BroadcastTo":return[$.broadcastTo(Yt("x",x,A,M),Yt("shape",x,A,M))];case"BroadcastArgs":return[$.broadcastArgs(Yt("s0",x,A,M),Yt("s1",x,A,M))];default:throw TypeError(`Node type ${x.op} is not implemented`)}})(y,w,C));case"hash_table":return((x,A,M,$)=>ce(this,null,function*(){switch(x.op){case"HashTable":case"HashTableV2":{let V=$.getHashTableHandleByName(x.name);if(V!=null)return[V];{let G=Yt("keyDType",x,A,M),Q=Yt("valueDType",x,A,M),nt=new kY(G,Q);return $.addHashTable(x.name,nt),[nt.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{let V=Yt("tableHandle",x,A,M,$),G=Yt("keys",x,A,M),Q=Yt("values",x,A,M);return[yield $.getHashTableById(V.id).import(G,Q)]}case"LookupTableFind":case"LookupTableFindV2":{let V=Yt("tableHandle",x,A,M,$),G=Yt("keys",x,A,M),Q=Yt("defaultValue",x,A,M);return[yield $.getHashTableById(V.id).find(G,Q)]}case"LookupTableSize":case"LookupTableSizeV2":{let V=Yt("tableHandle",x,A,M,$);return[$.getHashTableById(V.id).tensorSize()]}default:throw TypeError(`Node type ${x.op} is not implemented`)}}))(y,w,C,u);case"custom":let T=b2(y.op);if(T&&T.customExecutor)return T.customExecutor(new Qlt(y,w,C));throw TypeError(`Custom op ${y.op} is not registered.`);default:throw TypeError(`Unknown op '${y.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(l,i,o);return m.util.isPromise(f)?f.then(y=>[].concat(y)):[].concat(f)}class LF{constructor(i={},o={},u={},c={},f){this.weightMap=i,this.tensorArrayMap=o,this.tensorListMap=u,this.functionMap=c,this.parseNodeNameCache=f,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(i,o){return{id:i,frameName:o,iterationId:0}}set currentContext(i){this.contexts!==i&&(this.contexts=i,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){let i=[];for(let o=0;o<this.contexts.length-1;o++){let u=this.contexts.slice(0,this.contexts.length-o);i.push(this.contextIdforContexts(u))}i.push(""),this._currentContextIds=i}contextIdforContexts(i){return i?i.map(o=>o.id===0&&o.iterationId===0?"":`${o.frameName}-${o.iterationId}`).join("/"):""}enterFrame(i){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,i)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;let i=Object.assign({},this.contexts[this.contexts.length-1]);i.iterationId+=1,i.id=this.lastId,this.contexts.splice(-1,1,i),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(i){return this.weightMap[i]}addTensorArray(i){this.tensorArrayMap[i.id]=i}getTensorArray(i){return this.tensorArrayMap[i]}addTensorList(i){this.tensorListMap[i.id]=i}getTensorList(i){return this.tensorListMap[i]}dispose(i){for(let o in this.tensorArrayMap)this.tensorArrayMap[o].clearAndClose(i);for(let o in this.tensorListMap)this.tensorListMap[o].clearAndClose(i)}}function yS(l,i,o,u){let c=new Set,f=[],y=null,w=null,C=new Set,T=new Set(Object.keys(l).map(M=>Jh(M)[0]));u=u||[];let x=new Set(u.map(M=>Jh(M.name)[0])),A=[...i];for(;A.length>0;){let M=A.pop();(Ov(M)||nct(M)||rct(M))&&y==null&&(y=M,w=y.children.map($=>$.name).filter($=>c.has($))),c.add(M.name),o[M.name]==null&&(T.has(M.name)||x.has(M.name)||(M.inputs.length!==0?M.inputs.forEach($=>{C.has($.name)||(C.add($.name),A.push($))}):f.push(M.name)))}return{inputs:l,outputs:i,usedNodes:c,missingInputs:f,dynamicNode:y,syncInputs:w}}function Jlt(l,i){let{usedNodes:o,inputs:u}=i,c=Object.keys(u).map(G=>Jh(G)[0]).map(G=>l.nodes[G]),f=l.initNodes||[],y=G=>o.has(typeof G=="string"?G:G.name);function w(G){return[...new Map(G.map(Q=>[Q.name,Q])).values()]}let C=w([...c,...l.weights,...f]).filter(y),T=w([...C,...Object.values(l.nodes)]).filter(y),x=new Map(T.map(G=>[G.name,G])),A={};for(let G of T){A[G.name]=A[G.name]||0;for(let Q of G.children)y(Q)||(A[Q.name]=Number.POSITIVE_INFINITY),A[Q.name]=(A[Q.name]||0)+1}let M=Object.entries(A).filter(([,G])=>G===0).map(([G])=>G),$=[...M];for(;M.length>0;){let G=M.pop(),Q=x.get(G);for(let nt of Q.children.filter(y))--A[nt.name]==0&&($.push(nt.name),M.push(nt.name))}let V=function(G,Q){let nt=new Map(G.map(Nt=>[Nt.name,Nt])),it=Q.map(Nt=>Nt.name),ht=new Set(it);for(;it.length>0;){let Nt=it.pop(),$t=nt.get(Nt);for(let Ut of $t.children)nt.has(Ut.name)&&!ht.has(Ut.name)&&(ht.add(Ut.name),it.push(Ut.name))}return G.filter(Nt=>ht.has(Nt.name))}($.map(G=>x.get(G)),C);return function(G,Q){let nt=new Map(G.map(($t,Ut)=>[$t.name,Ut])),it=new Set(Q.map($t=>$t.name)),ht=$t=>it.has(typeof $t=="string"?$t:$t.name),kt=new Set(G.map($t=>$t.name)),Nt=$t=>kt.has(typeof $t=="string"?$t:$t.name);for(let $t of G){for(let Ut of $t.children.filter(Nt)){if(!nt.has(Ut.name))throw new vS(`Child ${Ut.name} of node ${$t.name} is unreachable.`);if(nt.get($t.name)>nt.get(Ut.name))throw new vS(`Node ${$t.name} is scheduled to run after its child ${Ut.name}.`)}if(!ht($t))for(let Ut of $t.inputs){if(!nt.has(Ut.name))throw new vS(`Input ${Ut.name} of node ${$t.name} is unreachable.`);if(nt.get(Ut.name)>nt.get($t.name))throw new vS(`Node ${$t.name} is scheduled to run before its input ${Ut.name}.`)}}}(V,C),V}class vS extends Error{constructor(i){super(`NodesExecutionOrderError: ${i}`)}}let tct=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),ect=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),$F=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Ov(l){return tct.has(l.op)}function nct(l){return ect.has(l.op)}function rct(l){return $F.has(l.op)}class HE{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(i){let o=Object.keys(i).map(u=>i[u].map(c=>c.id));this._weightIds=[].concat(...o),this._weightMap=i}set resourceManager(i){this._resourceManager=i}get inputs(){return this._inputs.map(i=>({name:i.name,shape:i.attrParams.shape?i.attrParams.shape.value:void 0,dtype:i.attrParams.dtype?i.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(i=>({name:i.name,shape:i.attrParams.shape?i.attrParams.shape.value:void 0,dtype:i.attrParams.dtype?i.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(i=>i.signatureKey||i.name)}get outputNodes(){return this._outputs.map(i=>{let o=i.signatureKey||i.name;return i.defaultOutput?`${o}:${i.defaultOutput}`:o})}get functions(){return Object.keys(this._functions).reduce((i,o)=>(i[o]=this._functions[o].signature,i),{})}constructor(i,o){this.graph=i,this.parent=o,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=i.outputs,this._inputs=i.inputs,this._initNodes=i.initNodes,this._signature=i.signature,this._functions=i.functions,i.functions!=null&&Object.keys(i.functions).forEach(u=>{this._functionExecutorMap[u]=new HE(i.functions[u],this)})}getCompilationKey(i,o){let u=i.map(f=>f.name).sort(),c=o.map(f=>f.name).sort();return u.join(this.SEPARATOR)+"--"+c.join(this.SEPARATOR)}compile(i,o){let u=yS(i,o,this.weightMap,this._initNodes),{missingInputs:c,dynamicNode:f,syncInputs:y}=u;if(f!=null)throw new Error(`This execution contains the node '${f.name}', which has the dynamic op '${f.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${y}]`);if(c.length>0){let T=o.map(A=>A.name),x=Object.keys(i);throw new Error(`Cannot compute the outputs [${T}] from the provided inputs [${x}]. Missing the following inputs: [${c}]`)}let w=Jlt(this.graph,u),C=function(T){let x=new Map(T.map((Q,nt)=>[Q.name,nt])),A=Number.MAX_SAFE_INTEGER,M=T.map((Q,nt)=>Ov(Q)?A:nt),$=Q=>{let nt=M[x.get(Q.name)];return nt??-1},V=T.map((Q,nt)=>Q.children.map($).reduce((it,ht)=>Math.max(it,ht),M[nt])),G=new Map;for(let Q=0;Q<T.length;++Q){let nt=V[Q];if(nt===A)continue;let it=T[Q],ht=T[nt];G.has(ht.name)||G.set(ht.name,[]),G.get(ht.name).push(it)}return G}(w);return{orderedNodes:w,nodeLiveUntilMap:C}}cloneAndKeepTensor(i){if(i==null)return null;let o=i.clone();return(0,m.keep)(o),o}cloneTensorList(i){return i?i.map(o=>this.cloneAndKeepTensor(o)):null}cloneTensorMap(i){return Object.fromEntries(Object.entries(i).map(([o,u])=>[o,this.cloneTensorList(u)]))}execute(i,o){this.disposeIntermediateTensors(),i=this.mapInputs(i);let u=Object.keys(i).sort();this.checkInputs(i),this.checkInputShapeAndType(i),o=this.mapOutputs(o),this.checkOutputs(o);let c=u.map(M=>this.graph.nodes[Jh(M)[0]]),f=o.map(M=>Jh(M)[0]),y=new Set(f),w=f.map(M=>this.graph.nodes[M]);w.length===0&&(w=this._outputs);let C=this.getCompilationKey(c,w),T=this.compiledMap.get(C);T==null&&(T=this.compile(i,w),this.compiledMap.set(C,T));try{this.keepIntermediateTensors=(0,m.env)().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(M){this.keepIntermediateTensors=!1,console.warn(M.message)}let x={},A={};return(0,m.tidy)(()=>{let M=new LF(this.weightMap,x,A,this.functionExecutorMap,this.parseNodeNameCache),$=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(i).forEach(nt=>{let[it,ht]=Jh(nt,M),kt=[];kt[ht]=i[nt],$[it]=kt,this.keepIntermediateTensors&&(this.clonedTensorsMap[it]=this.cloneTensorList(kt))});let V=this.getFrozenTensorIds($),{orderedNodes:G,nodeLiveUntilMap:Q}=T;for(let nt of G){if($[nt.name])continue;let it=lp(nt,$,M,this._resourceManager);if(m.util.isPromise(it))throw new Error(`The execution of the op '${nt.op}' returned a promise. Please use model.executeAsync() instead.`);$[nt.name]=it,this.keepIntermediateTensors&&(this.clonedTensorsMap[nt.name]=this.cloneTensorList(it)),this.checkTensorForDisposalWithNodeLiveUntilInfo(nt,$,M,V,y,Q.get(nt.name))}return this.parent==null&&M.dispose(V),o.map(nt=>pl(nt,$,M))})}getFrozenTensorIds(i){let o=[].concat.apply([],Object.keys(i).map(u=>i[u]).map(u=>u.map(c=>c.id)));return new Set(o)}checkTensorForDisposal(i,o,u,c,f,y,w){if(!Ov(o)&&!y.has(i)){for(let C of u[i])C!=null&&(w[C.id]=(w[C.id]||0)+o.children.length);for(let C of o.inputs){if(Ov(C))continue;let T=TF(C.name,u,c);if(T!=null)for(let x of T){if(!x||x.kept||f.has(x.id))continue;let A=w[x.id];A===1?(x.dispose(),delete w[x.id]):A!=null&&w[x.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(i,o,u,c,f,y){function w(C){return Ov(C)||f.has(C.name)}if(!Ov(i)&&y!=null)for(let C of y){if(w(C))continue;let T=TF(C.name,o,u);for(let x of T)!x||x.kept||c.has(x.id)||x.dispose()}}executeAsync(i,o){return ce(this,null,function*(){return this._executeAsync(i,o)})}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(i=>{for(let o of i)o&&!o.isDisposed&&o.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}_executeAsync(y,w){return ce(this,arguments,function*(i,o,u=!1,c={},f={}){this.disposeIntermediateTensors(),u||(i=this.mapInputs(i),this.checkInputs(i),this.checkInputShapeAndType(i),o=this.mapOutputs(o),this.checkOutputs(o));try{this.keepIntermediateTensors=(0,m.env)().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(V){this.keepIntermediateTensors=!1,console.warn(V.message)}let C=new LF(this.weightMap,c,f,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));let T=yield this.executeWithControlFlow(i,C,o,u),x=o.map(V=>pl(V,T,C)),A=x.map(V=>V.id),M=Object.keys(i).map(V=>i[V].id),$=new Set([...A,...M,...this.weightIds]);return Object.values(T).forEach(V=>{V.forEach(G=>{!G||G.isDisposed||$.has(G.id)||G.dispose()})}),this.parent==null&&C.dispose($),x})}executeFunctionAsync(i,o,u){return ce(this,null,function*(){let c=i.reduce((f,y,w)=>(f[this.inputs[w].name]=y,f),{});return this._executeAsync(c,this.outputNodes,!0,o,u)})}executeWithControlFlow(i,o,u,c){return ce(this,null,function*(){let f=Object.keys(i),y=f.map(kt=>this.graph.nodes[Jh(kt)[0]]),w=u.map(kt=>Jh(kt)[0]),C=new Set(w),T=w.map(kt=>this.graph.nodes[kt]);T.length===0&&(T=this._outputs);let{usedNodes:x,missingInputs:A,dynamicNode:M,syncInputs:$}=yS(i,T,this.weightMap,this._initNodes),V=[...y,...this.graph.weights,...this._initNodes||[]].map(kt=>({node:kt,contexts:o.currentContext})),G=Object.assign({},this.weightMap);Object.keys(i).forEach(kt=>{let[Nt,$t]=Jh(kt),Ut=[];Ut[$t]=i[kt],G[Nt]=Ut});let Q={},nt=this.getFrozenTensorIds(G),it={};for(;V.length>0;){let kt=this.processStack(y,V,o,G,it,nt,C,Q,x);yield Promise.all(kt)}M!=null||c||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");let ht=T.filter(kt=>!Ov(kt)&&!pl(kt.name,G,o)).map(kt=>kt.name);if(ht.length>0){let kt="";throw M!=null&&(kt=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${$}]`),new Error(`Cannot compute the outputs [${ht}] from the provided inputs [${f}]. Consider providing the following inputs: [${A}]. ${kt}`)}return G})}processStack(i,o,u,c,f,y,w,C,T){let x=[];for(;o.length>0;){let A=o.pop();u.currentContext=A.contexts;let M="";if(A.node.op==="Enter"&&Yt("isConstant",A.node,c,u)&&([M]=ym(A.node.name,u)),c[A.node.name]==null){let $=lp(A.node,c,u,this._resourceManager);M||([M]=ym(A.node.name,u));let V=u.currentContext;m.util.isPromise($)?x.push($.then(G=>(c[M]=G,this.keepIntermediateTensors&&(this.clonedTensorsMap[M]=this.cloneTensorList(G)),u.currentContext=V,this.checkTensorForDisposal(M,A.node,c,u,y,w,C),this.processChildNodes(A.node,o,u,c,f,T),G))):(c[M]=$,this.keepIntermediateTensors&&(this.clonedTensorsMap[M]=this.cloneTensorList($)),this.checkTensorForDisposal(M,A.node,c,u,y,w,C),this.processChildNodes(A.node,o,u,c,f,T))}else this.processChildNodes(A.node,o,u,c,f,T)}return x}processChildNodes(i,o,u,c,f,y){i.children.forEach(w=>{let[C]=ym(w.name,u);!f[C]&&y.has(w.name)&&(w.op==="Merge"?w.inputNames.some(T=>!!pl(T,c,u))&&(f[C]=!0,o.push({contexts:u.currentContext,node:w})):w.inputNames.every(T=>!!pl(T,c,u))&&(f[C]=!0,o.push({contexts:u.currentContext,node:w})))})}dispose(){Object.keys(this.weightMap).forEach(i=>this.weightMap[i].forEach(o=>o.dispose()))}checkInputShapeAndType(i){Object.keys(i).forEach(o=>{let u=i[o],[c]=Jh(o),f=this.graph.nodes[c];if(f.attrParams.shape&&f.attrParams.shape.value){let y=f.attrParams.shape.value,w=y.length===u.shape.length&&u.shape.every((C,T)=>y[T]===-1||y[T]===C);m.util.assert(w,()=>`The shape of dict['${f.name}'] provided in model.execute(dict) must be [${y}], but was [${u.shape}]`)}f.attrParams.dtype&&f.attrParams.dtype.value&&m.util.assert(u.dtype===f.attrParams.dtype.value,()=>`The dtype of dict['${f.name}'] provided in model.execute(dict) must be ${f.attrParams.dtype.value}, but was ${u.dtype}`)})}mapInputs(i){var o,u;let c={};for(let f in i){let y=(u=(o=this._signature)===null||o===void 0?void 0:o.inputs)===null||u===void 0?void 0:u[f];y!=null?c[y.name]=i[f]:c[f]=i[f]}return c}checkInputs(i){let o=Object.keys(i).filter(u=>{let[c]=Jh(u);return this.graph.nodes[c]==null});if(o.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${o}] that are not part of graph`)}mapOutputs(i){return i.map(o=>{var u,c;let f=(c=(u=this._signature)===null||u===void 0?void 0:u.outputs)===null||c===void 0?void 0:c[o];return f!=null?f.name:o},{})}checkOutputs(i){i.forEach(o=>{let[u]=Jh(o);if(!this.graph.nodes[u])throw new Error(`The output '${o}' is not found in the graph`)})}}class YE{constructor(i={},o={}){this.hashTableNameToHandle=i,this.hashTableMap=o}addHashTable(i,o){this.hashTableNameToHandle[i]=o.handle,this.hashTableMap[o.id]=o}getHashTableHandleByName(i){return this.hashTableNameToHandle[i]}getHashTableById(i){return this.hashTableMap[i]}dispose(){for(let i in this.hashTableMap)this.hashTableMap[i].clearAndClose(),delete this.hashTableMap[i];for(let i in this.hashTableNameToHandle)this.hashTableNameToHandle[i].dispose(),delete this.hashTableNameToHandle[i]}}var zF=F(7084);let PF="?tfjs-format=file",bS="model.json";class BF{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(i,o={},u=m.io){this.modelUrl=i,this.loadOptions=o,this.version="n/a",this.io=u,o==null&&(this.loadOptions={}),this.resourceManager=new YE}findIOHandler(){let i=this.modelUrl;if(i.load!=null)this.handler=i;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(i,this.loadOptions);else{let o=this.io.getLoadHandlers(i,this.loadOptions);if(o.length===0)o.push(this.io.browserHTTPRequest(i,this.loadOptions));else if(o.length>1)throw new Error(`Found more than one (${o.length}) load handlers for URL '${[i]}'`);this.handler=o[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let i=this.handler.load();return m.util.isPromise(i)?i.then(o=>o.getWeightStream==null?this.loadSync(o):this.loadStreaming(o)):this.loadSync(i)}loadSync(i){let o=this.io.decodeWeights(i.weightData,i.weightSpecs);return this.loadWithWeightMap(i,o)}loadStreaming(i){return ce(this,null,function*(){if(i.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");let o=yield(0,zF.s5)(i.getWeightStream(),i.weightSpecs);return this.loadWithWeightMap(i,o)})}loadWithWeightMap(i,o){this.artifacts=i;let u=this.artifacts.modelTopology,c=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){let f=this.artifacts.userDefinedMetadata;f.signature!=null&&(c=f.signature),f.structuredOutputKeys!=null&&(this.structuredOutputKeys=f.structuredOutputKeys)}if(this.signature=c,this.version=`${u.versions.producer}.${u.versions.minConsumer}`,this.executor=new HE(dS.Instance.transformGraph(u,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(o),this.executor.resourceManager=this.resourceManager,i.modelInitializer!=null&&i.modelInitializer.node!=null){let f=dS.Instance.transformGraph(i.modelInitializer);this.initializer=new HE(f),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=i.initializerSignature}return!0}save(i,o){return ce(this,null,function*(){if(typeof i=="string"){let u=this.io.getSaveHandlers(i);if(u.length===0)throw new Error(`Cannot find any save handlers for URL '${i}'`);if(u.length>1)throw new Error(`Found more than one (${u.length}) save handlers for URL '${i}'`);i=u[0]}if(i.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return i.save(this.artifacts)})}addStructuredOutputNames(i){if(this.structuredOutputKeys){let o=i instanceof m.Tensor?[i]:i,u={};return o.forEach((c,f)=>u[this.structuredOutputKeys[f]]=c),u}return i}predict(i,o){let u=this.execute(i,this.outputNodes);return this.addStructuredOutputNames(u)}predictAsync(i,o){return ce(this,null,function*(){let u=yield this.executeAsync(i,this.outputNodes);return this.addStructuredOutputNames(u)})}normalizeInputs(i){var o;if(!(i instanceof m.Tensor||Array.isArray(i))){let f=(o=this.signature)===null||o===void 0?void 0:o.inputs;if(f!=null)for(let y in f){let w=f[y];w.resourceId!=null&&(i[y]=this.resourceIdToCapturedInput[w.resourceId])}return i}i=Array.isArray(i)?i:[i];let u=Object.keys(this.resourceIdToCapturedInput).length;if(i.length+u!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-u} non-resource placeholders, while there are ${i.length} input tensors provided.`);let c=0;return this.inputNodes.reduce((f,y)=>{var w,C,T;let x=(T=(C=(w=this.signature)===null||w===void 0?void 0:w.inputs)===null||C===void 0?void 0:C[y])===null||T===void 0?void 0:T.resourceId;return f[y]=x!=null?this.resourceIdToCapturedInput[x]:i[c++],f},{})}normalizeOutputs(i){return i=i||this.outputNodes,Array.isArray(i)?i:[i]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}executeInitializerGraphAsync(){return ce(this,null,function*(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))})}setResourceIdToCapturedInput(i){if(this.resourceIdToCapturedInput={},this.initializerSignature){let o=this.initializerSignature.outputs,u=Object.keys(o);for(let c=0;c<u.length;c++){let f=o[u[c]];this.resourceIdToCapturedInput[f.resourceId]=i[c]}}}execute(i,o){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),i=this.normalizeInputs(i),o=this.normalizeOutputs(o);let u=this.executor.execute(i,o);return u.length>1?u:u[0]}executeAsync(i,o){return ce(this,null,function*(){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(yield this.executeInitializerGraphAsync()),i=this.normalizeInputs(i),o=this.normalizeOutputs(o);let u=yield this.executor.executeAsync(i,o);return u.length>1?u:u[0]})}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(i){return Object.keys(i).reduce((o,u)=>(o[u]=[i[u]],o),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&(0,m.dispose)(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}function Vc(u){return ce(this,arguments,function*(l,i={},o=m.io){if(l==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");i==null&&(i={}),i.fromTFHub&&typeof l=="string"&&(l=function(f){return f.endsWith("/")||(f+="/"),`${f}${bS}${PF}`}(l));let c=new BF(l,i,o);return yield c.load(),c})}function ict(l){if(l==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let i;if(l instanceof Array){let[u,c]=l;if(!u)throw new Error("modelJSON must be the first element of the array");if(!(c&&c instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in u))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in u))throw new Error("Model JSON is missing 'weightsManifest'");let f=m.io.getWeightSpecs(u.weightsManifest),y=m.io.getModelArtifactsForJSONSync(u,f,c);i=m.io.fromMemorySync(y)}else if("load"in l)i=l;else{if(!("modelTopology"in l&&"weightSpecs"in l&&"weightData"in l))throw new Error("Unknown model format");i=m.io.fromMemorySync(l)}let o=new BF(i);return o.load(),o}let jF="4.22.0";var Lv,jw,Uw=F(7391);function Ww(l,i,o=new Map,u=new Set){if(l==null)return null;if(typeof Blob=="function"&&l instanceof Blob)return l.slice();if(u.has(l))throw new Error("Circular references are not supported.");if(o.has(l))return o.get(l);let c=i(l);if(c.recurse&&c.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(c.recurse){if(g0(l)){let f=Array.isArray(l)?[]:{};u.add(l);for(let y in l){let w=Ww(l[y],i,o,u);f[y]=w}return u.delete(l),l.__proto__&&(f.__proto__=l.__proto__),f}throw new Error(`Can't recurse into non-iterable type: ${l}`)}return o.set(l,c.value),c.value}function SY(l,i=Gw){return Vw(l,i)}function Vw(l,i,o=new Set){let u=l[0];if(o.has(u))throw new Error("Circular references are not supported.");let c=i(l);if(c.recurse&&c.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(c.recurse){if(g0(u)){let f=Array.isArray(u)?[]:{};o.add(u);for(let y in u){let w=Vw(l.map(C=>C[y]),i,o);f[y]=w}return o.delete(u),f}throw new Error(`Can't recurse into non-iterable type: ${u}`)}return c.value}function Gw(l){return l===null?null:g0(l[0])?{value:null,recurse:!0}:{value:l,recurse:!1}}function wS(l,i){return ce(this,null,function*(){let o=new Map;Ww(l,i,o);for(let u of Array.from(o.keys())){let c=o.get(u);if(m.util.isPromise(c)){let f=yield c;o.set(u,f)}}return Ww(l,i,o)})}function g0(l){let i=!1;if(m.env().get("IS_BROWSER"))i=l instanceof TextDecoder;else{let{StringDecoder:o}=F(551);i=l instanceof o}return l!=null&&!ArrayBuffer.isView(l)&&(Array.isArray(l)||typeof l=="object"&&!(l instanceof m.Tensor)&&!(l instanceof Promise)&&!i)}function xS(l){return Ww(l,vm)}function vm(l){return l instanceof m.Tensor?{value:l.clone(),recurse:!1}:g0(l)?{value:null,recurse:!0}:{value:l,recurse:!1}}class _Y{constructor(i){if(this.capacity=i,this.begin=0,this.end=0,i==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(i<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(i),this.doubledCapacity=2*i}wrap(i){for(;i<0;)i+=this.doubledCapacity;return i%this.doubledCapacity}get(i){if(i<0)throw new RangeError("Can't get item at a negative index.");return this.data[i%this.capacity]}set(i,o){if(i<0)throw new RangeError("Can't set item at a negative index.");this.data[i%this.capacity]=o}length(){let i=this.end-this.begin;return i<0&&(i=this.doubledCapacity+i),i}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(i){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,i),this.end=this.wrap(this.end+1)}pushAll(i){for(let o of i)this.push(o)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);let i=this.get(this.end);return this.set(this.end,void 0),i}unshift(i){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,i)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let i=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),i}shuffleExcise(i){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let o=this.wrap(this.begin+i),u=this.get(o);return this.set(o,this.pop()),u}}class qE extends _Y{constructor(){super(qE.INITIAL_CAPACITY)}isFull(){return!1}push(i){super.isFull()&&this.expand(),super.push(i)}unshift(i){super.isFull()&&this.expand(),super.unshift(i)}expand(){let i=2*this.capacity,o=new Array(i),u=this.length();for(let c=0;c<u;c++)o[c]=this.get(this.wrap(this.begin+c));this.data=o,this.capacity=i,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=u}}function CY(l){return new oct(l)}function UF(l){return new EY(l)}function act(l,i){return new x2(l,i)}qE.INITIAL_CAPACITY=32;class Yl{toArray(){return ce(this,null,function*(){let i=[],o=yield this.next();for(;!o.done;)i.push(o.value),o=yield this.next();return i})}toArrayForTest(){return ce(this,null,function*(){let i=this.prefetch(100),o=[],u=yield i.next();for(;!u.done;)o.push(u.value),u=yield i.next();return o})}resolveFully(){return ce(this,null,function*(){let i=yield this.next();for(;!i.done;)i=yield this.next()})}resolveWhile(i){return ce(this,null,function*(){let o=yield this.next(),u=i(o.value);for(;!o.done&&u;)o=yield this.next(),u=i(o.value)})}handleErrors(i){return new Rd(this,i)}filter(i){return new XE(this,i)}map(i){return new WF(this,i)}mapAsync(i){return new VF(this,i)}serialMapAsync(i){return new VF(this,i).serial()}flatmap(i){return new ZE(this,i)}forEachAsync(i){return ce(this,null,function*(){return this.map(i).resolveFully()})}serialForEach(i){return ce(this,null,function*(){return this.serialMapAsync(i).resolveWhile(o=>o===!0)})}rowMajorBatch(i,o=!0){return new IY(this,i,o)}columnMajorBatch(i,o=!0,u=Gw){return this.rowMajorBatch(i,o).map(c=>SY(c,u))}concatenate(i,o){return new x2(CY([this,i]),o)}take(i){return i<0||i==null?this:new kS(this,i)}skip(i){return i<0||i==null?this:new AY(this,i)}prefetch(i){return new GF(this,i)}shuffle(i,o){return new NY(this,i,o)}serial(){return new TY(this)}}class oct extends Yl{constructor(i){super(),this.items=i,this.trav=0}summary(){return`Array of ${this.items.length} items`}next(){return ce(this,null,function*(){if(this.trav>=this.items.length)return{value:null,done:!0};let i=this.items[this.trav];return this.trav++,{value:xS(i),done:!1}})}}class EY extends Yl{constructor(i){super(),this.nextFn=i}summary(){return"Function call"}next(){return ce(this,null,function*(){try{return this.nextFn()}catch(i){throw i.message=`Error thrown while iterating through a dataset: ${i.message}`,i}})}}class TY extends Yl{constructor(i){super(),this.upstream=i,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}next(){return ce(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return ce(this,null,function*(){return this.upstream.next()})}}class AY extends Yl{constructor(i,o){super(),this.upstream=i,this.maxCount=o,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}next(){return ce(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return ce(this,null,function*(){for(;this.count++<this.maxCount;){let i=yield this.upstream.next();if(i.done)return i;m.dispose(i.value)}return this.upstream.next()})}}class kS extends Yl{constructor(i,o){super(),this.upstream=i,this.maxCount=o,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}next(){return ce(this,null,function*(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()})}}class IY extends Yl{constructor(i,o,u=!0){super(),this.upstream=i,this.batchSize=o,this.enableSmallLastBatch=u,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}next(){return ce(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return ce(this,null,function*(){let i=[];for(;i.length<this.batchSize;){let o=yield this.upstream.next();if(o.done)return this.enableSmallLastBatch&&i.length>0?{value:i,done:!1}:{value:null,done:!0};i.push(o.value)}return{value:i,done:!1}})}}class XE extends Yl{constructor(i,o){super(),this.upstream=i,this.predicate=o,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}next(){return ce(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return ce(this,null,function*(){for(;;){let i=yield this.upstream.next();if(i.done||this.predicate(i.value))return i;m.dispose(i.value)}})}}class WF extends Yl{constructor(i,o){super(),this.upstream=i,this.transform=o}summary(){return`${this.upstream.summary()} -> Map`}next(){return ce(this,null,function*(){let i=yield this.upstream.next();if(i.done)return{value:null,done:!0};let o=m.tensor_util.getTensorsInContainer(i.value),u=this.transform(i.value),c=m.tensor_util.getTensorsInContainer(u);for(let f of o)m.tensor_util.isTensorInList(f,c)||f.dispose();return{value:u,done:!1}})}}class Rd extends Yl{constructor(i,o){super(),this.upstream=i,this.handler=o,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}next(){return ce(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return ce(this,null,function*(){for(;;)try{return yield this.upstream.next()}catch(i){if(!this.handler(i))return{value:null,done:!0}}})}}class VF extends Yl{constructor(i,o){super(),this.upstream=i,this.transform=o}summary(){return`${this.upstream.summary()} -> AsyncMap`}next(){return ce(this,null,function*(){let i=yield this.upstream.next();if(i.done)return{value:null,done:!0};let o=m.tensor_util.getTensorsInContainer(i.value),u=yield this.transform(i.value),c=m.tensor_util.getTensorsInContainer(u);for(let f of o)m.tensor_util.isTensorInList(f,c)||f.dispose();return{value:u,done:!1}})}}class KE extends Yl{constructor(){super(),this.outputQueue=new qE,this.lastRead=Promise.resolve({value:null,done:!1})}next(){return ce(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return ce(this,null,function*(){for(;this.outputQueue.length()===0;)if(!(yield this.pump()))return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}})}}class ZE extends KE{constructor(i,o){super(),this.upstream=i,this.transform=o}summary(){return`${this.upstream.summary()} -> Flatmap`}pump(){return ce(this,null,function*(){let i=yield this.upstream.next();if(i.done)return!1;let o=m.tensor_util.getTensorsInContainer(i.value),u=this.transform(i.value),c=m.tensor_util.getTensorsInContainer(u);this.outputQueue.pushAll(u);for(let f of o)m.tensor_util.isTensorInList(f,c)||f.dispose();return!0})}}class x2 extends Yl{constructor(i,o){super(),this.baseErrorHandler=o,this.lastRead=null,this.iterator=null,this.moreIterators=i}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}next(){return ce(this,null,function*(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead})}readFromChain(i){return ce(this,null,function*(){if(yield i,this.iterator==null){let u=yield this.moreIterators.next();if(u.done)return{value:null,done:!0};this.iterator=u.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}let o=yield this.iterator.next();return o.done?(this.iterator=null,this.readFromChain(i)):o})}}(jw=Lv||(Lv={}))[jw.FAIL=0]="FAIL",jw[jw.SHORTEST=1]="SHORTEST",jw[jw.LONGEST=2]="LONGEST";class $v extends Yl{constructor(i,o=Lv.FAIL){super(),this.iterators=i,this.mismatchMode=o,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}nextState(i){return ce(this,null,function*(){yield i;let o=0,u=0,c=yield wS(this.iterators,function(f){return f instanceof Yl?{value:f.next().then(y=>(o++,y.done&&u++,y.value)),recurse:!1}:{value:null,recurse:!0}});if(o===u)return{value:null,done:!0};if(u>0)switch(this.mismatchMode){case Lv.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case Lv.SHORTEST:return{value:null,done:!0}}return this.count++,{value:c,done:!1}})}next(){return ce(this,null,function*(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise})}}class GF extends Yl{constructor(i,o){super(),this.upstream=i,this.bufferSize=o,this.buffer=new _Y(o)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){let i=this.upstream.next();this.buffer.push(i)}}next(){return this.refill(),this.buffer.shift()}}class NY extends GF{constructor(i,o,u){super(i,o),this.upstream=i,this.windowSize=o,this.upstreamExhausted=!1,this.random=Uw.alea(u||m.util.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}next(){return ce(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}randomInt(i){return Math.floor(this.random()*i)}chooseIndex(){return this.randomInt(this.buffer.length())}serialNext(){return ce(this,null,function*(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){let i=this.chooseIndex(),o=yield this.buffer.shuffleExcise(i);if(!o.done)return this.refill(),o;this.upstreamExhausted=!0}return{value:null,done:!0}})}}class vh{constructor(){this.size=null}batch(i,o=!0){let u=this,c;return m.util.assert(i>0,()=>`batchSize needs to be positive, but it is
      ${i}`),c=this.size===1/0||this.size==null?this.size:o?Math.ceil(this.size/i):Math.floor(this.size/i),td(()=>ce(this,null,function*(){return(yield u.iterator()).columnMajorBatch(i,o,HF)}),c)}concatenate(i){let o=this,u;return u=this.size===1/0||i.size===1/0?1/0:this.size!=null&&i.size!=null?this.size+i.size:null,td(()=>ce(this,null,function*(){return(yield o.iterator()).concatenate(yield i.iterator())}),u)}filter(i){let o=this,u;return u=this.size===1/0?1/0:null,td(()=>ce(this,null,function*(){return(yield o.iterator()).filter(c=>m.tidy(()=>i(c)))}),u)}forEachAsync(i){return ce(this,null,function*(){return(yield this.iterator()).forEachAsync(i)})}map(i){let o=this;return td(()=>ce(this,null,function*(){return(yield o.iterator()).map(u=>m.tidy(()=>i(u)))}),this.size)}mapAsync(i){let o=this;return td(()=>ce(this,null,function*(){return(yield o.iterator()).mapAsync(i)}),this.size)}prefetch(i){if(i==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");let o=this;return td(()=>ce(this,null,function*(){return(yield o.iterator()).prefetch(i)}),this.size)}repeat(i){let o=this,u;return u=this.size!=null&&i>0?this.size*i:i===0?0:this.size!=null&&(i===void 0||i<0)?1/0:null,td(()=>ce(this,null,function*(){return act(UF(()=>ce(this,null,function*(){return{value:yield o.iterator(),done:!1}})).take(i))}),u)}skip(i){let o=this,u;return u=this.size!=null&&i>=0&&this.size>=i?this.size-i:this.size!=null&&(this.size<i||i===void 0||i<0)?0:null,td(()=>ce(this,null,function*(){return(yield o.iterator()).skip(i)}),u)}shuffle(i,o,u=!0){if(i==null||i<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);let c=this,f=Uw.alea(o||m.util.now().toString());return td(()=>ce(this,null,function*(){let y=f.int32();return u&&(y+=f.int32()),(yield c.iterator()).shuffle(i,y.toString())}),this.size)}take(i){let o=this,u;return u=this.size!=null&&this.size>i?i:this.size!=null&&this.size<=i?this.size:null,td(()=>ce(this,null,function*(){return(yield o.iterator()).take(i)}),u)}toArray(){return ce(this,null,function*(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(yield this.iterator()).toArray()})}toArrayForTest(){return ce(this,null,function*(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(yield this.iterator()).toArrayForTest()})}}function td(l,i=null){return new class extends vh{constructor(){super(...arguments),this.size=i}iterator(){return ce(this,null,function*(){return l()})}}}function k2(l){return td(()=>ce(this,null,function*(){return CY(l)}),l.length)}function SS(l){if(!g0(l))throw new Error("The argument to zip() must be an object or array.");let i;if(Array.isArray(l))for(let o=0;o<l.length;o++)i=i==null?l[o].size:Math.min(i,l[o].size);else if(l instanceof Object)for(let o in l)i=i==null?l[o].size:Math.min(i,l[o].size);return td(()=>ce(this,null,function*(){return function(o,u=Lv.FAIL){return new $v(o,u)}(yield wS(l,o=>{if(o instanceof vh)return{value:o.iterator(),recurse:!1};if(g0(o))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")}),Lv.SHORTEST)}),i)}function HF(l){if(l===null)return null;if((o=l[0])==null||(u=o)===null||typeof u!="object"&&typeof u!="function"||Array.isArray(o)||typeof o=="object"&&o instanceof m.Tensor||m.util.isTypedArray(o))return{value:function(c){if(c.length===0)throw new Error("Can't make a batch of zero elements.");return c[0]instanceof m.Tensor?m.stack(c):m.tensor(c)}(l),recurse:!1};var o,u;return{value:null,recurse:!0}}vh.MAX_BUFFER_SIZE=1e4;class MY extends vh{constructor(i){super(),this.input=i}iterator(){return ce(this,null,function*(){return(yield this.input.iterator()).decodeUTF8().split(`
`).map(i=>(i.endsWith("\r")&&(i=i.slice(0,-1)),i))})}}let QE='"',Hw=Symbol("out"),YF=Symbol("field"),JE=Symbol("quote"),qF=Symbol("quoteafterquote"),_S=Symbol("quoteinquote");class DY extends vh{columnNames(){return ce(this,null,function*(){return this.columnNamesValidated||(yield this.setColumnNames()),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames})}setColumnNames(){return ce(this,null,function*(){let i=yield this.maybeReadHeaderLine();if(!this.fullColumnNames&&!i)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&i&&m.util.assert(i.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+i.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=i);let o=this.fullColumnNames.reduce((c,f)=>(c[f]=c[f]+1||1,c),{}),u=Object.keys(o).filter(c=>o[c]>1);if(m.util.assert(u.length===0,()=>"Duplicate column names found: "+u.toString()),this.columnConfigs){for(let c of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(c)===-1)throw new Error('The key "'+c+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0})}maybeReadHeaderLine(){return ce(this,null,function*(){if(this.hasHeader){let i=yield this.base.iterator(),o=yield i.next();if(o.done)throw new Error("No data was found for CSV parsing.");let u=o.value;return this.parseRow(u,!1)}return null})}constructor(i,o){super(),this.input=i,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new MY(i),o||(o={}),this.hasHeader=o.hasHeader!==!1,this.fullColumnNames=o.columnNames,this.columnConfigs=o.columnConfigs,this.configuredColumnsOnly=o.configuredColumnsOnly,o.delimWhitespace?(m.util.assert(o.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=o.delimiter?o.delimiter:","}iterator(){return ce(this,null,function*(){this.columnNamesValidated||(yield this.setColumnNames());let i=yield this.base.iterator();return this.hasHeader&&(i=i.skip(1)),i.map(o=>this.makeDataElement(o))})}makeDataElement(i){let o=this.parseRow(i),u={},c={};for(let f=0;f<this.fullColumnNames.length;f++){let y=this.fullColumnNames[f],w=this.columnConfigs?this.columnConfigs[y]:null;if(!this.configuredColumnsOnly||w){let C=o[f],T=null;if(C==="")if(w&&w.default!==void 0)T=w.default;else{if(w&&(w.required||w.isLabel))throw new Error(`Required column ${y} is empty in this line: ${i}`);T=void 0}else{let x=Number(C);if(isNaN(x))T=w&&w.dtype==="bool"?this.getBoolean(C):C;else if(w&&w.dtype)switch(w.dtype){case"float32":default:T=x;break;case"int32":T=Math.floor(x);break;case"bool":T=this.getBoolean(C)}else T=x}w&&w.isLabel?c[y]=T:u[y]=T}}return Object.keys(c).length===0?u:{xs:u,ys:c}}getBoolean(i){return i==="1"||i.toLowerCase()==="true"?1:0}parseRow(i,o=!0){let u=[],c=0,f=i.length,y=Hw;for(let w=0;w<f;w++)switch(y){case Hw:switch(i.charAt(w)){case QE:c=w+1,y=JE;break;case this.delimiter:if(c=w+1,this.delimiter===" "&&this.delimWhitespace)break;u.push(""),y=Hw;break;default:y=YF,c=w}break;case YF:i.charAt(w)===this.delimiter&&(u.push(i.substring(c,w)),y=Hw,c=w+1);break;case JE:i.charAt(w)===QE&&(y=qF);break;case qF:switch(i.charAt(w)){case this.delimiter:u.push(i.substring(c,w-1)),y=Hw,c=w+1;break;case QE:y=JE;break;default:y=_S}break;case _S:i.charAt(w)===QE&&(y=JE)}if(y===qF?u.push(i.substring(c,f-1)):u.push(i.substring(c)),o&&u.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${u}`);return u}}class CS extends Yl{constructor(i){super(),this.microphoneConfig=i,this.isClosed=!1,this.fftSize=i.fftSize||1024;let o=Math.log2(this.fftSize);if(this.fftSize<0||o<4||o>14||!Number.isInteger(o))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=i.numFramesPerSpectrogram||43,this.sampleRateHz=i.sampleRateHz,this.columnTruncateLength=i.columnTruncateLength||this.fftSize,this.audioTrackConstraints=i.audioTrackConstraints,this.smoothingTimeConstant=i.smoothingTimeConstant||0,this.includeSpectrogram=i.includeSpectrogram!==!1,this.includeWaveform=i.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static create(){return ce(this,arguments,function*(i={}){if(!(0,m.env)().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");let o=new CS(i);return yield o.start(),o})}start(){return ce(this,null,function*(){try{this.stream=yield navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null||this.audioTrackConstraints,video:!1})}catch(u){throw new Error(`Error thrown while initializing video stream: ${u.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");let i=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new i,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`)}else this.sampleRateHz=this.audioContext.sampleRate;let o=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,o.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)})}next(){return ce(this,null,function*(){if(this.isClosed)return{value:null,done:!0};let i,o,u=yield this.getAudioData();if(this.includeSpectrogram){let c=this.flattenQueue(u.freqDataQueue);i=this.getTensorFromAudioDataArray(c,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){let c=this.flattenQueue(u.timeDataQueue);o=this.getTensorFromAudioDataArray(c,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:i,waveform:o},done:!1}})}capture(){return ce(this,null,function*(){return(yield this.next()).value})}getAudioData(){return ce(this,null,function*(){let i=[],o=[],u=0;return new Promise(c=>{let f=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&c({freqDataQueue:i,timeDataQueue:o}),i.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),o.push(this.timeData.slice())),++u===this.numFrames&&(clearInterval(f),c({freqDataQueue:i,timeDataQueue:o}))},this.fftSize/this.sampleRateHz*1e3)})})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(i){let o=i[0].length,u=new Float32Array(i.length*o);return i.forEach((c,f)=>u.set(c,f*o)),u}getTensorFromAudioDataArray(i,o){let u=new Float32Array(m.util.sizeFromShape(o));return u.set(i,u.length-i.length),(0,m.tensor)(u,o)}}class ES extends Yl{constructor(i,o){if(super(),this.webcamVideoElement=i,this.webcamConfig=o,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=(0,m.tensor1d)([0],"int32"),this.webcamConfig.centerCrop){let u=1*this.webcamConfig.resizeWidth/this.webcamVideoElement.width,c=1*this.webcamConfig.resizeHeight/this.webcamVideoElement.height,f=(1-u)/2,y=(1-c)/2,w=f+u,C=c+y;this.cropBox=(0,m.tensor2d)([y,f,C,w],[1,4])}else this.cropBox=(0,m.tensor2d)([0,0,1,1],[1,4])}summary(){return"webcam"}static create(u){return ce(this,arguments,function*(i,o={}){if(!(0,m.env)().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!i){if(i=document.createElement("video"),!o.resizeWidth||!o.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");i.width=o.resizeWidth,i.height=o.resizeHeight}let c=new ES(i,o);return yield c.start(),c})}start(){return ce(this,null,function*(){this.webcamConfig.facingMode&&m.util.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=yield navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(i){throw i.message=`Error thrown while initializing video stream: ${i.message}`,i}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(i){console.log(i),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(i=>{this.webcamVideoElement.onloadedmetadata=()=>{i()}})})}next(){return ce(this,null,function*(){if(this.isClosed)return{value:null,done:!0};let i;try{i=m.browser.fromPixels(this.webcamVideoElement)}catch(o){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(o)}`)}if(!this.resize)return{value:i,done:!1};try{return{value:this.cropAndResizeFrame(i),done:!1}}catch(o){throw new Error(`Error thrown cropping the video: ${o.message}`)}finally{i.dispose()}})}needToResize(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)}cropAndResizeFrame(i){return(0,m.tidy)(()=>{let o=(0,m.expandDims)((0,m.cast)(i,"float32"),0),u;u=m.image.cropAndResize(o,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");let c=u.shape;return(0,m.reshape)(u,c.slice(1))})}capture(){return ce(this,null,function*(){return(yield this.next()).value})}stop(){this.stream.getTracks().forEach(i=>i.stop());try{this.webcamVideoElement.srcObject=null}catch(i){console.log(i),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}class RY{}class FY extends Yl{split(i){return new Yw(this,i)}}class Yw extends FY{constructor(i,o){super(),this.upstream=i,this.impl=new XF(i,o)}summary(){return this.impl.summary()}next(){return ce(this,null,function*(){return this.impl.next()})}}class XF extends KE{constructor(i,o){super(),this.upstream=i,this.separator=o,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}pump(){return ce(this,null,function*(){let i=yield this.upstream.next();if(i.done)return this.carryover!==""&&(this.outputQueue.push(this.carryover),this.carryover="",!0);let o=i.value.split(this.separator);o[0]=this.carryover+o[0];for(let u of o.slice(0,-1))this.outputQueue.push(u);return this.carryover=o[o.length-1],!0})}}class KF extends Yl{decodeUTF8(){return new OY(this)}}class OY extends FY{constructor(i){super(),this.upstream=i,this.impl=new Fd(i)}summary(){return this.impl.summary()}next(){return ce(this,null,function*(){return this.impl.next()})}}class Fd extends KE{constructor(i){if(super(),this.upstream=i,(0,m.env)().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{let{StringDecoder:o}=F(4530);this.decoder=new o("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}pump(){return ce(this,null,function*(){let i=yield this.upstream.next(),o,u;return!i.done&&(o=i.value,u=(0,m.env)().get("IS_BROWSER")?this.decoder.decode(o,{stream:!0}):this.decoder.write(Un.from(o.buffer)),this.outputQueue.push(u),!0)})}}class tT extends KF{constructor(i,o={}){super(),this.file=i,this.options=o,m.util.assert(i instanceof Uint8Array||!!(0,m.env)().get("IS_BROWSER")&&(i instanceof File||i instanceof Blob),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=o.offset||0,this.chunkSize=o.chunkSize||1048576}summary(){return`FileChunks ${this.file}`}next(){return ce(this,null,function*(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:yield new Promise((o,u)=>{let c=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)o(new Uint8Array(this.file.slice(this.offset,c)));else{let f=new FileReader;f.onload=w=>{let C=f.result;if(C instanceof ArrayBuffer&&(C=new Uint8Array(C)),!(C instanceof Uint8Array))return u(new TypeError("FileReader returned unknown type."));o(C)},f.onabort=w=>u(new Error("Aborted")),f.onerror=w=>u(new Error(w.type));let y=this.file.slice(this.offset,c);f.readAsArrayBuffer(y)}this.offset=c}),done:!1}})}}let sct=l=>({method:l.method,headers:l.headers,body:l.body,mode:l.mode,credentials:l.credentials,cache:l.cache,redirect:l.redirect,referrer:l.referrer,integrity:l.integrity});function LY(l){return typeof l=="string"&&l.slice(0,7)==="file://"}class qw extends RY{constructor(i,o={}){super(),this.input=i,this.options=o}iterator(){return ce(this,null,function*(){if(LY(this.input)&&(0,m.env)().get("IS_NODE")){let i=F(8108);this.input=i.readFileSync(this.input.slice(7))}return new tT(this.input,this.options)})}}class TS extends RY{constructor(i,o={}){super(),this.url=i,this.fileOptions=o}iterator(){return ce(this,null,function*(){return LY(this.url)?new qw(this.url,this.fileOptions).iterator():function(c){return ce(this,arguments,function*(i,o={},u){let f,y;typeof i=="string"?f=i:(f=i.url,y=sct(i));let w=yield(0,m.util.fetch)(f,y);if(w.ok){let C=new Uint8Array(yield w.arrayBuffer());return new tT(C,o)}throw new Error(w.statusText)})}(this.url,this.fileOptions)})}}function ZF(l,i={}){return new DY(new TS(l),i)}function bm(l){let i=UF(l);return td(()=>ce(this,null,function*(){return i}))}function S2(l){return td(()=>ce(this,null,function*(){let i=yield l();return UF(()=>i.next())}))}function eT(l,i){return ce(this,null,function*(){return ES.create(l,i)})}function zv(l){return ce(this,null,function*(){return CS.create(l)})}let AS="4.22.0";function Ii(l,i){Array.isArray(l)||(l=[l]),l.forEach(o=>{o!=null&&m.util.assert(o.dtype!=="complex64",()=>`${i} does not support complex64 tensors in the CPU backend.`)})}let $Y=m.kernel_impls.whereImpl;class Xw extends m.KernelBackend{nextDataId(){return Xw.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new m.DataStorage(this,(0,m.engine)())}write(i,o,u){this.firstUse&&(this.firstUse=!1,(0,m.env)().get("IS_NODE")&&m.backend_util.warn(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));let c={id:this.nextDataId()};return this.data.set(c,{values:i,dtype:u,refCount:1}),c}makeTensorInfo(i,o,u){let c;if(o==="string"&&u!=null&&u.length>0&&m.util.isString(u[0])){let f=u.map(y=>m.util.encodeString(y));c=this.write(f,i,o)}else c=this.write(u,i,o);return{dataId:c,shape:i,dtype:o}}refCount(i){return this.data.has(i)?this.data.get(i).refCount:0}incRef(i){this.data.get(i).refCount++}decRef(i){this.data.has(i)&&this.data.get(i).refCount--}move(i,o,u,c,f){this.data.set(i,{values:o,dtype:c,refCount:f})}numDataIds(){return this.data.numDataIds()}read(i){return ce(this,null,function*(){return this.readSync(i)})}readSync(i){let{dtype:o,complexTensorInfos:u}=this.data.get(i);if(o==="complex64"){let c=this.readSync(u.real.dataId),f=this.readSync(u.imag.dataId);return m.backend_util.mergeRealAndImagArrays(c,f)}return m.util.convertBackendValuesAndArrayBuffer(this.data.get(i).values,o)}bufferSync(i){let o=this.readSync(i.dataId);if(i.dtype==="string")try{let u=o.map(c=>m.util.decodeString(c));return(0,m.buffer)(i.shape,i.dtype,u)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return(0,m.buffer)(i.shape,i.dtype,o)}makeOutput(i,o,u){return(0,m.engine)().makeTensorFromTensorInfo(this.makeTensorInfo(o,u,i),this)}disposeData(i,o=!1){if(this.data.has(i)){if(this.data.get(i).refCount--,!o&&this.data.get(i).refCount>0)return!1;let{complexTensorInfos:u}=this.data.get(i);u!=null&&(this.disposeData(u.real.dataId,!0),this.disposeData(u.imag.dataId,!0)),this.data.delete(i)}return!0}disposeIntermediateTensorInfo(i){this.disposeData(i.dataId)}time(i){return ce(this,null,function*(){let o=m.util.now();return i(),{kernelMs:m.util.now()-o}})}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(i){Ii([i],"where");let o=this.readSync(i.dataId);return $Y(i.shape,o)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}function QF(l){let i=new Float32Array(l.length);for(let o=0;o<l.length;++o)i[o]=Math.abs(l[o]);return i}Xw.nextDataId=0;let uct={kernelName:m.Abs,backendName:"cpu",kernelFunc:l=>{let{x:i}=l.inputs,o=l.backend;Ii(i,"abs");let u=new Float32Array(m.util.sizeFromShape(i.shape));return u=QF(o.data.get(i.dataId).values),o.makeOutput(u,i.shape,i.dtype)}};function nl(l){return(i,o,u,c,f)=>{let y=m.backend_util.assertAndGetBroadcastShape(i,o),w=y.length,C=m.util.computeStrides(y),T=m.util.sizeFromShape(y),x=m.util.getTypedArrayFromDType(f,T),A=i.length,M=o.length,$=m.util.computeStrides(i),V=m.util.computeStrides(o),G=m.backend_util.getBroadcastDims(i,y),Q=m.backend_util.getBroadcastDims(o,y);if(G.length+Q.length===0)for(let nt=0;nt<x.length;++nt)x[nt]=l(u[nt%u.length],c[nt%c.length]);else for(let nt=0;nt<x.length;++nt){let it=m.util.indexToLoc(nt,w,C),ht=it.slice(-A);G.forEach(Ut=>ht[Ut]=0);let kt=m.util.locToIndex(ht,A,$),Nt=it.slice(-M);Q.forEach(Ut=>Nt[Ut]=0);let $t=m.util.locToIndex(Nt,M,V);x[nt]=l(u[kt],c[$t])}return[x,y]}}function Od(l){let{inputs:i,backend:o}=l,{real:u,imag:c}=i,f=o.data.get(u.dataId).values,y=o.data.get(c.dataId).values,w=o.makeTensorInfo(u.shape,"complex64");return o.data.get(w.dataId).complexTensorInfos={real:o.makeTensorInfo(u.shape,"float32",f),imag:o.makeTensorInfo(c.shape,"float32",y)},w}let zY={kernelName:m.Complex,backendName:"cpu",kernelFunc:Od};function Kw(l,i,o="float32"){if(o==="complex64")return Od({inputs:{real:Kw(l,i,"float32"),imag:Kw(l,i,"float32")},backend:l});let u=m.util.makeZerosTypedArray(m.util.sizeFromShape(i),o);return l.makeTensorInfo(i,o,u)}function xf(l){let{inputs:i,backend:o}=l,{x:u}=i;return o.incRef(u.dataId),{dataId:u.dataId,shape:u.shape,dtype:u.dtype}}let PY={kernelName:m.Identity,backendName:"cpu",kernelFunc:xf};function Pv(l){let{inputs:i,backend:o}=l,{input:u}=i,c=o.data.get(u.dataId).complexTensorInfos.real,f=o.data.get(c.dataId).values;return o.makeTensorInfo(c.shape,c.dtype,f)}let lct={kernelName:m.Real,backendName:"cpu",kernelFunc:Pv};function nT(l,i,o,u){if(u==="int32")return[i,"int32",Int32Array.from(l)];if(u==="bool"){let c=m.util.toTypedArray([0],o),[f,y]=nl((w,C)=>w!==C?1:0)(i,[],l,c,"bool");return[y,"bool",f]}throw new Error(`Error in Cast: failed to cast ${o} to ${u}`)}function cp(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{dtype:f}=u;if(f==="complex64"){if(c.dtype==="complex64")return xf({inputs:{x:c},backend:o});let x=Kw(o,c.shape,c.dtype),A=cp({inputs:{x:c},backend:o,attrs:{dtype:"float32"}}),M=Od({inputs:{real:A,imag:x},backend:o});return o.disposeIntermediateTensorInfo(x),o.disposeIntermediateTensorInfo(A),M}if(c.dtype==="complex64"){let x=Pv({inputs:{input:c},backend:o}),A=cp({inputs:{x},backend:o,attrs:{dtype:f}});return o.disposeIntermediateTensorInfo(x),A}if(!m.util.hasEncodingLoss(c.dtype,f)){let x=xf({inputs:{x:c},backend:o});return{dataId:x.dataId,shape:x.shape,dtype:f}}let y=o.data.get(c.dataId).values,[w,C,T]=nT(y,c.shape,c.dtype,f);return o.makeTensorInfo(w,C,T)}let JF={kernelName:m.Cast,backendName:"cpu",kernelFunc:cp};function ml(l,i,o,u){return o==null?({inputs:c,backend:f})=>{let{a:y,b:w}=c,C=f;Ii([y,w],l);let T=C.data.get(y.dataId).values,x=C.data.get(w.dataId).values,A=y.dtype==="string"?m.backend_util.fromUint8ToStringArray(T):T,M=y.dtype==="string"?m.backend_util.fromUint8ToStringArray(x):x,$=u||y.dtype,[V,G]=i(y.shape,w.shape,A,M,$);return C.makeTensorInfo(G,$,V)}:({inputs:c,backend:f})=>{let{a:y,b:w}=c,C=f;if(y.dtype==="complex64"||w.dtype==="complex64"){let T=cp({inputs:{x:y},backend:C,attrs:{dtype:"complex64"}}),x=C.data.get(T.dataId),A=x.complexTensorInfos.real,M=x.complexTensorInfos.imag,$=C.data.get(A.dataId).values,V=C.data.get(M.dataId).values,G=cp({inputs:{x:w},backend:C,attrs:{dtype:"complex64"}}),Q=C.data.get(G.dataId),nt=Q.complexTensorInfos.real,it=Q.complexTensorInfos.imag,ht=C.data.get(nt.dataId).values,kt=C.data.get(it.dataId).values,[Nt,$t,Ut]=o(y.shape,w.shape,$,V,ht,kt),Pt=C.makeTensorInfo(Ut,"float32",Nt),re=C.makeTensorInfo(Ut,"float32",$t),ue=Od({inputs:{real:Pt,imag:re},backend:C});return C.disposeIntermediateTensorInfo(T),C.disposeIntermediateTensorInfo(G),C.disposeIntermediateTensorInfo(Pt),C.disposeIntermediateTensorInfo(re),ue}{let T=C.data.get(y.dataId).values,x=C.data.get(w.dataId).values,A=u||y.dtype,[M,$]=i(y.shape,w.shape,T,x,A);return C.makeTensorInfo($,A,M)}}}function rT(l){return(i,o,u,c,f,y)=>{let w=m.backend_util.assertAndGetBroadcastShape(i,o),C=m.util.sizeFromShape(w),T=w.length,x=m.util.computeStrides(w),A=m.util.getTypedArrayFromDType("float32",C),M=m.util.getTypedArrayFromDType("float32",C),$=m.backend_util.getBroadcastDims(i,w),V=m.backend_util.getBroadcastDims(o,w),G=m.backend_util.mergeRealAndImagArrays(u,c),Q=m.backend_util.mergeRealAndImagArrays(f,y),nt=i.length,it=m.util.computeStrides(i),ht=o.length,kt=m.util.computeStrides(o);if($.length+V.length===0)for(let Nt=0;Nt<A.length;Nt++){let $t=Nt%G.length,Ut=Nt%Q.length,Pt=l(G[2*$t],G[2*$t+1],Q[2*Ut],Q[2*Ut+1]);A[Nt]=Pt.real,M[Nt]=Pt.imag}else for(let Nt=0;Nt<A.length;Nt++){let $t=m.util.indexToLoc(Nt,T,x),Ut=$t.slice(-nt);$.forEach(De=>Ut[De]=0);let Pt=m.util.locToIndex(Ut,nt,it),re=$t.slice(-ht);V.forEach(De=>re[De]=0);let ue=m.util.locToIndex(re,ht,kt),be=l(G[2*Pt],G[2*Pt+1],Q[2*ue],Q[2*ue+1]);A[Nt]=be.real,M[Nt]=be.imag}return[A,M,w]}}let iT=nl((l,i)=>l+i),aT=rT((l,i,o,u)=>({real:l+o,imag:i+u})),_2=ml(m.Add,iT,aT),cct={kernelName:m.Add,backendName:"cpu",kernelFunc:_2};function tO(l,i,o,u,c){let f=m.util.sizeFromShape(u),y=m.util.makeZerosTypedArray(c,o);for(let w=0;w<l.length;w++){let C=l[w];if(C<0)throw new Error("Input x must be non-negative!");C>=c||(y[C]+=f>0?i[w]:1)}return y}function BY(l,i,o,u=!1){let c=l.shape[0],f=l.shape[1],y=(0,m.buffer)([c,o],i.dtype);for(let w=0;w<c;w++)for(let C=0;C<f;C++){let T=l.get(w,C);if(T<0)throw new Error("Input x must be non-negative!");T>=o||(u?y.set(1,w,T):i.size>0?y.set(y.get(w,T)+i.get(w,C),w,T):y.set(y.get(w,T)+1,w,T))}return y}let jY=nl((l,i)=>l&i),hct=ml(m.BitwiseAnd,jY),UY={kernelName:m.BitwiseAnd,backendName:"cpu",kernelFunc:hct};function y0(l){return(i,o,u)=>{let c=m.util.getArrayFromDType(o,i.length);for(let f=0;f<i.length;++f)c[f]=l(i[f],u);return c}}function ns(l,i,o){return $g(l,y0(i),o)}function $g(l,i,o){return({inputs:u,attrs:c,backend:f})=>{let{x:y}=u;Ii(y,l);let w=f,C=w.data.get(y.dataId).values,T;if(y.dtype==="string"){if(!Array.isArray(C))throw new Error("String tensor's value was not an instance of Array");T=m.backend_util.fromUint8ToStringArray(C)}else T=C;let x=o||y.dtype,A=i(T,x,c);return w.makeTensorInfo(y.shape,x,A)}}let WY=y0(l=>Math.ceil(l)),dct=$g(m.Ceil,WY),fct={kernelName:m.Ceil,backendName:"cpu",kernelFunc:dct};function VY(l,i,o,u){let c=m.util.getArrayFromDType(o,m.util.sizeFromShape(i));if(u&&o!=="string"){let f=0;l.forEach(y=>{let w=m.util.sizeFromShape(y.shape);c.set(y.vals,f),f+=w})}else{let f=0;l.forEach(y=>{let w=o==="string"?m.backend_util.fromUint8ToStringArray(y.vals):y.vals,C=0;for(let T=0;T<y.shape[0];++T){let x=T*i[1]+f;for(let A=0;A<y.shape[1];++A)c[x+A]=w[C++]}f+=y.shape[1]})}return c}let GY=nl((l,i)=>l===i?1:0),HY=ml(m.Equal,GY,null,"bool"),eO={kernelName:m.Equal,backendName:"cpu",kernelFunc:HY},oT=y0(l=>Math.exp(l)),sT=$g(m.Exp,oT,"float32"),uT={kernelName:m.Exp,backendName:"cpu",kernelFunc:sT},zg=y0(l=>Math.expm1(l)),Bv=$g(m.Expm1,zg),lT={kernelName:m.Expm1,backendName:"cpu",kernelFunc:Bv},IS=y0(l=>Math.floor(l)),NS=$g(m.Floor,IS),nO={kernelName:m.Floor,backendName:"cpu",kernelFunc:NS},MS=nl((l,i)=>Math.floor(l/i)),cT=ml(m.FloorDiv,MS,null,"int32"),hT={kernelName:m.FloorDiv,backendName:"cpu",kernelFunc:cT};function DS(l,i,o,u,c,f,y,w,C){let T=(0,m.buffer)([u,f],o);for(let x=0;x<u;x++){let A=[],M=0;for(let $=0;$<c;$++){let V=l[x*c+$];M+=V*y[$],A.push(V)}if(M<0||M>=C/f)throw new Error(`Invalid indices: ${A} does not index into ${w}`);for(let $=0;$<f;$++)T.values[x*f+$]=i.get(...i.indexToLoc(M*f+$))}return T}function Zw(l,i,o){let u=(0,m.buffer)(o,l.dtype);for(let c=0;c<u.size;++c){let f=u.indexToLoc(c).slice(),y=f[0],w=f[2],C=i.locToIndex([y,w]);f[2]=i.values[C];let T=l.locToIndex(f);0<=T&&T<l.values.length&&(u.values[c]=l.values[T])}return u}let dT=nl((l,i)=>l>i?1:0),pct=ml(m.Greater,dT,null,"bool"),fT={kernelName:m.Greater,backendName:"cpu",kernelFunc:pct},RS=nl((l,i)=>l>=i?1:0),pT=ml(m.GreaterEqual,RS,null,"bool"),YY={kernelName:m.GreaterEqual,backendName:"cpu",kernelFunc:pT},rO=nl((l,i)=>l<i?1:0),mct=ml(m.Less,rO,null,"bool"),gct={kernelName:m.Less,backendName:"cpu",kernelFunc:mct},qY=nl((l,i)=>l<=i?1:0),iO=ml(m.LessEqual,qY,null,"bool"),jv={kernelName:m.LessEqual,backendName:"cpu",kernelFunc:iO};function Uv(l,i,o){let u=(i-l)/(o-1),c=m.util.makeZerosTypedArray(o,"float32");c[0]=l;for(let f=1;f<c.length;f++)c[f]=c[f-1]+u;return c}let Qw=y0(l=>Math.log(l)),C2=$g(m.Log,Qw),Wv={kernelName:m.Log,backendName:"cpu",kernelFunc:C2};function Vv(l,i,o,u){let c=m.util.getTypedArrayFromDType(u,m.util.sizeFromShape(o));for(let f=0;f<c.length;++f){let y=f*i,w=l[y];for(let C=0;C<i;++C){let T=l[y+C];(Number.isNaN(T)||T>w)&&(w=T)}c[f]=w}return c}let Gv=nl((l,i)=>Math.max(l,i)),FS=ml(m.Maximum,Gv),wm={kernelName:m.Maximum,backendName:"cpu",kernelFunc:FS},XY=nl((l,i)=>Math.min(l,i)),yct=ml(m.Minimum,XY),vct={kernelName:m.Minimum,backendName:"cpu",kernelFunc:yct},aO=nl((l,i)=>l*i),bct=rT((l,i,o,u)=>({real:l*o-i*u,imag:l*u+i*o})),mT=ml(m.Multiply,aO,bct),wct={kernelName:m.Multiply,backendName:"cpu",kernelFunc:mT};function oO(l,i,o){let u=m.util.createScalarValue(-1,o);return aO([],i,u,l,o)}let KY={kernelName:m.Neg,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{x:u}=i;Ii(u,"neg");let c=o.data.get(u.dataId).values,[f,y]=oO(c,u.shape,u.dtype);return o.makeTensorInfo(y,u.dtype,f)}},sO=nl((l,i)=>l!==i?1:0),OS=ml(m.NotEqual,sO,null,"bool"),ZY={kernelName:m.NotEqual,backendName:"cpu",kernelFunc:OS};function Jw(l,i,o,u,c){let f=i.length,y=m.util.sizeFromShape(i),w=m.util.computeStrides(i),C=m.util.computeStrides(c),T=m.util.getTypedArrayFromDType(o,m.util.sizeFromShape(c));for(let x=0;x<y;++x){let A=m.util.indexToLoc(x,f,w),M=new Array(A.length);for(let $=0;$<M.length;$++)M[$]=A[u[$]];T[m.util.locToIndex(M,f,C)]=l[x]}return T}function Gc(l){let{inputs:i,attrs:o,backend:u}=l,{x:c}=i,{perm:f}=o;Ii(c,"transpose");let y=c.shape.length,w=new Array(y);for(let T=0;T<w.length;T++)w[T]=c.shape[f[T]];let C=Jw(u.data.get(c.dataId).values,c.shape,c.dtype,f,w);return{dataId:u.write(C,w,c.dtype),shape:w,dtype:c.dtype}}let gT={kernelName:m.Transpose,backendName:"cpu",kernelFunc:Gc};function ql(l,i,o,u){let[c,f]=m.backend_util.computeOutAndReduceShapes(l,u),y=(0,m.upcastType)(i,"int32"),w=m.util.makeZerosTypedArray(m.util.sizeFromShape(c),y),C=m.util.sizeFromShape(f);for(let T=0;T<w.length;++T){let x=T*C,A=1;for(let M=0;M<C;++M)A*=o[x+M];w[T]=A}return{outVals:w,outShape:c,outDtype:y}}let QY={kernelName:m.Prod,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,keepDims:y}=u;Ii(c,"prod");let w=c.shape.length,C=m.util.parseAxisParam(f,c.shape),T=m.backend_util.getAxesPermutation(C,w),x=C,A=c,M=[];T!=null&&(A=Gc({inputs:{x:c},backend:o,attrs:{perm:T}}),M.push(A),x=m.backend_util.getInnerMostAxes(x.length,w));let $=o.data.get(A.dataId).values,{outVals:V,outShape:G,outDtype:Q}=ql(A.shape,A.dtype,$,x),nt=G;return y&&(nt=m.backend_util.expandShapeToKeepDim(G,C)),M.forEach(it=>o.disposeIntermediateTensorInfo(it)),o.makeTensorInfo(nt,Q,V)}};function JY(l,i,o,u){let c=[],f=0,y=i.length-1+o.length,w=new Array(y).fill(null).map(()=>[0]);(function(T,x){for(let A=0;A<T.length;++A){let M=T[A],$=A===T.length-1?x:T[A+1].length;if(M.length===0)throw new Error("Ragged splits may not be empty");if(M[0]<0)throw new Error("Ragged splits must be non-negative");if(M[M.length-1]>$)throw new Error("Ragged splits must not point past values");for(let V=1;V<M.length;++V)if(M[V-1]>M[V])throw new Error("Ragged splits must be sorted in ascending order")}})(o,u);let C=1;for(let T=0;T<i.length-1;++T){C*=i[T];let x=i[T+1];for(let A=1;A<C+1;++A)w[T].push(A*x)}for(let T=0;T<l.length;++T){let x=l[T],A=l[T]+1;for(let M=0;M<o.length;++M){let $=o[M],V=M+i.length-1;if(V>=0){let G=w[V],Q=G[G.length-1]-$[x];for(let nt=x;nt<A;++nt)w[V].push($[nt+1]+Q)}x=$[x],A=$[A]}A!==x&&(c.push([x,A]),f+=A-x)}return{outSplits:w,valueSlices:c,numValues:f}}function LS(l,i){let o=l.slice(0,i);for(;o.length<i;)o.push(1);for(let u=i;u<l.length;u++)o[i-1]*=l[u];return o}function Hv(l,i,o,u,c){let f=i.slice();f[0]=c;let y=m.util.getArrayFromDType(o,m.util.sizeFromShape(f)),w=l.length;return function(C,T,x,A,M,$){let V=LS(T,2)[1],G=LS($,2)[1],Q=0;for(let nt of x)for(let it=nt[0];it<nt[1];++it){for(let ht=0;ht<A;++ht)M[Q*G+ht]=C[it*V+ht];++Q}}(l,i,u,w===0?0:w/i[0],y,f),[y,f]}function E2(l,i,o,u,c,f,y,w){if(l.length===0)throw new Error("paramsNestedSplits must be non empty");if(i[0].length===0)throw new Error("Split tensors must not be scalars");if(function(V,G,Q){V.forEach((nt,it)=>{if(nt<0||nt>=Q){let ht=m.util.indexToLoc(it,G.length,m.util.computeStrides(G)).join(",");throw new Error(`indices[${ht}] = ${nt} is not in [0, ${Q})`)}})}(f,y,i[0][0]-1),u.length===0)throw new Error("params.rank must be nonzero");let C=u[0],{outSplits:T,valueSlices:x,numValues:A}=JY(f,y,l,C),M=function(V){let G=[];for(let Q=0;Q<V.length;++Q){let nt=V[Q].length,it=m.util.getArrayFromDType("int32",nt);G.push(it),V[Q].forEach((ht,kt)=>it[kt]=ht)}return G}(T),$=Hv(o,u,c,x,A);return[M,$[0],$[1]]}let uO=2147483647;function lO(l,i,o,u,c,f,y){if(i.length>1)throw new Error("starts must be a scalar or vector");if(c.length>1)throw new Error("limits must be a scalar or vector");if(y.length>1)throw new Error("deltas must be a scalar or vector");let w=i.length===0,C=c.length===0,T=y.length===0,x=[];w||x.push(i[0]),C||x.push(c[0]),T||x.push(y[0]);for(let Q=1;Q<x.length;++Q)if(x[Q]!==x[Q-1])throw new Error("starts, limits, and deltas must have the same shape");let A=x.length===0?1:x[0],M=m.util.getArrayFromDType("int32",A+1);M[0]=0;for(let Q=0;Q<A;++Q){let nt=w?l[0]:l[Q],it=C?u[0]:u[Q],ht=T?f[0]:f[Q];if(ht===0)throw new Error("Requires delta != 0");let kt;if(ht>0&&it<nt||ht<0&&it>nt)kt=0;else if(kt=Math.ceil(Math.abs((it-nt)/ht)),kt>uO)throw new Error(`Requires ((limit - start) / delta) <= ${uO}`);M[Q+1]=M[Q]+kt}let $=M[A],V=m.util.getArrayFromDType(o,$),G=0;for(let Q=0;Q<A;++Q){let nt=M[Q+1]-M[Q],it=w?l[0]:l[Q],ht=T?f[0]:f[Q];for(let kt=0;kt<nt;++kt)V[G++]=it,it+=ht}return[M,V]}var Ld=m.backend_util.RowPartitionType;class $d{constructor(i,o,u,c,f,y,w,C,T,x){this.shape=i,this.shapeShape=o,this.values=u,this.valuesShape=c,this.valuesDType=f,this.defaultValue=y,this.defaultValueShape=w,this.rowPartitionValues=C,this.rowPartitionValuesShapes=T,this.rowPartitionTypes=m.backend_util.getRowPartitionTypesHelper(x),this.raggedRank=m.backend_util.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(i){return this.rowPartitionTypes[0]===Ld.FIRST_DIM_SIZE?this.rowPartitionTypes[i+1]:this.rowPartitionTypes[i]}getRowPartitionTensor(i){return this.rowPartitionTypes[0]===Ld.FIRST_DIM_SIZE?this.rowPartitionValues[i+1]:this.rowPartitionValues[i]}getMaxWidth(i){let o=this.getRowPartitionTensor(i-1);switch(this.getRowPartitionTypeByDimension(i-1)){case Ld.VALUE_ROWIDS:return $d.getMaxWidthValueRowID(o);case Ld.ROW_SPLITS:return $d.getMaxWidthRowSplit(o);default:throw new Error(`Cannot handle partition type ${Ld[this.getRowPartitionTypeByDimension(i-1)]}`)}}static getMaxWidthRowSplit(i){let o=i.length;if(o===0||o===1)return 0;let u=0;for(let c=0;c<o-1;++c){let f=i[c+1]-i[c];f>u&&(u=f)}return u}static getMaxWidthValueRowID(i){let o=i.length;if(o===0)return 0;let u=0,c=i[0],f=0;for(let y=1;y<o;++y){let w=i[y];w!==c&&(c=w,f=Math.max(y-u,f),u=y)}return Math.max(o-u,f)}tensorShapeFromTensor(i,o,u=!0){if(o.length===0){if(i[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return $S(i,u)}calculateOutputSize(i){let o=this.valuesShape,u=this.defaultValueShape;m.backend_util.validateDefaultValueShape(u,o);let c=this.tensorShapeFromTensor(this.shape,this.shapeShape),f=m.backend_util.combineRaggedTensorToTensorShapes(this.raggedRank,c,o);f[0]<0&&(f[0]=i);for(let y=1;y<=this.raggedRank;++y)f[y]<0&&(f[y]=this.getMaxWidth(y));return f}calculateFirstParentOutputIndex(i,o,u){let c=Math.min(i,u),f=[],y=0;for(let w=0;w<c;++w,y+=o)f.push(y);for(let w=c;w<i;++w)f.push(-1);return m.util.assert(f.length===i,()=>"Final length of result must be equal to firstDimension."),f}calculateOutputIndexRowSplit(i,o,u,c){let f=i.length,y=[];for(let w=0;w<f-1;++w){let C=i[w+1]-i[w],T=Math.min(c,C),x=o[w];x===-1&&(T=0);for(let A=0;A<T;++A)y.push(x),x+=u;for(let A=0;A<C-T;++A)y.push(-1)}if(f>0&&y.length!==i[f-1])throw new Error("Invalid row split size.");return y}calculateOutputIndexValueRowID(i,o,u,c){let f=i.length,y=[];if(f===0)return[];let w=0,C=i[0];if(C>=o.length)throw new Error(`Got currentValueRowId=${C}, which is not less than ${o.length}`);let T=o[C];y.push(T);for(let x=1;x<f;++x){let A=i[x];if(A===C)T>=0&&(++w,w<c?T+=u:T=-1);else{if(w=0,C=A,A>=o.length)throw new Error(`Got nextValueRowId=${A} which is not less than ${o.length}`);T=o[A]}y.push(T)}if(y.length!==i.length)throw new Error("Invalid row ids.");return y}calculateOutputIndex(i,o,u,c){let f=this.getRowPartitionTensor(i),y=this.getRowPartitionTypeByDimension(i);switch(y){case Ld.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(f,o,u,c);case Ld.ROW_SPLITS:if(f.length-1>o.length)throw new Error(`Row partition size is greater than output size: ${f.length-1} > ${o.length}`);return this.calculateOutputIndexRowSplit(f,o,u,c);default:throw new Error(`Unsupported partition type: ${Ld[y]}`)}}getFirstDimensionSize(){let i=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");let o=this.rowPartitionTypes[0];switch(o){case Ld.FIRST_DIM_SIZE:return i[0];case Ld.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ld.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ld[o]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");let i=this.getFirstDimensionSize(),o=this.calculateOutputSize(i),u=new Array(this.raggedRank+1);u[u.length-1]=1;for(let y=u.length-2;y>=0;--y)u[y]=u[y+1]*o[y+1];let c=$S(o,!1),f=m.util.getArrayFromDType(this.valuesDType,m.util.sizeFromShape(c));if(u[0]*o[0]>0){let y=this.calculateFirstParentOutputIndex(i,u[0],o[0]);for(let w=1;w<=this.raggedRank;++w)y=this.calculateOutputIndex(w-1,y,u[w],o[w]);this.setOutput(this.raggedRank,y,f,c)}return[c,f]}setOutput(i,o,u,c){if(u.length===0)return;let f=this.values,y=u,w=c.slice();w=w.slice(i+1);let C=m.util.sizeFromShape(w),T=o.length,x=this.defaultValue;if(x.length!==C&&x.length!==1){let V=this.defaultValueShape;(0,m.tidy)(()=>{let G=(0,m.reshape)(x,V);x=(0,m.broadcastTo)(G,w).dataSync()})}let A=0,M=0,$=0;for(let V=0;V<=T;++V){let G=V<T?o[V]:-1;if(G!==$){if(M<$){let Q=f.subarray(A*C);cO(y.subarray(M*C),Q,($-M)*C)}if(V>=T){let Q=u.length;G=Math.floor(Q/C)}if(G>$)if(this.defaultValue.length===1)y.subarray($*C,G*C).fill(this.defaultValue[0]),$=G;else for(;G>$;)cO(y.slice($*C),x,C),++$;G<0?(A=V+1,M=$):(A=V,M=$,$=M+1)}else++$}}}function cO(l,i,o){for(let u=0;u<o;u++)l[u]=i[u]}function $S(l,i){let o=[];for(let u of l){if(u<0){if(!i)throw new Error(`Dimension ${u} must be >= 0`);if(u<-1)throw new Error(`Dimension ${u} must be >= -1`);u=-1}o.push(u)}return o}function yT(l,i,o,u,c,f,y,w,C,T){return new $d(l,i,o,u,c,f,y,w,C,T).compute()}function hO(l,i,o,u){if(l===i||l<i&&o<0||i<l&&o>1)return m.util.makeZerosTypedArray(0,u);let c=Math.abs(Math.ceil((i-l)/o)),f=m.util.makeZerosTypedArray(c,u);i<l&&o===1&&(o=-1),f[0]=l;for(let y=1;y<f.length;y++)f[y]=f[y-1]+o;return f}let dO=y0(l=>1/Math.sqrt(l)),tq=$g(m.Rsqrt,dO),vT={kernelName:m.Rsqrt,backendName:"cpu",kernelFunc:tq};function T2(l,i,o,u,c,f,y,w,C,T){let x=[u/c,c],A=l.values,M=i.values;if(u===0)return(0,m.buffer)(o,i.dtype);let $=C instanceof m.TensorBuffer?C:(0,m.buffer)(x,i.dtype);typeof C=="string"||typeof C=="number"?$.values.fill(C):typeof C=="boolean"&&$.values.fill(+C);for(let V=0;V<f;V++){let G=[],Q=0;for(let nt=0;nt<y;nt++){let it=A[V*y+nt];G.push(it),Q+=it*w[nt]}if(Q<0||Q>=u/c)throw new Error(`Invalid indices: ${G} does not index into ${o}`);for(let nt=0;nt<c;nt++)T?$.values[Q*c+nt]+=M[V*c+nt]:$.values[Q*c+nt]=i.rank===0?M[0]:M[V*c+nt]}return $}let bT=y0(l=>1/(1+Math.exp(-l))),eq=ns(m.Sigmoid,l=>1/(1+Math.exp(-l))),dc={kernelName:m.Sigmoid,backendName:"cpu",kernelFunc:eq};function wT(l,i,o,u,c){let f=m.slice_util.isSliceContinous(u,i,o),y=m.util.sizeFromShape(o),w=m.util.computeStrides(u);if(f){let A=m.slice_util.computeFlatOffset(i,w);return c==="string"?l.slice(A,A+y):l.subarray(A,A+y)}let C=c==="string"?m.backend_util.fromUint8ToStringArray(l):l,T=(0,m.buffer)(u,c,C),x=(0,m.buffer)(o,c);for(let A=0;A<x.size;++A){let M=x.indexToLoc(A),$=M.map((V,G)=>V+i[G]);x.set(T.get(...$),...M)}return c==="string"?m.backend_util.fromStringArrayToUint8(x.values):x.values}function A2(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{begin:f,size:y}=u;Ii(c,"slice");let[w,C]=m.slice_util.parseSliceParams(c,f,y);m.slice_util.assertParamsValid(c,w,C);let T=wT(o.data.get(c.dataId).values,w,C,c.shape,c.dtype);return o.makeTensorInfo(C,c.dtype,T)}let xct={kernelName:m.Slice,backendName:"cpu",kernelFunc:A2};function nq(l,i,o,u,c,f,y){let w=i[0],C=f[0],T=new Array(C),x=new Array(w),A=i[1];if(C===0){if(w!==0)throw new Error(m.backend_util.getSparseFillEmptyRowsIndicesDenseShapeMismatch(w));return[m.util.getArrayFromDType(o,0),[0,A],m.util.getArrayFromDType(c,0),T,x]}let M=!0,$=0,V=new Array(C).fill(0);for(let Q=0;Q<w;++Q){let nt=l[Q*A];if(nt<0)throw new Error(m.backend_util.getSparseFillEmptyRowsNegativeIndexErrorMessage(Q,nt));if(nt>=C)throw new Error(m.backend_util.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(Q,nt,C));++V[nt],M=M&&nt>=$,$=nt}let G=!0;for(let Q=0;Q<C;++Q){let nt=V[Q]===0;T[Q]=nt,G=G&&!nt,V[Q]=Math.max(V[Q],1),Q>0&&(V[Q]+=V[Q-1])}if(G&&M){let Q=l,nt=u;for(let it=0;it<w;++it)x[it]=it;return[Q,[w,A],nt,T,x]}{let Q=V[C-1],nt=m.util.getArrayFromDType(o,Q*A),it=m.util.getArrayFromDType(c,Q),ht=new Array(C).fill(0);for(let kt=0;kt<w;++kt){let Nt=l[kt*A],$t=ht[Nt],Ut=(Nt===0?0:V[Nt-1])+$t;ht[Nt]++;for(let Pt=0;Pt<A;++Pt)nt[Ut*A+Pt]=l[kt*A+Pt];it[Ut]=u[kt],x[kt]=Ut}for(let kt=0;kt<C;++kt)if(ht[kt]===0){let Nt=kt===0?0:V[kt-1];nt[Nt*A+0]=kt;for(let $t=1;$t<A;++$t)nt[Nt*A+$t]=0;it[Nt]=y}return[nt,[Q,A],it,T,x]}}function xT(l,i,o,u,c){let f=m.util.sizeFromShape(u),y=i[0],w=c.length,C=[],T=1,x=-1;for(let G=0;G<w;++G){let Q=c[G];if(Q===-1){if(x!==-1)throw new Error(m.backend_util.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(x,G));x=G,C.push(1)}else{if(Q<0)throw new Error(m.backend_util.getSparseReshapeNegativeOutputDimErrorMessage(G,Q));T*=Q,C.push(Q)}}if(x!==-1){if(T<=0)throw new Error(m.backend_util.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let G=Math.trunc(f/T);if(T*G!==f)throw new Error(m.backend_util.getSparseReshapeInputOutputMultipleErrorMessage(u,C));C[x]=G}if(m.util.sizeFromShape(C)!==f)throw new Error(m.backend_util.getSparseReshapeInputOutputMismatchErrorMessage(u,C));let A=u.length,M=[];if(A>0){M[A-1]=1;for(let G=A-2;G>=0;--G)M[G]=M[G+1]*u[G+1]}let $=[];if(w>0){$[w-1]=1;for(let G=w-2;G>=0;--G)$[G]=$[G+1]*C[G+1]}let V=m.util.getArrayFromDType(o,y*w);for(let G=0;G<y;++G){let Q=0;for(let nt=0;nt<A;++nt)Q+=l[G*A+nt]*M[nt];for(let nt=0;nt<w;++nt)V[G*w+nt]=Math.trunc(Q/$[nt]),Q%=$[nt]}return[V,[y,w],C]}function kT(l,i,o,u,c,f=!1,y=0){let w=u.length,C=[i[0],l.length/i[0]],T=C[1],x=w>0?c[w-1]+1:0;if(x<0)throw new Error(m.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let A=i.slice();A[0]=x;let M=A.reduce((it,ht)=>it*ht,1),$=m.util.getArrayFromDType(o,M);if(w===0)return x>0&&$.fill(y),[$,A];if(x<=0)throw new Error(m.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let V=0,G=1,Q=0,nt=c[V];for(;;){let it=0;if(G<w){if(it=c[G],nt===it){++G;continue}if(nt>=it)throw new Error(m.backend_util.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(nt<0||nt>=x)throw new Error(m.backend_util.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(nt,x));nt>Q&&$.fill(y,Q*T,nt*T);for(let ht=V;ht<G;++ht){let kt=u[ht];if(kt<0||kt>=C[0])throw new Error(m.backend_util.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(ht,u[ht],C[0]));for(let Nt=0;Nt<T;Nt++)$[nt*T+Nt]+=l[kt*T+Nt]}if(f)for(let ht=0;ht<T;ht++)$[nt*T+ht]/=G-V;if(V=G,++G,Q=nt+1,nt=it,G>w)break}return Q<x&&$.fill(y,Q*T,x*T),[$,A]}let kct=y0(l=>Math.sqrt(l)),rq=ns(m.Sqrt,l=>Math.sqrt(l)),iq={kernelName:m.Sqrt,backendName:"cpu",kernelFunc:rq},v0=nl((l,i)=>{let o=l-i;return o*o}),aq=ml(m.SquaredDifference,v0),fO={kernelName:m.SquaredDifference,backendName:"cpu",kernelFunc:aq},ST=y0((l,i)=>{let{pattern:o,replaceGlobal:u,rewrite:c}=i;return l.replace(new RegExp(o,u?"g":""),c)}),oq=$g(m.StaticRegexReplace,ST),_T={kernelName:m.StaticRegexReplace,backendName:"cpu",kernelFunc:oq};function pO(l,i,o,u){let c=(0,m.buffer)(l,i.dtype);for(let f=0;f<c.size;f++){let y=c.indexToLoc(f),w=new Array(y.length);for(let C=0;C<w.length;C++)w[C]=y[C]*o[C]+u[C];c.set(i.get(...w),...y)}return c}class Sct{constructor(i,o,u,c,f,y){this.separator=m.util.encodeString(i),this.nGramWidths=o,this.leftPad=m.util.encodeString(u),this.rightPad=m.util.encodeString(c),this.padWidth=f,this.preserveShort=y}getPadWidth(i){return Math.min(this.padWidth<0?i-1:this.padWidth,i-1)}getNumNGrams(i,o){let u=this.getPadWidth(o);return Math.max(0,i+2*u-o+1)}createNGrams(i,o,u,c,f,y){for(let w=0;w<f;++w){let C=this.getPadWidth(y),T=Math.max(0,C-w),x=Math.max(0,C-(f-(w+1))),A=y-(T+x),M=o+(T>0?0:w-C),$=0;$+=T*this.leftPad.length;for(let nt=0;nt<A;++nt)$+=i[M+nt].length;$+=x*this.rightPad.length,$+=(T+x+A-1)*this.separator.length,u[c+w]=new Uint8Array($);let V=u[c+w],G=0,Q=nt=>nt.forEach(it=>V[G++]=it);for(let nt=0;nt<T;++nt)Q(this.leftPad),Q(this.separator);for(let nt=0;nt<A-1;++nt)Q(i[M+nt]),Q(this.separator);if(A>0){Q(i[M+A-1]);for(let nt=0;nt<x;++nt)Q(this.separator),Q(this.rightPad)}else{for(let nt=0;nt<x-1;++nt)Q(this.rightPad),Q(this.separator);Q(this.rightPad)}}}compute(i,o){let u=i.length,c=o.length;if(c>0){let C=o[0];if(C!==0)throw new Error(`First split value must be 0, got ${C}`);for(let T=1;T<c;++T){let x=o[T]>=C;if(x=x&&o[T]<=u,!x)throw new Error(`Invalid split value ${o[T]}, must be in [${C}, ${u}]`);C=o[T]}if(C!==u)throw new Error(`Last split value must be data size. Expected ${u}, got ${C}`)}let f=c-1,y=m.util.getArrayFromDType("int32",c);if(u===0||c===0){let C=new Array(u);for(let T=0;T<=f;++T)y[T]=0;return[C,y]}y[0]=0;for(let C=1;C<=f;++C){let T=o[C]-o[C-1],x=0;this.nGramWidths.forEach(A=>{x+=this.getNumNGrams(T,A)}),this.preserveShort&&T>0&&x===0&&(x=1),y[C]=y[C-1]+x}let w=new Array(y[f]);for(let C=0;C<f;++C){let T=o[C],x=y[C];if(this.nGramWidths.forEach(A=>{let M=o[C+1]-o[C],$=this.getNumNGrams(M,A);this.createNGrams(i,T,w,x,$,A),x+=$}),this.preserveShort&&x===y[C]){let A=o[C+1]-o[C];if(A===0)continue;let M=A+2*this.padWidth;this.createNGrams(i,T,w,x,1,M)}}return[w,y]}}function sq(l,i,o,u,c,f,y,w){return new Sct(o,u,c,f,y,w).compute(l,i)}function _ct(l,i,o,u){if(!l.length)return;if(i.length===0){for(let f=0;f<l.length;++f)u.push(l.subarray(f,f+1));return}if(i.length===1){let f=i[0],y=l.indexOf(f);for(;y!==-1;){let w=l.subarray(0,y);o&&w.length===0||u.push(w),y=(l=l.subarray(y+1)).indexOf(f)}return void(o&&l.length===0||u.push(l))}let c=0;for(let f=0;f<l.length+1;f++)if(f===l.length||i.indexOf(l[f])!==-1){let y=l.subarray(c,f);o&&y.length===0||u.push(y),c=f+1}}function zS(l,i,o){let u=l.length,c=[],f=0,y=0,w=new Array(u);for(let M=0;M<u;++M){let $=c.length;_ct(l[M],i,o,c);let V=c.length-$;w[M]=V,f+=V,y=Math.max(y,V)}let C=m.util.getArrayFromDType("int32",2*f),T=new Array(f),x=[u,y],A=0;for(let M=0;M<u;++M)for(let $=0;$<w[M];++$)C[2*A]=M,C[2*A+1]=$,T[A]=c[A],++A;return[C,T,x]}function mO(l,i){let o=m.util.getArrayFromDType("int32",l.length);for(let u=0;u<l.length;++u)o[u]=m.util.fingerPrint64(l[u]).modulo(i).getLowBitsUnsigned();return o}let CT=nl((l,i)=>l-i),uq=rT((l,i,o,u)=>({real:l-o,imag:i-u})),ET=ml(m.Sub,CT,uq),Cct={kernelName:m.Sub,backendName:"cpu",kernelFunc:ET};function lq(l,i){let o=new Array(l.rank);for(let c=0;c<o.length;c++)o[c]=l.shape[c]*i[c];let u=(0,m.buffer)(o,l.dtype);for(let c=0;c<u.values.length;++c){let f=u.indexToLoc(c),y=new Array(l.rank);for(let C=0;C<y.length;C++)y[C]=f[C]%l.shape[C];let w=l.locToIndex(y);u.values[c]=l.values[w]}return u}let tx=(l,i)=>{let o=i.value-l.value;return o===0?l.index-i.index:o};function cq(l,i,o=0,u=l.length-1){for(;u>o;){if(u-o>600){let w=u-o+1,C=i-o+1,T=Math.log(w),x=.5*Math.exp(2*T/3),A=.5*Math.sqrt(T*x*(w-x)/w)*Math.sign(C-w/2);cq(l,i,Math.max(o,Math.floor(i-C*x/w+A)),Math.min(u,Math.floor(i+(w-C)*x/w+A)))}let c=l[i],f=o,y=u;for(m.util.swap(l,o,i),tx(l[u],c)>0&&m.util.swap(l,o,u);f<y;){for(m.util.swap(l,f,y),f++,y--;tx(l[f],c)<0;)f+=1;for(;tx(l[y],c)>0;)y-=1}tx(l[o],c)===0?m.util.swap(l,o,y):(y+=1,m.util.swap(l,y,u)),y<=i&&(o=y+1),i<=y&&(u=y-1)}}function gO(l,i,o,u,c){let f=i[i.length-1],[y,w]=[l.length/f,f],C=m.util.getTypedArrayFromDType(o,y*u),T=m.util.getTypedArrayFromDType("int32",y*u);for(let A=0;A<y;A++){let M=A*w,$=l.subarray(M,M+w),V=new Array($.length);$.forEach((it,ht)=>V[ht]={value:it,index:ht}),u<V.length&&(cq(V,u),V=V.slice(0,u)),c&&V.sort(tx);let G=A*u,Q=C.subarray(G,G+u),nt=T.subarray(G,G+u);for(let it=0;it<u;it++)Q[it]=V[it].value,nt[it]=V[it].index}let x=i.slice();return x[x.length-1]=u,[(0,m.buffer)(x,o,C),(0,m.buffer)(x,"int32",T)]}function hq(l,i,o,u){let c=m.util.parseAxisParam(i,o)[0],f=[1,o[0],1];for(let V=0;V<c;V++)f[0]*=o[V];f[1]=o[c];for(let V=c+1;V<o.length;V++)f[2]*=o[V];let y=new Map,w=new Int32Array(o[c]),C=new m.TensorBuffer(f,u,l),T=[],x=f[0]===1&&f[2]===1;for(let V=0;V<o[c];V++){let G;if(x)G=l[V].toString();else{let nt=[];for(let it=0;it<f[0];it++)for(let ht=0;ht<f[2];ht++)nt.push(C.get(it,V,ht));G=nt.join(",")}let Q=y.get(G);if(Q!=null)w[V]=Q;else{let nt=y.size;y.set(G,nt),w[V]=nt,T.push(V)}}let A=f.slice();A[1]=y.size;let M=new m.TensorBuffer(A,u);T.forEach((V,G)=>{for(let Q=0;Q<f[0];Q++)for(let nt=0;nt<f[2];nt++)M.set(C.get(Q,V,nt),Q,G,nt)});let $=o.slice();return $[c]=A[1],{outputValues:M.values,outputShape:$,indices:w}}let dq="4.22.0";(0,m.registerBackend)("cpu",()=>new Xw,1);let yO=ns(m.Elu,l=>l>=0?l:Math.exp(l)-1),fq={kernelName:m.Elu,backendName:"cpu",kernelFunc:yO};function vO(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{alpha:f}=u;Ii([c],"leakyRelu");let y=m.util.sizeFromShape(c.shape),w=o.data.get(c.dataId).values,C=m.util.getTypedArrayFromDType("float32",y);for(let T=0;T<w.length;T++)C[T]=w[T]<0?f*w[T]:w[T];return o.makeTensorInfo(c.shape,"float32",C)}let pq={kernelName:m.LeakyRelu,backendName:"cpu",kernelFunc:vO},mq=nl((l,i)=>l<0?i*l:l);function bO(l){let{inputs:i,backend:o}=l,{x:u,alpha:c}=i;Ii([u,c],"prelu");let f=o.data.get(u.dataId).values,y=o.data.get(c.dataId).values,[w,C]=mq(u.shape,c.shape,f,y,"float32");return o.makeTensorInfo(C,"float32",w)}let wO={kernelName:m.Prelu,backendName:"cpu",kernelFunc:bO},xO=ns(m.Relu,l=>Math.max(0,l)),Ect={kernelName:m.Relu,backendName:"cpu",kernelFunc:xO},kO=ns(m.Relu6,l=>Math.min(Math.max(0,l),6)),SO={kernelName:m.Relu6,backendName:"cpu",kernelFunc:kO};function kf(l,i,o,u,c){if(o==="linear")return xf({inputs:{x:i},backend:l});if(o==="relu")return xO({inputs:{x:i},backend:l});if(o==="elu")return yO({inputs:{x:i},backend:l});if(o==="relu6")return kO({inputs:{x:i},backend:l});if(o==="prelu")return bO({inputs:{x:i,alpha:u},backend:l});if(o==="leakyrelu")return vO({inputs:{x:i},backend:l,attrs:{alpha:c}});if(o==="sigmoid")return eq({inputs:{x:i},backend:l});throw new Error(`Activation ${o} has not been implemented for the CPU backend.`)}function Cs(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{shape:f}=u,y=m.util.sizeFromShape(c.shape),w=m.util.inferFromImplicitShape(f,y),C=m.util.sizeFromShape(w);m.util.assert(y===C,()=>`The new shape (${w}) has ${C} elements and the old shape (${c.shape}) has ${y} elements. The new shape and old shape must have the same number of elements.`),o.incRef(c.dataId);let T=o.data.get(c.dataId);if(T.complexTensorInfos!=null){let x=T.complexTensorInfos.real,A=T.complexTensorInfos.imag;x.shape=w,A.shape=w}return{dataId:c.dataId,shape:w,dtype:c.dtype}}let _O={kernelName:m.Reshape,backendName:"cpu",kernelFunc:Cs};function TT(l){let{inputs:i,backend:o,attrs:u}=l,{a:c,b:f}=i,{transposeA:y,transposeB:w}=u;Ii([c,f],"matMul");let C=c.shape.length,T=f.shape.length,x=y?c.shape[C-2]:c.shape[C-1],A=w?f.shape[T-1]:f.shape[T-2],M=y?c.shape[C-1]:c.shape[C-2],$=w?f.shape[T-2]:f.shape[T-1],V=c.shape.slice(0,-2),G=f.shape.slice(0,-2),Q=m.util.sizeFromShape(V),nt=m.util.sizeFromShape(G),it=m.broadcast_util.assertAndGetBroadcastShape(c.shape.slice(0,-2),f.shape.slice(0,-2)).concat([M,$]);m.util.assert(x===A,()=>`Error in matMul: inner shapes (${x}) and (${A}) of Tensors with shapes ${c.shape} and ${f.shape} and transposeA=${y} and transposeB=${w} must match.`);let ht=w?[nt,$,A]:[nt,A,$],kt=Cs({inputs:{x:c},backend:o,attrs:{shape:y?[Q,x,M]:[Q,M,x]}}),Nt=Cs({inputs:{x:f},backend:o,attrs:{shape:ht}}),$t=y?kt.shape[1]:kt.shape[2],Ut=y?kt.shape[2]:kt.shape[1],Pt=w?Nt.shape[1]:Nt.shape[2],re=Math.max(Q,nt),ue=o.data.get(kt.dataId).values,be=o.data.get(Nt.dataId).values,De=m.util.computeStrides(kt.shape),ze=m.util.computeStrides(Nt.shape),[Qe,cn,en]=y?[De[0],1,De[1]]:[De[0],De[1],1],[sn,xn,Rn]=w?[1,ze[1],ze[0]]:[ze[1],1,ze[0]],Bn=Ut*Pt,Fn=(0,m.buffer)([re,Ut,Pt],kt.dtype),Xn=Fn.values,Nn=o.blockSize;for(let kr=0;kr<re;kr++){let Tr=kr%Q,Ar=kr%nt;for(let Dr=0;Dr<Ut;Dr+=Nn){let Ni=Math.min(Dr+Nn,Ut);for(let Mi=0;Mi<Pt;Mi+=Nn){let Yi=Math.min(Mi+Nn,Pt);for(let Hr=0;Hr<$t;Hr+=Nn){let wa=Math.min(Hr+Nn,$t);for(let Oa=Dr;Oa<Ni;Oa++)for(let Xa=Mi;Xa<Yi;Xa++){let ta=0;for(let xa=Hr;xa<wa;xa++)ta+=ue[Tr*Qe+Oa*cn+xa*en]*be[xa*sn+Xa*xn+Ar*Rn];Xn[kr*Bn+(Oa*Pt+Xa)]+=ta}}}}}return o.disposeIntermediateTensorInfo(kt),o.disposeIntermediateTensorInfo(Nt),o.makeTensorInfo(it,Fn.dtype,Fn.values)}let CO={kernelName:m.BatchMatMul,backendName:"cpu",kernelFunc:TT},Tct={kernelName:m._FusedMatMul,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{a:c,b:f,bias:y,preluActivationWeights:w}=i,{transposeA:C,transposeB:T,activation:x,leakyreluAlpha:A}=u,M,$,V,G=[];M=TT({inputs:{a:c,b:f},attrs:{transposeA:C,transposeB:T},backend:o}),y&&($=_2({inputs:{a:M,b:y},backend:o}),G.push(M),M=$),x&&(V=kf(o,M,x,w,A),G.push(M),M=V);for(let Q of G)o.disposeIntermediateTensorInfo(Q);return M}},EO=ns(m.Acos,l=>Math.acos(l)),Pg={kernelName:m.Acos,backendName:"cpu",kernelFunc:EO},gq=ns(m.Acosh,l=>Math.acosh(l)),Act={kernelName:m.Acosh,backendName:"cpu",kernelFunc:gq},yq={kernelName:m.AddN,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,u=i;Ii(i,"addN");let c=u.map(w=>o.data.get(w.dataId).values),f=(0,m.buffer)(u[0].shape,u[0].dtype),y=f.values;for(let w=0;w<u.length;w++){let C=c[w];for(let T=0;T<y.length;T++)y[T]+=C[T]}return o.makeTensorInfo(f.shape,f.dtype,f.values)}},Ict={kernelName:m.All,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,keepDims:y}=u;Ii(c,"all");let w=m.util.parseAxisParam(f,c.shape),C=w,T=m.backend_util.getAxesPermutation(C,c.shape.length),x=c;T!=null&&(x=Gc({inputs:{x:c},backend:o,attrs:{perm:T}}),C=m.backend_util.getInnerMostAxes(C.length,c.shape.length)),m.backend_util.assertAxesAreInnerMostDims("all",C,x.shape.length);let[A,M]=m.backend_util.computeOutAndReduceShapes(x.shape,C),$=m.util.sizeFromShape(M),V=m.util.makeZerosTypedArray(m.util.sizeFromShape(A),x.dtype),G=o.data.get(x.dataId).values;for(let nt=0;nt<V.length;++nt){let it=nt*$,ht=G[it];for(let kt=0;kt<$;++kt){let Nt=G[it+kt];ht=ht&&Nt}V[nt]=ht}T!=null&&o.disposeIntermediateTensorInfo(x);let Q=o.makeTensorInfo(A,x.dtype,V);if(y){let nt=Cs({inputs:{x:Q},backend:o,attrs:{shape:m.backend_util.expandShapeToKeepDim(A,w)}});return o.disposeIntermediateTensorInfo(Q),nt}return Q}},Nct={kernelName:m.Any,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,keepDims:y}=u;Ii(c,"any");let w=m.util.parseAxisParam(f,c.shape),C=w,T=m.backend_util.getAxesPermutation(C,c.shape.length),x=c;T!=null&&(x=Gc({inputs:{x:c},backend:o,attrs:{perm:T}}),C=m.backend_util.getInnerMostAxes(C.length,c.shape.length)),m.backend_util.assertAxesAreInnerMostDims("any",C,x.shape.length);let[A,M]=m.backend_util.computeOutAndReduceShapes(x.shape,C),$=m.util.sizeFromShape(M),V=m.util.makeZerosTypedArray(m.util.sizeFromShape(A),x.dtype),G=o.data.get(x.dataId).values;for(let nt=0;nt<V.length;++nt){let it=nt*$,ht=G[it];for(let kt=0;kt<$;++kt){let Nt=G[it+kt];ht=ht||Nt}V[nt]=ht}T!=null&&o.disposeIntermediateTensorInfo(x);let Q=o.makeTensorInfo(A,x.dtype,V);if(y){let nt=Cs({inputs:{x:Q},backend:o,attrs:{shape:m.backend_util.expandShapeToKeepDim(A,w)}});return o.disposeIntermediateTensorInfo(Q),nt}return Q}},vq={kernelName:m.ArgMax,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f}=u;Ii(c,"argMax");let y=m.util.parseAxisParam(f,c.shape),w=m.backend_util.getAxesPermutation(y,c.shape.length),C=c,T=[];w!=null&&(C=Gc({inputs:{x:c},backend:o,attrs:{perm:w}}),T.push(C),y=m.backend_util.getInnerMostAxes(y.length,C.shape.length)),y=[y[0]],m.backend_util.assertAxesAreInnerMostDims("argMax",y,C.shape.length);let[x,A]=m.backend_util.computeOutAndReduceShapes(C.shape,y),M=m.util.sizeFromShape(x),$=m.util.makeZerosTypedArray(M,"int32"),V=m.util.sizeFromShape(A),G=o.data.get(C.dataId).values;for(let Q=0;Q<$.length;++Q){let nt=Q*V,it=G[nt],ht=0;for(let kt=0;kt<V;++kt){let Nt=G[nt+kt];Nt>it&&(it=Nt,ht=kt)}$[Q]=ht}return T.forEach(Q=>o.disposeIntermediateTensorInfo(Q)),o.makeTensorInfo(x,"int32",$)}},TO={kernelName:m.ArgMin,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f}=u;Ii(c,"argMin");let y=m.util.parseAxisParam(f,c.shape),w=m.backend_util.getAxesPermutation(y,c.shape.length),C=c,T=[];w!=null&&(C=Gc({inputs:{x:c},backend:o,attrs:{perm:w}}),T.push(C),y=m.backend_util.getInnerMostAxes(y.length,C.shape.length)),y=[y[0]],m.backend_util.assertAxesAreInnerMostDims("argMin",y,C.shape.length);let[x,A]=m.backend_util.computeOutAndReduceShapes(C.shape,y),M=m.util.sizeFromShape(x),$=m.util.makeZerosTypedArray(M,"int32"),V=m.util.sizeFromShape(A),G=o.data.get(C.dataId).values;for(let Q=0;Q<$.length;++Q){let nt=Q*V,it=G[nt],ht=0;for(let kt=0;kt<V;++kt){let Nt=G[nt+kt];Nt<it&&(it=Nt,ht=kt)}$[Q]=ht}return T.forEach(Q=>o.disposeIntermediateTensorInfo(Q)),o.makeTensorInfo(x,"int32",$)}},AO=ns(m.Asin,l=>Math.asin(l)),AT={kernelName:m.Asin,backendName:"cpu",kernelFunc:AO},PS=ns(m.Asinh,l=>Math.asinh(l)),bq={kernelName:m.Asinh,backendName:"cpu",kernelFunc:PS},wq=ns(m.Atan,l=>Math.atan(l)),xq={kernelName:m.Atan,backendName:"cpu",kernelFunc:wq},IO=nl((l,i)=>Math.atan2(l,i)),Yv=ml(m.Atan2,IO),kq={kernelName:m.Atan2,backendName:"cpu",kernelFunc:Yv},Mct=ns(m.Atanh,l=>Math.atanh(l)),Dct={kernelName:m.Atanh,backendName:"cpu",kernelFunc:Mct};function NO(l,i,o,u,c,f){let y=c.strideHeight,w=c.strideWidth,C=c.dilationHeight,T=c.dilationWidth,x=c.effectiveFilterHeight,A=c.effectiveFilterWidth,M=c.padInfo.top,$=c.padInfo.left,V=f==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,G=(0,m.buffer)(c.outShape,o),Q=G.values,nt=c.outShape[1]*c.outShape[2]*c.outShape[3],it=c.outShape[2]*c.outShape[3],ht=c.outShape[3];for(let kt=0;kt<c.batchSize;++kt){let Nt=kt*nt,$t=kt*u[0];for(let Ut=0;Ut<c.inChannels;++Ut)for(let Pt=0;Pt<c.outHeight;++Pt){let re=Pt*y-M,ue=Math.max(0,re),be=Math.min(c.inHeight,x+re),De=Nt+Pt*it;for(let ze=0;ze<c.outWidth;++ze){let Qe=ze*w-$,cn=Math.max(0,Qe),en=Math.min(c.inWidth,A+Qe),sn=V,xn=0,Rn=0;for(let Bn=ue;Bn<be;Bn+=C){let Fn=$t+Bn*u[1];for(let Xn=cn;Xn<en;Xn+=T){let Nn=l[Fn+Xn*u[2]+Ut];f==="max"&&Nn>sn?sn=Nn:f==="avg"&&(xn+=Nn,Rn++)}if(isNaN(sn))break}Q[De+ze*ht+Ut]=f==="avg"?xn/Rn:sn}}}return G}function b0(l,i,o,u,c=!1,f=!1){let y=(0,m.buffer)(u.outShape,"int32"),w=u.strideHeight,C=u.strideWidth,T=u.dilationHeight,x=u.dilationWidth,A=u.effectiveFilterHeight,M=u.effectiveFilterWidth,$=u.padInfo.top,V=u.padInfo.left,G=(0,m.buffer)(i,o,l);for(let Q=0;Q<u.batchSize;++Q)for(let nt=0;nt<u.inChannels;++nt)for(let it=0;it<u.outHeight;++it){let ht=it*w-$,kt=ht;for(;kt<0;)kt+=T;let Nt=Math.min(u.inHeight,A+ht);for(let $t=0;$t<u.outWidth;++$t){let Ut=$t*C-V,Pt=Ut;for(;Pt<0;)Pt+=x;let re=Math.min(u.inWidth,M+Ut),ue=Number.NEGATIVE_INFINITY,be=-1;for(let De=kt;De<Nt;De+=T){let ze=De-ht;for(let Qe=Pt;Qe<re;Qe+=x){let cn=Qe-Ut,en=G.get(Q,De,Qe,nt);en>ue&&(ue=en,be=c?f?((Q*u.inHeight+De)*u.inWidth+Qe)*u.inChannels+nt:(De*u.inWidth+Qe)*u.inChannels+nt:ze*M+cn)}}y.set(be,Q,it,$t,nt)}}return y}function IT(l,i,o,u,c,f){let y=c.strideDepth,w=c.strideHeight,C=c.strideWidth,T=c.dilationDepth,x=c.dilationHeight,A=c.dilationWidth,M=c.effectiveFilterDepth,$=c.effectiveFilterHeight,V=c.effectiveFilterWidth,G=c.padInfo.front,Q=c.padInfo.top,nt=c.padInfo.left,it=f==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,ht=(0,m.buffer)(c.outShape,o),kt=ht.values,Nt=c.outShape[1]*c.outShape[2]*c.outShape[3]*c.outShape[4],$t=c.outShape[2]*c.outShape[3]*c.outShape[4],Ut=c.outShape[3]*c.outShape[4],Pt=c.outShape[4];for(let re=0;re<c.batchSize;++re){let ue=re*Nt,be=re*u[0];for(let De=0;De<c.inChannels;++De)for(let ze=0;ze<c.outDepth;++ze){let Qe=ze*y-G,cn=Qe;for(;cn<0;)cn+=T;let en=Math.min(c.inDepth,M+Qe),sn=ue+ze*$t;for(let xn=0;xn<c.outHeight;++xn){let Rn=xn*w-Q,Bn=Rn;for(;Bn<0;)Bn+=x;let Fn=Math.min(c.inHeight,$+Rn),Xn=sn+xn*Ut;for(let Nn=0;Nn<c.outWidth;++Nn){let kr=Nn*C-nt,Tr=kr;for(;Tr<0;)Tr+=A;let Ar=Math.min(c.inWidth,V+kr),Dr=Xn+Nn*Pt,Ni=it,Mi=0,Yi=0;for(let Hr=cn;Hr<en;Hr+=T){let wa=be+Hr*u[1];for(let Oa=Bn;Oa<Fn;Oa+=x){let Xa=wa+Oa*u[2];for(let ta=Tr;ta<Ar;ta+=A){let xa=l[Xa+ta*u[3]+De];if(f==="max"&&xa>Ni?Ni=xa:f==="avg"&&(Mi+=xa,Yi++),isNaN(Ni))break}if(isNaN(Ni))break}if(isNaN(Ni))break}kt[Dr+De]=f==="avg"?Mi/Math.max(Yi,1):Ni}}}}return ht}let MO={kernelName:m.AvgPool,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i;Ii(c,"avgPool");let{filterSize:f,strides:y,pad:w,dimRoundingMode:C}=u;m.util.assert(m.backend_util.eitherStridesOrDilationsAreOne(y,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${y} and dilations '1'`);let T=m.backend_util.computePool2DInfo(c.shape,f,y,1,w,C),x;if(T.filterWidth===1&&T.filterHeight===1&&m.util.arraysEqual(T.inShape,T.outShape))x=xf({inputs:{x:c},backend:o});else{let A=o.data.get(c.dataId).values,M=m.util.computeStrides(c.shape),$=NO(A,c.shape,c.dtype,M,T,"avg");x=o.makeTensorInfo(T.outShape,c.dtype,$.values)}return x}},DO={kernelName:m.AvgPool3D,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{filterSize:f,strides:y,pad:w,dimRoundingMode:C,dataFormat:T}=u;Ii(c,"avgPool3d");let x=m.backend_util.computePool3DInfo(c.shape,f,y,1,w,C,T),A=IT(o.data.get(c.dataId).values,c.shape,c.dtype,m.util.computeStrides(c.shape),x,"avg");return o.makeTensorInfo(A.shape,"float32",A.values)}},RO={kernelName:m.AvgPool3DGrad,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,input:f}=i,{filterSize:y,strides:w,pad:C,dimRoundingMode:T}=u;Ii([c,f],"avgPool3DGrad");let x=m.backend_util.computePool3DInfo(f.shape,y,w,1,C,T),A=x.strideDepth,M=x.strideHeight,$=x.strideWidth,V=x.filterDepth,G=x.filterHeight,Q=x.filterWidth,nt=x.dilationDepth,it=x.dilationHeight,ht=x.dilationWidth,kt=x.effectiveFilterDepth,Nt=x.effectiveFilterHeight,$t=x.effectiveFilterWidth,Ut=kt-1-x.padInfo.front,Pt=$t-1-x.padInfo.left,re=Nt-1-x.padInfo.top,ue=(0,m.buffer)(f.shape,"float32"),be=1/(V*G*Q),De=o.bufferSync(c);for(let ze=0;ze<x.batchSize;++ze)for(let Qe=0;Qe<x.inChannels;++Qe)for(let cn=0;cn<x.inDepth;++cn)for(let en=0;en<x.inHeight;++en)for(let sn=0;sn<x.inWidth;++sn){let xn=cn-Ut,Rn=en-re,Bn=sn-Pt,Fn=0;for(let Xn=0;Xn<kt;Xn+=nt){let Nn=(xn+Xn)/A;if(!(Nn<0||Nn>=x.outDepth||Math.floor(Nn)!==Nn))for(let kr=0;kr<Nt;kr+=it){let Tr=(Rn+kr)/M;if(!(Tr<0||Tr>=x.outHeight||Math.floor(Tr)!==Tr))for(let Ar=0;Ar<$t;Ar+=ht){let Dr=(Bn+Ar)/$;Dr<0||Dr>=x.outWidth||Math.floor(Dr)!==Dr||(Fn+=De.get(ze,Nn,Tr,Dr,Qe))}}}ue.set(Fn*be,ze,cn,en,sn,Qe)}return o.makeTensorInfo(ue.shape,ue.dtype,ue.values)}},FO={kernelName:m.AvgPoolGrad,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,input:f}=i,y=f;Ii([c,f],"avgPoolGrad");let{filterSize:w,strides:C,pad:T}=u,x=m.backend_util.computePool2DInfo(y.shape,w,C,1,T),A=x.strideHeight,M=x.strideWidth,$=x.filterHeight,V=x.filterWidth,G=x.dilationHeight,Q=x.dilationWidth,nt=x.effectiveFilterHeight,it=x.effectiveFilterWidth,ht=it-1-x.padInfo.left,kt=nt-1-x.padInfo.top,Nt=(0,m.buffer)(y.shape,"float32"),$t=1/($*V),Ut=o.data.get(c.dataId).values,Pt=(0,m.buffer)(c.shape,"float32",Ut);for(let re=0;re<x.batchSize;++re)for(let ue=0;ue<x.inChannels;++ue)for(let be=0;be<x.inHeight;++be)for(let De=0;De<x.inWidth;++De){let ze=be-kt,Qe=De-ht,cn=0;for(let en=0;en<nt;en+=G){let sn=(ze+en)/A;if(!(sn<0||sn>=x.outHeight||Math.floor(sn)!==sn))for(let xn=0;xn<it;xn+=Q){let Rn=(Qe+xn)/M;Rn<0||Rn>=x.outWidth||Math.floor(Rn)!==Rn||(cn+=Pt.get(re,sn,Rn,ue))}}Nt.set(cn*$t,re,be,De,ue)}return o.makeTensorInfo(Nt.shape,Nt.dtype,Nt.values)}},OO={kernelName:m.FusedBatchNorm,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,scale:f,offset:y,mean:w,variance:C}=i;m.util.assert(w.shape.length===C.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),m.util.assert(y==null||w.shape.length===y.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),m.util.assert(f==null||w.shape.length===f.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ii([c,w,C,f,y],"batchNorm");let{varianceEpsilon:T}=u;T==null&&(T=.001);let x=o.data.get(c.dataId).values,A=o.data.get(w.dataId).values,M=o.data.get(C.dataId).values,$=f?o.data.get(f.dataId).values:new Float32Array([1]),V=y?o.data.get(y.dataId).values:new Float32Array([0]),G=new Float32Array(x.length),Q=V.length,nt=$.length,it=M.length,ht=A.length,kt=0,Nt=0,$t=0,Ut=0;for(let Pt=0;Pt<x.length;++Pt)G[Pt]=V[kt++]+(x[Pt]-A[Nt++])*$[$t++]/Math.sqrt(M[Ut++]+T),kt>=Q&&(kt=0),Nt>=ht&&(Nt=0),$t>=nt&&($t=0),Ut>=it&&(Ut=0);return o.makeTensorInfo(c.shape,c.dtype,G)}},LO={kernelName:m.BatchToSpaceND,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{blockShape:f,crops:y}=u;Ii([c],"batchToSpaceND");let w=f.reduce((nt,it)=>nt*it),C=m.backend_util.getReshaped(c.shape,f,w),T=m.backend_util.getPermuted(C.length,f.length),x=m.backend_util.getReshapedPermuted(c.shape,f,w),A=m.backend_util.getSliceBeginCoords(y,f.length),M=m.backend_util.getSliceSize(x,y,f.length),$=Cs({inputs:{x:c},backend:o,attrs:{shape:C}}),V=Gc({inputs:{x:$},backend:o,attrs:{perm:T}}),G=Cs({inputs:{x:V},backend:o,attrs:{shape:x}}),Q=A2({inputs:{x:G},backend:o,attrs:{begin:A,size:M}});return o.disposeIntermediateTensorInfo($),o.disposeIntermediateTensorInfo(V),o.disposeIntermediateTensorInfo(G),Q}},$O={kernelName:m.Bincount,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,weights:f}=i,{size:y}=u,w=tO(o.data.get(c.dataId).values,o.data.get(f.dataId).values,f.dtype,f.shape,y);return o.makeTensorInfo([y],f.dtype,w)}},zO={kernelName:m.BroadcastArgs,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{s0:u,s1:c}=i,f=o.data.get(u.dataId).values,y=o.data.get(c.dataId).values,w=m.backend_util.assertAndGetBroadcastShape(Array.from(f),Array.from(y));return o.makeTensorInfo([w.length],"int32",Int32Array.from(w))}},PO=ns(m.ClipByValue,(l,i)=>{let o=i;return l>o.clipValueMax?o.clipValueMax:l<o.clipValueMin?o.clipValueMin:l}),BO={kernelName:m.ClipByValue,backendName:"cpu",kernelFunc:PO},ex={kernelName:m.ComplexAbs,backendName:"cpu",kernelFunc:l=>{let{x:i}=l.inputs,o=l.backend,u=new Float32Array(m.util.sizeFromShape(i.shape)),c=o.data.get(i.dataId),f=c.complexTensorInfos.real,y=c.complexTensorInfos.imag,w=o.data.get(f.dataId).values,C=o.data.get(y.dataId).values;for(let T=0;T<w.length;T++){let x=w[T],A=C[T];u[T]=Math.hypot(x,A)}return o.makeOutput(u,i.shape,"float32")}};function zd(l){let{inputs:i,backend:o}=l,{input:u}=i,c=o.data.get(u.dataId).complexTensorInfos.imag,f=o.data.get(c.dataId).values;return o.makeTensorInfo(c.shape,c.dtype,f)}let BS={kernelName:m.Imag,backendName:"cpu",kernelFunc:zd};function xm(l){let{inputs:i,backend:o,attrs:u}=l,{axis:c}=u,f=m.util.parseAxisParam(c,i[0].shape)[0],y=i.map(G=>G.shape);m.backend_util.assertParamsConsistent(y,f);let w=m.backend_util.computeOutShape(i.map(G=>G.shape),f);if(m.util.sizeFromShape(w)===0)return o.makeTensorInfo(w,i[0].dtype,[]);let C=i.filter(G=>m.util.sizeFromShape(G.shape)>0);if(C.length===1)return xf({inputs:{x:C[0]},backend:o});if(C[0].dtype==="complex64"){let G=C.map(kt=>Pv({inputs:{input:kt},backend:o})),Q=C.map(kt=>zd({inputs:{input:kt},backend:o})),nt=xm({inputs:G,backend:o,attrs:{axis:f}}),it=xm({inputs:Q,backend:o,attrs:{axis:f}}),ht=Od({inputs:{real:nt,imag:it},backend:o});return G.forEach(kt=>o.disposeIntermediateTensorInfo(kt)),Q.forEach(kt=>o.disposeIntermediateTensorInfo(kt)),o.disposeIntermediateTensorInfo(nt),o.disposeIntermediateTensorInfo(it),ht}let T=C.map(G=>{let Q=m.util.sizeFromShape(G.shape.slice(f));return Cs({inputs:{x:G},backend:o,attrs:{shape:[-1,Q]}})}),x=T.map(G=>({vals:o.data.get(G.dataId).values,shape:G.shape}));w=m.backend_util.computeOutShape(T.map(G=>G.shape),1);let A=T[0].shape[0]===1,M=VY(x,w,i[0].dtype,A),$=m.backend_util.computeOutShape(C.map(G=>G.shape),f),V=o.makeTensorInfo($,i[0].dtype,M);return T.forEach(G=>o.disposeIntermediateTensorInfo(G)),V}let NT={kernelName:m.Concat,backendName:"cpu",kernelFunc:xm};function I2(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f}=i,{strides:y,pad:w,dataFormat:C,dilations:T,dimRoundingMode:x}=u;Ii([c,f],"conv2d");let A=m.backend_util.convertConv2DDataFormat(C),M=m.backend_util.computeConv2DInfo(c.shape,f.shape,y,T,w,x,!1,A),$=M.filterHeight,V=M.filterWidth,G=M.dilationHeight,Q=M.dilationWidth,nt=M.padInfo.left,it=M.padInfo.top,ht=M.dataFormat==="channelsLast",kt=new m.TensorBuffer(M.outShape,c.dtype),Nt=m.util.computeStrides(c.shape),$t=m.util.computeStrides(f.shape),Ut=Nt[0],Pt=ht?Nt[1]:Nt[2],re=ht?Nt[2]:1,ue=ht?1:Nt[1],be=kt.strides[0],De=ht?kt.strides[1]:kt.strides[2],ze=ht?kt.strides[2]:1,Qe=ht?1:kt.strides[1],cn=o.data.get(c.dataId).values,en=o.data.get(f.dataId).values,sn=kt.values;for(let xn=0;xn<M.batchSize;++xn){let Rn=xn*Ut,Bn=xn*be;for(let Fn=0;Fn<M.outHeight;++Fn){let Xn=Bn+Fn*De,Nn=Fn*M.strideHeight-it;for(let kr=0;kr<$;++kr){let Tr=Nn+kr*G;if(Tr<0||Tr>=M.inHeight)continue;let Ar=kr*$t[0],Dr=Rn+Tr*Pt;for(let Ni=0;Ni<M.outWidth;++Ni){let Mi=Xn+Ni*ze,Yi=Ni*M.strideWidth-nt;for(let Hr=0;Hr<V;++Hr){let wa=Yi+Hr*Q;if(wa<0||wa>=M.inWidth)continue;let Oa=Dr+wa*re,Xa=Ar+Hr*$t[1];for(let ta=0;ta<M.inChannels;++ta){let xa=cn[Oa+ta*ue];for(let Ka=0;Ka<M.outChannels;++Ka)sn[Mi+Ka*Qe]+=xa*en[Xa+Ka];Xa+=M.outChannels}}}}}}return o.makeTensorInfo(kt.shape,kt.dtype,sn)}let qv={kernelName:m.Conv2D,backendName:"cpu",kernelFunc:I2},km={kernelName:m.Conv2DBackpropFilter,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,dy:f}=i,{strides:y,pad:w,dataFormat:C,dimRoundingMode:T,filterShape:x}=u;Ii([c,f],"conv2dBackpropFilter");let A=m.backend_util.convertConv2DDataFormat(C),M=m.backend_util.computeConv2DInfo(c.shape,x,y,1,w,T,!1,A),{strideHeight:$,strideWidth:V,filterHeight:G,filterWidth:Q}=M,nt=M.dataFormat==="channelsLast",it=new m.TensorBuffer(M.filterShape,"float32"),ht=M.padInfo.left,kt=M.padInfo.top,Nt=o.data.get(c.dataId).values,$t=o.data.get(f.dataId).values,Ut=new m.TensorBuffer(c.shape,c.dtype,Nt),Pt=new m.TensorBuffer(f.shape,f.dtype,$t);for(let re=0;re<G;++re){let ue=Math.max(0,Math.ceil((kt-re)/$)),be=Math.min(M.outHeight,(M.inHeight+kt-re)/$);for(let De=0;De<Q;++De){let ze=Math.max(0,Math.ceil((ht-De)/V)),Qe=Math.min(M.outWidth,(M.inWidth+ht-De)/V);for(let cn=0;cn<M.inChannels;++cn)for(let en=0;en<M.outChannels;++en){let sn=0;for(let xn=0;xn<M.batchSize;++xn)for(let Rn=ue;Rn<be;++Rn){let Bn=re+Rn*$-kt;for(let Fn=ze;Fn<Qe;++Fn){let Xn=De+Fn*V-ht;sn+=nt?Ut.get(xn,Bn,Xn,cn)*Pt.get(xn,Rn,Fn,en):Ut.get(xn,cn,Bn,Xn)*Pt.get(xn,en,Rn,Fn)}}it.set(sn,re,De,cn,en)}}}return o.makeTensorInfo(it.shape,it.dtype,it.values)}},nx={kernelName:m.Conv2DBackpropInput,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,filter:f}=i,{inputShape:y,strides:w,pad:C,dataFormat:T,dimRoundingMode:x}=u;Ii([c,f],"conv2dBackpropInput");let A=m.util.computeStrides(f.shape),M=m.util.computeStrides(c.shape),$=m.backend_util.convertConv2DDataFormat(T),V=m.backend_util.computeConv2DInfo(y,f.shape,w,1,C,x,!1,$),G=new m.TensorBuffer(V.inShape,"float32"),Q=G.values,nt=o.data.get(c.dataId).values,it=o.data.get(f.dataId).values,[ht,kt,Nt]=A,{batchSize:$t,filterHeight:Ut,filterWidth:Pt,inChannels:re,inHeight:ue,inWidth:be,outChannels:De,outHeight:ze,outWidth:Qe,strideHeight:cn,strideWidth:en}=V;$=V.dataFormat;let sn=Ut-1-V.padInfo.top,xn=Pt-1-V.padInfo.left,Rn=$==="channelsLast",Bn=G.strides[0],Fn=Rn?G.strides[1]:G.strides[2],Xn=Rn?G.strides[2]:1,Nn=Rn?1:G.strides[1],kr=M[0],Tr=Rn?M[1]:M[2],Ar=Rn?M[2]:1,Dr=Rn?1:M[1];for(let Ni=0;Ni<$t;++Ni)for(let Mi=0;Mi<re;++Mi)for(let Yi=0;Yi<ue;++Yi){let Hr=Yi-sn,wa=Math.max(0,Math.ceil(Hr/cn)),Oa=Math.min(ze,(Ut+Hr)/cn);for(let Xa=0;Xa<be;++Xa){let ta=Xa-xn,xa=Math.max(0,Math.ceil(ta/en)),Ka=Math.min(Qe,(Pt+ta)/en),nu=0;for(let Ol=wa;Ol<Oa;++Ol){let Wu=Ol*cn-Hr;for(let vo=xa;vo<Ka;++vo){let eh=kr*Ni+Tr*Ol+Ar*vo,Ll=ht*(Ut-1-Wu)+kt*(Pt-1-(vo*en-ta))+Nt*Mi;for(let Cu=0;Cu<De;++Cu)nu+=nt[eh+Dr*Cu]*it[Ll+Cu]}}Q[Bn*Ni+Fn*Yi+Xn*Xa+Nn*Mi]=nu}}return o.makeTensorInfo(G.shape,G.dtype,G.values)}},rx={kernelName:m.Conv3D,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f}=i,{strides:y,pad:w,dilations:C}=u;Ii([c,f],"conv3d");let T=m.backend_util.computeConv3DInfo(c.shape,f.shape,y,C,w),{filterDepth:x,filterHeight:A,filterWidth:M,dilationDepth:$,dilationHeight:V,dilationWidth:G,padInfo:Q}=T,nt=Q.front,it=Q.left,ht=Q.top,kt=new m.TensorBuffer(T.outShape,c.dtype),Nt=o.data.get(c.dataId).values,$t=o.data.get(f.dataId).values,Ut=kt.values,Pt=m.util.computeStrides(c.shape),re=m.util.computeStrides(f.shape);for(let ue=0;ue<T.batchSize;++ue){let be=ue*Pt[0],De=ue*kt.strides[0];for(let ze=0;ze<T.outDepth;++ze){let Qe=De+ze*kt.strides[1],cn=ze*T.strideDepth-nt;for(let en=0;en<x;++en){let sn=cn+en*$;if(sn<0||sn>=T.inDepth)continue;let xn=en*re[0],Rn=be+sn*Pt[1];for(let Bn=0;Bn<T.outHeight;++Bn){let Fn=Qe+Bn*kt.strides[2],Xn=Bn*T.strideHeight-ht;for(let Nn=0;Nn<A;++Nn){let kr=Xn+Nn*V;if(kr<0||kr>=T.inHeight)continue;let Tr=xn+Nn*re[1],Ar=Rn+kr*Pt[2];for(let Dr=0;Dr<T.outWidth;++Dr){let Ni=Fn+Dr*T.outChannels,Mi=Dr*T.strideWidth-it;for(let Yi=0;Yi<M;++Yi){let Hr=Mi+Yi*G;if(Hr<0||Hr>=T.inWidth)continue;let wa=Tr+Yi*re[2],Oa=Ar+Hr*T.inChannels,Xa=wa;for(let ta=0;ta<T.inChannels;++ta){let xa=Nt[Oa+ta];for(let Ka=0;Ka<T.outChannels;++Ka)Ut[Ni+Ka]+=xa*$t[Xa+Ka];Xa+=T.outChannels}}}}}}}}return o.makeTensorInfo(kt.shape,kt.dtype,kt.values)}},MT={kernelName:m.Conv3DBackpropFilterV2,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,dy:f}=i,{strides:y,pad:w,filterShape:C}=u;Ii([c,f],"conv3dBackpropFilterV2");let T=m.util.computeStrides(c.shape),x=m.util.computeStrides(f.shape),A=m.backend_util.computeConv3DInfo(c.shape,C,y,1,w),M=A.strideDepth,$=A.strideHeight,V=A.strideWidth,G=A.filterDepth,Q=A.filterHeight,nt=A.filterWidth,it=new m.TensorBuffer(A.filterShape,"float32"),ht=it.values,[kt,Nt,$t,Ut]=it.strides,Pt=o.data.get(f.dataId).values,[re,ue,be,De]=x,ze=o.data.get(c.dataId).values,[Qe,cn,en,sn]=T,xn=A.padInfo.front,Rn=A.padInfo.left,Bn=A.padInfo.top;for(let Fn=0;Fn<G;++Fn){let Xn=Math.max(0,Math.ceil((xn-Fn)/M)),Nn=Math.min(A.outDepth,(A.inDepth+xn-Fn)/M),kr=Fn*kt;for(let Tr=0;Tr<Q;++Tr){let Ar=Math.max(0,Math.ceil((Bn-Tr)/$)),Dr=Math.min(A.outHeight,(A.inHeight+Bn-Tr)/$),Ni=Tr*Nt+kr;for(let Mi=0;Mi<nt;++Mi){let Yi=Math.max(0,Math.ceil((Rn-Mi)/V)),Hr=Math.min(A.outWidth,(A.inWidth+Rn-Mi)/V),wa=Mi*$t+Ni;for(let Oa=0;Oa<A.inChannels;++Oa){let Xa=Oa*Ut+wa;for(let ta=0;ta<A.outChannels;++ta){let xa=0;for(let Ka=0;Ka<A.batchSize;++Ka){let nu=Ka*Qe,Ol=Ka*re;for(let Wu=Xn;Wu<Nn;++Wu){let vo=(Fn+Wu*M-xn)*cn+nu,eh=Wu*ue+Ol;for(let Ll=Ar;Ll<Dr;++Ll){let Cu=(Tr+Ll*$-Bn)*en+vo,Vu=Ll*be+eh;for(let bl=Yi;bl<Hr;++bl){let $l=bl*De+Vu;xa+=ze[(Mi+bl*V-Rn)*sn+Cu+Oa]*Pt[$l+ta]}}}}ht[Xa+ta]=xa}}}}}return o.makeTensorInfo(it.shape,it.dtype,it.values)}},DT={kernelName:m.Conv3DBackpropInputV2,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,filter:f}=i,{pad:y,strides:w,inputShape:C}=u;Ii([c],"conv3dBackpropInputV2");let T=m.util.computeStrides(c.shape),x=m.util.computeStrides(f.shape),A=m.backend_util.computeConv3DInfo(C,f.shape,w,1,y),M=new m.TensorBuffer(A.inShape,"float32"),$=M.values,[V,G,Q,nt]=M.strides,it=o.data.get(c.dataId).values,[ht,kt,Nt,$t]=T,Ut=o.data.get(f.dataId).values,[Pt,re,ue,be]=x,{batchSize:De,filterDepth:ze,filterHeight:Qe,filterWidth:cn,inChannels:en,inDepth:sn,inHeight:xn,inWidth:Rn,outChannels:Bn,outDepth:Fn,outHeight:Xn,outWidth:Nn,strideDepth:kr,strideHeight:Tr,strideWidth:Ar}=A,Dr=ze-1-A.padInfo.front,Ni=Qe-1-A.padInfo.top,Mi=cn-1-A.padInfo.left;for(let Yi=0;Yi<De;++Yi)for(let Hr=0;Hr<en;++Hr)for(let wa=0;wa<sn;++wa){let Oa=wa-Dr,Xa=Math.max(0,Math.ceil(Oa/kr)),ta=Math.min(Fn,(ze+Oa)/kr);for(let xa=0;xa<xn;++xa){let Ka=xa-Ni,nu=Math.max(0,Math.ceil(Ka/Tr)),Ol=Math.min(Xn,(Qe+Ka)/Tr);for(let Wu=0;Wu<Rn;++Wu){let vo=Wu-Mi,eh=Math.max(0,Math.ceil(vo/Ar)),Ll=Math.min(Nn,(cn+vo)/Ar),Cu=0;for(let Vu=Xa;Vu<ta;++Vu){let bl=Vu*kr-Oa;for(let $l=nu;$l<Ol;++$l){let Zd=$l*Tr-Ka;for(let ld=eh;ld<Ll;++ld){let Qd=ht*Yi+kt*Vu+Nt*$l+$t*ld,kc=Pt*(ze-1-bl)+re*(Qe-1-Zd)+ue*(cn-1-(ld*Ar-vo))+be*Hr;for(let Jd=0;Jd<Bn;++Jd)Cu+=it[Qd+Jd]*Ut[kc+Jd]}}}$[V*Yi+G*wa+Q*xa+nt*Wu+Hr]=Cu}}}return o.makeTensorInfo(M.shape,M.dtype,M.values)}},jO=ns(m.Cos,l=>Math.cos(l)),UO={kernelName:m.Cos,backendName:"cpu",kernelFunc:jO},Sq=ns(m.Cosh,l=>Math.cosh(l)),WO={kernelName:m.Cosh,backendName:"cpu",kernelFunc:Sq},Xl={kernelName:m.CropAndResize,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{image:c,boxes:f,boxInd:y}=i,{cropSize:w,method:C,extrapolationValue:T}=u,[x,A,M,$]=c.shape,V=f.shape[0],[G,Q]=w,nt=(0,m.buffer)([V,G,Q,$],"float32"),it=o.data.get(f.dataId).values,ht=o.data.get(y.dataId).values,kt=o.data.get(c.dataId).values,Nt=m.util.computeStrides(c.shape),$t=m.util.computeStrides(nt.shape);for(let Ut=0;Ut<V;Ut++){let Pt=4*Ut,re=it[Pt],ue=it[Pt+1],be=it[Pt+2],De=it[Pt+3],ze=ht[Ut];if(ze>=x)continue;let Qe=G>1?(be-re)*(A-1)/(G-1):0,cn=Q>1?(De-ue)*(M-1)/(Q-1):0;for(let en=0;en<G;en++){let sn=G>1?re*(A-1)+en*Qe:.5*(re+be)*(A-1);if(sn<0||sn>A-1)for(let xn=0;xn<Q;xn++)for(let Rn=0;Rn<$;Rn++){let Bn=Rn+xn*$t[2]+en*$t[1]+Ut*$t[0];nt.values[Bn]=T}else if(C==="bilinear"){let xn=Math.floor(sn),Rn=Math.ceil(sn),Bn=sn-xn;for(let Fn=0;Fn<Q;Fn++){let Xn=Q>1?ue*(M-1)+Fn*cn:.5*(ue+De)*(M-1);if(Xn<0||Xn>M-1){for(let Ar=0;Ar<$;Ar++){let Dr=Ar+Fn*$t[2]+en*$t[1]+Ut*$t[0];nt.values[Dr]=T}continue}let Nn=Math.floor(Xn),kr=Math.ceil(Xn),Tr=Xn-Nn;for(let Ar=0;Ar<$;Ar++){let Dr=Ar+Nn*Nt[2]+xn*Nt[1]+ze*Nt[0],Ni=kt[Dr];Dr=Ar+kr*Nt[2]+xn*Nt[1]+ze*Nt[0];let Mi=kt[Dr];Dr=Ar+Nn*Nt[2]+Rn*Nt[1]+ze*Nt[0];let Yi=kt[Dr];Dr=Ar+kr*Nt[2]+Rn*Nt[1]+ze*Nt[0];let Hr=Ni+(Mi-Ni)*Tr,wa=Yi+(kt[Dr]-Yi)*Tr;Dr=Ar+Fn*$t[2]+en*$t[1]+Ut*$t[0],nt.values[Dr]=Hr+(wa-Hr)*Bn}}}else for(let xn=0;xn<Q;++xn){let Rn=Q>1?ue*(M-1)+xn*cn:.5*(ue+De)*(M-1);if(Rn<0||Rn>M-1){for(let Xn=0;Xn<$;Xn++){let Nn=Xn+xn*$t[2]+en*$t[1]+Ut*$t[0];nt.values[Nn]=T}continue}let Bn=Math.round(Rn),Fn=Math.round(sn);for(let Xn=0;Xn<$;Xn++){let Nn=Xn+Bn*Nt[2]+Fn*Nt[1]+ze*Nt[0],kr=Xn+xn*$t[2]+en*$t[1]+Ut*$t[0];nt.values[kr]=kt[Nn]}}}}return o.makeTensorInfo(nt.shape,nt.dtype,nt.values)}},jS={kernelName:m.Cumprod,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,exclusive:y,reverse:w}=u;Ii(c,"cumprod");let C=m.backend_util.getAxesPermutation([f],c.shape.length),T=c;C!=null&&(T=Gc({inputs:{x:c},backend:o,attrs:{perm:C}}));let x=m.backend_util.getInnerMostAxes(1,c.shape.length)[0];if(x!==T.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${T.shape.length-1} but got axis=${x}`);let A=(0,m.upcastType)(T.dtype,"int32"),M=m.util.makeOnesTypedArray(m.util.sizeFromShape(T.shape),A),$=o.data.get(T.dataId).values,V=T.shape[T.shape.length-1],G=w?(nt,it)=>nt+V-it-1:(nt,it)=>nt+it;for(let nt=0;nt<$.length;nt+=V)for(let it=0;it<V;it++){let ht=G(nt,it);if(it===0)M[ht]=y?1:$[ht];else{let kt=G(nt,it-1);M[ht]=y?$[kt]*M[kt]:$[ht]*M[kt]}}let Q=o.makeTensorInfo(T.shape,A,M);if(C!=null){let nt=Gc({inputs:{x:Q},backend:o,attrs:{perm:m.backend_util.getUndoAxesPermutation(C)}});return o.disposeIntermediateTensorInfo(Q),o.disposeIntermediateTensorInfo(T),nt}return Q}},US={kernelName:m.Cumsum,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,exclusive:y,reverse:w}=u;Ii(c,"cumsum");let C=m.backend_util.getAxesPermutation([f],c.shape.length),T=c;C!=null&&(T=Gc({inputs:{x:c},backend:o,attrs:{perm:C}}));let x=m.backend_util.getInnerMostAxes(1,c.shape.length)[0];if(x!==T.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${T.shape.length-1} but got axis=${x}`);let A=(0,m.upcastType)(T.dtype,"int32"),M=m.util.makeZerosTypedArray(m.util.sizeFromShape(T.shape),A),$=o.data.get(T.dataId).values,V=T.shape[T.shape.length-1],G=w?(nt,it)=>nt+V-it-1:(nt,it)=>nt+it;for(let nt=0;nt<$.length;nt+=V)for(let it=0;it<V;it++){let ht=G(nt,it);if(it===0)M[ht]=y?0:$[ht];else{let kt=G(nt,it-1);M[ht]=y?$[kt]+M[kt]:$[ht]+M[kt]}}let Q=o.makeTensorInfo(T.shape,A,M);if(C!=null){let nt=Gc({inputs:{x:Q},backend:o,attrs:{perm:m.backend_util.getUndoAxesPermutation(C)}});return o.disposeIntermediateTensorInfo(Q),o.disposeIntermediateTensorInfo(T),nt}return Q}},hp={kernelName:m.DenseBincount,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,weights:f}=i,{size:y,binaryOutput:w}=u;if(c.shape.length===1){let C=tO(o.data.get(c.dataId).values,o.data.get(f.dataId).values,f.dtype,f.shape,y);return o.makeTensorInfo([y],f.dtype,C)}if(c.shape.length===2){let C=BY(o.bufferSync(c),o.bufferSync(f),y,w);return o.makeTensorInfo(C.shape,f.dtype,C.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${c.shape.length}.`)}},VO={kernelName:m.DepthToSpace,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{blockSize:f,dataFormat:y}=u;m.util.assert(y==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${y}`);let w=c.shape[0],C=c.shape[1],T=c.shape[2],x=c.shape[3],A=C*f,M=T*f,$=x/(f*f),V=o.data.get(c.dataId).values,G=new Float32Array(w*A*M*$),Q=0;for(let nt=0;nt<w;++nt)for(let it=0;it<A;++it){let ht=Math.floor(it/f),kt=it%f;for(let Nt=0;Nt<M;++Nt){let $t=Math.floor(Nt/f),Ut=(kt*f+Nt%f)*$;for(let Pt=0;Pt<$;++Pt){let re=Pt+Ut+x*($t+T*(ht+C*nt));G[Q++]=V[re]}}}return o.makeTensorInfo([w,A,M,$],c.dtype,G)}};function RT(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f}=i,{strides:y,pad:w,dilations:C,dimRoundingMode:T}=u;Ii([c,f],"depthwiseConv2DNative");let x=m.util.computeStrides(c.shape),A=m.util.computeStrides(f.shape),M=C;M==null&&(M=[1,1]),m.util.assert(m.backend_util.eitherStridesOrDilationsAreOne(y,M),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${y} and dilations '${M}'`);let $=m.backend_util.computeConv2DInfo(c.shape,f.shape,y,M,w,T,!0),{filterHeight:V,filterWidth:G,dilationHeight:Q,dilationWidth:nt,padInfo:it}=$,ht=it.left,kt=it.top,Nt=$.outChannels/$.inChannels,$t=new m.TensorBuffer($.outShape,c.dtype),Ut=o.data.get(c.dataId).values,Pt=o.data.get(f.dataId).values,re=$t.values;for(let ue=0;ue<$.batchSize;++ue){let be=ue*x[0],De=ue*$t.strides[0];for(let ze=0;ze<$.outHeight;++ze){let Qe=De+ze*$t.strides[1],cn=ze*$.strideHeight-kt;for(let en=0;en<V;++en){let sn=cn+en*Q;if(sn<0||sn>=$.inHeight)continue;let xn=en*A[0],Rn=be+sn*x[1];for(let Bn=0;Bn<$.outWidth;++Bn){let Fn=Qe+Bn*$t.strides[2],Xn=Bn*$.strideWidth-ht;for(let Nn=0;Nn<G;++Nn){let kr=Xn+Nn*nt;if(kr<0||kr>=$.inWidth)continue;let Tr=xn+Nn*A[1],Ar=Rn+kr*$.inChannels,Dr=Fn,Ni=Tr;for(let Mi=0;Mi<$.inChannels;++Mi){let Yi=Ut[Ar+Mi];for(let Hr=0;Hr<Nt;++Hr)re[Dr+Hr]+=Yi*Pt[Ni+Hr];Dr+=Nt,Ni+=Nt}}}}}}return o.makeTensorInfo($t.shape,$t.dtype,$t.values)}let _q={kernelName:m.DepthwiseConv2dNative,backendName:"cpu",kernelFunc:RT},Rct={kernelName:m.DepthwiseConv2dNativeBackpropFilter,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,dy:f}=i,{strides:y,dilations:w,pad:C,dimRoundingMode:T,filterShape:x}=u;Ii([c,f],"depthwiseConv2dNativeBackpropFilter");let A=m.backend_util.computeConv2DInfo(c.shape,x,y,w,C,T,!0),{strideHeight:M,strideWidth:$,filterHeight:V,filterWidth:G}=A,Q=new m.TensorBuffer(A.filterShape,"float32"),nt=A.padInfo.left,it=A.padInfo.top,ht=A.outChannels/A.inChannels,kt=o.data.get(c.dataId).values,Nt=new m.TensorBuffer(c.shape,c.dtype,kt),$t=o.data.get(f.dataId).values,Ut=new m.TensorBuffer(f.shape,f.dtype,$t);for(let Pt=0;Pt<V;++Pt){let re=Math.max(0,Math.ceil((it-Pt)/M)),ue=Math.min(A.outHeight,(A.inHeight+it-Pt)/M);for(let be=0;be<G;++be){let De=Math.max(0,Math.ceil((nt-be)/$)),ze=Math.min(A.outWidth,(A.inWidth+nt-be)/$);for(let Qe=0;Qe<A.outChannels;++Qe){let cn=Math.trunc(Qe/ht),en=Qe%ht,sn=0;for(let xn=0;xn<A.batchSize;++xn)for(let Rn=re;Rn<ue;++Rn){let Bn=Pt+Rn*M-it;for(let Fn=De;Fn<ze;++Fn){let Xn=be+Fn*$-nt;sn+=Nt.get(xn,Bn,Xn,cn)*Ut.get(xn,Rn,Fn,Qe)}}Q.set(sn,Pt,be,cn,en)}}}return o.makeTensorInfo(Q.shape,Q.dtype,Q.values)}},Fct={kernelName:m.DepthwiseConv2dNativeBackpropInput,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,filter:f}=i,{strides:y,dilations:w,pad:C,dimRoundingMode:T,inputShape:x}=u;Ii([c,f],"depthwiseConv2DNativeBackpropInput");let A=m.util.computeStrides(c.shape),M=m.util.computeStrides(f.shape),$=m.backend_util.computeConv2DInfo(x,f.shape,y,w,C,T,!0),V=new m.TensorBuffer($.inShape,"float32"),G=V.values,[Q,nt,it]=V.strides,ht=o.data.get(c.dataId).values,[kt,Nt,$t]=A,Ut=o.data.get(f.dataId).values,[Pt,re,ue]=M,{batchSize:be,filterHeight:De,filterWidth:ze,inChannels:Qe,inHeight:cn,inWidth:en,outChannels:sn,outHeight:xn,outWidth:Rn,strideHeight:Bn,strideWidth:Fn}=$,Xn=De-1-$.padInfo.top,Nn=ze-1-$.padInfo.left,kr=sn/Qe;for(let Tr=0;Tr<be;++Tr)for(let Ar=0;Ar<Qe;++Ar)for(let Dr=0;Dr<cn;++Dr){let Ni=Dr-Xn,Mi=Math.max(0,Math.ceil(Ni/Bn)),Yi=Math.min(xn,(De+Ni)/Bn);for(let Hr=0;Hr<en;++Hr){let wa=Hr-Nn,Oa=Math.max(0,Math.ceil(wa/Fn)),Xa=Math.min(Rn,(ze+wa)/Fn),ta=0;for(let xa=Mi;xa<Yi;++xa){let Ka=xa*Bn-Ni;for(let nu=Oa;nu<Xa;++nu){let Ol=kt*Tr+Nt*xa+$t*nu,Wu=Pt*(De-1-Ka)+re*(ze-1-(nu*Fn-wa))+ue*Ar;for(let vo=0;vo<kr;++vo)ta+=ht[Ol+(Ar*kr+vo)]*Ut[Wu+vo]}}G[Q*Tr+nt*Dr+it*Hr+Ar]=ta}}return o.makeTensorInfo(V.shape,V.dtype,V.values)}},FT={kernelName:m.Diag,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{x:u}=i,c=m.util.sizeFromShape(u.shape),f=o.data.get(u.dataId).values,y=(0,m.buffer)([c,c],u.dtype),w=y.values;for(let T=0;T<f.length;T++)w[T*c+T]=f[T];let C=[...u.shape,...u.shape];return o.makeTensorInfo(C,y.dtype,y.values)}},Cq={kernelName:m.Dilation2D,backendName:"cpu",kernelFunc:({inputs:l,backend:i,attrs:o})=>{let{x:u,filter:c}=l,{strides:f,pad:y,dilations:w}=o,C=i,T=C.data.get(u.dataId).values,x=u.shape.length,A=C.data.get(c.dataId).values,M=c.shape.length,{batchSize:$,inHeight:V,inWidth:G,inChannels:Q,outHeight:nt,outWidth:it,padInfo:ht,strideHeight:kt,strideWidth:Nt,filterHeight:$t,filterWidth:Ut,dilationHeight:Pt,dilationWidth:re,outShape:ue}=m.backend_util.computeDilation2DInfo(u.shape,c.shape,f,y,"NHWC",w),be=m.util.sizeFromShape(ue),De=ue.length,ze=m.util.getArrayFromDType(u.dtype,be);for(let Qe=0;Qe<$;++Qe)for(let cn=0;cn<nt;++cn){let en=cn*kt-ht.top;for(let sn=0;sn<it;++sn){let xn=sn*Nt-ht.left;for(let Rn=0;Rn<Q;++Rn){let Bn=Number.MIN_SAFE_INTEGER;for(let Fn=0;Fn<$t;++Fn){let Xn=en+Fn*Pt;if(Xn>=0&&Xn<V)for(let Nn=0;Nn<Ut;++Nn){let kr=xn+Nn*re;if(kr>=0&&kr<G){let Tr=m.util.locToIndex([Qe,Xn,kr,Rn],x,m.util.computeStrides(u.shape)),Ar=m.util.locToIndex([Fn,Nn,Rn],M,m.util.computeStrides(c.shape)),Dr=T[Tr]+A[Ar];Dr>Bn&&(Bn=Dr)}}}ze[m.util.locToIndex([Qe,cn,sn,Rn],De,m.util.computeStrides(ue))]=Bn}}}return{dataId:C.write(m.util.toTypedArray(ze,u.dtype),ue,u.dtype),shape:ue,dtype:u.dtype}}},Eq={kernelName:m.Dilation2DBackpropFilter,backendName:"cpu",kernelFunc:({inputs:l,backend:i,attrs:o})=>{let{x:u,filter:c,dy:f}=l,{strides:y,pad:w,dilations:C}=o,T=i,x=m.util.toNestedArray(u.shape,T.data.get(u.dataId).values),A=m.util.toNestedArray(c.shape,T.data.get(c.dataId).values),{batchSize:M,inHeight:$,inWidth:V,inChannels:G,outHeight:Q,outWidth:nt,padInfo:it,strideHeight:ht,strideWidth:kt,filterHeight:Nt,filterWidth:$t,dilationHeight:Ut,dilationWidth:Pt,outShape:re}=m.backend_util.computeDilation2DInfo(u.shape,c.shape,y,w,"NHWC",C);m.util.assert(f.rank===re.length,()=>`Error in ${m.Dilation2DBackpropFilter}, dy must have the same rank as output ${re.length}, but got ${f.rank}`);let ue=m.util.toNestedArray(re,T.data.get(f.dataId).values),be=m.util.makeZerosNestedTypedArray(c.shape,c.dtype);for(let De=0;De<M;++De)for(let ze=0;ze<Q;++ze){let Qe=ze*ht-it.top;for(let cn=0;cn<nt;++cn){let en=cn*kt-it.left;for(let sn=0;sn<G;++sn){let xn=Number.MIN_SAFE_INTEGER,Rn=0,Bn=0;for(let Fn=0;Fn<Nt;++Fn){let Xn=Qe+Fn*Ut;if(Xn>=0&&Xn<$)for(let Nn=0;Nn<$t;++Nn){let kr=en+Nn*Pt;if(kr>=0&&kr<V){let Tr=x[De][Xn][kr][sn]+A[Fn][Nn][sn];Tr>xn&&(xn=Tr,Rn=Fn,Bn=Nn)}}}be[Rn][Bn][sn]+=ue[De][ze][cn][sn]}}}return{dataId:T.write(m.util.toTypedArray(be,u.dtype),c.shape,c.dtype),shape:c.shape,dtype:c.dtype}}},rs={kernelName:m.Dilation2DBackpropInput,backendName:"cpu",kernelFunc:({inputs:l,backend:i,attrs:o})=>{let{x:u,filter:c,dy:f}=l,{strides:y,pad:w,dilations:C}=o,T=i,x=m.util.toNestedArray(u.shape,T.data.get(u.dataId).values),A=m.util.toNestedArray(c.shape,T.data.get(c.dataId).values),{batchSize:M,inHeight:$,inWidth:V,inChannels:G,outHeight:Q,outWidth:nt,padInfo:it,strideHeight:ht,strideWidth:kt,filterHeight:Nt,filterWidth:$t,dilationHeight:Ut,dilationWidth:Pt,outShape:re}=m.backend_util.computeDilation2DInfo(u.shape,c.shape,y,w,"NHWC",C);m.util.assert(f.rank===re.length,()=>`Error in ${m.Dilation2DBackpropInput}, dy must have the same rank as output ${re.length}, but got ${f.rank}`);let ue=m.util.toNestedArray(re,T.data.get(f.dataId).values),be=m.util.makeZerosNestedTypedArray(u.shape,u.dtype);for(let De=0;De<M;++De)for(let ze=0;ze<Q;++ze){let Qe=ze*ht-it.top;for(let cn=0;cn<nt;++cn){let en=cn*kt-it.left;for(let sn=0;sn<G;++sn){let xn=Number.MIN_SAFE_INTEGER,Rn=Qe<0?0:Qe,Bn=en<0?0:en;for(let Fn=0;Fn<Nt;++Fn){let Xn=Qe+Fn*Ut;if(Xn>=0&&Xn<$)for(let Nn=0;Nn<$t;++Nn){let kr=en+Nn*Pt;if(kr>=0&&kr<V){let Tr=x[De][Xn][kr][sn]+A[Fn][Nn][sn];Tr>xn&&(xn=Tr,Rn=Xn,Bn=kr)}}}be[De][Rn][Bn][sn]+=ue[De][ze][cn][sn]}}}return{dataId:T.write(m.util.toTypedArray(be,u.dtype),u.shape,u.dtype),shape:u.shape,dtype:u.dtype}}},Tq={kernelName:m.Draw,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{image:c}=i,{canvas:f,options:y}=u,{contextOptions:w,imageOptions:C}=y||{},T=C?.alpha||1,x=w?.contextType||"2d";if(x!=="2d")throw new Error(`Context type ${w.contextType} is not supported by the CPU backend.`);let A=f.getContext(x,w?.contextAttributes||{});if(A==null)throw new Error(`Could not get the context with ${x} type.`);let[M,$]=c.shape.slice(0,2),V=c.shape.length===2?1:c.shape[2],G=o.data.get(c.dataId).values,Q=c.dtype==="float32"?255:1,nt=new Uint8ClampedArray($*M*4);for(let ht=0;ht<M*$;++ht){let kt=[0,0,0,255*T];for(let $t=0;$t<V;$t++){let Ut=G[ht*V+$t];if(c.dtype==="float32"){if(Ut<0||Ut>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${Ut}.`)}else if(c.dtype==="int32"&&(Ut<0||Ut>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${Ut}.`);V===1?(kt[0]=Ut*Q,kt[1]=Ut*Q,kt[2]=Ut*Q):kt[$t]=Ut*Q}let Nt=4*ht;nt[Nt+0]=Math.round(kt[0]),nt[Nt+1]=Math.round(kt[1]),nt[Nt+2]=Math.round(kt[2]),nt[Nt+3]=Math.round(kt[3])}f.width=$,f.height=M;let it=new ImageData(nt,$,M);return A.putImageData(it,0,0),c}};function w0(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,keepDims:y}=u,w;Ii(c,"sum"),w=c.dtype==="bool"?cp({inputs:{x:c},backend:o,attrs:{dtype:"int32"}}):xf({inputs:{x:c},backend:o});let C=w.shape.length,T=m.util.parseAxisParam(f,w.shape),x=m.backend_util.getAxesPermutation(T,C),A=T,M=w;x!=null&&(M=Gc({inputs:{x:w},backend:o,attrs:{perm:x}}),A=m.backend_util.getInnerMostAxes(A.length,C)),m.backend_util.assertAxesAreInnerMostDims("sum",A,M.shape.length);let[$,V]=m.backend_util.computeOutAndReduceShapes(M.shape,A),G=Kw(o,$,m.backend_util.upcastType(M.dtype,"int32")),Q=m.util.sizeFromShape(V),nt=o.data.get(G.dataId).values,it=o.data.get(M.dataId).values;for(let ht=0;ht<nt.length;++ht){let kt=ht*Q,Nt=0;for(let $t=0;$t<Q;++$t)Nt+=it[kt+$t];nt[ht]=Nt}if(y){let ht=G;G=Cs({inputs:{x:G},backend:o,attrs:{shape:m.backend_util.expandShapeToKeepDim(G.shape,T)}}),o.disposeIntermediateTensorInfo(ht)}return o.disposeIntermediateTensorInfo(w),x!=null&&o.disposeIntermediateTensorInfo(M),G}let GO={kernelName:m.Sum,backendName:"cpu",kernelFunc:w0},ix={kernelName:m.Einsum,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{equation:c}=u,f=i,{allDims:y,summedDims:w,idDims:C}=m.backend_util.decodeEinsumEquation(c,f.length);m.backend_util.checkEinsumDimSizes(y.length,C,f);let{path:T,steps:x}=m.backend_util.getEinsumComputePath(w,C),A=x.length,M=null,$=y.length,V=[];for(let G=0;G<A;++G){for(let Q of x[G]){let{permutationIndices:nt,expandDims:it}=m.backend_util.getEinsumPermutation($,C[Q]),ht;m.backend_util.isIdentityPermutation(nt)?ht=f[Q]:(ht=Gc({inputs:{x:f[Q]},backend:o,attrs:{perm:nt}}),V.push(ht));let kt=ht.shape.slice();for(let Nt=0;Nt<it.length;++Nt)kt.splice(it[Nt],0,1);m.util.arraysEqual(ht.shape,kt)||(ht=Cs({inputs:{x:ht},backend:o,attrs:{shape:kt}}),V.push(ht)),M===null?M=ht:(M=mT({inputs:{a:ht,b:M},backend:o}),V.push(M))}G<A-1&&(T[G]>=0&&(M=w0({inputs:{x:M},backend:o,attrs:{axis:T[G]-(y.length-$),keepDims:!1}}),V.push(M)),$--)}for(let G of V)G!==M&&o.disposeIntermediateTensorInfo(G);return M}},HO={kernelName:m.EluGrad,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{dy:u,y:c}=i;Ii([u,c],"eluGrad");let f=new Float32Array(m.util.sizeFromShape(c.shape)),y=o.data.get(c.dataId).values,w=o.data.get(u.dataId).values;for(let C=0;C<y.length;++C){let T=y[C];f[C]=T>=0?w[C]:w[C]*(T+1)}return o.makeTensorInfo(c.shape,"float32",f)}},Aq=m.backend_util.ERF_P,Iq=m.backend_util.ERF_A1,Nq=m.backend_util.ERF_A2,Oct=m.backend_util.ERF_A3,YO=m.backend_util.ERF_A4,Mq=m.backend_util.ERF_A5,Dq=ns(m.Erf,l=>{let i=Math.sign(l),o=Math.abs(l),u=1/(1+Aq*o);return i*(1-((((Mq*u+YO)*u+Oct)*u+Nq)*u+Iq)*u*Math.exp(-o*o))}),Rq={kernelName:m.Erf,backendName:"cpu",kernelFunc:Dq};function WS(l){let{inputs:i,backend:o,attrs:u}=l,{input:c}=i,{dim:f}=u,y=c.shape.length,w=c.shape.slice(),C=f;return f<0&&(m.util.assert(-(y+1)<=f,()=>`Axis must be in the interval [${-(y+1)}, ${y}]`),C=y+f+1),w.splice(C,0,1),Cs({inputs:{x:c},backend:o,attrs:{shape:w}})}let Fq={kernelName:m.ExpandDims,backendName:"cpu",kernelFunc:WS},Oq=nl((l,i)=>l/i),ax=ml(m.RealDiv,Oq),qO={kernelName:m.RealDiv,backendName:"cpu",kernelFunc:ax};function Lq(l,i,o){let u=l.shape,c=u[0],f=u[1],y=o.data.get(l.dataId),w=y.complexTensorInfos.real,C=y.complexTensorInfos.imag,T=[c,f],x=m.util.sizeFromShape(T),A=m.util.getTypedArrayFromDType("float32",x),M=m.util.getTypedArrayFromDType("float32",x);for(let Q=0;Q<c;Q++){let nt=A2({inputs:{x:w},backend:o,attrs:{begin:[Q,0],size:[1,f]}}),it=A2({inputs:{x:C},backend:o,attrs:{begin:[Q,0],size:[1,f]}}),ht=Od({inputs:{real:nt,imag:it},backend:o}),{real:kt,imag:Nt}=Lct(ht,i,o),$t=m.backend_util.mergeRealAndImagArrays(kt,Nt);for(let Ut=0;Ut<f;Ut++){let Pt=m.backend_util.getComplexWithIndex($t,Ut);A[Q*f+Ut]=Pt.real,M[Q*f+Ut]=Pt.imag}o.disposeIntermediateTensorInfo(nt),o.disposeIntermediateTensorInfo(it),o.disposeIntermediateTensorInfo(ht)}let $=o.makeTensorInfo(T,"float32",A),V=o.makeTensorInfo(T,"float32",M),G=Od({inputs:{real:$,imag:V},backend:o});return o.disposeIntermediateTensorInfo($),o.disposeIntermediateTensorInfo(V),G}function Lct(l,i,o){let u=m.util.sizeFromShape(l.shape),c=o.data.get(l.dataId),f=o.data.get(c.complexTensorInfos.real.dataId).values,y=o.data.get(c.complexTensorInfos.imag.dataId).values;if((w=u)&w-1){let C=function(T,x,A){let M=new Float32Array(2*x);for(let $=0;$<x;$++){let V=0,G=0;for(let Q=0;Q<x;Q++){let nt=m.backend_util.exponent($*Q,x,A),it=m.backend_util.getComplexWithIndex(T,Q);V+=it.real*nt.real-it.imag*nt.imag,G+=it.real*nt.imag+it.imag*nt.real}A&&(V/=x,G/=x),m.backend_util.assignToTypedArray(M,V,G,$)}return M}(m.backend_util.mergeRealAndImagArrays(f,y),u,i);return m.backend_util.splitRealAndImagArrays(C)}{let C=VS(f,y,u,i,o),T=[l.shape[0],l.shape[1]];if(i){let x=o.makeTensorInfo(T,"float32",C.real),A=o.makeTensorInfo(T,"float32",C.imag),M=o.makeTensorInfo([],"float32",m.util.createScalarValue(u,"float32")),$=xf({inputs:{x:M},backend:o}),V=qO.kernelFunc({inputs:{a:x,b:M},backend:o}),G=qO.kernelFunc({inputs:{a:A,b:$},backend:o}),Q=o.data.get(V.dataId).values,nt=o.data.get(G.dataId).values;return o.disposeIntermediateTensorInfo(x),o.disposeIntermediateTensorInfo(A),o.disposeIntermediateTensorInfo(M),o.disposeIntermediateTensorInfo($),o.disposeIntermediateTensorInfo(V),o.disposeIntermediateTensorInfo(G),{real:Q,imag:nt}}return C}var w}function VS(l,i,o,u,c){if(o===1)return{real:l,imag:i};let f=m.backend_util.mergeRealAndImagArrays(l,i),y=o/2,w=m.backend_util.complexWithEvenIndex(f),C=w.real,T=w.imag,x=[C.length],A=c.makeTensorInfo(x,"float32",C),M=c.makeTensorInfo(x,"float32",T),$=Od({inputs:{real:A,imag:M},backend:c}),V=m.backend_util.complexWithOddIndex(f),G=V.real,Q=V.imag,nt=[G.length],it=c.makeTensorInfo(nt,"float32",G),ht=c.makeTensorInfo(nt,"float32",Q),kt=Od({inputs:{real:it,imag:ht},backend:c}),Nt=VS(C,T,y,u,c),$t=Nt.real,Ut=Nt.imag,Pt=[$t.length],re=c.makeTensorInfo(Pt,"float32",$t),ue=c.makeTensorInfo(Pt,"float32",Ut),be=Od({inputs:{real:re,imag:ue},backend:c}),De=VS(G,Q,y,u,c),ze=De.real,Qe=De.imag,cn=[ze.length],en=c.makeTensorInfo(cn,"float32",ze),sn=c.makeTensorInfo(cn,"float32",Qe),xn=Od({inputs:{real:en,imag:sn},backend:c}),Rn=m.backend_util.exponents(o,u),Bn=[Rn.real.length],Fn=c.makeTensorInfo(Bn,"float32",Rn.real),Xn=c.makeTensorInfo(Bn,"float32",Rn.imag),Nn=Od({inputs:{real:Fn,imag:Xn},backend:c}),kr=mT({inputs:{a:Nn,b:xn},backend:c}),Tr=_2({inputs:{a:be,b:kr},backend:c}),Ar=ET({inputs:{a:be,b:kr},backend:c}),Dr=Pv({inputs:{input:Tr},backend:c}),Ni=Pv({inputs:{input:Ar},backend:c}),Mi=zd({inputs:{input:Tr},backend:c}),Yi=zd({inputs:{input:Ar},backend:c}),Hr=xm({inputs:[Dr,Ni],backend:c,attrs:{axis:0}}),wa=xm({inputs:[Mi,Yi],backend:c,attrs:{axis:0}}),Oa=c.data.get(Hr.dataId).values,Xa=c.data.get(wa.dataId).values;return c.disposeIntermediateTensorInfo(A),c.disposeIntermediateTensorInfo(M),c.disposeIntermediateTensorInfo($),c.disposeIntermediateTensorInfo(it),c.disposeIntermediateTensorInfo(ht),c.disposeIntermediateTensorInfo(kt),c.disposeIntermediateTensorInfo(re),c.disposeIntermediateTensorInfo(ue),c.disposeIntermediateTensorInfo(be),c.disposeIntermediateTensorInfo(en),c.disposeIntermediateTensorInfo(sn),c.disposeIntermediateTensorInfo(xn),c.disposeIntermediateTensorInfo(Fn),c.disposeIntermediateTensorInfo(Xn),c.disposeIntermediateTensorInfo(Nn),c.disposeIntermediateTensorInfo(kr),c.disposeIntermediateTensorInfo(Tr),c.disposeIntermediateTensorInfo(Ar),c.disposeIntermediateTensorInfo(Dr),c.disposeIntermediateTensorInfo(Mi),c.disposeIntermediateTensorInfo(Ni),c.disposeIntermediateTensorInfo(Yi),c.disposeIntermediateTensorInfo(Hr),c.disposeIntermediateTensorInfo(wa),{real:Oa,imag:Xa}}let $q={kernelName:m.FFT,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{input:u}=i,c=m.util.sizeFromShape(u.shape),f=u.shape[u.shape.length-1],y=Cs({inputs:{x:u},backend:o,attrs:{shape:[c/f,f]}}),w=Lq(y,!1,o),C=Cs({inputs:{x:w},backend:o,attrs:{shape:u.shape}});return o.disposeIntermediateTensorInfo(y),o.disposeIntermediateTensorInfo(w),C}};function GS(l){let{backend:i,attrs:o}=l,{shape:u,value:c,dtype:f}=o,y=f||m.util.inferDtype(c),w=m.util.getArrayFromDType(y,m.util.sizeFromShape(u));return function(C,T){C.fill(T)}(w,c),i.makeTensorInfo(u,y,w)}let zq={kernelName:m.Fill,backendName:"cpu",kernelFunc:GS};let Pq={kernelName:m.FlipLeftRight,backendName:"cpu",kernelFunc:({inputs:l,attrs:i,backend:o})=>{let{image:u}=l,c=o,f=m.util.getTypedArrayFromDType(u.dtype,m.util.sizeFromShape(u.shape)),[y,w,C,T]=u.shape,x=c.data.get(u.dataId).values;for(let A=0;A<y;A++){let M=A*C*w*T;for(let $=0;$<w;$++){let V=$*(C*T);for(let G=0;G<C;G++){let Q=G*T;for(let nt=0;nt<T;nt++){let it=Math.round(C-G-1),ht=M+V+Q+nt,kt=x[ht];it>=0&&it<C&&(kt=x[M+V+it*T+nt]),f[ht]=kt}}}}return{dataId:c.write(f,u.shape,u.dtype),shape:u.shape,dtype:u.dtype}}},XO={kernelName:m.FusedConv2D,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f,bias:y,preluActivationWeights:w}=i,{strides:C,pad:T,dataFormat:x,dilations:A,dimRoundingMode:M,activation:$,leakyreluAlpha:V}=u,G=I2({inputs:{x:c,filter:f},backend:o,attrs:{strides:C,pad:T,dataFormat:x,dilations:A,dimRoundingMode:M}});if(y){let Q=G;if(x==="NCHW"&&y.shape.length===1&&y.shape[0]!==1){let nt=Cs({inputs:{x:y},backend:o,attrs:{shape:[y.shape[0],1,1]}});G=_2({inputs:{a:G,b:nt},backend:o}),o.disposeIntermediateTensorInfo(nt)}else G=_2({inputs:{a:G,b:y},backend:o});o.disposeIntermediateTensorInfo(Q)}if($){let Q=G;if(x==="NCHW"&&$==="prelu"&&w.shape.length===1&&w.shape[0]!==1){let nt=Cs({inputs:{x:w},backend:o,attrs:{shape:[w.shape[0],1,1]}});G=kf(o,G,$,nt,V),o.disposeIntermediateTensorInfo(nt)}else G=kf(o,G,$,w,V);o.disposeIntermediateTensorInfo(Q)}return G}},Bq={kernelName:m.FusedDepthwiseConv2D,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f,bias:y,preluActivationWeights:w}=i,{strides:C,pad:T,dataFormat:x,dilations:A,dimRoundingMode:M,activation:$,leakyreluAlpha:V}=u,G=RT({inputs:{x:c,filter:f},backend:o,attrs:{strides:C,pad:T,dataFormat:x,dilations:A,dimRoundingMode:M}});if(y){let Q=G;G=_2({inputs:{a:G,b:y},backend:o}),o.disposeIntermediateTensorInfo(Q)}if($){let Q=G;G=kf(o,G,$,w,V),o.disposeIntermediateTensorInfo(Q)}return G}},jq={kernelName:m.GatherNd,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{params:u,indices:c}=i,f=m.util.sizeFromShape(u.shape),y=c.shape,w=y[y.length-1],[C,T,x,A]=m.backend_util.prepareAndValidate(u,c);if(T===0)return o.makeTensorInfo(C,u.dtype,[]);let M=DS(o.data.get(c.dataId).values,o.bufferSync(u),u.dtype,T,w,x,A,u.shape,f);return o.makeTensorInfo(C,u.dtype,M.values)}},Uq={kernelName:m.GatherV2,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,indices:f}=i,{axis:y,batchDims:w}=u;Ii([c,f],"gatherV2");let C=m.util.parseAxisParam(y,c.shape)[0],T=o.data.get(f.dataId).values,x=c.shape[C];for(let ht=0;ht<T.length;++ht){let kt=T[ht];m.util.assert(kt<=x-1&&kt>=0,()=>`GatherV2: the index value ${kt} is not in [0, ${x-1}]`)}let A=w;w==null&&(A=0);let M=m.util.sizeFromShape(f.shape),$=m.backend_util.segment_util.collectGatherOpShapeInfo(c,f,C,A),V=Cs({inputs:{x:c},backend:o,attrs:{shape:[$.batchSize,$.outerSize,$.dimSize,$.sliceSize]}}),G=Cs({inputs:{x:f},backend:o,attrs:{shape:[$.batchSize,M/$.batchSize]}}),Q=[$.batchSize,$.outerSize,M/$.batchSize,$.sliceSize],nt=o.bufferSync(G),it=Zw(o.bufferSync(V),nt,Q);return o.disposeIntermediateTensorInfo(V),o.disposeIntermediateTensorInfo(G),o.makeTensorInfo($.outputShape,it.dtype,it.values)}},$ct={kernelName:m.IFFT,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{input:u}=i,c=m.util.sizeFromShape(u.shape),f=u.shape[u.shape.length-1],y=Cs({inputs:{x:u},backend:o,attrs:{shape:[c/f,f]}}),w=Lq(y,!0,o),C=Cs({inputs:{x:w},backend:o,attrs:{shape:u.shape}});return o.disposeIntermediateTensorInfo(y),o.disposeIntermediateTensorInfo(w),C}},Wq=ns(m.IsFinite,l=>Number.isFinite(l)?1:0,"bool"),zct={kernelName:m.IsFinite,backendName:"cpu",kernelFunc:Wq},Pct=ns(m.IsInf,l=>Math.abs(l)===1/0?1:0,"bool"),Vq={kernelName:m.IsInf,backendName:"cpu",kernelFunc:Pct},Bct=ns(m.IsNan,l=>Number.isNaN(l)?1:0,"bool"),Gq={kernelName:m.IsNan,backendName:"cpu",kernelFunc:Bct},jct={kernelName:m.LinSpace,backendName:"cpu",kernelFunc:function(l){let{backend:i,attrs:o}=l,{start:u,stop:c,num:f}=o,y=Uv(u,c,f);return i.makeTensorInfo([y.length],"float32",y)}},OT=ns(m.Log1p,l=>Math.log1p(l)),KO={kernelName:m.Log1p,backendName:"cpu",kernelFunc:OT},Hq=nl((l,i)=>l&&i),Sm=ml(m.LogicalAnd,Hq,null,"bool"),Yq={kernelName:m.LogicalAnd,backendName:"cpu",kernelFunc:Sm},qq=ns(m.LogicalNot,l=>l?0:1,"bool"),Uct={kernelName:m.LogicalNot,backendName:"cpu",kernelFunc:qq},Wct=nl((l,i)=>l||i),Vct=ml(m.LogicalOr,Wct,null,"bool"),Gct={kernelName:m.LogicalOr,backendName:"cpu",kernelFunc:Vct},Hct={kernelName:m.LRN,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{depthRadius:f,bias:y,alpha:w,beta:C}=u;Ii(c,"LRN");let T=c.shape[3],x=T-1,A=o.data.get(c.dataId).values,M=m.util.sizeFromShape(c.shape),$=new Float32Array(M);function V(G){let Q=G%T,nt=G-Q+Math.max(0,Q-f),it=G-Q+Math.min(Q+f,x),ht=0;for(;nt<=it;nt++){let kt=A[nt];ht+=kt*kt}return ht}for(let G=0;G<M;G++){let Q=V(G),nt=A[G]*Math.pow(y+w*Q,-C);$[G]=nt}return o.makeTensorInfo(c.shape,c.dtype,$)}},ZO={kernelName:m.LRNGrad,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,y:f,dy:y}=i,{depthRadius:w,bias:C,alpha:T,beta:x}=u;Ii(y,"LRNGrad");let A=m.util.sizeFromShape(y.shape),M=y.shape[3],$=o.data.get(y.dataId).values,V=o.data.get(c.dataId).values,G=o.data.get(f.dataId).values,Q=new Float32Array(A),nt=A;for(let it=0;it<nt;it++){let ht=it%M,kt=it-ht+Math.max(0,ht-w),Nt=it-ht+Math.min(M,ht+w+1),$t=0;for(let Ut=kt;Ut<Nt;Ut++)$t+=Math.pow(V[Ut],2);$t=T*$t+C;for(let Ut=kt;Ut<Nt;Ut++){let Pt=-2*T*x*V[Ut]*G[it]/$t;it===Ut&&(Pt+=Math.pow($t,-x)),Pt*=$[it],Q[Ut]+=Pt}}return o.makeTensorInfo(y.shape,c.dtype,Q)}};function Bg(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{reductionIndices:f,keepDims:y}=u,w=o,C=c.shape,T=C.length,x=m.util.parseAxisParam(f,C),A=x,M=m.backend_util.getAxesPermutation(A,T),$=w.data.get(c.dataId).values;if(M!=null){let ht=new Array(T);for(let kt=0;kt<ht.length;kt++)ht[kt]=C[M[kt]];$=Jw($,C,c.dtype,M,ht),A=m.backend_util.getInnerMostAxes(A.length,T),C=ht}Ii(c,"max"),m.backend_util.assertAxesAreInnerMostDims("max",A,T);let[V,G]=m.backend_util.computeOutAndReduceShapes(C,A),Q=Vv($,m.util.sizeFromShape(G),V,c.dtype),nt=w.write(Q,V,c.dtype),it=V;return y&&(it=m.backend_util.expandShapeToKeepDim(V,x)),{dataId:nt,shape:it,dtype:c.dtype}}let Xv={kernelName:m.Max,backendName:"cpu",kernelFunc:Bg},_m={kernelName:m.MaxPool,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i;Ii(c,"maxPool");let{filterSize:f,strides:y,pad:w,dimRoundingMode:C}=u;m.util.assert(m.backend_util.eitherStridesOrDilationsAreOne(y,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${y} and dilations '1'`);let T=m.backend_util.computePool2DInfo(c.shape,f,y,1,w,C),x;if(T.filterWidth===1&&T.filterHeight===1&&m.util.arraysEqual(T.inShape,T.outShape))x=xf({inputs:{x:c},backend:o});else{let A=o.data.get(c.dataId).values,M=m.util.computeStrides(c.shape),$=NO(A,c.shape,c.dtype,M,T,"max");x=o.makeTensorInfo(T.outShape,c.dtype,$.values)}return x}},ox={kernelName:m.MaxPool3D,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{filterSize:f,strides:y,pad:w,dimRoundingMode:C,dataFormat:T}=u;Ii(c,"maxPool3d");let x=m.backend_util.computePool3DInfo(c.shape,f,y,1,w,C,T),A=IT(o.data.get(c.dataId).values,c.shape,c.dtype,m.util.computeStrides(c.shape),x,"max");return o.makeTensorInfo(A.shape,"float32",A.values)}},QO={kernelName:m.MaxPool3DGrad,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,input:f}=i,{filterSize:y,strides:w,pad:C,dimRoundingMode:T}=u;Ii([c,f],"maxPool3DGrad");let x=m.backend_util.computePool3DInfo(f.shape,y,w,1,C,T),A=function(ue,be){let De=(0,m.buffer)(be.outShape,"int32"),ze=be.strideDepth,Qe=be.strideHeight,cn=be.strideWidth,en=be.dilationDepth,sn=be.dilationHeight,xn=be.dilationWidth,Rn=be.effectiveFilterDepth,Bn=be.effectiveFilterHeight,Fn=be.effectiveFilterWidth,Xn=be.padInfo.front,Nn=be.padInfo.top,kr=be.padInfo.left;for(let Tr=0;Tr<be.batchSize;++Tr)for(let Ar=0;Ar<be.inChannels;++Ar)for(let Dr=0;Dr<be.outDepth;++Dr){let Ni=Dr*ze-Xn,Mi=Ni;for(;Mi<0;)Mi+=en;let Yi=Math.min(be.inDepth,Rn+Ni);for(let Hr=0;Hr<be.outHeight;++Hr){let wa=Hr*Qe-Nn,Oa=wa;for(;Oa<0;)Oa+=sn;let Xa=Math.min(be.inHeight,Bn+wa);for(let ta=0;ta<be.outWidth;++ta){let xa=ta*cn-kr,Ka=xa;for(;Ka<0;)Ka+=xn;let nu=Math.min(be.inWidth,Fn+xa),Ol=Number.NEGATIVE_INFINITY,Wu=-1;for(let vo=Mi;vo<Yi;vo+=en){let eh=vo-Ni;for(let Ll=Oa;Ll<Xa;Ll+=sn){let Cu=Ll-wa;for(let Vu=Ka;Vu<nu;Vu+=xn){let bl=Vu-xa,$l=ue.get(Tr,vo,Ll,Vu,Ar);$l>=Ol&&(Ol=$l,Wu=eh*Bn*Fn+Cu*Bn+bl)}}}De.set(Wu,Tr,Dr,Hr,ta,Ar)}}}return De}(o.bufferSync(f),x),M=x.strideDepth,$=x.strideHeight,V=x.strideWidth,G=x.dilationDepth,Q=x.dilationHeight,nt=x.dilationWidth,it=x.effectiveFilterDepth,ht=x.effectiveFilterHeight,kt=x.effectiveFilterWidth,Nt=it-1-x.padInfo.front,$t=kt-1-x.padInfo.left,Ut=ht-1-x.padInfo.top,Pt=(0,m.buffer)(f.shape,"float32"),re=o.bufferSync(c);for(let ue=0;ue<x.batchSize;++ue)for(let be=0;be<x.inChannels;++be)for(let De=0;De<x.inDepth;++De)for(let ze=0;ze<x.inHeight;++ze)for(let Qe=0;Qe<x.inWidth;++Qe){let cn=De-Nt,en=ze-Ut,sn=Qe-$t,xn=0;for(let Rn=0;Rn<it;Rn+=G){let Bn=(cn+Rn)/M;if(!(Bn<0||Bn>=x.outDepth||Math.floor(Bn)!==Bn))for(let Fn=0;Fn<ht;Fn+=Q){let Xn=(en+Fn)/$;if(!(Xn<0||Xn>=x.outHeight||Math.floor(Xn)!==Xn))for(let Nn=0;Nn<kt;Nn+=nt){let kr=(sn+Nn)/V;if(kr<0||kr>=x.outWidth||Math.floor(kr)!==kr)continue;let Tr=it*ht*kt-1-A.get(ue,Bn,Xn,kr,be)===Rn*ht*kt+Fn*kt+Nn?1:0;Tr!==0&&(xn+=re.get(ue,Bn,Xn,kr,be)*Tr)}}}Pt.set(xn,ue,De,ze,Qe,be)}return o.makeTensorInfo(Pt.shape,Pt.dtype,Pt.values)}},JO={kernelName:m.MaxPoolGrad,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,input:f,output:y}=i,w=f;Ii([f,y],"maxPoolGrad");let{filterSize:C,strides:T,pad:x,dimRoundingMode:A}=u,M=m.backend_util.computePool2DInfo(w.shape,C,T,1,x,A),$=o.data.get(w.dataId).values,V=(0,m.buffer)(M.outShape,w.dtype,b0($,w.shape,w.dtype,M).values),G=M.strideHeight,Q=M.strideWidth,nt=M.dilationHeight,it=M.dilationWidth,ht=M.effectiveFilterHeight,kt=M.effectiveFilterWidth,Nt=kt-1-M.padInfo.left,$t=ht-1-M.padInfo.top,Ut=(0,m.buffer)(w.shape,"float32"),Pt=o.data.get(c.dataId).values,re=(0,m.buffer)(c.shape,"float32",Pt);for(let ue=0;ue<M.batchSize;++ue)for(let be=0;be<M.inChannels;++be)for(let De=0;De<M.inHeight;++De)for(let ze=0;ze<M.inWidth;++ze){let Qe=De-$t,cn=ze-Nt,en=0;for(let sn=0;sn<ht;sn+=nt){let xn=(Qe+sn)/G;if(!(xn<0||xn>=M.outHeight||Math.floor(xn)!==xn))for(let Rn=0;Rn<kt;Rn+=it){let Bn=(cn+Rn)/Q;if(Bn<0||Bn>=M.outWidth||Math.floor(Bn)!==Bn)continue;let Fn=ht*kt-1-V.get(ue,xn,Bn,be)===sn*kt+Rn?1:0;Fn!==0&&(en+=re.get(ue,xn,Bn,be)*Fn)}}Ut.set(en,ue,De,ze,be)}return o.makeTensorInfo(Ut.shape,Ut.dtype,Ut.values)}};let Xq={kernelName:m.MaxPoolWithArgmax,backendName:"cpu",kernelFunc:({inputs:l,attrs:i,backend:o})=>{let{x:u}=l,{filterSize:c,strides:f,pad:y,includeBatchInIndex:w}=i,C=o;Ii(u,"MaxPoolWithArgmax");let T=C.data.get(u.dataId).values,x=m.backend_util.computePool2DInfo(u.shape,c,f,[1,1],y),[A,M]=function(G,Q,nt,it,ht){let kt=NO(G,0,nt,m.util.computeStrides(Q),ht,"max"),Nt=b0(G,Q,nt,ht,!0,it);return[kt.values,Nt.values]}(T,u.shape,u.dtype,w,x),$=C.write(A,x.outShape,u.dtype),V=C.write(M,x.outShape,u.dtype);return[{dataId:$,shape:x.outShape,dtype:u.dtype},{dataId:V,shape:x.outShape,dtype:"int32"}]}},Yct={kernelName:m.Mean,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,keepDims:y}=u,w=m.util.parseAxisParam(f,c.shape),C=m.backend_util.computeOutAndReduceShapes(c.shape,w)[1],T=m.util.sizeFromShape(C),x=[],A=o.makeTensorInfo([],"float32",new Float32Array([T]));x.push(A);let M=cp({inputs:{x:c},backend:o,attrs:{dtype:"float32"}});x.push(M);let $=ax({inputs:{a:M,b:A},backend:o});x.push($);let V=w0({inputs:{x:$},backend:o,attrs:{axis:f,keepDims:y}});return x.forEach(G=>o.disposeIntermediateTensorInfo(G)),V}},dp={kernelName:m.Min,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,keepDims:y}=u;Ii(c,"min");let w=m.util.parseAxisParam(f,c.shape),C=w,T=m.backend_util.getAxesPermutation(C,c.shape.length),x=c;T!=null&&(x=Gc({inputs:{x:c},backend:o,attrs:{perm:T}}),C=m.backend_util.getInnerMostAxes(C.length,c.shape.length)),m.backend_util.assertAxesAreInnerMostDims("min",C,x.shape.length);let[A,M]=m.backend_util.computeOutAndReduceShapes(x.shape,C),$=m.util.sizeFromShape(M),V=m.util.makeZerosTypedArray(m.util.sizeFromShape(A),x.dtype),G=o.data.get(x.dataId).values;for(let nt=0;nt<V.length;++nt){let it=nt*$,ht=G[it];for(let kt=0;kt<$;++kt){let Nt=G[it+kt];(Number.isNaN(Nt)||Nt<ht)&&(ht=Nt)}V[nt]=ht}T!=null&&o.disposeIntermediateTensorInfo(x);let Q=o.makeTensorInfo(A,x.dtype,V);if(y){let nt=Cs({inputs:{x:Q},backend:o,attrs:{shape:m.backend_util.expandShapeToKeepDim(A,w)}});return o.disposeIntermediateTensorInfo(Q),nt}return Q}},qct={kernelName:m.MirrorPad,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{paddings:f,mode:y}=u;Ii(c,"mirrorPad");let w=f.map((it,ht)=>it[0]+c.shape[ht]+it[1]),C=f.map(it=>it[0]),T=f.map((it,ht)=>it[0]+c.shape[ht]),x=y==="reflect"?0:1,A=o.data.get(c.dataId).values,M=c.shape.length,$=m.util.computeStrides(c.shape),V=m.util.sizeFromShape(w),G=w.length,Q=m.util.computeStrides(w),nt=m.util.getTypedArrayFromDType(c.dtype,V);for(let it=0;it<V;it++){let ht=m.util.indexToLoc(it,G,Q);for(let Nt=0;Nt<G;Nt++)ht[Nt]<C[Nt]?ht[Nt]=2*C[Nt]-ht[Nt]-x:ht[Nt]>=T[Nt]&&(ht[Nt]=2*(T[Nt]-1)-ht[Nt]+x);ht=ht.map((Nt,$t)=>Nt-C[$t]);let kt=m.util.locToIndex(ht,M,$);nt[it]=A[kt]}return{dataId:o.write(nt,w,c.dtype),shape:w,dtype:c.dtype}}},LT=nl((l,i)=>{let o=l%i;return l<0&&i<0||l>=0&&i>=0?o:(o+i)%i}),Kq=ml(m.Mod,LT),Zq={kernelName:m.Mod,backendName:"cpu",kernelFunc:Kq};function tL(l){let{inputs:i,backend:o,attrs:u}=l,{logits:c}=i,{dim:f}=u,y=c.shape.length,w=f;if(w===-1&&(w=y-1),w!==y-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${y} and dim was ${w}`);let C=m.util.parseAxisParam([w],c.shape),T=Bg({inputs:{x:c},backend:o,attrs:{reductionIndices:C,keepDims:!1}}),x=m.backend_util.expandShapeToKeepDim(T.shape,C),A=Cs({inputs:{x:T},backend:o,attrs:{shape:x}}),M=ET({inputs:{a:c,b:A},backend:o}),$=sT({inputs:{x:M},backend:o}),V=w0({inputs:{x:$},backend:o,attrs:{axis:C,keepDims:!1}}),G=Cs({inputs:{x:V},backend:o,attrs:{shape:x}}),Q=ax({inputs:{a:$,b:G},backend:o});return o.disposeIntermediateTensorInfo(T),o.disposeIntermediateTensorInfo(A),o.disposeIntermediateTensorInfo(M),o.disposeIntermediateTensorInfo($),o.disposeIntermediateTensorInfo(V),o.disposeIntermediateTensorInfo(G),Q}let Xct={kernelName:m.Softmax,backendName:"cpu",kernelFunc:tL},eL={kernelName:m.Multinomial,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{logits:c}=i,{numSamples:f,seed:y,normalized:w}=u;Ii(c,"multinomial");let C=w?c:tL({inputs:{logits:c},backend:o,attrs:{dim:-1}}),T=C.shape[0],x=C.shape[1],A=o.data.get(C.dataId).values,M=[T,f],$=m.util.makeZerosTypedArray(m.util.sizeFromShape(M),"int32");for(let V=0;V<T;++V){let G=V*x,Q=new Float32Array(x-1);Q[0]=A[G];for(let ht=1;ht<Q.length;++ht)Q[ht]=Q[ht-1]+A[G+ht];let nt=Uw.alea(y.toString()),it=V*f;for(let ht=0;ht<f;++ht){let kt=nt();$[it+ht]=Q.length;for(let Nt=0;Nt<Q.length;Nt++)if(kt<Q[Nt]){$[it+ht]=Nt;break}}}return w||o.disposeIntermediateTensorInfo(C),o.makeTensorInfo(M,"int32",$)}},N2=m.kernel_impls.nonMaxSuppressionV3Impl,Kct={kernelName:m.NonMaxSuppressionV3,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{boxes:c,scores:f}=i,{maxOutputSize:y,iouThreshold:w,scoreThreshold:C}=u;Ii(c,"NonMaxSuppression");let T=o.data.get(c.dataId).values,x=o.data.get(f.dataId).values,{selectedIndices:A}=N2(T,x,y,w,C);return o.makeTensorInfo([A.length],"int32",new Int32Array(A))}},Zct=m.kernel_impls.nonMaxSuppressionV4Impl,Qct={kernelName:m.NonMaxSuppressionV4,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{boxes:c,scores:f}=i,{maxOutputSize:y,iouThreshold:w,scoreThreshold:C,padToMaxOutputSize:T}=u;Ii(c,"NonMaxSuppressionPadded");let x=o.data.get(c.dataId).values,A=o.data.get(f.dataId).values,{selectedIndices:M,validOutputs:$}=Zct(x,A,y,w,C,T);return[o.makeTensorInfo([M.length],"int32",new Int32Array(M)),o.makeTensorInfo([],"int32",new Int32Array([$]))]}},Jct=m.kernel_impls.nonMaxSuppressionV5Impl,jg={kernelName:m.NonMaxSuppressionV5,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{boxes:c,scores:f}=i,{maxOutputSize:y,iouThreshold:w,scoreThreshold:C,softNmsSigma:T}=u;Ii(c,"NonMaxSuppressionWithScore");let x=o.data.get(c.dataId).values,A=o.data.get(f.dataId).values,M=y,$=w,V=C,G=T,{selectedIndices:Q,selectedScores:nt}=Jct(x,A,M,$,V,G);return[o.makeTensorInfo([Q.length],"int32",new Int32Array(Q)),o.makeTensorInfo([nt.length],"float32",new Float32Array(nt))]}},$T={kernelName:m.OneHot,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{indices:c}=i,{dtype:f,depth:y,onValue:w,offValue:C}=u;Ii(c,"oneHot");let T=m.util.sizeFromShape(c.shape),x=new Float32Array(T*y);x.fill(C);let A=o.data.get(c.dataId).values;for(let M=0;M<T;++M)A[M]>=0&&A[M]<y&&(x[M*y+A[M]]=w);return o.makeTensorInfo([...c.shape,y],f,x)}};function M2(l){let{inputs:i,backend:o}=l,{x:u}=i;if(u.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(u.dtype==="complex64"){let c=Pv({inputs:{input:u},backend:o}),f=M2({inputs:{x:c},backend:o}),y=zd({inputs:{input:u},backend:o}),w=M2({inputs:{x:y},backend:o}),C=Od({inputs:{real:f,imag:w},backend:o});return o.disposeIntermediateTensorInfo(c),o.disposeIntermediateTensorInfo(f),o.disposeIntermediateTensorInfo(y),o.disposeIntermediateTensorInfo(w),C}return GS({backend:o,attrs:{shape:u.shape,value:0,dtype:u.dtype}})}let HS={kernelName:m.ZerosLike,backendName:"cpu",kernelFunc:M2},YS={kernelName:m.OnesLike,backendName:"cpu",kernelFunc:function l(i){let{inputs:o,backend:u}=i,{x:c}=o;if(c.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(c.dtype==="complex64"){let f=Pv({inputs:{input:c},backend:u}),y=l({inputs:{x:f},backend:u}),w=zd({inputs:{input:c},backend:u}),C=M2({inputs:{x:w},backend:u}),T=Od({inputs:{real:y,imag:C},backend:u});return u.disposeIntermediateTensorInfo(f),u.disposeIntermediateTensorInfo(y),u.disposeIntermediateTensorInfo(w),u.disposeIntermediateTensorInfo(C),T}return GS({backend:u,attrs:{shape:c.shape,value:1,dtype:c.dtype}})}};function qS(l){let{inputs:i,backend:o,attrs:u}=l,{axis:c}=u;if(i.length===1)return WS({inputs:{input:i[0]},backend:o,attrs:{dim:c}});let f=i[0].shape,y=i[0].dtype;i.forEach(T=>{m.util.assertShapesMatch(f,T.shape,"All tensors passed to stack must have matching shapes"),m.util.assert(y===T.dtype,()=>"All tensors passed to stack must have matching dtypes")});let w=[],C=xm({inputs:i.map(T=>{let x=WS({inputs:{input:T},backend:o,attrs:{dim:c}});return w.push(x),x}),backend:o,attrs:{axis:c}});return w.forEach(T=>o.disposeIntermediateTensorInfo(T)),C}let tht={kernelName:m.Pack,backendName:"cpu",kernelFunc:qS},Qq={kernelName:m.PadV2,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{paddings:f,constantValue:y}=u;Ii(c,"pad");let w=f.map((nt,it)=>nt[0]+c.shape[it]+nt[1]),C=f.map(nt=>nt[0]),T=o.data.get(c.dataId).values,x=m.util.sizeFromShape(c.shape),A=c.shape.length,M=m.util.computeStrides(c.shape),$=m.util.sizeFromShape(w),V=w.length,G=m.util.computeStrides(w),Q=m.util.getTypedArrayFromDType(c.dtype,$);y!==0&&Q.fill(y);for(let nt=0;nt<x;nt++){let it=m.util.indexToLoc(nt,A,M).map((ht,kt)=>ht+C[kt]);Q[m.util.locToIndex(it,V,G)]=T[nt]}return{dataId:o.write(Q,w,c.dtype),shape:w,dtype:c.dtype}}},eht=nl((l,i)=>Math.pow(l,i)),nht=ml(m.Pow,eht),rht={kernelName:m.Pow,backendName:"cpu",kernelFunc:nht},iht={kernelName:m.RaggedGather,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{paramsNestedSplits:u,paramsDenseValues:c,indices:f}=i,y=u.map(G=>o.data.get(G.dataId).values),w=u.map(G=>G.shape),C=o.data.get(c.dataId).values,T=o.data.get(f.dataId).values,[x,A,M]=E2(y,w,C,c.shape,c.dtype,T,f.shape),$=x.map(G=>o.makeTensorInfo([G.length],"int32",G)),V=o.makeTensorInfo(M,c.dtype,A);return $.concat([V])}},aht={kernelName:m.RaggedRange,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{starts:u,limits:c,deltas:f}=i,y=o.data.get(u.dataId).values,w=o.data.get(c.dataId).values,C=o.data.get(f.dataId).values,[T,x]=lO(y,u.shape,u.dtype,w,c.shape,C,f.shape);return[o.makeTensorInfo([T.length],"int32",T),o.makeTensorInfo([x.length],u.dtype,x)]}},nL={kernelName:m.RaggedTensorToTensor,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{shape:c,values:f,defaultValue:y,rowPartitionTensors:w}=i,{rowPartitionTypes:C}=u,T=o.data.get(c.dataId).values,x=o.data.get(f.dataId).values,A=o.data.get(y.dataId).values,M=w.map(Q=>o.data.get(Q.dataId).values),$=w.map(Q=>Q.shape),[V,G]=yT(T,c.shape,x,f.shape,f.dtype,A,y.shape,M,$,C);return o.makeTensorInfo(V,f.dtype,G)}},sx={kernelName:m.Range,backendName:"cpu",kernelFunc:function(l){let{backend:i,attrs:o}=l,{start:u,stop:c,dtype:f,step:y}=o,w=hO(u,c,y,f);return i.makeTensorInfo([w.length],f,w)}},oht=ns(m.Reciprocal,l=>1/l),rL={kernelName:m.Reciprocal,backendName:"cpu",kernelFunc:oht},Kl={kernelName:m.ResizeBilinear,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{images:c}=i,{alignCorners:f,halfPixelCenters:y,size:w}=u;Ii(c,"resizeBilinear");let C=m.util.computeStrides(c.shape),[T,x]=w,[A,M,$,V]=c.shape,G=o.data.get(c.dataId).values,Q=new Float32Array(m.util.sizeFromShape([A,T,x,V])),nt=[f&&T>1?M-1:M,f&&x>1?$-1:$],it=[f&&T>1?T-1:T,f&&x>1?x-1:x],ht=0,kt=nt[0]/it[0],Nt=nt[1]/it[1];for(let $t=0;$t<A;$t++)for(let Ut=0;Ut<T;Ut++){let Pt;Pt=y?kt*(Ut+.5)-.5:kt*Ut;let re=Math.max(0,Math.floor(Pt)),ue=Pt-re,be=Math.min(M-1,Math.ceil(Pt)),De=$t*C[0]+re*C[1],ze=$t*C[0]+be*C[1];for(let Qe=0;Qe<x;Qe++){let cn;cn=y?Nt*(Qe+.5)-.5:Nt*Qe;let en=Math.max(0,Math.floor(cn)),sn=cn-en,xn=Math.min($-1,Math.ceil(cn)),Rn=De+en*C[2],Bn=ze+en*C[2],Fn=De+xn*C[2],Xn=ze+xn*C[2];for(let Nn=0;Nn<V;Nn++){let kr=G[Rn+Nn],Tr=G[Bn+Nn],Ar=kr+(G[Fn+Nn]-kr)*sn,Dr=Ar+(Tr+(G[Xn+Nn]-Tr)*sn-Ar)*ue;Q[ht++]=Dr}}}return o.makeTensorInfo([A,T,x,V],"float32",Q)}},iL={kernelName:m.ResizeBilinearGrad,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{images:c,dy:f}=i,{alignCorners:y}=u;Ii([f,c],"resizeBilinearGrad");let w=m.util.computeStrides(c.shape),[C,T,x,A]=c.shape,[,M,$]=f.shape,V=new Float32Array(C*T*x*A),G=[y&&M>1?T-1:T,y&&$>1?x-1:x],Q=[y&&M>1?M-1:M,y&&$>1?$-1:$],nt=G[0]/Q[0],it=G[1]/Q[1],ht=o.data.get(f.dataId).values,kt=0;for(let Nt=0;Nt<C;Nt++){let $t=Nt*w[0];for(let Ut=0;Ut<M;Ut++){let Pt=Ut*nt,re=Math.floor(Pt),ue=Math.min(Math.ceil(Pt),T-1),be=$t+re*w[1],De=$t+ue*w[1],ze=Pt-re,Qe=1-ze;for(let cn=0;cn<$;cn++){let en=cn*it,sn=Math.floor(en),xn=Math.min(Math.ceil(en),x-1),Rn=en-sn,Bn=1-Rn,Fn=be+sn*w[2],Xn=be+xn*w[2],Nn=De+sn*w[2],kr=De+xn*w[2],Tr=Qe*Bn,Ar=Qe*Rn,Dr=ze*Bn,Ni=ze*Rn;for(let Mi=0;Mi<A;Mi++){let Yi=ht[kt++];V[Fn+Mi]+=Yi*Tr,V[Xn+Mi]+=Yi*Ar,V[Nn+Mi]+=Yi*Dr,V[kr+Mi]+=Yi*Ni}}}}return o.makeTensorInfo([C,x,T,A],"float32",V)}},aL={kernelName:m.ResizeNearestNeighbor,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{images:c}=i,{alignCorners:f,halfPixelCenters:y,size:w}=u;Ii(c,"resizeNearestNeighbor");let C=m.util.computeStrides(c.shape),[T,x]=w,[A,M,$,V]=c.shape,G=o.data.get(c.dataId).values,Q=new Float32Array(A*T*x*V),nt=[f&&T>1?M-1:M,f&&x>1?$-1:$],it=[f&&T>1?T-1:T,f&&x>1?x-1:x],ht=nt[0]/it[0],kt=nt[1]/it[1],Nt=0;for(let $t=0;$t<A;$t++){let Ut=$t*C[0];for(let Pt=0;Pt<T;Pt++){let re=y?ht*(Pt+.5):ht*Pt,ue=Math.min(M-1,f?Math.round(re):Math.floor(re));y&&(ue=Math.max(0,ue));let be=Ut+ue*C[1];for(let De=0;De<x;De++){let ze=y?kt*(De+.5):kt*De,Qe=Math.min($-1,f?Math.round(ze):Math.floor(ze));y&&(Qe=Math.max(0,Qe));let cn=be+Qe*C[2];for(let en=0;en<V;en++){let sn=G[cn+en];Q[Nt++]=sn}}}}return o.makeTensorInfo([A,T,x,V],c.dtype,Q)}},sht={kernelName:m.ResizeNearestNeighborGrad,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{images:c,dy:f}=i,{alignCorners:y}=u;Ii([f,c],"resizeNearestNeighborGrad");let w=m.util.computeStrides(c.shape),C=m.util.computeStrides(f.shape),[T,x,A,M]=c.shape,[,$,V]=f.shape,G=new Float32Array(T*x*A*M),Q=o.data.get(f.dataId).values,nt=[y&&$>1?x-1:x,y&&V>1?A-1:A],it=[y&&$>1?$-1:$,y&&V>1?V-1:V],ht=nt[0]/it[0],kt=nt[1]/it[1],Nt=1/ht,$t=1/kt,Ut=2*Math.ceil(Nt)+2,Pt=2*Math.ceil($t)+2;for(let re=0;re<T;re++){let ue=re*w[0];for(let be=0;be<x;be++){let De=ue+be*w[1],ze=Math.floor(be*Nt),Qe=Math.floor(ze-Ut/2);for(let cn=0;cn<A;cn++){let en=De+cn*w[2],sn=Math.floor(cn*$t),xn=Math.floor(sn-Pt/2);for(let Rn=0;Rn<M;Rn++){let Bn=0;for(let Fn=0;Fn<Ut;Fn++){let Xn=Fn+Qe;if(Xn<0||Xn>=$)continue;let Nn=ue+Xn*C[1],kr=Xn*ht;if(be===Math.min(x-1,y?Math.round(kr):Math.floor(kr)))for(let Tr=0;Tr<Pt;Tr++){let Ar=Tr+xn;if(Ar<0||Ar>=V)continue;let Dr=Nn+Ar*C[2],Ni=Ar*kt;cn===Math.min(A-1,y?Math.round(Ni):Math.floor(Ni))&&(Bn+=Q[Dr+Rn])}}G[en+Rn]=Bn}}}}return o.makeTensorInfo(c.shape,c.dtype,G)}},Jq={kernelName:m.Reverse,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{dims:f}=u;Ii(c,"reverse");let y=c.shape.length,w=m.util.parseAxisParam(f,c.shape);if(y===0)return xf({inputs:{x:c},backend:o});let C=new m.TensorBuffer(c.shape,c.dtype),T=o.bufferSync(c);for(let x=0;x<C.size;x++){let A=C.indexToLoc(x),M=A.slice();w.forEach($=>M[$]=c.shape[$]-1-M[$]),C.set(T.get(...M),...A)}return o.makeTensorInfo(C.shape,C.dtype,C.values)}},XS={kernelName:m.RotateWithOffset,backendName:"cpu",kernelFunc:({inputs:l,attrs:i,backend:o})=>{let{image:u}=l,{radians:c,fillValue:f,center:y}=i,w=o,C=m.util.getTypedArrayFromDType(u.dtype,m.util.sizeFromShape(u.shape)),[T,x,A,M]=u.shape,[$,V]=m.backend_util.getImageCenter(y,x,A),G=Math.sin(c),Q=Math.cos(c),nt=w.data.get(u.dataId).values;for(let it=0;it<T;it++){let ht=it*A*x*M;for(let kt=0;kt<x;kt++){let Nt=kt*(A*M);for(let $t=0;$t<A;$t++){let Ut=$t*M;for(let Pt=0;Pt<M;Pt++){let re=[T,kt,$t,Pt],ue=re[2],be=re[1],De=(ue-$)*Q-(be-V)*G,ze=(ue-$)*G+(be-V)*Q;De=Math.round(De+$),ze=Math.round(ze+V);let Qe=f;typeof f!="number"&&(Qe=Pt===3?255:f[Pt]),De>=0&&De<A&&ze>=0&&ze<x&&(Qe=nt[ht+ze*(A*M)+De*M+Pt]),C[ht+Nt+Ut+Pt]=Qe}}}}return{dataId:w.write(C,u.shape,u.dtype),shape:u.shape,dtype:u.dtype}}},D2=ns(m.Round,l=>{let i=Math.floor(l);return l-i<.5?Math.floor(l):l-i>.5?Math.ceil(l):i%2==0?i:i+1}),uht={kernelName:m.Round,backendName:"cpu",kernelFunc:D2},zT={kernelName:m.ScatterNd,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{indices:c,updates:f}=i,{shape:y}=u,{sliceRank:w,numUpdates:C,sliceSize:T,strides:x,outputSize:A}=m.backend_util.calculateShapes(f,c,y),M=T2(o.bufferSync(c),o.bufferSync(f),y,A,T,C,w,x,0,!0);return o.makeTensorInfo(y,M.dtype,M.values)}};function PT(l,i){let o=0,u=l.length,c=0;for(;o<u;)c=Math.floor((o+u)/2),l[c]<i?o=c+1:u=c;return u}function BT(l,i){let o=0,u=l.length,c=0;for(;o<u;)c=Math.floor((o+u)/2),l[c]<=i?o=c+1:u=c;return u}let Kv={kernelName:m.SearchSorted,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{sortedSequence:c,values:f}=i,{side:y}=u,w=function(C,T,x,A,M,$){let V=m.util.getArrayFromDType("int32",x*M);for(let G=0;G<x;++G){let Q=C.slice(G*A,(G+1)*A),nt=G*M;for(let it=0;it<M;++it)V[nt+it]=$==="left"?PT(Q,T[it+nt]):BT(Q,T[it+nt])}return V}(o.data.get(c.dataId).values,o.data.get(f.dataId).values,c.shape[0],c.shape[1],f.shape[1],y);return o.makeTensorInfo(f.shape,"int32",w)}},oL={kernelName:m.Select,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{condition:u,t:c,e:f}=i;Ii([u,c,f],"select");let y=u.shape.length,w=o.data.get(u.dataId).values,C=o.data.get(c.dataId).values,T=o.data.get(f.dataId).values,x=(0,m.upcastType)(c.dtype,f.dtype),A=m.util.makeZerosTypedArray(m.util.sizeFromShape(c.shape),x),M=0,$=y===0||y>1||c.shape.length===1?1:m.util.sizeFromShape(c.shape.slice(1));for(let V=0;V<w.length;V++)for(let G=0;G<$;G++)w[V]===1?A[M++]=C[V]:A[M++]=T[V];return o.makeTensorInfo(c.shape,x,A)}},jT=m.backend_util.SELU_SCALEALPHA,sL=m.backend_util.SELU_SCALE,uL=ns(m.Selu,l=>l>=0?sL*l:jT*(Math.exp(l)-1)),R2={kernelName:m.Selu,backendName:"cpu",kernelFunc:uL},UT=ns(m.Sign,l=>l<0?-1:l>0?1:0),tX={kernelName:m.Sign,backendName:"cpu",kernelFunc:UT},eX=ns(m.Sin,l=>Math.sin(l)),Zv={kernelName:m.Sin,backendName:"cpu",kernelFunc:eX},Qv=ns(m.Sinh,l=>Math.sinh(l)),lL={kernelName:m.Sinh,backendName:"cpu",kernelFunc:Qv},WT=Math.log(11920928955078125e-23)+2,VT=ns(m.Softplus,l=>{let i=l>-WT,o=l<WT,u=Math.exp(l),c;return c=o?u:i?l:Math.log(1+u),c}),lht={kernelName:m.Softplus,backendName:"cpu",kernelFunc:VT},nX={kernelName:m.SpaceToBatchND,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{blockShape:f,paddings:y}=u;Ii([c],"spaceToBatchND");let w=m.util.sizeFromShape(f),C=[[0,0]];C.push(...y);for(let Q=1+f.length;Q<c.shape.length;++Q)C.push([0,0]);let T=Qq.kernelFunc({inputs:{x:c},backend:o,attrs:{paddings:C,constantValue:0}}),x=m.backend_util.getReshaped(T.shape,f,w,!1),A=m.backend_util.getPermuted(x.length,f.length,!1),M=m.backend_util.getReshapedPermuted(T.shape,f,w,!1),$=Cs({inputs:{x:T},backend:o,attrs:{shape:x}}),V=Gc({inputs:{x:$},backend:o,attrs:{perm:A}}),G=Cs({inputs:{x:V},backend:o,attrs:{shape:M}});return o.disposeIntermediateTensorInfo(T),o.disposeIntermediateTensorInfo($),o.disposeIntermediateTensorInfo(V),G}},rX={kernelName:m.SparseFillEmptyRows,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{indices:u,values:c,denseShape:f,defaultValue:y}=i;if(f.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${f.shape}`);if(u.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${u.shape}`);if(c.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${c.shape}`);if(y.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${y.shape}`);let w=o.data.get(u.dataId).values,C=o.data.get(c.dataId).values,T=o.data.get(f.dataId).values,x=o.data.get(y.dataId).values[0],[A,M,$,V,G]=nq(w,u.shape,u.dtype,C,c.dtype,T,x);return[o.makeTensorInfo(M,u.dtype,A),o.makeTensorInfo([M[0]],c.dtype,$),o.makeTensorInfo([V.length],"bool",new Uint8Array(V.map(Q=>Number(Q)))),o.makeTensorInfo([G.length],u.dtype,new Int32Array(G))]}},iX={kernelName:m.SparseReshape,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{inputIndices:u,inputShape:c,newShape:f}=i;if(u.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${u.shape}`);if(c.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${c.shape}`);if(f.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${f.shape}`);let y=Array.from(o.data.get(c.dataId).values),w=o.data.get(u.dataId).values,C=Array.from(o.data.get(f.dataId).values),[T,x,A]=xT(w,u.shape,u.dtype,y,C);return[o.makeTensorInfo(x,u.dtype,T),o.makeTensorInfo([A.length],f.dtype,new Int32Array(A))]}},F2={kernelName:m.SparseSegmentMean,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{data:u,indices:c,segmentIds:f}=i;if(u.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(c.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${c.shape}`);if(f.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${f.shape}`);if(c.shape[0]!==f.shape[0])throw new Error("segmentIds and indices should have same size.");let y=o.data.get(u.dataId).values,w=o.data.get(c.dataId).values,C=o.data.get(f.dataId).values,[T,x]=kT(y,u.shape,u.dtype,w,C,!0);return o.makeTensorInfo(x,u.dtype,T)}},cL={kernelName:m.SparseSegmentSum,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{data:u,indices:c,segmentIds:f}=i;if(u.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(c.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${c.shape}`);if(f.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${f.shape}`);if(c.shape[0]!==f.shape[0])throw new Error("segmentIds and indices should have same size.");let y=o.data.get(u.dataId).values,w=o.data.get(c.dataId).values,C=o.data.get(f.dataId).values,[T,x]=kT(y,u.shape,u.dtype,w,C);return o.makeTensorInfo(x,u.dtype,T)}},aX={kernelName:m.SparseToDense,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{sparseIndices:c,sparseValues:f,defaultValue:y}=i,{outputShape:w}=u,{sliceRank:C,numUpdates:T,sliceSize:x,strides:A,outputSize:M}=m.backend_util.calculateShapes(f,c,w),$=!1,V=o.bufferSync(c),G;switch(f.dtype){case"bool":G=T2(V,o.bufferSync(f),w,M,x,T,C,A,!!o.data.get(y.dataId).values[0],$);break;case"float32":G=T2(V,o.bufferSync(f),w,M,x,T,C,A,o.data.get(y.dataId).values[0],$);break;case"int32":G=T2(V,o.bufferSync(f),w,M,x,T,C,A,o.data.get(y.dataId).values[0],$);break;case"string":G=T2(V,o.bufferSync(f),w,M,x,T,C,A,m.util.decodeString(o.data.get(y.dataId).values[0]),$);break;default:throw new Error(`Unsupported type ${f.dtype}`)}return o.makeTensorInfo(w,G.dtype,G.values)}},oX={kernelName:m.SplitV,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{numOrSizeSplits:f,axis:y}=u,w=m.util.parseAxisParam(y,c.shape)[0],C=m.backend_util.prepareSplitSize(c,f,w),T=new Array(c.shape.length).fill(0),x=c.shape.slice();return C.map(A=>{let M=[...x];M[w]=A;let $=A2({inputs:{x:c},backend:o,attrs:{begin:T,size:M}});return T[w]+=A,$})}},sX={kernelName:m.Square,backendName:"cpu",kernelFunc:({inputs:l,backend:i})=>{let{x:o}=l,u=i;Ii(o,"square");let c=u.data.get(o.dataId).values,f=new Float32Array(c.length);for(let y=0;y<c.length;++y){let w=c[y];f[y]=w*w}return{dataId:u.write(f,o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}},KS=ns(m.Step,(l,i)=>{let o=i;return isNaN(l)?NaN:l>0?1:o.alpha}),ux={kernelName:m.Step,backendName:"cpu",kernelFunc:KS},x0={kernelName:m.StridedSlice,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{begin:f,end:y,strides:w,beginMask:C,endMask:T,ellipsisMask:x,newAxisMask:A,shrinkAxisMask:M}=u;Ii(c,"stridedSlice");let{finalShapeSparse:$,finalShape:V,isIdentity:G,sliceDim0:Q,isSimpleSlice:nt,begin:it,end:ht,strides:kt}=m.slice_util.sliceInfo(c.shape,f,y,w,C,T,x,A,M),Nt;if(G)Nt=Cs({inputs:{x:c},backend:o,attrs:{shape:V}});else if(Q||nt){m.util.assert(c.shape.length>=1,()=>`Input must have rank at least 1, got: ${c.shape.length}`);let $t=m.slice_util.computeOutShape(it,ht,kt),Ut=A2({inputs:{x:c},backend:o,attrs:{begin:it,size:$t}});Nt=Cs({inputs:{x:Ut},backend:o,attrs:{shape:V}}),o.disposeIntermediateTensorInfo(Ut)}else{let $t=pO($,o.bufferSync(c),kt,it);Nt=o.makeTensorInfo(V,$t.dtype,$t.values)}return Nt}},uX={kernelName:m.StringNGrams,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{separator:c,nGramWidths:f,leftPad:y,rightPad:w,padWidth:C,preserveShortSequences:T}=u,{data:x,dataSplits:A}=i,M=o.data.get(x.dataId).values,$=o.data.get(A.dataId).values,[V,G]=sq(M,$,c,f,y,w,C,T);return[o.makeTensorInfo([V.length],"string",V),o.makeTensorInfo(A.shape,"int32",G)]}},lX={kernelName:m.StringSplit,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{skipEmpty:c}=u,{input:f,delimiter:y}=i;if(f.dtype!=="string")throw new Error("Input must be of datatype string");if(f.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${f.shape}`);if(y.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${y.shape}`);let w=o.data.get(f.dataId).values,C=o.data.get(y.dataId).values[0],[T,x,A]=zS(w,C,c),M=x.length;return[o.makeTensorInfo([M,2],"int32",T),o.makeTensorInfo([M],"string",x),o.makeTensorInfo([2],"int32",new Int32Array(A))]}},GT={kernelName:m.StringToHashBucketFast,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{numBuckets:c}=u,{input:f}=i;if(f.dtype!=="string")throw new Error("Input must be of datatype string");if(c<=0)throw new Error("Number of buckets must be at least 1");let y=mO(o.data.get(f.dataId).values,c);return o.makeTensorInfo(f.shape,"int32",y)}},cht=ns(m.Tan,l=>Math.tan(l)),lx={kernelName:m.Tan,backendName:"cpu",kernelFunc:cht},hht=ns(m.Tanh,l=>Math.tanh(l)),cX={kernelName:m.Tanh,backendName:"cpu",kernelFunc:hht},Cm={kernelName:m.TensorScatterUpdate,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{tensor:u,indices:c,updates:f}=i,{sliceRank:y,numUpdates:w,sliceSize:C,strides:T,outputSize:x}=m.backend_util.calculateShapes(f,c,u.shape),A=o.bufferSync(c),M=o.bufferSync(f),$=o.bufferSync(u),V=T2(A,M,u.shape,x,C,w,y,T,$,!1);return o.makeTensorInfo(u.shape,V.dtype,V.values)}},hL={kernelName:m.Tile,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{reps:f}=u;Ii(c,"tile");let y=lq(o.bufferSync(c),f);return o.makeTensorInfo(y.shape,y.dtype,y.values)}},dL={kernelName:m.TopK,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{k:f,sorted:y}=u;Ii(c,"topk");let w=o.data.get(c.dataId).values,[C,T]=gO(w,c.shape,c.dtype,f,y);return[o.makeTensorInfo(C.shape,C.dtype,C.values),o.makeTensorInfo(T.shape,T.dtype,T.values)]}},dht={kernelName:m.Transform,backendName:"cpu",kernelFunc:function(l){let{inputs:i,attrs:o,backend:u}=l,{image:c,transforms:f}=i,{interpolation:y,fillMode:w,fillValue:C,outputShape:T}=o,[x,A,M,$]=c.shape,[V,G]=T??[A,M],Q=[x,V,G,$],nt=m.util.computeStrides(c.shape),it=nt[0],ht=nt[1],kt=nt[2],Nt=m.util.computeStrides(Q),$t=Nt[0],Ut=Nt[1],Pt=Nt[2],re=m.util.getTypedArrayFromDType(c.dtype,m.util.sizeFromShape(Q));re.fill(C);let ue=u.data.get(c.dataId).values,be=u.data.get(f.dataId).values;for(let De=0;De<x;++De){let ze=f.shape[0]===1?be:be.subarray(8*De,8*De+8);for(let Qe=0;Qe<V;++Qe)for(let cn=0;cn<G;++cn)for(let en=0;en<$;++en){let sn,xn=ze[6]*cn+ze[7]*Qe+1;if(xn===0)continue;let Rn=(ze[0]*cn+ze[1]*Qe+ze[2])/xn,Bn=(ze[3]*cn+ze[4]*Qe+ze[5])/xn,Fn=fL(Rn,M,w),Xn=fL(Bn,A,w);switch(y){case"nearest":sn=ZS(ue,A,M,it,ht,kt,De,Xn,Fn,en,C);break;case"bilinear":sn=pL(ue,A,M,it,ht,kt,De,Xn,Fn,en,C);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${y}`)}re[De*$t+Qe*Ut+cn*Pt+en]=sn}return u.makeTensorInfo(Q,c.dtype,re)}return{dataId:u.write(re,Q,c.dtype),shape:c.shape,dtype:c.dtype}}};function fL(l,i,o){switch(o){case"reflect":return function(u,c){let f=u;if(f<0)if(c<=1)f=0;else{let y=2*c;f<y&&(f=y*Math.trunc(-f/y)+f),f=f<-c?f+y:-f-1}else if(f>c-1)if(c<=1)f=0;else{let y=2*c;f-=y*Math.trunc(f/y),f>=c&&(f=y-f-1)}return m.util.clamp(0,f,c-1)}(l,i);case"wrap":return function(u,c){let f=u;if(f<0)if(c<=1)f=0;else{let y=c-1;f+=c*(Math.trunc(-f/y)+1)}else if(f>c-1)if(c<=1)f=0;else{let y=c-1;f-=c*Math.trunc(f/y)}return m.util.clamp(0,f,c-1)}(l,i);case"nearest":return function(u,c){return m.util.clamp(0,u,c-1)}(l,i);default:return function(u){return u}(l)}}function O2(l,i,o,u,c,f,y,w,C,T,x){return 0<=w&&w<i&&0<=C&&C<o?l[y*u+w*c+C*f+T]:x}function ZS(l,i,o,u,c,f,y,w,C,T,x){return O2(l,i,o,u,c,f,y,Math.round(w),Math.round(C),T,x)}function pL(l,i,o,u,c,f,y,w,C,T,x){let A=Math.floor(w),M=Math.floor(C),$=A+1,V=M+1;return($-w)*((V-C)*O2(l,i,o,u,c,f,y,A,M,T,x)+(C-M)*O2(l,i,o,u,c,f,y,A,V,T,x))+(w-A)*((V-C)*O2(l,i,o,u,c,f,y,$,M,T,x)+(C-M)*O2(l,i,o,u,c,f,y,$,V,T,x))}let Jv={kernelName:m.Unique,backendName:"cpu",kernelFunc:function(l){let{inputs:i,attrs:o,backend:u}=l,{axis:c}=o,{x:f}=i;Ii(f,"unique");let y=u.data.get(f.dataId).values,{outputValues:w,outputShape:C,indices:T}=hq(y,c,f.shape,f.dtype);return[u.makeTensorInfo(C,f.dtype,w),u.makeTensorInfo([T.length],"int32",T)]}},mL={kernelName:m.Unpack,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{value:c}=i,{axis:f}=u;f<0&&(f+=c.shape.length);let y=c.shape.length,w=c.shape[f],C=new Array(y-1),T=0;for(let $=0;$<y;$++)$!==f&&(C[T++]=c.shape[$]);let x=new Array(y).fill(0),A=c.shape.slice();A[f]=1;let M=new Array(w);for(let $=0;$<M.length;$++){x[f]=$;let V=A2({inputs:{x:c},backend:o,attrs:{begin:x,size:A}});M[$]=Cs({inputs:{x:V},backend:o,attrs:{shape:C}}),o.disposeIntermediateTensorInfo(V)}return M}},hX={kernelName:m.UnsortedSegmentSum,backendName:"cpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,segmentIds:f}=i,{numSegments:y}=u;Ii(c,"unsortedSegmentSum");let w=[],C=[],T=c.shape.length-f.shape.length,x=f;for(let M=0;M<T;++M){let $=WS({inputs:{input:x},backend:o,attrs:{dim:M+1}});x=$,C.push($)}for(let M=0;M<y;++M){let $=m.util.createScalarValue(M,"int32"),V=o.makeTensorInfo([],"int32",$),G=HY({inputs:{a:V,b:x},backend:o}),Q=cp({inputs:{x:G},backend:o,attrs:{dtype:"float32"}}),nt=mT({inputs:{a:Q,b:c},backend:o}),it=w0({inputs:{x:nt},backend:o,attrs:{axis:0,keepDims:!1}});w.push(it),C.push(V),C.push(G),C.push(Q),C.push(nt),C.push(it)}let A=qS({inputs:w,backend:o,attrs:{axis:0}});return C.forEach(M=>o.disposeIntermediateTensorInfo(M)),A}},gL=[Tct,uct,Pg,Act,cct,yq,Ict,Nct,vq,TO,AT,bq,xq,kq,Dct,MO,DO,RO,FO,CO,OO,LO,$O,UY,zO,JF,fct,BO,zY,ex,NT,qv,km,nx,rx,MT,DT,UO,WO,Xl,jS,US,hp,VO,_q,Rct,Fct,FT,Cq,Eq,rs,Tq,ix,fq,HO,eO,Rq,uT,Fq,lT,$q,zq,Pq,nO,hT,XO,Bq,jq,Uq,fT,YY,PY,$ct,BS,zct,Vq,Gq,pq,gct,jv,jct,Wv,KO,Yq,Uct,Gct,Hct,ZO,Xv,wm,_m,ox,QO,JO,Xq,Yct,dp,vct,qct,Zq,eL,wct,KY,Kct,Qct,jg,ZY,$T,YS,tht,Qq,rht,wO,QY,iht,aht,nL,sx,lct,qO,rL,Ect,SO,_O,Kl,iL,aL,sht,Jq,XS,uht,vT,zT,Kv,oL,R2,dc,tX,Zv,lL,xct,Xct,lht,nX,rX,iX,F2,cL,aX,oX,iq,sX,fO,_T,ux,x0,uX,lX,GT,Cct,GO,lx,cX,Cm,hL,dL,dht,gT,Jv,mL,hX,HS];for(let l of gL)(0,m.registerKernel)(l);let tb={},cx={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function dX(l,i){tb[l]=i}function fp(l,i){if(!(l in tb)||i!=null){let u=function(c,f){if(c!==1&&c!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let y=f??function(w){if((0,m.env)().getBool("IS_SAFARI")||typeof OffscreenCanvas>"u"||w!==2){if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(c);return y.addEventListener("webglcontextlost",w=>{w.preventDefault(),delete tb[c]},!1),(0,m.env)().getBool("SOFTWARE_WEBGL_ENABLED")&&(cx.failIfMajorPerformanceCaveat=!1),c===1?y.getContext("webgl",cx)||y.getContext("experimental-webgl",cx):y.getContext("webgl2",cx)}(l,i);if(u===null)return console.log("Could not get context for WebGL version",l),null;tb[l]=u}let o=tb[l];return o==null||o.isContextLost()?(delete tb[l],fp(l)):(o.disable(o.DEPTH_TEST),o.disable(o.STENCIL_TEST),o.disable(o.BLEND),o.disable(o.DITHER),o.disable(o.POLYGON_OFFSET_FILL),o.disable(o.SAMPLE_COVERAGE),o.enable(o.SCISSOR_TEST),o.enable(o.CULL_FACE),o.cullFace(o.BACK),tb[l])}var hx,QS,Hc,L2,fc,Em;function JS(l,i){return[i,l]}function $2(l){let i=m.util.sizeFromShape(l),o=Math.ceil(i/4);return m.util.sizeToSquarishShape(o)}function z2(l,i){return[Math.max(1,Math.ceil(i/2)),Math.max(1,Math.ceil(l/2))]}function t_(l,i){let o=l,u,c,f,y,w,C,T,x,A,M;return(0,m.env)().getNumber("WEBGL_VERSION")===2?(u=o.R32F,c=o.R16F,f=o.RGBA16F,y=o.RGBA32F,w=o.RED,T=4,x=1,A=o.HALF_FLOAT,M=o.FLOAT,C=o.RGBA8):(u=l.RGBA,c=l.RGBA,f=l.RGBA,y=o.RGBA,w=l.RGBA,T=4,x=4,A=i!=null?i.HALF_FLOAT_OES:null,M=l.FLOAT,C=l.RGBA),{internalFormatFloat:u,internalFormatHalfFloat:c,internalFormatPackedHalfFloat:f,internalFormatPackedFloat:y,textureFormatFloat:w,downloadTextureFormat:C,downloadUnpackNumChannels:T,defaultNumChannels:x,textureTypeHalfFloat:A,textureTypeFloat:M}}function ti(l,i){let o=i();return(0,m.env)().getBool("DEBUG")&&function(u){let c=u.getError();if(c!==u.NO_ERROR)throw new Error("WebGL Error: "+pX(u,c))}(l),o}(QS=hx||(hx={}))[QS.DENSE=0]="DENSE",QS[QS.SHARED_BATCH=1]="SHARED_BATCH",(L2=Hc||(Hc={}))[L2.RENDER=0]="RENDER",L2[L2.UPLOAD=1]="UPLOAD",L2[L2.PIXELS=2]="PIXELS",L2[L2.DOWNLOAD=3]="DOWNLOAD",(Em=fc||(fc={}))[Em.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",Em[Em.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",Em[Em.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",Em[Em.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",Em[Em.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16";let HT=596e-10,YT=65504;function fX(l){return!!((0,m.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||l===0||HT<Math.abs(l)&&Math.abs(l)<YT)}function pX(l,i){switch(i){case l.NO_ERROR:return"NO_ERROR";case l.INVALID_ENUM:return"INVALID_ENUM";case l.INVALID_VALUE:return"INVALID_VALUE";case l.INVALID_OPERATION:return"INVALID_OPERATION";case l.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case l.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case l.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${i}`}}function P2(l,i){return mp(l,()=>l.getExtension(i),'Extension "'+i+'" not supported on this browser.')}function mX(l,i){let o=mp(l,()=>l.createShader(l.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(ti(l,()=>l.shaderSource(o,i)),ti(l,()=>l.compileShader(o)),l.getShaderParameter(o,l.COMPILE_STATUS)===!1)throw console.log(l.getShaderInfoLog(o)),new Error("Failed to compile vertex shader.");return o}function yL(l,i){let o=mp(l,()=>l.createShader(l.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(ti(l,()=>l.shaderSource(o,i)),ti(l,()=>l.compileShader(o)),(0,m.env)().get("ENGINE_COMPILE_ONLY"))return o;if(l.getShaderParameter(o,l.COMPILE_STATUS)===!1)throw qT(i,l.getShaderInfoLog(o)),new Error("Failed to compile fragment shader.");return o}let fht=/ERROR: [0-9]+:([0-9]+):/g;function qT(l,i){let o=fht.exec(i);if(o==null)return console.log(`Couldn't parse line number in error: ${i}`),void console.log(l);let u=+o[1],c=l.split(`
`),f=c.length.toString().length+2,y=c.map((A,M)=>m.util.rightPad((M+1).toString(),f)+A),w=0;for(let A=0;A<y.length;A++)w=Math.max(y[A].length,w);let C=y.slice(0,u-1),T=y.slice(u-1,u),x=y.slice(u);console.log(C.join(`
`)),console.log(i.split(`
`)[0]),console.log(`%c ${m.util.rightPad(T[0],w)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(x.join(`
`))}function gX(l){return mp(l,()=>l.createProgram(),"Unable to create WebGLProgram.")}function yX(l,i){if(ti(l,()=>l.linkProgram(i)),!(0,m.env)().get("ENGINE_COMPILE_ONLY")&&l.getProgramParameter(i,l.LINK_STATUS)===!1)throw console.log(l.getProgramInfoLog(i)),new Error("Failed to link vertex and fragment shaders.")}function XT(l,i){if(ti(l,()=>l.validateProgram(i)),l.getProgramParameter(i,l.VALIDATE_STATUS)===!1)throw console.log(l.getProgramInfoLog(i)),new Error("Shader program validation failed.")}function vL(l,i){let o=mp(l,()=>l.createBuffer(),"Unable to create WebGLBuffer");return ti(l,()=>l.bindBuffer(l.ARRAY_BUFFER,o)),ti(l,()=>l.bufferData(l.ARRAY_BUFFER,i,l.STATIC_DRAW)),o}function pp(l,i){let o=mp(l,()=>l.createBuffer(),"Unable to create WebGLBuffer");return ti(l,()=>l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,o)),ti(l,()=>l.bufferData(l.ELEMENT_ARRAY_BUFFER,i,l.STATIC_DRAW)),o}function vX(){return(0,m.env)().getNumber("WEBGL_VERSION")===2?1:4}function e_(l){return mp(l,()=>l.createTexture(),"Unable to create WebGLTexture.")}function bL(l,i){let o=(0,m.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(l<=0||i<=0)throw new Error(`Requested texture size [${l}x${i}] is invalid.`);if(l>o||i>o)throw new Error(`Requested texture size [${l}x${i}] greater than WebGL maximum on this browser / GPU [${o}x${o}].`)}function KT(l){return mp(l,()=>l.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function ZT(l,i,o,u,c,f,y){let w=l.getAttribLocation(i,o);return w!==-1&&(ti(l,()=>l.bindBuffer(l.ARRAY_BUFFER,u)),ti(l,()=>l.vertexAttribPointer(w,c,l.FLOAT,!1,f,y)),ti(l,()=>l.enableVertexAttribArray(w)),!0)}function Tm(l,i,o){JT(l,o),ti(l,()=>l.activeTexture(l.TEXTURE0+o)),ti(l,()=>l.bindTexture(l.TEXTURE_2D,i))}function eb(l,i){JT(l,i),ti(l,()=>l.activeTexture(l.TEXTURE0+i)),ti(l,()=>l.bindTexture(l.TEXTURE_2D,null))}function dx(l,i,o){return mp(l,()=>l.getUniformLocation(i,o),'uniform "'+o+'" not present in program.')}function wL(l,i,o){return l.getUniformLocation(i,o)}function Ug(l,i,o,u){ti(l,()=>Tm(l,i,u)),ti(l,()=>l.uniform1i(o,u))}function QT(l){ti(l,()=>l.bindFramebuffer(l.FRAMEBUFFER,null)),ti(l,()=>l.viewport(0,0,l.canvas.width,l.canvas.height)),ti(l,()=>l.scissor(0,0,l.canvas.width,l.canvas.height))}function fx(l,i,o){ti(l,()=>l.bindFramebuffer(l.FRAMEBUFFER,o)),ti(l,()=>l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,i,0))}function n_(l,i){ti(l,()=>l.bindFramebuffer(l.FRAMEBUFFER,i)),ti(l,()=>l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,null,0))}function r_(l){let i=l.checkFramebufferStatus(l.FRAMEBUFFER);if(i!==l.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+px(l,i))}function px(l,i){switch(i){case l.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case l.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case l.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case l.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${i}`}}function mp(l,i,o){let u=ti(l,()=>i());if(u==null)throw new Error(o);return u}function JT(l,i){let o=l.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,u=i+l.TEXTURE0;if(u<l.TEXTURE0||u>o)throw new Error(`textureUnit must be in ${`[gl.TEXTURE0, gl.TEXTURE${o}]`}.`)}function nb(l,i=2){return m.util.sizeFromShape(l.slice(0,l.length-i))}function rb(l){if(l.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[l.length>1?l[l.length-2]:1,l[l.length-1]]}function bh(l){let i=[1,1,1];return l.length===0||l.length===1&&l[0]===1||(i=[nb(l),...rb(l)]),i}function xL(l,i=!1){let o=(0,m.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE"),u=(0,m.env)().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");u===1/0&&(0,m.env)().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(u=o/2),i&&(o*=2,u*=2,(l=l.map((w,C)=>C>=l.length-2?m.util.nearestLargerEven(l[C]):l[C])).length===1&&(l=[2,l[0]])),l.length!==2&&(l=m.util.squeezeShape(l).newShape);let c=m.util.sizeFromShape(l),f=null;l.length<=1&&c<=o?f=[1,c]:l.length===2&&l[0]<=o&&l[1]<=o?f=l:l.length===3&&l[0]*l[1]<=o&&l[2]<=o?f=[l[0]*l[1],l[2]]:l.length===3&&l[0]<=o&&l[1]*l[2]<=o?f=[l[0],l[1]*l[2]]:l.length===4&&l[0]*l[1]*l[2]<=o&&l[3]<=o?f=[l[0]*l[1]*l[2],l[3]]:l.length===4&&l[0]<=o&&l[1]*l[2]*l[3]<=o&&(f=[l[0],l[1]*l[2]*l[3]]);let y=f!=null&&Math.max(...f)>u&&Math.min(...f)<=(i?2:1)&&Math.min(...f)>0;if(f==null||y)if(i){let w=nb(l),C=2,T=2;l.length&&([C,T]=rb(l)),c=w*(C/2)*(T/2),f=m.util.sizeToSquarishShape(c).map(x=>2*x)}else f=m.util.sizeToSquarishShape(c);return f}function i_(l){return l%2==0}function a_(l,i){if(l=l.slice(-2),i=i.slice(-2),m.util.arraysEqual(l,i)||!l.length||!i.length||l[0]===0||l[1]===0||i[0]===0||i[1]===0)return!0;if(l.length!==i.length){let o=l[l.length-1],u=i[i.length-1];if(o===u||i_(o)&&i_(u)&&(l[0]===1||i[0]===1))return!0}return l[1]===i[1]&&i_(l[0])&&i_(i[0])}let tA,o_;function bX(l){if(tA==null){let i=fp(l);tA=i.getParameter(i.MAX_TEXTURE_SIZE)}return tA}function wX(){tA=null}function ib(){o_=null}function kL(l){if(o_==null){let i=fp(l);o_=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,o_)}function Zl(l){if(l===0)return 0;let i,o=fp(l);return i=zu(o,"EXT_disjoint_timer_query_webgl2")&&l===2?2:zu(o,"EXT_disjoint_timer_query")?1:0,i}function zu(l,i){return l.getExtension(i)!=null}function eA(l){try{if(fp(l)!=null)return!0}catch(i){return console.log("Error when getting WebGL context: ",i),!1}return!1}function nA(l){if(l===0)return!1;let i=fp(l);if(l===1){if(!zu(i,"OES_texture_float"))return!1}else if(!zu(i,"EXT_color_buffer_float"))return!1;return _L(i)}function SL(l){if(l===0)return!1;let i=fp(l);if(l!==1){if(zu(i,"EXT_color_buffer_float"))return _L(i);let o="EXT_color_buffer_half_float";if(zu(i,o)){let u=i.getExtension(o);return function(c,f){let y=t_(c,f),w=c.createTexture();c.bindTexture(c.TEXTURE_2D,w),c.texImage2D(c.TEXTURE_2D,0,y.internalFormatHalfFloat,1,1,0,y.textureFormatFloat,y.textureTypeHalfFloat,null);let x=c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,x),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,w,0);let A=c.checkFramebufferStatus(c.FRAMEBUFFER)===c.FRAMEBUFFER_COMPLETE;return c.bindTexture(c.TEXTURE_2D,null),c.bindFramebuffer(c.FRAMEBUFFER,null),c.deleteTexture(w),c.deleteFramebuffer(x),A}(i,u)}return!1}return!zu(i,"OES_texture_float")||!zu(i,"WEBGL_color_buffer_float")?!1:_L(i)}function _L(l){let i=t_(l),o=l.createTexture();l.bindTexture(l.TEXTURE_2D,o),l.texImage2D(l.TEXTURE_2D,0,i.internalFormatFloat,1,1,0,i.textureFormatFloat,i.textureTypeFloat,null);let u=l.createFramebuffer();l.bindFramebuffer(l.FRAMEBUFFER,u),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,o,0);let c=l.checkFramebufferStatus(l.FRAMEBUFFER)===l.FRAMEBUFFER_COMPLETE;return l.bindTexture(l.TEXTURE_2D,null),l.bindFramebuffer(l.FRAMEBUFFER,null),l.deleteTexture(o),l.deleteFramebuffer(u),c}function s_(l){return l!==2?!1:fp(l).fenceSync!=null}function ab(l,i){Array.isArray(l)||(l=[l]),l.forEach(o=>{o!=null&&m.util.assert(o.dtype!=="complex64",()=>`${i} does not support complex64 tensors in the WebGL backend.`)})}let Ri=(0,m.env)();function Yc(){let l,i,o,u,c,f,y,w,C,T;return(0,m.env)().getNumber("WEBGL_VERSION")===2?(l="#version 300 es",i="in",o="out",u="in",c="texture",f="outputColor",y="out vec4 outputColor;",w=(0,m.env)().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",C="",T=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(l="",i="attribute",o="varying",u="varying",c="texture2D",f="gl_FragColor",y="",w=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,C=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,T=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:l,attribute:i,varyingVs:o,varyingFs:u,texture2D:c,output:f,defineOutput:y,defineSpecialNaN:w,defineSpecialInf:C,defineRound:T}}function Wg(l,i,o="index"){let u=m.util.computeStrides(i);return u.map((c,f)=>`${`int ${l[f]} = ${o} / ${c}`}; ${f===u.length-1?`int ${l[f+1]} = ${o} - ${l[f]} * ${c}`:`index -= ${l[f]} * ${c}`};`).join("")}function ob(l,i,o="index"){let u=m.util.computeStrides(i);return u.map((c,f)=>`${`int ${l[f]} = ${o} / outShapeStrides[${f}]`}; ${f===u.length-1?`int ${l[f+1]} = ${o} - ${l[f]} * outShapeStrides[${f}]`:`index -= ${l[f]} * outShapeStrides[${f}]`};`).join("")}function rA(l,i,o="index"){let u=function(c,f){let y=c.length,w=c.map(T=>`${f}[${T}]`),C=new Array(y-1);C[y-2]=w[y-1];for(let T=y-3;T>=0;--T)C[T]=`(${C[T+1]} * ${w[T+1]})`;return C}(l.map((c,f)=>f),i);return u.map((c,f)=>`${`int ${l[f]} = ${o} / ${u[f]}`}; ${f===u.length-1?`int ${l[f+1]} = ${o} - ${l[f]} * ${u[f]}`:`index -= ${l[f]} * ${u[f]}`};`).join("")}function iA(l){let i=m.util.computeStrides(l).map(o=>o.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${i[0]} + coords.y * ${i[1]} + coords.z;
  }
`}Ri.registerFlag("HAS_WEBGL",()=>Ri.getNumber("WEBGL_VERSION")>0),Ri.registerFlag("WEBGL_VERSION",()=>eA(2)?2:eA(1)?1:0),Ri.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),Ri.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ri.get("WEBGL_VERSION")===2),Ri.registerFlag("WEBGL_CPU_FORWARD",()=>!0),Ri.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),Ri.registerFlag("WEBGL_PACK",()=>Ri.getBool("HAS_WEBGL")),Ri.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ri.getBool("WEBGL_PACK")),Ri.registerFlag("WEBGL_PACK_CLIP",()=>Ri.getBool("WEBGL_PACK")),Ri.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ri.getBool("WEBGL_PACK")),Ri.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ri.getBool("WEBGL_PACK")),Ri.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ri.getBool("WEBGL_PACK")),Ri.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ri.getBool("WEBGL_PACK")),Ri.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ri.getBool("WEBGL_PACK")),Ri.registerFlag("WEBGL_PACK_REDUCE",()=>Ri.getBool("WEBGL_PACK")),Ri.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ri.getBool("WEBGL_PACK")),Ri.registerFlag("WEBGL_CONV_IM2COL",()=>Ri.getBool("WEBGL_PACK")),Ri.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Ri.getBool("WEBGL_PACK")),Ri.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>bX(Ri.getNumber("WEBGL_VERSION"))),Ri.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>kL(Ri.getNumber("WEBGL_VERSION"))),Ri.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let l=Ri.getNumber("WEBGL_VERSION");return l===0?0:Zl(l)}),Ri.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ri.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!m.device_util.isMobile()),Ri.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>nA(Ri.getNumber("WEBGL_VERSION"))),Ri.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!Ri.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ri.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),Ri.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>SL(Ri.getNumber("WEBGL_VERSION"))),Ri.registerFlag("WEBGL_FENCE_API_ENABLED",()=>s_(Ri.getNumber("WEBGL_VERSION"))),Ri.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ri.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),Ri.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,l=>{if(typeof l!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${l}.`);if(l<0&&l!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${l}.`)}),Ri.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>m.device_util.isMobile()?1:-1,l=>{if(typeof l!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${l}.`);if(l<0&&l!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${l}.`)}),Ri.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),Ri.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),Ri.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),Ri.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),Ri.registerFlag("WEBGL_EXP_CONV",()=>!1),Ri.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ri.getBool("IS_TEST")),Ri.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),Ri.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),Ri.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1),Ri.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);let aA=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`,{getBroadcastDims:CL}=m.backend_util;function oA(l,i,o){let u=[];if(l.forEach(M=>{let $=m.util.sizeFromShape(M.shapeInfo.logicalShape);if(M.shapeInfo.isUniform?u.push(`uniform float ${M.name}${$>1?`[${$}]`:""};`):(u.push(`uniform sampler2D ${M.name};`),u.push(`uniform int offset${M.name};`)),o.enableShapeUniforms){let{uniformShape:V}=mx(o.packedInputs,M.shapeInfo.logicalShape,M.shapeInfo.texShape);switch(V.length){case 1:u.push(`uniform int ${M.name}Shape;`);break;case 2:u.push(`uniform ivec2 ${M.name}Shape;`);break;case 3:u.push(`uniform ivec3 ${M.name}Shape;`);break;case 4:u.push(`uniform ivec4 ${M.name}Shape;`)}u.push(`uniform ivec2 ${M.name}TexShape;`)}}),o.enableShapeUniforms){switch(i.logicalShape.length){case 1:u.push("uniform int outShape;");break;case 2:u.push("uniform ivec2 outShape;"),u.push("uniform int outShapeStrides;");break;case 3:u.push("uniform ivec3 outShape;"),u.push("uniform ivec2 outShapeStrides;");break;case 4:u.push("uniform ivec4 outShape;"),u.push("uniform ivec3 outShapeStrides;")}u.push("uniform ivec2 outTexShape;")}o.customUniforms&&o.customUniforms.forEach(M=>{u.push(`uniform ${M.type} ${M.name}${M.arrayIndex?`[${M.arrayIndex}]`:""};`)});let c=u.join(`
`),f=l.map(M=>function($,V,G=!1,Q){let nt="";nt+=G?u_($,Q):sb($,Q);let it=$.shapeInfo.logicalShape,ht=V.logicalShape;return it.length<=ht.length&&(nt+=G?function(kt,Nt){let $t=kt.name,Ut=$t.charAt(0).toUpperCase()+$t.slice(1),Pt="get"+Ut+"AtOutCoords",re=kt.shapeInfo.logicalShape.length,ue=Nt.logicalShape.length,be=CL(kt.shapeInfo.logicalShape,Nt.logicalShape),De=is(ue),ze=ue-re,Qe,cn=["x","y","z","w","u","v"];Qe=re===0?"":ue<2&&be.length>=1?"coords = 0;":be.map(Fn=>`coords.${cn[Fn+ze]} = 0;`).join(`
`);let en="";en=ue<2&&re>0?"coords":kt.shapeInfo.logicalShape.map((Fn,Xn)=>`coords.${cn[Xn+ze]}`).join(", ");let sn="return outputValue;",xn=m.util.sizeFromShape(kt.shapeInfo.logicalShape)===1,Rn=m.util.sizeFromShape(Nt.logicalShape),Bn=Rn===1;if(re!==1||xn||Bn){if(xn&&!Bn)sn=ue===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(be.length){let Fn=re-2,Xn=re-1;be.indexOf(Fn)>-1&&be.indexOf(Xn)>-1?sn="return vec4(outputValue.x);":be.indexOf(Fn)>-1?sn="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":be.indexOf(Xn)>-1&&(sn="return vec4(outputValue.xx, outputValue.zz);")}}else sn=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 ${Pt}() {
      ${De} coords = getOutputCoords();
      ${Qe}
      vec4 outputValue = get${Ut}(${en});
      ${sn}
    }
  `}($,V):function(kt,Nt){let $t=kt.name,Ut=$t.charAt(0).toUpperCase()+$t.slice(1),Pt="get"+Ut+"AtOutCoords",re=Nt.texShape,ue=kt.shapeInfo.texShape,be=kt.shapeInfo.logicalShape.length,De=Nt.logicalShape.length;if(!kt.shapeInfo.isUniform&&be===De&&kt.shapeInfo.flatOffset==null&&m.util.arraysEqual(ue,re))return`
      float ${Pt}() {
        return sampleTexture(${$t}, resultUV);
      }
    `;let ze=is(De),Qe=CL(kt.shapeInfo.logicalShape,Nt.logicalShape),cn=De-be,en,sn=["x","y","z","w","u","v"];en=be===0?"":De<2&&Qe.length>=1?"coords = 0;":Qe.map(Rn=>`coords.${sn[Rn+cn]} = 0;`).join(`
`);let xn="";return xn=De<2&&be>0?"coords":kt.shapeInfo.logicalShape.map((Rn,Bn)=>`coords.${sn[Bn+cn]}`).join(", "),`
    float ${Pt}() {
      ${ze} coords = getOutputCoords();
      ${en}
      return get${Ut}(${xn});
    }
  `}($,V)),nt}(M,i,o.packedInputs,o.enableShapeUniforms)).join(`
`),y=i.texShape,w=Yc(),C=function(M){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${M.texture2D}(textureSampler, uv).r;
    }
  `}(w),T,x,A=function(M){return`${M.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${M.varyingFs} vec2 resultUV;
    ${M.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${M.defineSpecialNaN}
    ${M.defineSpecialInf}
    ${M.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${xX}
    ${sA}
    ${uA}
  `}(w);return i.isPacked?(T=function(M,$,V){switch(M.length){case 0:return kX();case 1:return function(G,Q,nt){let it=[Math.ceil(Q[0]/2),Math.ceil(Q[1]/2)];return it[0]===1?nt?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${it[1]}.0);
      }
    `:it[1]===1?nt?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${it[0]}.0);
      }
    `:nt?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${it[0]}, ${it[1]}));
      return 2 * (resTexRC.x * ${it[1]} + resTexRC.y);
    }
  `}(0,$,V);case 2:return function(G,Q,nt){let it=[Math.ceil(Q[0]/2),Math.ceil(Q[1]/2)];if(m.util.arraysEqual(G,Q))return nt?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${it[0]}, ${it[1]}));
      }
    `;let ht=Math.ceil(G[1]/2);return nt?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${it[0]}, ${it[1]}));

      int index = resTexRC.x * ${it[1]} + resTexRC.y;
      int r = 2 * (index / ${ht});
      int c = imod(index, ${ht}) * 2;

      return ivec2(r, c);
    }
  `}(M,$,V);case 3:return function(G,Q,nt){if(nt)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;let it=[Math.ceil(Q[0]/2),Math.ceil(Q[1]/2)],ht=Math.ceil(G[2]/2),kt=ht*Math.ceil(G[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${it[0]}, ${it[1]}));
      int index = resTexRC.x * ${it[1]} + resTexRC.y;

      int b = index / ${kt};
      index -= b * ${kt};

      int r = 2 * (index / ${ht});
      int c = imod(index, ${ht}) * 2;

      return ivec3(b, r, c);
    }
  `}(M,$,V);default:return function(G,Q,nt){if(nt)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;let it=[Math.ceil(Q[0]/2),Math.ceil(Q[1]/2)],ht=Math.ceil(G[G.length-1]/2),kt=ht*Math.ceil(G[G.length-2]/2),Nt=kt,$t="",Ut="b, r, c";for(let Pt=2;Pt<G.length-1;Pt++)Nt*=G[G.length-Pt-1],$t=`
      int b${Pt} = index / ${Nt};
      index -= b${Pt} * ${Nt};
    `+$t,Ut=`b${Pt}, `+Ut;return`
    ivec${G.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${it[0]}, ${it[1]}));
      int index = resTexRC.x * ${it[1]} + resTexRC.y;

      ${$t}

      int b = index / ${kt};
      index -= b * ${kt};

      int r = 2 * (index / ${ht});
      int c = imod(index, ${ht}) * 2;

      return ivec${G.length}(${Ut});
    }
  `}(M,$,V)}}(i.logicalShape,y,o.enableShapeUniforms),x=function(M){return`
    void setOutput(vec4 val) {
      ${M.output} = val;
    }
  `}(w)):(T=function(M,$,V){switch(M.length){case 0:return kX();case 1:return function(G,Q,nt){return Q[0]===1?nt?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${Q[1]}.0);
      }
    `:Q[1]===1?nt?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${Q[0]}.0);
      }
    `:nt?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${Q[0]}, ${Q[1]}));
      return resTexRC.x * ${Q[1]} + resTexRC.y;
    }
  `}(0,$,V);case 2:return function(G,Q,nt){return m.util.arraysEqual(G,Q)?nt?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${Q[0]}, ${Q[1]}));
      }
    `:G[1]===1?nt?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${Q[0]}, ${Q[1]}));
        int index = resTexRC.x * ${Q[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:G[0]===1?nt?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${Q[0]}, ${Q[1]}));
        int index = resTexRC.x * ${Q[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:nt?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${Q[0]}, ${Q[1]}));
      int index = resTexRC.x * ${Q[1]} + resTexRC.y;
      int r = index / ${G[1]};
      int c = index - r * ${G[1]};
      return ivec2(r, c);
    }
  `}(M,$,V);case 3:return function(G,Q,nt){if(nt)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${ob(["r","c","d"],G)}
    return ivec3(r, c, d);
  }
`;let it=Wg(["r","c","d"],G);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${Q[0]}, ${Q[1]}));
      int index = resTexRC.x * ${Q[1]} + resTexRC.y;
      ${it}
      return ivec3(r, c, d);
    }
  `}(M,$,V);case 4:return function(G,Q,nt){if(nt)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${ob(["r","c","d","d2"],G)}
      return ivec4(r, c, d, d2);
    }
  `;let it=Wg(["r","c","d","d2"],G);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${Q[0]}, ${Q[1]}));
      int index = resTexRC.x * ${Q[1]} + resTexRC.y;
      ${it}
      return ivec4(r, c, d, d2);
    }
  `}(M,$,V);case 5:return function(G,Q){let nt=Wg(["r","c","d","d2","d3"],G);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${Q[0]},
                             ${Q[1]}));

      int index = resTexRC.x * ${Q[1]} + resTexRC.y;

      ${nt}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(M,$);case 6:return function(G,Q){let nt=Wg(["r","c","d","d2","d3","d4"],G);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${Q[0]}, ${Q[1]}));
      int index = resTexRC.x * ${Q[1]} + resTexRC.y;

      ${nt}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(M,$);default:throw new Error(`${M.length}-D output sampling is not yet supported`)}}(i.logicalShape,y,o.enableShapeUniforms),x=function(M){return`
    void setOutput(float val) {
      ${M.output} = vec4(val, 0, 0, 0);
    }
  `}(w)),o.packedInputs&&(A+=lA),[A,C,x,c,T,f,o.userCode].join(`
`)}function sb(l,i=!1){let o=l.shapeInfo.logicalShape;switch(o.length){case 0:return function(u,c){let f=u.name,y="get"+f.charAt(0).toUpperCase()+f.slice(1);if(u.shapeInfo.isUniform)return`float ${y}() {return ${f};}`;let[w,C]=u.shapeInfo.texShape;if(w===1&&C===1)return`
      float ${y}() {
        return sampleTexture(${f}, halfCR);
      }
    `;let T=Vg(f);if(c)return`
    float ${y}() {
      vec2 uv = uvFromFlat(${f}TexShape[0], ${f}TexShape[1], ${T});
      return sampleTexture(${f}, uv);
    }
  `;let[x,A]=u.shapeInfo.texShape;return`
    float ${y}() {
      vec2 uv = uvFromFlat(${x}, ${A}, ${T});
      return sampleTexture(${f}, uv);
    }
  `}(l,i);case 1:return function(u,c){let f=u.name,y="get"+f.charAt(0).toUpperCase()+f.slice(1);if(u.shapeInfo.isUniform)return`
      float ${y}(int index) {
        ${Am(u)}
      }
    `;let w=u.shapeInfo.texShape,C=w[0],T=w[1];if(T===1&&C===1)return`
      float ${y}(int index) {
        return sampleTexture(${f}, halfCR);
      }
    `;let x=Vg(f);return T===1?c?`
      float ${y}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${x}) + 0.5) / float(${f}TexShape[0]));
        return sampleTexture(${f}, uv);
      }
    `:`
      float ${y}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${x}) + 0.5) / ${C}.0);
        return sampleTexture(${f}, uv);
      }
    `:C===1?c?`
      float ${y}(int index) {
        vec2 uv = vec2((float(index + ${x}) + 0.5) / float(${f}TexShape[1]), 0.5);
        return sampleTexture(${f}, uv);
      }
    `:`
      float ${y}(int index) {
        vec2 uv = vec2((float(index + ${x}) + 0.5) / ${T}.0, 0.5);
        return sampleTexture(${f}, uv);
      }
    `:c?`
    float ${y}(int index) {
      vec2 uv = uvFromFlat(${f}TexShape[0], ${f}TexShape[1], index + ${x});
      return sampleTexture(${f}, uv);
    }
  `:`
    float ${y}(int index) {
      vec2 uv = uvFromFlat(${C}, ${T}, index + ${x});
      return sampleTexture(${f}, uv);
    }
  `}(l,i);case 2:return function(u,c){let f=u.shapeInfo.logicalShape,y=u.name,w="get"+y.charAt(0).toUpperCase()+y.slice(1),C=u.shapeInfo.texShape;if(C!=null&&m.util.arraysEqual(f,C)){if(c)return`
      float ${w}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${y}TexShape[1], ${y}TexShape[0]);
        return sampleTexture(${y}, uv);
      }
    `;let G=C[0];return`
    float ${w}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${C[1]}.0, ${G}.0);
      return sampleTexture(${y}, uv);
    }
  `}let{newShape:T,keptDims:x}=m.util.squeezeShape(f),A=T;if(A.length<f.length){let G=["row","col"];return`
      ${sb(gx(u,A),c)}
      float ${w}(int row, int col) {
        return ${w}(${ub(G,x)});
      }
    `}if(u.shapeInfo.isUniform)return`
      float ${w}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${f[1]}, 1)));
        ${Am(u)}
      }
    `;let M=C[0],$=C[1],V=Vg(y);return $===1?c?`
      float ${w}(int row, int col) {
        float index = dot(vec3(row, col, ${V}), vec3(${y}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${y}TexShape[0]));
        return sampleTexture(${y}, uv);
      }
    `:`
    float ${w}(int row, int col) {
      float index = dot(vec3(row, col, ${V}), vec3(${f[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${M}.0);
      return sampleTexture(${y}, uv);
    }
  `:M===1?c?`
      float ${w}(int row, int col) {
        float index = dot(vec3(row, col, ${V}), vec3(${y}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${y}TexShape[1]), 0.5);
        return sampleTexture(${y}, uv);
      }
    `:`
    float ${w}(int row, int col) {
      float index = dot(vec3(row, col, ${V}), vec3(${f[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${$}.0, 0.5);
      return sampleTexture(${y}, uv);
    }
  `:c?`
      float ${w}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${y}Shape[1] + col + ${V};
        vec2 uv = uvFromFlat(${y}TexShape[0], ${y}TexShape[1], index);
        return sampleTexture(${y}, uv);
      }
    `:`
  float ${w}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${f[1]} + col + ${V};
    vec2 uv = uvFromFlat(${M}, ${$}, index);
    return sampleTexture(${y}, uv);
  }
`}(l,i);case 3:return function(u,c){let f=u.shapeInfo.logicalShape,y=u.name,w="get"+y.charAt(0).toUpperCase()+y.slice(1),C=f[1]*f[2],T=f[2],{newShape:x,keptDims:A}=m.util.squeezeShape(f),M=x;if(M.length<f.length){let it=["row","col","depth"];return`
        ${sb(gx(u,M),c)}
        float ${w}(int row, int col, int depth) {
          return ${w}(${ub(it,A)});
        }
      `}if(u.shapeInfo.isUniform)return`
      float ${w}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${C}, ${T}, 1)));
        ${Am(u)}
      }
    `;let $=u.shapeInfo.texShape,V=$[0],G=$[1],Q=u.shapeInfo.flatOffset;if(G===C&&Q==null)return c?`
      float ${w}(int row, int col, int depth) {
        int stride1 = ${y}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}TexShape[1], ${y}TexShape[0]);
        return sampleTexture(${y}, uv);
      }
    `:`
        float ${w}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${T}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${G}.0, ${V}.0);
          return sampleTexture(${y}, uv);
        }
      `;if(G===T&&Q==null)return c?`
      float ${w}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${y}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${y}TexShape[1], ${y}TexShape[0]);
        return sampleTexture(${y}, uv);
      }
    `:`
    float ${w}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${f[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${G}.0, ${V}.0);
      return sampleTexture(${y}, uv);
    }
  `;let nt=Vg(y);return c?`
    float ${w}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${y}Shape[1] * ${y}Shape[2];
      int stride1 = ${y}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${nt};
      vec2 uv = uvFromFlat(${y}TexShape[0], ${y}TexShape[1], index);
      return sampleTexture(${y}, uv);
    }
    `:`
      float ${w}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${C} + col * ${T} + depth + ${nt};
        vec2 uv = uvFromFlat(${V}, ${G}, index);
        return sampleTexture(${y}, uv);
      }
  `}(l,i);case 4:return function(u,c){let f=u.shapeInfo.logicalShape,y=u.name,w="get"+y.charAt(0).toUpperCase()+y.slice(1),C=f[3],T=f[2]*C,x=f[1]*T,{newShape:A,keptDims:M}=m.util.squeezeShape(f);if(A.length<f.length){let Nt=["row","col","depth","depth2"];return`
      ${sb(gx(u,A),c)}
      float ${w}(int row, int col, int depth, int depth2) {
        return ${w}(${ub(Nt,M)});
      }
    `}if(u.shapeInfo.isUniform)return`
      float ${w}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${x}, ${T}, ${C}, 1)));
        ${Am(u)}
      }
    `;let $=u.shapeInfo.flatOffset,V=u.shapeInfo.texShape,G=V[0],Q=V[1],nt=`int stride2 = ${y}Shape[3];`,it=`int stride1 = ${y}Shape[2] * stride2;`,ht=`int stride0 = ${y}Shape[1] * stride1;`;if(Q===x&&$==null)return c?`
      float ${w}(int row, int col, int depth, int depth2) {
        ${nt}
        ${it}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}TexShape[1], ${y}TexShape[0]);
        return sampleTexture(${y}, uv);
      }
    `:`
      float ${w}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${T}, ${C}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${Q}.0, ${G}.0);
        return sampleTexture(${y}, uv);
      }
    `;if(Q===C&&$==null)return c?`
      float ${w}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${y}Shape[1] * ${y}Shape[2], ${y}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}TexShape[1], ${y}TexShape[0]);
        return sampleTexture(${y}, uv);
      }
    `:`
      float ${w}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${f[1]*f[2]}, ${f[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${Q}.0, ${G}.0);
        return sampleTexture(${y}, uv);
      }
    `;let kt=Vg(y);return c?`
    float ${w}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${nt}
      ${it}
      ${ht}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${y}TexShape[0], ${y}TexShape[1], index + ${kt});
      return sampleTexture(${y}, uv);
    }
  `:`
    float ${w}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${x} + col * ${T} +
          depth * ${C} + depth2;
      vec2 uv = uvFromFlat(${G}, ${Q}, index + ${kt});
      return sampleTexture(${y}, uv);
    }
  `}(l,i);case 5:return function(u){let c=u.shapeInfo.logicalShape,f=u.name,y="get"+f.charAt(0).toUpperCase()+f.slice(1),w=c[4],C=c[3]*w,T=c[2]*C,x=c[1]*T,{newShape:A,keptDims:M}=m.util.squeezeShape(c);if(A.length<c.length){let it=["row","col","depth","depth2","depth3"];return`
      ${sb(gx(u,A))}
      float ${y}(int row, int col, int depth, int depth2, int depth3) {
        return ${y}(${ub(it,M)});
      }
    `}if(u.shapeInfo.isUniform)return`
      float ${y}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${x}, ${T}, ${C}, ${w})) +
          depth3;
        ${Am(u)}
      }
    `;let $=u.shapeInfo.flatOffset,V=u.shapeInfo.texShape,G=V[0],Q=V[1];if(Q===x&&$==null)return`
      float ${y}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${T}, ${C}, ${w}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${Q}.0, ${G}.0);
        return sampleTexture(${f}, uv);
      }
    `;if(Q===w&&$==null)return`
      float ${y}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${c[1]*c[2]*c[3]},
               ${c[2]*c[3]}, ${c[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${Q}.0, ${G}.0);
        return sampleTexture(${f}, uv);
      }
    `;let nt=Vg(f);return`
    float ${y}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${x} + col * ${T} + depth * ${C} +
          depth2 * ${w} + depth3 + ${nt};
      vec2 uv = uvFromFlat(${G}, ${Q}, index);
      return sampleTexture(${f}, uv);
    }
  `}(l);case 6:return function(u){let c=u.shapeInfo.logicalShape,f=u.name,y="get"+f.charAt(0).toUpperCase()+f.slice(1),{newShape:w,keptDims:C}=m.util.squeezeShape(c);if(w.length<c.length){let ht=["row","col","depth","depth2","depth3","depth4"];return`
      ${sb(gx(u,w))}
      float ${y}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${y}(${ub(ht,C)});
      }
    `}let T=c[5],x=c[4]*T,A=c[3]*x,M=c[2]*A,$=c[1]*M;if(u.shapeInfo.isUniform)return`
      float ${y}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${$}, ${M}, ${A}, ${x})) +
          dot(
            vec2(depth3, depth4),
            vec2(${T}, 1)));
        ${Am(u)}
      }
    `;let V=u.shapeInfo.flatOffset,G=u.shapeInfo.texShape,Q=G[0],nt=G[1];if(nt===$&&V==null)return`
      float ${y}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${M}, ${A}, ${x}, ${T})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${nt}.0, ${Q}.0);
        return sampleTexture(${f}, uv);
      }
    `;if(nt===T&&V==null)return`
      float ${y}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${c[1]*c[2]*c[3]*c[4]},
               ${c[2]*c[3]*c[4]},
               ${c[3]*c[4]},
               ${c[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${nt}.0, ${Q}.0);
        return sampleTexture(${f}, uv);
      }
    `;let it=Vg(f);return`
    float ${y}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${$} + col * ${M} + depth * ${A} +
          depth2 * ${x} + depth3 * ${T} + depth4 + ${it};
      vec2 uv = uvFromFlat(${Q}, ${nt}, index);
      return sampleTexture(${f}, uv);
    }
  `}(l);default:throw new Error(`${o.length}-D input sampling is not yet supported`)}}function u_(l,i){switch(l.shapeInfo.logicalShape.length){case 0:return function(o){let u=o.name,c="get"+u.charAt(0).toUpperCase()+u.slice(1),f=Yc();return`
    vec4 ${c}() {
      return ${f.texture2D}(${u}, halfCR);
    }
  `}(l);case 1:return function(o,u){let c=o.name,f="get"+c.charAt(0).toUpperCase()+c.slice(1),y=o.shapeInfo.texShape,w=Yc();if(u)return`
    vec4 ${f}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${c}TexShape[0]) / 2.0), ceil(float(${c}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${w.texture2D}(${c}, uv);
    }
  `;let C=[Math.ceil(y[0]/2),Math.ceil(y[1]/2)];return`
    vec4 ${f}(int index) {
      vec2 uv = packedUVfrom1D(
        ${C[0]}, ${C[1]}, index);
      return ${w.texture2D}(${c}, uv);
    }
  `}(l,i);case 2:return function(o,u){let c=o.shapeInfo.logicalShape,f=o.name,y="get"+f.charAt(0).toUpperCase()+f.slice(1),w=o.shapeInfo.texShape,C=w[0],T=w[1],x=Yc();if(w!=null&&m.util.arraysEqual(c,w))return u?`
      vec4 ${y}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}TexShape[1], ${f}TexShape[0]);

        return ${x.texture2D}(${f}, uv);
      }
    `:`
      vec4 ${y}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${T}.0, ${C}.0);

        return ${x.texture2D}(${f}, uv);
      }
    `;if(u)return`
    vec4 ${y}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${f}TexShape[0]) / 2.0), ceil(float(${f}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${f}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${x.texture2D}(${f}, uv);
    }
  `;let A=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)],M=Math.ceil(c[1]/2);return`
    vec4 ${y}(int row, int col) {
      vec2 uv = packedUVfrom2D(${M}, ${A[0]}, ${A[1]}, row, col);
      return ${x.texture2D}(${f}, uv);
    }
  `}(l,i);case 3:return function(o,u){let c=o.shapeInfo.logicalShape,f=o.name,y="get"+f.charAt(0).toUpperCase()+f.slice(1),w=o.shapeInfo.texShape,C=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)];if(c[0]===1){let V=[1,2],G=["b","row","col"];return`
        ${u_(gx(o,c.slice(1)),u)}
        vec4 ${y}(int b, int row, int col) {
          return ${y}(${ub(G,V)});
        }
      `}let T=Yc();if(u)return`
    vec4 ${y}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${f}TexShape[0]) / 2.0), ceil(float(${f}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${f}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${f}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${T.texture2D}(${f}, uv);
    }
  `;let x=C[0],A=C[1],M=Math.ceil(c[2]/2),$=M*Math.ceil(c[1]/2);return`
    vec4 ${y}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${x}, ${A}, ${$}, ${M}, b, row, col);
      return ${T.texture2D}(${f}, uv);
    }
  `}(l,i);default:return function(o,u){let c=o.name,f="get"+c.charAt(0).toUpperCase()+c.slice(1),y=Yc();if(u)return`
    vec4 ${f}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${c}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${c}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${c}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${c}TexShape[0]) / 2.0), ceil(float(${c}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${y.texture2D}(${c}, uv);
    }
  `;let w=o.shapeInfo.logicalShape,C=w.length,T=o.shapeInfo.texShape,x=[Math.ceil(T[0]/2),Math.ceil(T[1]/2)],A=x[0],M=x[1],$=Math.ceil(w[C-1]/2),V=$*Math.ceil(w[C-2]/2),G="int b, int row, int col",Q=`b * ${V} + (row / 2) * ${$} + (col / 2)`;for(let nt=2;nt<C-1;nt++)G=`int b${nt}, `+G,V*=w[C-nt-1],Q=`b${nt} * ${V} + `+Q;return`
    vec4 ${f}(${G}) {
      int index = ${Q};
      int texR = index / ${M};
      int texC = index - texR * ${M};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${M}, ${A});
      return ${y.texture2D}(${c}, uv);
    }
  `}(l,i)}}let xX=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,sA=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,uA=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,lA=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function kX(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Vg(l){return`offset${l}`}function Am(l){let i=l.name,o=m.util.sizeFromShape(l.shapeInfo.logicalShape);return o<2?`return ${i};`:`
    for (int i = 0; i < ${o}; i++) {
      if (i == index) {
        return ${i}[i];
      }
    }
  `}function is(l){if(l<=1)return"int";if(l===2)return"ivec2";if(l===3)return"ivec3";if(l===4)return"ivec4";if(l===5)return"ivec5";if(l===6)return"ivec6";throw Error(`GPU for rank ${l} is not yet supported`)}function mx(l,i,o){let{newShape:u,keptDims:c}=m.util.squeezeShape(i),f=i.length,y=l&&f===3&&i[0]===1,w=y?i.slice(1):u,C=!l&&f>1&&!m.util.arraysEqual(i,o)&&u.length<f||y;return{useSqueezeShape:C,uniformShape:C?w:i,keptDims:c}}function gx(l,i){let o=JSON.parse(JSON.stringify(l));return o.shapeInfo.logicalShape=i,o}function ub(l,i){return i.map(o=>l[o]).join(", ")}function l_(l,i,o){let u=[],c=[],f,y,w,C=null,T=null;T=l.getUniformLocation(o,"NAN",!1),(0,m.env)().getNumber("WEBGL_VERSION")===1&&(C=l.getUniformLocation(o,"INFINITY",!1));let x=!1;for(let A of i.variableNames){let M={name:A,uniform:l.getUniformLocation(o,A,x),offset:l.getUniformLocation(o,`offset${A}`,x)};i.enableShapeUniforms&&(M.shape=l.getUniformLocation(o,`${A}Shape`,x),M.texShape=l.getUniformLocation(o,`${A}TexShape`,x)),u.push(M)}if(i.enableShapeUniforms&&(f=l.getUniformLocation(o,"outShape",x),w=l.getUniformLocation(o,"outShapeStrides",x),y=l.getUniformLocation(o,"outTexShape",x)),i.customUniforms)for(let A of i.customUniforms)c.push(l.getUniformLocation(o,A.name,x));return{variablesLocations:u,customUniformLocations:c,infLoc:C,nanLoc:T,outShapeLocation:f,outShapeStridesLocation:w,outTexShapeLocation:y}}function EL(l,i){if(l.length!==i.length)throw Error(`Binary was compiled with ${l.length} inputs, but was executed with ${i.length} inputs`);l.forEach((o,u)=>{let c=o.logicalShape,f=i[u],y=f.shape;if(!m.util.arraysEqual(c,y))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${c} and ${y} must match`);if(o.isUniform&&f.isUniform)return;let w=o.texShape,C=f.isUniform?null:f.texData.texShape;if(!m.util.arraysEqual(w,C))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${w} and ${C} must match`)})}function pc(l){return(0,m.env)().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&l<=4}class pht{constructor(i){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=hx.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let o=Yc();this.outputShape=i,this.enableShapeUniforms=pc(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?ob(["r","c","d"],i):Wg(["r","c","d"],i)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${o.output} = result;
      }
    `}}class TL{constructor(i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=hx.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let o=Yc();this.outputShape=i,this.enableShapeUniforms=pc(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?ob(["r","c","d"],i):Wg(["r","c","d"],i)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${o.output} = result;
      }
    `}}class mht{constructor(i){this.variableNames=["A"],this.outTexUsage=Hc.DOWNLOAD;let o=Yc();this.outputShape=i,this.userCode=`
      ${aA}

      void main() {
        float x = getAAtOutCoords();
        ${o.output} = encode_float(x);
      }
    `}}class AL{constructor(i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Hc.DOWNLOAD;let o=Yc();this.outputShape=i,this.userCode=`
      ${aA}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${o.output} = encode_float(x);
      }
    `}}let SX={R:0,G:1,B:2,A:3};class cA{constructor(i,o=!1,u="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let c=Yc();this.outputShape=i,this.enableShapeUniforms=pc(this.outputShape.length);let f="result";o&&(f="floor(result * 255. + 0.5)");let y="";for(let w=0;w<u.length;w++){let C=u[w];y+=`
          if(offset == ${w}) {
            result = values[${SX[C]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`:iA(i)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${u.length});

        flatIndex = idiv(flatIndex, ${u.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${c.texture2D}(A, uv);
          ${y}
        }
        ${c.output} = vec4(${f}, 0., 0., 0.);
      }
    `}}class IL{constructor(i,o=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let u=Yc();this.outputShape=i,this.enableShapeUniforms=pc(this.outputShape.length);let c="",f="result";o&&(f="floor(result * 255. + 0.5)");for(let y=0;y<=1;y++)for(let w=0;w<=1;w++){let C=2*y+w;c+=`
          localCoords = coords;
          if(localCoords[2] + ${w} < ${this.enableShapeUniforms?"outShape[2]":`${i[2]}`}) {
          localCoords[2] += ${w};
          if (localCoords[1] + ${y} < ${this.enableShapeUniforms?"outShape[1]":`${i[1]}`}) {
            localCoords[1] += ${y};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${u.texture2D}(A, uv);

            if (offset == 0) {
              result[${C}] = values[0];
            } else if (offset == 1) {
              result[${C}] = values[1];
            } else if (offset == 2) {
              result[${C}] = values[2];
            } else {
              result[${C}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`:iA(i)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${c}

          ${u.output} = ${f};
        }
    `}}function hA(l){let i=Yc();return mX(l,`${i.version}
    precision highp float;
    ${i.attribute} vec3 clipSpacePos;
    ${i.attribute} vec2 uv;
    ${i.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function NL(l){return vL(l,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function dA(l){return pp(l,new Uint16Array([0,1,2,2,1,3]))}function yx(l,i,o,u,c,f){bL(i,o);let y=e_(l),w=l.TEXTURE_2D;return ti(l,()=>l.bindTexture(w,y)),ti(l,()=>l.texParameteri(w,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE)),ti(l,()=>l.texParameteri(w,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE)),ti(l,()=>l.texParameteri(w,l.TEXTURE_MIN_FILTER,l.NEAREST)),ti(l,()=>l.texParameteri(w,l.TEXTURE_MAG_FILTER,l.NEAREST)),(0,m.env)().getNumber("WEBGL_VERSION")===1?ti(l,()=>l.texImage2D(w,0,u,i,o,0,c,f,null)):ti(l,()=>l.texStorage2D(w,1,u,i,o)),ti(l,()=>l.bindTexture(l.TEXTURE_2D,null)),{texture:y,texShape:[o,i]}}function ML(l){return l.internalFormatFloat}function DL(l,i,o,u){let[c,f]=JS(i,o);return yx(l,c,f,ML(u),u.textureFormatFloat,l.FLOAT)}function fA(l){return l.internalFormatHalfFloat}function RL(l,i,o,u){let[c,f]=JS(i,o);return yx(l,c,f,fA(u),u.textureFormatFloat,u.textureTypeHalfFloat)}function pA(l){return l.downloadTextureFormat}function FL(l,i,o,u){let[c,f]=JS(i,o);return yx(l,c,f,pA(u),l.RGBA,l.UNSIGNED_BYTE)}function mA(l){return l.internalFormatPackedFloat}function OL(l,i,o,u){let[c,f]=z2(i,o);return yx(l,c,f,mA(u),l.RGBA,l.FLOAT)}function gA(l){return l.internalFormatPackedHalfFloat}function _X(l,i,o,u){let[c,f]=z2(i,o);return yx(l,c,f,gA(u),l.RGBA,u.textureTypeHalfFloat)}function LL(l,i,o){return ti(l,()=>l.bindBuffer(l.ARRAY_BUFFER,o)),ZT(l,i,"clipSpacePos",o,3,20,0)&&ZT(l,i,"uv",o,2,20,12)}function c_(l,i,o,u,c,f){let y,w,C;ti(l,()=>l.bindTexture(l.TEXTURE_2D,i)),c instanceof Uint8Array?(y=new Uint8Array(o*u*4),w=l.UNSIGNED_BYTE,C=l.RGBA):(y=new Float32Array(o*u*4),w=l.FLOAT,C=f.internalFormatPackedFloat),y.set(c),(0,m.env)().getNumber("WEBGL_VERSION")===2?ti(l,()=>l.texSubImage2D(l.TEXTURE_2D,0,0,0,o,u,l.RGBA,w,y)):ti(l,()=>l.texImage2D(l.TEXTURE_2D,0,C,o,u,0,l.RGBA,w,y)),ti(l,()=>l.bindTexture(l.TEXTURE_2D,null))}function h_(l,i,o){ti(l,()=>l.bindTexture(l.TEXTURE_2D,i)),o.data instanceof Uint8Array?(0,m.env)().getNumber("WEBGL_VERSION")===2?ti(l,()=>l.texSubImage2D(l.TEXTURE_2D,0,0,0,o.width,o.height,l.RGBA,l.UNSIGNED_BYTE,o.data)):ti(l,()=>l.texImage2D(l.TEXTURE_2D,0,l.RGBA,o.width,o.height,0,l.RGBA,l.UNSIGNED_BYTE,o.data)):(0,m.env)().getNumber("WEBGL_VERSION")===2?ti(l,()=>l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,o)):ti(l,()=>l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,o)),ti(l,()=>l.bindTexture(l.TEXTURE_2D,null))}function $L(l,i,o,u){let c=l.createBuffer();ti(l,()=>l.bindBuffer(l.PIXEL_PACK_BUFFER,c));let f=16*i*o;return ti(l,()=>l.bufferData(l.PIXEL_PACK_BUFFER,f,l.STREAM_READ)),ti(l,()=>l.readPixels(0,0,o,i,l.RGBA,l.FLOAT,0)),ti(l,()=>l.bindBuffer(l.PIXEL_PACK_BUFFER,null)),c}function zL(l,i,o){let u=l,c=new Float32Array(o);return u.bindBuffer(u.PIXEL_PACK_BUFFER,i),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function Ml(l,i,o,u){let[c,f]=JS(i,o),y=new Uint8Array(i*o*4);return ti(l,()=>l.readPixels(0,0,c,f,u.downloadTextureFormat,l.UNSIGNED_BYTE,y)),new Float32Array(y.buffer)}function PL(l,i,o,u,c,f,y,w){let C=l,T=new Float32Array(function(x,A){let[M,$]=z2(x,A);return M*$*4}(f,y));return C.bindBuffer(C.PIXEL_PACK_BUFFER,i),C.getBufferSubData(C.PIXEL_PACK_BUFFER,0,T),C.bindBuffer(C.PIXEL_PACK_BUFFER,null),T}function BL(l,i,o){let u=new Float32Array(i*o*4);return ti(l,()=>l.readPixels(0,0,o,i,l.RGBA,l.FLOAT,u)),u}class yA{constructor(i){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let o=(0,m.env)().getNumber("WEBGL_VERSION");if(i!=null?(this.gl=i,dX(o,i)):this.gl=fp(o),i=this.gl,(0,m.env)().getNumber("WEBGL_VERSION")===2){let f=i;this.createVertexArray=()=>ti(f,()=>f.createVertexArray()),this.bindVertexArray=y=>ti(f,()=>f.bindVertexArray(y)),this.deleteVertexArray=y=>ti(f,()=>f.deleteVertexArray(y)),this.getVertexArray=()=>ti(f,()=>f.getParameter(f.VERTEX_ARRAY_BINDING))}else if(i!=null){let f=i.getExtension("OES_vertex_array_object");if(f==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>ti(i,()=>f.createVertexArrayOES()),this.bindVertexArray=y=>ti(i,()=>f.bindVertexArrayOES(y)),this.deleteVertexArray=y=>ti(i,()=>f.deleteVertexArrayOES(y)),this.getVertexArray=()=>ti(i,()=>i.getParameter(f.VERTEX_ARRAY_BINDING_OES))}let u="WEBGL_color_buffer_float",c="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),(0,m.env)().getNumber("WEBGL_VERSION")===1){let f="OES_texture_float",y="OES_texture_half_float";if(this.textureFloatExtension=P2(this.gl,f),zu(this.gl,y))this.textureHalfFloatExtension=P2(this.gl,y);else if((0,m.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(u),zu(this.gl,c))this.colorBufferHalfFloatExtension=P2(this.gl,c);else if((0,m.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(u="EXT_color_buffer_float",zu(this.gl,u))this.colorBufferFloatExtension=this.gl.getExtension(u);else{if(!zu(this.gl,c))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(c)}this.vertexBuffer=NL(this.gl),this.indexBuffer=dA(this.gl),this.framebuffer=KT(this.gl),this.textureConfig=t_(this.gl,this.textureHalfFloatExtension)}get debug(){return(0,m.env)().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let i=this.gl;ti(i,()=>i.finish()),ti(i,()=>i.bindFramebuffer(i.FRAMEBUFFER,null)),ti(i,()=>i.deleteFramebuffer(this.framebuffer)),ti(i,()=>i.bindBuffer(i.ARRAY_BUFFER,null)),ti(i,()=>i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,null)),ti(i,()=>i.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(i,o){return this.throwIfDisposed(),DL(this.gl,i,o,this.textureConfig)}createFloat16MatrixTexture(i,o){return this.throwIfDisposed(),RL(this.gl,i,o,this.textureConfig)}createUnsignedBytesMatrixTexture(i,o){return this.throwIfDisposed(),FL(this.gl,i,o,this.textureConfig)}uploadPixelDataToTexture(i,o){this.throwIfDisposed(),h_(this.gl,i,o)}uploadDenseMatrixToTexture(i,o,u,c){this.throwIfDisposed(),c_(this.gl,i,o,u,c,this.textureConfig)}createFloat16PackedMatrixTexture(i,o){return this.throwIfDisposed(),_X(this.gl,i,o,this.textureConfig)}createPackedMatrixTexture(i,o){return this.throwIfDisposed(),OL(this.gl,i,o,this.textureConfig)}deleteMatrixTexture(i){this.throwIfDisposed(),this.outputTexture===i&&(n_(this.gl,this.framebuffer),this.outputTexture=null),ti(this.gl,()=>this.gl.deleteTexture(i))}downloadByteEncodedFloatMatrixFromOutputTexture(i,o,u){return this.downloadMatrixDriver(i,()=>Ml(this.gl,o,u,this.textureConfig))}downloadPackedMatrixFromBuffer(i,o,u,c,f,y){return PL(this.gl,i,0,0,0,f,y)}downloadFloat32MatrixFromBuffer(i,o){return zL(this.gl,i,o)}createBufferFromTexture(i,o,u){this.bindTextureToFrameBuffer(i);let c=$L(this.gl,o,u);return this.unbindTextureToFrameBuffer(),c}createAndWaitForFence(){let i=this.createFence(this.gl);return this.pollFence(i)}createFence(i){let o,u;if((0,m.env)().getBool("WEBGL_FENCE_API_ENABLED")){let c=i,f=c.fenceSync(c.SYNC_GPU_COMMANDS_COMPLETE,0);i.flush(),u=()=>{let y=c.clientWaitSync(f,0,0);return y===c.ALREADY_SIGNALED||y===c.CONDITION_SATISFIED},o=f}else(0,m.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(o=this.beginQuery(),this.endQuery(),u=()=>this.isQueryAvailable(o,(0,m.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):u=()=>!0;return{query:o,isFencePassed:u}}downloadMatrixFromPackedTexture(i,o,u){return this.downloadMatrixDriver(i,()=>BL(this.gl,o,u))}createProgram(i){this.throwIfDisposed();let o=this.gl;this.vertexShader==null&&(this.vertexShader=hA(o));let u=gX(o);ti(o,()=>o.attachShader(u,this.vertexShader)),ti(o,()=>o.attachShader(u,i)),yX(o,u);let c=Object.assign(u,{vao:this.createVertexArray()});return this.debug&&XT(o,c),c}buildVao(i){this.setProgram(i),this.bindVertexArray(i.vao);let o=this.gl;ti(o,()=>o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),LL(o,i,this.vertexBuffer)}deleteProgram(i){this.throwIfDisposed(),i===this.program&&(this.program=null),i!=null&&(ti(this.gl,()=>this.gl.deleteProgram(i)),this.deleteVertexArray(i.vao))}setProgram(i){this.throwIfDisposed(),this.program=i,this.program!=null&&this.debug&&XT(this.gl,this.program),ti(this.gl,()=>this.gl.useProgram(i))}getUniformLocation(i,o,u=!0){return this.throwIfDisposed(),u?dx(this.gl,i,o):wL(this.gl,i,o)}getAttributeLocation(i,o){return this.throwIfDisposed(),ti(this.gl,()=>this.gl.getAttribLocation(i,o))}getUniformLocationNoThrow(i,o){return this.throwIfDisposed(),this.gl.getUniformLocation(i,o)}setInputMatrixTexture(i,o,u){this.throwIfDisposed(),this.throwIfNoProgram(),Ug(this.gl,i,o,u)}setOutputMatrixTexture(i,o,u){this.setOutputMatrixTextureDriver(i,u,o)}setOutputPackedMatrixTexture(i,o,u){this.throwIfDisposed();let[c,f]=z2(o,u);this.setOutputMatrixTextureDriver(i,c,f)}setOutputMatrixWriteRegion(i,o,u,c){this.setOutputMatrixWriteRegionDriver(u,i,c,o)}setOutputPackedMatrixWriteRegion(i,o,u,c){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&XT(this.gl,this.program),r_(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let i=this.gl;if(this.debug){let o=this.getVertexArray();console.assert(o===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}ti(i,()=>i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),ti(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=P2(this.gl,(0,m.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if((0,m.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let u=this.gl,c=this.getQueryTimerExtensionWebGL2(),f=u.createQuery();return u.beginQuery(c.TIME_ELAPSED_EXT,f),f}let i=this.getQueryTimerExtensionWebGL1(),o=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,o),o}endQuery(){if((0,m.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let o=this.gl,u=this.getQueryTimerExtensionWebGL2();return void o.endQuery(u.TIME_ELAPSED_EXT)}let i=this.getQueryTimerExtensionWebGL1();i.endQueryEXT(i.TIME_ELAPSED_EXT)}waitForQueryAndGetTime(i){return ce(this,null,function*(){return yield m.util.repeatedTry(()=>this.disposed||this.isQueryAvailable(i,(0,m.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(i,(0,m.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})}getQueryTime(i,o){if(o===0)return null;if(o===2){let u=this.gl;return u.getQueryParameter(i,u.QUERY_RESULT)/1e6}{let u=this.getQueryTimerExtensionWebGL1();return u.getQueryObjectEXT(i,u.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(i,o){if(o===0)return!0;if(o===2){let u=this.gl,c=this.getQueryTimerExtensionWebGL2(),f=u.getQueryParameter(i,u.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(c.GPU_DISJOINT_EXT)),f&&!this.disjoint}{let u=this.getQueryTimerExtensionWebGL1(),c=u.getQueryObjectEXT(i,u.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(u.GPU_DISJOINT_EXT)),c&&!this.disjoint}}pollFence(i){return new Promise(o=>{this.addItemToPoll(()=>i.isFencePassed(),()=>o())})}pollItems(){let i=function(o){let u=0;for(;u<o.length&&o[u]();++u);return u-1}(this.itemsToPoll.map(o=>o.isDoneFn));for(let o=0;o<=i;++o){let{resolveFn:u}=this.itemsToPoll[o];u()}this.itemsToPoll=this.itemsToPoll.slice(i+1)}addItemToPoll(i,o){if(this.itemsToPoll.push({isDoneFn:i,resolveFn:o}),this.itemsToPoll.length>1)return;let u;"setTimeoutCustom"in(0,m.env)().platform&&(u=(0,m.env)().platform.setTimeoutCustom.bind((0,m.env)().platform)),m.util.repeatedTry(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,u)}bindTextureToFrameBuffer(i){this.throwIfDisposed(),fx(this.gl,i,this.framebuffer),this.debug&&r_(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(fx(this.gl,this.outputTexture,this.framebuffer),this.debug&&r_(this.gl)):n_(this.gl,this.framebuffer)}downloadMatrixDriver(i,o){this.bindTextureToFrameBuffer(i);let u=o();return this.unbindTextureToFrameBuffer(),u}setOutputMatrixTextureDriver(i,o,u){this.throwIfDisposed();let c=this.gl;fx(c,i,this.framebuffer),this.debug&&r_(c),this.outputTexture=i,ti(c,()=>c.viewport(0,0,o,u)),ti(c,()=>c.scissor(0,0,o,u))}setOutputMatrixWriteRegionDriver(i,o,u,c){this.throwIfDisposed(),ti(this.gl,()=>this.gl.scissor(i,o,u,c))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}let{addImpl:ght,bincountImpl:jL,bincountReduceImpl:Gg,bitwiseAndImpl:wh,castImpl:yht,ceilImpl:d_,concatImpl:vA,equalImpl:B2,expImpl:ed,expm1Impl:CX,floorImpl:UL,gatherNdImpl:EX,gatherV2Impl:TX,greaterImpl:vht,greaterEqualImpl:bht,lessImpl:lb,lessEqualImpl:cb,linSpaceImpl:WL,logImpl:AX,maxImpl:IX,maximumImpl:NX,minimumImpl:VL,multiplyImpl:vx,negImpl:k0,notEqualImpl:S0,prodImpl:j2,raggedGatherImpl:GL,raggedRangeImpl:HL,raggedTensorToTensorImpl:nd,rangeImpl:bA,rsqrtImpl:YL,scatterImpl:qL,sigmoidImpl:wht,simpleAbsImpl:MX,sliceImpl:XL,sparseFillEmptyRowsImpl:DX,sparseReshapeImpl:RX,sparseSegmentReductionImpl:KL,sqrtImpl:FX,staticRegexReplaceImpl:OX,stridedSliceImpl:LX,stringNGramsImpl:xht,stringSplitImpl:$X,stringToHashBucketFastImpl:zX,subImpl:PX,tileImpl:ZL,topKImpl:wA,transposeImpl:f_,uniqueImpl:QL}=Qt;function Hg(l,i){return["x","y","z","w","u","v"].slice(0,i).map(o=>`${l}.${o}`)}function Pu(l,i){return i===1?[l]:Hg(l,i)}class BX{constructor(i){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=i,this.rank=i.length,this.enableShapeUniforms=pc(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{let o=Pu("rc",this.rank),u=is(this.rank),c=this.getOutOfBoundsCondition(o),f=this.getSetup(o),y=this.getOutput(o);this.userCode=`
        void main() {
          ${u} rc = getOutputCoords();

          if(${c}) {
            setOutput(vec4(0));
          } else {
            ${f}

            setOutput(vec4(${y}));
          }
        }
      `}}getSourceCoordsArr(i){let o=[];for(let u=0;u<=1;u++)for(let c=0;c<=1;c++){let f=`${u===0?"r":"rp1"}, ${c===0?"c":"cp1"}`;for(let y=2;y<this.rank;y++)f=`${i[i.length-1-y]},`+f;o.push(f)}return o}getOutOfBoundsCondition(i){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let o="";for(let u=this.rank-2;u<this.rank;u++)o+=`${i[u]} >= ${this.enableShapeUniforms?`outShape[${u}]`:this.outputShape[u]}`,u<this.rank-1&&(o+="||");return o}getSetup(i){if(this.rank===1)return"";let o=i.slice(-2),u=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],c=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${o[0]};
      int c = ${o[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${u};
      bool rEdge = rp1 >= ${c};
    `}getOutput(i){let o=this.getSourceCoordsArr(i);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${o[0]}),
            cEdge ? 0. : getA(${o[1]}),
            rEdge ? 0. : getA(${o[2]}),
            rEdge || cEdge ? 0. : getA(${o[3]})`}}class p_{constructor(i,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=i,this.enableShapeUniforms=pc(this.outputShape.length);let u="";for(let y=0;y<4;y++){let w="thisRC = rc;";y%2==1&&(w+="thisRC.z += 1;"),y>1&&(w+="thisRC.y += 1;"),u+=`
        ${w}
        ${y>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${y}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${y>0?"}":""}
      `}var c,f;this.userCode=`
      ${c=o,f=this.enableShapeUniforms,`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${f?rA(["r","c","d"],"inputShape"):Wg(["r","c","d"],c)}
      return ivec3(r, c, d);
    }
  `}
      ${this.enableShapeUniforms?`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`:iA(i)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":i[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":i[2]};

        ${u}

        setOutput(result);
      }
    `}}class jX{constructor(i){this.gpgpu=i,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(i,o,u){let c=JL(o,u),f=t$(i,c,u);f in this.freeTextures||(this.freeTextures[f]=[]),f in this.usedTextures||(this.usedTextures[f]=[]);let y=xA(i,c,this.gpgpu.gl,this.gpgpu.textureConfig,u);if(this.freeTextures[f].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=y,this.log();let C=this.freeTextures[f].pop();return this.usedTextures[f].push(C),C}let w;return c===fc.PACKED_2X2_FLOAT32?w=this.gpgpu.createPackedMatrixTexture(i[0],i[1]):c===fc.PACKED_2X2_FLOAT16?w=this.gpgpu.createFloat16PackedMatrixTexture(i[0],i[1]):c===fc.UNPACKED_FLOAT32?w=this.gpgpu.createFloat32MatrixTexture(i[0],i[1]):c===fc.UNPACKED_FLOAT16?w=this.gpgpu.createFloat16MatrixTexture(i[0],i[1]):c===fc.PACKED_4X1_UNSIGNED_BYTE&&(w=this.gpgpu.createUnsignedBytesMatrixTexture(i[0],i[1])),this.usedTextures[f].push(w),this.numUsedTextures++,this._numBytesAllocated+=y,this.log(),w}releaseTexture(i,o,u,c){if(this.freeTextures==null)return;let f=JL(u,c),y=t$(o,f,c);y in this.freeTextures||(this.freeTextures[y]=[]);let w=xA(o,f,this.gpgpu.gl,this.gpgpu.textureConfig,c),C=(0,m.env)().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");C!==-1&&this._numBytesAllocated>C?(this.gpgpu.deleteMatrixTexture(i.texture),this._numBytesAllocated-=w):(this.freeTextures[y].push(i),this.numFreeTextures++,this._numBytesFree+=w),this.numUsedTextures--;let T=this.usedTextures[y],x=T&&T.indexOf(i);if(x==null||x<0)throw new Error("Cannot release a texture that was never provided by this texture manager");T[x]=T[T.length-1],T.pop(),this.log()}log(){if(!this.logEnabled)return;let i=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${i})`);let o=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*o)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(let i in this.freeTextures)this.freeTextures[i].forEach(o=>{this.gpgpu.deleteMatrixTexture(o.texture)});for(let i in this.usedTextures)this.usedTextures[i].forEach(o=>{this.gpgpu.deleteMatrixTexture(o.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function xA(l,i,o,u,c){let f=function(C,T){switch(C){case fc.PACKED_2X2_FLOAT32:return mA(T);case fc.PACKED_2X2_FLOAT16:return gA(T);case fc.UNPACKED_FLOAT32:return ML(T);case fc.UNPACKED_FLOAT16:return fA(T);case fc.PACKED_4X1_UNSIGNED_BYTE:return pA(T);default:throw new Error(`Unknown physical texture type ${C}`)}}(i,u),y;if(c){let[C,T]=z2(l[0],l[1]);y=C*T}else{let[C,T]=JS(l[0],l[1]);y=C*T}let w=function(C,T){let x=C;if(T===x.R32F)return 4;if(T===x.R16F)return 2;if(T===x.RGBA32F||T===C.RGBA)return 16;if(T===x.RGBA16F)return 8;if(T===x.RGBA8)return 4;throw new Error(`Unknown internal format ${T}`)}(o,f);return y*w}function JL(l,i){if(l===Hc.UPLOAD)return fc.PACKED_2X2_FLOAT32;if(l===Hc.RENDER||l==null)return function(o){return(0,m.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?o?fc.PACKED_2X2_FLOAT32:fc.UNPACKED_FLOAT32:o?fc.PACKED_2X2_FLOAT16:fc.UNPACKED_FLOAT16}(i);if(l===Hc.DOWNLOAD||l===Hc.PIXELS)return fc.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${l}`)}function t$(l,i,o){return`${l[0]}_${l[1]}_${i}_${o}`}class _0{constructor(i,o){this.variableNames=["A"],this.outputShape=i,this.enableShapeUniforms=pc(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${o}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}let Sf="if (isnan(x)) return x;",e$="return abs(x);",kht=Sf+`
  return (x < 0.0) ? 0.0 : x;
`,UX=Sf+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Yg="return x;";class qg{constructor(i,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i,this.enableShapeUniforms=pc(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${o}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}class xh{constructor(i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=i,this.enableShapeUniforms=pc(this.outputShape.length);let o=i.length,u=Pu("rc",o),c=is(o),f=function(C,T){if(C===1)return"rc";let x="";for(let A=0;A<C;A++)x+=T[A],A<C-1&&(x+=",");return x}(o,u),y=u.slice(-2),w=o<=1?"rc":`vec2(${y.join(",")})`;this.userCode=`
      void main() {
        ${c} rc = getOutputCoords();
        vec4 packedInput = getA(${f});

        setOutput(getChannel(packedInput, ${w}));
      }
    `}}let bx=m.kernel_impls.whereImpl,n$={},Sht=(0,m.env)().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),m_=(()=>{class l extends m.KernelBackend{nextDataId(){return l.nextDataId++}constructor(o){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!(0,m.env)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let u;if(o!=null){if(o instanceof yA)u=o;else{let f=fp((0,m.env)().getNumber("WEBGL_VERSION"),o);u=new yA(f)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{let f=fp((0,m.env)().getNumber("WEBGL_VERSION"));u=new yA(f),this.binaryCache=((c=(0,m.env)().getNumber("WEBGL_VERSION"))in n$||(n$[c]={}),n$[c]),this.gpgpuCreatedLocally=!0}var c;this.gpgpu=u,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new jX(this.gpgpu),this.numMBBeforeWarning=(0,m.env)().global.screen==null?1024:(0,m.env)().global.screen.height*(0,m.env)().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new m.DataStorage(this,(0,m.engine)())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(o,u,c,f,y,w){let C=this.makeTensorInfo(u,c),T=this.texData.get(C.dataId);T.isPacked=!1,T.texture={texture:o,texShape:[f,y]},T.texShape=[f,y];let x=bh(u),A=new cA(x,!1,w),M=this.runWebGLProgram(A,[C],c,[[f,y]]);return M.shape=u,T.texture=null,this.disposeIntermediateTensorInfo(C),M.dataId}write(o,u,c){if(((0,m.env)().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||(0,m.env)().getBool("DEBUG"))&&this.checkNumericalProblems(o),c==="complex64"&&o!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let f={id:this.nextDataId()};return this.texData.set(f,{shape:u,dtype:c,values:o,usage:Hc.UPLOAD,refCount:1}),f}refCount(o){return this.texData.has(o)?this.texData.get(o).refCount:0}incRef(o){this.texData.get(o).refCount++}decRef(o){this.texData.has(o)&&this.texData.get(o).refCount--}move(o,u,c,f,y){if((0,m.env)().getBool("DEBUG")&&this.checkNumericalProblems(u),f==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(o,{shape:c,dtype:f,values:u,usage:Hc.UPLOAD,refCount:y})}disposeIntermediateTensorInfo(o){this.disposeData(o.dataId)}readSync(o){let u=this.texData.get(o),{values:c,dtype:f,complexTensorInfos:y,slice:w,shape:C,isPacked:T}=u;if(w!=null){let $;$=T?new qg(C,Yg):new _0(C,Yg);let V=this.runWebGLProgram($,[{dataId:o,shape:C,dtype:f}],f),G=this.readSync(V.dataId);return this.disposeIntermediateTensorInfo(V),G}if(c!=null)return this.convertAndCacheOnCPU(o);if(f==="string")return c;let x=this.activeTimers!=null,A,M;if(x&&(A=m.util.now()),f==="complex64"){let $=this.readSync(y.real.dataId),V=this.readSync(y.imag.dataId);M=m.backend_util.mergeRealAndImagArrays($,V)}else M=this.getValuesFromTexture(o);return x&&(this.downloadWaitMs+=m.util.now()-A),this.convertAndCacheOnCPU(o,M)}read(o){return ce(this,null,function*(){if(this.pendingRead.has(o)){let G=this.pendingRead.get(o);return new Promise(Q=>G.push(Q))}let u=this.texData.get(o),{values:c,shape:f,slice:y,dtype:w,complexTensorInfos:C,isPacked:T}=u;if(y!=null){let G;G=T?new qg(f,Yg):new _0(f,Yg);let Q=this.runWebGLProgram(G,[{dataId:o,shape:f,dtype:w}],w),nt=this.read(Q.dataId);return this.disposeIntermediateTensorInfo(Q),nt}if(c!=null)return this.convertAndCacheOnCPU(o);if((0,m.env)().getBool("DEBUG")&&!(0,m.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&(0,m.env)().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let x,A,M=null;if(w!=="complex64"&&(0,m.env)().get("WEBGL_BUFFER_SUPPORTED")){x=this.decode(o);let G=this.texData.get(x.dataId);M=this.gpgpu.createBufferFromTexture(G.texture.texture,...$2(f))}if(this.pendingRead.set(o,[]),w!=="complex64"&&(yield this.gpgpu.createAndWaitForFence()),w==="complex64"){let G=yield Promise.all([this.read(C.real.dataId),this.read(C.imag.dataId)]),Q=G[0],nt=G[1];A=m.backend_util.mergeRealAndImagArrays(Q,nt)}else if(M==null)A=this.getValuesFromTexture(o);else{let G=m.util.sizeFromShape(f);A=this.gpgpu.downloadFloat32MatrixFromBuffer(M,G)}if(x!=null&&this.disposeIntermediateTensorInfo(x),M!=null){let G=this.gpgpu.gl;ti(G,()=>G.deleteBuffer(M))}let $=this.convertAndCacheOnCPU(o,A),V=this.pendingRead.get(o);return this.pendingRead.delete(o),V.forEach(G=>G($)),this.pendingDisposal.has(o)&&(this.pendingDisposal.delete(o),this.disposeData(o)&&(0,m.engine)().removeDataId(o,this),this.pendingDeletes--),$})}readToGPU(o,u={}){let c=this.texData.get(o),{values:f,shape:y,slice:w,dtype:C,isPacked:T,texture:x}=c;if(C==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(w!=null){let V;V=T?new qg(y,Yg):new _0(y,Yg);let G=this.runWebGLProgram(V,[{dataId:o,shape:y,dtype:C}],C),Q=this.readToGPU(G,u);return this.disposeIntermediateTensorInfo(G),Q}if(x==null)throw f!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");let A=this.decode(o,u.customTexShape),M=(0,m.engine)().makeTensorFromTensorInfo(A),$=this.texData.get(A.dataId);return Object.assign({tensorRef:M},$.texture)}bufferSync(o){let u=this.readSync(o.dataId);if(o.dtype==="string")try{let c=u.map(f=>m.util.decodeString(f));return(0,m.buffer)(o.shape,o.dtype,c)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return(0,m.buffer)(o.shape,o.dtype,u)}checkNumericalProblems(o){if(o!=null)for(let u=0;u<o.length;u++){let c=o[u];if(!fX(c))throw(0,m.env)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${c} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${c} cannot be represented on this device.`)}}getValuesFromTexture(o){let{shape:u,dtype:c,isPacked:f}=this.texData.get(o),y=m.util.sizeFromShape(u);if((0,m.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let $=this.decode(o),V=this.texData.get($.dataId),G=this.gpgpu.downloadMatrixFromPackedTexture(V.texture.texture,...$2(u)).subarray(0,y);return this.disposeIntermediateTensorInfo($),G}let w=(0,m.env)().getBool("WEBGL_PACK")&&f===!0,C=w?bh(u):u,T=w?new AL(C):new mht(C),x=this.runWebGLProgram(T,[{shape:C,dtype:c,dataId:o}],"float32"),A=this.texData.get(x.dataId),M=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(A.texture.texture,A.texShape[0],A.texShape[1]).subarray(0,y);return this.disposeIntermediateTensorInfo(x),M}timerAvailable(){return(0,m.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(o){let u=this.activeTimers,c=[],f=!1;this.programTimersStack==null?(this.programTimersStack=c,f=!0):this.activeTimers.push(c),this.activeTimers=c,o();let y=m.util.flatten(this.activeTimers.map(T=>T.query)).filter(T=>T!=null),w=m.util.flatten(this.activeTimers.map(T=>T.name)).filter(T=>T!=null);this.activeTimers=u,f&&(this.programTimersStack=null);let C={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return ce(this,null,function*(){if((0,m.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let T=yield Promise.all(y);C.kernelMs=m.util.sum(T),C.getExtraProfileInfo=()=>T.map((x,A)=>({name:w[A],ms:x})).map(x=>`${x.name}: ${x.ms}`).join(", ")}else C.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,C})}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return(0,m.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:m.util.now(),endMs:null}}endTimer(o){return(0,m.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),o):(o.endMs=m.util.now(),o)}getQueryTime(o){return ce(this,null,function*(){if((0,m.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(o);let u=o;return u.endMs-u.startMs})}disposeData(o,u=!1){if(this.pendingDisposal.has(o))return!1;if(!this.texData.has(o))return!0;if(u?this.texData.get(o).refCount=0:this.texData.get(o).refCount--,!u&&this.texData.get(o).refCount>0)return!1;if(this.pendingRead.has(o))return this.pendingDisposal.add(o),this.pendingDeletes++,!1;this.releaseGPUData(o);let{complexTensorInfos:c}=this.texData.get(o);return c!=null&&(this.disposeData(c.real.dataId,u),this.disposeData(c.imag.dataId,u)),this.texData.delete(o),!0}releaseGPUData(o){let{texture:u,dtype:c,texShape:f,usage:y,isPacked:w,slice:C}=this.texData.get(o),T=C&&C.origDataId||o,x=this.dataRefCount.get(T);x>1?this.dataRefCount.set(T,x-1):(this.dataRefCount.delete(T),u!=null&&(this.numBytesInGPU-=this.computeBytes(f,c),this.textureManager.releaseTexture(u,f,y,w)));let A=this.texData.get(o);A.texture=null,A.texShape=null,A.isPacked=!1,A.slice=null}getTexture(o){return this.uploadToGPU(o),this.texData.get(o).texture.texture}getDataInfo(o){return this.texData.get(o)}shouldExecuteOnCPU(o,u=Sht){return(0,m.env)().getBool("WEBGL_CPU_FORWARD")&&o.every(c=>this.texData.get(c.dataId).texture==null&&m.util.sizeFromShape(c.shape)<u)}getGPGPUContext(){return this.gpgpu}where(o){m.backend_util.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let u=o.dataSync();return bx(o.shape,u)}packedUnaryOp(o,u,c){let f=new qg(o.shape,u),y=this.compileAndRun(f,[o],c);return(0,m.engine)().makeTensorFromTensorInfo(y)}abs(o){if(this.shouldExecuteOnCPU([o])&&o.dtype!=="complex64"){let f=MX(this.texData.get(o.dataId).values);return this.makeOutput(o.shape,o.dtype,f)}if((0,m.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(o,e$,o.dtype);let u=new _0(o.shape,e$),c=this.compileAndRun(u,[o]);return(0,m.engine)().makeTensorFromTensorInfo(c)}makeTensorInfo(o,u,c){let f;if(u==="string"&&c!=null&&c.length>0&&m.util.isString(c[0])){let y=c.map(w=>m.util.encodeString(w));f=this.write(y,o,u)}else f=this.write(c,o,u);return this.texData.get(f).usage=null,{dataId:f,shape:o,dtype:u}}makeOutput(o,u,c){return(0,m.engine)().makeTensorFromTensorInfo(this.makeTensorInfo(o,u,c),this)}unpackTensor(o){let u=new xh(o.shape);return this.runWebGLProgram(u,[o],o.dtype)}packTensor(o){let u=new BX(o.shape);return this.runWebGLProgram(u,[o],o.dtype,null,!0)}packedReshape(o,u){let c=[nb(o.shape),...rb(o.shape)],f={dtype:o.dtype,shape:c,dataId:o.dataId},y=[nb(u),...rb(u)],w=new p_(y,c),C=[c],T=this.runWebGLProgram(w,[f],o.dtype,C,!0);return{dataId:T.dataId,shape:u,dtype:T.dtype}}decode(o,u){let c=this.texData.get(o),{isPacked:f,shape:y,dtype:w}=c;if(u!=null){let A=m.util.sizeFromShape(y),M=u[0]*u[1]*4;m.util.assert(A<=M,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}let C=bh(y),T;T=f?new TL(C):new pht(C);let x=[u??$2(C)];return{dtype:w,shape:y,dataId:this.runWebGLProgram(T,[{shape:C,dtype:w,dataId:o}],w,x,!0,u).dataId}}runWebGLProgram(o,u,c,f,y=!1,w){let C=this.makeTensorInfo(o.outputShape,c),T=this.texData.get(C.dataId);if(o.packedOutput&&(T.isPacked=!0),o.outPackingScheme===hx.DENSE){let it=w??$2(o.outputShape);T.texShape=it.map(ht=>2*ht)}if(o.outTexUsage!=null&&(T.usage=o.outTexUsage),m.util.sizeFromShape(C.shape)===0)return T.values=m.util.getTypedArrayFromDType(C.dtype,0),C;let x=[],A=u.map(it=>{if(it.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let ht=this.texData.get(it.dataId);if(ht.texture==null){if(!o.packedInputs&&m.util.sizeFromShape(it.shape)<=(0,m.env)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:it.shape,texData:null,isUniform:!0,uniformValues:ht.values};o.packedInputs&&(ht.isPacked=!0,ht.shape=it.shape)}if(this.uploadToGPU(it.dataId),!!ht.isPacked!=!!o.packedInputs)it=ht.isPacked?this.unpackTensor(it):this.packTensor(it),x.push(it),ht=this.texData.get(it.dataId);else if(ht.isPacked&&!a_(ht.shape,it.shape)){let kt=it,Nt=it.shape;it.shape=ht.shape,it=this.packedReshape(it,Nt),x.push(it),ht=this.texData.get(it.dataId),kt.shape=Nt}return{shape:it.shape,texData:ht,isUniform:!1}});this.uploadToGPU(C.dataId);let M={shape:C.shape,texData:T,isUniform:!1},$=function(it,ht,kt){let Nt="";ht.concat(kt).forEach(Pt=>{let re=Pt.texData!=null&&Pt.texData.slice!=null&&Pt.texData.slice.flatOffset>0;if(it.enableShapeUniforms&&!Pt.isUniform){let ue=Pt.texData.texShape,{useSqueezeShape:be,uniformShape:De,keptDims:ze}=mx(it.packedInputs,Pt.shape,ue),Qe="",cn="",en="";if(De.length===1&&it.packedInputs){let Nn=[Math.ceil(ue[0]/2),Math.ceil(ue[1]/2)];Qe=`${Nn[0]>1}_${Nn[1]>1}`}else if(De.length!==2||it.packedInputs){if(De.length>2&&!it.packedInputs){let Nn=m.util.computeStrides(De);en=`${Nn[0]===ue[1]}_${Nn[Nn.length-1]===ue[1]}`}}else cn=`${De[0]>1}_${De[1]>1}`;let sn=Pt.shape.length,xn=De.length===2&&m.util.arraysEqual(Pt.shape,ue),Rn=m.util.sizeFromShape(Pt.shape)===1,Bn=m.backend_util.getBroadcastDims(Pt.shape,kt.shape),Fn=!it.packedInputs&&sn===kt.shape.length&&m.util.arraysEqual(ue,kt.texData.texShape),Xn=it.packedInputs||De.length>2?"":`${ue[0]>1}_${ue[1]>1}`;Nt+=`${sn}_${Fn}_${be?ze:""}_${De.length}_${Rn}_${Bn}_${xn}_${Qe}_${cn}_${en}_${Xn}_${re}`}else{let ue=Pt.isUniform?"uniform":Pt.texData.texShape;Nt+=`${Pt.shape}_${ue}_${re}`}});let $t=it.userCode,Ut=it.constructor.name;return Ut+="_"+Nt+"_"+$t+`${(0,m.env)().getNumber("WEBGL_VERSION")}`,Ut}(o,A,M),V=this.getAndSaveBinary($,()=>function(it,ht,kt,Nt){let $t=kt.map((De,ze)=>{let Qe={logicalShape:De.shape,texShape:De.isUniform?null:De.texData.texShape,isUniform:De.isUniform,isPacked:!De.isUniform&&De.texData.isPacked,flatOffset:null};return De.texData!=null&&De.texData.slice!=null&&De.texData.slice.flatOffset>0&&(Qe.flatOffset=De.texData.slice.flatOffset),{name:ht.variableNames[ze],shapeInfo:Qe}}),Ut=$t.map(De=>De.shapeInfo),Pt={logicalShape:Nt.shape,texShape:Nt.texData.texShape,isUniform:!1,isPacked:Nt.texData.isPacked,flatOffset:null},re=oA($t,Pt,ht),ue=yL(it.gl,re),be=it.createProgram(ue);return(0,m.env)().get("ENGINE_COMPILE_ONLY")?{program:ht,fragmentShader:ue,source:re,webGLProgram:be,inShapeInfos:Ut,outShapeInfo:Pt,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(it.buildVao(be),Object.assign({program:ht,fragmentShader:ue,source:re,webGLProgram:be,inShapeInfos:Ut,outShapeInfo:Pt},l_(it,ht,be)))}(this.gpgpu,o,A,M)),G=this.activeTimers!=null,Q;G&&(Q=this.startTimer()),(0,m.env)().get("ENGINE_COMPILE_ONLY")||function(it,ht,kt,Nt,$t){ht.program.enableShapeUniforms||(EL(ht.inShapeInfos,kt),EL([ht.outShapeInfo],[Nt]));let Ut=Nt.texData.texture,Pt=Nt.texData.texShape;Nt.texData.isPacked?it.setOutputPackedMatrixTexture(Ut.texture,Pt[0],Pt[1]):it.setOutputMatrixTexture(Ut.texture,Pt[0],Pt[1]),it.setProgram(ht.webGLProgram),it.bindVertexArray(ht.webGLProgram.vao),(0,m.env)().getNumber("WEBGL_VERSION")===1&&ht.infLoc!==null&&it.gl.uniform1f(ht.infLoc,1/0),ht.nanLoc!==null&&it.gl.uniform1f(ht.nanLoc,NaN);for(let ue=0;ue<kt.length;++ue){let be=kt[ue],{uniform:De,offset:ze,shape:Qe,texShape:cn}=ht.variablesLocations[ue];if(Qe){let{uniformShape:en}=mx(ht.program.packedInputs,be.shape,be.texData.texShape);switch(en.length){case 1:it.gl.uniform1iv(Qe,new Int32Array(en));break;case 2:it.gl.uniform2iv(Qe,new Int32Array(en));break;case 3:it.gl.uniform3iv(Qe,new Int32Array(en));break;case 4:it.gl.uniform4iv(Qe,new Int32Array(en))}}if(cn&&it.gl.uniform2i(cn,be.texData.texShape[0],be.texData.texShape[1]),De!=null)if(be.isUniform)if(m.util.sizeFromShape(be.shape)<2)it.gl.uniform1f(De,be.uniformValues[0]);else{let en=be.uniformValues;en instanceof Float32Array||(en=new Float32Array(en)),it.gl.uniform1fv(De,en)}else be.texData.slice!=null&&ze!=null&&it.gl.uniform1i(ze,be.texData.slice.flatOffset),it.setInputMatrixTexture(be.texData.texture.texture,De,ue)}let re=ht.outShapeLocation;if(re)switch(Nt.shape.length){case 1:it.gl.uniform1iv(re,new Int32Array(Nt.shape));break;case 2:it.gl.uniform2iv(re,new Int32Array(Nt.shape));break;case 3:it.gl.uniform3iv(re,new Int32Array(Nt.shape));break;case 4:it.gl.uniform4iv(re,new Int32Array(Nt.shape))}if(ht.outShapeStridesLocation){let ue=m.util.computeStrides(Nt.shape);switch(Nt.shape.length){case 2:it.gl.uniform1iv(ht.outShapeStridesLocation,new Int32Array(ue));break;case 3:it.gl.uniform2iv(ht.outShapeStridesLocation,new Int32Array(ue));break;case 4:it.gl.uniform3iv(ht.outShapeStridesLocation,new Int32Array(ue))}}if(ht.outTexShapeLocation&&it.gl.uniform2i(ht.outTexShapeLocation,Nt.texData.texShape[0],Nt.texData.texShape[1]),ht.program.customUniforms&&$t)for(let ue=0;ue<ht.program.customUniforms.length;++ue){let be=ht.program.customUniforms[ue],De=ht.customUniformLocations[ue],ze=$t[ue];if(be.type==="float")it.gl.uniform1fv(De,ze);else if(be.type==="vec2")it.gl.uniform2fv(De,ze);else if(be.type==="vec3")it.gl.uniform3fv(De,ze);else if(be.type==="vec4")it.gl.uniform4fv(De,ze);else if(be.type==="int")it.gl.uniform1iv(De,ze);else if(be.type==="ivec2")it.gl.uniform2iv(De,ze);else if(be.type==="ivec3")it.gl.uniform3iv(De,ze);else{if(be.type!=="ivec4")throw Error(`uniform type ${be.type} is not supported yet.`);it.gl.uniform4iv(De,ze)}}it.executeProgram()}(this.gpgpu,V,A,M,f),x.forEach(it=>this.disposeIntermediateTensorInfo(it)),G&&(Q=this.endTimer(Q),this.activeTimers.push({name:o.constructor.name,query:this.getQueryTime(Q)}));let nt=(0,m.env)().getNumber("WEBGL_FLUSH_THRESHOLD");if(nt>0){let it=m.util.now();it-this.lastGlFlushTime>nt&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=it)}if(!(0,m.env)().getBool("WEBGL_LAZILY_UNPACK")&&T.isPacked&&y===!1){let it=this.unpackTensor(C);return this.disposeIntermediateTensorInfo(C),it}return C}compileAndRun(o,u,c,f,y=!1){return c=c||u[0].dtype,this.runWebGLProgram(o,u,c,f,y)}getAndSaveBinary(o,u){return o in this.binaryCache||(this.binaryCache[o]=u()),this.binaryCache[o]}getTextureManager(){return this.textureManager}dispose(){this.disposed||((0,m.env)().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(o=>{this.gpgpu.deleteProgram(this.binaryCache[o].webGLProgram),delete this.binaryCache[o]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=(0,m.tidy)(()=>{if(!(0,m.env)().get("WEBGL_RENDER_FLOAT32_ENABLED")){let o=(0,m.env)().getBool("DEBUG");(0,m.env)().set("DEBUG",!1);let u=this.abs((0,m.scalar)(1e-8)).dataSync()[0];if((0,m.env)().set("DEBUG",o),u>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?1e-7:1e-4}uploadToGPU(o){let u=this.texData.get(o),{shape:c,dtype:f,values:y,texture:w,usage:C,isPacked:T}=u;if(w!=null)return;let x=this.activeTimers!=null,A;x&&(A=m.util.now());let M=u.texShape;if(M==null&&(M=xL(c,T),u.texShape=M),y!=null){let $=bh(c),V,G=M[1],Q=M[0],nt=y instanceof Uint8Array||y instanceof Uint8ClampedArray;!T&&nt||([G,Q]=z2(M[0],M[1])),V=T?new IL($,nt):new cA($,nt);let it=nt?[Q,G]:M,ht=this.makeTensorInfo(it,f),kt=this.texData.get(ht.dataId);kt.usage=nt?Hc.PIXELS:Hc.UPLOAD,kt.texShape=it,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(ht.dataId),G,Q,y);let Nt=[[Q,G]],$t=!0,Ut=this.runWebGLProgram(V,[ht],f,Nt,$t),Pt=this.texData.get(Ut.dataId);u.texShape=Pt.texShape,u.isPacked=Pt.isPacked,u.usage=Pt.usage,(0,m.env)().get("ENGINE_COMPILE_ONLY")?this.disposeData(Ut.dataId):(u.texture=Pt.texture,u.values=null,this.texData.delete(Ut.dataId)),this.disposeIntermediateTensorInfo(ht),x&&(this.uploadWaitMs+=m.util.now()-A)}else{let $=this.acquireTexture(M,C,f,T);u.texture=$}}convertAndCacheOnCPU(o,u){let c=this.texData.get(o),{dtype:f}=c;return u!=null&&(c.values=function(y,w){if(w==="float32"||w==="complex64")return y;if(w==="int32"||w==="bool"){let C=w==="int32"?new Int32Array(y.length):new Uint8Array(y.length);for(let T=0;T<C.length;++T)C[T]=Math.round(y[T]);return C}throw new Error(`Unknown dtype ${w}`)}(u,f)),c.values}acquireTexture(o,u,c,f){if(this.numBytesInGPU+=this.computeBytes(o,c),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){let y=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${y} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(o,u,f)}computeBytes(o,u){return o[0]*o[1]*m.util.bytesPerElement(u)}checkCompileCompletion(){for(let[,o]of Object.entries(this.binaryCache))this.checkCompletion_(o)}checkCompileCompletionAsync(){return ce(this,null,function*(){let o=[];if(this.gpgpu.parallelCompilationExtension){for(let[,u]of Object.entries(this.binaryCache))o.push(this.checkCompletionAsync_(u));return Promise.all(o)}for(let[,u]of Object.entries(this.binaryCache)){let c=new Promise(f=>{try{this.checkCompletion_(u),f(!0)}catch(y){throw y}});o.push(c)}return Promise.all(o)})}checkCompletionAsync_(o){return ce(this,null,function*(){return this.gpgpu.gl.getProgramParameter(o.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(o):(yield(0,m.nextFrame)(),this.checkCompletionAsync_(o))})}checkCompletion_(o){if(this.gpgpu.gl.getProgramParameter(o.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(o.webGLProgram)),this.gpgpu.gl.getShaderParameter(o.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(qT(o.source,this.gpgpu.gl.getShaderInfoLog(o.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(let o of Object.values(this.binaryCache)){this.gpgpu.buildVao(o.webGLProgram);let{variablesLocations:u,customUniformLocations:c,infLoc:f,nanLoc:y,outShapeLocation:w,outShapeStridesLocation:C,outTexShapeLocation:T}=l_(this.gpgpu,o.program,o.webGLProgram);o.variablesLocations=u,o.customUniformLocations=c,o.infLoc=f,o.nanLoc=y,o.outShapeLocation=w,o.outShapeStridesLocation=C,o.outTexShapeLocation=T}}createTensorFromGPUData(o,u,c){o.channels=o.channels||"RGBA";let{texture:f,height:y,width:w,channels:C}=o,T=(0,m.engine)().backend;if(!T.gpgpu.gl.isTexture(f))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");let x=T.writeTexture(f,u,c,y,w,C);return(0,m.engine)().makeTensorFromDataId(x,u,c,T)}}l.nextDataId=0;return l})(),r$="4.22.0";function i$(){(0,m.env)().set("WEBGL_FORCE_F16_TEXTURES",!0)}m.device_util.isBrowser()&&(0,m.registerBackend)("webgl",()=>new m_,2);let _ht={forceHalfFloat:i$},a$=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class hs{constructor(i,o,u){this.variableNames=["A","B"],this.outputShape=m.backend_util.assertAndGetBroadcastShape(o,u),this.enableShapeUniforms=pc(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${i}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}let U2=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class hb{constructor(i,o,u,c=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=m.backend_util.assertAndGetBroadcastShape(o,u);let f=this.outputShape.length;this.enableShapeUniforms=pc(f);let y="";if(c)if(f===0||m.util.sizeFromShape(this.outputShape)===1)y=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(y=`
          ${is(f)} coords = getOutputCoords();
        `,f===1)this.enableShapeUniforms?y+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:y+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{let w=Pu("coords",f);this.enableShapeUniforms?y+=`
            bool nextRowOutOfBounds =
              (${w[f-2]} + 1) >= outShape[${f} - 2];
            bool nextColOutOfBounds =
              (${w[f-1]} + 1) >= outShape[${f} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:y+=`
            bool nextRowOutOfBounds =
              (${w[f-2]} + 1) >= ${this.outputShape[f-2]};
            bool nextColOutOfBounds =
              (${w[f-1]} + 1) >= ${this.outputShape[f-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${i}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${y}

        setOutput(result);
      }
    `}}function Pd(l){let{inputs:i,backend:o}=l,{x:u}=i;return o.incRef(u.dataId),{dataId:u.dataId,shape:u.shape,dtype:u.dtype}}let Cht={kernelName:m.Identity,backendName:"webgl",kernelFunc:Pd};function W2(l){let{inputs:i,backend:o}=l,{real:u,imag:c}=i,f=o.makeTensorInfo(u.shape,"complex64"),y=o.texData.get(f.dataId),w=Pd({inputs:{x:u},backend:o}),C=Pd({inputs:{x:c},backend:o});return y.complexTensorInfos={real:w,imag:C},f}let kA={kernelName:m.Complex,backendName:"webgl",kernelFunc:W2},o$="return (a < 0.) ? b * a : a;",WX=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Eht={kernelName:m.LeakyRelu,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{alpha:f}=u,y=o.makeTensorInfo([],"float32",m.util.createScalarValue(f,"float32")),w=(0,m.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new hb(WX,c.shape,y.shape):new hs(o$,c.shape,y.shape),C=o.runWebGLProgram(w,[c,y],"float32");return o.disposeIntermediateTensorInfo(y),C}},db="return (a < 0.) ? b * a : a;",wx=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,VX={kernelName:m.Prelu,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{x:u,alpha:c}=i,f=(0,m.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new hb(wx,u.shape,c.shape):new hs(db,u.shape,c.shape);return o.runWebGLProgram(f,[u,c],"float32")}},fb="if (isnan(x)) return x;";function lo({opSnippet:l,packedOpSnippet:i,cpuKernelImpl:o,dtype:u}){return({inputs:c,backend:f})=>{let{x:y}=c,w=f,C=u||y.dtype;if(w.shouldExecuteOnCPU([y])&&o!=null){let x=w.texData.get(y.dataId),A=o(x.values,C);return w.makeTensorInfo(y.shape,C,A)}let T;return T=(0,m.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&i!=null?new qg(y.shape,i):new _0(y.shape,l),w.runWebGLProgram(T,[y],C)}}function Bu({opSnippet:l,packedOpSnippet:i,checkOutOfBounds:o=!1,supportsComplex:u=!1,cpuKernelImpl:c,dtype:f}){return({inputs:y,backend:w})=>{let{a:C,b:T}=y,x=w;if(u&&C.dtype==="complex64"){let $=x.texData.get(C.dataId),V=x.texData.get(T.dataId),[G,Q]=[[$.complexTensorInfos.real,V.complexTensorInfos.real],[$.complexTensorInfos.imag,V.complexTensorInfos.imag]].map(it=>{let[ht,kt]=it,Nt={dataId:ht.dataId,dtype:ht.dtype,shape:C.shape},$t={dataId:kt.dataId,dtype:kt.dtype,shape:T.shape},Ut=new hs(l,C.shape,T.shape);return x.runWebGLProgram(Ut,[Nt,$t],(0,m.upcastType)(ht.dtype,kt.dtype))}),nt=W2({inputs:{real:G,imag:Q},backend:x});return x.disposeIntermediateTensorInfo(G),x.disposeIntermediateTensorInfo(Q),nt}let A=f||(0,m.upcastType)(C.dtype,T.dtype);if((C.dtype==="string"||T.dtype==="string"||x.shouldExecuteOnCPU([C,T]))&&c!=null){let $=x.texData.get(C.dataId).values,V=x.texData.get(T.dataId).values,G=C.dtype==="string"?m.backend_util.fromUint8ToStringArray($):$,Q=C.dtype==="string"?m.backend_util.fromUint8ToStringArray(V):V,[nt,it]=c(C.shape,T.shape,G,Q,A),ht=x.makeTensorInfo(it,A);return x.texData.get(ht.dataId).values=nt,ht}let M;return M=(0,m.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&i!=null?new hb(i,C.shape,T.shape,o):new hs(l,C.shape,T.shape),x.runWebGLProgram(M,[C,T],A)}}function Xg(l,i=!1){if(l==="linear")return"return x;";if(l==="relu")return i?`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`:kht;if(l==="elu")return i?`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`:"return (x >= 0.0) ? x : (exp(x) - 1.0);";if(l==="relu6")return i?`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`:UX;if(l==="prelu")return i?wx:db;if(l==="leakyrelu")return i?WX:o$;if(l==="sigmoid")return"return 1.0 / (1.0 + exp(-1.0 * x));";throw new Error(`Activation ${l} has not been implemented for the WebGL backend.`)}class Kg{constructor(i,o,u,c=!1,f=!1,y=!1,w=null,C=!1,T=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=u,this.enableShapeUniforms=pc(this.outputShape.length);let x=c?i[1]:i[2],A=Math.ceil(x/2),M=c?"i * 2, rc.y":"rc.y, i * 2",$=f?"rc.z, i * 2":"i * 2, rc.z",V=c?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],G=f?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],Q="",nt="";w&&(Q=C?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${w}
        }`:T?`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${w}
        }`:`vec4 activation(vec4 x) {
          ${w}
        }`,nt="result = activation(result);");let it=y?"result += getBiasAtOutCoords();":"";y&&this.variableNames.push("bias"),C&&this.variableNames.push("preluActivationWeights"),T&&this.variableNames.push("leakyreluAlpha");let ht="rc.x",kt="rc.x";i[0]<o[0]?ht=`imod(rc.x, ${i[0]})`:o[0]<i[0]&&(kt=`imod(rc.x, ${o[0]})`),this.userCode=`
      ${Q}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${A}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${ht};
        int batchB = ${kt};
        for (int i = 0; i < ${A}; i++) {
          vec4 a = getMatrixA(batchA, ${M});
          vec4 b = getMatrixB(batchB, ${$});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${V[0]} * ${G[0]});
          result += (${V[1]} * ${G[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${it}

        ${nt}

        setOutput(result);
      }
    `}}let xx="return areal * breal - aimag * bimag;",kx="return areal * bimag + aimag * breal;";class pb{constructor(i,o,u){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=m.backend_util.assertAndGetBroadcastShape(o,u),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${i}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}let Sx="return a * b;";function gp(l){let{inputs:i,backend:o}=l,{a:u,b:c}=i,f=m.backend_util.upcastType(u.dtype,c.dtype);if(u.dtype==="complex64"){let w=o.texData.get(u.dataId),C=o.texData.get(c.dataId),T=new pb(xx,u.shape,c.shape),x=new pb(kx,u.shape,c.shape),A=[{dataId:w.complexTensorInfos.real.dataId,dtype:w.complexTensorInfos.real.dtype,shape:u.shape},{dataId:w.complexTensorInfos.imag.dataId,dtype:w.complexTensorInfos.imag.dtype,shape:u.shape},{dataId:C.complexTensorInfos.real.dataId,dtype:C.complexTensorInfos.real.dtype,shape:c.shape},{dataId:C.complexTensorInfos.imag.dataId,dtype:C.complexTensorInfos.imag.dtype,shape:c.shape}],M=o.runWebGLProgram(T,A,"float32"),$=o.runWebGLProgram(x,A,"float32"),V=W2({inputs:{real:M,imag:$},backend:o});return o.disposeIntermediateTensorInfo(M),o.disposeIntermediateTensorInfo($),V}if(o.shouldExecuteOnCPU([u,c])){let w=o.texData.get(u.dataId),C=o.texData.get(c.dataId),[T,x]=vx(u.shape,c.shape,w.values,C.values,f),A=o.makeTensorInfo(x,f);return o.texData.get(A.dataId).values=T,A}let y;return y=(0,m.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new hb(Sx,u.shape,c.shape):new hs(Sx,u.shape,c.shape),o.runWebGLProgram(y,[u,c],f)}let Tht={kernelName:m.Multiply,backendName:"webgl",kernelFunc:gp};function ri(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{shape:f}=u,y=o,w=m.util.sizeFromShape(c.shape),C=m.util.inferFromImplicitShape(f,w),T=m.util.sizeFromShape(C);m.util.assert(w===T,()=>`The new shape (${C}) has ${T} elements and the old shape (${c.shape}) has ${w} elements. The new shape and old shape must have the same number of elements.`);let x=y.texData.get(c.dataId);return!x.isPacked||a_(c.shape,C)||x.texture!==null&&a_(x.shape,C)?(y.incRef(c.dataId),{dataId:c.dataId,shape:C,dtype:c.dtype}):function(A,M,$){let V=[nb(A.shape),...rb(A.shape)],G={dtype:A.dtype,shape:V,dataId:A.dataId},Q=[nb(M),...rb(M)],nt=new p_(Q,V),it=[V],ht=$.runWebGLProgram(nt,[G],A.dtype,it,!0);return{dataId:ht.dataId,shape:M,dtype:ht.dtype}}(c,C,y)}let Aht={kernelName:m.Reshape,backendName:"webgl",kernelFunc:ri};class GX{constructor(i,o){this.variableNames=["x"];let{windowSize:u,batchSize:c,inSize:f,outSize:y}=i;this.outputShape=[c,y];let w=4*Math.floor(u/4),C=u%4,T="sumValue += dot(values, ones);";if(o!=null){let A=1/o;T=`sumValue += dot(values * ${m.util.isInt(A)?A.toPrecision(2):A}, ones);`}let x="";f%u>0&&(x=`
        if (inIdx < 0 || inIdx >= ${f}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${x}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${u};

        float sumValue = 0.0;

        for (int i = 0; i < ${w}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${T}
        }

        int inIdx = inOffset + ${w};
        if (${C===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${T}
        } else if (${C===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${T}
        } else if (${C===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${T}
        }
        setOutput(sumValue);
      }
    `}}class Iht{constructor(i,o){this.variableNames=["x"];let{windowSize:u,batchSize:c,inSize:f,outSize:y}=i;this.outputShape=[c,y];let w="0.0",C="";o==="prod"?w="1.0":o==="min"?(w="1.0 / 1e-20",C="min"):o==="max"&&(w="-1.0 / 1e-20",C="max");let T=`${o}(${o}(${o}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;o==="sum"?T="sumValue":o==="prod"?T="prodValue":o==="all"?T="allValue":o==="any"&&(T="anyValue");let x=4*Math.floor(u/4),A=u%4,M=`
      if (${o==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${o==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${C}(values, minMaxValue);
        if (${o==="min"} || ${o==="max"}) {
          minMaxValue = ${C}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,$="vec4";o==="all"?(w="1.0",M=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,$="bvec4"):o==="any"&&(w="0.0",M=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,$="bvec4");let V="";f%u>0&&(V=`
        if (inIdx < 0 || inIdx >= ${f}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${V}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${u};

        vec4 minMaxValue = vec4(${w});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${x}; i += 4) {
          int inIdx = inOffset + i;
          ${$} values = ${$}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${M}
        }

        int inIdx = inOffset + ${x};
        if (${A===1}) {
          ${$} values = ${$}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${M}
        } else if (${A===2}) {
          ${$} values = ${$}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${M}
        } else if (${A===3}) {
          ${$} values = ${$}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${M}
        }
        setOutput(${T});
      }
    `}}function mb(l,i,o,u){let c=function(y){let w=[];for(;w.length===0||w[w.length-1].outSize!==1;){let C=w.length?w[w.length-1].outSize:y[1],T=m.backend_util.computeOptimalWindowSize(C);w.push({inSize:C,windowSize:T,outSize:Math.ceil(C/T)})}return w}(l.shape),f=l;for(let y=0;y<c.length;y++){let{inSize:w,windowSize:C,outSize:T}=c[y],x,A;x=o==="mean"?y===0?new GX({windowSize:C,inSize:w,batchSize:l.shape[0],outSize:T},w):new GX({windowSize:C,inSize:w,batchSize:l.shape[0],outSize:T}):new Iht({windowSize:C,inSize:w,batchSize:l.shape[0],outSize:T},o),A=f,f=u.runWebGLProgram(x,[f],i),A.dataId!==l.dataId&&u.disposeIntermediateTensorInfo(A)}return f}class Nht{constructor(i,o){this.variableNames=["A"];let u=new Array(i.length);for(let y=0;y<u.length;y++)u[y]=i[o[y]];this.outputShape=u,this.rank=u.length;let c=is(this.rank),f=function(y){let w=y.length;if(w>6)throw Error(`Transpose for rank ${w} is not yet supported`);let C=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],T=new Array(w);for(let x=0;x<y.length;x++)T[y[x]]=C[x];return T.join()}(o);this.userCode=`
    void main() {
      ${c} resRC = getOutputCoords();
      setOutput(getA(${f}));
    }
    `}}class HX{constructor(i,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let u=new Array(i.length);for(let x=0;x<u.length;x++)u[x]=i[o[x]];if(this.outputShape=u,this.rank=u.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let c=is(this.rank),f=Hg("rc",this.rank),y=new Array(this.rank);for(let x=0;x<o.length;x++)y[o[x]]=f[x];let w=`vec2(${y.slice(-2).join()})`,C=`++${f[this.rank-1]} < ${u[this.rank-1]}`,T=`getChannel(getA(${y.join()}), ${w})`;this.userCode=`
    void main() {
      ${c} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${T};
      if(${C}) {
        result[1] = ${T};
      }
      --${f[this.rank-1]};
      if(++${f[this.rank-2]} < ${u[this.rank-2]}) {
        result[2] = ${T};
        if(${C}) {
          result[3] = ${T};
        }
      }
      setOutput(result);
    }
    `}}function g_(l,i,o){let u=(0,m.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new HX(l.shape,i):new Nht(l.shape,i);return o.runWebGLProgram(u,[l],l.dtype)}function y_(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,keepDims:y}=u;return function(w,C,T,x){let A=C,M=w.shape.length,$=m.util.parseAxisParam(A,w.shape),V=$,G=m.backend_util.getAxesPermutation(V,M),Q=G!=null,nt=w;Q&&(nt=g_(w,G,x),V=m.backend_util.getInnerMostAxes(V.length,M)),m.backend_util.assertAxesAreInnerMostDims("sum",V,M);let[it,ht]=m.backend_util.computeOutAndReduceShapes(nt.shape,V),kt=it;T&&(kt=m.backend_util.expandShapeToKeepDim(it,$));let Nt=m.util.sizeFromShape(ht),$t=ri({inputs:{x:nt},attrs:{shape:[m.util.sizeFromShape(w.shape)/Nt,Nt]},backend:x}),Ut=mb($t,(0,m.sumOutType)(w.dtype),"sum",x),Pt=ri({inputs:{x:Ut},attrs:{shape:kt},backend:x});return x.disposeIntermediateTensorInfo($t),x.disposeIntermediateTensorInfo(Ut),Q&&x.disposeIntermediateTensorInfo(nt),Pt}(c,f,y,o)}let v_={kernelName:m.Sum,backendName:"webgl",kernelFunc:y_};function qc(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{perm:f}=u,y=o,w=c.shape.length,C=new Array(w);for(let x=0;x<C.length;x++)C[x]=c.shape[f[x]];let T;if(y.shouldExecuteOnCPU([c])){let x=y.texData.get(c.dataId).values,A=f_(x,c.shape,c.dtype,f,C);T=y.makeTensorInfo(C,c.dtype),y.texData.get(T.dataId).values=A}else T=g_(c,f,y);return T}let SA={kernelName:m.Transpose,backendName:"webgl",kernelFunc:qc};function _x({a:l,b:i,transposeA:o,transposeB:u,backend:c,bias:f=null,preluActivationWeights:y=null,leakyreluAlpha:w=0,activation:C=null}){let T=l.shape.length,x=i.shape.length,A=o?l.shape[T-2]:l.shape[T-1],M=u?i.shape[x-1]:i.shape[x-2],$=o?l.shape[T-1]:l.shape[T-2],V=u?i.shape[x-2]:i.shape[x-1],G=l.shape.slice(0,-2),Q=i.shape.slice(0,-2),nt=m.util.sizeFromShape(G),it=m.util.sizeFromShape(Q),ht=m.broadcast_util.assertAndGetBroadcastShape(l.shape.slice(0,-2),i.shape.slice(0,-2)).concat([$,V]);m.util.assert(A===M,()=>`Error in matMul: inner shapes (${A}) and (${M}) of Tensors with shapes ${l.shape} and ${i.shape} and transposeA=${o} and transposeB=${u} must match.`);let kt=o?[nt,A,$]:[nt,$,A],Nt=u?[it,V,M]:[it,M,V],$t=ri({inputs:{x:l},backend:c,attrs:{shape:kt}}),Ut=ri({inputs:{x:i},backend:c,attrs:{shape:Nt}}),Pt=[$t,Ut],re=Math.max(nt,it),ue=o?$t.shape[1]:$t.shape[2],be=f!=null,De=y!=null,ze=C==="leakyrelu",Qe=C!=null?Xg(C,!0):null,cn;if(($===1||V===1)&&ue>1e3&&(be||De||ze||Qe!=null)===!1){let sn=$t,xn=Ut;o&&(sn=qc({inputs:{x:$t},backend:c,attrs:{perm:[0,2,1]}}),Pt.push(sn)),u&&(xn=qc({inputs:{x:Ut},backend:c,attrs:{perm:[0,2,1]}}),Pt.push(xn));let Rn=V===1,Bn=sn;V!==1&&(Bn=ri({inputs:{x:sn},backend:c,attrs:{shape:[re,ue,1]}}),Pt.push(Bn));let Fn=V===1?2:1,Xn=xn;Rn&&(Xn=ri({inputs:{x:xn},backend:c,attrs:{shape:[re,1,ue]}}),Pt.push(Xn));let Nn=gp({inputs:{a:Bn,b:Xn},backend:c});cn=y_({inputs:{x:Nn},backend:c,attrs:{axis:Fn,keepDims:!0}}),Pt.push(Nn)}else{let sn=(0,m.upcastType)(l.dtype,i.dtype),xn=new Kg(kt,Nt,[re,$,V],o,u,be,Qe,De,ze),Rn=[$t,Ut];if(f!=null&&Rn.push(f),De&&Rn.push(y),ze){let Bn=c.makeTensorInfo([],"float32",m.util.createScalarValue(w,"float32"));Rn.push(Bn),Pt.push(Bn)}cn=c.runWebGLProgram(xn,Rn,sn)}let en=ri({inputs:{x:cn},backend:c,attrs:{shape:ht}});Pt.push(cn);for(let sn of Pt)c.disposeIntermediateTensorInfo(sn);return en}let V2={kernelName:m._FusedMatMul,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{a:c,b:f,bias:y,preluActivationWeights:w}=i,{transposeA:C,transposeB:T,activation:x,leakyreluAlpha:A}=u;return _x({a:c,b:f,transposeA:C,transposeB:T,backend:o,bias:y,preluActivationWeights:w,leakyreluAlpha:A,activation:x})}},mc="return abs(x);",YX={kernelName:m.Abs,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{x:u}=i;if(o.shouldExecuteOnCPU([u])&&u.dtype!=="complex64"){let f=o.texData.get(u.dataId),y=MX(f.values);return o.makeTensorInfo(u.shape,u.dtype,y)}let c;return c=(0,m.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new qg(u.shape,mc):new _0(u.shape,mc),o.runWebGLProgram(c,[u],u.dtype)}},qX=lo({opSnippet:Sf+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`}),s$={kernelName:m.Acos,backendName:"webgl",kernelFunc:qX},XX=lo({opSnippet:Sf+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`}),KX={kernelName:m.Acosh,backendName:"webgl",kernelFunc:XX},b_="return a + b;",Im=Bu({opSnippet:b_,packedOpSnippet:b_,supportsComplex:!0,cpuKernelImpl:ght}),u$={kernelName:m.Add,backendName:"webgl",kernelFunc:Im};class ZX{constructor(i,o){this.outputShape=[],this.outputShape=i,this.variableNames=o.map((f,y)=>`T${y}`);let u=[];this.variableNames.forEach(f=>{u.push(`float v${f} = get${f}AtOutCoords();`)});let c=this.variableNames.map(f=>`v${f}`).join(" + ");this.userCode=`
      void main() {
        ${u.join(`
        `)}

        float result = ${c};
        setOutput(result);
      }
    `}}class QX{constructor(i,o){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i,this.variableNames=o.map((f,y)=>`T${y}`);let u=[];this.variableNames.forEach(f=>{u.push(`vec4 v${f} = get${f}AtOutCoords();`)});let c=this.variableNames.map(f=>`v${f}`).join(" + ");this.userCode=`
      void main() {
        ${u.join(`
        `)}

        vec4 result = ${c};
        setOutput(result);
      }
    `}}let JX={kernelName:m.AddN,backendName:"webgl",kernelFunc:function l(i){let{inputs:o,backend:u}=i,c=o;if(c.length===1)return Pd({inputs:{x:c[0]},backend:u});if(c.length>(0,m.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){let C=Math.floor(c.length/2),T=l({inputs:c.slice(0,C),backend:u}),x=l({inputs:c.slice(C),backend:u});return l({inputs:[T,x],backend:u})}let f=c.map(C=>C.dtype).reduce((C,T)=>(0,m.upcastType)(C,T)),y=c.map(C=>C.shape),w=(0,m.env)().getBool("WEBGL_PACK")?new QX(c[0].shape,y):new ZX(c[0].shape,y);return u.runWebGLProgram(w,c,f)}},_A={kernelName:m.All,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,keepDims:y}=u,w=c.shape.length,C=m.util.parseAxisParam(f,c.shape),T=C,x=m.backend_util.getAxesPermutation(T,w),A=c;x!=null&&(A=qc({inputs:{x:c},backend:o,attrs:{perm:x}}),T=m.backend_util.getInnerMostAxes(T.length,w)),m.backend_util.assertAxesAreInnerMostDims("all",T,w);let[M,$]=m.backend_util.computeOutAndReduceShapes(A.shape,T),V=ri({inputs:{x:A},backend:o,attrs:{shape:[-1,m.util.sizeFromShape($)]}}),G=mb(V,V.dtype,"all",o),Q;return y?Q=ri({inputs:{x:G},backend:o,attrs:{shape:m.backend_util.expandShapeToKeepDim(M,C)}}):Q=ri({inputs:{x:G},backend:o,attrs:{shape:M}}),o.disposeIntermediateTensorInfo(V),o.disposeIntermediateTensorInfo(G),x!=null&&o.disposeIntermediateTensorInfo(A),Q}},tK={kernelName:m.Any,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,keepDims:y}=u,w=c.shape.length,C=m.util.parseAxisParam(f,c.shape),T=C,x=m.backend_util.getAxesPermutation(T,w),A=c;x!=null&&(A=qc({inputs:{x:c},backend:o,attrs:{perm:x}}),T=m.backend_util.getInnerMostAxes(T.length,w)),m.backend_util.assertAxesAreInnerMostDims("any",T,w);let[M,$]=m.backend_util.computeOutAndReduceShapes(A.shape,T),V=ri({inputs:{x:A},backend:o,attrs:{shape:[-1,m.util.sizeFromShape($)]}}),G=mb(V,V.dtype,"any",o),Q;return y?Q=ri({inputs:{x:G},backend:o,attrs:{shape:m.backend_util.expandShapeToKeepDim(M,C)}}):Q=ri({inputs:{x:G},backend:o,attrs:{shape:M}}),o.disposeIntermediateTensorInfo(V),o.disposeIntermediateTensorInfo(G),x!=null&&o.disposeIntermediateTensorInfo(A),Q}};class CA{constructor(i,o,u){this.variableNames=["A"];let{windowSize:c,batchSize:f,outSize:y}=i;u||this.variableNames.push("bestIndicesA"),this.outputShape=[f,y];let w=o==="max"?">":"<",C=u?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${c};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${c}; i++) {
          int inIdx = ${C};
          float candidate = getA(batch, inIdx);
          if (candidate ${w} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}class Mht{constructor(i,o,u,c){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,m.util.assert(i.length>2,()=>`Packed arg${u.charAt(0).toUpperCase()+u.slice(1)} supports only inputs with rank above 2.`);let f=i[i.length-1],y=Math.ceil(f/o);this.outputShape=i.slice(0,-1),y>1&&this.outputShape.push(y),c||this.variableNames.push("bestIndicesA");let w=this.outputShape,C=w.length,T=is(C),x=Pu("coords",C),A,M;if(y===1){M=C+1;let Pt=is(M);A=`
        ${Pt} sourceLocR = ${Pt}(${x.join()}, 0);
        ++${x[C-1]};
        ${Pt} sourceLocG = ${Pt}(${x.join()}, 0);
        ++${x[C-2]};
        ${Pt} sourceLocA = ${Pt}(${x.join()}, 0);
        --${x[C-1]};
        ${Pt} sourceLocB = ${Pt}(${x.join()}, 0);
        --${x[C-2]};`}else M=C,A=`
        ${T} sourceLocR = coords;
        ++${x[C-1]};
        ${T} sourceLocG = coords;
        ++${x[C-2]};
        ${T} sourceLocA = coords;
        --${x[C-1]};
        ${T} sourceLocB = coords;
        --${x[C-2]};`;let $=["x","y","z","w","u","v"].slice(0,M),V="."+$[M-1],G=$.map(Pt=>"int "+Pt),Q=Pu("sourceLocR",M-1).concat("inIdx.r"),nt=Pu("sourceLocG",M-1).concat("inIdx.g"),it=Pu("sourceLocB",M-1).concat("inIdx.b"),ht=Pu("sourceLocA",M-1).concat("inIdx.a"),kt=u==="max"?"greaterThan":"lessThan",Nt=c?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${Q.join()}),
                             getBestIndicesAChannel(${nt.join()}),
                             getBestIndicesAChannel(${it.join()}),
                             getBestIndicesAChannel(${ht.join()})));`,$t=`vec4(
            getAChannel(${Q.join()}),
            hasNextCol ? getAChannel(${nt.join()}) : 0.,
            hasNextRow ? getAChannel(${it.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${ht.join()}) : 0.)`,Ut=c?"":`
      float getBestIndicesAChannel(${G.join()}) {
        return getChannel(getBestIndicesA(${$.join()}),
                                          vec2(${$.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${G.join()}) {
        return getChannel(getA(${$.join()}),
                               vec2(${$.slice(-2).join()}));
      }
      ${Ut}
      void main() {
        ${T} coords = getOutputCoords();
        bool hasNextCol = ${x[C-1]} < ${w[C-1]-1};
        bool hasNextRow = ${x[C-2]} < ${w[C-2]-1};
        ${A}
        ivec4 srcIdx = ivec4(sourceLocR${V}, sourceLocG${V},
          sourceLocB${V}, sourceLocA${V}) * ${o};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${$t};

        for (int i = 0; i < ${o}; i++) {
          inIdx = srcIdx;
          ${Nt}
          vec4 candidate = ${$t};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${kt}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}function Ql(l,i,o,u=null){let c=i.shape[0],f=i.shape[1];u!=null&&(c=u.shape[0],f=u.shape[1]);let y=m.backend_util.computeOptimalWindowSize(f),w={windowSize:y,inSize:f,batchSize:c,outSize:Math.ceil(f/y)},C=new CA(w,o,u==null),T=[i];u!=null&&T.push(u);let x=l.runWebGLProgram(C,T,"int32");if(x.shape[1]===1)return x;let A=Ql(l,i,o,x);return l.disposeIntermediateTensorInfo(x),A}function EA(l,i,o,u=null){let c=u!=null?u.shape:i.shape,f=c[c.length-1],y=m.backend_util.computeOptimalWindowSize(f),w=new Mht(c,y,o,u==null),C=u==null?[i]:[i,u],T=l.runWebGLProgram(w,C,"int32");if(T.shape.length===i.shape.length){let x=EA(l,i,o,T);return l.disposeIntermediateTensorInfo(T),x}return T}function l$(l,i,o,u){let c=[o];if(m.backend_util.assertAxesAreInnerMostDims("arg"+u.charAt(0).toUpperCase()+u.slice(1),c,i.shape.length),!(0,m.env)().getBool("WEBGL_PACK_REDUCE")||i.shape.length<=2){let f=[],y=l.texData.get(i.dataId),w=i;y!==null&&y.isPacked&&(w=l.unpackTensor(i),f.push(w));let[C,T]=m.backend_util.computeOutAndReduceShapes(w.shape,c),x=m.util.sizeFromShape(T),A=ri({inputs:{x:w},backend:l,attrs:{shape:[-1,x]}});f.push(A);let M=Ql(l,A,u);f.push(M);let $=ri({inputs:{x:M},backend:l,attrs:{shape:C}});return f.forEach(V=>l.disposeIntermediateTensorInfo(V)),$}return EA(l,i,u)}let Dht={kernelName:m.ArgMax,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f}=u,y=m.util.parseAxisParam(f,c.shape),w=m.backend_util.getAxesPermutation(y,c.shape.length),C=c,T=[];w!=null&&(C=qc({inputs:{x:c},backend:o,attrs:{perm:w}}),T.push(C),y=m.backend_util.getInnerMostAxes(y.length,C.shape.length)),m.backend_util.assertAxesAreInnerMostDims("argMax",[y[0]],C.shape.length);let x=l$(o,C,y[0],"max");return T.forEach(A=>o.disposeIntermediateTensorInfo(A)),x}},Rht={kernelName:m.ArgMin,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f}=u,y=m.util.parseAxisParam(f,c.shape),w=m.backend_util.getAxesPermutation(y,c.shape.length),C=c,T=[];w!=null&&(C=qc({inputs:{x:c},backend:o,attrs:{perm:w}}),T.push(C),y=m.backend_util.getInnerMostAxes(y.length,C.shape.length)),m.backend_util.assertAxesAreInnerMostDims("argMin",[y[0]],C.shape.length);let x=l$(o,C,y[0],"min");return T.forEach(A=>o.disposeIntermediateTensorInfo(A)),x}},c$=lo({opSnippet:Sf+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`}),eK={kernelName:m.Asin,backendName:"webgl",kernelFunc:c$},Fht=lo({opSnippet:Sf+"return log(x + sqrt(x * x + 1.0));"}),nK={kernelName:m.Asinh,backendName:"webgl",kernelFunc:Fht},rK=lo({opSnippet:Sf+`
  return atan(x);
`}),C0={kernelName:m.Atan,backendName:"webgl",kernelFunc:rK},iK=Bu({opSnippet:a$+`
  return atan(a, b);
`,packedOpSnippet:`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+U2+`
  return result;
`}),h$={kernelName:m.Atan2,backendName:"webgl",kernelFunc:iK},d$=lo({opSnippet:Sf+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`}),aK={kernelName:m.Atanh,backendName:"webgl",kernelFunc:d$};class yp{constructor(i,o,u,c=!1,f=!1){if(this.variableNames=["x"],o==="avg"&&u)throw new Error("Cannot compute positions for average pool.");let y=i.filterWidth,w=i.strideHeight,C=i.strideWidth,T=i.dilationHeight,x=i.dilationWidth,A=i.effectiveFilterHeight,M=i.effectiveFilterWidth,$=i.padInfo.top,V=i.padInfo.left;this.outputShape=i.outShape;let G=o==="avg",Q=`((batch  * ${i.inHeight} + xR) * ${i.inWidth} + xC) * ${i.inChannels} + d`,nt=`(xR * ${i.inWidth} + xC) * ${i.inChannels} + d`,it="0.0";if(G||(it="-1.0 / 1e-20"),u){let Ut=">=";return void(this.userCode=`
        const ivec2 strides = ivec2(${w}, ${C});
        const ivec2 pads = ivec2(${$}, ${V});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${A};
              wR += ${T}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${i.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${M};
                wC += ${x}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${i.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${Ut} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${c?f?Q:nt:`wR * ${M} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `)}let ht=`${o}(${o}(${o}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;o==="avg"&&(ht="avgValue / max(count, 1.0)");let kt=4*Math.floor(y/4),Nt=y%4,$t=`
      if (${G}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${w}, ${C});
      const ivec2 pads = ivec2(${$}, ${V});
      const float initializationValue = ${it};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${i.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${it});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${A};
            wR += ${T}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${i.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${kt}; wC += 4) {
            int xC = xCCorner + wC * ${x};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${x}, d),
              getValue(batch, xR, xC + 2 * ${x}, d),
              getValue(batch, xR, xC + 3 * ${x}, d)
            );

            ${$t}
          }

          int xC = xCCorner + ${kt};
          if (${Nt===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${$t}
          } else if (${Nt===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${x}, d),
              initializationValue,
              initializationValue
            );

            ${$t}
          } else if (${Nt===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${x}, d),
              getValue(batch, xR, xC + 2 * ${x}, d),
              initializationValue
            );

            ${$t}
          }
        }
        setOutput(${ht});
      }
    `}}class TA{constructor(i,o,u,c=!1,f=!1){if(this.variableNames=["x"],o==="avg"&&u)throw new Error("Cannot compute positions for average pool.");let y=i.filterWidth,w=i.strideDepth,C=i.strideHeight,T=i.strideWidth,x=i.dilationDepth,A=i.dilationHeight,M=i.dilationWidth,$=i.effectiveFilterDepth,V=i.effectiveFilterHeight,G=i.effectiveFilterWidth,Q=i.padInfo.front,nt=i.padInfo.top,it=i.padInfo.left;this.outputShape=i.outShape;let ht=o==="avg",kt="0.0";if(ht||(kt="-1.0 / 1e-20"),u){let re=">=";return void(this.userCode=`
        const ivec3 strides =
            ivec3(${w}, ${C}, ${T});
        const ivec3 pads = ivec3(${Q}, ${nt}, ${it});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${$};
              wD += ${x}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${i.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${V};
                wR += ${A}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${i.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${G};
                  wC += ${M}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${i.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${re} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${c?f?`(((batch * ${i.inDepth} + xD) * ${i.inHeight} + xR) * ${i.inWidth} + xC) * ${i.inChannels} + ch`:`((xD * ${i.inHeight} + xR) * ${i.inWidth} + xC) * ${i.inChannels} + ch`:`wD * ${V} * ${G} +
                      wR * ${G} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `)}let Nt=`${o}(${o}(${o}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;o==="avg"&&(Nt="avgValue / max(count, 1.0)");let $t=4*Math.floor(y/4),Ut=y%4,Pt=`
      if (${ht}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${w}, ${C}, ${T});
      const ivec3 pads = ivec3(${Q}, ${nt}, ${it});
      const float initializationValue = ${kt};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${i.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${kt});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${$};
            wD += ${x}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${i.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${V};
            wR += ${A}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${i.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${$t}; wC += 4) {
              int xC = xCCorner + wC * ${M};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${M}, ch),
                getValue(batch, xD, xR, xC + 2 * ${M}, ch),
                getValue(batch, xD, xR, xC + 3 * ${M}, ch)
              );

              ${Pt}
            }

            int xC = xCCorner + ${$t};
            if (${Ut===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${Pt}
            } else if (${Ut===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${M}, ch),
                initializationValue,
                initializationValue
              );

              ${Pt}
            } else if (${Ut===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${M}, ch),
                getValue(batch, xD, xR, xC + 2 * ${M}, ch),
                initializationValue
              );

              ${Pt}
            }
          }
        }
        setOutput(${Nt});
      }
    `}}let oK={kernelName:m.AvgPool,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i;ab(c,"avgPool");let{filterSize:f,strides:y,pad:w,dimRoundingMode:C}=u;m.util.assert(m.backend_util.eitherStridesOrDilationsAreOne(y,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${y} and dilations '1'`);let T=m.backend_util.computePool2DInfo(c.shape,f,y,1,w,C);if(T.filterWidth===1&&T.filterHeight===1&&m.util.arraysEqual(T.inShape,T.outShape))return Pd({inputs:{x:c},backend:o});let x=new yp(T,"avg",!1);return o.runWebGLProgram(x,[c],"float32")}},Oht={kernelName:m.AvgPool3D,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{filterSize:f,strides:y,pad:w,dimRoundingMode:C,dataFormat:T}=u,x=m.backend_util.computePool3DInfo(c.shape,f,y,[1,1,1],w,C,T),A=new TA(x,"avg",!1);return o.runWebGLProgram(A,[c],"float32")}};class sK{constructor(i){this.variableNames=["dy"],this.outputShape=i.inShape;let o=i.filterHeight,u=i.filterWidth,c=i.strideHeight,f=i.strideWidth,y=i.dilationHeight,w=i.dilationWidth,C=i.effectiveFilterHeight,T=i.effectiveFilterWidth,x=C-1-i.padInfo.top,A=T-1-i.padInfo.left,M=1/(o*u);this.userCode=`
      const ivec2 pads = ivec2(${x}, ${A});
      const float avgMultiplier = float(${M});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${C};
            wR += ${y}) {
          float dyR = float(dyRCorner + wR) / ${c}.0;

          if (dyR < 0.0 || dyR >= ${i.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${T};
            wC+= ${w}) {
            float dyC = float(dyCCorner + wC) / ${f}.0;

            if (dyC < 0.0 || dyC >= ${i.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class uK{constructor(i){this.variableNames=["dy"],this.outputShape=i.inShape;let o=i.filterDepth,u=i.filterHeight,c=i.filterWidth,f=i.strideDepth,y=i.strideHeight,w=i.strideWidth,C=i.dilationDepth,T=i.dilationHeight,x=i.dilationWidth,A=i.effectiveFilterDepth,M=i.effectiveFilterHeight,$=i.effectiveFilterWidth,V=A-1-i.padInfo.front,G=M-1-i.padInfo.top,Q=$-1-i.padInfo.left,nt=1/(o*u*c);this.userCode=`
      const ivec3 pads = ivec3(${V}, ${G}, ${Q});
      const float avgMultiplier = float(${nt});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${A};
            wD += ${C}) {
          float dyD = float(dyDCorner + wD) / ${f}.0;

          if (dyD < 0.0 || dyD >= ${i.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${M};
              wR += ${T}) {
            float dyR = float(dyRCorner + wR) / ${y}.0;

            if (dyR < 0.0 || dyR >= ${i.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${$};
                wC += ${x}) {
              float dyC = float(dyCCorner + wC) / ${w}.0;

              if (dyC < 0.0 || dyC >= ${i.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}let Lht={kernelName:m.AvgPool3DGrad,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,input:f}=i,y=f,{filterSize:w,strides:C,pad:T,dimRoundingMode:x}=u,A=m.backend_util.computePool3DInfo(y.shape,w,C,[1,1,1],T,x),M=new uK(A);return o.runWebGLProgram(M,[c],y.dtype)}},$ht={kernelName:m.AvgPoolGrad,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,input:f}=i,y=f;ab([c,f],"avgPoolGrad");let{filterSize:w,strides:C,pad:T}=u,x=m.backend_util.computePool2DInfo(y.shape,w,C,1,T),A=new sK(x);return o.runWebGLProgram(A,[c],y.dtype)}},zht={kernelName:m.BatchMatMul,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{a:c,b:f}=i,{transposeA:y,transposeB:w}=u;return _x({a:c,b:f,transposeA:y,transposeB:w,backend:o})}};class Pht{constructor(i,o,u,c,f,y){this.outputShape=[],this.variableNames=["x","mean","variance"],m.backend_util.assertAndGetBroadcastShape(i,o),m.backend_util.assertAndGetBroadcastShape(i,u);let w="0.0";c!=null&&(m.backend_util.assertAndGetBroadcastShape(i,c),this.variableNames.push("offset"),w="getOffsetAtOutCoords()");let C="1.0";f!=null&&(m.backend_util.assertAndGetBroadcastShape(i,f),this.variableNames.push("scale"),C="getScaleAtOutCoords()"),this.outputShape=i,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${w};
        float scale = ${C};
        float inv = scale * inversesqrt(variance + float(${y}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}class f${constructor(i,o,u,c,f,y){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],m.backend_util.assertAndGetBroadcastShape(i,o),m.backend_util.assertAndGetBroadcastShape(i,u);let w="vec4(0.0)";c!=null&&(m.backend_util.assertAndGetBroadcastShape(i,c),this.variableNames.push("offset"),w="getOffsetAtOutCoords()");let C="vec4(1.0)";f!=null&&(m.backend_util.assertAndGetBroadcastShape(i,f),this.variableNames.push("scale"),C="getScaleAtOutCoords()"),this.outputShape=i,this.userCode=`
      void main() {
        vec4 offset = ${w};
        vec4 scale = ${C};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${y}));

        setOutput((x - mean) * inv + offset);
      }
    `}}let lK={kernelName:m.FusedBatchNorm,backendName:"webgl",kernelFunc:({inputs:l,backend:i,attrs:o})=>{let{x:u,mean:c,variance:f,offset:y,scale:w}=l;m.util.assert(c.shape.length===f.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),m.util.assert(y==null||c.shape.length===y.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),m.util.assert(w==null||c.shape.length===w.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:C}=o;C==null&&(C=.001);let T=[u,c,f],x=null;y!=null&&(x=y.shape,T.push(y));let A=null;w!=null&&(A=w.shape,T.push(w));let M=(0,m.env)().getBool("WEBGL_PACK_NORMALIZATION")?new f$(u.shape,c.shape,f.shape,x,A,C):new Pht(u.shape,c.shape,f.shape,x,A,C);return i.runWebGLProgram(M,T,T[0].dtype)}};class cK{constructor(i){this.variableNames=["source"],this.outputShape=i,this.rank=i.length;let o=is(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let u=function(f){if(f===1)return"sourceLoc";if(f<=6)return AA.slice(0,f).map(y=>"sourceLoc."+y).join(",");throw Error(`Slicing for rank ${f} is not yet supported`)}(this.rank),c;c=`
        ${o} sourceLoc;
        ${o} coords = getOutputCoords();
        ${i.map((f,y)=>`sourceLoc.${AA[y]} = start[${y}] + coords.${AA[y]};`).join(`
`)}
      `,this.userCode=`
      void main() {
        ${c}
        setOutput(getSource(${u}));
      }
    `}}let AA=["x","y","z","w","u","v"];class hK{constructor(i){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i,this.rank=i.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let o=is(this.rank),u=Pu("coords",this.rank),c=Pu("sourceLoc",this.rank),f=this.rank===1?"sourceLoc":`vec2(${c.slice(-2).join()})`,y=`getChannel(getSource(${c.join()}), ${f})`,w=`
      result.x = ${y};
      if (++${u[this.rank-1]} < ${i[this.rank-1]}) {
        ++${c[this.rank-1]};
        result.y = ${y};
        --${c[this.rank-1]};
      }
    `,C=this.rank===1?"":`
      --${u[this.rank-1]};
      if (++${u[this.rank-2]} < ${i[this.rank-2]}) {
        ++${c[this.rank-2]};
        result.z = ${y};
        if (++${u[this.rank-1]} < ${i[this.rank-1]}) {
          ++${c[this.rank-1]};
          result.w = ${y};
        }
      }
    `,T=this.rank<=4?`sourceLoc = coords +
            ${o}(${i.map((x,A)=>`start[${A}]`).join()});`:i.map((x,A)=>`${c[A]} = ${u[A]} + start[${A}];`).join(`
`);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        ${o} sourceLoc;
        ${T}
        vec4 result = vec4(0.);
        ${w}
        ${C}
        setOutput(result);
      }
    `}}function G2(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{begin:f,size:y}=u,[w,C]=m.slice_util.parseSliceParams(c,f,y);if(m.slice_util.assertParamsValid(c,w,C),m.util.sizeFromShape(C)===0)return o.makeTensorInfo(C,c.dtype,[]);if(o.shouldExecuteOnCPU([c])||c.dtype==="string"){let A=o.texData.get(c.dataId),M=XL(A.values,w,C,c.shape,c.dtype);return o.makeTensorInfo(C,c.dtype,M)}let{isPacked:T}=o.texData.get(c.dataId),x=m.slice_util.isSliceContinous(c.shape,w,C);if(T||!x){let A=(0,m.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new hK(C):new cK(C),M=[w];return o.runWebGLProgram(A,[c],c.dtype,M)}return o.uploadToGPU(c.dataId),function(A,M,$,V){let G=V.texData.get(A.dataId),Q=V.makeTensorInfo($,A.dtype),nt=V.texData.get(Q.dataId);Object.assign(nt,G),nt.refCount=1,nt.shape=$,nt.dtype=A.dtype;let it=m.slice_util.computeFlatOffset(M,m.util.computeStrides(A.shape));G.slice&&(it+=G.slice.flatOffset),nt.slice={flatOffset:it,origDataId:G.slice&&G.slice.origDataId||A.dataId};let ht=V.dataRefCount.get(nt.slice.origDataId)||1;return V.dataRefCount.set(nt.slice.origDataId,ht+1),Q}(c,w,C,o)}let dK={kernelName:m.Slice,backendName:"webgl",kernelFunc:G2},Bht={kernelName:m.BatchToSpaceND,backendName:"webgl",kernelFunc:l=>{let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{blockShape:f,crops:y}=u;m.util.assert(c.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let w=f.reduce((it,ht)=>it*ht),C=m.backend_util.getReshaped(c.shape,f,w),T=m.backend_util.getPermuted(C.length,f.length),x=m.backend_util.getReshapedPermuted(c.shape,f,w),A=m.backend_util.getSliceBeginCoords(y,f.length),M=m.backend_util.getSliceSize(x,y,f.length),$=[],V=ri({inputs:{x:c},backend:o,attrs:{shape:C}}),G=qc({inputs:{x:V},backend:o,attrs:{perm:T}}),Q=ri({inputs:{x:G},backend:o,attrs:{shape:x}}),nt=G2({inputs:{x:Q},backend:o,attrs:{begin:A,size:M}});return $.push(V),$.push(G),$.push(Q),$.forEach(it=>o.disposeIntermediateTensorInfo(it)),nt}},fK={kernelName:m.Bincount,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,weights:f}=i,{size:y}=u,w=o.readSync(c.dataId),C=o.readSync(f.dataId),T=jL(w,C,f.dtype,f.shape,y);return o.makeTensorInfo([y],f.dtype,T)}},pK={kernelName:m.BitwiseAnd,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{a:u,b:c}=i,f=(0,m.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"),y=(0,m.env)().getNumber("WEBGL_VERSION");if(o.shouldExecuteOnCPU([u,c])||y===1){let C=o.texData.get(u.dataId).values,T=o.texData.get(c.dataId).values,[x,A]=wh(u.shape,c.shape,C,T,u.dtype),M=o.makeTensorInfo(A,u.dtype);return o.texData.get(M.dataId).values=x,M}let w;return w=f?new hb(`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,u.shape,c.shape,!1):new hs(`
  return float(int(a.r) & int(b.r));
`,u.shape,c.shape),o.runWebGLProgram(w,[u,c],u.dtype)}},mK={kernelName:m.BroadcastArgs,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{s0:u,s1:c}=i,f=o.readSync(u.dataId),y=o.readSync(c.dataId),w=m.backend_util.assertAndGetBroadcastShape(Array.from(f),Array.from(y));return o.makeTensorInfo([w.length],"int32",Int32Array.from(w))}},IA=Bu({opSnippet:"return float(a != b);",cpuKernelImpl:S0,dtype:"bool"}),gK={kernelName:m.NotEqual,backendName:"webgl",kernelFunc:IA};function Cx(l){let{inputs:i,backend:o}=l,{input:u}=i;return Pd({inputs:{x:o.texData.get(u.dataId).complexTensorInfos.real},backend:o})}let yK={kernelName:m.Real,backendName:"webgl",kernelFunc:Cx},vK={kernelName:m.Cast,backendName:"webgl",kernelFunc:function l(i){let{inputs:o,backend:u,attrs:c}=i,{x:f}=o,{dtype:y}=c;if(y==="complex64"){if(f.dtype==="complex64")return Pd({inputs:{x:f},backend:u});let w=m.zeros(f.shape),C=l({inputs:{x:f},backend:u,attrs:{dtype:"float32"}}),T=W2({inputs:{real:C,imag:w},backend:u});return w.dispose(),u.disposeIntermediateTensorInfo(C),T}if(f.dtype==="complex64"){let w=Cx({inputs:{input:f},backend:u}),C=l({inputs:{x:w},backend:u,attrs:{dtype:y}});return u.disposeIntermediateTensorInfo(w),C}if(!m.util.hasEncodingLoss(f.dtype,y)){let w=Pd({inputs:{x:f},backend:u});return{dataId:w.dataId,shape:w.shape,dtype:y}}if(u.shouldExecuteOnCPU([f])){let w=u.texData.get(f.dataId).values,[C,T,x]=yht(w,f.shape,f.dtype,y);return u.makeTensorInfo(C,T,x)}if(y==="int32")return function(w,C){let T=new _0(w.shape,"return float(int(x));"),x=C.runWebGLProgram(T,[w],"int32");return{dataId:x.dataId,shape:x.shape,dtype:x.dtype}}(f,u);if(y==="bool"){let w=u.makeTensorInfo([],"bool",m.util.getTypedArrayFromDType("bool",1)),C=IA({inputs:{a:f,b:w},backend:u});return u.disposeIntermediateTensorInfo(w),C}throw new Error(`Error in Cast: failed to cast ${f.dtype} to ${y}`)}},p$="return ceil(x);",m$=lo({opSnippet:p$,packedOpSnippet:p$,cpuKernelImpl:d_}),jht={kernelName:m.Ceil,backendName:"webgl",kernelFunc:m$};class Uht{constructor(i){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=i,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}class Wht{constructor(i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=i,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}let g$={kernelName:m.ClipByValue,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{clipValueMin:f,clipValueMax:y}=u,w;w=(0,m.env)().getBool("WEBGL_PACK_CLIP")?new Wht(c.shape):new Uht(c.shape);let C=[[f],[y]];return o.runWebGLProgram(w,[c],c.dtype,C)}};class y${constructor(i){this.variableNames=["real","imag"],this.outputShape=i,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}function NA(l,i){return{dataId:i.dataId,dtype:i.dtype,shape:l.shape}}let v$={kernelName:m.ComplexAbs,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{x:u}=i,c=o.texData.get(u.dataId),f=new y$(u.shape),y=[NA(u,c.complexTensorInfos.real),NA(u,c.complexTensorInfos.imag)];return o.runWebGLProgram(f,y,y[0].dtype)}};class bK{constructor(i){this.outputShape=[],this.outputShape=m.backend_util.computeOutShape(i,1),this.variableNames=i.map((y,w)=>`T${w}`);let o=new Array(i.length-1);o[0]=i[0][1];for(let y=1;y<o.length;y++)o[y]=o[y-1]+i[y][1];let u=[`if (yC < ${o[0]}) setOutput(getT0(yR, yC));`];for(let y=1;y<o.length;y++){let w=o[y-1];u.push(`else if (yC < ${o[y]}) setOutput(getT${y}(yR, yC-${w}));`)}let c=o.length,f=o[o.length-1];u.push(`else setOutput(getT${c}(yR, yC-${f}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${u.join(`
        `)}
      }
    `}}class H2{constructor(i,o){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=m.backend_util.computeOutShape(i,o);let u=this.outputShape,c=u.length,f=is(c),y=Pu("coords",c),w=["x","y","z","w","u","v"].slice(0,c);this.variableNames=i.map((G,Q)=>`T${Q}`);let C=new Array(i.length-1);C[0]=i[0][o];for(let G=1;G<C.length;G++)C[G]=C[G-1]+i[G][o];let T=w[o],x=w.slice(-2),A=w.join(),M=`if (${T} < ${C[0]}) {
        return getChannel(
            getT0(${A}), vec2(${x.join()}));
        }`;for(let G=1;G<C.length;G++){let Q=C[G-1];M+=`
        if (${T} < ${C[G]}  && ${T} >= ${C[G-1]}) {
          return getChannel(
            getT${G}(${Y2(w,T,Q)}),
            vec2(${Y2(x,T,Q)}));
        }`}let $=C.length,V=C[C.length-1];M+=`
        return getChannel(
          getT${$}(${Y2(w,T,V)}),
          vec2(${Y2(x,T,V)}));`,this.userCode=`
      float getValue(${w.map(G=>"int "+G)}) {
        ${M}
      }

      void main() {
        ${f} coords = getOutputCoords();
        vec4 result = vec4(getValue(${y}), 0., 0., 0.);

        ${y[c-1]} = ${y[c-1]} + 1;
        if (${y[c-1]} < ${u[c-1]}) {
          result.g = getValue(${y});
        }

        ${y[c-2]} = ${y[c-2]} + 1;
        if (${y[c-2]} < ${u[c-2]}) {
          result.a = getValue(${y});
        }

        ${y[c-1]} = ${y[c-1]} - 1;
        if (${y[c-2]} < ${u[c-2]} &&
            ${y[c-1]} < ${u[c-1]}) {
          result.b = getValue(${y});
        }
        setOutput(result);
      }
    `}}function Y2(l,i,o){let u=l.indexOf(i);return l.map((c,f)=>f===u?`${c} - ${o}`:c).join()}function gb(l){let{inputs:i,backend:o}=l,{input:u}=i;return Pd({inputs:{x:o.texData.get(u.dataId).complexTensorInfos.imag},backend:o})}let wK={kernelName:m.Imag,backendName:"webgl",kernelFunc:gb};function Ex(l,i,o){let u=l[0].dtype;if(u==="complex64"){let $=l.map(it=>Cx({inputs:{input:it},backend:o})),V=l.map(it=>gb({inputs:{input:it},backend:o})),G=Ex($,i,o),Q=Ex(V,i,o),nt=W2({inputs:{real:G,imag:Q},backend:o});return $.forEach(it=>o.disposeIntermediateTensorInfo(it)),V.forEach(it=>o.disposeIntermediateTensorInfo(it)),o.disposeIntermediateTensorInfo(G),o.disposeIntermediateTensorInfo(Q),nt}let c=o.shouldExecuteOnCPU(l);if(u==="string"&&(c=!0),c){let $=l.map(kt=>{let Nt=m.util.sizeFromShape(kt.shape.slice(i));return ri({inputs:{x:kt},backend:o,attrs:{shape:[-1,Nt]}})}),V=$.map(kt=>({vals:o.readSync(kt.dataId),shape:kt.shape})),G=m.backend_util.computeOutShape($.map(kt=>kt.shape),1),Q=$[0].shape[0]===1,nt=vA(V,G,u,Q),it=m.backend_util.computeOutShape(l.map(kt=>kt.shape),i),ht=o.makeTensorInfo(it,u,nt);return $.forEach(kt=>o.disposeIntermediateTensorInfo(kt)),ht}let f=l.filter($=>m.util.sizeFromShape($.shape)>0),y=(0,m.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&f[0].shape.length>1;if(f.length===1){let $=y?new _0(l[0].shape,Yg):new qg(l[0].shape,Yg);return o.runWebGLProgram($,l,u)}let w=(0,m.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(f.length>w){let $=[];for(let G=0;G<f.length;G+=w){let Q=f.slice(G,G+w);$.push(Ex(Q,i,o))}let V=Ex($,i,o);for(let G of $)o.disposeIntermediateTensorInfo(G);return V}if(y){let $=new H2(f.map(V=>V.shape),i);return o.runWebGLProgram($,f,u)}let{tensors2D:C,outShape:T}=function($,V,G){let Q=m.backend_util.computeOutShape($.map(it=>it.shape),V);return{tensors2D:$.map(it=>ri({inputs:{x:it},attrs:{shape:[-1,m.util.sizeFromShape(it.shape.slice(V))]},backend:G})),outShape:Q}}(f,i,o),x=new bK(C.map($=>$.shape)),A=o.runWebGLProgram(x,C,u);C.forEach($=>o.disposeIntermediateTensorInfo($));let M=ri({inputs:{x:A},attrs:{shape:T},backend:o});return o.disposeIntermediateTensorInfo(A),M}function MA(l){let{inputs:i,backend:o,attrs:u}=l,{axis:c}=u,f=m.util.parseAxisParam(c,i[0].shape)[0],y=i.map(T=>T.shape);m.backend_util.assertParamsConsistent(y,f);let w=m.backend_util.computeOutShape(i.map(T=>T.shape),f);if(m.util.sizeFromShape(w)===0)return o.makeTensorInfo(w,i[0].dtype,[]);let C=i.filter(T=>m.util.sizeFromShape(T.shape)>0);return C.length===1?Pd({inputs:{x:C[0]},backend:o}):Ex(C,f,o)}let xK={kernelName:m.Concat,backendName:"webgl",kernelFunc:MA};class yb{constructor(i,o=!1,u=null,c=!1,f=!1){this.variableNames=["x","W"],this.outputShape=i.outShape;let y=i.padInfo.top,w=i.padInfo.left,C=i.strideHeight,T=i.strideWidth,x=i.dilationHeight,A=i.dilationWidth,M=i.filterHeight,$=i.filterWidth,V=4*Math.floor(i.inChannels/4),G=i.inChannels%4,Q=i.dataFormat==="channelsLast",nt=Q?1:2,it=Q?2:3,ht=Q?3:1,kt="",Nt="";u&&(kt=c?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${u}
        }`:f?`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${u}
        }`:`
          float activation(float x) {
            ${u}
          }
        `,Nt="result = activation(result);");let $t=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),f&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${kt}

      const ivec2 strides = ivec2(${C}, ${T});
      const ivec2 pads = ivec2(${y}, ${w});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${ht}];

        ivec2 xRCCorner =
            ivec2(coords[${nt}], coords[${it}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${M}; wR++) {
          int xR = xRCorner + wR * ${x};

          if (xR < 0 || xR >= ${i.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${$}; wC++) {
            int xC = xCCorner + wC * ${A};

            if (xC < 0 || xC >= ${i.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${V}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${Q}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${G===1}) {

              if (${Q}) {
                dotProd +=
                    getX(batch, xR, xC, ${V}) *
                    getW(wR, wC, ${V}, d2);
              } else {
                dotProd +=
                    getX(batch, ${V}, xR, xC) *
                    getW(wR, wC, ${V}, d2);
              }

            } else if (${G===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${V}, d2),
                getW(wR, wC, ${V} + 1, d2)
              );

              if (${Q}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${V}),
                  getX(batch, xR, xC, ${V} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${V}, xR, xC),
                  getX(batch, ${V} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${G===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${V}, d2),
                getW(wR, wC, ${V} + 1, d2),
                getW(wR, wC, ${V} + 2, d2)
              );

              if (${Q}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${V}),
                  getX(batch, xR, xC, ${V} + 1),
                  getX(batch, xR, xC, ${V} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${V}, xR, xC),
                  getX(batch, ${V} + 1, xR, xC),
                  getX(batch, ${V} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${$t}
        ${Nt}
        setOutput(result);
      }
    `}}class vb{constructor(i){this.variableNames=["x","W"],this.outputShape=i.outShape;let o=i.padInfo.front,u=i.padInfo.top,c=i.padInfo.left,f=i.strideDepth,y=i.strideHeight,w=i.strideWidth,C=i.dilationDepth,T=i.dilationHeight,x=i.dilationWidth,A=i.filterDepth,M=i.filterHeight,$=i.filterWidth,V=4*Math.floor(i.inChannels/4),G=i.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${f}, ${y}, ${w});
      const ivec3 pads = ivec3(${o}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${A}; wF++) {
          int xF = xFCorner + wF * ${C};

          if (xF < 0 || xF >= ${i.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${M}; wR++) {
            int xR = xRCorner + wR * ${T};

            if (xR < 0 || xR >= ${i.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${$}; wC++) {
              int xC = xCCorner + wC * ${x};

              if (xC < 0 || xC >= ${i.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${V}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${G===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${V}) *
                  getW(wF, wR, wC, ${V}, d2);
              } else if (${G===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${V}),
                  getX(batch, xF, xR, xC, ${V} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${V}, d2),
                  getW(wF, wR, wC, ${V} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${G===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${V}),
                  getX(batch, xF, xR, xC, ${V} + 1),
                  getX(batch, xF, xR, xC, ${V} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${V}, d2),
                  getW(wF, wR, wC, ${V} + 1, d2),
                  getW(wF, wR, wC, ${V} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ao{constructor(i,o=!1,u=null,c=!1,f=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=i.outShape,this.enableShapeUniforms=pc(this.outputShape.length);let y=i.padInfo.left,w=i.strideWidth,C=i.dilationWidth,T=i.filterHeight,x=i.filterWidth,A=x,M=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let Q=0;Q<x;Q++)M+=`
           vec4 xTexelC${2*Q};
           int xTexelC${2*Q}Ready;
           vec4 xTexelC${2*Q+1};
           int xTexelC${2*Q+1}Ready;
           vec4 xC${Q};`;M+=`
     for (int r = 0; r < ${T}; r++) {
      for (int d1 = 0; d1 < ${i.inChannels}; d1 += 2) {
       `;for(let Q=0;Q<x;Q++)M+=`
           xTexelC${2*Q} = vec4(0.0);
           xTexelC${2*Q}Ready = 0;
           xTexelC${2*Q+1} = vec4(0.0);
           xTexelC${2*Q+1}Ready = 0;
           xC${Q} = vec4(0.0);`;M+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let Q=0;Q<(A+1)/2;Q++){let nt=2*Q;if(M+=`
           xC = xCCorner + ${nt*C};
           `,w===1){if(nt<x&&(y%2==1?(M+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${nt}Ready == 0) {
                   xTexelC${nt} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${nt}.zw = vec2(0.0);
                   }
                   xTexelC${nt}Ready = 1;
                 }
               `,M+=C===1&&nt>0?`
                 xC${nt} = vec4(xTexelC${nt-2}.zw, xTexelC${nt}.xy);
                 `:`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${nt} = vec4(previous.zw, xTexelC${nt}.xy);
                   } else {
                     xC${nt} = vec4(0.0, 0.0, xTexelC${nt}.xy);
                   }
                   `):M+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${nt}Ready == 0) {
                   xTexelC${nt} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${nt}.zw = vec2(0.0);
                   }
                   xTexelC${nt}Ready = 1;
                 }

                 xC${nt} = xTexelC${nt};
                 `,nt+1<x)){let it=y%2==0?m.util.nearestLargerEven(C):C;C%2==0&&y%2==1||C%2!=0&&y%2!=1?(M+=`
                   xCOffset = xC + imod(pads[1], 2) + ${it};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${nt+1}Ready == 0) {
                     xTexelC${nt+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${nt+1}.zw = vec2(0.0);
                     }
                     xTexelC${nt+1}Ready = 1;
                   }
                   `,M+=C>1?`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${nt+1} = vec4(previous.zw, xTexelC${nt+1}.xy);
                     } else {
                      xC${nt+1} = vec4(0.0, 0.0, xTexelC${nt+1}.xy);
                     }
                     `:`
                     xC${nt+1} = vec4(xTexelC${nt}.zw, xTexelC${nt+1}.xy);
                     `):M+=it===1?`
                     xC${nt+1} = xTexelC${nt};
                     `:`
                     xCOffset = xC + ${it};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${nt+1}Ready == 0) {
                       xTexelC${nt+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${nt+1}.zw = vec2(0.0);
                       }
                       xTexelC${nt+1}Ready = 1;
                     }

                     xC${nt+1} = xTexelC${nt+1};
                     `}}else nt<x&&(y%2==1?(M+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${nt}Ready == 0) {
                   xTexelC${nt} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${nt}.zw = vec2(0.0);
                   }
                   xTexelC${nt}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${nt+1}Ready == 0) {
                   xTexelC${nt+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${nt+1}.zw = vec2(0.0);
                   }
                   xTexelC${nt+1}Ready = 1;
                 }

                 xC${nt} = vec4(xTexelC${nt}.zw, xTexelC${nt+1}.zw);
               `,nt+1<x&&(M+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${nt+1} = vec4(xTexelC${nt+1}.xy, final.xy);
                 `)):(M+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${nt}Ready == 0) {
                   xTexelC${nt} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${nt}.zw = vec2(0.0);
                   }
                   xTexelC${nt}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${nt+1}Ready == 0) {
                   xTexelC${nt+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${nt+1}.zw = vec2(0.);
                   }
                   xTexelC${nt+1}Ready = 1;
                 }

                 xC${nt} = vec4(
                   xTexelC${nt}.xy, xTexelC${nt+1}.xy);
               `,nt+1<x&&(M+=`
                   xC${nt+1} = vec4(xTexelC${nt}.zw, xTexelC${nt+1}.zw);
                 `)));nt<x&&(M+=`
             wTexel = getW(r, ${nt}, d1, d2);
             dotProd += xC${nt}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${i.inChannels}) {
               dotProd += xC${nt}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,nt+1<x&&(M+=`
               wTexel = getW(r, ${nt+1}, d1, d2);
               dotProd += xC${nt+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${i.inChannels}) {
                 dotProd += xC${nt+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}M+=`
     }
   `,M+=`
     }
   `,M+=`
     }
   `;let $="",V="";u&&($=c?`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${u}
         }`:f?`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${u}
         }`:`vec4 activation(vec4 x) {
           ${u}
         }`,V="result = activation(result);");let G=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),f&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${$}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${M}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${G}
         ${V}
         setOutput(result);
       }
     `}}class fo{constructor(i,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=i,this.enableShapeUniforms=pc(this.outputShape.length);let{dataFormat:u}=o,c=Yc(),f=u==="channelsLast",y=f?1:2,w=f?2:3,C=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${i[2]} && pos < ${i[1]}) {`,T="";for(let x=0;x<=1;x++)for(let A=0;A<=1;A++)T+=`
          blockIndex = rc.z + ${A};
          pos = rc.y + ${x};

          ${C}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${y}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${w}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${f}) {
                  innerDims = vec2(d1, ch);
                  result[${2*x+A}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${2*x+A}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${T}

        ${c.output} = result;
      }
    `}}function fu(l,i){let o=l.length;return o>=3?i?[...l.slice(0,-3),l[o-3]*l[o-2],l[o-1]]:[...l.slice(0,-3),l[o-3],l[o-2]*l[o-1]]:!i&&o===1&&l[0]>1?[l[0],1]:null}function b$({x:l,filter:i,convInfo:o,backend:u,bias:c=null,preluActivationWeights:f=null,leakyreluAlpha:y=0,activation:w=null}){let C=l.shape,T=u.texData.get(l.dataId),x=o.inChannels,A=C[0]*C[1]*C[2],M=o.outChannels,$=o.dataFormat==="channelsLast",V=!1,G,Q=[];if(f!=null){let nt=fu(f.shape,$);nt!=null&&(f=ri({inputs:{x:f},backend:u,attrs:{shape:nt}}),Q.push(f))}if(c!=null){let nt=fu(c.shape,$);nt!=null&&(c=ri({inputs:{x:c},backend:u,attrs:{shape:nt}}),Q.push(c))}if(!((A===1||M===1)&&x>1e3)&&T.isPacked&&$&&T.texture!=null&&C[2]%2!=0&&m.util.arraysEqual(T.shape.slice(-3),C.slice(-3))){let nt=C[0]*C[1]*(C[2]+1),it={dataId:l.dataId,shape:[1,nt,o.inChannels],dtype:l.dtype},ht=T.shape;T.shape=T.shape.slice(),T.shape[T.shape.length-2]++,m.util.assert(a_(T.shape,it.shape),()=>`packed reshape ${T.shape} to ${it.shape} isn't free`);let kt=ri({inputs:{x:i},backend:u,attrs:{shape:[1,o.inChannels,o.outChannels]}});Q.push(kt);let Nt=_x({a:it,b:kt,backend:u,transposeA:!1,transposeB:V,bias:c,activation:w,preluActivationWeights:f,leakyreluAlpha:y}),$t=u.texData.get(Nt.dataId);m.util.assert($t.isPacked,()=>"batchMatMul result is expected to be packed"),T.shape=ht,$t.shape=o.outShape,G=Pd({inputs:{x:Nt},backend:u}),G.shape=o.outShape,Q.push(Nt)}else{let nt=o.outHeight*o.outWidth,it=ri({inputs:{x:l},backend:u,attrs:{shape:$?[o.batchSize,nt,o.inChannels]:[o.batchSize,o.inChannels,nt]}}),ht=ri({inputs:{x:i},backend:u,attrs:{shape:[1,o.inChannels,o.outChannels]}}),kt=_x({a:$?it:ht,b:$?ht:it,transposeA:!$,transposeB:V,backend:u,bias:c,activation:w,preluActivationWeights:f,leakyreluAlpha:y});G=ri({inputs:{x:kt},backend:u,attrs:{shape:o.outShape}}),Q.push(it),Q.push(ht),Q.push(kt)}for(let nt of Q)u.disposeIntermediateTensorInfo(nt);return G}function Bd({x:l,filter:i,convInfo:o,backend:u,bias:c=null,preluActivationWeights:f=null,leakyreluAlpha:y=0,activation:w=null}){let{filterWidth:C,filterHeight:T,inChannels:x,outWidth:A,outHeight:M,dataFormat:$}=o,V=$==="channelsLast",G=C*T*x,Q=M*A,nt=[o.batchSize,G,Q],it=[];if(f!=null){let en=fu(f.shape,V);en!=null&&(f=ri({inputs:{x:f},backend:u,attrs:{shape:en}}),it.push(f))}if(c!=null){let en=fu(c.shape,V);en!=null&&(c=ri({inputs:{x:c},backend:u,attrs:{shape:en}}),it.push(c))}let ht=ri({inputs:{x:i},backend:u,attrs:{shape:[1,G,m.util.sizeFromShape(i.shape)/G]}});it.push(ht);let kt=new fo(nt,o),Nt=[l.shape,[o.padInfo.top,o.padInfo.left],[o.strideHeight,o.strideWidth],[o.dilationHeight,o.dilationWidth],[o.inChannels],[o.filterWidth*o.inChannels],[o.outWidth]],$t=u.runWebGLProgram(kt,[l],"float32",Nt),Ut=ri({inputs:{x:$t},backend:u,attrs:{shape:nt}});it.push($t),it.push(Ut);let Pt=c!=null,re=f!=null,ue=w==="leakyrelu",be=w?Xg(w,!0):null,De=new Kg(V?Ut.shape:ht.shape,V?ht.shape:Ut.shape,V?[o.batchSize,Q,o.outChannels]:[o.batchSize,o.outChannels,Q],!0,!1,Pt,be,re,ue),ze=V?[Ut,ht]:[ht,Ut];if(c&&ze.push(c),re&&ze.push(f),ue){let en=u.makeTensorInfo([],"float32",m.util.createScalarValue(y,"float32"));ze.push(en),it.push(en)}let Qe=u.runWebGLProgram(De,ze,"float32"),cn=ri({inputs:{x:Qe},backend:u,attrs:{shape:o.outShape}});it.push(Qe);for(let en of it)u.disposeIntermediateTensorInfo(en);return cn}let kh={kernelName:m.Conv2D,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f}=i,{strides:y,pad:w,dataFormat:C,dilations:T,dimRoundingMode:x}=u,A=m.backend_util.convertConv2DDataFormat(C),M=m.backend_util.computeConv2DInfo(c.shape,f.shape,y,T,w,x,!1,A),$;if(M.filterHeight!==1||M.filterWidth!==1||M.dilationHeight!==1||M.dilationWidth!==1||M.strideHeight!==1||M.strideWidth!==1||M.padInfo.type!=="SAME"&&M.padInfo.type!=="VALID")if(M.strideWidth<=2&&A==="channelsLast"&&(0,m.env)().getBool("WEBGL_EXP_CONV")){let G=new ao(M),Q=[[M.padInfo.top,M.padInfo.left],[M.strideHeight,M.strideWidth],[M.dilationHeight,M.dilationWidth],[M.inHeight,M.inWidth]];$=o.runWebGLProgram(G,[c,f],"float32",Q)}else if((0,m.env)().getBool("WEBGL_CONV_IM2COL"))$=Bd({x:c,filter:f,convInfo:M,backend:o});else{let G=new yb(M);$=o.runWebGLProgram(G,[c,f],"float32")}else $=b$({x:c,filter:f,convInfo:M,backend:o});let V=ri({inputs:{x:$},backend:o,attrs:{shape:M.outShape}});return o.disposeIntermediateTensorInfo($),V}};class ju{constructor(i){this.variableNames=["x","dy"],this.outputShape=i.filterShape;let o=i.strideHeight,u=i.strideWidth,c=i.padInfo.top,f=i.padInfo.left,y=i.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${i.batchSize}; b++) {
          for (int yR = 0; yR < ${i.outHeight}; yR++) {
            int xR = wR + yR * ${o} - ${c};

            if (xR < 0 || xR >= ${i.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${i.outWidth}; yC++) {
              int xC = wC + yC * ${u} - ${f};

              if (xC < 0 || xC >= ${i.inWidth}) {
                continue;
              }

              ${y?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ds{constructor(i){this.variableNames=["dy","W"],this.outputShape=i.inShape;let o=i.filterHeight,u=i.filterWidth,c=i.strideHeight,f=i.strideWidth,y=i.dataFormat==="channelsLast",w=o-1-i.padInfo.top,C=u-1-i.padInfo.left,T=y?1:2,x=y?2:3,A=y?3:1;this.userCode=`
      const ivec2 pads = ivec2(${w}, ${C});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${A}];

        ivec2 dyCorner = ivec2(coords[${T}], coords[${x}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o}; wR++) {
          float dyR = float(dyRCorner + wR) / ${c}.0;

          if (dyR < 0.0 || dyR >= ${i.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${o} - 1 - wR;

          for (int wC = 0; wC < ${u}; wC++) {
            float dyC = float(dyCCorner + wC) / ${f}.0;

            if (dyC < 0.0 || dyC >= ${i.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${u} - 1 - wC;

            for (int d2 = 0; d2 < ${i.outChannels}; d2++) {

              if (${y}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Tx{constructor(i){this.variableNames=["x","dy"],this.outputShape=i.filterShape;let o=i.strideDepth,u=i.strideHeight,c=i.strideWidth,f=i.padInfo.front,y=i.padInfo.top,w=i.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${i.batchSize}; b++) {
          for (int yF = 0; yF < ${i.outDepth}; yF++) {
            int xF = wF + yF * ${o} - ${f};

            if (xF < 0 || xF >= ${i.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${i.outHeight}; yR++) {
              int xR = wR + yR * ${u} - ${y};

              if (xR < 0 || xR >= ${i.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${i.outWidth}; yC++) {
                int xC = wC + yC * ${c} - ${w};

                if (xC < 0 || xC >= ${i.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Zg{constructor(i){this.variableNames=["dy","W"],this.outputShape=i.inShape;let o=i.filterDepth,u=i.filterHeight,c=i.filterWidth,f=i.strideDepth,y=i.strideHeight,w=i.strideWidth,C=o-1-i.padInfo.front,T=u-1-i.padInfo.top,x=c-1-i.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${C}, ${T}, ${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${o}; wF++) {
          float dyF = float(dyFCorner + wF) / ${f}.0;

          if (dyF < 0.0 || dyF >= ${i.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${o} - 1 - wF;

          for (int wR = 0; wR < ${u}; wR++) {
            float dyR = float(dyRCorner + wR) / ${y}.0;

            if (dyR < 0.0 || dyR >= ${i.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${u} - 1 - wR;

            for (int wC = 0; wC < ${c}; wC++) {
              float dyC = float(dyCCorner + wC) / ${w}.0;

              if (dyC < 0.0 || dyC >= ${i.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${c} - 1 - wC;

              for (int d2 = 0; d2 < ${i.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}let oo={kernelName:m.Conv2DBackpropFilter,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,dy:f}=i,{strides:y,pad:w,dataFormat:C,dimRoundingMode:T,filterShape:x}=u,A=m.backend_util.convertConv2DDataFormat(C),M=m.backend_util.computeConv2DInfo(c.shape,x,y,1,w,T,!1,A),$=new ju(M);return o.runWebGLProgram($,[c,f],"float32")}};class kK{constructor(i){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=i.inShape,this.enableShapeUniforms=pc(this.outputShape.length);let o=i.filterHeight,u=i.filterWidth,c=o-1-i.padInfo.top,f=u-1-i.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${c}, ${f});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${o}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${i.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${o} - 1 - wR;

          for (int wC = 0; wC < ${u}; wC++) {
            int wCPerm = ${u} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${i.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${i.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${i.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${i.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${i.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}let DA={kernelName:m.Conv2DBackpropInput,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,filter:f}=i,{inputShape:y,strides:w,pad:C,dataFormat:T,dimRoundingMode:x}=u,A=m.backend_util.convertConv2DDataFormat(T),M=m.backend_util.computeConv2DInfo(y,f.shape,w,1,C,x,!1,A);if((0,m.env)().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&A==="channelsLast"){let $=[[M.strideHeight,M.strideWidth]],V=new kK(M);return o.runWebGLProgram(V,[c,f],"float32",$)}{let $=new ds(M);return o.runWebGLProgram($,[c,f],"float32")}}},w$={kernelName:m.Conv3D,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f}=i,{strides:y,pad:w,dilations:C}=u,T=m.backend_util.computeConv3DInfo(c.shape,f.shape,y,C,w),x=new vb(T);return o.runWebGLProgram(x,[c,f],"float32")}},qa={kernelName:m.Conv3DBackpropFilterV2,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,dy:f}=i,{strides:y,pad:w,filterShape:C}=u,T=m.backend_util.computeConv3DInfo(c.shape,C,y,1,w),x=new Tx(T);return o.runWebGLProgram(x,[c,f],"float32")}},vp={kernelName:m.Conv3DBackpropInputV2,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,filter:f}=i,{pad:y,strides:w,inputShape:C}=u,T=m.backend_util.computeConv3DInfo(C,f.shape,w,1,y),x=new Zg(T);return o.runWebGLProgram(x,[c,f],"float32")}},jd=lo({opSnippet:fb+`
  return cos(x);
`,packedOpSnippet:`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${U2}
  return result;
`}),x$={kernelName:m.Cos,backendName:"webgl",kernelFunc:jd},SK=lo({opSnippet:`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`}),bp={kernelName:m.Cosh,backendName:"webgl",kernelFunc:SK};class wp{constructor(i,o,u,c,f){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[y,w,C,T]=i,[x]=o,[A,M]=u;this.outputShape=[x,A,M,T];let $=c==="bilinear"?1:0,[V,G]=[w-1+".0",C-1+".0"],[Q,nt,it]=A>1?[""+(w-1)/(A-1),"(y2-y1) * height_ratio",`y1*${V} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${V}`],[ht,kt,Nt]=M>1?[""+(C-1)/(M-1),"(x2-x1) * width_ratio",`x1*${G} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${G}`];this.userCode=`
      const float height_ratio = float(${Q});
      const float width_ratio = float(${ht});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${y}) {
          return;
        }

        float height_scale = ${nt};
        float width_scale = ${kt};

        float in_y = ${it};
        if( in_y < 0.0 || in_y > ${V} ) {
          setOutput(float(${f}));
          return;
        }
        float in_x = ${Nt};
        if( in_x < 0.0 || in_x > ${G} ) {
          setOutput(float(${f}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${$} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}let _K={kernelName:m.CropAndResize,backendName:"webgl",kernelFunc:l=>{let{inputs:i,backend:o,attrs:u}=l,{image:c,boxes:f,boxInd:y}=i,{cropSize:w,method:C,extrapolationValue:T}=u,x=new wp(c.shape,f.shape,w,C,T);return o.runWebGLProgram(x,[c,f,y],"float32")}};var Ax,RA;(RA=Ax||(Ax={})).Prod="*",RA.Sum="+";class FA{constructor(i,o,u,c){this.op=i,this.outputShape=o,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let f=this.outputShape.length,y=this.op===Ax.Prod?"1.0":"0.0",w=u?y:`getX(${OA(f,"coords",this.op)})`,C=this.outputShape[this.outputShape.length-1],T="",x="";u?(T=c?"end != "+(C-1):"end != 0",x=c?"end + 1":"end - 1"):(T=c?`end + pow2 < ${C}`:"end >= pow2",x=c?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${is(f)} coords = getOutputCoords();
        int end = ${LA(f,"coords",this.op)};
        float val = ${w};
        int pow2 = int(pow(2.0, index));
        if (${T}) {
          int idx = ${x};
          ${LA(f,"coords",this.op)} = idx;
          val ${this.op}= getX(${OA(f,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function OA(l,i,o){if(l===1)return`${i}`;if(l===2)return`${i}.x, ${i}.y`;if(l===3)return`${i}.x, ${i}.y, ${i}.z`;if(l===4)return`${i}.x, ${i}.y, ${i}.z, ${i}.w`;throw new Error(`Cumulative ${o} for rank ${l} is not yet supported`)}function LA(l,i,o){if(l===1)return`${i}`;if(l===2)return`${i}.y`;if(l===3)return`${i}.z`;if(l===4)return`${i}.w`;throw new Error(`Cumulative ${o} for rank ${l} is not yet supported`)}function Qg(l,i,o,u,c,f){let y=i.shape.length,w=m.backend_util.getAxesPermutation([u],y),C=i;w!=null&&(C=qc({inputs:{x:i},backend:o,attrs:{perm:w}}));let T=m.backend_util.getInnerMostAxes(1,y)[0];if(T!==y-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${i.shape.length-1} but got axis=${u}`);let x=C.shape[T],A=Pd({inputs:{x:C},backend:o});for(let M=0;M<=Math.ceil(Math.log2(x))-1;M++){let $=new FA(l,C.shape,!1,f),V=[[M]],G=A;A=o.runWebGLProgram($,[A],A.dtype,V),o.disposeIntermediateTensorInfo(G)}if(c){let M=new FA(l,C.shape,c,f),$=A;A=o.runWebGLProgram(M,[A],A.dtype),o.disposeIntermediateTensorInfo($)}if(w!=null){let M=qc({inputs:{x:A},backend:o,attrs:{perm:m.backend_util.getUndoAxesPermutation(w)}});return o.disposeIntermediateTensorInfo(A),o.disposeIntermediateTensorInfo(C),M}return A}let Vht={kernelName:m.Cumprod,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,exclusive:y,reverse:w}=u;return Qg(Ax.Prod,c,o,f,y,w)}},Ght={kernelName:m.Cumsum,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,exclusive:y,reverse:w}=u;return Qg(Ax.Sum,c,o,f,y,w)}},CK={kernelName:m.DenseBincount,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,weights:f}=i,{size:y,binaryOutput:w}=u;if(c.shape.length===1){let C=o.readSync(c.dataId),T=o.readSync(f.dataId),x=jL(C,T,f.dtype,f.shape,y);return o.makeTensorInfo([y],f.dtype,x)}if(c.shape.length===2){let C=o.bufferSync(c),T=o.bufferSync(f),x=Gg(C,T,y,w);return o.makeTensorInfo(x.shape,f.dtype,x.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${c.shape.length}.`)}};class Hht{constructor(i,o,u){this.variableNames=["x"],this.outputShape=[],this.outputShape=i,this.blockSize=o,this.dataFormat=u,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${o};
      int offset_h = imod(h, ${o});
      int in_w = w / ${o};
      int offset_w = imod(w, ${o});
      int offset_d = (offset_h * ${o} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}let EK={kernelName:m.DepthToSpace,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{blockSize:f,dataFormat:y}=u,w=c.shape[0],C=(y==="NHWC"?c.shape[1]:c.shape[2])*f,T=(y==="NHWC"?c.shape[2]:c.shape[3])*f,x=(y==="NHWC"?c.shape[3]:c.shape[1])/(f*f),A=new Hht(y==="NHWC"?[w,C,T,x]:[w,x,C,T],f,y);return o.runWebGLProgram(A,[c],c.dtype)}};class bb{constructor(i,o=!1,u=null,c=!1,f=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=i.outShape,this.enableShapeUniforms=pc(this.outputShape.length);let y=i.filterHeight,w=i.filterWidth,C=i.outChannels/i.inChannels,T="",x="";u&&(T=c?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${u}
        }`:f?`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${u}
        }`:`
          float activation(float x) {
            ${u}
          }
        `,x="result = activation(result);");let A=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),f&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${T}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${C};
        int q = d2 - d1 * ${C};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${y}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${w}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${A}
        ${x}
        setOutput(result);
      }
    `}}class w_{constructor(i,o=!1,u=null,c=!1,f=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=i.outShape,this.enableShapeUniforms=pc(this.outputShape.length);let y=i.outChannels/i.inChannels,w=i.padInfo.left,C=i.strideWidth,T=i.dilationWidth,x=i.filterHeight,A=i.filterWidth,M=A,$=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let nt=0;nt<A;nt++)$+=`
          vec4 xTexelC${2*nt};
          int xTexelC${2*nt}Ready;
          vec4 xTexelC${2*nt+1};
          int xTexelC${2*nt+1}Ready;
          vec4 xC${nt};`;$+=`
    for (int r = 0; r < ${x}; r++) {
      `;for(let nt=0;nt<A;nt++)$+=`
          xTexelC${2*nt} = vec4(0.0);
          xTexelC${2*nt}Ready = 0;
          xTexelC${2*nt+1} = vec4(0.0);
          xTexelC${2*nt+1}Ready = 0;
          xC${nt} = vec4(0.0);`;$+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let nt=0;nt<(M+1)/2;nt++){let it=2*nt;if($+=`
          xC = xCCorner + ${it*T};
          `,C===1){if(it<A&&(w%2==1?($+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${it}Ready == 0) {
                  xTexelC${it} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${it}.zw = vec2(0.0);
                  }
                  xTexelC${it}Ready = 1;
                }
              `,$+=T===1&&it>0?`
                xC${it} = vec4(xTexelC${it-2}.zw, xTexelC${it}.xy);
                `:`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${it} = vec4(previous.zw, xTexelC${it}.xy);
                  } else {
                    xC${it} = vec4(0.0, 0.0, xTexelC${it}.xy);
                  }
                  `):$+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${it}Ready == 0) {
                  xTexelC${it} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${it}.zw = vec2(0.0);
                  }
                  xTexelC${it}Ready = 1;
                }

                xC${it} = xTexelC${it};
                `,it+1<A)){let ht=w%2==0?m.util.nearestLargerEven(T):T;T%2==0&&w%2==1||T%2!=0&&w%2!=1?($+=`
                  xCOffset = xC + imod(pads[1], 2) + ${ht};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${it+1}Ready == 0) {
                    xTexelC${it+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${it+1}.zw = vec2(0.0);
                    }
                    xTexelC${it+1}Ready = 1;
                  }
                  `,$+=T>1?`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${it+1} = vec4(previous.zw, xTexelC${it+1}.xy);
                    } else {
                     xC${it+1} = vec4(0.0, 0.0, xTexelC${it+1}.xy);
                    }
                    `:`
                    xC${it+1} = vec4(xTexelC${it}.zw, xTexelC${it+1}.xy);
                    `):$+=ht===1?`
                    xC${it+1} = xTexelC${it};
                    `:`
                    xCOffset = xC + ${ht};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${it+1}Ready == 0) {
                      xTexelC${it+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${it+1}.zw = vec2(0.0);
                      }
                      xTexelC${it+1}Ready = 1;
                    }

                    xC${it+1} = xTexelC${it+1};
                    `}}else it<A&&(w%2==1?($+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${it}Ready == 0) {
                  xTexelC${it} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${it}.zw = vec2(0.0);
                  }
                  xTexelC${it}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${it+1}Ready == 0) {
                  xTexelC${it+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${it+1}.zw = vec2(0.0);
                  }
                  xTexelC${it+1}Ready = 1;
                }

                xC${it} = vec4(xTexelC${it}.zw, xTexelC${it+1}.zw);
              `,it+1<A&&($+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${it+1} = vec4(xTexelC${it+1}.xy, final.xy);
                `)):($+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${it}Ready == 0) {
                  xTexelC${it} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${it}.zw = vec2(0.0);
                  }
                  xTexelC${it}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${it+1}Ready == 0) {
                  xTexelC${it+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${it+1}.zw = vec2(0.);
                  }
                  xTexelC${it+1}Ready = 1;
                }

                xC${it} = vec4(
                  xTexelC${it}.xy, xTexelC${it+1}.xy);
              `,it+1<A&&($+=`
                  xC${it+1} = vec4(xTexelC${it}.zw, xTexelC${it+1}.zw);
                `)));it<A&&($+=`
            wTexel = getW(r, ${it}, d1, q);
            dotProd += xC${it} * vec4(wTexel.xz, wTexel.xz);
          `,it+1<A&&($+=`
              wTexel = getW(r, ${it+1}, d1, q);
              dotProd += xC${it+1} * vec4(wTexel.xz, wTexel.xz);
            `))}$+=`
    }
  `,$+=`
      }
    `;let V="",G="";u&&(V=c?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${u}
        }`:f?`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${u}
        }`:`vec4 activation(vec4 x) {
          ${u}
        }`,G="result = activation(result);");let Q=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),f&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${V}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${y};
        int q = d2 - d1 * ${y};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${$}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${Q}
        ${G}
        setOutput(result);
      }
    `}}let x_={kernelName:m.DepthwiseConv2dNative,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f}=i,{strides:y,pad:w,dilations:C,dimRoundingMode:T}=u,x=C;x==null&&(x=[1,1]),m.util.assert(m.backend_util.eitherStridesOrDilationsAreOne(y,x),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${y} and dilations '${x}'`);let A=m.backend_util.computeConv2DInfo(c.shape,f.shape,y,x,w,T,!0),M;M=(0,m.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&A.strideWidth<=2&&A.outChannels/A.inChannels==1?new w_(A):new bb(A);let $=[[A.padInfo.top,A.padInfo.left],[A.strideHeight,A.strideWidth],[A.dilationHeight,A.dilationWidth],[A.inHeight,A.inWidth]];return o.runWebGLProgram(M,[c,f],"float32",$)}};class $A{constructor(i){this.variableNames=["x","dy"],this.outputShape=i.filterShape;let o=i.strideHeight,u=i.strideWidth,c=i.padInfo.top,f=i.padInfo.left,y=i.outChannels/i.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${y} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${i.batchSize}; b++) {
          for (int yR = 0; yR < ${i.outHeight}; yR++) {
            int xR = wR + yR * ${o} - ${c};

            if (xR < 0 || xR >= ${i.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${i.outWidth}; yC++) {
              int xC = wC + yC * ${u} - ${f};

              if (xC < 0 || xC >= ${i.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Yht{constructor(i){this.variableNames=["dy","W"],this.outputShape=i.inShape;let o=i.filterHeight,u=i.filterWidth,c=i.strideHeight,f=i.strideWidth,y=o-1-i.padInfo.top,w=u-1-i.padInfo.left,C=i.outChannels/i.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${y}, ${w});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${o}; wR++) {
          float dyR = float(dyRCorner + wR) / ${c}.0;

          if (dyR < 0.0 || dyR >= ${i.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${o} - 1 - wR;

          for (int wC = 0; wC < ${u}; wC++) {
            float dyC = float(dyCCorner + wC) / ${f}.0;

            if (dyC < 0.0 || dyC >= ${i.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${u} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${C}; dm++) {
              int d2 = d1 * ${C} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}let zA={kernelName:m.DepthwiseConv2dNativeBackpropFilter,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,dy:f}=i,{strides:y,dilations:w,pad:C,dimRoundingMode:T,filterShape:x}=u,A=m.backend_util.computeConv2DInfo(c.shape,x,y,w,C,T,!0),M=new $A(A);return o.runWebGLProgram(M,[c,f],"float32")}},TK={kernelName:m.DepthwiseConv2dNativeBackpropInput,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,filter:f}=i,{strides:y,dilations:w,pad:C,dimRoundingMode:T,inputShape:x}=u,A=m.backend_util.computeConv2DInfo(x,f.shape,y,w,C,T,!0),M=new Yht(A);return o.runWebGLProgram(M,[c,f],"float32")}};class AK{constructor(i){this.variableNames=["X"],this.outputShape=[i,i],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}let Nm={kernelName:m.Diag,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{x:u}=i,c=[...u.shape,...u.shape],f=m.util.sizeFromShape(u.shape),y=ri({inputs:{x:u},backend:o,attrs:{shape:[f]}}),w=new AK(f),C=o.runWebGLProgram(w,[y],y.dtype),T=ri({inputs:{x:C},backend:o,attrs:{shape:c}});return o.disposeIntermediateTensorInfo(y),o.disposeIntermediateTensorInfo(C),T}};class Mm{constructor(i){this.variableNames=["x","W"],this.outputShape=i.outShape;let{inHeight:o,inWidth:u,padInfo:c,strideHeight:f,strideWidth:y,filterHeight:w,filterWidth:C,dilationHeight:T,dilationWidth:x}=i,{top:A,left:M}=c;this.userCode=`
      const ivec2 strides = ivec2(${f}, ${y});
      const ivec2 pads = ivec2(${A}, ${M});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${w}; h++) {
          int hIn = hBeg + h * ${T};

          if (hIn >= 0 && hIn < ${o}) {
            for (int w = 0; w < ${C}; w++) {
              int wIn = wBeg + w * ${x};

              if (wIn >= 0 && wIn < ${u}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}let k$={kernelName:m.Dilation2D,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f}=i,{strides:y,pad:w,dilations:C}=u,T=m.backend_util.computeDilation2DInfo(c.shape,f.shape,y,w,"NHWC",C),x,A=new Mm(T);x=o.runWebGLProgram(A,[c,f],"float32");let M=ri({inputs:{x},backend:o,attrs:{shape:T.outShape}});return o.disposeIntermediateTensorInfo(x),M}},S$={kernelName:m.Einsum,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{equation:c}=u,f=i,{allDims:y,summedDims:w,idDims:C}=m.backend_util.decodeEinsumEquation(c,f.length);m.backend_util.checkEinsumDimSizes(y.length,C,f);let{path:T,steps:x}=m.backend_util.getEinsumComputePath(w,C),A=x.length,M=null,$=y.length,V=[];for(let G=0;G<A;++G){for(let Q of x[G]){let{permutationIndices:nt,expandDims:it}=m.backend_util.getEinsumPermutation($,C[Q]),ht;m.backend_util.isIdentityPermutation(nt)?ht=f[Q]:(ht=qc({inputs:{x:f[Q]},backend:o,attrs:{perm:nt}}),V.push(ht));let kt=ht.shape.slice();for(let Nt=0;Nt<it.length;++Nt)kt.splice(it[Nt],0,1);m.util.arraysEqual(ht.shape,kt)||(ht=ri({inputs:{x:ht},backend:o,attrs:{shape:kt}}),V.push(ht)),M===null?M=ht:(M=gp({inputs:{a:ht,b:M},backend:o}),V.push(M))}G<A-1&&(T[G]>=0&&(M=y_({inputs:{x:M},backend:o,attrs:{axis:T[G]-(y.length-$),keepDims:!1}}),V.push(M)),$--)}for(let G of V)G!==M&&o.disposeIntermediateTensorInfo(G);return M}},k_=lo({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`}),PA={kernelName:m.Elu,backendName:"webgl",kernelFunc:k_},BA={kernelName:m.EluGrad,backendName:"webgl",kernelFunc:l=>{let{inputs:i,backend:o}=l,{dy:u,y:c}=i,f=(0,m.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new hb(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,u.shape,c.shape):new hs("return (b >= 0.0) ? a : a * (b + 1.0);",u.shape,c.shape);return o.runWebGLProgram(f,[u,c],u.dtype)}},Ix=Bu({opSnippet:"return float(a == b);",packedOpSnippet:`
  return vec4(equal(a, b));
`,dtype:"bool",cpuKernelImpl:B2}),_$={kernelName:m.Equal,backendName:"webgl",kernelFunc:Ix},C$=lo({opSnippet:`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${m.backend_util.ERF_P};
  float a1 = ${m.backend_util.ERF_A1};
  float a2 = ${m.backend_util.ERF_A2};
  float a3 = ${m.backend_util.ERF_A3};
  float a4 = ${m.backend_util.ERF_A4};
  float a5 = ${m.backend_util.ERF_A5};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`}),S_={kernelName:m.Erf,backendName:"webgl",kernelFunc:C$},xp=lo({opSnippet:fb+`
  return exp(x);
`,packedOpSnippet:`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cpuKernelImpl:ed,dtype:"float32"}),wb={kernelName:m.Exp,backendName:"webgl",kernelFunc:xp};function jA(l){let{inputs:i,attrs:o,backend:u}=l,{dim:c}=o,{input:f}=i,y=f.shape.length,w=f.shape.slice(),C=c;return c<0&&(m.util.assert(-(y+1)<=c,()=>`Axis must be in the interval [${-(y+1)}, ${y}]`),C=y+c+1),w.splice(C,0,1),ri({inputs:{x:f},backend:u,attrs:{shape:w}})}let qht={kernelName:m.ExpandDims,backendName:"webgl",kernelFunc:jA},IK="return exp(x) - 1.0;",NK=lo({opSnippet:IK,packedOpSnippet:IK,cpuKernelImpl:CX}),Xht={kernelName:m.Expm1,backendName:"webgl",kernelFunc:NK};class MK{constructor(i,o,u){this.variableNames=["real","imag"];let c=o[1];this.outputShape=o;let f=u?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,y=u?`${c}.0`:"1.0",w;if(i==="real")w="return real * expR - imag * expI;";else{if(i!=="imag")throw new Error(`FFT component must be either "real" or "imag", got ${i}.`);w="return real * expI + imag * expR;"}this.userCode=`
      const float exponentMultiplier = ${f};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${w}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${c});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${c}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${y};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}function DK(l,i,o){let u=o.texData.get(l.dataId),c=m.util.sizeFromShape(l.shape),f=l.shape[l.shape.length-1],y=ri({inputs:{x:l},backend:o,attrs:{shape:[c/f,f]}}),w=y.shape,C=new MK("real",w,i),T=new MK("imag",w,i),x=[{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:w},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:w}],A=o.runWebGLProgram(C,x,"float32"),M=o.runWebGLProgram(T,x,"float32"),$=W2({inputs:{real:A,imag:M},backend:o});o.disposeIntermediateTensorInfo(A),o.disposeIntermediateTensorInfo(M);let V=ri({inputs:{x:$},backend:o,attrs:{shape:l.shape}});return o.disposeIntermediateTensorInfo(y),o.disposeIntermediateTensorInfo($),V}let RK={kernelName:m.FFT,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{input:u}=i;return DK(u,!1,o)}};class FK{constructor(i,o){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=i,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}function Nx(l){let{backend:i,attrs:o}=l,{shape:u,value:c}=o,{dtype:f}=o;if(f=f||m.util.inferDtype(c),f==="string"){let y=m.util.getArrayFromDType(f,m.util.sizeFromShape(u));return y.fill(c),i.makeTensorInfo(u,f,y)}{let y=new FK(u,c),w=[[c]];return i.runWebGLProgram(y,[],f,w)}}let E$={kernelName:m.Fill,backendName:"webgl",kernelFunc:Nx};class OK{constructor(i){this.variableNames=["Image"],this.outputShape=[];let o=i[2];this.outputShape=i,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${o} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${o}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}let LK={kernelName:m.FlipLeftRight,backendName:"webgl",kernelFunc:({inputs:l,backend:i})=>{let{image:o}=l,u=i,c=new OK(o.shape);return u.runWebGLProgram(c,[o],o.dtype)}},Mx="return floor(x);",__=lo({opSnippet:Mx,packedOpSnippet:Mx,cpuKernelImpl:UL}),T$={kernelName:m.Floor,backendName:"webgl",kernelFunc:__},UA=Bu({opSnippet:`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,packedOpSnippet:`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,dtype:"int32"}),Kht={kernelName:m.FloorDiv,backendName:"webgl",kernelFunc:UA};class $K{constructor(i){this.variableNames=["A"];let o=Yc(),[u,c]=i;this.outputShape=i,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}.0, ${u}.0);

        vec4 values = ${o.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}class zK{constructor(i){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let o=Yc(),[u,c]=i;this.outputShape=i,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${c}.0, ${u}.0);
            vec4 values = ${o.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${o.output} = result;
      }
    `}}let PK={kernelName:m.FromPixels,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{pixels:c}=i,{numChannels:f}=u,y=typeof HTMLVideoElement<"u"&&c instanceof HTMLVideoElement,w=typeof HTMLImageElement<"u"&&c instanceof HTMLImageElement,[C,T]=y?[c.videoWidth,c.videoHeight]:[c.width,c.height],x=[T,C],A=[T,C,f];if(w||y){let G=(0,m.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");Jg!=null&&G===WA||(WA=G,Jg=document.createElement("canvas").getContext("2d",{willReadFrequently:WA})),Jg.canvas.width=C,Jg.canvas.height=T,Jg.drawImage(c,0,0,C,T),c=Jg.canvas}let M=o.makeTensorInfo(x,"int32");o.texData.get(M.dataId).usage=Hc.PIXELS,o.gpgpu.uploadPixelDataToTexture(o.getTexture(M.dataId),c);let $=(0,m.env)().getBool("WEBGL_PACK")?new zK(A):new $K(A),V=o.runWebGLProgram($,[M],"int32");return o.disposeData(M.dataId),V}},Jg,WA=(0,m.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU"),BK={kernelName:m.FusedConv2D,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f,bias:y,preluActivationWeights:w}=i,{strides:C,pad:T,dataFormat:x,dilations:A,dimRoundingMode:M,activation:$,leakyreluAlpha:V}=u,G=m.backend_util.convertConv2DDataFormat(x),Q=m.backend_util.computeConv2DInfo(c.shape,f.shape,C,A,T,M,!1,G),nt,it=[],ht=y!=null,kt=w!=null,Nt=$==="leakyrelu",$t=()=>{let Pt=[c,f],re=(ue,be)=>{if(be==="NCHW"&&ue.shape.length===1&&ue.shape[0]!==1){let De=ri({inputs:{x:ue},backend:o,attrs:{shape:[ue.shape[0],1,1]}});return it.push(De),De}return ue};if(ht&&Pt.push(re(y,x)),kt&&Pt.push(re(w,x)),Nt){let ue=o.makeTensorInfo([],"float32",m.util.createScalarValue(V,"float32"));Pt.push(ue),it.push(ue)}return Pt};if(Q.filterHeight!==1||Q.filterWidth!==1||Q.dilationHeight!==1||Q.dilationWidth!==1||Q.strideHeight!==1||Q.strideWidth!==1||Q.padInfo.type!=="SAME"&&Q.padInfo.type!=="VALID")if(Q.strideWidth<=2&&G==="channelsLast"&&(0,m.env)().getBool("WEBGL_EXP_CONV")){let Pt=$?Xg($,!0):null,re=new ao(Q,ht,Pt,kt,Nt),ue=[[Q.padInfo.top,Q.padInfo.left],[Q.strideHeight,Q.strideWidth],[Q.dilationHeight,Q.dilationWidth],[Q.inHeight,Q.inWidth]],be=$t();nt=o.runWebGLProgram(re,be,"float32",ue)}else if((0,m.env)().getBool("WEBGL_CONV_IM2COL"))nt=Bd({x:c,filter:f,convInfo:Q,backend:o,bias:y,activation:$,preluActivationWeights:w,leakyreluAlpha:V});else{let Pt=$?Xg($,!1):null,re=new yb(Q,ht,Pt,kt,Nt),ue=$t();nt=o.runWebGLProgram(re,ue,"float32")}else nt=b$({x:c,filter:f,convInfo:Q,backend:o,bias:y,activation:$,preluActivationWeights:w,leakyreluAlpha:V});let Ut=ri({inputs:{x:nt},backend:o,attrs:{shape:Q.outShape}});return it.push(nt),it.forEach(Pt=>o.disposeIntermediateTensorInfo(Pt)),Ut}},jK={kernelName:m.FusedDepthwiseConv2D,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f,bias:y,preluActivationWeights:w}=i,{strides:C,pad:T,dilations:x,dimRoundingMode:A,activation:M,leakyreluAlpha:$}=u,V=[],G=x;G==null&&(G=[1,1]),m.util.assert(m.backend_util.eitherStridesOrDilationsAreOne(C,G),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${C} and dilations '${G}'`);let Q=m.backend_util.computeConv2DInfo(c.shape,f.shape,C,G,T,A,!0),nt=(0,m.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&Q.strideWidth<=2&&Q.outChannels/Q.inChannels==1,it=M?Xg(M,nt):null,ht=[c,f],kt=y!=null,Nt=w!=null,$t=M==="leakyrelu";if(kt&&ht.push(y),Nt&&ht.push(w),$t){let ue=o.makeTensorInfo([],"float32",m.util.createScalarValue($,"float32"));ht.push(ue),V.push(ue)}let Ut;Ut=nt?new w_(Q,kt,it,Nt,$t):new bb(Q,kt,it,Nt,$t);let Pt=[[Q.padInfo.top,Q.padInfo.left],[Q.strideHeight,Q.strideWidth],[Q.dilationHeight,Q.dilationWidth],[Q.inHeight,Q.inWidth]],re=o.runWebGLProgram(Ut,ht,"float32",Pt);return V.forEach(ue=>o.disposeIntermediateTensorInfo(ue)),re}};class UK{constructor(i,o,u,c){this.sliceDim=i,this.strides=o,this.paramsShape=c,this.variableNames=["x","indices"],this.outputShape=u;let f=is(u.length),y=`
    int index;`;for(let w=0;w<this.sliceDim;w++)y+=`
          index = round(getIndices(coords[0], ${w}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[w]};
          flattenIndex += index * ${this.strides[w]};`;this.userCode=`
         void main() {
          ${f} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${y}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}let WK={kernelName:m.GatherNd,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{params:u,indices:c}=i,f=c.shape,y=f[f.length-1],w=m.util.sizeFromShape(u.shape),[C,T,x,A]=m.backend_util.prepareAndValidate(u,c),M=ri({inputs:{x:c},backend:o,attrs:{shape:[T,y]}}),$=ri({inputs:{x:u},backend:o,attrs:{shape:[m.util.sizeFromShape(u.shape)/x,x]}});if(o.shouldExecuteOnCPU([u,c])||u.dtype==="string"){let nt=o.readSync(c.dataId),it=o.bufferSync(u),ht=EX(nt,it,u.dtype,T,y,x,A,u.shape,w);return o.makeTensorInfo(C,u.dtype,ht.values)}let V=new UK(y,A,[T,x],u.shape),G=o.runWebGLProgram(V,[$,M],$.dtype),Q=ri({inputs:{x:G},backend:o,attrs:{shape:C}});return o.disposeIntermediateTensorInfo(M),o.disposeIntermediateTensorInfo($),o.disposeIntermediateTensorInfo(G),Q}};class VK{constructor(i,o){this.variableNames=["A","indices"],this.outputShape=o,this.rank=o.length;let u=is(this.rank),c=function(f){let y=["resRC.x","resRC.y","resRC.z","resRC.w"],w=[];for(let C=0;C<f.length;C++)C===2?w.push("index"):w.push(`${y[C]}`);return w.join()}(i);this.userCode=`
      void main() {
        ${u} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${i[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${c}));
      }
    `}}function C_(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,indices:f}=i,{axis:y,batchDims:w}=u,C=m.util.parseAxisParam(y,c.shape)[0];if((0,m.env)().get("DEBUG")){let it=o.readSync(f.dataId),ht=c.shape[C];for(let kt=0;kt<it.length;++kt){let Nt=it[kt];m.util.assert(Nt<=ht-1&&Nt>=0,()=>`GatherV2: the index value ${Nt} is not in [0, ${ht-1}]`)}}let T=m.backend_util.segment_util.collectGatherOpShapeInfo(c,f,C,w),x=m.util.sizeFromShape(f.shape),A=[],M=ri({inputs:{x:c},backend:o,attrs:{shape:[T.batchSize,T.outerSize,T.dimSize,T.sliceSize]}}),$=ri({inputs:{x:f},backend:o,attrs:{shape:[T.batchSize,x/T.batchSize]}});A.push(M),A.push($);let V=[T.batchSize,T.outerSize,x/T.batchSize,T.sliceSize];if(o.shouldExecuteOnCPU([c,f])||c.dtype==="string"){let it=o.bufferSync($),ht=o.bufferSync(M),kt=TX(ht,it,V);return A.forEach(Nt=>o.disposeIntermediateTensorInfo(Nt)),o.makeTensorInfo(T.outputShape,kt.dtype,kt.values)}let G=new VK(M.shape,V),Q=o.runWebGLProgram(G,[M,$],M.dtype);A.push(Q);let nt=ri({inputs:{x:Q},backend:o,attrs:{shape:T.outputShape}});return A.forEach(it=>o.disposeIntermediateTensorInfo(it)),nt}let VA={kernelName:m.GatherV2,backendName:"webgl",kernelFunc:C_},GK=Bu({opSnippet:"return float(a > b);",packedOpSnippet:`
  return vec4(greaterThan(a, b));
`,cpuKernelImpl:vht,dtype:"bool"}),HK={kernelName:m.Greater,backendName:"webgl",kernelFunc:GK},A$=Bu({opSnippet:"return float(a >= b);",packedOpSnippet:`
  return vec4(greaterThanEqual(a, b));
`,dtype:"bool",cpuKernelImpl:bht}),Dx={kernelName:m.GreaterEqual,backendName:"webgl",kernelFunc:A$},GA={kernelName:m.IFFT,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{input:u}=i;return DK(u,!0,o)}},HA=lo({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),I$={kernelName:m.IsFinite,backendName:"webgl",kernelFunc:HA},YA=lo({opSnippet:"return float(isinf(x));",dtype:"bool"}),N$={kernelName:m.IsInf,backendName:"webgl",kernelFunc:YA},M$=lo({opSnippet:"return float(isnan(x));",dtype:"bool"}),YK={kernelName:m.IsNan,backendName:"webgl",kernelFunc:M$},qK=Bu({opSnippet:"return float(a < b);",packedOpSnippet:`
  return vec4(lessThan(a, b));
`,cpuKernelImpl:lb,dtype:"bool"}),Zht={kernelName:m.Less,backendName:"webgl",kernelFunc:qK},Qht=Bu({opSnippet:"return float(a <= b);",packedOpSnippet:`
  return vec4(lessThanEqual(a, b));
`,cpuKernelImpl:cb,dtype:"bool"}),XK={kernelName:m.LessEqual,backendName:"webgl",kernelFunc:Qht},Jht={kernelName:m.LinSpace,backendName:"webgl",kernelFunc:function(l){let{backend:i,attrs:o}=l,{start:u,stop:c,num:f}=o,y=WL(u,c,f);return i.makeTensorInfo([y.length],"float32",y)}},KK=lo({opSnippet:fb+`
  return x < 0.0 ? 0./0. : log(x);
`,packedOpSnippet:`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,cpuKernelImpl:AX}),qA={kernelName:m.Log,backendName:"webgl",kernelFunc:KK},XA=lo({opSnippet:fb+`
  return log(1.0 + x);
`}),ZK={kernelName:m.Log1p,backendName:"webgl",kernelFunc:XA},D$=Bu({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,dtype:"bool"}),R$={kernelName:m.LogicalAnd,backendName:"webgl",kernelFunc:D$},QK=lo({opSnippet:"return float(!(x >= 1.0));"}),JK={kernelName:m.LogicalNot,backendName:"webgl",kernelFunc:QK},tZ=Bu({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,dtype:"bool"}),eZ={kernelName:m.LogicalOr,backendName:"webgl",kernelFunc:tZ};class KA{constructor(i,o,u,c,f){this.variableNames=["x"],this.outputShape=[];let y=o,w=i[3]-1,C;this.outputShape=i;let T=`float(${u}) + float(${c}) * sum`;C=f===.5?`inversesqrt(${T})`:f===1?`1.0/(${T})`:`exp(log(${T}) * float(-${f}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${y}; j <= ${y}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${w}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${C};
        setOutput(val);
      }
    `}}class F${constructor(i,o,u,c,f){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let y=o,w=i[3]-1,C;this.outputShape=i;let T=`float(${u}) + float(${c}) * sum`;C=f===.5?`inversesqrt(${T})`:f===1?`1.0/(${T})`:`exp(log(${T}) * float(-${f}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${y};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${y}; j <= ${y}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${w}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${C};
        setOutput(result);
      }
    `}}let O$={kernelName:m.LRN,backendName:"webgl",kernelFunc:l=>{let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{depthRadius:f,bias:y,alpha:w,beta:C}=u,T=(0,m.env)().getBool("WEBGL_PACK_NORMALIZATION")?new F$(c.shape,f,y,w,C):new KA(c.shape,f,y,w,C);return o.runWebGLProgram(T,[c],c.dtype)}};class ZA{constructor(i,o,u,c,f){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=i,this.depth=i[3],this.depthRadius=o,this.bias=u,this.alpha=c,this.beta=f,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${o})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${o} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${c}) * norm + float(${u});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${c})
                * float(${f})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${f});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}let L$={kernelName:m.LRNGrad,backendName:"webgl",kernelFunc:l=>{let{inputs:i,backend:o,attrs:u}=l,{x:c,y:f,dy:y}=i,{depthRadius:w,bias:C,alpha:T,beta:x}=u,A=new ZA(c.shape,w,C,T,x);return o.runWebGLProgram(A,[c,f,y],c.dtype)}};function QA(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{reductionIndices:f,keepDims:y}=u,w=c.shape.length,C=m.util.parseAxisParam(f,c.shape),T=C,x=m.backend_util.getAxesPermutation(T,w),A=x!=null,M=o.shouldExecuteOnCPU([c]),$=c;if(A){if(M){let it=o.texData.get($.dataId).values,ht=new Array(w);for(let Nt=0;Nt<ht.length;Nt++)ht[Nt]=c.shape[x[Nt]];let kt=f_(it,c.shape,c.dtype,x,ht);$=o.makeTensorInfo(ht,c.dtype),o.texData.get($.dataId).values=kt}else $=g_(c,x,o);T=m.backend_util.getInnerMostAxes(T.length,w)}m.backend_util.assertAxesAreInnerMostDims("max",T,w);let[V,G]=m.backend_util.computeOutAndReduceShapes($.shape,T),Q,nt=V;if(y&&(nt=m.backend_util.expandShapeToKeepDim(V,C)),M){let it=o.texData.get($.dataId).values,ht=IX(it,m.util.sizeFromShape(G),nt,c.dtype);Q=o.makeTensorInfo(nt,c.dtype),o.texData.get(Q.dataId).values=ht}else Q=function(it,ht,kt,Nt){let $t=m.util.sizeFromShape(ht),Ut=ri({inputs:{x:it},attrs:{shape:[m.util.sizeFromShape(it.shape)/$t,$t]},backend:Nt}),Pt=mb(Ut,it.dtype,"max",Nt),re=ri({inputs:{x:Pt},attrs:{shape:kt},backend:Nt});return Nt.disposeIntermediateTensorInfo(Ut),Nt.disposeIntermediateTensorInfo(Pt),re}($,G,nt,o);return A&&o.disposeIntermediateTensorInfo($),Q}let $$={kernelName:m.Max,backendName:"webgl",kernelFunc:QA},tdt=Bu({opSnippet:a$+`
  return max(a, b);
`,packedOpSnippet:`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+U2+`
  return result;
`,cpuKernelImpl:NX}),nZ={kernelName:m.Maximum,backendName:"webgl",kernelFunc:tdt},edt={kernelName:m.MaxPool,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i;ab(c,"maxPool");let{filterSize:f,strides:y,pad:w,dimRoundingMode:C}=u;m.util.assert(m.backend_util.eitherStridesOrDilationsAreOne(y,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${y} and dilations '1'`);let T=m.backend_util.computePool2DInfo(c.shape,f,y,1,w,C);if(T.filterWidth===1&&T.filterHeight===1&&m.util.arraysEqual(T.inShape,T.outShape))return Pd({inputs:{x:c},backend:o});let x=new yp(T,"max",!1);return o.runWebGLProgram(x,[c],c.dtype)}},rZ={kernelName:m.MaxPool3D,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{filterSize:f,strides:y,pad:w,dataFormat:C,dimRoundingMode:T}=u,x=m.backend_util.computePool3DInfo(c.shape,f,y,[1,1,1],w,T,C),A=new TA(x,"max",!1);return o.runWebGLProgram(A,[c],c.dtype)}};class t1{constructor(i){this.variableNames=["dy","maxPos"],this.outputShape=i.inShape;let o=i.strideHeight,u=i.strideWidth,c=i.dilationHeight,f=i.effectiveFilterHeight,y=i.effectiveFilterWidth,w=f-1-i.padInfo.top,C=y-1-i.padInfo.left,T=f*y-1;this.userCode=`
      const ivec2 pads = ivec2(${w}, ${C});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${f};
          wR += ${c}) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${i.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${y}; wC++) {
            float dyC = float(dyCCorner + wC) / ${u}.0;

            if (dyC < 0.0 || dyC >= ${i.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${T} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${y} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class iZ{constructor(i){this.variableNames=["dy","maxPos"],this.outputShape=i.inShape;let o=i.strideDepth,u=i.strideHeight,c=i.strideWidth,f=i.dilationDepth,y=i.dilationHeight,w=i.dilationWidth,C=i.effectiveFilterDepth,T=i.effectiveFilterHeight,x=i.effectiveFilterWidth,A=C-1-i.padInfo.front,M=T-1-i.padInfo.top,$=x-1-i.padInfo.left,V=C*T*x-1;this.userCode=`
      const ivec3 pads = ivec3(${A}, ${M}, ${$});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${C};
           wD += ${f}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${i.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${T};
              wR += ${y}) {
            float dyR = float(dyRCorner + wR) / ${u}.0;

            if (dyR < 0.0 || dyR >= ${i.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${x};
                wC += ${w}) {
              float dyC = float(dyCCorner + wC) / ${c}.0;

              if (dyC < 0.0 || dyC >= ${i.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${V} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${T} * ${x} +
                  wR * ${x} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}let z$={kernelName:m.MaxPool3DGrad,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,input:f}=i,y=f,{filterSize:w,strides:C,pad:T,dimRoundingMode:x}=u,A=m.backend_util.computePool3DInfo(y.shape,w,C,[1,1,1],T,x),M=new TA(A,"max",!0),$=o.runWebGLProgram(M,[y],y.dtype),V=new iZ(A),G=o.runWebGLProgram(V,[c,$],y.dtype);return o.disposeIntermediateTensorInfo($),G}},ndt={kernelName:m.MaxPoolGrad,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,input:f,output:y}=i,w=f;ab([f,y],"maxPoolGrad");let{filterSize:C,strides:T,pad:x,dimRoundingMode:A}=u,M=m.backend_util.computePool2DInfo(w.shape,C,T,1,x,A),$=new yp(M,"max",!0),V=o.runWebGLProgram($,[w],w.dtype),G=new t1(M),Q=o.runWebGLProgram(G,[c,V],w.dtype);return o.disposeIntermediateTensorInfo(V),Q}};let JA={kernelName:m.MaxPoolWithArgmax,backendName:"webgl",kernelFunc:({inputs:l,attrs:i,backend:o})=>{let{x:u}=l,{filterSize:c,strides:f,pad:y,includeBatchInIndex:w}=i,C=o;m.util.assert(u.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${u.shape.length}.`);let T=[1,1];m.util.assert(m.backend_util.eitherStridesOrDilationsAreOne(f,T),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${f} and dilations '${T}'`);let x=m.backend_util.computePool2DInfo(u.shape,c,f,T,y),[A,M]=function($,V,G,Q){let nt=new yp(G,"max",!1),it=Q.runWebGLProgram(nt,[$],"float32");return nt=new yp(G,"max",!0,!0,V),[it,Q.runWebGLProgram(nt,[$],"float32")]}(u,w,x,C);return[A,M]}};let aZ={kernelName:m.Mean,backendName:"webgl",kernelFunc:({inputs:l,attrs:i,backend:o})=>{let{x:u}=l,{keepDims:c,axis:f}=i,y=o,w=u.shape.length,C=m.util.parseAxisParam(f,u.shape),T=C,x=m.backend_util.getAxesPermutation(T,w),A=x!=null,M=y.shouldExecuteOnCPU([u]),$=[],V=u;if(A){if(M){let ht=y.texData.get(V.dataId).values,kt=new Array(w);for(let $t=0;$t<kt.length;$t++)kt[$t]=u.shape[x[$t]];let Nt=f_(ht,u.shape,u.dtype,x,kt);V=y.makeTensorInfo(kt,u.dtype),y.texData.get(V.dataId).values=Nt}else V=g_(u,x,y);$.push(V),T=m.backend_util.getInnerMostAxes(T.length,w)}m.backend_util.assertAxesAreInnerMostDims("sum",T,w);let[G,Q]=m.backend_util.computeOutAndReduceShapes(V.shape,T),nt=G;c&&(nt=m.backend_util.expandShapeToKeepDim(G,C));let it=function(ht,kt,Nt,$t){let Ut=m.util.sizeFromShape(kt),Pt=ri({inputs:{x:ht},attrs:{shape:[m.util.sizeFromShape(ht.shape)/Ut,Ut]},backend:$t}),re=mb(Pt,"float32","mean",$t),ue=ri({inputs:{x:re},attrs:{shape:Nt},backend:$t});return $t.disposeIntermediateTensorInfo(Pt),$t.disposeIntermediateTensorInfo(re),ue}(V,Q,nt,y);for(let ht of $)y.disposeIntermediateTensorInfo(ht);return it}},oZ={kernelName:m.Min,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,keepDims:y}=u,w=c.shape.length,C=m.util.parseAxisParam(f,c.shape),T=C,x=m.backend_util.getAxesPermutation(T,w),A=c;x!=null&&(A=qc({inputs:{x:c},backend:o,attrs:{perm:x}}),T=m.backend_util.getInnerMostAxes(T.length,c.shape.length)),m.backend_util.assertAxesAreInnerMostDims("min",T,w);let[M,$]=m.backend_util.computeOutAndReduceShapes(A.shape,T),V=ri({inputs:{x:A},backend:o,attrs:{shape:[-1,m.util.sizeFromShape($)]}}),G=mb(V,V.dtype,"min",o),Q;return y?Q=ri({inputs:{x:G},backend:o,attrs:{shape:m.backend_util.expandShapeToKeepDim(M,C)}}):Q=ri({inputs:{x:G},backend:o,attrs:{shape:M}}),o.disposeIntermediateTensorInfo(V),o.disposeIntermediateTensorInfo(G),x!=null&&o.disposeIntermediateTensorInfo(A),Q}},E_=Bu({opSnippet:a$+`
  return min(a, b);
`,packedOpSnippet:`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+U2+`
  return result;
`,cpuKernelImpl:VL}),sZ={kernelName:m.Minimum,backendName:"webgl",kernelFunc:E_};class uZ{constructor(i,o,u){this.variableNames=["x"],this.outputShape=o.map((x,A)=>x[0]+i[A]+x[1]);let c=i.length,f=is(c),y=o.map(x=>x[0]).join(","),w=o.map((x,A)=>x[0]+i[A]).join(","),C=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,c),T=u==="reflect"?0:1;this.userCode=c!==1?`
      ${f} start = ${f}(${y});
      ${f} end = ${f}(${w});

      void main() {
        ${f} outC = getOutputCoords();
        for (int i = 0; i < ${c}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${T};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${T};
          }
        }
        ${f} coords = outC - start;
        setOutput(getX(${C}));
      }
    `:`
        int start = ${y};
        int end = ${w};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${T};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${T};
          }
          setOutput(getX(outC - start));
        }
      `}}class tI{constructor(i,o,u){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o.map((V,G)=>V[0]+i[G]+V[1]);let c=i.length,f=is(c),y=o.map(V=>V[0]).join(","),w=o.map((V,G)=>V[0]+i[G]).join(","),C=Pu("rc",c),T=Pu("source",c),x=`${C[c-1]} < ${this.outputShape[c-1]}`,A=c===1?"source":`vec2(${T.slice(-2).join()})`,M=u==="reflect"?0:1,$="";if(c===1){let V=`
        ${f} source = rc;
        if (source < start) {
          source = start * 2 - source - ${M};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${M};
        }
        source -= start;
      `;$=`
        ${f} rc = outputLoc;
        ${V}
        result[0] = getChannel(getX(${T.join()}), ${A});
        ${C[c-1]} += 1;
        if(${x}) {
          ${V}
          result[1] = getChannel(getX(${T.join()}), ${A});
        }
      `}else{let V=`
        ${f} source = rc;
        ${f} lt = ${f}(lessThan(source, start));
        ${f} gte = ${f}(greaterThanEqual(source, end));
        ${f} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${M}) +
                gte * ((end - 1) * 2 - source + ${M});
        source -= start;
      `;$=`
        ${f} rc = outputLoc;
        ${V}
        result[0] = getChannel(getX(${T.join()}), ${A});
        ${C[c-1]} += 1;
        if(${x}) {
          ${V}
          result[1] = getChannel(getX(${T.join()}), ${A});
        }
        rc = outputLoc;
        ${C[c-2]} += 1;
        if(${C[c-2]} < ${this.outputShape[c-2]}) {
          ${V}
          result[2] = getChannel(getX(${T.join()}), ${A});
          ${C[c-1]} += 1;
          if(${x}) {
            ${V}
            result[3] = getChannel(getX(${T.join()}), ${A});
          }
        }
      `}this.userCode=`
      const ${f} start = ${f}(${y});
      const ${f} end = ${f}(${w});

      void main() {
        ${f} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${$}
        setOutput(result);
      }
    `}}let lZ={kernelName:m.MirrorPad,backendName:"webgl",kernelFunc:({inputs:l,backend:i,attrs:o})=>{let{x:u}=l,{paddings:c,mode:f}=o,y=(0,m.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tI(u.shape,c,f):new uZ(u.shape,c,f);return i.runWebGLProgram(y,[u],u.dtype)}},eI=Bu({opSnippet:`if (b == 0.0) return NAN;
  return mod(a, b);`,packedOpSnippet:`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+U2+`
  return result;
`}),rdt={kernelName:m.Mod,backendName:"webgl",kernelFunc:eI};class nI{constructor(i,o,u){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[i,u],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${o-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${o-1}));
      }
    `}}let cZ=Bu({opSnippet:`
if (a == b) {
  return 1.0;
};
return a / b;`,packedOpSnippet:`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,checkOutOfBounds:!0}),T_={kernelName:m.RealDiv,backendName:"webgl",kernelFunc:cZ},Rx="return a - b;",Fx=Bu({opSnippet:Rx,packedOpSnippet:Rx,supportsComplex:!0,cpuKernelImpl:PX}),A_={kernelName:m.Sub,backendName:"webgl",kernelFunc:Fx};function I_(l){let{inputs:i,backend:o,attrs:u}=l,{logits:c}=i,{dim:f}=u,y=m.util.parseAxisParam([f],c.shape),w=QA({inputs:{x:c},backend:o,attrs:{reductionIndices:y,keepDims:!1}}),C=m.backend_util.expandShapeToKeepDim(w.shape,y),T=ri({inputs:{x:w},backend:o,attrs:{shape:C}}),x=Fx({inputs:{a:c,b:T},backend:o}),A=xp({inputs:{x},backend:o}),M=y_({inputs:{x:A},backend:o,attrs:{axis:y,keepDims:!1}}),$=ri({inputs:{x:M},backend:o,attrs:{shape:C}}),V=cZ({inputs:{a:A,b:$},backend:o});return o.disposeIntermediateTensorInfo(w),o.disposeIntermediateTensorInfo(T),o.disposeIntermediateTensorInfo(x),o.disposeIntermediateTensorInfo(A),o.disposeIntermediateTensorInfo(M),o.disposeIntermediateTensorInfo($),V}let hZ={kernelName:m.Softmax,backendName:"webgl",kernelFunc:I_},dZ={kernelName:m.Multinomial,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{logits:c}=i,{numSamples:f,seed:y,normalized:w}=u,C=w?c:I_({inputs:{logits:c},backend:o,attrs:{dim:c.shape.length-1}}),T=C.shape[0],x=C.shape[1],A=new nI(T,x,f),M=[[y]],$=o.runWebGLProgram(A,[C],"int32",M);return w||o.disposeIntermediateTensorInfo(C),$}},fZ=Sf+`
  return -x;
`,pZ={kernelName:m.Neg,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{x:u}=i;if(o.shouldExecuteOnCPU([u])){let f=o.texData.get(u.dataId),[y,w]=k0(f.values,u.shape,u.dtype);return o.makeTensorInfo(w,u.dtype,y)}let c;return c=(0,m.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new qg(u.shape,`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`):new _0(u.shape,fZ),o.runWebGLProgram(c,[u],u.dtype)}},mZ=m.kernel_impls.nonMaxSuppressionV3Impl,gZ={kernelName:m.NonMaxSuppressionV3,backendName:"webgl",kernelFunc:function(l){m.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:i,backend:o,attrs:u}=l,{boxes:c,scores:f}=i,{maxOutputSize:y,iouThreshold:w,scoreThreshold:C}=u,T=o.readSync(c.dataId),x=o.readSync(f.dataId),{selectedIndices:A}=mZ(T,x,y,w,C);return o.makeTensorInfo([A.length],"int32",new Int32Array(A))}},N_=m.kernel_impls.nonMaxSuppressionV4Impl,yZ={kernelName:m.NonMaxSuppressionV4,backendName:"webgl",kernelFunc:function(l){m.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:i,backend:o,attrs:u}=l,{boxes:c,scores:f}=i,{maxOutputSize:y,iouThreshold:w,scoreThreshold:C,padToMaxOutputSize:T}=u,x=o.readSync(c.dataId),A=o.readSync(f.dataId),{selectedIndices:M,validOutputs:$}=N_(x,A,y,w,C,T);return[o.makeTensorInfo([M.length],"int32",new Int32Array(M)),o.makeTensorInfo([],"int32",new Int32Array([$]))]}},_u=m.kernel_impls.nonMaxSuppressionV5Impl,Lo={kernelName:m.NonMaxSuppressionV5,backendName:"webgl",kernelFunc:function(l){m.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:i,backend:o,attrs:u}=l,{boxes:c,scores:f}=i,{maxOutputSize:y,iouThreshold:w,scoreThreshold:C,softNmsSigma:T}=u,x=o.readSync(c.dataId),A=o.readSync(f.dataId),M=y,$=w,V=C,G=T,{selectedIndices:Q,selectedScores:nt}=_u(x,A,M,$,V,G);return[o.makeTensorInfo([Q.length],"int32",new Int32Array(Q)),o.makeTensorInfo([nt.length],"float32",new Float32Array(nt))]}};class kp{constructor(i,o,u,c){this.variableNames=["indices"],this.outputShape=[i,o],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${c}), float(${u}),
                      float(index == coords.y)));
      }
    `}}let vZ={kernelName:m.OneHot,backendName:"webgl",kernelFunc:l=>{let{inputs:i,backend:o,attrs:u}=l,{indices:c}=i,{dtype:f,depth:y,onValue:w,offValue:C}=u,T=m.util.sizeFromShape(c.shape),x=new kp(T,y,w,C),A=ri({inputs:{x:c},backend:o,attrs:{shape:[T]}}),M=o.runWebGLProgram(x,[A],f);o.disposeIntermediateTensorInfo(A);let $=ri({inputs:{x:M},backend:o,attrs:{shape:[...c.shape,y]}});return o.disposeIntermediateTensorInfo(M),$}};function Ud(l){let{inputs:i,backend:o}=l,{x:u}=i;if(u.dtype==="complex64"){let c=Cx({inputs:{input:u},backend:o}),f=Ud({inputs:{x:c},backend:o}),y=gb({inputs:{input:u},backend:o}),w=Ud({inputs:{x:y},backend:o}),C=W2({inputs:{real:f,imag:w},backend:o});return o.disposeIntermediateTensorInfo(c),o.disposeIntermediateTensorInfo(f),o.disposeIntermediateTensorInfo(y),o.disposeIntermediateTensorInfo(w),C}return Nx({attrs:{shape:u.shape,dtype:u.dtype,value:u.dtype==="string"?"":0},backend:o})}let e1={kernelName:m.ZerosLike,backendName:"webgl",kernelFunc:Ud},_f={kernelName:m.OnesLike,backendName:"webgl",kernelFunc:function l(i){let{inputs:o,backend:u}=i,{x:c}=o;if(c.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(c.dtype==="complex64"){let f=Cx({inputs:{input:c},backend:u}),y=l({inputs:{x:f},backend:u}),w=gb({inputs:{input:c},backend:u}),C=Ud({inputs:{x:w},backend:u}),T=W2({inputs:{real:y,imag:C},backend:u});return u.disposeIntermediateTensorInfo(f),u.disposeIntermediateTensorInfo(y),u.disposeIntermediateTensorInfo(w),u.disposeIntermediateTensorInfo(C),T}return Nx({attrs:{shape:c.shape,dtype:c.dtype,value:1},backend:u})}},rl={kernelName:m.Pack,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{axis:c}=u;if(i.length===1)return jA({inputs:{input:i[0]},backend:o,attrs:{dim:c}});let f=i[0].shape,y=i[0].dtype;i.forEach(T=>{m.util.assertShapesMatch(f,T.shape,"All tensors passed to stack must have matching shapes"),m.util.assert(y===T.dtype,()=>"All tensors passed to stack must have matching dtypes")});let w=[],C=MA({inputs:i.map(T=>{let x=jA({inputs:{input:T},backend:o,attrs:{dim:c}});return w.push(x),x}),backend:o,attrs:{axis:c}});return w.forEach(T=>o.disposeIntermediateTensorInfo(T)),C}};class idt{constructor(i,o,u){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=o.map((T,x)=>T[0]+i[x]+T[1]);let c=i.length,f=is(c),y=o.map(T=>T[0]).join(","),w=o.map((T,x)=>T[0]+i[x]).join(","),C=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,c);this.userCode=c!==1?`
      ${f} start = ${f}(${y});
      ${f} end = ${f}(${w});

      void main() {
        ${f} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${f} coords = outC - start;
          setOutput(getX(${C}));
        }
      }
    `:`
        int start = ${y};
        int end = ${w};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `}}class M_{constructor(i,o,u){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=o.map((G,Q)=>G[0]+i[Q]+G[1]);let c=i.length,f=is(c),y=o.map(G=>G[0]).join(","),w=o.map((G,Q)=>G[0]+i[Q]).join(","),C=Pu("rc",c),T=Pu("source",c),x=`${C[c-1]} < ${this.outputShape[c-1]}`,A=c===1?"source":`vec2(${T.slice(-2).join()})`,M=[`${f} rc = outputLoc;`,`${C[c-1]} += 1;
       if(${x}) {
      `,c===1?"":`}
       rc = outputLoc;
       ${C[c-2]} += 1;
       if(${C[c-2]} < ${this.outputShape[c-2]}) {`,c===1?"":`  ${C[c-1]} += 1;
         if(${x}) {`],$=c===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",V="";for(let G=0,Q=c===1?2:4;G<Q;G++)V+=`
        ${M[G]}
        if (${$}) {
          result[${G}] = float(value);
        } else {
          ${f} source = rc - start;
          result[${G}] = getChannel(getX(${T.join()}), ${A});
        }
      `;V+=c===1?"} ":"}}",this.userCode=`
      const ${f} start = ${f}(${y});
      const ${f} end = ${f}(${w});

      void main() {
        ${f} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${V}
        setOutput(result);
      }
    `}}let il=l=>{let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{paddings:f,constantValue:y}=u;if(m.util.sizeFromShape(c.shape)===0)return Nx({backend:o,attrs:{shape:f.map((T,x)=>T[0]+c.shape[x]+T[1]),value:y,dtype:c.dtype}});let w=(0,m.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new M_(c.shape,f,y):new idt(c.shape,f,y),C=[[y]];return o.runWebGLProgram(w,[c],c.dtype,C)},gl={kernelName:m.PadV2,backendName:"webgl",kernelFunc:il},adt=Bu({opSnippet:`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,packedOpSnippet:`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+U2+`
  return result;
`}),rI={kernelName:m.Pow,backendName:"webgl",kernelFunc:adt},D_={kernelName:m.Prod,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,keepDims:y}=u,w=c.shape.length,C=[],T=m.util.parseAxisParam(f,c.shape),x=T,A=m.backend_util.getAxesPermutation(x,w),M,$=c;if(A!=null&&($=qc({inputs:{x:c},backend:o,attrs:{perm:A}}),x=m.backend_util.getInnerMostAxes(x.length,w),C.push($)),m.backend_util.assertAxesAreInnerMostDims("prod",x,w),o.shouldExecuteOnCPU([$])){let V=o.texData.get($.dataId).values,{outVals:G,outShape:Q,outDtype:nt}=j2($.shape,$.dtype,V,x);M=o.makeTensorInfo(Q,nt,G)}else{let[V,G]=m.backend_util.computeOutAndReduceShapes($.shape,x),Q=m.util.sizeFromShape(G),nt=ri({inputs:{x:$},backend:o,attrs:{shape:[-1,Q]}}),it=mb(nt,(0,m.sumOutType)(c.dtype),"prod",o);M=ri({inputs:{x:it},backend:o,attrs:{shape:V}}),C.push(nt),C.push(it)}if(y){C.push(M);let V=m.backend_util.expandShapeToKeepDim(M.shape,T);M=ri({inputs:{x:M},backend:o,attrs:{shape:V}})}return C.forEach(V=>o.disposeIntermediateTensorInfo(V)),M}},iI={kernelName:m.RaggedGather,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{paramsNestedSplits:c,paramsDenseValues:f,indices:y}=i,{outputRaggedRank:w}=u,C=c.map(nt=>o.readSync(nt.dataId)),T=c.map(nt=>nt.shape),x=o.readSync(f.dataId),A=o.readSync(y.dataId),[M,$,V]=GL(C,T,x,f.shape,f.dtype,A,y.shape,w),G=M.map(nt=>o.makeTensorInfo([nt.length],"int32",nt)),Q=o.makeTensorInfo(V,f.dtype,$);return G.concat([Q])}},aI={kernelName:m.RaggedRange,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{starts:u,limits:c,deltas:f}=i,y=o.readSync(u.dataId),w=o.readSync(c.dataId),C=o.readSync(f.dataId),[T,x]=HL(y,u.shape,u.dtype,w,c.shape,C,f.shape);return[o.makeTensorInfo([T.length],"int32",T),o.makeTensorInfo([x.length],u.dtype,x)]}},bZ={kernelName:m.RaggedTensorToTensor,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{shape:c,values:f,defaultValue:y,rowPartitionTensors:w}=i,{rowPartitionTypes:C}=u,T=o.readSync(c.dataId),x=o.readSync(f.dataId),A=o.readSync(y.dataId),M=w.map(Q=>o.readSync(Q.dataId)),$=w.map(Q=>Q.shape),[V,G]=nd(T,c.shape,x,f.shape,f.dtype,A,y.shape,M,$,C);return o.makeTensorInfo(V,f.dtype,G)}},P$=l=>{let{backend:i,attrs:o}=l,{start:u,stop:c,step:f,dtype:y}=o,w=bA(u,c,f,y);return i.makeTensorInfo([w.length],y,w)},odt={kernelName:m.Range,backendName:"webgl",kernelFunc:P$},B$=lo({opSnippet:"return 1.0 / x;"}),Ox={kernelName:m.Reciprocal,backendName:"webgl",kernelFunc:B$},oI=lo({opSnippet:Sf+`
  return (x < 0.0) ? 0.0 : x;
`,packedOpSnippet:`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`}),sI={kernelName:m.Relu,backendName:"webgl",kernelFunc:oI},j$=lo({opSnippet:Sf+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,packedOpSnippet:`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`}),uI={kernelName:m.Relu6,backendName:"webgl",kernelFunc:j$};class U${constructor(i,o,u,c,f){this.variableNames=["A"],this.outputShape=[];let[y,w,C,T]=i;this.outputShape=[y,o,u,T];let x=[c&&o>1?w-1:w,c&&u>1?C-1:C],A=[c&&o>1?o-1:o,c&&u>1?u-1:u],M;M=f?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${x[0]/A[0]},
          ${x[1]/A[1]});
      const vec2 inputShapeRC = vec2(${w}.0, ${C}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${M};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}class W${constructor(i,o,u,c,f){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[y,w,C,T]=i;this.outputShape=[y,o,u,T];let x=[c&&o>1?w-1:w,c&&u>1?C-1:C],A=[c&&o>1?o-1:o,c&&u>1?u-1:u],M;M=f?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${x[0]/A[0]},
          ${x[1]/A[1]},
          ${x[1]/A[1]});
      const vec3 inputShapeRC = vec3(${w}.0, ${C}.0,
                                     ${C}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${M};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${T-1};
        bool hasNextRow = coords.z < ${u-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}let wZ={kernelName:m.ResizeBilinear,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{images:c}=i,{alignCorners:f,halfPixelCenters:y,size:w}=u,[C,T]=w,x=(0,m.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new W$(c.shape,C,T,f,y):new U$(c.shape,C,T,f,y);return o.runWebGLProgram(x,[c],"float32")}};class xZ{constructor(i,o,u){this.variableNames=["dy"],this.outputShape=[],this.outputShape=o;let[,c,f]=o,[,y,w]=i,C=[u&&y>1?c-1:c,u&&w>1?f-1:f],T=[u&&y>1?y-1:y,u&&w>1?w-1:w],x=C[0]/T[0],A=C[1]/T[1],M=1/x,$=1/A,V=2*Math.ceil(M)+2,G=2*Math.ceil($)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${x});
        const float widthScale = float(${A});

        const float invHeightScale = float(${M});
        const float invWidthScale = float(${$});

        const int winHeight = int(${V});
        const int winWidth = int(${G});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${y}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${w}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${c-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${f-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}let sdt={kernelName:m.ResizeBilinearGrad,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{images:c,dy:f}=i,{alignCorners:y}=u,w=new xZ(f.shape,c.shape,y);return o.runWebGLProgram(w,[f],f.dtype)}};class udt{constructor(i,o,u,c,f){this.variableNames=["A"],this.outputShape=[];let[y,w,C,T]=i;this.outputShape=[y,o,u,T];let x=[c&&o>1?w-1:w,c&&u>1?C-1:C],A=[c&&o>1?o-1:o,c&&u>1?u-1:u],M=c?"0.5":"0.0",$;$=f?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${x[0]/A[0]},
          ${x[1]/A[1]});
      const vec2 inputShapeRC = vec2(${w}.0, ${C}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${$};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${M})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}class kZ{constructor(i,o,u,c,f){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[y,w,C,T]=i;this.outputShape=[y,o,u,T];let x=[c&&o>1?w-1:w,c&&u>1?C-1:C],A=[c&&o>1?o-1:o,c&&u>1?u-1:u],M=c?"0.5":"0.0",$;$=f?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${x[0]/A[0]},
          ${x[1]/A[1]},
          ${x[1]/A[1]});
      const vec3 inputShapeRC = vec3(${w}.0, ${C}.0,
                                     ${C}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${$};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${M})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${T-1};
        bool hasNextRow = coords.z < ${u-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}let ldt={kernelName:m.ResizeNearestNeighbor,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{images:c}=i,{alignCorners:f,halfPixelCenters:y,size:w}=u,[C,T]=w,x=(0,m.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new kZ(c.shape,C,T,f,y):new udt(c.shape,C,T,f,y);return o.runWebGLProgram(x,[c],c.dtype)}};class SZ{constructor(i,o,u){this.variableNames=["dy"],this.outputShape=[],this.outputShape=o;let[,c,f]=o,[,y,w]=i,C=[u&&y>1?c-1:c,u&&w>1?f-1:f],T=[u&&y>1?y-1:y,u&&w>1?w-1:w],x=C[0]/T[0],A=C[1]/T[1],M=1/x,$=1/A,V=2*Math.ceil(M)+2,G=2*Math.ceil($)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${x});
        const float widthScale = float(${A});

        const float invHeightScale = float(${M});
        const float invWidthScale = float(${$});

        const int winHeight = int(${V});
        const int winWidth = int(${G});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${y}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${w}) {
              continue;
            }

            float sourceFracRow =
              float(${C[0]}) *
                (float(dyR) / float(${T[0]}));

            float sourceFracCol =
                float(${C[1]}) *
                  (float(dyC) / float(${T[1]}));

            int sourceNearestRow = int(min(
                float(int(${c}) - 1),
                ${u} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${f}) - 1),
                ${u} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}let lI={kernelName:m.ResizeNearestNeighborGrad,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{images:c,dy:f}=i,{alignCorners:y}=u,w=new SZ(f.shape,c.shape,y);return o.runWebGLProgram(w,[f],f.dtype)}};class cI{constructor(i,o){this.variableNames=["x"];let u=i.length;if(u>4)throw new Error(`WebGL backend: Reverse of rank-${u} tensor is not yet supported`);if(this.outputShape=i,u===1)return void(this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${i[0]} - coord - 1));
        }
      `);let c=i.map((y,w)=>(C=>o.indexOf(C)!==-1&&i[C]!==1?`${i[C]} - coords[${C}] - 1`:`coords[${C}]`)(w)).join(","),f=is(u);this.userCode=`
      void main() {
        ${f} coords = getOutputCoords();
        setOutput(getX(${c}));
      }
    `}}class cdt{constructor(i,o){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let u=i.length;if(u>4)throw new Error(`WebGL backend: Reverse of rank-${u} tensor is not yet supported`);this.outputShape=i;let c=Pu("rc",u),f=`${c[u-1]} + 1 < ${this.outputShape[u-1]}`,y=`${c[u-2]} + 1 < ${this.outputShape[u-2]}`,w=is(u);function C(T){let x=i.map((A,M)=>function($,V){return o.indexOf($)!==-1&&i[$]!==1?`${i[$]} - ${V[$]} - 1`:`${V[$]}`}(M,T));return`getChannel(getX(${x.join(",")}), vec2(${x.slice(-2).join(",")}))`}this.userCode=u===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${i[0]} - rc - 1),
            ${i[0]} - rc - 1);
          if(${f}){
              result.g = getChannel(getX(${i[0]} - (rc  + 1) - 1),
                ${i[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          ${w} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${function(T){return C(T)}(c.slice())};
          if(${f}){
            result.g = ${function(T){return T[u-1]="("+T[u-1]+" + 1)",C(T)}(c.slice())};
          }
          if(${y}) {
            result.b = ${function(T){return T[u-2]="("+T[u-2]+" + 1)",C(T)}(c.slice())};
            if(${f}) {
              result.a = ${function(T){return T[u-1]="("+T[u-1]+" + 1)",T[u-2]="("+T[u-2]+" + 1)",C(T)}(c.slice())};
            }
          }
          setOutput(result);
        }
    `}}let V$={kernelName:m.Reverse,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{dims:f}=u,y=c.shape.length,w=m.util.parseAxisParam(f,c.shape);if(y===0)return Pd({inputs:{x:c},backend:o});let C=(0,m.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new cdt(c.shape,w):new cI(c.shape,w);return o.runWebGLProgram(C,[c],c.dtype)}};class _Z{constructor(i,o){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let u=i[1],c=i[2];this.outputShape=i;let f="";f=typeof o=="number"?`float outputValue = ${o.toFixed(2)};`:`
        vec3 fill = vec3(${o.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${f}
          if(coordX >= 0 && coordX < ${c} && coordY >= 0 && coordY < ${u}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}let G$={kernelName:m.RotateWithOffset,backendName:"webgl",kernelFunc:({inputs:l,attrs:i,backend:o})=>{let{image:u}=l,{radians:c,fillValue:f,center:y}=i,w=o,C=new _Z(u.shape,f),[T,x]=m.backend_util.getImageCenter(y,u.shape[1],u.shape[2]),A=[[T,x,Math.sin(c),Math.cos(c)]];return w.runWebGLProgram(C,[u],u.dtype,A)}},hdt=lo({opSnippet:`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`}),CZ={kernelName:m.Round,backendName:"webgl",kernelFunc:hdt},EZ=lo({opSnippet:"return inversesqrt(x);",cpuKernelImpl:YL}),TZ={kernelName:m.Rsqrt,backendName:"webgl",kernelFunc:EZ};class R_{constructor(i,o,u,c,f,y,w=!0,C=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=y;let T=is(f.length),x=is(y.length),A="";u===1?A="i":u===2&&(A="i, j");let M=`getIndices(${A})`,$="";c===1?$="i":c===2&&($="i, coords[1]");let V=`getUpdates(${$})`,G="";C&&(G="coords[0], coords[1]");let Q=`getDefaultValue(${G})`,nt=o>1?"strides[j]":"strides";this.userCode=`
        ${T} strides = ${T}(${f});

        void main() {
          ${x} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${i}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${o}; j++) {
              int index = round(${M});
              flattenedIndex += index * ${nt};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${V};
              found = true;
            }
          }
          setOutput(mix(${Q}, sum, float(found)));
        }
      `}}class H${constructor(i,o,u,c,f,y,w=!0,C=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=y;let T=is(f.length),x=is(y.length),A="";u===1?A="i":u===2&&(A="i, j");let M=`getIndices(${A})`,$="";c===1?$="i":c===2&&($="i, coords[1]");let V=`getUpdates(${$})`,G="";C&&(G="coords[0], coords[1]");let Q=`getDefaultValue(${G})`,nt=o>1?"strides[j]":"strides",it=o>1?"strides[j + 1]":"strides";this.userCode=`
        ${T} strides = ${T}(${f});

        void main() {
          ${x} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${i}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${o}; j+=2) {
              ivec4 index = round(${M});
              flattenedIndex += index.xz * ${nt};
              if (j + 1 < ${o}) {
                flattenedIndex += index.yw * ${it};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${V};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${Q}, sum, found));
        }
      `}}let hI={kernelName:m.ScatterNd,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{indices:c,updates:f}=i,{shape:y}=u,{sliceRank:w,numUpdates:C,sliceSize:T,strides:x,outputSize:A}=m.backend_util.calculateShapes(f,c,y),M=[A/T,T];if(A===0)return o.makeTensorInfo(y,c.dtype);let $=ri({inputs:{x:c},backend:o,attrs:{shape:[C,w]}}),V=ri({inputs:{x:f},backend:o,attrs:{shape:[C,T]}}),G=o.makeTensorInfo([],"float32",new Float32Array([0])),Q;Q=(0,m.env)().getBool("WEBGL_PACK")?new H$(C,w,$.shape.length,V.shape.length,x,M):new R_(C,w,$.shape.length,V.shape.length,x,M);let nt=o.runWebGLProgram(Q,[V,$,G],V.dtype),it=ri({inputs:{x:nt},backend:o,attrs:{shape:y}});return o.disposeIntermediateTensorInfo($),o.disposeIntermediateTensorInfo(V),o.disposeIntermediateTensorInfo(nt),o.disposeIntermediateTensorInfo(G),it}};class AZ{constructor(i,o,u,c){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[i,u];let f=`for (int i = 0; i < ${Math.ceil(Math.log2(o+1))}; ++i) { if (left >= right) break;`,y=(0,m.env)().getNumber("WEBGL_VERSION")===2?"while (left < right) {":f,w=c==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${y}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${w} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}let IZ={kernelName:m.SearchSorted,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{sortedSequence:c,values:f}=i,{side:y}=u,w=new AZ(c.shape[0],c.shape[1],f.shape[1],y),C=[[c.shape[1]]];return o.runWebGLProgram(w,[c,f],"int32",C)}};class Y${constructor(i,o,u){let c,f;if(this.variableNames=["c","a","b"],this.outputShape=o,u>4)throw Error(`Where for rank ${u} is not yet supported`);if(u===1)f="resRC",c="resRC";else{let w=["resRC.x","resRC.y","resRC.z","resRC.w"],C=[],T=[];for(let x=0;x<o.length;x++)T.push(`${w[x]}`),x<i&&C.push(`${w[x]}`);c=C.join(),f=T.join()}let y=is(u);this.userCode=`
      void main() {
        ${y} resRC = getOutputCoords();
        float cVal = getC(${c});
        if (cVal >= 1.0) {
          setOutput(getA(${f}));
        } else {
          setOutput(getB(${f}));
        }
      }
    `}}let NZ={kernelName:m.Select,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{condition:u,t:c,e:f}=i,y=new Y$(u.shape.length,c.shape,c.shape.length);return o.runWebGLProgram(y,[u,c,f],(0,m.upcastType)(c.dtype,f.dtype))}},Lx=lo({opSnippet:`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${m.backend_util.SELU_SCALEALPHA};
  float scale = ${m.backend_util.SELU_SCALE};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`}),dI={kernelName:m.Selu,backendName:"webgl",kernelFunc:Lx},F_=lo({opSnippet:fb+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,packedOpSnippet:`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cpuKernelImpl:wht}),fI={kernelName:m.Sigmoid,backendName:"webgl",kernelFunc:F_},ddt=lo({opSnippet:`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`}),MZ={kernelName:m.Sign,backendName:"webgl",kernelFunc:ddt},q$=lo({opSnippet:fb+`
  return sin(x);
`,packedOpSnippet:`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${U2}
  return result;
`}),DZ={kernelName:m.Sin,backendName:"webgl",kernelFunc:q$},fdt=lo({opSnippet:`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`}),RZ={kernelName:m.Sinh,backendName:"webgl",kernelFunc:fdt},pdt=lo({opSnippet:`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`}),FZ={kernelName:m.Softplus,backendName:"webgl",kernelFunc:pdt},mdt={kernelName:m.SpaceToBatchND,backendName:"webgl",kernelFunc:l=>{let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{blockShape:f,paddings:y}=u;m.util.assert(c.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let w=f.reduce((nt,it)=>nt*it),C=[[0,0]];C.push(...y);for(let nt=1+f.length;nt<c.shape.length;++nt)C.push([0,0]);let T=[],x=il({inputs:{x:c},backend:o,attrs:{paddings:C,constantValue:0}}),A=m.backend_util.getReshaped(x.shape,f,w,!1),M=m.backend_util.getPermuted(A.length,f.length,!1),$=m.backend_util.getReshapedPermuted(x.shape,f,w,!1),V=ri({inputs:{x},backend:o,attrs:{shape:A}}),G=qc({inputs:{x:V},backend:o,attrs:{perm:M}}),Q=ri({inputs:{x:G},backend:o,attrs:{shape:$}});return T.push(x),T.push(V),T.push(G),T.forEach(nt=>o.disposeIntermediateTensorInfo(nt)),Q}},gdt={kernelName:m.SparseFillEmptyRows,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{indices:u,values:c,denseShape:f,defaultValue:y}=i;if(f.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${f.shape}`);if(u.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${u.shape}`);if(c.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${c.shape}`);if(y.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${y.shape}`);let w=o.readSync(u.dataId),C=o.readSync(c.dataId),T=o.readSync(f.dataId),x=o.readSync(y.dataId)[0],[A,M,$,V,G]=DX(w,u.shape,u.dtype,C,c.dtype,T,x);return[o.makeTensorInfo(M,u.dtype,A),o.makeTensorInfo([M[0]],c.dtype,$),o.makeTensorInfo([V.length],"bool",new Uint8Array(V.map(Q=>Number(Q)))),o.makeTensorInfo([G.length],u.dtype,new Int32Array(G))]}},X$={kernelName:m.SparseReshape,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{inputIndices:u,inputShape:c,newShape:f}=i;if(u.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${u.shape}`);if(c.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${c.shape}`);if(f.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${f.shape}`);let y=Array.from(o.readSync(c.dataId)),w=o.readSync(u.dataId),C=Array.from(o.readSync(f.dataId)),[T,x,A]=RX(w,u.shape,u.dtype,y,C);return[o.makeTensorInfo(x,u.dtype,T),o.makeTensorInfo([A.length],f.dtype,new Int32Array(A))]}},pI={kernelName:m.SparseSegmentMean,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{data:u,indices:c,segmentIds:f}=i;if(u.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(c.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${c.shape}`);if(f.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${f.shape}`);let y=o.readSync(u.dataId),w=o.readSync(c.dataId),C=o.readSync(f.dataId),[T,x]=KL(y,u.shape,u.dtype,w,C,!0);return o.makeTensorInfo(x,u.dtype,T)}},OZ={kernelName:m.SparseSegmentSum,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{data:u,indices:c,segmentIds:f}=i;if(u.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(c.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${c.shape}`);if(f.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${f.shape}`);let y=o.readSync(u.dataId),w=o.readSync(c.dataId),C=o.readSync(f.dataId),[T,x]=KL(y,u.shape,u.dtype,w,C);return o.makeTensorInfo(x,u.dtype,T)}},K$={kernelName:m.SparseToDense,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{sparseIndices:c,sparseValues:f,defaultValue:y}=i,{outputShape:w}=u,{sliceRank:C,numUpdates:T,sliceSize:x,strides:A,outputSize:M}=m.backend_util.calculateShapes(f,c,w),$=!1;if(f.dtype==="string"){let nt=o.bufferSync(c),it=o.bufferSync(f),ht=m.util.decodeString(o.readSync(y.dataId)[0]),kt=qL(nt,it,w,M,x,T,C,A,ht,$);return o.makeTensorInfo(w,kt.dtype,kt.values)}let V=new R_(T,C,c.shape.length,f.shape.length,A,[M,1],$),G=o.runWebGLProgram(V,[f,c,y],f.dtype),Q=ri({inputs:{x:G},backend:o,attrs:{shape:w}});return o.disposeIntermediateTensorInfo(G),Q}},LZ={kernelName:m.SplitV,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{numOrSizeSplits:f,axis:y}=u,w=m.util.parseAxisParam(y,c.shape)[0],C=m.backend_util.prepareSplitSize(c,f,w),T=c.shape.length,x=new Array(T).fill(0),A=c.shape.slice();return C.map(M=>{let $=[...A];$[w]=M;let V=G2({inputs:{x:c},backend:o,attrs:{begin:x,size:$}});return x[w]+=M,V})}},Z$="return sqrt(x);",ydt=lo({opSnippet:Z$,packedOpSnippet:Z$,cpuKernelImpl:FX}),vdt={kernelName:m.Sqrt,backendName:"webgl",kernelFunc:ydt},bdt=lo({opSnippet:"return x * x;"}),wdt={kernelName:m.Square,backendName:"webgl",kernelFunc:bdt},mI="return (a - b) * (a - b);",$Z=Bu({opSnippet:mI,packedOpSnippet:mI}),zZ={kernelName:m.SquaredDifference,backendName:"webgl",kernelFunc:$Z},gI={kernelName:m.StaticRegexReplace,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i;if(c.dtype!=="string")throw new Error("Input must be of datatype string");let f=o.readSync(c.dataId),y=m.backend_util.fromUint8ToStringArray(f),w=OX(y,"string",u);return o.makeTensorInfo(c.shape,"string",w)}},ba={kernelName:m.Step,backendName:"webgl",kernelFunc:function({inputs:l,attrs:i,backend:o}){let{x:u}=l,c=Sf+`
    return x > 0.0 ? 1.0 : float(${i.alpha});
  `,f=new _0(u.shape,c);return o.runWebGLProgram(f,[u],u.dtype)}};class Q${constructor(i,o,u){this.variableNames=["x"],this.outputShape=u;let c=u.length,f=is(u.length),y=is(u.length),w="";if(c===1)w="coords * strides + begin";else{let C=0;w=u.map((T,x)=>(C++,u.length===1?`coords * strides[${x}] + begin[${x}]`:`coords[${C-1}] * strides[${x}] + begin[${x}]`)).join(",")}this.userCode=`
      ${f} begin = ${f}(${i});
      ${f} strides = ${f}(${o});

      void main() {
        ${y} coords = getOutputCoords();
        setOutput(getX(${w}));
      }
    `}}let co={kernelName:m.StridedSlice,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{begin:f,end:y,strides:w,beginMask:C,endMask:T,ellipsisMask:x,newAxisMask:A,shrinkAxisMask:M}=u,{finalShapeSparse:$,finalShape:V,isIdentity:G,sliceDim0:Q,isSimpleSlice:nt,begin:it,end:ht,strides:kt}=m.slice_util.sliceInfo(c.shape,f,y,w,C,T,x,A,M),Nt;if(G)Nt=ri({inputs:{x:c},backend:o,attrs:{shape:V}});else if(Q||nt){m.util.assert(c.shape.length>=1,()=>`Input must have rank at least 1, got: ${c.shape.length}`);let Ut=m.slice_util.computeOutShape(it,ht,kt),Pt=G2({inputs:{x:c},backend:o,attrs:{begin:it,size:Ut}});Nt=ri({inputs:{x:Pt},backend:o,attrs:{shape:V}}),o.disposeIntermediateTensorInfo(Pt)}else if(o.shouldExecuteOnCPU([c])){let Ut=o.readSync(c.dataId),Pt=(0,m.buffer)(c.shape,c.dtype,Ut),re=LX($,Pt,kt,it);Nt=o.makeTensorInfo(V,c.dtype,re.values)}else{let Ut=new Q$(it,kt,$);Nt=o.runWebGLProgram(Ut,[c],c.dtype)}let $t=ri({inputs:{x:Nt},backend:o,attrs:{shape:V}});return o.disposeIntermediateTensorInfo(Nt),$t}},al={kernelName:m.StringNGrams,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{separator:c,nGramWidths:f,leftPad:y,rightPad:w,padWidth:C,preserveShortSequences:T}=u,{data:x,dataSplits:A}=i,M=o.readSync(x.dataId),$=o.readSync(A.dataId),[V,G]=xht(M,$,c,f,y,w,C,T);return[o.makeTensorInfo([V.length],"string",V),o.makeTensorInfo(A.shape,"int32",G)]}},yI={kernelName:m.StringSplit,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{skipEmpty:c}=u,{input:f,delimiter:y}=i;if(f.dtype!=="string")throw new Error("Input must be of datatype string");if(f.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${f.shape}`);if(y.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${y.shape}`);let w=o.readSync(f.dataId),C=o.readSync(y.dataId)[0],[T,x,A]=$X(w,C,c),M=x.length;return[o.makeTensorInfo([M,2],"int32",T),o.makeTensorInfo([M],"string",x),o.makeTensorInfo([2],"int32",new Int32Array(A))]}},rd={kernelName:m.StringToHashBucketFast,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{numBuckets:c}=u,{input:f}=i;if(f.dtype!=="string")throw new Error("Input must be of datatype string");if(c<=0)throw new Error("Number of buckets must be at least 1");let y=o.readSync(f.dataId),w=zX(y,c);return o.makeTensorInfo(f.shape,"int32",w)}},yl=lo({opSnippet:"return tan(x);"}),ho={kernelName:m.Tan,backendName:"webgl",kernelFunc:yl},No=lo({opSnippet:`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`}),$x={kernelName:m.Tanh,backendName:"webgl",kernelFunc:No},Sp={kernelName:m.TensorScatterUpdate,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o}=l,{tensor:u,indices:c,updates:f}=i,{sliceRank:y,numUpdates:w,sliceSize:C,strides:T,outputSize:x}=m.backend_util.calculateShapes(f,c,u.shape),A=[x/C,C];if(x===0)return o.makeTensorInfo(u.shape,c.dtype);let M=ri({inputs:{x:c},backend:o,attrs:{shape:[w,y]}}),$=ri({inputs:{x:f},backend:o,attrs:{shape:[w,C]}}),V=ri({inputs:{x:u},backend:o,attrs:{shape:A}}),G=new R_(w,y,M.shape.length,$.shape.length,T,A,!1,!0),Q=o.runWebGLProgram(G,[$,M,V],V.dtype),nt=ri({inputs:{x:Q},backend:o,attrs:{shape:u.shape}});return o.disposeIntermediateTensorInfo(M),o.disposeIntermediateTensorInfo($),o.disposeIntermediateTensorInfo(V),o.disposeIntermediateTensorInfo(Q),nt}};class ga{constructor(i,o){this.variableNames=["A"];let u=new Array(i.length);for(let y=0;y<u.length;y++)u[y]=i[y]*o[y];this.outputShape=u,this.rank=u.length;let c=is(this.rank),f=function(y){let w=y.length;if(w>5)throw Error(`Tile for rank ${w} is not yet supported`);if(w===1)return`imod(resRC, ${y[0]})`;let C=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],T=[];for(let x=0;x<y.length;x++)T.push(`imod(${C[x]}, ${y[x]})`);return T.join()}(i);this.userCode=`
      void main() {
        ${c} resRC = getOutputCoords();
        setOutput(getA(${f}));
      }
    `}}function O_(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{reps:f}=u;if(c.dtype==="string"||c.shape.length>5){let w=o.readSync(c.dataId),C=c.dtype==="string"?w.map(A=>m.util.decodeString(A)):w,T=(0,m.buffer)(c.shape,c.dtype,C),x=ZL(T,f);return o.makeTensorInfo(x.shape,x.dtype,x.values)}let y=new ga(c.shape,f);return o.runWebGLProgram(y,[c],c.dtype)}let PZ={kernelName:m.Tile,backendName:"webgl",kernelFunc:O_};class J${constructor(i){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=i,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class vI{constructor(i){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=i,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}function n1(l,i){i!==null&&l.disposeIntermediateTensorInfo(i)}function ia(l){let i=1;for(;i<l;)i*=2;return i}let _p={kernelName:m.TopK,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{k:f,sorted:y}=u,w=(0,m.env)().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),C=(0,m.env)().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),T=c.shape,x=T[T.length-1];if(o.shouldExecuteOnCPU([c])||x<w||f>C){let re=o.readSync(c.dataId),[ue,be]=wA(re,T,c.dtype,f,y);return[o.makeTensorInfo(ue.shape,ue.dtype,ue.values),o.makeTensorInfo(be.shape,be.dtype,be.values)]}if(f===0)return T[T.length-1]=0,[o.makeTensorInfo(T,c.dtype,[]),o.makeTensorInfo(T,"int32",[])];if(x===1)return[c,Nx({attrs:{shape:T,dtype:"int32",value:0},backend:o})];let A=o.texData.get(c.dataId),M=A!==null&&A.isPacked,$=M?o.unpackTensor(c):c,V=m.util.sizeFromShape(T)/x,G=ri({inputs:{x:$},attrs:{shape:[V,x]},backend:o});M&&n1(o,$);let Q=ia(f),nt=ia(x),it=null,ht=()=>it===null?[G,G]:[G,it],kt=(re,ue,be)=>{let De=ht(),ze=new J$(be),Qe=[[x],[it===null?1:0],[Number.NEGATIVE_INFINITY],[re],[ue]],cn=it;it=o.runWebGLProgram(ze,De,"int32",Qe),n1(o,cn)};for(let re=1;re<Q;re*=2){let ue=2*re;for(let be=re;be>=1;be/=2)kt(ue,be,[V,nt])}for(let re=nt;re>Q;re/=2){let ue=ht(),be=new vI([V,re/2]),De=[[x],[it===null?1:0],[Q]],ze=it;it=o.runWebGLProgram(be,ue,"int32",De),n1(o,ze);let Qe=Q/2,cn=2*Qe;for(let en=Qe;en>=1;en/=2)kt(cn,en,it.shape)}let Nt=it;it=G2({inputs:{x:it},backend:o,attrs:{begin:0,size:[V,f]}}),n1(o,Nt);let $t=C_({inputs:{x:G,indices:it},backend:o,attrs:{axis:1,batchDims:1}});n1(o,G);let Ut=T.slice(0,-1);Ut.push(f),Nt=it,it=ri({inputs:{x:it},attrs:{shape:Ut},backend:o}),n1(o,Nt);let Pt=$t;return $t=ri({inputs:{x:$t},attrs:{shape:Ut},backend:o}),n1(o,Pt),[$t,it]}};class id{constructor(i,o,u,c,f,y){this.variableNames=["Image","Transforms"],this.outputShape=y;let w=u==="nearest"?1:2,C;switch(c){case"constant":default:C=1;break;case"reflect":C=2;break;case"wrap":C=3;break;case"nearest":C=4}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${C} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${C} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${C} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${i} && 0 <= coordX && coordX < ${o}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${f});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${f});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${o}));
                float mapY = mapCoord(inY, float(${i}));

                if (${w} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}let tz={kernelName:m.Transform,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{image:c,transforms:f}=i,{interpolation:y,fillMode:w,fillValue:C,outputShape:T}=u,[x,A,M,$]=c.shape,[V,G]=T??[A,M],Q=new id(A,M,y,w,C,[x,V,G,$]);return o.runWebGLProgram(Q,[c,f],"float32")}},BZ={kernelName:m.Unique,backendName:"webgl",kernelFunc:function(l){let{inputs:i,attrs:o,backend:u}=l,{axis:c}=o,{x:f}=i;ab(f,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let y=u.readSync(f.dataId),{outputValues:w,outputShape:C,indices:T}=QL(y,c,f.shape,f.dtype);return[u.makeTensorInfo(C,f.dtype,w),u.makeTensorInfo([T.length],"int32",T)]}},Wd={kernelName:m.Unpack,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{value:c}=i,{axis:f}=u;f<0&&(f+=c.shape.length);let y=c,w=y.shape.length,C=c.shape[f],T=new Array(w-1),x=0;for(let G=0;G<w;G++)G!==f&&(T[x++]=y.shape[G]);let A=[],M=new Array(w).fill(0),$=y.shape.slice();$[f]=1;let V=new Array(C);for(let G=0;G<V.length;G++){M[f]=G;let Q=G2({inputs:{x:y},backend:o,attrs:{begin:M,size:$}}),nt=ri({inputs:{x:Q},backend:o,attrs:{shape:T}});V[G]=nt,A.push(Q)}return A.forEach(G=>o.disposeIntermediateTensorInfo(G)),V}};class jZ{constructor(i,o){this.variableNames=["x","segmentIds"];let u=i.windowSize,c=i.batchSize,f=i.inSize,y=i.numSegments,w=y*Math.ceil(f/u);this.outputShape=[c,w];let C=4*Math.floor(u/4),T=u%4,x=`
        sumValue += dot(values, segFilter);
    `,A="";f%u>0&&(A=`
        if (inIdx < 0 || inIdx >= ${f}) {
          return initializationValue;
        }
      `);let M="";f%u>0&&(M=`
        if (inIdx < 0 || inIdx >= ${f}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        ${A}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${M}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${y})) * float(${u}));
        int currentSeg = int(mod(float(outIdx), float(${y})));

        float sumValue = 0.0;

        for (int i = 0; i < ${C}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${x}
        }

        int inIdx = inOffset + ${C};
        if (${T===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${x}
        } else if (${T===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${x}
        } else if (${T===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${x}
        }
        setOutput(sumValue);
      }
    `}}let UZ={kernelName:m.UnsortedSegmentSum,backendName:"webgl",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,segmentIds:f}=i,{numSegments:y}=u,w=c.shape.length,C=[],T=0,x=m.backend_util.getAxesPermutation([T],w),A=c;x!=null&&(A=qc({inputs:{x:c},backend:o,attrs:{perm:x}}),C.push(A),T=m.backend_util.getInnerMostAxes(1,w)[0]);let M=m.backend_util.segment_util.computeOutShape(A.shape,T,y),$=m.util.sizeFromShape([A.shape[T]]),V=ri({inputs:{x:A},backend:o,attrs:{shape:[-1,$]}});C.push(V);let G=(0,m.sumOutType)(c.dtype),Q=(ht,kt,Nt,$t,Ut)=>{let Pt=ht.shape[0],re=ht.shape[1],ue=m.backend_util.segment_util.segOpComputeOptimalWindowSize(re,Ut),be=new jZ({windowSize:ue,inSize:re,batchSize:Pt,numSegments:Ut},kt),De=o.compileAndRun(be,[ht,Nt],$t);if(C.push(De),De.shape[1]===Ut)return De;let ze=P$({backend:o,attrs:{start:0,stop:Ut,step:1,dtype:"float32"}}),Qe=O_({inputs:{x:ze},backend:o,attrs:{reps:[re/ue]}});return C.push(ze),C.push(Qe),Q(De,kt,Qe,$t,Ut)},nt=ri({inputs:{x:Q(V,"unsortedSegmentSum",f,G,y)},backend:o,attrs:{shape:M}}),it=nt;if(x!=null){C.push(nt);let ht=m.backend_util.getUndoAxesPermutation(x);it=qc({inputs:{x:it},backend:o,attrs:{perm:ht}})}return C.forEach(ht=>o.disposeIntermediateTensorInfo(ht)),it}},xdt=[V2,YX,s$,KX,u$,JX,_A,tK,Dht,Rht,eK,nK,C0,h$,aK,oK,Oht,Lht,$ht,zht,lK,Bht,fK,pK,mK,vK,jht,g$,kA,v$,xK,kh,oo,DA,w$,qa,vp,x$,bp,_K,Vht,Ght,CK,EK,x_,zA,TK,Nm,k$,S$,PA,BA,_$,S_,wb,qht,Xht,RK,E$,LK,T$,Kht,PK,BK,jK,WK,VA,HK,Dx,Cht,GA,wK,I$,N$,YK,Eht,Zht,XK,Jht,qA,ZK,R$,JK,eZ,O$,L$,$$,nZ,edt,rZ,z$,ndt,JA,aZ,oZ,sZ,lZ,rdt,dZ,Tht,pZ,gZ,yZ,Lo,gK,vZ,_f,rl,gl,rI,VX,D_,iI,aI,bZ,odt,yK,T_,Ox,sI,uI,Aht,wZ,sdt,ldt,lI,V$,G$,CZ,TZ,hI,IZ,NZ,dI,fI,MZ,DZ,RZ,dK,hZ,FZ,mdt,gdt,X$,pI,OZ,K$,LZ,vdt,wdt,zZ,gI,ba,co,al,yI,rd,A_,v_,ho,$x,Sp,PZ,_p,tz,SA,BZ,Wd,UZ,e1];for(let l of xdt)(0,m.registerKernel)(l);let kdt={"tfjs-core":m.version_core,"tfjs-backend-cpu":dq,"tfjs-backend-webgl":r$,"tfjs-data":AS,"tfjs-layers":oE,"tfjs-converter":jF,tfjs:"4.22.0"};function Ws(l,i){return i?new Promise((o,u)=>{l.then(c=>{i(c),o(c)}).catch(c=>{i(void 0,c),u(c)})}):l}let zx=l=>typeof HTMLVideoElement<"u"&&l instanceof HTMLVideoElement,WZ=l=>typeof HTMLAudioElement<"u"&&l instanceof HTMLAudioElement,VZ=l=>typeof HTMLCanvasElement<"u"&&l instanceof HTMLCanvasElement,GZ=l=>typeof HTMLImageElement<"u"&&l instanceof HTMLImageElement,L_=l=>typeof ImageData>"u"?typeof l=="object"&&(l.data instanceof Uint8ClampedArray||l.data instanceof Uint8Array)&&typeof l.width=="number"&&typeof l.height=="number":l instanceof ImageData,Px=l=>!!l&&(VZ(l)||GZ(l)||zx(l)),ez=l=>{if(Px(l))return l;if(typeof l=="object"){if(Px(l.canvas))return l.canvas;if(Px(l.elt))return l.elt}return null};class HZ{constructor(...i){i.forEach(o=>this.addArg(o))}addArg(i){var o;if(i!=null)switch(typeof i){case"string":this.set({string:i});break;case"number":this.set({number:i});break;case"function":this.set({callback:i});break;case"object":{((o=i)instanceof m.Tensor&&o.rank===3||L_(i))&&this.set({image:i});let u=ez(i);u&&(this.set({image:u}),zx(u)&&this.set({audio:u,video:u})),WZ(i)?this.set({audio:i}):Array.isArray(i)?this.set({array:i}):this.set({options:i});break}default:throw new Error("invalid argument")}}set(i,o=!0){Object.keys(i).forEach(u=>{o&&this.has(u)&&console.warn(`Received multiple ${u} arguments, but only a single ${u} is supported.
          The last ${u} will be used.`),this[u]=i[u]})}has(i){return this[i]!==void 0}require(i,o){if(this.has(i))return this;throw new Error(o||`An argument for ${i} must be provided.`)}}function Uu(...l){return new HZ(...l)}function nz(l){return!!(l&&typeof l=="function"&&l.prototype&&l.prototype.registerMethod)}let r1=new class{constructor(){this.didSetupPreload=!1,this.p5Constructor=void 0,this.p5Extensions=void 0,this.ml5Library=void 0,this.methodsToPreload=[],this.findAndSetP5()}findAndSetP5(){let l;typeof window<"u"?l=window:typeof globalThis<"u"&&(l=globalThis),l&&(nz(l.p5)&&(this.p5Constructor=l.p5,this.registerPreloads()),function(i){return!!(i&&typeof i.loadImage=="function")}(l)&&(this.p5Extensions=l))}setP5(l){nz(l)?(this.p5Constructor=l,this.p5Extensions=l.prototype,this.registerPreloads()):console.warn("Invalid p5 object provided to ml5.setP5().")}shouldPreload(l,i){this.methodsToPreload=i,this.ml5Library=l,this.checkP5()&&this.registerPreloads()}registerPreloads(){if(this.didSetupPreload)return;let l=this.p5Constructor,i=this.ml5Library,o=this.methodsToPreload;if(!l||!i)return;let u=yd({},i),c=this;l.prototype.ml5Init=function(){let f=this._incrementPreload.bind(this),y=this._decrementPreload.bind(this);o.forEach(w=>{i[w]=function(...C){f();let T=u[w](...C);return T.ready.then(()=>{y()}),T}}),c.didSetupPreload=!0},l.prototype.ml5Remove=function(){o.forEach(f=>{i[f]=u[f]}),c.didSetupPreload=!1},l.prototype.registerMethod("init",l.prototype.ml5Init),l.prototype.registerMethod("remove",l.prototype.ml5Remove)}get p5Instance(){return this.p5Extensions||this.findAndSetP5(),this.p5Extensions}checkP5(){return!!this.p5Instance}getBlob(l){return new Promise((i,o)=>{l.toBlob(u=>{u?i(u):o(new Error("Canvas could not be converted to Blob."))})})}loadAsync(l){return new Promise((i,o)=>{this.p5Instance.loadImage(l,u=>{i(u)},()=>{o(new Error(`Could not load image from url ${l}`))})})}rawToBlob(l,i,o){return ce(this,null,function*(){let u=Array.from(l),c=document.createElement("canvas"),f=c.getContext("2d");c.width=i,c.height=o;let y=f.createImageData(i,o),{data:w}=y;for(let C=0;C<i*o*4;C+=1)w[C]=u[C];return f.putImageData(y,0,0),this.getBlob(c)})}ImageDataToBlob(l,i,o){return ce(this,null,function*(){let u=document.createElement("canvas"),c=u.getContext("2d");return u.width=i,u.height=o,c.putImageData(l,0,0),this.getBlob(u)})}blobToP5Image(l){return ce(this,null,function*(){return this.checkP5()&&typeof URL<"u"?this.loadAsync(URL.createObjectURL(l)):null})}},Bx=l=>{let i=L_(l)?l:ez(l);if(VZ(i))return i;if(!i)throw new Error("Invalid image. Image must be one of: HTMLCanvasElement, HTMLImageElement, HTMLVideoElement, ImageData, p5.Image, p5.Graphics, or p5.Video.");let o=i.videoWidth||i.width,u=i.videoHeight||i.height,c=document.createElement("canvas");c.width=o,c.height=u;let f=c.getContext("2d");return L_(l)?f.putImageData(l,0,0):f.drawImage(i,0,0,o,u),c};function rz(l,i=null){return m.tidy(()=>{let o=m.browser.fromPixels(l);return i&&(o=m.image.resizeBilinear(o,i)),(c=>{let f=Math.min(c.shape[0],c.shape[1]),y=c.shape[0]/2-f/2,w=c.shape[1]/2-f/2;return c.slice([y,w,0],[f,f,3])})(o).expandDims(0).toFloat().div(m.scalar(127)).sub(m.scalar(1))})}function iz(l){return Px(l)||L_(l)}function E0(l,i){return ce(this,null,function*(){l&&(zx(l)||WZ(l))?(i&&(yield m.nextFrame()),l.readyState===0&&(yield new Promise((o,u)=>{l.addEventListener("error",()=>u(l.error)),l.addEventListener("loadeddata",o)}))):l&&GZ(l)&&(l.complete||(yield new Promise((o,u)=>{l.addEventListener("error",u),l.addEventListener("load",o)})))})}let jx=(l,i,o)=>ce(this,null,function*(){let u=document.createElement("a");u.style.display="none",document.body.appendChild(u);let c=new Blob([l],{type:o});u.href=URL.createObjectURL(c),u.download=i,u.click()}),bI=(l=0,i=1)=>Math.random()*(i-l)+l,az=(l=0,i=1)=>{let o,u,c,f,y,w;if(w)o=u,w=!1;else{do c=bI(0,2)-1,f=bI(0,2)-1,y=c*c+f*f;while(y>=1);y=Math.sqrt(-2*Math.log(y)/y),o=c*y,u=f*y,w=!0}return o*i+l},oz=class{constructor(){this.isTrained=!1,this.isCompiled=!1,this.isLayered=!1,this.model=null,this.init=this.init.bind(this),this.createModel=this.createModel.bind(this),this.addLayer=this.addLayer.bind(this),this.compile=this.compile.bind(this),this.setOptimizerFunction=this.setOptimizerFunction.bind(this),this.train=this.train.bind(this),this.predict=this.predict.bind(this),this.classify=this.classify.bind(this),this.save=this.save.bind(this),this.load=this.load.bind(this),this.init()}init(){this.createModel()}createModel(l="sequential"){return l.toLowerCase(),this.model=sE(),this.model}addLayer(l){this.model.add(l),this.model.layers.length>=2&&(this.isLayered=!0)}compile(l){this.model.compile(l),this.isCompiled=!0}setOptimizerFunction(l,i){return i.call(this,l)}train(l){return ce(this,null,function*(){let i=l,o=i.inputs,u=i.outputs,{batchSize:c,epochs:f,shuffle:y,validationSplit:w,whileTraining:C}=i;yield this.model.fit(o,u,{batchSize:c,epochs:f,shuffle:y,validationSplit:w,callbacks:C}),o.dispose(),u.dispose(),this.isTrained=!0})}predictSync(l){let i=m.tidy(()=>this.model.predict(l)),o=i.arraySync();return i.dispose(),l.dispose(),o}predict(l){return ce(this,null,function*(){let i=m.tidy(()=>this.model.predict(l)),o=yield i.array();return i.dispose(),l.dispose(),o})}classify(l){return ce(this,null,function*(){return this.predict(l)})}classifySync(l){return this.predictSync(l)}save(l="model"){return ce(this,null,function*(){yield this.model.save(m.io.withSaveHandler(i=>ce(this,null,function*(){this.weightsManifest={modelTopology:i.modelTopology,weightsManifest:[{paths:[`./${l}.weights.bin`],weights:i.weightSpecs}]},yield jx(i.weightData,`${l}.weights.bin`,"application/octet-stream"),yield jx(JSON.stringify(this.weightsManifest),`${l}.json`,"text/plain")})))})}load(l){return ce(this,null,function*(){if(l instanceof FileList){let i=Array.from(l),o=i.find(c=>c.name.includes(".json")&&!c.name.includes("_meta")),u=i.find(c=>c.name.includes(".bin"));this.model=yield Dd(m.io.browserFiles([o,u]))}else this.model=l instanceof Object?yield Dd(m.io.http(l.model,{weightUrlConverter:i=>l.weights||i})):yield Dd(l);this.isCompiled=!0,this.isLayered=!0,this.isTrained=!0})}dispose(){this.model.dispose()}mutate(l=.1,i){m.tidy(()=>{let o=this.model.getWeights(),u=[];for(let c=0;c<o.length;c+=1){let f=o[c],{shape:y}=o[c],w=f.dataSync().slice();for(let T=0;T<w.length;T+=1)Math.random()<l&&(w[T]=i?i(w[T]):Math.min(Math.max(w[T]+az(),-1),1));let C=m.tensor(w,y);u[c]=C}this.model.setWeights(u)})}crossover(l){return m.tidy(()=>{let i=this.model.getWeights(),o=l.model.getWeights(),u=[];for(let c=0;c<i.length;c+=1){let f=i[c],y=o[c],{shape:w}=i[c],C=f.dataSync().slice(),T=y.dataSync().slice();for(let A=0;A<C.length;A+=1)Math.random()<.5&&(C[A]=T[A]);let x=m.tensor(C,w);u[c]=x}this.model.setWeights(u)})}};function wI(l,i){return function(){return l.apply(i,arguments)}}let{toString:sz}=Object.prototype,{getPrototypeOf:$_}=Object,Ux=(z_=Object.create(null),l=>{let i=sz.call(l);return z_[i]||(z_[i]=i.slice(8,-1).toLowerCase())});var z_;let Cp=l=>(l=l.toLowerCase(),i=>Ux(i)===l),P_=l=>i=>typeof i===l,{isArray:xb}=Array,Wx=P_("undefined"),Sh=Cp("ArrayBuffer"),Sdt=P_("string"),Cf=P_("function"),xI=P_("number"),Vx=l=>l!==null&&typeof l=="object",B_=l=>{if(Ux(l)!=="object")return!1;let i=$_(l);return!(i!==null&&i!==Object.prototype&&Object.getPrototypeOf(i)!==null||Symbol.toStringTag in l||Symbol.iterator in l)},ad=Cp("Date"),od=Cp("File"),q2=Cp("Blob"),_dt=Cp("FileList"),Cdt=Cp("URLSearchParams"),[Edt,YZ,kI,Tdt]=["ReadableStream","Request","Response","Headers"].map(Cp);function Gx(l,i,{allOwnKeys:o=!1}={}){if(l==null)return;let u,c;if(typeof l!="object"&&(l=[l]),xb(l))for(u=0,c=l.length;u<c;u++)i.call(null,l[u],u,l);else{let f=o?Object.getOwnPropertyNames(l):Object.keys(l),y=f.length,w;for(u=0;u<y;u++)w=f[u],i.call(null,l[w],w,l)}}function qZ(l,i){i=i.toLowerCase();let o=Object.keys(l),u,c=o.length;for(;c-- >0;)if(u=o[c],i===u.toLowerCase())return u;return null}let Dm=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:MNt,Hx=l=>!Wx(l)&&l!==Dm,Yx=(kb=typeof Uint8Array<"u"&&$_(Uint8Array),l=>kb&&l instanceof kb);var kb;let j_=Cp("HTMLFormElement"),U_=(({hasOwnProperty:l})=>(i,o)=>l.call(i,o))(Object.prototype),Sb=Cp("RegExp"),W_=(l,i)=>{let o=Object.getOwnPropertyDescriptors(l),u={};Gx(o,(c,f)=>{let y;(y=i(c,f,l))!==!1&&(u[f]=y||c)}),Object.defineProperties(l,u)},_b="abcdefghijklmnopqrstuvwxyz",uz="0123456789",SI={DIGIT:uz,ALPHA:_b,ALPHA_DIGIT:_b+_b.toUpperCase()+uz},Adt=Cp("AsyncFunction"),V_=(lz=typeof setImmediate=="function",cz=Cf(Dm.postMessage),lz?setImmediate:cz?(hz=`axios@${Math.random()}`,qx=[],Dm.addEventListener("message",({source:l,data:i})=>{l===Dm&&i===hz&&qx.length&&qx.shift()()},!1),l=>{qx.push(l),Dm.postMessage(hz,"*")}):l=>setTimeout(l));var lz,cz,hz,qx;let XZ=typeof queueMicrotask<"u"?queueMicrotask.bind(Dm):typeof Iu<"u"&&Iu.nextTick||V_,cr={isArray:xb,isArrayBuffer:Sh,isBuffer:function(l){return l!==null&&!Wx(l)&&l.constructor!==null&&!Wx(l.constructor)&&Cf(l.constructor.isBuffer)&&l.constructor.isBuffer(l)},isFormData:l=>{let i;return l&&(typeof FormData=="function"&&l instanceof FormData||Cf(l.append)&&((i=Ux(l))==="formdata"||i==="object"&&Cf(l.toString)&&l.toString()==="[object FormData]"))},isArrayBufferView:function(l){let i;return i=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(l):l&&l.buffer&&Sh(l.buffer),i},isString:Sdt,isNumber:xI,isBoolean:l=>l===!0||l===!1,isObject:Vx,isPlainObject:B_,isReadableStream:Edt,isRequest:YZ,isResponse:kI,isHeaders:Tdt,isUndefined:Wx,isDate:ad,isFile:od,isBlob:q2,isRegExp:Sb,isFunction:Cf,isStream:l=>Vx(l)&&Cf(l.pipe),isURLSearchParams:Cdt,isTypedArray:Yx,isFileList:_dt,forEach:Gx,merge:function l(){let{caseless:i}=Hx(this)&&this||{},o={},u=(c,f)=>{let y=i&&qZ(o,f)||f;B_(o[y])&&B_(c)?o[y]=l(o[y],c):B_(c)?o[y]=l({},c):xb(c)?o[y]=c.slice():o[y]=c};for(let c=0,f=arguments.length;c<f;c++)arguments[c]&&Gx(arguments[c],u);return o},extend:(l,i,o,{allOwnKeys:u}={})=>(Gx(i,(c,f)=>{o&&Cf(c)?l[f]=wI(c,o):l[f]=c},{allOwnKeys:u}),l),trim:l=>l.trim?l.trim():l.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:l=>(l.charCodeAt(0)===65279&&(l=l.slice(1)),l),inherits:(l,i,o,u)=>{l.prototype=Object.create(i.prototype,u),l.prototype.constructor=l,Object.defineProperty(l,"super",{value:i.prototype}),o&&Object.assign(l.prototype,o)},toFlatObject:(l,i,o,u)=>{let c,f,y,w={};if(i=i||{},l==null)return i;do{for(c=Object.getOwnPropertyNames(l),f=c.length;f-- >0;)y=c[f],u&&!u(y,l,i)||w[y]||(i[y]=l[y],w[y]=!0);l=o!==!1&&$_(l)}while(l&&(!o||o(l,i))&&l!==Object.prototype);return i},kindOf:Ux,kindOfTest:Cp,endsWith:(l,i,o)=>{l=String(l),(o===void 0||o>l.length)&&(o=l.length),o-=i.length;let u=l.indexOf(i,o);return u!==-1&&u===o},toArray:l=>{if(!l)return null;if(xb(l))return l;let i=l.length;if(!xI(i))return null;let o=new Array(i);for(;i-- >0;)o[i]=l[i];return o},forEachEntry:(l,i)=>{let o=(l&&l[Symbol.iterator]).call(l),u;for(;(u=o.next())&&!u.done;){let c=u.value;i.call(l,c[0],c[1])}},matchAll:(l,i)=>{let o,u=[];for(;(o=l.exec(i))!==null;)u.push(o);return u},isHTMLForm:j_,hasOwnProperty:U_,hasOwnProp:U_,reduceDescriptors:W_,freezeMethods:l=>{W_(l,(i,o)=>{if(Cf(l)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;let u=l[o];Cf(u)&&(i.enumerable=!1,"writable"in i?i.writable=!1:i.set||(i.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")}))})},toObjectSet:(l,i)=>{let o={},u=c=>{c.forEach(f=>{o[f]=!0})};return xb(l)?u(l):u(String(l).split(i)),o},toCamelCase:l=>l.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(i,o,u){return o.toUpperCase()+u}),noop:()=>{},toFiniteNumber:(l,i)=>l!=null&&Number.isFinite(l=+l)?l:i,findKey:qZ,global:Dm,isContextDefined:Hx,ALPHABET:SI,generateString:(l=16,i=SI.ALPHA_DIGIT)=>{let o="",{length:u}=i;for(;l--;)o+=i[Math.random()*u|0];return o},isSpecCompliantForm:function(l){return!!(l&&Cf(l.append)&&l[Symbol.toStringTag]==="FormData"&&l[Symbol.iterator])},toJSONObject:l=>{let i=new Array(10),o=(u,c)=>{if(Vx(u)){if(i.indexOf(u)>=0)return;if(!("toJSON"in u)){i[c]=u;let f=xb(u)?[]:{};return Gx(u,(y,w)=>{let C=o(y,c+1);!Wx(C)&&(f[w]=C)}),i[c]=void 0,f}}return u};return o(l,0)},isAsyncFn:Adt,isThenable:l=>l&&(Vx(l)||Cf(l))&&Cf(l.then)&&Cf(l.catch),setImmediate:V_,asap:XZ};function Xx(l,i,o,u,c){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=l,this.name="AxiosError",i&&(this.code=i),o&&(this.config=o),u&&(this.request=u),c&&(this.response=c,this.status=c.status?c.status:null)}cr.inherits(Xx,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:cr.toJSONObject(this.config),code:this.code,status:this.status}}});let KZ=Xx.prototype,ZZ={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(l=>{ZZ[l]={value:l}}),Object.defineProperties(Xx,ZZ),Object.defineProperty(KZ,"isAxiosError",{value:!0}),Xx.from=(l,i,o,u,c,f)=>{let y=Object.create(KZ);return cr.toFlatObject(l,y,function(w){return w!==Error.prototype},w=>w!=="isAxiosError"),Xx.call(y,l.message,i,o,u,c),y.cause=l,y.name=l.name,f&&Object.assign(y,f),y};let mo=Xx;function _I(l){return cr.isPlainObject(l)||cr.isArray(l)}function dz(l){return cr.endsWith(l,"[]")?l.slice(0,-2):l}function Kx(l,i,o){return l?l.concat(i).map(function(u,c){return u=dz(u),!o&&c?"["+u+"]":u}).join(o?".":""):i}let fz=cr.toFlatObject(cr,{},null,function(l){return/^is[A-Z]/.test(l)}),CI=function(l,i,o){if(!cr.isObject(l))throw new TypeError("target must be an object");i=i||new FormData;let u=(o=cr.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(M,$){return!cr.isUndefined($[M])})).metaTokens,c=o.visitor||T,f=o.dots,y=o.indexes,w=(o.Blob||typeof Blob<"u"&&Blob)&&cr.isSpecCompliantForm(i);if(!cr.isFunction(c))throw new TypeError("visitor must be a function");function C(M){if(M===null)return"";if(cr.isDate(M))return M.toISOString();if(!w&&cr.isBlob(M))throw new mo("Blob is not supported. Use a Buffer instead.");return cr.isArrayBuffer(M)||cr.isTypedArray(M)?w&&typeof Blob=="function"?new Blob([M]):Un.from(M):M}function T(M,$,V){let G=M;if(M&&!V&&typeof M=="object"){if(cr.endsWith($,"{}"))$=u?$:$.slice(0,-2),M=JSON.stringify(M);else if(cr.isArray(M)&&function(Q){return cr.isArray(Q)&&!Q.some(_I)}(M)||(cr.isFileList(M)||cr.endsWith($,"[]"))&&(G=cr.toArray(M)))return $=dz($),G.forEach(function(Q,nt){!cr.isUndefined(Q)&&Q!==null&&i.append(y===!0?Kx([$],nt,f):y===null?$:$+"[]",C(Q))}),!1}return!!_I(M)||(i.append(Kx(V,$,f),C(M)),!1)}let x=[],A=Object.assign(fz,{defaultVisitor:T,convertValue:C,isVisitable:_I});if(!cr.isObject(l))throw new TypeError("data must be an object");return function M($,V){if(!cr.isUndefined($)){if(x.indexOf($)!==-1)throw Error("Circular reference detected in "+V.join("."));x.push($),cr.forEach($,function(G,Q){(!(cr.isUndefined(G)||G===null)&&c.call(i,G,cr.isString(Q)?Q.trim():Q,V,A))===!0&&M(G,V?V.concat(Q):[Q])}),x.pop()}}(l),i};function pz(l){let i={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(l).replace(/[!'()~]|%20|%00/g,function(o){return i[o]})}function EI(l,i){this._pairs=[],l&&CI(l,this,i)}let mz=EI.prototype;mz.append=function(l,i){this._pairs.push([l,i])},mz.toString=function(l){let i=l?function(o){return l.call(this,o,pz)}:pz;return this._pairs.map(function(o){return i(o[0])+"="+i(o[1])},"").join("&")};let QZ=EI;function Idt(l){return encodeURIComponent(l).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function JZ(l,i,o){if(!i)return l;let u=o&&o.encode||Idt;cr.isFunction(o)&&(o={serialize:o});let c=o&&o.serialize,f;if(f=c?c(i,o):cr.isURLSearchParams(i)?i.toString():new QZ(i,o).toString(u),f){let y=l.indexOf("#");y!==-1&&(l=l.slice(0,y)),l+=(l.indexOf("?")===-1?"?":"&")+f}return l}let tQ=class{constructor(){this.handlers=[]}use(l,i,o){return this.handlers.push({fulfilled:l,rejected:i,synchronous:!!o&&o.synchronous,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(l){this.handlers[l]&&(this.handlers[l]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(l){cr.forEach(this.handlers,function(i){i!==null&&l(i)})}},TI={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ndt={isBrowser:!0,classes:{URLSearchParams:typeof URLSearchParams<"u"?URLSearchParams:QZ,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]},gz=typeof window<"u"&&typeof document<"u",yz=typeof navigator=="object"&&navigator||void 0,eQ=gz&&(!yz||["ReactNative","NativeScript","NS"].indexOf(yz.product)<0),Zx=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Mdt=gz&&window.location.href||"http://localhost",_h=yd(yd({},Ee),Ndt),G_=function(l){function i(o,u,c,f){let y=o[f++];if(y==="__proto__")return!0;let w=Number.isFinite(+y),C=f>=o.length;return y=!y&&cr.isArray(c)?c.length:y,C?(cr.hasOwnProp(c,y)?c[y]=[c[y],u]:c[y]=u,!w):(c[y]&&cr.isObject(c[y])||(c[y]=[]),i(o,u,c[y],f)&&cr.isArray(c[y])&&(c[y]=function(T){let x={},A=Object.keys(T),M,$=A.length,V;for(M=0;M<$;M++)V=A[M],x[V]=T[V];return x}(c[y])),!w)}if(cr.isFormData(l)&&cr.isFunction(l.entries)){let o={};return cr.forEachEntry(l,(u,c)=>{i(function(f){return cr.matchAll(/\w+|\[(\w*)]/g,f).map(y=>y[0]==="[]"?"":y[1]||y[0])}(u),c,o,0)}),o}return null},AI={transitional:TI,adapter:["xhr","http","fetch"],transformRequest:[function(l,i){let o=i.getContentType()||"",u=o.indexOf("application/json")>-1,c=cr.isObject(l);if(c&&cr.isHTMLForm(l)&&(l=new FormData(l)),cr.isFormData(l))return u?JSON.stringify(G_(l)):l;if(cr.isArrayBuffer(l)||cr.isBuffer(l)||cr.isStream(l)||cr.isFile(l)||cr.isBlob(l)||cr.isReadableStream(l))return l;if(cr.isArrayBufferView(l))return l.buffer;if(cr.isURLSearchParams(l))return i.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),l.toString();let f;if(c){if(o.indexOf("application/x-www-form-urlencoded")>-1)return function(y,w){return CI(y,new _h.classes.URLSearchParams,Object.assign({visitor:function(C,T,x,A){return _h.isNode&&cr.isBuffer(C)?(this.append(T,C.toString("base64")),!1):A.defaultVisitor.apply(this,arguments)}},w))}(l,this.formSerializer).toString();if((f=cr.isFileList(l))||o.indexOf("multipart/form-data")>-1){let y=this.env&&this.env.FormData;return CI(f?{"files[]":l}:l,y&&new y,this.formSerializer)}}return c||u?(i.setContentType("application/json",!1),function(y,w,C){if(cr.isString(y))try{return(0,JSON.parse)(y),cr.trim(y)}catch(T){if(T.name!=="SyntaxError")throw T}return(C||JSON.stringify)(y)}(l)):l}],transformResponse:[function(l){let i=this.transitional||AI.transitional,o=i&&i.forcedJSONParsing,u=this.responseType==="json";if(cr.isResponse(l)||cr.isReadableStream(l))return l;if(l&&cr.isString(l)&&(o&&!this.responseType||u)){let c=!(i&&i.silentJSONParsing)&&u;try{return JSON.parse(l)}catch(f){if(c)throw f.name==="SyntaxError"?mo.from(f,mo.ERR_BAD_RESPONSE,this,null,this.response):f}}return l}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:_h.classes.FormData,Blob:_h.classes.Blob},validateStatus:function(l){return l>=200&&l<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};cr.forEach(["delete","get","head","post","put","patch"],l=>{AI.headers[l]={}});let H_=AI,Ddt=cr.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Qx=Symbol("internals");function Jx(l){return l&&String(l).trim().toLowerCase()}function Y_(l){return l===!1||l==null?l:cr.isArray(l)?l.map(Y_):String(l)}function II(l,i,o,u,c){return cr.isFunction(u)?u.call(this,i,o):(c&&(i=o),cr.isString(i)?cr.isString(u)?i.indexOf(u)!==-1:cr.isRegExp(u)?u.test(i):void 0:void 0)}class q_{constructor(i){i&&this.set(i)}set(i,o,u){let c=this;function f(w,C,T){let x=Jx(C);if(!x)throw new Error("header name must be a non-empty string");let A=cr.findKey(c,x);(!A||c[A]===void 0||T===!0||T===void 0&&c[A]!==!1)&&(c[A||C]=Y_(w))}let y=(w,C)=>cr.forEach(w,(T,x)=>f(T,x,C));if(cr.isPlainObject(i)||i instanceof this.constructor)y(i,o);else if(cr.isString(i)&&(i=i.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(i.trim()))y((w=>{let C={},T,x,A;return w&&w.split(`
`).forEach(function(M){A=M.indexOf(":"),T=M.substring(0,A).trim().toLowerCase(),x=M.substring(A+1).trim(),!T||C[T]&&Ddt[T]||(T==="set-cookie"?C[T]?C[T].push(x):C[T]=[x]:C[T]=C[T]?C[T]+", "+x:x)}),C})(i),o);else if(cr.isHeaders(i))for(let[w,C]of i.entries())f(C,w,u);else i!=null&&f(o,i,u);return this}get(i,o){if(i=Jx(i)){let u=cr.findKey(this,i);if(u){let c=this[u];if(!o)return c;if(o===!0)return function(f){let y=Object.create(null),w=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g,C;for(;C=w.exec(f);)y[C[1]]=C[2];return y}(c);if(cr.isFunction(o))return o.call(this,c,u);if(cr.isRegExp(o))return o.exec(c);throw new TypeError("parser must be boolean|regexp|function")}}}has(i,o){if(i=Jx(i)){let u=cr.findKey(this,i);return!(!u||this[u]===void 0||o&&!II(0,this[u],u,o))}return!1}delete(i,o){let u=this,c=!1;function f(y){if(y=Jx(y)){let w=cr.findKey(u,y);!w||o&&!II(0,u[w],w,o)||(delete u[w],c=!0)}}return cr.isArray(i)?i.forEach(f):f(i),c}clear(i){let o=Object.keys(this),u=o.length,c=!1;for(;u--;){let f=o[u];i&&!II(0,this[f],f,i,!0)||(delete this[f],c=!0)}return c}normalize(i){let o=this,u={};return cr.forEach(this,(c,f)=>{let y=cr.findKey(u,f);if(y)return o[y]=Y_(c),void delete o[f];let w=i?function(C){return C.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(T,x,A)=>x.toUpperCase()+A)}(f):String(f).trim();w!==f&&delete o[f],o[w]=Y_(c),u[w]=!0}),this}concat(...i){return this.constructor.concat(this,...i)}toJSON(i){let o=Object.create(null);return cr.forEach(this,(u,c)=>{u!=null&&u!==!1&&(o[c]=i&&cr.isArray(u)?u.join(", "):u)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([i,o])=>i+": "+o).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(i){return i instanceof this?i:new this(i)}static concat(i,...o){let u=new this(i);return o.forEach(c=>u.set(c)),u}static accessor(i){let o=(this[Qx]=this[Qx]={accessors:{}}).accessors,u=this.prototype;function c(f){let y=Jx(f);o[y]||(function(w,C){let T=cr.toCamelCase(" "+C);["get","set","has"].forEach(x=>{Object.defineProperty(w,x+T,{value:function(A,M,$){return this[x].call(this,C,A,M,$)},configurable:!0})})}(u,f),o[y]=!0)}return cr.isArray(i)?i.forEach(c):c(i),this}}q_.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),cr.reduceDescriptors(q_.prototype,({value:l},i)=>{let o=i[0].toUpperCase()+i.slice(1);return{get:()=>l,set(u){this[o]=u}}}),cr.freezeMethods(q_);let Vd=q_;function vz(l,i){let o=this||H_,u=i||o,c=Vd.from(u.headers),f=u.data;return cr.forEach(l,function(y){f=y.call(o,f,c.normalize(),i?i.status:void 0)}),c.normalize(),f}function X_(l){return!(!l||!l.__CANCEL__)}function X2(l,i,o){mo.call(this,l??"canceled",mo.ERR_CANCELED,i,o),this.name="CanceledError"}cr.inherits(X2,mo,{__CANCEL__:!0});let Rm=X2;function nQ(l,i,o){let u=o.config.validateStatus;o.status&&u&&!u(o.status)?i(new mo("Request failed with status code "+o.status,[mo.ERR_BAD_REQUEST,mo.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o)):l(o)}let rQ=function(l,i){l=l||10;let o=new Array(l),u=new Array(l),c,f=0,y=0;return i=i!==void 0?i:1e3,function(w){let C=Date.now(),T=u[y];c||(c=C),o[f]=w,u[f]=C;let x=y,A=0;for(;x!==f;)A+=o[x++],x%=l;if(f=(f+1)%l,f===y&&(y=(y+1)%l),C-c<i)return;let M=T&&C-T;return M?Math.round(1e3*A/M):void 0}},bz=function(l,i){let o,u,c=0,f=1e3/i,y=(w,C=Date.now())=>{c=C,o=null,u&&(clearTimeout(u),u=null),l.apply(null,w)};return[(...w)=>{let C=Date.now(),T=C-c;T>=f?y(w,C):(o=w,u||(u=setTimeout(()=>{u=null,y(o)},f-T)))},()=>o&&y(o)]},K_=(l,i,o=3)=>{let u=0,c=rQ(50,250);return bz(f=>{let y=f.loaded,w=f.lengthComputable?f.total:void 0,C=y-u,T=c(C);u=y,l({loaded:y,total:w,progress:w?y/w:void 0,bytes:C,rate:T||void 0,estimated:T&&w&&y<=w?(w-y)/T:void 0,event:f,lengthComputable:w!=null,[i?"download":"upload"]:!0})},o)},wz=(l,i)=>{let o=l!=null;return[u=>i[0]({lengthComputable:o,total:l,loaded:u}),i[1]]},t4=l=>(...i)=>cr.asap(()=>l(...i)),Rdt=_h.hasStandardBrowserEnv?(Z_=new URL(_h.origin),iQ=_h.navigator&&/(msie|trident)/i.test(_h.navigator.userAgent),l=>(l=new URL(l,_h.origin),Z_.protocol===l.protocol&&Z_.host===l.host&&(iQ||Z_.port===l.port))):()=>!0;var Z_,iQ;let Fdt=_h.hasStandardBrowserEnv?{write(l,i,o,u,c,f){let y=[l+"="+encodeURIComponent(i)];cr.isNumber(o)&&y.push("expires="+new Date(o).toGMTString()),cr.isString(u)&&y.push("path="+u),cr.isString(c)&&y.push("domain="+c),f===!0&&y.push("secure"),document.cookie=y.join("; ")},read(l){let i=document.cookie.match(new RegExp("(^|;\\s*)("+l+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove(l){this.write(l,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function xz(l,i){return l&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)?function(o,u){return u?o.replace(/\/?\/$/,"")+"/"+u.replace(/^\/+/,""):o}(l,i):i}let aQ=l=>l instanceof Vd?yd({},l):l;function i1(l,i){i=i||{};let o={};function u(T,x,A,M){return cr.isPlainObject(T)&&cr.isPlainObject(x)?cr.merge.call({caseless:M},T,x):cr.isPlainObject(x)?cr.merge({},x):cr.isArray(x)?x.slice():x}function c(T,x,A,M){return cr.isUndefined(x)?cr.isUndefined(T)?void 0:u(void 0,T,0,M):u(T,x,0,M)}function f(T,x){if(!cr.isUndefined(x))return u(void 0,x)}function y(T,x){return cr.isUndefined(x)?cr.isUndefined(T)?void 0:u(void 0,T):u(void 0,x)}function w(T,x,A){return A in i?u(T,x):A in l?u(void 0,T):void 0}let C={url:f,method:f,data:f,baseURL:y,transformRequest:y,transformResponse:y,paramsSerializer:y,timeout:y,timeoutMessage:y,withCredentials:y,withXSRFToken:y,adapter:y,responseType:y,xsrfCookieName:y,xsrfHeaderName:y,onUploadProgress:y,onDownloadProgress:y,decompress:y,maxContentLength:y,maxBodyLength:y,beforeRedirect:y,transport:y,httpAgent:y,httpsAgent:y,cancelToken:y,socketPath:y,responseEncoding:y,validateStatus:w,headers:(T,x,A)=>c(aQ(T),aQ(x),0,!0)};return cr.forEach(Object.keys(Object.assign({},l,i)),function(T){let x=C[T]||c,A=x(l[T],i[T],T);cr.isUndefined(A)&&x!==w||(o[T]=A)}),o}let NI=l=>{let i=i1({},l),o,{data:u,withXSRFToken:c,xsrfHeaderName:f,xsrfCookieName:y,headers:w,auth:C}=i;if(i.headers=w=Vd.from(w),i.url=JZ(xz(i.baseURL,i.url),l.params,l.paramsSerializer),C&&w.set("Authorization","Basic "+btoa((C.username||"")+":"+(C.password?unescape(encodeURIComponent(C.password)):""))),cr.isFormData(u)){if(_h.hasStandardBrowserEnv||_h.hasStandardBrowserWebWorkerEnv)w.setContentType(void 0);else if((o=w.getContentType())!==!1){let[T,...x]=o?o.split(";").map(A=>A.trim()).filter(Boolean):[];w.setContentType([T||"multipart/form-data",...x].join("; "))}}if(_h.hasStandardBrowserEnv&&(c&&cr.isFunction(c)&&(c=c(i)),c||c!==!1&&Rdt(i.url))){let T=f&&y&&Fdt.read(y);T&&w.set(f,T)}return i},Odt=typeof XMLHttpRequest<"u"&&function(l){return new Promise(function(i,o){let u=NI(l),c=u.data,f=Vd.from(u.headers).normalize(),y,w,C,T,x,{responseType:A,onUploadProgress:M,onDownloadProgress:$}=u;function V(){T&&T(),x&&x(),u.cancelToken&&u.cancelToken.unsubscribe(y),u.signal&&u.signal.removeEventListener("abort",y)}let G=new XMLHttpRequest;function Q(){if(!G)return;let it=Vd.from("getAllResponseHeaders"in G&&G.getAllResponseHeaders());nQ(function(ht){i(ht),V()},function(ht){o(ht),V()},{data:A&&A!=="text"&&A!=="json"?G.response:G.responseText,status:G.status,statusText:G.statusText,headers:it,config:l,request:G}),G=null}G.open(u.method.toUpperCase(),u.url,!0),G.timeout=u.timeout,"onloadend"in G?G.onloadend=Q:G.onreadystatechange=function(){G&&G.readyState===4&&(G.status!==0||G.responseURL&&G.responseURL.indexOf("file:")===0)&&setTimeout(Q)},G.onabort=function(){G&&(o(new mo("Request aborted",mo.ECONNABORTED,l,G)),G=null)},G.onerror=function(){o(new mo("Network Error",mo.ERR_NETWORK,l,G)),G=null},G.ontimeout=function(){let it=u.timeout?"timeout of "+u.timeout+"ms exceeded":"timeout exceeded",ht=u.transitional||TI;u.timeoutErrorMessage&&(it=u.timeoutErrorMessage),o(new mo(it,ht.clarifyTimeoutError?mo.ETIMEDOUT:mo.ECONNABORTED,l,G)),G=null},c===void 0&&f.setContentType(null),"setRequestHeader"in G&&cr.forEach(f.toJSON(),function(it,ht){G.setRequestHeader(ht,it)}),cr.isUndefined(u.withCredentials)||(G.withCredentials=!!u.withCredentials),A&&A!=="json"&&(G.responseType=u.responseType),$&&([C,x]=K_($,!0),G.addEventListener("progress",C)),M&&G.upload&&([w,T]=K_(M),G.upload.addEventListener("progress",w),G.upload.addEventListener("loadend",T)),(u.cancelToken||u.signal)&&(y=it=>{G&&(o(!it||it.type?new Rm(null,l,G):it),G.abort(),G=null)},u.cancelToken&&u.cancelToken.subscribe(y),u.signal&&(u.signal.aborted?y():u.signal.addEventListener("abort",y)));let nt=function(it){let ht=/^([-+\w]{1,25})(:?\/\/|:)/.exec(it);return ht&&ht[1]||""}(u.url);nt&&_h.protocols.indexOf(nt)===-1?o(new mo("Unsupported protocol "+nt+":",mo.ERR_BAD_REQUEST,l)):G.send(c||null)})},Ldt=(l,i)=>{let{length:o}=l=l?l.filter(Boolean):[];if(i||o){let u,c=new AbortController,f=function(T){if(!u){u=!0,w();let x=T instanceof Error?T:this.reason;c.abort(x instanceof mo?x:new Rm(x instanceof Error?x.message:x))}},y=i&&setTimeout(()=>{y=null,f(new mo(`timeout ${i} of ms exceeded`,mo.ETIMEDOUT))},i),w=()=>{l&&(y&&clearTimeout(y),y=null,l.forEach(T=>{T.unsubscribe?T.unsubscribe(f):T.removeEventListener("abort",f)}),l=null)};l.forEach(T=>T.addEventListener("abort",f));let{signal:C}=c;return C.unsubscribe=()=>cr.asap(w),C}},MI=function*(l,i){let o=l.byteLength;if(o<i)return void(yield l);let u,c=0;for(;c<o;)u=c+i,yield l.slice(c,u),c=u},$dt=function(l){return hbt(this,null,function*(){if(l[Symbol.asyncIterator])return void(yield*OM(l));let i=l.getReader();try{for(;;){let{done:o,value:u}=yield new GW(i.read());if(o)break;yield u}}finally{yield new GW(i.cancel())}})},oQ=(l,i,o,u)=>{let c=function(T,x){return hbt(this,null,function*(){try{for(var A=NNt($dt(T)),M,$,V;M=!($=yield new GW(A.next())).done;M=!1){let G=$.value;yield*OM(MI(G,x))}}catch{V=[$]}finally{try{M&&($=A.return)&&(yield new GW($.call(A)))}finally{if(V)throw V[0]}}})}(l,i),f,y=0,w=T=>{f||(f=!0,u&&u(T))};return new ReadableStream({pull(T){return ce(this,null,function*(){try{let{done:x,value:A}=yield c.next();if(x)return w(),void T.close();let M=A.byteLength;if(o){let $=y+=M;o($)}T.enqueue(new Uint8Array(A))}catch(x){throw w(x),x}})},cancel:T=>(w(T),c.return())},{highWaterMark:2})},DI=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Q_=DI&&typeof ReadableStream=="function",sQ=DI&&(typeof TextEncoder=="function"?(kz=new TextEncoder,l=>kz.encode(l)):l=>ce(this,null,function*(){return new Uint8Array(yield new Response(l).arrayBuffer())}));var kz;let Sz=(l,...i)=>{try{return!!l(...i)}catch{return!1}},zdt=Q_&&Sz(()=>{let l=!1,i=new Request(_h.origin,{body:new ReadableStream,method:"POST",get duplex(){return l=!0,"half"}}).headers.has("Content-Type");return l&&!i}),J_=Q_&&Sz(()=>cr.isReadableStream(new Response("").body)),e4={stream:J_&&(l=>l.body)};var uQ;DI&&(uQ=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(l=>{!e4[l]&&(e4[l]=cr.isFunction(uQ[l])?i=>i[l]():(i,o)=>{throw new mo(`Response type '${l}' is not supported`,mo.ERR_NOT_SUPPORT,o)})}));let Pdt=(l,i)=>ce(this,null,function*(){let o=cr.toFiniteNumber(l.getContentLength());return o??(u=>ce(this,null,function*(){return u==null?0:cr.isBlob(u)?u.size:cr.isSpecCompliantForm(u)?(yield new Request(_h.origin,{method:"POST",body:u}).arrayBuffer()).byteLength:cr.isArrayBufferView(u)||cr.isArrayBuffer(u)?u.byteLength:(cr.isURLSearchParams(u)&&(u+=""),cr.isString(u)?(yield sQ(u)).byteLength:void 0)}))(i)}),Fm={http:null,xhr:Odt,fetch:DI&&(l=>ce(this,null,function*(){let{url:i,method:o,data:u,signal:c,cancelToken:f,timeout:y,onDownloadProgress:w,onUploadProgress:C,responseType:T,headers:x,withCredentials:A="same-origin",fetchOptions:M}=NI(l);T=T?(T+"").toLowerCase():"text";let $,V=Ldt([c,f&&f.toAbortSignal()],y),G=V&&V.unsubscribe&&(()=>{V.unsubscribe()}),Q;try{if(C&&zdt&&o!=="get"&&o!=="head"&&(Q=yield Pdt(x,u))!==0){let Nt,$t=new Request(i,{method:"POST",body:u,duplex:"half"});if(cr.isFormData(u)&&(Nt=$t.headers.get("content-type"))&&x.setContentType(Nt),$t.body){let[Ut,Pt]=wz(Q,K_(t4(C)));u=oQ($t.body,65536,Ut,Pt)}}cr.isString(A)||(A=A?"include":"omit");let nt="credentials"in Request.prototype;$=new Request(i,cbt(yd({},M),{signal:V,method:o.toUpperCase(),headers:x.normalize().toJSON(),body:u,duplex:"half",credentials:nt?A:void 0}));let it=yield fetch($),ht=J_&&(T==="stream"||T==="response");if(J_&&(w||ht&&G)){let Nt={};["status","statusText","headers"].forEach(re=>{Nt[re]=it[re]});let $t=cr.toFiniteNumber(it.headers.get("content-length")),[Ut,Pt]=w&&wz($t,K_(t4(w),!0))||[];it=new Response(oQ(it.body,65536,Ut,()=>{Pt&&Pt(),G&&G()}),Nt)}T=T||"text";let kt=yield e4[cr.findKey(e4,T)||"text"](it,l);return!ht&&G&&G(),yield new Promise((Nt,$t)=>{nQ(Nt,$t,{data:kt,headers:Vd.from(it.headers),status:it.status,statusText:it.statusText,config:l,request:$})})}catch(nt){throw G&&G(),nt&&nt.name==="TypeError"&&/fetch/i.test(nt.message)?Object.assign(new mo("Network Error",mo.ERR_NETWORK,l,$),{cause:nt.cause||nt}):mo.from(nt,nt&&nt.code,l,$)}}))};cr.forEach(Fm,(l,i)=>{if(l){try{Object.defineProperty(l,"name",{value:i})}catch{}Object.defineProperty(l,"adapterName",{value:i})}});let lQ=l=>`- ${l}`,_z=l=>cr.isFunction(l)||l===null||l===!1,RI=l=>{l=cr.isArray(l)?l:[l];let{length:i}=l,o,u,c={};for(let f=0;f<i;f++){let y;if(o=l[f],u=o,!_z(o)&&(u=Fm[(y=String(o)).toLowerCase()],u===void 0))throw new mo(`Unknown adapter '${y}'`);if(u)break;c[y||"#"+f]=u}if(!u){let f=Object.entries(c).map(([w,C])=>`adapter ${w} `+(C===!1?"is not supported by the environment":"is not available in the build")),y=i?f.length>1?`since :
`+f.map(lQ).join(`
`):" "+lQ(f[0]):"as no adapter specified";throw new mo("There is no suitable adapter to dispatch the request "+y,"ERR_NOT_SUPPORT")}return u};function t6(l){if(l.cancelToken&&l.cancelToken.throwIfRequested(),l.signal&&l.signal.aborted)throw new Rm(null,l)}function FI(l){return t6(l),l.headers=Vd.from(l.headers),l.data=vz.call(l,l.transformRequest),["post","put","patch"].indexOf(l.method)!==-1&&l.headers.setContentType("application/x-www-form-urlencoded",!1),RI(l.adapter||H_.adapter)(l).then(function(i){return t6(l),i.data=vz.call(l,l.transformResponse,i),i.headers=Vd.from(i.headers),i},function(i){return X_(i)||(t6(l),i&&i.response&&(i.response.data=vz.call(l,l.transformResponse,i.response),i.response.headers=Vd.from(i.response.headers))),Promise.reject(i)})}let Cz="1.7.8",e6={};["object","boolean","number","function","string","symbol"].forEach((l,i)=>{e6[l]=function(o){return typeof o===l||"a"+(i<1?"n ":" ")+l}});let OI={};e6.transitional=function(l,i,o){function u(c,f){return"[Axios v1.7.8] Transitional option '"+c+"'"+f+(o?". "+o:"")}return(c,f,y)=>{if(l===!1)throw new mo(u(f," has been removed"+(i?" in "+i:"")),mo.ERR_DEPRECATED);return i&&!OI[f]&&(OI[f]=!0,console.warn(u(f," has been deprecated since v"+i+" and will be removed in the near future"))),!l||l(c,f,y)}},e6.spelling=function(l){return(i,o)=>(console.warn(`${o} is likely a misspelling of ${l}`),!0)};let n4={assertOptions:function(l,i,o){if(typeof l!="object")throw new mo("options must be an object",mo.ERR_BAD_OPTION_VALUE);let u=Object.keys(l),c=u.length;for(;c-- >0;){let f=u[c],y=i[f];if(y){let w=l[f],C=w===void 0||y(w,f,l);if(C!==!0)throw new mo("option "+f+" must be "+C,mo.ERR_BAD_OPTION_VALUE)}else if(o!==!0)throw new mo("Unknown option "+f,mo.ERR_BAD_OPTION)}},validators:e6},Ep=n4.validators;class n6{constructor(i){this.defaults=i,this.interceptors={request:new tQ,response:new tQ}}request(i,o){return ce(this,null,function*(){try{return yield this._request(i,o)}catch(u){if(u instanceof Error){let c={};Error.captureStackTrace?Error.captureStackTrace(c):c=new Error;let f=c.stack?c.stack.replace(/^.+\n/,""):"";try{u.stack?f&&!String(u.stack).endsWith(f.replace(/^.+\n.+\n/,""))&&(u.stack+=`
`+f):u.stack=f}catch{}}throw u}})}_request(i,o){typeof i=="string"?(o=o||{}).url=i:o=i||{},o=i1(this.defaults,o);let{transitional:u,paramsSerializer:c,headers:f}=o;u!==void 0&&n4.assertOptions(u,{silentJSONParsing:Ep.transitional(Ep.boolean),forcedJSONParsing:Ep.transitional(Ep.boolean),clarifyTimeoutError:Ep.transitional(Ep.boolean)},!1),c!=null&&(cr.isFunction(c)?o.paramsSerializer={serialize:c}:n4.assertOptions(c,{encode:Ep.function,serialize:Ep.function},!0)),n4.assertOptions(o,{baseUrl:Ep.spelling("baseURL"),withXsrfToken:Ep.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let y=f&&cr.merge(f.common,f[o.method]);f&&cr.forEach(["delete","get","head","post","put","patch","common"],V=>{delete f[V]}),o.headers=Vd.concat(y,f);let w=[],C=!0;this.interceptors.request.forEach(function(V){typeof V.runWhen=="function"&&V.runWhen(o)===!1||(C=C&&V.synchronous,w.unshift(V.fulfilled,V.rejected))});let T=[],x;this.interceptors.response.forEach(function(V){T.push(V.fulfilled,V.rejected)});let A,M=0;if(!C){let V=[FI.bind(this),void 0];for(V.unshift.apply(V,w),V.push.apply(V,T),A=V.length,x=Promise.resolve(o);M<A;)x=x.then(V[M++],V[M++]);return x}A=w.length;let $=o;for(M=0;M<A;){let V=w[M++],G=w[M++];try{$=V($)}catch(Q){G.call(this,Q);break}}try{x=FI.call(this,$)}catch(V){return Promise.reject(V)}for(M=0,A=T.length;M<A;)x=x.then(T[M++],T[M++]);return x}getUri(i){return JZ(xz((i=i1(this.defaults,i)).baseURL,i.url),i.params,i.paramsSerializer)}}cr.forEach(["delete","get","head","options"],function(l){n6.prototype[l]=function(i,o){return this.request(i1(o||{},{method:l,url:i,data:(o||{}).data}))}}),cr.forEach(["post","put","patch"],function(l){function i(o){return function(u,c,f){return this.request(i1(f||{},{method:l,headers:o?{"Content-Type":"multipart/form-data"}:{},url:u,data:c}))}}n6.prototype[l]=i(),n6.prototype[l+"Form"]=i(!0)});let r4=n6;class r6{constructor(i){if(typeof i!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(c){o=c});let u=this;this.promise.then(c=>{if(!u._listeners)return;let f=u._listeners.length;for(;f-- >0;)u._listeners[f](c);u._listeners=null}),this.promise.then=c=>{let f,y=new Promise(w=>{u.subscribe(w),f=w}).then(c);return y.cancel=function(){u.unsubscribe(f)},y},i(function(c,f,y){u.reason||(u.reason=new Rm(c,f,y),o(u.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(i){this.reason?i(this.reason):this._listeners?this._listeners.push(i):this._listeners=[i]}unsubscribe(i){if(!this._listeners)return;let o=this._listeners.indexOf(i);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){let i=new AbortController,o=u=>{i.abort(u)};return this.subscribe(o),i.signal.unsubscribe=()=>this.unsubscribe(o),i.signal}static source(){let i;return{token:new r6(function(o){i=o}),cancel:i}}}let Bdt=r6,LI={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(LI).forEach(([l,i])=>{LI[i]=l});let jdt=LI,Mo=function l(i){let o=new r4(i),u=wI(r4.prototype.request,o);return cr.extend(u,r4.prototype,o,{allOwnKeys:!0}),cr.extend(u,o,null,{allOwnKeys:!0}),u.create=function(c){return l(i1(i,c))},u}(H_);Mo.Axios=r4,Mo.CanceledError=Rm,Mo.CancelToken=Bdt,Mo.isCancel=X_,Mo.VERSION=Cz,Mo.toFormData=CI,Mo.AxiosError=mo,Mo.Cancel=Mo.CanceledError,Mo.all=function(l){return Promise.all(l)},Mo.spread=function(l){return function(i){return l.apply(null,i)}},Mo.isAxiosError=function(l){return cr.isObject(l)&&l.isAxiosError===!0},Mo.mergeConfig=i1,Mo.AxiosHeaders=Vd,Mo.formToJSON=l=>G_(cr.isHTMLForm(l)?new FormData(l):l),Mo.getAdapter=RI,Mo.HttpStatusCode=jdt,Mo.default=Mo;let Ch=Mo;function Tp(l){return new RegExp("^(?:[a-z]+:)?//","i").test(l)}class Udt{constructor(i,o="model",u=!0){let c=u?function(y){if(!Tp(y)&&typeof window<"u"){if(y.startsWith("/"))return window.location.origin+y;let w=window.location.href;return w.endsWith("/")||(w+="/"),w+y}return y}(i):i,f={};if(c.endsWith(".json")){let y=c.lastIndexOf("/")+1;this.directory=c.slice(0,y);let w=c.slice(y,-5);w!==o&&["model","manifest","metadata"].includes(w)?console.warn(`Expected a ${o}.json file URL, but received a ${w}.json file instead.`):f[o]=c}else this.directory=c.endsWith("/")?c:`${c}/`;this.modelUrl=f.model||this.getPath("model.json"),this.metadataUrl=f.metadata||this.getPath("metadata.json"),this.manifestUrl=f.manifest||this.getPath("manifest.json")}getPath(i){return Tp(i)?i:this.directory+i}loadManifestJson(){return ce(this,null,function*(){try{return(yield Ch.get(this.manifestUrl)).data}catch(i){throw new Error(`Error loading manifest.json file from URL ${this.manifestUrl}: ${String(i)}`)}})}loadMetadataJson(){return ce(this,null,function*(){try{return(yield Ch.get(this.metadataUrl)).data}catch(i){throw new Error(`Error loading metadata.json file from URL ${this.metadataUrl}: ${String(i)}`)}})}loadLayersModel(i){return ce(this,null,function*(){let o=i?this.getPath(i):this.modelUrl;try{return yield Dd(o)}catch(u){throw new Error(`Error loading model from URL ${o}: ${String(u)}`)}})}}function i4(l,i,o){return new Udt(l,i,o)}class K2{constructor(i){this.options=i||{}}normalizeValue(i,o,u){return o===u?0:(i-o)/(u-o)}unnormalizeValue(i,o,u){return o===u?o:i*(u-o)+o}getMin(i){return i.reduce((o,u)=>Math.min(o,u))}getMax(i){return i.reduce((o,u)=>Math.max(o,u))}isJsonOrString(i){try{JSON.parse(i)}catch{return!1}return!0}zipArrays(i,o){return i.length!==o.length?(console.error("arrays do not have the same length"),[]):[...new Array(i.length).fill(null)].map((u,c)=>yd(yd({},i[c]),o[c]))}createLabelsFromArrayValues(i,o){let u;return Array.isArray(i)&&(u=i.map((c,f)=>`${o}_${f}`)),u}formatDataAsObject(i,o){let u={};if(Array.isArray(i))return i.forEach((c,f)=>{let y=o[f];u[y]=c}),u;if(typeof i=="object")return u=i,u;throw new Error("input provided is not supported or does not match your output label specifications")}getDataType(i){let o=typeof i;return o==="object"&&Array.isArray(i)&&(o="array"),o}}let gc=new K2,Wdt=class{constructor(){this.meta={inputUnits:null,outputUnits:null,inputs:{},outputs:{},isNormalized:!1},this.isMetadataReady=!1,this.isWarmedUp=!1,this.data={raw:[]}}createMetadata(l=null){this.getDTypesFromData(),this.getDataStats(),this.getDataOneHot(),this.getDataUnits(l),this.isMetadataReady=!0}getDataStats(){this.meta.inputs=this.getInputMetaStats(this.meta.inputs,"xs"),this.meta.outputs=this.getInputMetaStats(this.meta.outputs,"ys")}getInputMetaStats(l,i){let o=Object.assign({},l);return Object.keys(o).forEach(u=>{if(o[u].dtype==="string")o[u].min=0,o[u].max=1;else if(o[u].dtype==="number"){let c=this.data.raw.map(f=>f[i][u]);o[u].min=gc.getMin(c),o[u].max=gc.getMax(c)}else if(o[u].dtype==="array"){let c=this.data.raw.map(f=>f[i][u]).flat();o[u].min=gc.getMin(c),o[u].max=gc.getMax(c)}}),o}getDataUnits(l=null){this.meta.inputUnits=l||[this.getInputMetaUnits(this.meta.inputs)].flat(),this.meta.outputUnits=this.getInputMetaUnits(this.meta.outputs)}getInputMetaUnits(l){let i=0;return Object.entries(l).forEach(o=>{let{dtype:u}=o[1];if(u==="number")i+=1;else if(u==="string"){let{uniqueValues:c}=o[1],f=c.length;i+=f}else u==="array"&&(i=[])}),i}getDTypesFromData(){let l=cbt(yd({},this.meta),{inputs:{},outputs:{}}),i=this.data.raw[0],o=Object.keys(i.xs),u=Object.keys(i.ys);o.forEach(c=>{l.inputs[c]={dtype:gc.getDataType(i.xs[c])}}),u.forEach(c=>{l.outputs[c]={dtype:gc.getDataType(i.ys[c])}}),this.meta=l}addData(l,i){this.data.raw.push({xs:l,ys:i})}convertRawToTensors(l){let i=Object.assign({},this.meta),o=l.length;return m.tidy(()=>{let u=[],c=[];return l.forEach(f=>{let y=Object.keys(i.inputs).map(C=>f.xs[C]).flat();u.push(y);let w=Object.keys(i.outputs).map(C=>f.ys[C]).flat();c.push(w)}),{inputs:m.tensor(u.flat(),[o,...i.inputUnits]),outputs:m.tensor(c.flat(),[o,i.outputUnits])}})}normalizeDataRaw(){let l=this.normalizeInputData(this.meta.inputs,"xs"),i=this.normalizeInputData(this.meta.outputs,"ys");return gc.zipArrays(l,i)}normalizeInputData(l,i){let o=this.data.raw,u=o.length,c=Object.assign({},l),f={};return Object.keys(c).forEach(y=>{let w={min:c[y].min,max:c[y].max},C=o.map(T=>T[i][y]);c[y].dtype==="string"?(w.legend=c[y].legend,f[y]=this.normalizeArray(C,w)):c[y].dtype==="number"?f[y]=this.normalizeArray(C,w):c[y].dtype==="array"&&(f[y]=C.map(T=>this.normalizeArray(T,w)))}),[...new Array(u).fill(null)].map((y,w)=>{let C={[i]:{}};return Object.keys(c).forEach(T=>{C[i][T]=f[T][w]}),C})}normalizeArray(l,i){let{min:o,max:u}=i;if(i.legend)return l.map(c=>i.legend[c]?i.legend[c]:c);if(o===u&&console.warn("\u{1F7EA} ml5.js NeuralNetwork warns: Normalization failed, all data entries for an input parameter are identical (min === max). The data for this input parameter will be set to 0, effectively removing it from the model. Please check your input data."),l.every(c=>typeof c=="number"))return l.map(c=>gc.normalizeValue(c,o,u));throw new Error("error in inputArray of normalizeArray() function")}unnormalizeArray(l,i){let{min:o,max:u}=i;if(i.legend)return l.map(f=>{let y;return Object.entries(i.legend).forEach(w=>{let C=w[0],T=w[1];f.map((x,A)=>x===T[A]).every(x=>x===!0)&&(y=C)}),y});if(l.every(c=>typeof c=="number"))return l.map(c=>gc.unnormalizeValue(c,o,u));throw new Error("error in inputArray of normalizeArray() function")}applyOneHotEncodingsToDataRaw(){let l=Object.assign({},this.meta);return this.data.raw.map(i=>{let o=yd({},i.xs),u=yd({},i.ys);return Object.keys(l.inputs).forEach(c=>{l.inputs[c].legend&&(o[c]=l.inputs[c].legend[i.xs[c]])}),Object.keys(l.outputs).forEach(c=>{l.outputs[c].legend&&(u[c]=l.outputs[c].legend[i.ys[c]])}),{xs:o,ys:u}})}getDataOneHot(){this.meta.inputs=this.getInputMetaOneHot(this.meta.inputs,"xs"),this.meta.outputs=this.getInputMetaOneHot(this.meta.outputs,"ys")}getInputMetaOneHot(l,i){let o=Object.assign({},l);return Object.entries(o).forEach(u=>{let c=u[0],{dtype:f}=u[1];if(f==="string"){let y=[...new Set(this.data.raw.map(C=>C[i][c]))],w=this.createOneHotEncodings(y);o[c]=yd(yd({},o[c]),w)}}),o}createOneHotEncodings(l){return m.tidy(()=>{let i={uniqueValues:l,legend:{}},o=l,u=o.map((f,y)=>y),c=m.oneHot(m.tensor1d(u,"int32"),o.length).arraySync();return o.forEach((f,y)=>{i.legend[f]=c[y]}),i})}loadDataFromUrl(l,i,o){return ce(this,null,function*(){try{if(l.endsWith(".csv"))yield this.loadCSV(l,i,o);else if(l.endsWith(".json"))yield this.loadJSON(l,i,o);else{if(!l.includes("blob"))throw new Error("Not a valid data format. Must be csv or json");yield this.loadBlob(l,i,o)}}catch(u){throw console.error(u),new Error(u)}})}loadJSON(l,i,o){return ce(this,null,function*(){try{let u;if(l instanceof Object)u=Object.assign({},l);else{let{data:c}=yield Ch.get(l);u=c}this.formatRawData(u,i,o)}catch(u){throw console.error("error loading json"),new Error(u)}})}loadCSV(l,i,o){return ce(this,null,function*(){try{let u=ZF(l),c={entries:yield u.toArray()};this.formatRawData(c,i,o)}catch(u){throw console.error("error loading csv",u),new Error(u)}})}loadBlob(l,i,o){return ce(this,null,function*(){try{let{data:u}=yield Ch.get(l),c=u;if(gc.isJsonOrString(c)){let f=JSON.parse(c);yield this.loadJSON(f,i,o)}else{let f=this.csvToJSON(c);yield this.loadJSON(f,i,o)}}catch(u){throw console.log("mmm might be passing in a string or something!",u),new Error(u)}})}loadData(l){return ce(this,null,function*(){try{let i;if(typeof l!="string"){let o=l[0];if(new FileReader().readAsText(o),o.name.includes(".json")){let u=yield o.text();i=JSON.parse(u)}else console.log('data must be a json object containing an array called "data" or "entries')}else{let o=yield Ch.get(l,{responseType:"text"});gc.isJsonOrString(o.data)?i=JSON.parse(o.data):console.error("\u{1F7EA} ml5.js error: `NeuralNetwork.loadData` only accepts JSON data.")}this.data.raw=this.findEntries(i),!this.data.raw.length>0&&console.error("\u{1F7EA} ml5.js error: `NeuralNetwork.loadData` only accepts JSON objects with a 'data' property.")}catch(i){throw new Error(i)}})}saveData(l){return ce(this,null,function*(){let i=new Date,o=`${`${String(i.getFullYear())}-${String(i.getMonth()+1)}-${String(i.getDate())}`}_${`${String(i.getHours())}-${String(i.getMinutes())}-${String(i.getSeconds())}`}`;l&&(o=l);let u={data:this.data.raw};yield jx(JSON.stringify(u),`${o}.json`,"text/plain")})}saveMeta(l="model"){return ce(this,null,function*(){yield jx(JSON.stringify(this.meta),`${l}_meta.json`,"text/plain")})}loadMeta(l){return ce(this,null,function*(){if(l instanceof FileList){let i=Array.from(l).find(u=>u.name.includes("_meta.json"));if(!i)return void console.warn("no model_meta.json file found in FileList");let o=yield i.text();this.meta=JSON.parse(o)}else if(l instanceof Object){let i=yield Ch.get(l.metadata);this.meta=i.data}else{let i=i4(l).getPath("model_meta.json"),o=yield Ch.get(i);this.meta=o.data}this.isMetadataReady=!0,this.isWarmedUp=!0})}formatRawData(l,i,o){let u=this.findEntries(l);!u.length>0&&console.log(`your data must be contained in an array in 

        a property called 'entries' or 'data' of your json object`);let c=u.map((f,y)=>{let w={xs:{},ys:{}};return i.forEach(C=>{f[C]!==void 0?w.xs[C]=f[C]:console.error(`the input label ${C} does not exist at row ${y}`)}),o.forEach(C=>{f[C]!==void 0?w.ys[C]=f[C]:console.error(`the output label ${C} does not exist at row ${y}`)}),w});this.data.raw=c}csvToJSON(l){let i=l.split(`
`),o=[],u=i[0].split(",");for(let c=1;c<i.length;c+=1){let f={},y=i[c].split(",");u.forEach((w,C)=>{f[w]=y[C]}),o.push(f)}return{entries:o}}findEntries(l){let i=Object.assign({},l);return i.entries&&i.entries instanceof Array?i.entries:i.data&&i.data instanceof Array?i.data:(Object.keys(i).forEach(o=>{if(typeof i[o]=="object")return this.findEntries(i[o])}),i)}getData(){return this.data.raw}};var a4=F(9778);let Vdt=class{constructor(){this.config={height:300}}modelSummary(l,i){let o=yd({},l);a4.show.modelSummary(o,i)}scatterplot(l,i,o){let u=o.map(f=>({x:f.xs[l],y:f.ys[i]})),c={xLabel:"X",yLabel:"Y",height:this.config.height};a4.render.scatterplot({name:"debug mode"},u,c)}scatterplotAll(l,i,o){let u=[];l.forEach(f=>{i.forEach(y=>{let w=o.map(C=>({x:C.xs[f],y:C.ys[y]}));u=[...u,...w]})});let c={xLabel:"X",yLabel:"Y",height:this.config.height};a4.render.scatterplot({name:"debug mode"},u,c)}barchart(l,i,o){let u=o.map(f=>({value:f.xs[l],index:f.ys[i]})),c={xLabel:"label",yLabel:"value",height:this.config.height};console.log(c),a4.render.barchart({name:"Bar chart"},u)}trainingVis(){return a4.show.fitCallbacks({name:"Training Performance"},["loss","accuracy"],{height:this.config.height,callbacks:["onEpochEnd"]})}},$I={inputs:[],outputs:[],dataUrl:null,modelUrl:null,layers:[],task:null,debug:!1,learningRate:.2,hiddenUnits:16,neuroEvolution:!1};class Ez{constructor(i,o){i.task==="imageClassification"&&($I.learningRate=.02),this.options=yd(yd({},$I),i)||$I,this.neuralNetwork=new oz,this.neuralNetworkData=new Wdt,this.neuralNetworkVis=new Vdt,this.data={training:[]},this.init=this.init.bind(this),this.addData=this.addData.bind(this),this.loadDataFromUrl=this.loadDataFromUrl.bind(this),this.createMetaData=this.createMetaData.bind(this),this.prepareForTraining=this.prepareForTraining.bind(this),this.normalizeData=this.normalizeData.bind(this),this.normalizeInput=this.normalizeInput.bind(this),this.searchAndFormat=this.searchAndFormat.bind(this),this.formatInputItem=this.formatInputItem.bind(this),this.convertTrainingDataToTensors=this.convertTrainingDataToTensors.bind(this),this.formatInputsForPrediction=this.formatInputsForPrediction.bind(this),this.formatInputsForPredictionAll=this.formatInputsForPredictionAll.bind(this),this.isOneHotEncodedOrNormalized=this.isOneHotEncodedOrNormalized.bind(this),this.train=this.train.bind(this),this.trainInternal=this.trainInternal.bind(this),this.addLayer=this.addLayer.bind(this),this.createNetworkLayers=this.createNetworkLayers.bind(this),this.addDefaultLayers=this.addDefaultLayers.bind(this),this.compile=this.compile.bind(this),this.predict=this.predict.bind(this),this.predictMultiple=this.predictMultiple.bind(this),this.classify=this.classify.bind(this),this.classifyMultiple=this.classifyMultiple.bind(this),this.predictInternal=this.predictInternal.bind(this),this.classifyInternal=this.classifyInternal.bind(this),this.saveData=this.saveData.bind(this),this.loadData=this.loadData.bind(this),this.save=this.save.bind(this),this.load=this.load.bind(this),this.dispose=this.dispose.bind(this),this.mutate=this.mutate.bind(this),this.crossover=this.crossover.bind(this),this.ready=Ws(this.init(),o)}init(){return ce(this,null,function*(){return this.options.neuroEvolution===!0&&this.createLayersNoTraining(),this.options.dataUrl?yield this.loadDataFromUrl():this.options.modelUrl&&(yield this.load(this.options.modelUrl)),this})}createLayersNoTraining(){let{inputs:i,outputs:o,task:u}=this.options;if(u==="classification")for(let c=0;c<o.length;c+=1){let f=new Array(i).fill(0);this.addData(f,[o[c]])}else{let c=new Array(i).fill(0),f=new Array(o).fill(0);this.addData(c,f)}this.neuralNetworkData.createMetadata(),this.addDefaultLayers()}copy(){let i=new Ez(this.options);return m.tidy(()=>{let o=this.neuralNetwork.model.getWeights(),u=[];for(let c=0;c<o.length;c+=1)u[c]=o[c].clone();return i.neuralNetwork.model.setWeights(u),i})}addData(i,o,u=null){let{inputs:c,outputs:f}=this.options,y,w;if(u!==null?(y=u.inputLabels,w=u.outputLabels):c.length>0&&f.length>0?(c.every(A=>typeof A=="string")&&(y=c),f.every(A=>typeof A=="string")&&(w=f)):typeof i=="object"&&typeof o=="object"?(y=Object.keys(i),w=Object.keys(o)):(y=gc.createLabelsFromArrayValues(i,"input"),w=gc.createLabelsFromArrayValues(o,"output")),!(y instanceof Array))throw new Error("inputLabels must be an array");if(!(w instanceof Array))throw new Error("outputLabels must be an array");let C=this.searchAndFormat(i),T=gc.formatDataAsObject(C,y),x=gc.formatDataAsObject(o,w);this.neuralNetworkData.addData(T,x)}loadDataFromUrl(){return ce(this,null,function*(){let{dataUrl:i,inputs:o,outputs:u}=this.options;yield this.neuralNetworkData.loadDataFromUrl(i,o,u),this.createMetaData(),this.prepareForTraining()})}createMetaData(){let{inputs:i}=this.options,o;Array.isArray(i)&&i.length>0&&(o=i.every(u=>typeof u=="number")&&i.length>0?i:null),this.neuralNetworkData.createMetadata(o)}prepareForTraining(){this.data.training=this.neuralNetworkData.applyOneHotEncodingsToDataRaw(),this.neuralNetworkData.isWarmedUp=!0}normalizeData(){this.neuralNetworkData.isMetadataReady||this.createMetaData(),this.neuralNetworkData.isWarmedUp||this.prepareForTraining();let i=this.neuralNetworkData.normalizeDataRaw();this.data.training=i,this.neuralNetworkData.meta.isNormalized=!0}normalizeInput(i,o,u){let c=o,{min:f,max:y}=u[c];return gc.normalizeValue(i,f,y)}searchAndFormat(i){let o;if(Array.isArray(i))o=i.map(u=>this.formatInputItem(u));else if(typeof i=="object"){let u=Object.assign({},i);Object.keys(i).forEach(c=>{let f=i[c];u[c]=this.formatInputItem(f)}),o=u}return o}formatInputItem(i){let o,u;return iz(i)?o=i:typeof i=="object"&&iz(i.elt)?o=i.elt:typeof i=="object"&&iz(i.canvas)&&(o=i.canvas),u=o?function(c){let f=Bx(c),y=f.getContext("2d").getImageData(0,0,f.width,f.height);return Array.from(y.data)}(o):i,u}convertTrainingDataToTensors(){return this.neuralNetworkData.convertRawToTensors(this.data.training)}formatInputsForPrediction(i){let{meta:o}=this.neuralNetworkData,u=Object.keys(o.inputs),c=[];return i instanceof Array?c=u.map((f,y)=>this.isOneHotEncodedOrNormalized(i[y],f,o.inputs)):i instanceof Object&&(c=u.map(f=>this.isOneHotEncodedOrNormalized(i[f],f,o.inputs))),c=c.flat(),c}formatInputsForPredictionAll(i){let{meta:o}=this.neuralNetworkData,u=Object.keys(o.inputs),c;return i instanceof Array&&i.every(f=>Array.isArray(f))?(c=i.map(f=>this.formatInputsForPrediction(f)),m.tensor(c,[i.length,u.length])):(c=this.formatInputsForPrediction(i),m.tensor([c]))}isOneHotEncodedOrNormalized(i,o,u){let c=i,f=o,y;return typeof i!="number"?y=u[f].legend[c]:(y=i,this.neuralNetworkData.meta.isNormalized&&(y=this.normalizeInput(i,f,u))),y}train(i,o,u){return ce(this,null,function*(){let c,f,y;return typeof i=="object"&&typeof o=="function"&&typeof u=="function"?(c=i,f=o,y=u):typeof i=="object"&&typeof o=="function"?(c=i,f=null,y=o):typeof i=="function"&&typeof o=="function"?(c={},f=i,y=o):(c={},f=null,y=i),Ws(this.trainInternal(c,f),y)})}trainInternal(i,o){return ce(this,null,function*(){let u=yd({epochs:10,batchSize:32,validationSplit:.1,whileTraining:null},i);if(this.options.debug===!0||this.options.debug==="true"?u.whileTraining=[this.neuralNetworkVis.trainingVis(),{onEpochEnd:o}]:u.whileTraining=[{onEpochEnd:o}],this.neuralNetworkData.isMetadataReady||this.createMetaData(),this.neuralNetworkData.isWarmedUp||this.prepareForTraining(),!u.inputs&&!u.outputs){let{inputs:c,outputs:f}=this.convertTrainingDataToTensors();u.inputs=c,u.outputs=f}this.neuralNetwork.isLayered||(this.options.layers=this.createNetworkLayers(this.options.layers)),this.neuralNetwork.isLayered||(this.options.layers=this.addDefaultLayers()),this.neuralNetwork.isCompiled||this.compile(),yield this.neuralNetwork.train(u)})}addLayer(i){this.neuralNetwork.addLayer(i)}createNetworkLayers(i){let o=[...i],{inputUnits:u,outputUnits:c}=this.neuralNetworkData.meta,f=o.length;if(!(o.length>=2))return!1;o[0].inputShape=o[0].inputShape?o[0].inputShape:u;let y=o[f-1];return y.units=y.units?y.units:c,o.forEach(w=>{this.addLayer(S[w.type](w))}),o}addDefaultLayers(){let i;switch(this.options.task.toLowerCase()){case"classification":return i=[{type:"dense",units:this.options.hiddenUnits,activation:"relu"},{type:"dense",activation:"softmax"}],this.createNetworkLayers(i);case"regression":return i=[{type:"dense",units:this.options.hiddenUnits,activation:"relu"},{type:"dense",activation:"sigmoid"}],this.createNetworkLayers(i);case"imageclassification":return i=[{type:"conv2d",filters:8,kernelSize:5,strides:1,activation:"relu",kernelInitializer:"varianceScaling"},{type:"maxPooling2d",poolSize:[2,2],strides:[2,2]},{type:"conv2d",filters:16,kernelSize:5,strides:1,activation:"relu",kernelInitializer:"varianceScaling"},{type:"maxPooling2d",poolSize:[2,2],strides:[2,2]},{type:"flatten"},{type:"dense",kernelInitializer:"varianceScaling",activation:"softmax"}],this.createNetworkLayers(i);default:return console.log("no imputUnits or outputUnits defined"),i=[{type:"dense",units:this.options.hiddenUnits,activation:"relu"},{type:"dense",activation:"sigmoid"}],this.createNetworkLayers(i)}}compile(){let i=this.options.learningRate,o={};this.options.task==="classification"||this.options.task==="imageClassification"?o={loss:"categoricalCrossentropy",optimizer:m.train.sgd,metrics:["accuracy"]}:this.options.task==="regression"&&(o={loss:"meanSquaredError",optimizer:m.train.adam,metrics:["accuracy"]}),o.optimizer=o.optimizer?this.neuralNetwork.setOptimizerFunction(i,o.optimizer):this.neuralNetwork.setOptimizerFunction(i,m.train.sgd),this.neuralNetwork.compile(o),this.options.debug&&this.neuralNetworkVis.modelSummary({name:"Model Summary"},this.neuralNetwork.model)}predictSync(i){return this.predictSyncInternal(i)}predict(i,o){return Ws(this.predictInternal(i),o)}predictMultiple(i,o){return Ws(this.predictInternal(i),o)}classifySync(i){return this.classifySyncInternal(i)}classify(i,o){return Ws(this.classifyInternal(i),o)}classifyMultiple(i,o){return Ws(this.classifyInternal(i),o)}predictSyncInternal(i){let{meta:o}=this.neuralNetworkData,u=this.formatInputsForPredictionAll(i),c=this.neuralNetwork.predictSync(u);if(u.dispose(),o!==null){let f=Object.keys(o.outputs),y=c.map(w=>f.map((C,T)=>{let x,A;if(o.isNormalized){let{min:$,max:V}=o.outputs[C];x=gc.unnormalizeValue(w[T],$,V),A=w[T]}else x=w[T];let M={[f[T]]:x,label:C,value:x};return A&&(M.unNormalizedValue=A),M}));return y.length<2?y[0]:y}return c}predictInternal(i){return ce(this,null,function*(){let{meta:o}=this.neuralNetworkData,u=this.formatInputsForPredictionAll(i),c=yield this.neuralNetwork.predict(u);if(u.dispose(),o!==null){let f=Object.keys(o.outputs),y=c.map(w=>f.map((C,T)=>{let x,A;if(o.isNormalized){let{min:$,max:V}=o.outputs[C];x=gc.unnormalizeValue(w[T],$,V),A=w[T]}else x=w[T];let M={[f[T]]:x,label:C,value:x};return A&&(M.unNormalizedValue=A),M}));return y.length<2?y[0]:y}return c})}classifySyncInternal(i){let{meta:o}=this.neuralNetworkData,u=Object.keys(o.inputs),c;if(this.options.task==="imageClassification"){if(c=this.searchAndFormat(i),c=Array.isArray(c)?c.flat():c[u[0]],o.isNormalized){let{min:y,max:w}=o.inputs[u[0]];c=this.neuralNetworkData.normalizeArray(Array.from(c),{min:y,max:w})}else c=Array.from(c);c=m.tensor([c],[1,...o.inputUnits])}else c=this.formatInputsForPredictionAll(i);let f=this.neuralNetwork.classifySync(c);if(c.dispose(),o!==null){let y=Object.keys(o.outputs)[0],w=Object.entries(o.outputs[y].legend),C=f.map(T=>w.map((x,A)=>({[x[0]]:T[A],label:x[0],confidence:T[A]})).sort((x,A)=>A.confidence-x.confidence));return C.length<2?C[0]:C}return f}classifyInternal(i){return ce(this,null,function*(){let{meta:o}=this.neuralNetworkData,u=Object.keys(o.inputs),c;if(this.options.task==="imageClassification"){if(c=this.searchAndFormat(i),c=Array.isArray(c)?c.flat():c[u[0]],o.isNormalized){let{min:y,max:w}=o.inputs[u[0]];c=this.neuralNetworkData.normalizeArray(Array.from(c),{min:y,max:w})}else c=Array.from(c);c=m.tensor([c],[1,...o.inputUnits])}else c=this.formatInputsForPredictionAll(i);let f=yield this.neuralNetwork.classify(c);if(c.dispose(),o!==null){let y=Object.keys(o.outputs)[0],w=Object.entries(o.outputs[y].legend);w.sort((T,x)=>x[1].reduce((A,M)=>2*A+M,0)-T[1].reduce((A,M)=>2*A+M,0));let C=f.map(T=>w.map((x,A)=>({[x[0]]:T[A],label:x[0],confidence:T[A]})).sort((x,A)=>A.confidence-x.confidence));return C.length<2?C[0]:C}return f})}saveData(i,o){let u=Uu(i,o);return Ws(this.neuralNetworkData.saveData(u.name),u.callback)}loadData(i,o){return ce(this,null,function*(){return Ws(this.neuralNetworkData.loadData(i),o)})}save(i,o){return ce(this,null,function*(){let u=Uu(i,o),c=u.string||"model";return Ws(Promise.all([this.neuralNetwork.save(c),this.neuralNetworkData.saveMeta(c)]),u.callback)})}load(i,o){return ce(this,null,function*(){return Ws(Promise.all([this.neuralNetwork.load(i),this.neuralNetworkData.loadMeta(i)]),o)})}dispose(){this.neuralNetwork.dispose()}mutate(i,o){this.neuralNetwork.mutate(i,o)}crossover(i){let o=this.copy();return o.neuralNetwork.crossover(i.neuralNetwork),o}}let Gdt=(l,i,o)=>{let u,c;return l instanceof Object?(u=l,c=i):(u={inputs:l,outputs:i},c=o),new Ez(u,c)};var Hdt=F(8554),yc=function(){return yc=Object.assign||function(l){for(var i,o=1,u=arguments.length;o<u;o++)for(var c in i=arguments[o])Object.prototype.hasOwnProperty.call(i,c)&&(l[c]=i[c]);return l},yc.apply(this,arguments)};function Ap(l,i,o,u){return new(o||(o=Promise))(function(c,f){function y(T){try{C(u.next(T))}catch(x){f(x)}}function w(T){try{C(u.throw(T))}catch(x){f(x)}}function C(T){var x;T.done?c(T.value):(x=T.value,x instanceof o?x:new o(function(A){A(x)})).then(y,w)}C((u=u.apply(l,[])).next())})}function Ef(l,i){var o,u,c,f,y={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return f={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function w(C){return function(T){return function(x){if(o)throw new TypeError("Generator is already executing.");for(;f&&(f=0,x[0]&&(y=0)),y;)try{if(o=1,u&&(c=2&x[0]?u.return:x[0]?u.throw||((c=u.return)&&c.call(u),0):u.next)&&!(c=c.call(u,x[1])).done)return c;switch(u=0,c&&(x=[2&x[0],c.value]),x[0]){case 0:case 1:c=x;break;case 4:return y.label++,{value:x[1],done:!1};case 5:y.label++,u=x[1],x=[0];continue;case 7:x=y.ops.pop(),y.trys.pop();continue;default:if(!((c=(c=y.trys).length>0&&c[c.length-1])||x[0]!==6&&x[0]!==2)){y=0;continue}if(x[0]===3&&(!c||x[1]>c[0]&&x[1]<c[3])){y.label=x[1];break}if(x[0]===6&&y.label<c[1]){y.label=c[1],c=x;break}if(c&&y.label<c[2]){y.label=c[2],y.ops.push(x);break}c[2]&&y.ops.pop(),y.trys.pop();continue}x=i.call(l,y)}catch(A){x=[6,A],u=0}finally{o=c=0}if(5&x[0])throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}([C,T])}}}typeof SuppressedError=="function"&&SuppressedError;var i6=["wrist","thumb_cmc","thumb_mcp","thumb_ip","thumb_tip","index_finger_mcp","index_finger_pip","index_finger_dip","index_finger_tip","middle_finger_mcp","middle_finger_pip","middle_finger_dip","middle_finger_tip","ring_finger_mcp","ring_finger_pip","ring_finger_dip","ring_finger_tip","pinky_finger_mcp","pinky_finger_pip","pinky_finger_dip","pinky_finger_tip"],a6={runtime:"mediapipe",maxHands:2,modelType:"full"},Tz=function(){function l(i){var o,u=this;this.width=0,this.height=0,this.selfieMode=!1,this.handsSolution=new Hdt.Hands({locateFile:function(c,f){return i.solutionPath?i.solutionPath.replace(/\/+$/,"")+"/"+c:f+"/"+c}}),o=i.modelType==="lite"?0:1,this.handsSolution.setOptions({modelComplexity:o,selfieMode:this.selfieMode,maxNumHands:i.maxHands}),this.handsSolution.onResults(function(c){if(u.height=c.image.height,u.width=c.image.width,u.hands=[],c.multiHandLandmarks!==null)for(var f=c.multiHandedness,y=c.multiHandLandmarks,w=c.multiHandWorldLandmarks,C=0;C<f.length;C++)u.hands.push(yc(yc({},u.translateOutput(y[C],w[C])),{score:f[C].score,handedness:f[C].label}))})}return l.prototype.translateOutput=function(i,o){var u=this;return{keypoints:i.map(function(c,f){return{x:c.x*u.width,y:c.y*u.height,score:c.visibility,name:i6[f]}}),keypoints3D:o.map(function(c,f){return{x:c.x,y:c.y,z:c.z,score:c.visibility,name:i6[f]}})}},l.prototype.estimateHands=function(i,o){return Ap(this,void 0,void 0,function(){var u,c;return Ef(this,function(f){switch(f.label){case 0:return o&&o.flipHorizontal&&o.flipHorizontal!==this.selfieMode&&(this.selfieMode=o.flipHorizontal,this.handsSolution.setOptions({selfieMode:this.selfieMode})),i instanceof m.Tensor?(c=ImageData.bind,[4,m.browser.toPixels(i)]):[3,2];case 1:return u=new(c.apply(ImageData,[void 0,f.sent(),i.shape[1],i.shape[0]])),[3,3];case 2:u=i,f.label=3;case 3:return i=u,[4,this.handsSolution.send({image:i})];case 4:return f.sent(),[2,this.hands]}})})},l.prototype.dispose=function(){this.handsSolution.close()},l.prototype.reset=function(){this.handsSolution.reset(),this.width=0,this.height=0,this.hands=null,this.selfieMode=!1},l.prototype.initialize=function(){return this.handsSolution.initialize()},l}();function Az(l){return Ap(this,void 0,void 0,function(){var i,o;return Ef(this,function(u){switch(u.label){case 0:return i=function(c){if(c==null)return yc({},a6);var f=yc({},c);return f.runtime="mediapipe",f.maxHands==null&&(f.maxHands=a6.maxHands),f.modelType==null&&(f.modelType=a6.modelType),f}(l),[4,(o=new Tz(i)).initialize()];case 1:return u.sent(),[2,o]}})})}function zI(l){return l.width*l.height}function o6(l){var i=l.xCenter-l.width/2,o=i+l.width,u=l.yCenter-l.height/2;return{xMin:i,xMax:o,yMin:u,yMax:u+l.height,width:l.width,height:l.height}}function s6(l){return l instanceof m.Tensor?{height:l.shape[0],width:l.shape[1]}:{height:l.height,width:l.width}}function o4(l){return l-2*Math.PI*Math.floor((l+Math.PI)/(2*Math.PI))}function PI(l){return l instanceof m.Tensor?l:m.browser.fromPixels(l)}function s4(l,i){m.util.assert(l.width!==0,function(){return i+" width cannot be 0."}),m.util.assert(l.height!==0,function(){return i+" height cannot be 0."})}function cQ(l,i,o){var u=i.outputTensorSize,c=i.keepAspectRatio,f=i.borderMode,y=i.outputTensorFloatRange,w=s6(l),C=function(M,$){return $?{xCenter:$.xCenter*M.width,yCenter:$.yCenter*M.height,width:$.width*M.width,height:$.height*M.height,rotation:$.rotation}:{xCenter:.5*M.width,yCenter:.5*M.height,width:M.width,height:M.height,rotation:0}}(w,o),T=function(M,$,V){if(V===void 0&&(V=!1),!V)return{top:0,left:0,right:0,bottom:0};var G=$.height,Q=$.width;s4($,"targetSize"),s4(M,"roi");var nt,it,ht=G/Q,kt=M.height/M.width,Nt=0,$t=0;return ht>kt?(nt=M.width,it=M.width*ht,$t=(1-kt/ht)/2):(nt=M.height/ht,it=M.height,Nt=(1-ht/kt)/2),M.width=nt,M.height=it,{top:$t,left:Nt,right:Nt,bottom:$t}}(C,u,c),x=function(M,$,V,G){var Q=M.width,nt=M.height,it=1,ht=Math.cos(M.rotation),kt=Math.sin(M.rotation),Nt=M.xCenter,$t=M.yCenter,Ut=1/$,Pt=1/V,re=new Array(16);return re[0]=Q*ht*it*Ut,re[1]=-nt*kt*Ut,re[2]=0,re[3]=(-.5*Q*ht*it+.5*nt*kt+Nt)*Ut,re[4]=Q*kt*it*Pt,re[5]=nt*ht*Pt,re[6]=0,re[7]=(-.5*nt*ht-.5*Q*kt*it+$t)*Pt,re[8]=0,re[9]=0,re[10]=Q*Ut,re[11]=0,re[12]=0,re[13]=0,re[14]=0,re[15]=1,function(ue){if(ue.length!==16)throw new Error("Array length must be 16 but got "+ue.length);return[[ue[0],ue[1],ue[2],ue[3]],[ue[4],ue[5],ue[6],ue[7]],[ue[8],ue[9],ue[10],ue[11]],[ue[12],ue[13],ue[14],ue[15]]]}(re)}(C,w.width,w.height),A=(0,m.tidy)(function(){var M=PI(l),$=(0,m.tensor2d)(function(Q,nt,it){return s4(it,"inputResolution"),[1/it.width*Q[0][0]*nt.width,1/it.height*Q[0][1]*nt.width,Q[0][3]*nt.width,1/it.width*Q[1][0]*nt.height,1/it.height*Q[1][1]*nt.height,Q[1][3]*nt.height,0,0]}(x,w,u),[1,8]),V=f==="zero"?"constant":"nearest",G=m.image.transform((0,m.expandDims)((0,m.cast)(M,"float32")),$,"bilinear",V,0,[u.height,u.width]);return y!=null?function(Q,nt){var it=function(ht,kt,Nt,$t){var Ut=($t-Nt)/255;return{scale:Ut,offset:Nt-0*Ut}}(0,0,nt[0],nt[1]);return(0,m.tidy)(function(){return(0,m.add)((0,m.mul)(Q,it.scale),it.offset)})}(G,y):G});return{imageTensor:A,padding:T,transformationMatrix:x}}function hQ(l,i,o,u){return u===1?.5*(l+i):l+(i-l)*o/(u-1)}function Cb(l){return{xCenter:l.xMin+l.width/2,yCenter:l.yMin+l.height/2,width:l.width,height:l.height}}function u6(l){var i=l.relativeKeypoints;if(i.length<=1)throw new Error("2 or more keypoints required to calculate a rect.");var o=Number.MAX_VALUE,u=Number.MAX_VALUE,c=Number.MIN_VALUE,f=Number.MIN_VALUE;return i.forEach(function(y){o=Math.min(o,y.x),c=Math.max(c,y.x),u=Math.min(u,y.y),f=Math.max(f,y.y)}),{xCenter:(o+c)/2,yCenter:(u+f)/2,width:c-o,height:f-u}}function Ydt(l,i,o,u){return Ap(this,void 0,void 0,function(){var c,f,y,w,C;return Ef(this,function(T){switch(T.label){case 0:return l.sort(function(x,A){return Math.max.apply(Math,A.score)-Math.max.apply(Math,x.score)}),c=(0,m.tensor2d)(l.map(function(x){return[x.locationData.relativeBoundingBox.yMin,x.locationData.relativeBoundingBox.xMin,x.locationData.relativeBoundingBox.yMax,x.locationData.relativeBoundingBox.xMax]})),f=(0,m.tensor1d)(l.map(function(x){return x.score[0]})),[4,m.image.nonMaxSuppressionAsync(c,f,i,o)];case 1:return[4,(y=T.sent()).array()];case 2:return w=T.sent(),C=l.filter(function(x,A){return w.indexOf(A)>-1}),(0,m.dispose)([c,f,y]),[2,C]}})})}function qdt(l,i){return l.map(function(o){var u=yc(yc({},o),{x:o.x*i.width,y:o.y*i.height});return o.z!=null&&(u.z=o.z*i.width),u})}function dQ(l,i,o){return Ap(this,void 0,void 0,function(){var u,c,f,y,w;return Ef(this,function(C){switch(C.label){case 0:return u=l[0],c=l[1],f=function(T,x,A){return(0,m.tidy)(function(){var M,$,V,G;$=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+0],[-1,1])),M=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+1],[-1,1])),G=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+2],[-1,1])),V=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+3],[-1,1])),$=(0,m.add)((0,m.mul)((0,m.div)($,A.xScale),x.w),x.x),M=(0,m.add)((0,m.mul)((0,m.div)(M,A.yScale),x.h),x.y),V=(0,m.mul)((0,m.div)(V,A.hScale),x.h),G=(0,m.mul)((0,m.div)(G,A.wScale),x.h);for(var Q=(0,m.sub)(M,(0,m.div)(V,2)),nt=(0,m.sub)($,(0,m.div)(G,2)),it=(0,m.add)(M,(0,m.div)(V,2)),ht=(0,m.add)($,(0,m.div)(G,2)),kt=(0,m.concat)([(0,m.reshape)(Q,[A.numBoxes,1]),(0,m.reshape)(nt,[A.numBoxes,1]),(0,m.reshape)(it,[A.numBoxes,1]),(0,m.reshape)(ht,[A.numBoxes,1])],1),Nt=0;Nt<A.numKeypoints;++Nt){var $t=A.keypointCoordOffset+Nt*A.numValuesPerKeypoint,Ut=void 0,Pt=void 0;Ut=(0,m.squeeze)((0,m.slice)(T,[0,$t],[-1,1])),Pt=(0,m.squeeze)((0,m.slice)(T,[0,$t+1],[-1,1]));var re=(0,m.add)((0,m.mul)((0,m.div)(Ut,A.xScale),x.w),x.x),ue=(0,m.add)((0,m.mul)((0,m.div)(Pt,A.yScale),x.h),x.y);kt=(0,m.concat)([kt,(0,m.reshape)(re,[A.numBoxes,1]),(0,m.reshape)(ue,[A.numBoxes,1])],1)}return kt})}(c,i,o),y=(0,m.tidy)(function(){var T=u;return o.scoreClippingThresh!=null&&(T=(0,m.clipByValue)(u,-o.scoreClippingThresh,o.scoreClippingThresh)),T=(0,m.sigmoid)(T)}),[4,Eb(f,y,o)];case 1:return w=C.sent(),(0,m.dispose)([f,y]),[2,w]}})})}function Eb(l,i,o){return Ap(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M,$,V;return Ef(this,function(G){switch(G.label){case 0:return u=[],[4,l.data()];case 1:return c=G.sent(),[4,i.data()];case 2:for(f=G.sent(),y=0;y<o.numBoxes;++y)if(!(f[y]<o.minScoreThresh||(w=y*o.numCoords,C=Iz(c[w+0],c[w+1],c[w+2],c[w+3],f[y],o.flipVertically,y),(T=C.locationData.relativeBoundingBox).width<0||T.height<0))){for((x=C.locationData).relativeKeypoints=[],A=o.numKeypoints*o.numValuesPerKeypoint,M=0;M<A;M+=o.numValuesPerKeypoint)$=w+o.keypointCoordOffset+M,V={x:c[$+0],y:c[$+1]},x.relativeKeypoints.push(V);u.push(C)}return[2,u]}})})}function Iz(l,i,o,u,c,f,y){return{score:[c],ind:y,locationData:{relativeBoundingBox:{xMin:i,yMin:f?1-o:l,xMax:u,yMax:f?1-l:o,width:u-i,height:o-l}}}}function Xdt(l,i){return l==="none"?i:function(o){return 1/(1+Math.exp(-o))}(i)}function fQ(l,i,o,u){return Ap(this,void 0,void 0,function(){var c,f,y,w,C,T,x,A;return Ef(this,function(M){switch(M.label){case 0:return o=o||i.flipHorizontally||!1,u=u||i.flipVertically||!1,c=l.size,f=c/i.numLandmarks,[4,l.data()];case 1:for(y=M.sent(),w=[],C=0;C<i.numLandmarks;++C)T=C*f,(A={x:0,y:0}).x=o?i.inputImageWidth-y[T]:y[T],f>1&&(A.y=u?i.inputImageHeight-y[T+1]:y[T+1]),f>2&&(A.z=y[T+2]),f>3&&(A.score=Xdt(i.visibilityActivation,y[T+3])),w.push(A);for(x=0;x<w.length;++x)(A=w[x]).x=A.x/i.inputImageWidth,A.y=A.y/i.inputImageHeight,A.z=A.z/i.inputImageWidth/(i.normalizeZ||1);return[2,w]}})})}function Tb(l,i,o){var u=l.width,c=l.height,f=l.rotation;if(o.rotation==null&&o.rotationDegree==null||(f=function(x,A){return A.rotation!=null?x+=A.rotation:A.rotationDegree!=null&&(x+=Math.PI*A.rotationDegree/180),o4(x)}(f,o)),f===0)l.xCenter=l.xCenter+u*o.shiftX,l.yCenter=l.yCenter+c*o.shiftY;else{var y=(i.width*u*o.shiftX*Math.cos(f)-i.height*c*o.shiftY*Math.sin(f))/i.width,w=(i.width*u*o.shiftX*Math.sin(f)+i.height*c*o.shiftY*Math.cos(f))/i.height;l.xCenter=l.xCenter+y,l.yCenter=l.yCenter+w}if(o.squareLong){var C=Math.max(u*i.width,c*i.height);u=C/i.width,c=C/i.height}else if(o.squareShort){var T=Math.min(u*i.width,c*i.height);u=T/i.width,c=T/i.height}return l.width=u*o.scaleX,l.height=c*o.scaleY,l}var BI,Kdt={interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:4,minScale:.1484375,maxScale:.75,inputSizeHeight:192,inputSizeWidth:192,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,16,16],aspectRatios:[1]},Nz={runtime:"tfjs",modelType:"full",maxHands:2,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/handpose_3d/detector/full/1",landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/handpose_3d/landmark/full/1"},l6={flipHorizontal:!1,staticImageMode:!1},Mz={flipVertically:!1,numBoxes:2016,numCoords:18,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:7,numValuesPerKeypoint:2,scoreClippingThresh:100,xScale:192,yScale:192,hScale:192,wScale:192,minScoreThresh:.5},Zdt={shiftX:0,shiftY:-.5,scaleX:2.6,scaleY:2.6,squareLong:!0},Qdt={shiftX:0,shiftY:-.1,scaleX:2,scaleY:2,squareLong:!0},Dz={outputTensorSize:{width:192,height:192},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},c6={outputTensorSize:{width:224,height:224},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},jI={numLandmarks:21,inputImageWidth:224,inputImageHeight:224,normalizeZ:.4,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},Jdt={numLandmarks:21,inputImageWidth:1,inputImageHeight:1,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},tft=function(){function l(i,o,u){this.detectorModel=i,this.landmarkModel=o,this.maxHands=u,this.prevHandRectsFromLandmarks=null,this.anchors=function(C){C.interpolatedScaleAspectRatio==null&&(C.interpolatedScaleAspectRatio=1);for(var T=[],x=0;x<C.numLayers;){for(var A=[],M=[],$=[],V=[],G=x;G<C.strides.length&&C.strides[G]===C.strides[x];){var Q=hQ(C.minScale,C.maxScale,G,C.strides.length);{for(var nt=0;nt<C.aspectRatios.length;++nt)$.push(C.aspectRatios[nt]),V.push(Q);if(C.interpolatedScaleAspectRatio>0){var it=G===C.strides.length-1?1:hQ(C.minScale,C.maxScale,G+1,C.strides.length);V.push(Math.sqrt(Q*it)),$.push(C.interpolatedScaleAspectRatio)}}G++}for(var ht=0;ht<$.length;++ht){var kt=Math.sqrt($[ht]);A.push(V[ht]/kt),M.push(V[ht]*kt)}var Nt=0,$t=0;if(C.featureMapHeight.length>0)Nt=C.featureMapHeight[x],$t=C.featureMapWidth[x];else{var Ut=C.strides[x];Nt=Math.ceil(C.inputSizeHeight/Ut),$t=Math.ceil(C.inputSizeWidth/Ut)}for(var Pt=0;Pt<Nt;++Pt)for(var re=0;re<$t;++re)for(var ue=0;ue<A.length;++ue){var be={xCenter:(re+C.anchorOffsetX)/$t,yCenter:(Pt+C.anchorOffsetY)/Nt,width:0,height:0};be.width=1,be.height=1,T.push(be)}x=G}return T}(Kdt);var c=(0,m.tensor1d)(this.anchors.map(function(C){return C.width})),f=(0,m.tensor1d)(this.anchors.map(function(C){return C.height})),y=(0,m.tensor1d)(this.anchors.map(function(C){return C.xCenter})),w=(0,m.tensor1d)(this.anchors.map(function(C){return C.yCenter}));this.anchorTensor={x:y,y:w,w:c,h:f}}return l.prototype.estimateHands=function(i,o){return Ap(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M,$,V,G,Q,nt,it,ht,kt,Nt=this;return Ef(this,function($t){switch($t.label){case 0:return u=function(Pt){if(Pt==null)return yc({},l6);var re=yc({},Pt);return re.flipHorizontal==null&&(re.flipHorizontal=l6.flipHorizontal),re.staticImageMode==null&&(re.staticImageMode=l6.staticImageMode),re}(o),i==null?(this.reset(),[2,[]]):(c=s6(i),f=(0,m.tidy)(function(){var Pt=(0,m.cast)(PI(i),"float32");return u.flipHorizontal&&(Pt=(0,m.squeeze)(m.image.flipLeftRight((0,m.expandDims)(Pt,0)),[0])),Pt}),y=this.prevHandRectsFromLandmarks,u.staticImageMode||y==null||y.length<this.maxHands?[4,this.detectPalm(f)]:[3,2]);case 1:return(C=$t.sent()).length===0?(this.reset(),f.dispose(),[2,[]]):(T=C.map(function(Pt){return Nt.palmDetectionToRoi(Pt,c)}),w=T,[3,3]);case 2:w=y,$t.label=3;case 3:return Ut=[],[w].forEach(function(Pt){return Pt.forEach(function(re){(Ut=Ut.filter(function(ue){return function(be,De){var ze=o6(be),Qe=o6(De);if(!function(sn,xn){return!(sn.xMax<xn.xMin||xn.xMax<sn.xMin||sn.yMax<xn.yMin||xn.yMax<sn.yMin)}(ze,Qe))return 0;var cn=zI(function(sn,xn){var Rn=Math.max(sn.xMin,xn.xMin),Bn=Math.min(sn.xMax,xn.xMax),Fn=Math.max(sn.yMin,xn.yMin),Xn=Math.min(sn.yMax,xn.yMax);return{xMin:Rn,xMax:Bn,yMin:Fn,yMax:Xn,width:Math.max(Bn-Rn,0),height:Math.max(Xn-Fn,0)}}(ze,Qe)),en=zI(ze)+zI(Qe)-cn;return en>0?cn/en:0}(re,ue)<=.5})).push(re)})}),w=Ut,[4,Promise.all(w.map(function(Pt){return Nt.handLandmarks(Pt,f)}))];case 4:for(x=$t.sent(),A=[],this.prevHandRectsFromLandmarks=[],M=0,$=x;M<$.length;M++)(V=$[M])!=null&&(G=V.landmarks,Q=V.worldLandmarks,nt=V.handScore,it=V.handedness,this.prevHandRectsFromLandmarks.push(this.handLandmarksToRoi(G,c)),(ht=qdt(G,c))!=null&&ht.forEach(function(Pt,re){delete Pt.z,Pt.name=i6[re]}),(kt=Q)!=null&&kt.forEach(function(Pt,re){Pt.name=i6[re]}),A.push({keypoints:ht,keypoints3D:kt,handedness:it,score:nt}));return f.dispose(),[2,A]}var Ut})})},l.prototype.dispose=function(){this.detectorModel.dispose(),this.landmarkModel.dispose(),(0,m.dispose)([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h])},l.prototype.reset=function(){this.prevHandRectsFromLandmarks=null},l.prototype.detectPalm=function(i){return Ap(this,void 0,void 0,function(){var o,u,c,f,y,w,C,T,x,A;return Ef(this,function(M){switch(M.label){case 0:return o=cQ(i,Dz),u=o.imageTensor,c=o.padding,f=this.detectorModel.predict(u),y=function($){return(0,m.tidy)(function(){var V=function(nt){return(0,m.tidy)(function(){return[(0,m.slice)(nt,[0,0,0],[1,-1,1]),(0,m.slice)(nt,[0,0,1],[1,-1,-1])]})}($),G=V[0],Q=V[1];return{boxes:(0,m.squeeze)(Q),logits:(0,m.squeeze)(G)}})}(f),w=y.boxes,[4,dQ([C=y.logits,w],this.anchorTensor,Mz)];case 1:return(T=M.sent()).length===0?((0,m.dispose)([u,f,C,w]),[2,T]):[4,Ydt(T,this.maxHands,.3)];case 2:return x=M.sent(),A=function($,V){$===void 0&&($=[]);for(var G=V.left,Q=V.top,nt=V.left+V.right,it=V.top+V.bottom,ht=0;ht<$.length;ht++){var kt=$[ht],Nt=kt.locationData.relativeBoundingBox,$t=(Nt.xMin-G)/(1-nt),Ut=(Nt.yMin-Q)/(1-it),Pt=Nt.width/(1-nt),re=Nt.height/(1-it);Nt.xMin=$t,Nt.yMin=Ut,Nt.width=Pt,Nt.height=re,Nt.xMax=$t+Pt,Nt.yMax=Ut+re;var ue=kt.locationData.relativeKeypoints;ue&&ue.forEach(function(be){var De=(be.x-G)/(1-nt),ze=(be.y-Q)/(1-it);be.x=De,be.y=ze})}return $}(x,c),(0,m.dispose)([u,f,C,w]),[2,A]}})})},l.prototype.palmDetectionToRoi=function(i,o){return Tb(function(u,c,f,y,w){var C=f==="rect"?function(T,x,A){var M,$=T.locationData;return M=Cb($.boundingBox),M}(u):function(T,x){var A=T.locationData;return x==="boundingbox"?Cb(A.relativeBoundingBox):u6(A)}(u,c);return w&&(C.rotation=function(T,x,A){var M,$=T.locationData,V=A.rotationVectorStartKeypointIndex,G=A.rotationVectorEndKeypointIndex;M=A.rotationVectorTargetAngle?A.rotationVectorTargetAngle:Math.PI*A.rotationVectorTargetAngleDegree/180;var Q=$.relativeKeypoints[V].x*x.width,nt=$.relativeKeypoints[V].y*x.height,it=$.relativeKeypoints[G].x*x.width,ht=$.relativeKeypoints[G].y*x.height;return o4(M-Math.atan2(-(ht-nt),it-Q))}(u,y,w)),C}(i,"boundingbox","normRect",o,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:2,rotationVectorTargetAngleDegree:90}),o,Zdt)},l.prototype.handLandmarks=function(i,o){return Ap(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M,$,V,G,Q,nt,it;return Ef(this,function(ht){switch(ht.label){case 0:return u=cQ(o,c6,i),c=u.imageTensor,f=u.padding,y=this.landmarkModel.execute(c,["Identity_2:0","Identity_1:0","Identity:0","Identity_3:0"]),w=y[0],C=y[1],T=y[2],x=y[3],[4,C.data()];case 1:return(A=ht.sent()[0])<.5?((0,m.dispose)(y),(0,m.dispose)(c),[2,null]):[4,T.data()];case 2:return M=ht.sent()[0],$=M>=.5?"Left":"Right",[4,fQ(w,jI)];case 3:return V=ht.sent(),[4,fQ(x,Jdt)];case 4:return G=ht.sent(),Q=function(kt,Nt){var $t=Nt.left,Ut=Nt.top,Pt=Nt.left+Nt.right,re=Nt.top+Nt.bottom;return kt.map(function(ue){return yc(yc({},ue),{x:(ue.x-$t)/(1-Pt),y:(ue.y-Ut)/(1-re),z:ue.z/(1-Pt)})})}(V,f),nt=function(kt,Nt,$t){$t===void 0&&($t={ignoreRotation:!1});for(var Ut=[],Pt=0,re=kt;Pt<re.length;Pt++){var ue=re[Pt],be=ue.x-.5,De=ue.y-.5,ze=$t.ignoreRotation?0:Nt.rotation,Qe=Math.cos(ze)*be-Math.sin(ze)*De,cn=Math.sin(ze)*be+Math.cos(ze)*De;Qe=Qe*Nt.width+Nt.xCenter,cn=cn*Nt.height+Nt.yCenter;var en=ue.z*Nt.width,sn=yc({},ue);sn.x=Qe,sn.y=cn,sn.z=en,Ut.push(sn)}return Ut}(Q,i),it=function(kt,Nt){for(var $t=[],Ut=0,Pt=kt;Ut<Pt.length;Ut++){var re=Pt[Ut],ue=re.x,be=re.y,De=Nt.rotation,ze=Math.cos(De)*ue-Math.sin(De)*be,Qe=Math.sin(De)*ue+Math.cos(De)*be,cn=yc({},re);cn.x=ze,cn.y=Qe,$t.push(cn)}return $t}(G,i),(0,m.dispose)(y),(0,m.dispose)(c),[2,{landmarks:nt,worldLandmarks:it,handScore:A,handedness:$}]}})})},l.prototype.handLandmarksToRoi=function(i,o){return Tb(function(u,c){for(var f=function(Qe,cn){var en=Qe[0].x*cn.width,sn=Qe[0].y*cn.height,xn=(Qe[4].x+Qe[8].x)/2,Rn=(Qe[4].y+Qe[8].y)/2;return xn=(xn+Qe[6].x)/2*cn.width,Rn=(Rn+Qe[6].y)/2*cn.height,o4(Math.PI/2-Math.atan2(-(Rn-sn),xn-en))}(u,c),y=o4(-f),w=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,T=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY,A=0,M=u;A<M.length;A++){var $=(ht=M[A]).x,V=ht.y;w=Math.min(w,$),C=Math.max(C,$),T=Math.min(T,V),x=Math.max(x,V)}var G=(C+w)/2,Q=(x+T)/2;w=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,T=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY;for(var nt=0,it=u;nt<it.length;nt++){var ht,kt=((ht=it[nt]).x-G)*c.width,Nt=(ht.y-Q)*c.height,$t=kt*Math.cos(y)-Nt*Math.sin(y),Ut=kt*Math.sin(y)+Nt*Math.cos(y);w=Math.min(w,$t),C=Math.max(C,$t),T=Math.min(T,Ut),x=Math.max(x,Ut)}var Pt=(C+w)/2,re=(x+T)/2,ue=Pt*Math.cos(f)-re*Math.sin(f)+c.width*G,be=Pt*Math.sin(f)+re*Math.cos(f)+c.height*Q,De=(C-w)/c.width,ze=(x-T)/c.height;return{xCenter:ue/c.width,yCenter:be/c.height,width:De,height:ze,rotation:f}}([].concat(i.slice(0,4),i.slice(5,7),i.slice(9,11),i.slice(13,15),i.slice(17,19)),o),o,Qdt)},l}();function eft(l){return Ap(this,void 0,void 0,function(){var i,o,u,c,f,y;return Ef(this,function(w){switch(w.label){case 0:return i=function(C){if(C==null)return yc({},Nz);var T=yc({},C);if(T.runtime="tfjs",T.maxHands==null&&(T.maxHands=Nz.maxHands),T.modelType==null&&(T.modelType=Nz.modelType),T.modelType!=="lite"&&T.modelType!=="full")throw new Error("Model type must be one of lite or full, but got "+T.modelType);return T.detectorModelUrl==null&&(T.modelType==="lite"?T.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/handpose_3d/detector/lite/1":T.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/handpose_3d/detector/full/1"),T.landmarkModelUrl==null&&(T.modelType==="lite"?T.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/handpose_3d/landmark/lite/1":T.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/handpose_3d/landmark/full/1"),T}(l),o=i.detectorModelUrl.indexOf("https://tfhub.dev")>-1,u=i.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Promise.all([Vc(i.detectorModelUrl,{fromTFHub:o}),Vc(i.landmarkModelUrl,{fromTFHub:u})])];case 1:return c=w.sent(),f=c[0],y=c[1],[2,new tft(f,y,i.maxHands)]}})})}(BI||(BI={})).MediaPipeHands="MediaPipeHands";var nft=F(3185);let rft=(l,i,o,u,c)=>`\u{1F7EA}ml5.js warns: The '${i}' option for ${l} has to be set to a ${u}, but it is being set to a ${o} instead.

ml5.js is using default value of '${c}'.`,pQ=(l,i,o,u,c)=>`\u{1F7EA}ml5.js warns: The '${i}' option for ${l} has to be set to ${UI(u)}, but it is being set to '${o}' instead.

ml5.js is using default value of '${c}'.`,Ab=(l,i,o,u,c,f)=>`\u{1F7EA}ml5.js warns: The '${i}' option for ${l} has to be set to a number between ${u} and ${c}, but it is being set to '${o}' instead.

ml5.js is using default value of '${f}'.`,ift=(l,i,o,u)=>`\u{1F7EA}ml5.js warns: The '${i}' option for ${l} has to be set to an integer, but it is being set to the float value '${o}' instead.

ml5.js is using the default value of '${u}'.`,mQ=(l,i,o,u,c)=>`\u{1F7EA}ml5.js warns: The '${i}' option for ${l} has to be a multiple of ${u}, but it is being set to '${o}' instead.

ml5.js is using the default value of '${c}'.`,aft=(l,i,o,u)=>`\u{1F7EA}ml5.js warns: The modelName parameter for ${l} has to be set to ${UI(o)}, but it is being set to '${i}' instead.

ml5.js is using default model '${u}'.`;function UI(l){if(l.length===1)return`'${l[0]}'`;if(l.length===2)return`'${l[0]}' or '${l[1]}'`;{let i=l.pop();return`'${l.join("', '")}', or '${i}'`}}function Om(l,i){return typeof i=="function"?i(l):i}function h6(l,i,o){return o&&typeof l=="string"?i.find(u=>u.toLowerCase()===l.toLowerCase()):i.includes(l)?l:void 0}function oft(l,i,o){return l<i||l>o?void 0:l}function Lm(l,i,o,u){if(l===void 0)return o;let c=h6(l,i,!0);return c===void 0?(console.warn(aft(u,l,i,o)),o):c}let Ip=function(l,i,o){let u={};for(let c in i){let f=i[c],y=Om(u,f.type),w=Om(u,f.default);if(Om(u,f.ignore))continue;let C=i[c].alias,T,x=!1;if(l[c]!==void 0)T=l[c];else{if(C===void 0||l[C]===void 0){u[c]=w;continue}T=l[C],x=!0}if(typeof T!==y&&y!=="enum")console.warn(rft(o,x?C:c,typeof T,y,w)),u[c]=w;else if(y==="enum"){let A=Om(u,f.enums),M=h6(T,A,Om(u,f.caseInsensitive)??!0);M===void 0?(console.warn(pQ(o,x?C:c,T,A,w)),u[c]=w):u[c]=M}else if(y==="number"){let A=Om(u,f.min)??-1/0,M=Om(u,f.max)??1/0,$=Om(u,f.integer)??!1,V=Om(u,f.multipleOf),G=oft(T,A,M);$&&!Number.isInteger(T)?(console.warn(ift(o,x?C:c,T,w)),u[c]=w):V!==void 0&&T%V!=0?(console.warn(mQ(o,x?C:c,T,V,w)),u[c]=w):G===void 0?(console.warn(Ab(o,x?C:c,T,A,M,w)),u[c]=w):u[c]=G}else{if(y!=="boolean"&&y!=="string"&&y!=="object")throw new Error(`Unknown type "${y}" for ${c} in moldObject.`);u[c]=T}}return u};function WI(l,i,o){return Object.assign(l,{[o]:l[i]}),delete l[i],l}let d6={maxHands:{type:"number",min:1,max:2147483647,integer:!0,default:2},runtime:{type:"enum",enums:["mediapipe","tfjs"],default:"tfjs"},modelType:{type:"enum",enums:["lite","full"],default:"full"},solutionPath:{type:"string",default:"https://cdn.jsdelivr.net/npm/@mediapipe/hands",ignore:l=>l.runtime!=="mediapipe"},detectorModelUrl:{type:"string",default:void 0,ignore:l=>l.runtime!=="tfjs"},landmarkModelUrl:{type:"string",default:void 0,ignore:l=>l.runtime!=="tfjs"}},VI={flipHorizontal:{type:"boolean",alias:"flipped",default:!1}};class gQ{constructor(i,o,u){this.modelName=this.modelName=Lm(i,["MediaPipeHands"],"MediaPipeHands","handPose"),this.model=null,this.userOptions=o,this.runtimeConfig={},this.detectMedia=null,this.detectCallback=null,this.detecting=!1,this.signalStop=!1,this.prevCall="",this.ready=Ws(this.loadModel(),u)}loadModel(){return ce(this,null,function*(){let i=BI.MediaPipeHands,o=Ip(this.userOptions,d6,"handPose");return this.runtimeConfig=Ip(this.userOptions,VI,"handPose"),yield m.ready(),this.model=yield function(u,c){return Ap(this,void 0,void 0,function(){var f,y;return Ef(this,function(w){if(u===BI.MediaPipeHands){if(y=void 0,(f=c)!=null){if(f.runtime==="tfjs")return[2,eft(f)];if(f.runtime==="mediapipe")return[2,Az(f)];y=f.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+y)}throw new Error(u+" is not a supported model name.")})})}(i,o),this})}detect(...i){return ce(this,null,function*(){let o=Uu(...i);o.require("image","An html or p5.js image, video, or canvas element argument is required for detect().");let{image:u,callback:c}=o;yield E0(u,!1);let f=yield this.model.estimateHands(u,this.runtimeConfig);return this.renameScoreToConfidence(f),this.addKeypoints(f),typeof c=="function"&&c(f),f})}detectStart(...i){let o=Uu(...i);o.require("image","An html or p5.js image, video, or canvas element argument is required for detectStart()."),o.require("callback","A callback function argument is required for detectStart()."),this.detectMedia=o.image,this.detectCallback=o.callback,this.signalStop=!1,this.detecting||(this.detecting=!0,this.detectLoop()),this.prevCall==="start"&&console.warn("detectStart() was called more than once without calling detectStop(). Only the latest detectStart() call will take effect."),this.prevCall="start"}detectStop(){this.detecting&&(this.signalStop=!0),this.prevCall="stop"}detectLoop(){return ce(this,null,function*(){for(yield E0(this.detectMedia,!1);!this.signalStop;){let i=yield this.model.estimateHands(this.detectMedia,this.runtimeConfig);this.renameScoreToConfidence(i),this.addKeypoints(i),this.detectCallback(i),yield m.nextFrame()}this.detecting=!1,this.signalStop=!1})}renameScoreToConfidence(i){i.forEach(o=>{WI(o,"score","confidence")})}addKeypoints(i){i=i.map(o=>{for(let u=0;u<o.keypoints.length;u++){let c=o.keypoints[u],f=o.keypoints3D[u];o[c.name]={x:c.x,y:c.y,x3D:f.x,y3D:f.y,z3D:f.z}}return o})}getConnections(){return nft.c6}}let yQ=(...l)=>{let{string:i,options:o={},callback:u}=Uu(...l);return new gQ(i,o,u)};class Rz{constructor(i,o){this.modelName=Lm(i,["MovieReviews"],"MovieReviews","sentiment"),this.ready=Ws(this.loadModel(),o)}loadModel(i){return ce(this,null,function*(){yield m.ready();let o=i4(this.modelName.toLowerCase()==="moviereviews"?"https://storage.googleapis.com/tfjs-models/tfjs/sentiment_cnn_v1/":this.modelName,"model"),[u,c]=yield Promise.all([o.loadLayersModel(),o.loadMetadataJson()]);return this.model=u,this.indexFrom=c.index_from,this.maxLen=c.max_len,this.wordIndex=c.word_index,this.vocabularySize=c.vocabulary_size,this})}predict(...i){return ce(this,null,function*(){let o=Uu(...i),{string:u,callback:c}=o;o.require("string","A string argument is required for sentiment.predict function.");let f=function(T,x,A="pre",M="pre",$=0){return T.map(V=>{if(V.length>x&&(M==="pre"?V.splice(0,V.length-x):V.splice(x,V.length-x)),V.length<x){let G=[];for(let Q=0;Q<x-V.length;Q+=1)G.push($);V=A==="pre"?G.concat(V):V.concat(G)}return V})}([u.trim().toLowerCase().replace(/[.,?!]/g,"").split(" ").map(T=>{let x=this.wordIndex[T]+this.indexFrom;return x>this.vocabularySize&&(x=2),x})],this.maxLen),y=m.tensor2d(f,[1,this.maxLen]),w=this.model.predict(y),C=(yield w.data())[0];return w.dispose(),y.dispose(),c&&c({confidence:C}),{confidence:C}})}}let Fz=(...l)=>{let{string:i,callback:o}=Uu(...l);return new Rz(i,o)};var vQ=F(2726),Np=function(){return Np=Object.assign||function(l){for(var i,o=1,u=arguments.length;o<u;o++)for(var c in i=arguments[o])Object.prototype.hasOwnProperty.call(i,c)&&(l[c]=i[c]);return l},Np.apply(this,arguments)};function $m(l,i,o,u){return new(o||(o=Promise))(function(c,f){function y(T){try{C(u.next(T))}catch(x){f(x)}}function w(T){try{C(u.throw(T))}catch(x){f(x)}}function C(T){var x;T.done?c(T.value):(x=T.value,x instanceof o?x:new o(function(A){A(x)})).then(y,w)}C((u=u.apply(l,[])).next())})}function zm(l,i){var o,u,c,f,y={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return f={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function w(C){return function(T){return function(x){if(o)throw new TypeError("Generator is already executing.");for(;y;)try{if(o=1,u&&(c=2&x[0]?u.return:x[0]?u.throw||((c=u.return)&&c.call(u),0):u.next)&&!(c=c.call(u,x[1])).done)return c;switch(u=0,c&&(x=[2&x[0],c.value]),x[0]){case 0:case 1:c=x;break;case 4:return y.label++,{value:x[1],done:!1};case 5:y.label++,u=x[1],x=[0];continue;case 7:x=y.ops.pop(),y.trys.pop();continue;default:if(!((c=(c=y.trys).length>0&&c[c.length-1])||x[0]!==6&&x[0]!==2)){y=0;continue}if(x[0]===3&&(!c||x[1]>c[0]&&x[1]<c[3])){y.label=x[1];break}if(x[0]===6&&y.label<c[1]){y.label=c[1],c=x;break}if(c&&y.label<c[2]){y.label=c[2],y.ops.push(x);break}c[2]&&y.ops.pop(),y.trys.pop();continue}x=i.call(l,y)}catch(A){x=[6,A],u=0}finally{o=c=0}if(5&x[0])throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}([C,T])}}}function Z2(l){var i=l.map(function(o){return o[0]});return i.push(l[l.length-1][1]),i}var Pm={lips:Z2([[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]]),leftEye:Z2([[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]]),leftEyebrow:Z2([[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]]),leftIris:Z2([[474,475],[475,476],[476,477],[477,474]]),rightEye:Z2([[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]]),rightEyebrow:Z2([[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]]),rightIris:Z2([[469,470],[470,471],[471,472],[472,469]]),faceOval:Z2([[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]])},sft=[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]],uft=Object.entries(Pm).map(function(l){var i=l[0];return l[1].map(function(o){return[o,i]})}).flat(),bQ=new Map(uft);function Oz(l){for(var i={locationData:{relativeKeypoints:[]}},o=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,f=Number.MIN_SAFE_INTEGER,y=0;y<l.length;++y){var w=l[y];o=Math.min(o,w.x),u=Math.max(u,w.x),c=Math.min(c,w.y),f=Math.max(f,w.y),i.locationData.relativeKeypoints.push({x:w.x,y:w.y})}return i.locationData.relativeBoundingBox={xMin:o,yMin:c,xMax:u,yMax:f,width:u-o,height:f-c},i}var Lz={runtime:"mediapipe",maxFaces:1,refineLandmarks:!1},wQ=function(){function l(i){var o=this;this.width=0,this.height=0,this.selfieMode=!1,this.faceMeshSolution=new vQ.FaceMesh({locateFile:function(u,c){return i.solutionPath?i.solutionPath.replace(/\/+$/,"")+"/"+u:c+"/"+u}}),this.faceMeshSolution.setOptions({refineLandmarks:i.refineLandmarks,selfieMode:this.selfieMode,maxNumFaces:i.maxFaces}),this.faceMeshSolution.onResults(function(u){if(o.height=u.image.height,o.width=u.image.width,o.faces=[],u.multiFaceLandmarks!==null)for(var c=u.multiFaceLandmarks,f=0;f<c.length;f++){var y=o.translateOutput(c[f]);o.faces.push({keypoints:y,box:Oz(y).locationData.relativeBoundingBox})}})}return l.prototype.translateOutput=function(i){var o=this;return i.map(function(u,c){var f={x:u.x*o.width,y:u.y*o.height,z:u.z*o.width},y=bQ.get(c);return y!=null&&(f.name=y),f})},l.prototype.estimateFaces=function(i,o){return $m(this,void 0,void 0,function(){var u,c;return zm(this,function(f){switch(f.label){case 0:return o&&o.flipHorizontal&&o.flipHorizontal!==this.selfieMode&&(this.selfieMode=o.flipHorizontal,this.faceMeshSolution.setOptions({selfieMode:this.selfieMode})),i instanceof m.Tensor?(c=ImageData.bind,[4,m.browser.toPixels(i)]):[3,2];case 1:return u=new(c.apply(ImageData,[void 0,f.sent(),i.shape[1],i.shape[0]])),[3,3];case 2:u=i,f.label=3;case 3:return i=u,[4,this.faceMeshSolution.send({image:i})];case 4:return f.sent(),[2,this.faces]}})})},l.prototype.dispose=function(){this.faceMeshSolution.close()},l.prototype.reset=function(){this.faceMeshSolution.reset(),this.width=0,this.height=0,this.faces=null,this.selfieMode=!1},l.prototype.initialize=function(){return this.faceMeshSolution.initialize()},l}();function lft(l){return $m(this,void 0,void 0,function(){var i,o;return zm(this,function(u){switch(u.label){case 0:return i=function(c){if(c==null)return Np({},Lz);var f=Np({},c);return f.runtime="mediapipe",f.maxFaces==null&&(f.maxFaces=Lz.maxFaces),f.refineLandmarks==null&&(f.refineLandmarks=Lz.refineLandmarks),f}(l),[4,(o=new wQ(i)).initialize()];case 1:return u.sent(),[2,o]}})})}var Ib=typeof globalThis<"u"?globalThis:typeof window<"u"?window:F.g!==void 0?F.g:typeof self<"u"?self:{},$z={};(function(){var l;function i(Mt){var ae=0;return function(){return ae<Mt.length?{done:!1,value:Mt[ae++]}:{done:!0}}}var o=typeof Object.defineProperties=="function"?Object.defineProperty:function(Mt,ae,me){return Mt==Array.prototype||Mt==Object.prototype||(Mt[ae]=me.value),Mt},u=function(Mt){Mt=[typeof globalThis=="object"&&globalThis,Mt,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ib=="object"&&Ib];for(var ae=0;ae<Mt.length;++ae){var me=Mt[ae];if(me&&me.Math==Math)return me}throw Error("Cannot find global object")}(this);function c(Mt,ae){if(ae)t:{var me=u;Mt=Mt.split(".");for(var Ie=0;Ie<Mt.length-1;Ie++){var on=Mt[Ie];if(!(on in me))break t;me=me[on]}(ae=ae(Ie=me[Mt=Mt[Mt.length-1]]))!=Ie&&ae!=null&&o(me,Mt,{configurable:!0,writable:!0,value:ae})}}function f(Mt){return(Mt={next:Mt})[Symbol.iterator]=function(){return this},Mt}function y(Mt){var ae=typeof Symbol<"u"&&Symbol.iterator&&Mt[Symbol.iterator];return ae?ae.call(Mt):{next:i(Mt)}}function w(Mt){if(!(Mt instanceof Array)){Mt=y(Mt);for(var ae,me=[];!(ae=Mt.next()).done;)me.push(ae.value);Mt=me}return Mt}c("Symbol",function(Mt){function ae(on,Je){this.g=on,o(this,"description",{configurable:!0,writable:!0,value:Je})}if(Mt)return Mt;ae.prototype.toString=function(){return this.g};var me="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",Ie=0;return function on(Je){if(this instanceof on)throw new TypeError("Symbol is not a constructor");return new ae(me+(Je||"")+"_"+Ie++,Je)}}),c("Symbol.iterator",function(Mt){if(Mt)return Mt;Mt=Symbol("Symbol.iterator");for(var ae="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),me=0;me<ae.length;me++){var Ie=u[ae[me]];typeof Ie=="function"&&typeof Ie.prototype[Mt]!="function"&&o(Ie.prototype,Mt,{configurable:!0,writable:!0,value:function(){return f(i(this))}})}return Mt});var C,T=typeof Object.create=="function"?Object.create:function(Mt){function ae(){}return ae.prototype=Mt,new ae};if(typeof Object.setPrototypeOf=="function")C=Object.setPrototypeOf;else{var x;t:{var A={};try{A.__proto__={a:!0},x=A.a;break t}catch{}x=!1}C=x?function(Mt,ae){if(Mt.__proto__=ae,Mt.__proto__!==ae)throw new TypeError(Mt+" is not extensible");return Mt}:null}var M=C;function $(Mt,ae){if(Mt.prototype=T(ae.prototype),Mt.prototype.constructor=Mt,M)M(Mt,ae);else for(var me in ae)if(me!="prototype")if(Object.defineProperties){var Ie=Object.getOwnPropertyDescriptor(ae,me);Ie&&Object.defineProperty(Mt,me,Ie)}else Mt[me]=ae[me];Mt.na=ae.prototype}function V(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.u=this.o=0,this.j=null}function G(Mt){if(Mt.l)throw new TypeError("Generator is already running");Mt.l=!0}function Q(Mt,ae){Mt.j={da:ae,ea:!0},Mt.g=Mt.o||Mt.u}function nt(Mt,ae,me){return Mt.g=me,{value:ae}}function it(Mt){this.g=new V,this.h=Mt}function ht(Mt,ae,me,Ie){try{var on=ae.call(Mt.g.i,me);if(!(on instanceof Object))throw new TypeError("Iterator result "+on+" is not an object");if(!on.done)return Mt.g.l=!1,on;var Je=on.value}catch(ln){return Mt.g.i=null,Q(Mt.g,ln),kt(Mt)}return Mt.g.i=null,Ie.call(Mt.g,Je),kt(Mt)}function kt(Mt){for(;Mt.g.g;)try{var ae=Mt.h(Mt.g);if(ae)return Mt.g.l=!1,{value:ae.value,done:!1}}catch(me){Mt.g.h=void 0,Q(Mt.g,me)}if(Mt.g.l=!1,Mt.g.j){if(ae=Mt.g.j,Mt.g.j=null,ae.ea)throw ae.da;return{value:ae.return,done:!0}}return{value:void 0,done:!0}}function Nt(Mt){this.next=function(ae){return G(Mt.g),Mt.g.i?ae=ht(Mt,Mt.g.i.next,ae,Mt.g.s):(Mt.g.s(ae),ae=kt(Mt)),ae},this.throw=function(ae){return G(Mt.g),Mt.g.i?ae=ht(Mt,Mt.g.i.throw,ae,Mt.g.s):(Q(Mt.g,ae),ae=kt(Mt)),ae},this.return=function(ae){return function(me,Ie){G(me.g);var on=me.g.i;return on?ht(me,"return"in on?on.return:function(Je){return{value:Je,done:!0}},Ie,me.g.return):(me.g.return(Ie),kt(me))}(Mt,ae)},this[Symbol.iterator]=function(){return this}}function $t(Mt){return function(ae){function me(on){return ae.next(on)}function Ie(on){return ae.throw(on)}return new Promise(function(on,Je){(function ln(Ln){Ln.done?on(Ln.value):Promise.resolve(Ln.value).then(me,Ie).then(ln,Je)})(ae.next())})}(new Nt(new it(Mt)))}V.prototype.s=function(Mt){this.h=Mt},V.prototype.return=function(Mt){this.j={return:Mt},this.g=this.u},c("Promise",function(Mt){function ae(ln){this.h=0,this.i=void 0,this.g=[],this.s=!1;var Ln=this.j();try{ln(Ln.resolve,Ln.reject)}catch(vr){Ln.reject(vr)}}function me(){this.g=null}function Ie(ln){return ln instanceof ae?ln:new ae(function(Ln){Ln(ln)})}if(Mt)return Mt;me.prototype.h=function(ln){if(this.g==null){this.g=[];var Ln=this;this.i(function(){Ln.l()})}this.g.push(ln)};var on=u.setTimeout;me.prototype.i=function(ln){on(ln,0)},me.prototype.l=function(){for(;this.g&&this.g.length;){var ln=this.g;this.g=[];for(var Ln=0;Ln<ln.length;++Ln){var vr=ln[Ln];ln[Ln]=null;try{vr()}catch(Br){this.j(Br)}}}this.g=null},me.prototype.j=function(ln){this.i(function(){throw ln})},ae.prototype.j=function(){function ln(Br){return function(xi){vr||(vr=!0,Br.call(Ln,xi))}}var Ln=this,vr=!1;return{resolve:ln(this.D),reject:ln(this.l)}},ae.prototype.D=function(ln){if(ln===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(ln instanceof ae)this.H(ln);else{t:switch(typeof ln){case"object":var Ln=ln!=null;break t;case"function":Ln=!0;break t;default:Ln=!1}Ln?this.A(ln):this.o(ln)}},ae.prototype.A=function(ln){var Ln=void 0;try{Ln=ln.then}catch(vr){return void this.l(vr)}typeof Ln=="function"?this.I(Ln,ln):this.o(ln)},ae.prototype.l=function(ln){this.u(2,ln)},ae.prototype.o=function(ln){this.u(1,ln)},ae.prototype.u=function(ln,Ln){if(this.h!=0)throw Error("Cannot settle("+ln+", "+Ln+"): Promise already settled in state"+this.h);this.h=ln,this.i=Ln,this.h===2&&this.G(),this.B()},ae.prototype.G=function(){var ln=this;on(function(){if(ln.C()){var Ln=u.console;Ln!==void 0&&Ln.error(ln.i)}},1)},ae.prototype.C=function(){if(this.s)return!1;var ln=u.CustomEvent,Ln=u.Event,vr=u.dispatchEvent;return vr===void 0||(typeof ln=="function"?ln=new ln("unhandledrejection",{cancelable:!0}):typeof Ln=="function"?ln=new Ln("unhandledrejection",{cancelable:!0}):(ln=u.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,ln),ln.promise=this,ln.reason=this.i,vr(ln))},ae.prototype.B=function(){if(this.g!=null){for(var ln=0;ln<this.g.length;++ln)Je.h(this.g[ln]);this.g=null}};var Je=new me;return ae.prototype.H=function(ln){var Ln=this.j();ln.M(Ln.resolve,Ln.reject)},ae.prototype.I=function(ln,Ln){var vr=this.j();try{ln.call(Ln,vr.resolve,vr.reject)}catch(Br){vr.reject(Br)}},ae.prototype.then=function(ln,Ln){function vr(Ja,_o){return typeof Ja=="function"?function($a){try{Br(Ja($a))}catch(Di){xi(Di)}}:_o}var Br,xi,ya=new ae(function(Ja,_o){Br=Ja,xi=_o});return this.M(vr(ln,Br),vr(Ln,xi)),ya},ae.prototype.catch=function(ln){return this.then(void 0,ln)},ae.prototype.M=function(ln,Ln){function vr(){switch(Br.h){case 1:ln(Br.i);break;case 2:Ln(Br.i);break;default:throw Error("Unexpected state: "+Br.h)}}var Br=this;this.g==null?Je.h(vr):this.g.push(vr),this.s=!0},ae.resolve=Ie,ae.reject=function(ln){return new ae(function(Ln,vr){vr(ln)})},ae.race=function(ln){return new ae(function(Ln,vr){for(var Br=y(ln),xi=Br.next();!xi.done;xi=Br.next())Ie(xi.value).M(Ln,vr)})},ae.all=function(ln){var Ln=y(ln),vr=Ln.next();return vr.done?Ie([]):new ae(function(Br,xi){function ya($a){return function(Di){Ja[$a]=Di,--_o==0&&Br(Ja)}}var Ja=[],_o=0;do Ja.push(void 0),_o++,Ie(vr.value).M(ya(Ja.length-1),xi),vr=Ln.next();while(!vr.done)})},ae});var Ut=typeof Object.assign=="function"?Object.assign:function(Mt,ae){for(var me=1;me<arguments.length;me++){var Ie=arguments[me];if(Ie)for(var on in Ie)Object.prototype.hasOwnProperty.call(Ie,on)&&(Mt[on]=Ie[on])}return Mt};c("Object.assign",function(Mt){return Mt||Ut}),c("Object.is",function(Mt){return Mt||function(ae,me){return ae===me?ae!==0||1/ae==1/me:ae!=ae&&me!=me}}),c("Array.prototype.includes",function(Mt){return Mt||function(ae,me){var Ie=this;Ie instanceof String&&(Ie=String(Ie));var on=Ie.length;for(0>(me=me||0)&&(me=Math.max(me+on,0));me<on;me++){var Je=Ie[me];if(Je===ae||Object.is(Je,ae))return!0}return!1}}),c("String.prototype.includes",function(Mt){return Mt||function(ae,me){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(ae instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(ae,me||0)!==-1}}),c("Array.prototype.keys",function(Mt){return Mt||function(){return function(ae,me){ae instanceof String&&(ae+="");var Ie=0,on=!1,Je={next:function(){if(!on&&Ie<ae.length){var ln=Ie++;return{value:me(ln,ae[ln]),done:!1}}return on=!0,{done:!0,value:void 0}}};return Je[Symbol.iterator]=function(){return Je},Je}(this,function(ae){return ae})}});var Pt=this||self;function re(Mt,ae){Mt=Mt.split(".");var me,Ie=Pt;for((Mt[0]in Ie)||Ie.execScript===void 0||Ie.execScript("var "+Mt[0]);Mt.length&&(me=Mt.shift());)Mt.length||ae===void 0?Ie=Ie[me]&&Ie[me]!==Object.prototype[me]?Ie[me]:Ie[me]={}:Ie[me]=ae}function ue(){throw Error("Invalid UTF8")}function be(Mt,ae){return ae=String.fromCharCode.apply(null,ae),Mt==null?ae:Mt+ae}var De,ze,Qe=typeof TextDecoder<"u",cn=typeof TextEncoder<"u",en={},sn=null;function xn(Mt){var ae;ae===void 0&&(ae=0),Bn(),ae=en[ae];for(var me=Array(Math.floor(Mt.length/3)),Ie=ae[64]||"",on=0,Je=0;on<Mt.length-2;on+=3){var ln=Mt[on],Ln=Mt[on+1],vr=Mt[on+2],Br=ae[ln>>2];ln=ae[(3&ln)<<4|Ln>>4],Ln=ae[(15&Ln)<<2|vr>>6],vr=ae[63&vr],me[Je++]=Br+ln+Ln+vr}switch(Br=0,vr=Ie,Mt.length-on){case 2:vr=ae[(15&(Br=Mt[on+1]))<<2]||Ie;case 1:Mt=Mt[on],me[Je]=ae[Mt>>2]+ae[(3&Mt)<<4|Br>>4]+vr+Ie}return me.join("")}function Rn(Mt){var ae=Mt.length,me=3*ae/4;me%3?me=Math.floor(me):"=.".indexOf(Mt[ae-1])!=-1&&(me="=.".indexOf(Mt[ae-2])!=-1?me-2:me-1);var Ie=new Uint8Array(me),on=0;return function(Je,ln){function Ln(_o){for(;vr<Je.length;){var $a=Je.charAt(vr++),Di=sn[$a];if(Di!=null)return Di;if(!/^[\s\xa0]*$/.test($a))throw Error("Unknown base64 encoding at char: "+$a)}return _o}Bn();for(var vr=0;;){var Br=Ln(-1),xi=Ln(0),ya=Ln(64),Ja=Ln(64);if(Ja===64&&Br===-1)break;ln(Br<<2|xi>>4),ya!=64&&(ln(xi<<4&240|ya>>2),Ja!=64&&ln(ya<<6&192|Ja))}}(Mt,function(Je){Ie[on++]=Je}),on!==me?Ie.subarray(0,on):Ie}function Bn(){if(!sn){sn={};for(var Mt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),ae=["+/=","+/","-_=","-_.","-_"],me=0;5>me;me++){var Ie=Mt.concat(ae[me].split(""));en[me]=Ie;for(var on=0;on<Ie.length;on++){var Je=Ie[on];sn[Je]===void 0&&(sn[Je]=on)}}}}var Fn,Xn=typeof Uint8Array=="function";function Nn(Mt){return Xn&&Mt!=null&&Mt instanceof Uint8Array}function kr(Mt){if(this.L=Mt,Mt!==null&&Mt.length===0)throw Error("ByteString should be constructed with non-empty values")}var Tr=typeof Uint8Array.prototype.slice=="function",Ar=0;function Dr(Mt,ae){return Error("Invalid wire type: "+Mt+" (at position "+ae+")")}function Ni(){return Error("Failed to read varint, encoding is invalid.")}function Mi(Mt,ae){ae=(ae=ae===void 0?{}:ae).v!==void 0&&ae.v,this.h=null,this.g=this.i=this.j=0,this.v=ae,Mt&&Yi(this,Mt)}function Yi(Mt,ae){Mt.h=function(me,Ie){if(me.constructor===Uint8Array)return me;if(me.constructor===ArrayBuffer)return new Uint8Array(me);if(me.constructor===Array)return new Uint8Array(me);if(me.constructor===String)return Rn(me);if(me.constructor===kr)return!Ie&&(Ie=me.L)&&Ie.constructor===Uint8Array?Ie:(Ie=(Ie=me.L)==null||Nn(Ie)?Ie:typeof Ie=="string"?Rn(Ie):null,(me=me.L=Ie)?new Uint8Array(me):Fn||(Fn=new Uint8Array(0)));if(me instanceof Uint8Array)return new Uint8Array(me.buffer,me.byteOffset,me.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")}(ae,Mt.v),Mt.j=0,Mt.i=Mt.h.length,Mt.g=Mt.j}function Hr(Mt){if(Mt.g>Mt.i)throw Error("Tried to read past the end of the data "+Mt.g+" > "+Mt.i)}function wa(Mt){var ae=Mt.h,me=ae[Mt.g],Ie=127&me;if(128>me)return Mt.g+=1,Hr(Mt),Ie;if(Ie|=(127&(me=ae[Mt.g+1]))<<7,128>me)return Mt.g+=2,Hr(Mt),Ie;if(Ie|=(127&(me=ae[Mt.g+2]))<<14,128>me)return Mt.g+=3,Hr(Mt),Ie;if(Ie|=(127&(me=ae[Mt.g+3]))<<21,128>me)return Mt.g+=4,Hr(Mt),Ie;if(me=ae[Mt.g+4],Mt.g+=5,Ie|=(15&me)<<28,128>me)return Hr(Mt),Ie;if(128<=ae[Mt.g++]&&128<=ae[Mt.g++]&&128<=ae[Mt.g++]&&128<=ae[Mt.g++]&&128<=ae[Mt.g++])throw Ni();return Hr(Mt),Ie}Mi.prototype.reset=function(){this.g=this.j};var Oa=[];function Xa(){this.g=[]}function ta(Mt,ae){for(;127<ae;)Mt.g.push(127&ae|128),ae>>>=7;Mt.g.push(ae)}function xa(Mt){var ae={},me=ae.W!==void 0&&ae.W;this.l={v:ae.v!==void 0&&ae.v},this.W=me,ae=this.l,Oa.length?(me=Oa.pop(),ae&&(me.v=ae.v),Mt&&Yi(me,Mt),Mt=me):Mt=new Mi(Mt,ae),this.g=Mt,this.j=this.g.g,this.h=this.i=-1}function Ka(Mt){var ae=Mt.g;if(ae.g==ae.i)return!1;Mt.j=Mt.g.g;var me=wa(Mt.g)>>>0;if(ae=me>>>3,!(0<=(me&=7)&&5>=me))throw Dr(me,Mt.j);if(1>ae)throw Error("Invalid field number: "+ae+" (at position "+Mt.j+")");return Mt.i=ae,Mt.h=me,!0}function nu(Mt){switch(Mt.h){case 0:if(Mt.h!=0)nu(Mt);else t:{for(var ae=(Mt=Mt.g).g,me=ae+10;ae<me;)if(!(128&Mt.h[ae++])){Mt.g=ae,Hr(Mt);break t}throw Ni()}break;case 1:(Mt=Mt.g).g+=8,Hr(Mt);break;case 2:Mt.h!=2?nu(Mt):(ae=wa(Mt.g)>>>0,(Mt=Mt.g).g+=ae,Hr(Mt));break;case 5:(Mt=Mt.g).g+=4,Hr(Mt);break;case 3:for(ae=Mt.i;;){if(!Ka(Mt))throw Error("Unmatched start-group tag: stream EOF");if(Mt.h==4){if(Mt.i!=ae)throw Error("Unmatched end-group tag");break}nu(Mt)}break;default:throw Dr(Mt.h,Mt.j)}}Xa.prototype.length=function(){return this.g.length},Xa.prototype.end=function(){var Mt=this.g;return this.g=[],Mt},xa.prototype.reset=function(){this.g.reset(),this.j=this.g.g,this.h=this.i=-1};var Ol=[];function Wu(){this.i=[],this.h=0,this.g=new Xa}function vo(Mt,ae){ae.length!==0&&(Mt.i.push(ae),Mt.h+=ae.length)}var eh=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol(void 0):void 0;function Ll(Mt,ae){Object.isFrozen(Mt)||(eh?Mt[eh]|=ae:Mt.N!==void 0?Mt.N|=ae:Object.defineProperties(Mt,{N:{value:ae,configurable:!0,writable:!0,enumerable:!1}}))}function Cu(Mt){var ae;return(ae=eh?Mt[eh]:Mt.N)==null?0:ae}function Vu(Mt){return Ll(Mt,1),Mt}function bl(Mt){return!!Array.isArray(Mt)&&!!(2&Cu(Mt))}function $l(Mt){if(!Array.isArray(Mt))throw Error("cannot mark non-array as immutable");Ll(Mt,2)}function Zd(Mt){return Mt!==null&&typeof Mt=="object"&&!Array.isArray(Mt)&&Mt.constructor===Object}var ld=Object.freeze(Vu([]));function Qd(Mt){if(bl(Mt.m))throw Error("Cannot mutate an immutable Message")}var kc,Jd=typeof Symbol<"u"&&Symbol.hasInstance!==void 0;function Op(Mt){return{value:Mt,configurable:!1,writable:!1,enumerable:!1}}function Sc(Mt,ae,me){return ae===-1?null:ae>=Mt.i?Mt.g?Mt.g[ae]:void 0:me!==void 0&&me&&Mt.g&&(me=Mt.g[ae])!=null?me:Mt.m[ae+Mt.h]}function ru(Mt,ae,me,Ie){Ie=Ie!==void 0&&Ie,Qd(Mt),ae<Mt.i&&!Ie?Mt.m[ae+Mt.h]=me:(Mt.g||(Mt.g=Mt.m[Mt.i+Mt.h]={}))[ae]=me}function fy(Mt,ae,me,Ie){me=me===void 0||me;var on=Sc(Mt,ae,Ie=Ie!==void 0&&Ie);return on==null&&(on=ld),bl(Mt.m)?me&&($l(on),Object.freeze(on)):(on===ld||bl(on))&&ru(Mt,ae,on=Vu(on.slice()),Ie),on}function nh(Mt,ae,me){return(Mt=(Mt=Sc(Mt,ae))==null?Mt:+Mt)==null?me===void 0?0:me:Mt}function os(Mt,ae,me,Ie){Mt.j||(Mt.j={});var on=bl(Mt.m),Je=Mt.j[me];if(!Je){Ie=fy(Mt,me,!0,Ie!==void 0&&Ie),Je=[],on=on||bl(Ie);for(var ln=0;ln<Ie.length;ln++)Je[ln]=new ae(Ie[ln]),on&&$l(Je[ln].m);on&&($l(Je),Object.freeze(Je)),Mt.j[me]=Je}return Je}function Zet(Mt,ae,me,Ie,on){var Je=Je!==void 0&&Je;return Qd(Mt),Je=os(Mt,me,ae,Je),me=Ie||new me,Mt=fy(Mt,ae),on!=null?(Je.splice(on,0,me),Mt.splice(on,0,me.m)):(Je.push(me),Mt.push(me.m)),me}function Qet(Mt,ae){return(Mt=Sc(Mt,ae))==null?0:Mt}function $o(Mt,ae){return(Mt=Sc(Mt,ae))==null?"":Mt}function Jet(Mt){return Y4(Mt,tnt===void 0?imt:tnt)}function H4(Mt,ae){if(Mt!=null){if(Array.isArray(Mt))Mt=Y4(Mt,ae);else if(Zd(Mt)){var me,Ie={};for(me in Mt)Ie[me]=H4(Mt[me],ae);Mt=Ie}else Mt=ae(Mt);return Mt}}function Y4(Mt,ae){for(var me=Mt.slice(),Ie=0;Ie<me.length;Ie++)me[Ie]=H4(me[Ie],ae);return Array.isArray(Mt)&&1&Cu(Mt)&&Vu(me),me}function tnt(Mt){return Mt&&typeof Mt=="object"&&Mt.toJSON?Mt.toJSON():(Mt=function(ae){switch(typeof ae){case"number":return isFinite(ae)?ae:String(ae);case"object":if(ae&&!Array.isArray(ae)){if(Nn(ae))return xn(ae);if(ae instanceof kr){var me=ae.L;return me=me==null||typeof me=="string"?me:Xn&&me instanceof Uint8Array?xn(me):null,(ae.L=me)||""}}}return ae}(Mt),Array.isArray(Mt)?Jet(Mt):Mt)}function imt(Mt){return Nn(Mt)?new Uint8Array(Mt):Mt}function SN(Mt,ae,me){Mt||(Mt=kc),kc=null;var Ie=this.constructor.h;if(Mt||(Mt=Ie?[Ie]:[]),this.h=(Ie?0:-1)-(this.constructor.g||0),this.j=void 0,this.m=Mt,Mt=(Ie=this.m.length)-1,Ie&&Zd(Ie=this.m[Mt])?(this.i=Mt-this.h,this.g=Ie):ae!==void 0&&-1<ae?(this.i=Math.max(ae,Mt+1-this.h),this.g=void 0):this.i=Number.MAX_VALUE,me)for(ae=0;ae<me.length;ae++)if((Mt=me[ae])<this.i)Mt+=this.h,(Ie=this.m[Mt])?Array.isArray(Ie)&&Vu(Ie):this.m[Mt]=ld;else{var on=(Ie=this.g||(this.g=this.m[this.i+this.h]={}))[Mt];on?Array.isArray(on)&&Vu(on):Ie[Mt]=ld}}function _N(){SN.apply(this,arguments)}if(SN.prototype.toJSON=function(){return Jet(this.m)},SN.prototype.toString=function(){return this.m.toString()},$(_N,SN),Jd){var ent={};Object.defineProperties(_N,(ent[Symbol.hasInstance]=Op(function(){throw Error("Cannot perform instanceof checks for MutableMessage")}),ent))}function aj(Mt,ae,me){if(me){var Ie,on={};for(Ie in me){var Je=me[Ie],ln=Je.ha;ln||(on.F=Je.la||Je.fa.P,Je.aa?(on.U=sj(Je.aa),ln=function(Ln){return function(vr,Br,xi){return Ln.F(vr,Br,xi,Ln.U)}}(on)):Je.ca?(on.T=int(Je.X.g,Je.ca),ln=function(Ln){return function(vr,Br,xi){return Ln.F(vr,Br,xi,Ln.T)}}(on)):ln=on.F,Je.ha=ln),ln(ae,Mt,Je.X),on={F:on.F,U:on.U,T:on.T}}}(function(Ln,vr){if(vr=vr.ba){vo(Ln,Ln.g.end());for(var Br=0;Br<vr.length;Br++)vo(Ln,vr[Br])}})(ae,Mt)}var bC=Symbol();function nnt(Mt,ae,me){return Mt[bC]||(Mt[bC]=function(Ie,on){return ae(Ie,on,me)})}function rnt(Mt){var ae=Mt[bC];if(!ae){var me=unt(Mt);ae=function(Ie,on){return lnt(Ie,on,me)},Mt[bC]=ae}return ae}function amt(Mt){var ae=function(on){var Je=on.aa;return Je?rnt(Je):(Je=on.ka)?nnt(on.X.g,Je,on.ca):void 0}(Mt),me=Mt.X,Ie=Mt.fa.O;return ae?function(on,Je){return Ie(on,Je,me,ae)}:function(on,Je){return Ie(on,Je,me)}}function oj(Mt,ae,me,Ie,on,Je){var ln=0;for((Mt=Mt()).length&&typeof Mt[0]!="number"&&(me(ae,Mt[0]),ln++);ln<Mt.length;){me=Mt[ln++];for(var Ln=ln+1;Ln<Mt.length&&typeof Mt[Ln]!="number";)Ln++;var vr=Mt[ln++];switch(Ln-=ln){case 0:Ie(ae,me,vr);break;case 1:Ie(ae,me,vr,Mt[ln++]);break;case 2:on(ae,me,vr,Mt[ln++],Mt[ln++]);break;case 3:Ln=Mt[ln++];var Br=Mt[ln++],xi=Mt[ln++];Array.isArray(xi)?on(ae,me,vr,Ln,Br,xi):Je(ae,me,vr,Ln,Br,xi);break;case 4:Je(ae,me,vr,Mt[ln++],Mt[ln++],Mt[ln++],Mt[ln++]);break;default:throw Error("unexpected number of binary field arguments: "+Ln)}}return ae}var CN=Symbol();function sj(Mt){var ae=Mt[CN];if(!ae){var me=ont(Mt);ae=function(Ie,on){return cnt(Ie,on,me)},Mt[CN]=ae}return ae}function int(Mt,ae){var me=Mt[CN];return me||(me=function(Ie,on){return aj(Ie,on,ae)},Mt[CN]=me),me}var ant=Symbol();function omt(Mt,ae){Mt.push(ae)}function smt(Mt,ae,me){Mt.push(ae,me.P)}function umt(Mt,ae,me,Ie,on){var Je=sj(on),ln=me.P;Mt.push(ae,function(Ln,vr,Br){return ln(Ln,vr,Br,Ie,Je)})}function lmt(Mt,ae,me,Ie,on,Je){var ln=int(Ie,Je),Ln=me.P;Mt.push(ae,function(vr,Br,xi){return Ln(vr,Br,xi,Ie,ln)})}function ont(Mt){return Mt[ant]||oj(Mt,Mt[ant]=[],omt,smt,umt,lmt)}var uj=Symbol();function cmt(Mt,ae){Mt[0]=ae}function hmt(Mt,ae,me,Ie){var on=me.O;Mt[ae]=Ie?function(Je,ln,Ln){return on(Je,ln,Ln,Ie)}:on}function dmt(Mt,ae,me,Ie,on,Je){var ln=me.O,Ln=rnt(on);Mt[ae]=function(vr,Br,xi){return ln(vr,Br,xi,Ie,Ln,Je)}}function snt(Mt,ae,me,Ie,on,Je,ln){var Ln=me.O,vr=nnt(Ie,on,Je);Mt[ae]=function(Br,xi,ya){return Ln(Br,xi,ya,Ie,vr,ln)}}function unt(Mt){return Mt[uj]||oj(Mt,Mt[uj]={},cmt,hmt,dmt,snt)}function lnt(Mt,ae,me){for(;Ka(ae)&&ae.h!=4;){var Ie=ae.i,on=me[Ie];if(!on){var Je=me[0];Je&&(Je=Je[Ie])&&(on=me[Ie]=amt(Je))}if(!(on&&on(ae,Mt,Ie)||(on=ae,Ie=Mt,Je=on.j,nu(on),on.W))){var ln=on.g.h;on=Je===(on=on.g.g)?Fn||(Fn=new Uint8Array(0)):Tr?ln.slice(Je,on):new Uint8Array(ln.subarray(Je,on)),(Je=Ie.ba)?Je.push(on):Ie.ba=[on]}}return Mt}function lj(Mt,ae,me){if(Ol.length){var Ie=Ol.pop();Mt&&(Yi(Ie.g,Mt),Ie.i=-1,Ie.h=-1),Mt=Ie}else Mt=new xa(Mt);try{return lnt(new ae,Mt,unt(me))}finally{(ae=Mt.g).h=null,ae.j=0,ae.i=0,ae.g=0,ae.v=!1,Mt.i=-1,Mt.h=-1,100>Ol.length&&Ol.push(Mt)}}function cnt(Mt,ae,me){for(var Ie=me.length,on=Ie%2==1,Je=on?1:0;Je<Ie;Je+=2)(0,me[Je+1])(ae,Mt,me[Je]);aj(Mt,ae,on?me[0]:void 0)}function cj(Mt,ae){var me=new Wu;cnt(Mt,me,ont(ae)),vo(me,me.g.end()),Mt=new Uint8Array(me.h);for(var Ie=(ae=me.i).length,on=0,Je=0;Je<Ie;Je++){var ln=ae[Je];Mt.set(ln,on),on+=ln.length}return me.i=[Mt],Mt}function wC(Mt,ae){return{O:Mt,P:ae}}var Lp=wC(function(Mt,ae,me){if(Mt.h!==5)return!1;var Ie=(Mt=Mt.g).h[Mt.g],on=Mt.h[Mt.g+1],Je=Mt.h[Mt.g+2],ln=Mt.h[Mt.g+3];return Mt.g+=4,Hr(Mt),Mt=2*((on=(Ie|on<<8|Je<<16|ln<<24)>>>0)>>31)+1,Ie=on>>>23&255,on&=8388607,ru(ae,me,Ie==255?on?NaN:1/0*Mt:Ie==0?Mt*Math.pow(2,-149)*on:Mt*Math.pow(2,Ie-150)*(on+Math.pow(2,23))),!0},function(Mt,ae,me){if((ae=Sc(ae,me))!=null){ta(Mt.g,8*me+5),Mt=Mt.g;var Ie=ae;(Ie=(me=0>Ie?1:0)?-Ie:Ie)===0?Ar=0<1/Ie?0:2147483648:isNaN(Ie)?Ar=2147483647:34028234663852886e22<Ie?Ar=(me<<31|2139095040)>>>0:11754943508222875e-54>Ie?(Ie=Math.round(Ie/Math.pow(2,-149)),Ar=(me<<31|Ie)>>>0):(ae=Math.floor(Math.log(Ie)/Math.LN2),Ie*=Math.pow(2,-ae),16777216<=(Ie=Math.round(8388608*Ie))&&++ae,Ar=(me<<31|ae+127<<23|8388607&Ie)>>>0),me=Ar,Mt.g.push(me>>>0&255),Mt.g.push(me>>>8&255),Mt.g.push(me>>>16&255),Mt.g.push(me>>>24&255)}}),fmt=wC(function(Mt,ae,me){if(Mt.h!==0)return!1;for(var Ie=Mt.g,on=128,Je=0,ln=Mt=0;4>ln&&128<=on;ln++)on=Ie.h[Ie.g++],Hr(Ie),Je|=(127&on)<<7*ln;if(128<=on&&(on=Ie.h[Ie.g++],Hr(Ie),Je|=(127&on)<<28,Mt|=(127&on)>>4),128<=on)for(ln=0;5>ln&&128<=on;ln++)on=Ie.h[Ie.g++],Hr(Ie),Mt|=(127&on)<<7*ln+3;if(!(128>on))throw Ni();return Ie=Je>>>0,(Mt=2147483648&(on=Mt>>>0))&&(on=~on>>>0,(Ie=1+~Ie>>>0)==0&&(on=on+1>>>0)),Ie=4294967296*on+(Ie>>>0),ru(ae,me,Mt?-Ie:Ie),!0},function(Mt,ae,me){if((ae=Sc(ae,me))!=null&&ae!=null){ta(Mt.g,8*me),Mt=Mt.g;var Ie=ae;for(me=0>Ie,ae=(Ie=Math.abs(Ie))>>>0,Ie=Math.floor((Ie-ae)/4294967296),Ie>>>=0,me&&(Ie=~Ie>>>0,4294967295<(ae=1+(~ae>>>0))&&(ae=0,4294967295<++Ie&&(Ie=0))),me=Ar=ae,ae=Ie;0<ae||127<me;)Mt.g.push(127&me|128),me=(me>>>7|ae<<25)>>>0,ae>>>=7;Mt.g.push(me)}}),pmt=wC(function(Mt,ae,me){return Mt.h===0&&(ru(ae,me,wa(Mt.g)),!0)},function(Mt,ae,me){if((ae=Sc(ae,me))!=null&&ae!=null)if(ta(Mt.g,8*me),Mt=Mt.g,0<=(me=ae))ta(Mt,me);else{for(ae=0;9>ae;ae++)Mt.g.push(127&me|128),me>>=7;Mt.g.push(1)}}),hnt=wC(function(Mt,ae,me){if(Mt.h!==2)return!1;var Ie,on=wa(Mt.g)>>>0,Je=(Mt=Mt.g).g;if(Mt.g+=on,Hr(Mt),Mt=Mt.h,Qe)(Ie=De)||(Ie=De=new TextDecoder("utf-8",{fatal:!0})),Ie=Ie.decode(Mt.subarray(Je,Je+on));else{on=Je+on;for(var ln,Ln,vr,Br=[],xi=null;Je<on;)128>(ln=Mt[Je++])?Br.push(ln):224>ln?Je>=on?ue():(Ln=Mt[Je++],194>ln||(192&Ln)!=128?(Je--,ue()):Br.push((31&ln)<<6|63&Ln)):240>ln?Je>=on-1?ue():(192&(Ln=Mt[Je++]))!=128||ln===224&&160>Ln||ln===237&&160<=Ln||(192&(Ie=Mt[Je++]))!=128?(Je--,ue()):Br.push((15&ln)<<12|(63&Ln)<<6|63&Ie):244>=ln?Je>=on-2?ue():(192&(Ln=Mt[Je++]))!=128||Ln-144+(ln<<28)>>30||(192&(Ie=Mt[Je++]))!=128||(192&(vr=Mt[Je++]))!=128?(Je--,ue()):(ln=(7&ln)<<18|(63&Ln)<<12|(63&Ie)<<6|63&vr,ln-=65536,Br.push(55296+(ln>>10&1023),56320+(1023&ln))):ue(),8192<=Br.length&&(xi=be(xi,Br),Br.length=0);Ie=be(xi,Br)}return ru(ae,me,Ie),!0},function(Mt,ae,me){if((ae=Sc(ae,me))!=null){var Ie=!1;if(Ie=Ie!==void 0&&Ie,cn){if(Ie&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(ae))throw Error("Found an unpaired surrogate");ae=(ze||(ze=new TextEncoder)).encode(ae)}else{for(var on=0,Je=new Uint8Array(3*ae.length),ln=0;ln<ae.length;ln++){var Ln=ae.charCodeAt(ln);if(128>Ln)Je[on++]=Ln;else{if(2048>Ln)Je[on++]=Ln>>6|192;else{if(55296<=Ln&&57343>=Ln){if(56319>=Ln&&ln<ae.length){var vr=ae.charCodeAt(++ln);if(56320<=vr&&57343>=vr){Ln=1024*(Ln-55296)+vr-56320+65536,Je[on++]=Ln>>18|240,Je[on++]=Ln>>12&63|128,Je[on++]=Ln>>6&63|128,Je[on++]=63&Ln|128;continue}ln--}if(Ie)throw Error("Found an unpaired surrogate");Ln=65533}Je[on++]=Ln>>12|224,Je[on++]=Ln>>6&63|128}Je[on++]=63&Ln|128}}ae=Je.subarray(0,on)}ta(Mt.g,8*me+2),ta(Mt.g,ae.length),vo(Mt,Mt.g.end()),vo(Mt,ae)}}),dnt=wC(function(Mt,ae,me,Ie,on){if(Mt.h!==2)return!1;ae=Zet(ae,me,Ie),me=Mt.g.i,Ie=wa(Mt.g)>>>0;var Je=Mt.g.g+Ie,ln=Je-me;if(0>=ln&&(Mt.g.i=Je,on(ae,Mt),ln=Je-Mt.g.g),ln)throw Error("Message parsing ended unexpectedly. Expected to read "+Ie+" bytes, instead read "+(Ie-ln)+" bytes, either the data ended unexpectedly or the message misreported its own length");return Mt.g.g=Je,Mt.g.i=me,!0},function(Mt,ae,me,Ie,on){if((ae=os(ae,Ie,me))!=null)for(Ie=0;Ie<ae.length;Ie++){var Je=Mt;ta(Je.g,8*me+2);var ln=Je.g.end();vo(Je,ln),ln.push(Je.h),Je=ln,on(ae[Ie],Mt),ln=Mt;var Ln=Je.pop();for(Ln=ln.h+ln.g.length()-Ln;127<Ln;)Je.push(127&Ln|128),Ln>>>=7,ln.h++;Je.push(Ln),ln.h++}});function $p(){_N.apply(this,arguments)}if($($p,_N),Jd){var fnt={};Object.defineProperties($p,(fnt[Symbol.hasInstance]=Op(Object[Symbol.hasInstance]),fnt))}function xC(Mt){$p.call(this,Mt)}function pnt(){return[1,pmt,2,Lp,3,hnt,4,hnt]}function EN(Mt){$p.call(this,Mt,-1,gmt)}function mmt(){return[1,dnt,xC,pnt]}$(xC,$p),$(EN,$p),EN.prototype.addClassification=function(Mt,ae){return Zet(this,1,xC,Mt,ae),this};var gmt=[1];function TN(Mt){$p.call(this,Mt)}function hj(){return[1,Lp,2,Lp,3,Lp,4,Lp,5,Lp]}function mnt(Mt){$p.call(this,Mt,-1,vmt)}function ymt(){return[1,dnt,TN,hj]}$(TN,$p),$(mnt,$p);var vmt=[1];function dj(Mt){$p.call(this,Mt)}function gnt(){return[1,Lp,2,Lp,3,Lp,4,Lp,5,Lp,6,fmt]}$(dj,$p);var ynt=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],fj=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],vnt=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],bnt=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],wnt=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],xnt=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],bmt=[].concat(w(ynt),w(fj),w(vnt),w(bnt),w(wnt),w(xnt));function knt(Mt,ae,me){if(me=Mt.createShader(me===0?Mt.VERTEX_SHADER:Mt.FRAGMENT_SHADER),Mt.shaderSource(me,ae),Mt.compileShader(me),!Mt.getShaderParameter(me,Mt.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+Mt.getShaderInfoLog(me));return me}function wmt(Mt){return os(Mt,xC,1).map(function(ae){return{index:Qet(ae,1),ga:nh(ae,2),label:Sc(ae,3)!=null?$o(ae,3):void 0,displayName:Sc(ae,4)!=null?$o(ae,4):void 0}})}function xmt(Mt){return{x:nh(Mt,1),y:nh(Mt,2),z:nh(Mt,3),visibility:Sc(Mt,4)!=null?nh(Mt,4):void 0}}function AN(Mt,ae){this.h=Mt,this.g=ae,this.l=0}function pj(Mt,ae,me){return function(Ie,on){var Je=Ie.g;if(Ie.o===void 0){var ln=knt(Je,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),Ln=knt(Je,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),vr=Je.createProgram();if(Je.attachShader(vr,ln),Je.attachShader(vr,Ln),Je.linkProgram(vr),!Je.getProgramParameter(vr,Je.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+Je.getProgramInfoLog(vr));ln=Ie.o=vr,Je.useProgram(ln),Ln=Je.getUniformLocation(ln,"sampler0"),Ie.j={K:Je.getAttribLocation(ln,"aVertex"),J:Je.getAttribLocation(ln,"aTex"),ma:Ln},Ie.u=Je.createBuffer(),Je.bindBuffer(Je.ARRAY_BUFFER,Ie.u),Je.enableVertexAttribArray(Ie.j.K),Je.vertexAttribPointer(Ie.j.K,2,Je.FLOAT,!1,0,0),Je.bufferData(Je.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),Je.STATIC_DRAW),Je.bindBuffer(Je.ARRAY_BUFFER,null),Ie.s=Je.createBuffer(),Je.bindBuffer(Je.ARRAY_BUFFER,Ie.s),Je.enableVertexAttribArray(Ie.j.J),Je.vertexAttribPointer(Ie.j.J,2,Je.FLOAT,!1,0,0),Je.bufferData(Je.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),Je.STATIC_DRAW),Je.bindBuffer(Je.ARRAY_BUFFER,null),Je.uniform1i(Ln,0)}ln=Ie.j,Je.useProgram(Ie.o),Je.canvas.width=on.width,Je.canvas.height=on.height,Je.viewport(0,0,on.width,on.height),Je.activeTexture(Je.TEXTURE0),Ie.h.bindTexture2d(on.glName),Je.enableVertexAttribArray(ln.K),Je.bindBuffer(Je.ARRAY_BUFFER,Ie.u),Je.vertexAttribPointer(ln.K,2,Je.FLOAT,!1,0,0),Je.enableVertexAttribArray(ln.J),Je.bindBuffer(Je.ARRAY_BUFFER,Ie.s),Je.vertexAttribPointer(ln.J,2,Je.FLOAT,!1,0,0),Je.bindFramebuffer(Je.DRAW_FRAMEBUFFER?Je.DRAW_FRAMEBUFFER:Je.FRAMEBUFFER,null),Je.clearColor(0,0,0,0),Je.clear(Je.COLOR_BUFFER_BIT),Je.colorMask(!0,!0,!0,!0),Je.drawArrays(Je.TRIANGLE_FAN,0,4),Je.disableVertexAttribArray(ln.K),Je.disableVertexAttribArray(ln.J),Je.bindBuffer(Je.ARRAY_BUFFER,null),Ie.h.bindTexture2d(0)}(Mt,ae),typeof Mt.g.canvas.transferToImageBitmap=="function"?Promise.resolve(Mt.g.canvas.transferToImageBitmap()):me?Promise.resolve(Mt.g.canvas):typeof createImageBitmap=="function"?createImageBitmap(Mt.g.canvas):(Mt.i===void 0&&(Mt.i=document.createElement("canvas")),new Promise(function(Ie){Mt.i.height=Mt.g.canvas.height,Mt.i.width=Mt.g.canvas.width,Mt.i.getContext("2d",{}).drawImage(Mt.g.canvas,0,0,Mt.g.canvas.width,Mt.g.canvas.height),Ie(Mt.i)}))}function Snt(Mt){this.g=Mt}var kmt=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Smt(Mt,ae){return ae+Mt}function IN(Mt,ae){window[Mt]=ae}function q4(Mt){if(this.g=Mt,this.listeners={},this.j={},this.H={},this.o={},this.u={},this.I=this.s=this.Z=!0,this.D=Promise.resolve(),this.Y="",this.C={},this.locateFile=Mt&&Mt.locateFile||Smt,typeof window=="object")var ae=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(typeof location>"u")throw Error("solutions can only be loaded on a web page or in a web worker");ae=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.$=ae,Mt.options)for(var me=(ae=y(Object.keys(Mt.options))).next();!me.done;me=ae.next()){me=me.value;var Ie=Mt.options[me].default;Ie!==void 0&&(this.j[me]=typeof Ie=="function"?Ie():Ie)}}function V0(Mt,ae){var me,Ie;return $t(function(on){return ae in Mt.H?on.return(Mt.H[ae]):(me=Mt.locateFile(ae,""),Ie=fetch(me).then(function(Je){return Je.arrayBuffer()}),Mt.H[ae]=Ie,on.return(Ie))})}function mj(Mt,ae,me){var Ie,on,Je,ln,Ln,vr,Br,xi,ya,Ja,_o,$a,Di,Vs;return $t(function(po){switch(po.g){case 1:if(!me)return po.return(ae);for(Ie={},on=0,Je=y(Object.keys(me)),ln=Je.next();!ln.done;ln=Je.next())Ln=ln.value,typeof(vr=me[Ln])!="string"&&vr.type==="texture"&&ae[vr.stream]!==void 0&&++on;1<on&&(Mt.I=!1),Br=y(Object.keys(me)),ln=Br.next();case 2:if(ln.done){po.g=4;break}if(xi=ln.value,typeof(ya=me[xi])=="string")return Di=Ie,Vs=xi,nt(po,function(u3,yj,w1){var Nf;return $t(function(kC){return typeof w1=="number"||w1 instanceof Uint8Array||w1 instanceof u3.h.Uint8BlobList?kC.return(w1):w1 instanceof u3.h.Texture2dDataOut?((Nf=u3.u[yj])||(Nf=new AN(u3.h,u3.G),u3.u[yj]=Nf),kC.return(pj(Nf,w1,u3.I))):kC.return(void 0)})}(Mt,xi,ae[ya]),14);if(Ja=ae[ya.stream],ya.type==="detection_list"){if(Ja){for(var Gs=Ja.getRectList(),If=Ja.getLandmarksList(),cd=Ja.getClassificationsList(),Uo=[],rh=0;rh<Gs.size();++rh){var b1=lj(Gs.get(rh),dj,gnt);b1={boundingBox:{xCenter:nh(b1,1),yCenter:nh(b1,2),height:nh(b1,3),width:nh(b1,4),rotation:nh(b1,5,0),rectId:Qet(b1,6)},landmarks:os(lj(If.get(rh),mnt,ymt),TN,1).map(xmt),V:wmt(lj(cd.get(rh),EN,mmt))},Uo.push(b1)}Gs=Uo}else Gs=[];Ie[xi]=Gs,po.g=7;break}if(ya.type==="proto_list"){if(Ja){for(Gs=Array(Ja.size()),If=0;If<Ja.size();If++)Gs[If]=Ja.get(If);Ja.delete()}else Gs=[];Ie[xi]=Gs,po.g=7;break}if(Ja===void 0){po.g=3;break}if(ya.type==="float_list"){Ie[xi]=Ja,po.g=7;break}if(ya.type==="proto"){Ie[xi]=Ja,po.g=7;break}if(ya.type!=="texture")throw Error("Unknown output config type: '"+ya.type+"'");return(_o=Mt.u[xi])||(_o=new AN(Mt.h,Mt.G),Mt.u[xi]=_o),nt(po,pj(_o,Ja,Mt.I),13);case 13:$a=po.h,Ie[xi]=$a;case 7:ya.transform&&Ie[xi]&&(Ie[xi]=ya.transform(Ie[xi])),po.g=3;break;case 14:Di[Vs]=po.h;case 3:ln=Br.next(),po.g=2;break;case 4:return po.return(Ie)}})}function gj(Mt,ae){for(var me=ae.name||"$",Ie=[].concat(w(ae.wants)),on=new Mt.h.StringList,Je=y(ae.wants),ln=Je.next();!ln.done;ln=Je.next())on.push_back(ln.value);Je=Mt.h.PacketListener.implement({onResults:function(Ln){for(var vr={},Br=0;Br<ae.wants.length;++Br)vr[Ie[Br]]=Ln.get(Br);var xi=Mt.listeners[me];xi&&(Mt.D=mj(Mt,vr,ae.outs).then(function(ya){ya=xi(ya);for(var Ja=0;Ja<ae.wants.length;++Ja){var _o=vr[Ie[Ja]];typeof _o=="object"&&_o.hasOwnProperty&&_o.hasOwnProperty("delete")&&_o.delete()}ya&&(Mt.D=ya)}))}}),Mt.i.attachMultiListener(on,Je),on.delete()}function NN(Mt){var ae=this;Mt=Mt||{};var me={url:"face_detection_short.binarypb"},Ie={type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}};this.g=new q4({locateFile:Mt.locateFile,files:[{data:!0,url:"face_detection_short.binarypb"},{data:!0,url:"face_detection_short_range.tflite"},{simd:!0,url:"face_detection_solution_simd_wasm_bin.js"},{simd:!1,url:"face_detection_solution_wasm_bin.js"}],graph:me,listeners:[{wants:["detections","image_transformed"],outs:{image:"image_transformed",detections:{type:"detection_list",stream:"detections"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window=="object"&&window.navigator!==void 0&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},model:{type:0,onChange:function(on){var Je,ln,Ln,vr,Br;return $t(function(xi){switch(xi.g){case 1:Je=y(on==="short"?["face_detection_short_range.tflite"]:["face_detection_full_range_sparse.tflite"]),ln=Je.next();case 2:if(ln.done){xi.g=4;break}return Ln=ln.value,vr="third_party/mediapipe/modules/face_detection/"+Ln,nt(xi,V0(ae.g,Ln),5);case 5:Br=xi.h,ae.g.overrideFile(vr,Br),ln=Je.next(),xi.g=2;break;case 4:return me.url=on==="short"?"face_detection_short.binarypb":"face_detection_full.binarypb",Ie.graphOptionXref.calculatorName=on==="short"?"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator":"facedetectionfullrangegpu__facedetectionfullrangecommon__TensorsToDetectionsCalculator",xi.return(!0)}})}},minDetectionConfidence:Ie}})}(l=q4.prototype).close=function(){return this.i&&this.i.delete(),Promise.resolve()},l.reset=function(){var Mt=this;return $t(function(ae){Mt.i&&(Mt.i.reset(),Mt.o={},Mt.u={}),ae.g=0})},l.setOptions=function(Mt,ae){var me=this;if(ae=ae||this.g.options){for(var Ie=[],on=[],Je={},ln=y(Object.keys(Mt)),Ln=ln.next();!Ln.done;Je={R:Je.R,S:Je.S},Ln=ln.next()){var vr=Ln.value;vr in this.j&&this.j[vr]===Mt[vr]||(this.j[vr]=Mt[vr],(Ln=ae[vr])!==void 0&&(Ln.onChange&&(Je.R=Ln.onChange,Je.S=Mt[vr],Ie.push(function(Br){return function(){return $t(function(xi){if(xi.g==1)return nt(xi,Br.R(Br.S),2);xi.h===!0&&(me.s=!0),xi.g=0})}}(Je))),Ln.graphOptionXref&&(vr={valueNumber:Ln.type===1?Mt[vr]:0,valueBoolean:Ln.type===0&&Mt[vr],valueString:Ln.type===2?Mt[vr]:""},Ln=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),Ln.graphOptionXref),vr),on.push(Ln))))}Ie.length===0&&on.length===0||(this.s=!0,this.B=(this.B===void 0?[]:this.B).concat(on),this.A=(this.A===void 0?[]:this.A).concat(Ie))}},l.initialize=function(){var Mt=this;return $t(function(ae){return ae.g==1?nt(ae,function(me){var Ie,on,Je,ln,Ln,vr,Br,xi,ya,Ja,_o;return $t(function($a){switch($a.g){case 1:return me.Z?(Ie=me.g.files===void 0?[]:typeof me.g.files=="function"?me.g.files(me.j):me.g.files,nt($a,$t(function(Di){switch(Di.g){case 1:return Di.o=2,nt(Di,WebAssembly.instantiate(kmt),4);case 4:Di.g=3,Di.o=0;break;case 2:return Di.o=0,Di.j=null,Di.return(!1);case 3:return Di.return(!0)}}),2)):$a.return();case 2:if(on=$a.h,typeof window=="object")return IN("createMediapipeSolutionsWasm",{locateFile:me.locateFile}),IN("createMediapipeSolutionsPackedAssets",{locateFile:me.locateFile}),vr=Ie.filter(function(Di){return Di.data!==void 0}),Br=Ie.filter(function(Di){return Di.data===void 0}),xi=Promise.all(vr.map(function(Di){var Vs=V0(me,Di.url);if(Di.path!==void 0){var po=Di.path;Vs=Vs.then(function(Gs){return me.overrideFile(po,Gs),Promise.resolve(Gs)})}return Vs})),ya=Promise.all(Br.map(function(Di){return Di.simd===void 0||Di.simd&&on||!Di.simd&&!on?function(Vs){var po=document.createElement("script");return po.setAttribute("src",Vs),po.setAttribute("crossorigin","anonymous"),new Promise(function(Gs){po.addEventListener("load",function(){Gs()},!1),po.addEventListener("error",function(){Gs()},!1),document.body.appendChild(po)})}(me.locateFile(Di.url,me.$)):Promise.resolve()})).then(function(){var Di,Vs,po;return $t(function(Gs){if(Gs.g==1)return Di=window.createMediapipeSolutionsWasm,Vs=window.createMediapipeSolutionsPackedAssets,po=me,nt(Gs,Di(Vs),2);po.h=Gs.h,Gs.g=0})}),Ja=$t(function(Di){return me.g.graph&&me.g.graph.url?Di=nt(Di,V0(me,me.g.graph.url),0):(Di.g=0,Di=void 0),Di}),nt($a,Promise.all([ya,xi,Ja]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return Je=Ie.filter(function(Di){return Di.simd===void 0||Di.simd&&on||!Di.simd&&!on}).map(function(Di){return me.locateFile(Di.url,me.$)}),importScripts.apply(null,w(Je)),ln=me,nt($a,createMediapipeSolutionsWasm(Module),6);case 6:ln.h=$a.h,me.l=new OffscreenCanvas(1,1),me.h.canvas=me.l,Ln=me.h.GL.createContext(me.l,{antialias:!1,alpha:!1,ja:typeof WebGL2RenderingContext<"u"?2:1}),me.h.GL.makeContextCurrent(Ln),$a.g=4;break;case 7:if(me.l=document.createElement("canvas"),!(_o=me.l.getContext("webgl2",{}))&&!(_o=me.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),$a.return();me.G=_o,me.h.canvas=me.l,me.h.createContext(me.l,!0,!0,{});case 4:me.i=new me.h.SolutionWasm,me.Z=!1,$a.g=0}})}(Mt),2):ae.g!=3?nt(ae,function(me){var Ie,on,Je,ln,Ln,vr,Br,xi;return $t(function(ya){if(ya.g==1)return me.g.graph&&me.g.graph.url&&me.Y===me.g.graph.url?ya.return():(me.s=!0,me.g.graph&&me.g.graph.url?(me.Y=me.g.graph.url,nt(ya,V0(me,me.g.graph.url),3)):void(ya.g=2));for(ya.g!=2&&(Ie=ya.h,me.i.loadGraph(Ie)),on=y(Object.keys(me.C)),Je=on.next();!Je.done;Je=on.next())ln=Je.value,me.i.overrideFile(ln,me.C[ln]);if(me.C={},me.g.listeners)for(Ln=y(me.g.listeners),vr=Ln.next();!vr.done;vr=Ln.next())Br=vr.value,gj(me,Br);xi=me.j,me.j={},me.setOptions(xi),ya.g=0})}(Mt),3):nt(ae,function(me){var Ie,on,Je,ln,Ln,vr;return $t(function(Br){switch(Br.g){case 1:if(!me.s)return Br.return();if(!me.A){Br.g=2;break}Ie=y(me.A),on=Ie.next();case 3:if(on.done){Br.g=5;break}return nt(Br,(0,on.value)(),4);case 4:on=Ie.next(),Br.g=3;break;case 5:me.A=void 0;case 2:if(me.B){for(Je=new me.h.GraphOptionChangeRequestList,ln=y(me.B),Ln=ln.next();!Ln.done;Ln=ln.next())vr=Ln.value,Je.push_back(vr);me.i.changeOptions(Je),Je.delete(),me.B=void 0}me.s=!1,Br.g=0}})}(Mt),0)})},l.overrideFile=function(Mt,ae){this.i?this.i.overrideFile(Mt,ae):this.C[Mt]=ae},l.clearOverriddenFiles=function(){this.C={},this.i&&this.i.clearOverriddenFiles()},l.send=function(Mt,ae){var me,Ie,on,Je,ln,Ln,vr,Br,xi,ya=this;return $t(function(Ja){switch(Ja.g){case 1:return ya.g.inputs?(me=1e3*(ae??performance.now()),nt(Ja,ya.D,2)):Ja.return();case 2:return nt(Ja,ya.initialize(),3);case 3:for(Ie=new ya.h.PacketDataList,on=y(Object.keys(Mt)),Je=on.next();!Je.done;Je=on.next())if(ln=Je.value,Ln=ya.g.inputs[ln]){t:{var _o=Mt[ln];switch(Ln.type){case"video":var $a=ya.o[Ln.stream];if($a||($a=new AN(ya.h,ya.G),ya.o[Ln.stream]=$a),$a.l===0&&($a.l=$a.h.createTexture()),typeof HTMLVideoElement<"u"&&_o instanceof HTMLVideoElement)var Di=_o.videoWidth,Vs=_o.videoHeight;else typeof HTMLImageElement<"u"&&_o instanceof HTMLImageElement?(Di=_o.naturalWidth,Vs=_o.naturalHeight):(Di=_o.width,Vs=_o.height);Vs={glName:$a.l,width:Di,height:Vs},(Di=$a.g).canvas.width=Vs.width,Di.canvas.height=Vs.height,Di.activeTexture(Di.TEXTURE0),$a.h.bindTexture2d($a.l),Di.texImage2D(Di.TEXTURE_2D,0,Di.RGBA,Di.RGBA,Di.UNSIGNED_BYTE,_o),$a.h.bindTexture2d(0),$a=Vs;break t;case"detections":for(($a=ya.o[Ln.stream])||($a=new Snt(ya.h),ya.o[Ln.stream]=$a),$a.data||($a.data=new $a.g.DetectionListData),$a.data.reset(_o.length),Vs=0;Vs<_o.length;++Vs){Di=_o[Vs];var po=$a.data,Gs=po.setBoundingBox,If=Vs,cd=Di.boundingBox,Uo=new dj;if(ru(Uo,1,cd.xCenter),ru(Uo,2,cd.yCenter),ru(Uo,3,cd.height),ru(Uo,4,cd.width),ru(Uo,5,cd.rotation),ru(Uo,6,cd.rectId),cd=cj(Uo,gnt),Gs.call(po,If,cd),Di.landmarks)for(po=0;po<Di.landmarks.length;++po){var rh=!!(Uo=Di.landmarks[po]).visibility;If=(Gs=$a.data).addNormalizedLandmark,cd=Vs,Uo=Object.assign(Object.assign({},Uo),{visibility:rh?Uo.visibility:0}),ru(rh=new TN,1,Uo.x),ru(rh,2,Uo.y),ru(rh,3,Uo.z),Uo.visibility&&ru(rh,4,Uo.visibility),Uo=cj(rh,hj),If.call(Gs,cd,Uo)}if(Di.V)for(po=0;po<Di.V.length;++po)If=(Gs=$a.data).addClassification,cd=Vs,Uo=Di.V[po],ru(rh=new xC,2,Uo.ga),Uo.index&&ru(rh,1,Uo.index),Uo.label&&ru(rh,3,Uo.label),Uo.displayName&&ru(rh,4,Uo.displayName),Uo=cj(rh,pnt),If.call(Gs,cd,Uo)}$a=$a.data;break t;default:$a={}}}switch(vr=$a,Br=Ln.stream,Ln.type){case"video":Ie.pushTexture2d(Object.assign(Object.assign({},vr),{stream:Br,timestamp:me}));break;case"detections":(xi=vr).stream=Br,xi.timestamp=me,Ie.pushDetectionList(xi);break;default:throw Error("Unknown input config type: '"+Ln.type+"'")}}return ya.i.send(Ie),nt(Ja,ya.D,4);case 4:Ie.delete(),Ja.g=0}})},l.onResults=function(Mt,ae){this.listeners[ae||"$"]=Mt},re("Solution",q4),re("OptionType",{BOOL:0,NUMBER:1,ia:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(l=NN.prototype).close=function(){return this.g.close(),Promise.resolve()},l.onResults=function(Mt){this.g.onResults(Mt)},l.initialize=function(){var Mt=this;return $t(function(ae){return nt(ae,Mt.g.initialize(),0)})},l.reset=function(){this.g.reset()},l.send=function(Mt){var ae=this;return $t(function(me){return nt(me,ae.g.send(Mt),0)})},l.setOptions=function(Mt){this.g.setOptions(Mt)},re("FaceDetection",NN),re("FACEDETECTION_LIPS",ynt),re("FACEDETECTION_LEFT_EYE",fj),re("FACEDETECTION_LEFT_EYEBROW",vnt),re("FACEDETECTION_RIGHT_EYE",bnt),re("FACEDETECTION_RIGHT_EYEBROW",wnt),re("FACEDETECTION_FACE_OVAL",xnt),re("FACEDETECTION_CONTOURS",bmt),re("FACEDETECTION_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]])}).call(Ib);var a1=function(){return a1=Object.assign||function(l){for(var i,o=1,u=arguments.length;o<u;o++)for(var c in i=arguments[o])Object.prototype.hasOwnProperty.call(i,c)&&(l[c]=i[c]);return l},a1.apply(this,arguments)};function T0(l,i,o,u){return new(o||(o=Promise))(function(c,f){function y(T){try{C(u.next(T))}catch(x){f(x)}}function w(T){try{C(u.throw(T))}catch(x){f(x)}}function C(T){var x;T.done?c(T.value):(x=T.value,x instanceof o?x:new o(function(A){A(x)})).then(y,w)}C((u=u.apply(l,[])).next())})}function A0(l,i){var o,u,c,f,y={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return f={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function w(C){return function(T){return function(x){if(o)throw new TypeError("Generator is already executing.");for(;y;)try{if(o=1,u&&(c=2&x[0]?u.return:x[0]?u.throw||((c=u.return)&&c.call(u),0):u.next)&&!(c=c.call(u,x[1])).done)return c;switch(u=0,c&&(x=[2&x[0],c.value]),x[0]){case 0:case 1:c=x;break;case 4:return y.label++,{value:x[1],done:!1};case 5:y.label++,u=x[1],x=[0];continue;case 7:x=y.ops.pop(),y.trys.pop();continue;default:if(!((c=(c=y.trys).length>0&&c[c.length-1])||x[0]!==6&&x[0]!==2)){y=0;continue}if(x[0]===3&&(!c||x[1]>c[0]&&x[1]<c[3])){y.label=x[1];break}if(x[0]===6&&y.label<c[1]){y.label=c[1],c=x;break}if(c&&y.label<c[2]){y.label=c[2],y.ops.push(x);break}c[2]&&y.ops.pop(),y.trys.pop();continue}x=i.call(l,y)}catch(A){x=[6,A],u=0}finally{o=c=0}if(5&x[0])throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}([C,T])}}}var zz=["rightEye","leftEye","noseTip","mouthCenter","rightEarTragion","leftEarTragion"],Pz={modelType:"short",runtime:"mediapipe",maxFaces:1},xQ=function(){function l(i){var o=this;this.width=0,this.height=0,this.selfieMode=!1,this.faceDetectorSolution=new $z.FaceDetection({locateFile:function(u,c){return i.solutionPath?i.solutionPath.replace(/\/+$/,"")+"/"+u:c+"/"+u}}),this.faceDetectorSolution.setOptions({selfieMode:this.selfieMode,model:i.modelType}),this.faceDetectorSolution.onResults(function(u){if(o.height=u.image.height,o.width=u.image.width,o.faces=[],u.detections!==null)for(var c=0,f=u.detections;c<f.length;c++){var y=f[c];o.faces.push(o.normalizedToAbsolute(y.landmarks,{xMin:C=(w=y.boundingBox).xCenter-w.width/2,xMax:C+w.width,yMin:T=w.yCenter-w.height/2,yMax:T+w.height,width:w.width,height:w.height}))}var w,C,T})}return l.prototype.normalizedToAbsolute=function(i,o){var u=this;return{keypoints:i.map(function(c,f){return{x:c.x*u.width,y:c.y*u.height,name:zz[f]}}),box:{xMin:o.xMin*this.width,yMin:o.yMin*this.height,xMax:o.xMax*this.width,yMax:o.yMax*this.height,width:o.width*this.width,height:o.height*this.height}}},l.prototype.estimateFaces=function(i,o){return T0(this,void 0,void 0,function(){var u,c;return A0(this,function(f){switch(f.label){case 0:return o&&o.flipHorizontal&&o.flipHorizontal!==this.selfieMode&&(this.selfieMode=o.flipHorizontal,this.faceDetectorSolution.setOptions({selfieMode:this.selfieMode})),i instanceof m.Tensor?(c=ImageData.bind,[4,m.browser.toPixels(i)]):[3,2];case 1:return u=new(c.apply(ImageData,[void 0,f.sent(),i.shape[1],i.shape[0]])),[3,3];case 2:u=i,f.label=3;case 3:return i=u,[4,this.faceDetectorSolution.send({image:i})];case 4:return f.sent(),[2,this.faces]}})})},l.prototype.dispose=function(){this.faceDetectorSolution.close()},l.prototype.reset=function(){this.faceDetectorSolution.reset(),this.width=0,this.height=0,this.faces=null,this.selfieMode=!1},l.prototype.initialize=function(){return this.faceDetectorSolution.initialize()},l}();function kQ(l){return T0(this,void 0,void 0,function(){var i,o;return A0(this,function(u){switch(u.label){case 0:return i=function(c){if(c==null)return a1({},Pz);var f=a1({},c);return f.runtime="mediapipe",f.modelType==null&&(f.modelType=Pz.modelType),f.maxFaces==null&&(f.maxFaces=Pz.maxFaces),f}(l),[4,(o=new xQ(i)).initialize()];case 1:return u.sent(),[2,o]}})})}function Bz(l){return l instanceof m.Tensor?{height:l.shape[0],width:l.shape[1]}:{height:l.height,width:l.width}}function jz(l){return l instanceof m.Tensor?l:m.browser.fromPixels(l)}function Uz(l,i){m.util.assert(l.width!==0,function(){return i+" width cannot be 0."}),m.util.assert(l.height!==0,function(){return i+" height cannot be 0."})}function SQ(l){l.reduceBoxesInLowestLayer==null&&(l.reduceBoxesInLowestLayer=!1),l.interpolatedScaleAspectRatio==null&&(l.interpolatedScaleAspectRatio=1),l.fixedAnchorSize==null&&(l.fixedAnchorSize=!1);for(var i=[],o=0;o<l.numLayers;){for(var u=[],c=[],f=[],y=[],w=o;w<l.strides.length&&l.strides[w]===l.strides[o];){var C=Wz(l.minScale,l.maxScale,w,l.strides.length);if(w===0&&l.reduceBoxesInLowestLayer)f.push(1),f.push(2),f.push(.5),y.push(.1),y.push(C),y.push(C);else{for(var T=0;T<l.aspectRatios.length;++T)f.push(l.aspectRatios[T]),y.push(C);if(l.interpolatedScaleAspectRatio>0){var x=w===l.strides.length-1?1:Wz(l.minScale,l.maxScale,w+1,l.strides.length);y.push(Math.sqrt(C*x)),f.push(l.interpolatedScaleAspectRatio)}}w++}for(var A=0;A<f.length;++A){var M=Math.sqrt(f[A]);u.push(y[A]/M),c.push(y[A]*M)}var $=0,V=0;if(l.featureMapHeight.length>0)$=l.featureMapHeight[o],V=l.featureMapWidth[o];else{var G=l.strides[o];$=Math.ceil(l.inputSizeHeight/G),V=Math.ceil(l.inputSizeWidth/G)}for(var Q=0;Q<$;++Q)for(var nt=0;nt<V;++nt)for(var it=0;it<u.length;++it){var ht={xCenter:(nt+l.anchorOffsetX)/V,yCenter:(Q+l.anchorOffsetY)/$,width:0,height:0};l.fixedAnchorSize?(ht.width=1,ht.height=1):(ht.width=c[it],ht.height=u[it]),i.push(ht)}o=w}return i}function Wz(l,i,o,u){return u===1?.5*(l+i):l+(i-l)*o/(u-1)}function Vz(l,i){var o=i[0],u=i[1];return[o*l[0]+u*l[1]+l[3],o*l[4]+u*l[5]+l[7]]}function _Q(l,i,o,u){return T0(this,void 0,void 0,function(){var c,f,y,w,C;return A0(this,function(T){switch(T.label){case 0:return l.sort(function(x,A){return Math.max.apply(Math,A.score)-Math.max.apply(Math,x.score)}),c=(0,m.tensor2d)(l.map(function(x){return[x.locationData.relativeBoundingBox.yMin,x.locationData.relativeBoundingBox.xMin,x.locationData.relativeBoundingBox.yMax,x.locationData.relativeBoundingBox.xMax]})),f=(0,m.tensor1d)(l.map(function(x){return x.score[0]})),[4,m.image.nonMaxSuppressionAsync(c,f,i,o)];case 1:return[4,(y=T.sent()).array()];case 2:return w=T.sent(),C=l.filter(function(x,A){return w.indexOf(A)>-1}),(0,m.dispose)([c,f,y]),[2,C]}})})}function CQ(l,i,o){return T0(this,void 0,void 0,function(){var u,c,f,y,w;return A0(this,function(C){switch(C.label){case 0:return u=l[0],c=l[1],f=function(T,x,A){return(0,m.tidy)(function(){var M,$,V,G;A.reverseOutputOrder?($=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+0],[-1,1])),M=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+1],[-1,1])),G=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+2],[-1,1])),V=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+3],[-1,1]))):(M=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+0],[-1,1])),$=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+1],[-1,1])),V=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+2],[-1,1])),G=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+3],[-1,1]))),$=(0,m.add)((0,m.mul)((0,m.div)($,A.xScale),x.w),x.x),M=(0,m.add)((0,m.mul)((0,m.div)(M,A.yScale),x.h),x.y),A.applyExponentialOnBoxSize?(V=(0,m.mul)((0,m.exp)((0,m.div)(V,A.hScale)),x.h),G=(0,m.mul)((0,m.exp)((0,m.div)(G,A.wScale)),x.w)):(V=(0,m.mul)((0,m.div)(V,A.hScale),x.h),G=(0,m.mul)((0,m.div)(G,A.wScale),x.h));var Q=(0,m.sub)(M,(0,m.div)(V,2)),nt=(0,m.sub)($,(0,m.div)(G,2)),it=(0,m.add)(M,(0,m.div)(V,2)),ht=(0,m.add)($,(0,m.div)(G,2)),kt=(0,m.concat)([(0,m.reshape)(Q,[A.numBoxes,1]),(0,m.reshape)(nt,[A.numBoxes,1]),(0,m.reshape)(it,[A.numBoxes,1]),(0,m.reshape)(ht,[A.numBoxes,1])],1);if(A.numKeypoints)for(var Nt=0;Nt<A.numKeypoints;++Nt){var $t=A.keypointCoordOffset+Nt*A.numValuesPerKeypoint,Ut=void 0,Pt=void 0;A.reverseOutputOrder?(Ut=(0,m.squeeze)((0,m.slice)(T,[0,$t],[-1,1])),Pt=(0,m.squeeze)((0,m.slice)(T,[0,$t+1],[-1,1]))):(Pt=(0,m.squeeze)((0,m.slice)(T,[0,$t],[-1,1])),Ut=(0,m.squeeze)((0,m.slice)(T,[0,$t+1],[-1,1])));var re=(0,m.add)((0,m.mul)((0,m.div)(Ut,A.xScale),x.w),x.x),ue=(0,m.add)((0,m.mul)((0,m.div)(Pt,A.yScale),x.h),x.y);kt=(0,m.concat)([kt,(0,m.reshape)(re,[A.numBoxes,1]),(0,m.reshape)(ue,[A.numBoxes,1])],1)}return kt})}(c,i,o),y=(0,m.tidy)(function(){var T=u;return o.sigmoidScore?(o.scoreClippingThresh!=null&&(T=(0,m.clipByValue)(u,-o.scoreClippingThresh,o.scoreClippingThresh)),T=(0,m.sigmoid)(T)):T}),[4,cft(f,y,o)];case 1:return w=C.sent(),(0,m.dispose)([f,y]),[2,w]}})})}function cft(l,i,o){return T0(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M,$,V;return A0(this,function(G){switch(G.label){case 0:return u=[],[4,l.data()];case 1:return c=G.sent(),[4,i.data()];case 2:for(f=G.sent(),y=0;y<o.numBoxes;++y)if(!(o.minScoreThresh!=null&&f[y]<o.minScoreThresh||(w=y*o.numCoords,C=f6(c[w+0],c[w+1],c[w+2],c[w+3],f[y],o.flipVertically,y),(T=C.locationData.relativeBoundingBox).width<0||T.height<0))){if(o.numKeypoints>0)for((x=C.locationData).relativeKeypoints=[],A=o.numKeypoints*o.numValuesPerKeypoint,M=0;M<A;M+=o.numValuesPerKeypoint)$=w+o.keypointCoordOffset+M,V={x:c[$+0],y:o.flipVertically?1-c[$+1]:c[$+1]},x.relativeKeypoints.push(V);u.push(C)}return[2,u]}})})}function f6(l,i,o,u,c,f,y){return{score:[c],ind:y,locationData:{relativeBoundingBox:{xMin:i,yMin:f?1-o:l,xMax:u,yMax:f?1-l:o,width:u-i,height:o-l}}}}var Nb,p6={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:4,minScale:.1484375,maxScale:.75,inputSizeHeight:128,inputSizeWidth:128,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,16,16],aspectRatios:[1],fixedAnchorSize:!0},u4={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:0,featureMapHeight:[],featureMapWidth:[],numLayers:1,minScale:.1484375,maxScale:.75,inputSizeHeight:192,inputSizeWidth:192,anchorOffsetX:.5,anchorOffsetY:.5,strides:[4],aspectRatios:[1],fixedAnchorSize:!0},GI={runtime:"tfjs",modelType:"short",maxFaces:1,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/face_detection/short/1"},hft={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:896,numCoords:16,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:6,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:128,yScale:128,hScale:128,wScale:128,minScoreThresh:.5},dft={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:2304,numCoords:16,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:6,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:192,yScale:192,hScale:192,wScale:192,minScoreThresh:.6},fft={outputTensorSize:{width:128,height:128},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},EQ={outputTensorSize:{width:192,height:192},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},pft=function(){function l(i,o,u){this.detectorModel=o,this.maxFaces=u,i==="full"?(this.imageToTensorConfig=EQ,this.tensorsToDetectionConfig=dft,this.anchors=SQ(u4)):(this.imageToTensorConfig=fft,this.tensorsToDetectionConfig=hft,this.anchors=SQ(p6));var c=(0,m.tensor1d)(this.anchors.map(function(C){return C.width})),f=(0,m.tensor1d)(this.anchors.map(function(C){return C.height})),y=(0,m.tensor1d)(this.anchors.map(function(C){return C.xCenter})),w=(0,m.tensor1d)(this.anchors.map(function(C){return C.yCenter}));this.anchorTensor={x:y,y:w,w:c,h:f}}return l.prototype.dispose=function(){this.detectorModel.dispose(),(0,m.dispose)([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h])},l.prototype.reset=function(){},l.prototype.detectFaces=function(i,o){return o===void 0&&(o=!1),T0(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M,$;return A0(this,function(V){switch(V.label){case 0:return i==null?(this.reset(),[2,[]]):(u=(0,m.tidy)(function(){var G=(0,m.cast)(jz(i),"float32");return o&&(G=(0,m.squeeze)(m.image.flipLeftRight((0,m.expandDims)(G,0)),[0])),G}),c=function(G,Q,nt){var it=Q.outputTensorSize,ht=Q.keepAspectRatio,kt=Q.borderMode,Nt=Q.outputTensorFloatRange,$t=Bz(G),Ut=function(be,De){return{xCenter:.5*be.width,yCenter:.5*be.height,width:be.width,height:be.height,rotation:0}}($t),Pt=function(be,De,ze){if(ze===void 0&&(ze=!1),!ze)return{top:0,left:0,right:0,bottom:0};var Qe=De.height,cn=De.width;Uz(De,"targetSize"),Uz(be,"roi");var en,sn,xn=Qe/cn,Rn=be.height/be.width,Bn=0,Fn=0;return xn>Rn?(en=be.width,sn=be.width*xn,Fn=(1-Rn/xn)/2):(en=be.height/xn,sn=be.height,Bn=(1-xn/Rn)/2),be.width=en,be.height=sn,{top:Fn,left:Bn,right:Bn,bottom:Fn}}(Ut,it,ht),re=function(be,De,ze){var Qe=be.width,cn=be.height,en=Math.cos(be.rotation),sn=Math.sin(be.rotation),xn=be.xCenter,Rn=be.yCenter,Bn=1/De,Fn=1/ze,Xn=new Array(16);return Xn[0]=Qe*en*1*Bn,Xn[1]=-cn*sn*Bn,Xn[2]=0,Xn[3]=(-.5*Qe*en*1+.5*cn*sn+xn)*Bn,Xn[4]=Qe*sn*1*Fn,Xn[5]=cn*en*Fn,Xn[6]=0,Xn[7]=(-.5*cn*en-.5*Qe*sn*1+Rn)*Fn,Xn[8]=0,Xn[9]=0,Xn[10]=Qe*Bn,Xn[11]=0,Xn[12]=0,Xn[13]=0,Xn[14]=0,Xn[15]=1,function(Nn){if(Nn.length!==16)throw new Error("Array length must be 16 but got "+Nn.length);return[[Nn[0],Nn[1],Nn[2],Nn[3]],[Nn[4],Nn[5],Nn[6],Nn[7]],[Nn[8],Nn[9],Nn[10],Nn[11]],[Nn[12],Nn[13],Nn[14],Nn[15]]]}(Xn)}(Ut,$t.width,$t.height),ue=(0,m.tidy)(function(){var be=jz(G),De=(0,m.tensor2d)(function(cn,en,sn){return Uz(sn,"inputResolution"),[1/sn.width*cn[0][0]*en.width,1/sn.height*cn[0][1]*en.width,cn[0][3]*en.width,1/sn.width*cn[1][0]*en.height,1/sn.height*cn[1][1]*en.height,cn[1][3]*en.height,0,0]}(re,$t,it),[1,8]),ze=kt==="zero"?"constant":"nearest",Qe=m.image.transform((0,m.expandDims)((0,m.cast)(be,"float32")),De,"bilinear",ze,0,[it.height,it.width]);return Nt!=null?function(cn,en){var sn=function(xn,Rn,Bn,Fn){var Xn=(Fn-Bn)/255;return{scale:Xn,offset:Bn-0*Xn}}(0,0,en[0],en[1]);return(0,m.tidy)(function(){return(0,m.add)((0,m.mul)(cn,sn.scale),sn.offset)})}(Qe,Nt):Qe});return{imageTensor:ue,padding:Pt,transformationMatrix:re}}(u,this.imageToTensorConfig),f=c.imageTensor,y=c.transformationMatrix,w=this.detectorModel.execute(f,"Identity:0"),C=function(G){return(0,m.tidy)(function(){var Q=function(ht){return(0,m.tidy)(function(){return[(0,m.slice)(ht,[0,0,0],[1,-1,1]),(0,m.slice)(ht,[0,0,1],[1,-1,-1])]})}(G),nt=Q[0],it=Q[1];return{boxes:(0,m.squeeze)(it),logits:(0,m.squeeze)(nt)}})}(w),T=C.boxes,[4,CQ([x=C.logits,T],this.anchorTensor,this.tensorsToDetectionConfig)]);case 1:return(A=V.sent()).length===0?((0,m.dispose)([u,f,w,x,T]),[2,A]):[4,_Q(A,this.maxFaces,.3)];case 2:return M=V.sent(),$=function(G,Q){G===void 0&&(G=[]);var nt,it=(nt=Q,[].concat.apply([],nt));return G.forEach(function(ht){var kt=ht.locationData;kt.relativeKeypoints.forEach(function(ue){var be=Vz(it,[ue.x,ue.y]),De=be[0],ze=be[1];ue.x=De,ue.y=ze});var Nt=kt.relativeBoundingBox,$t=Number.MAX_VALUE,Ut=Number.MAX_VALUE,Pt=Number.MIN_VALUE,re=Number.MIN_VALUE;[[Nt.xMin,Nt.yMin],[Nt.xMin+Nt.width,Nt.yMin],[Nt.xMin+Nt.width,Nt.yMin+Nt.height],[Nt.xMin,Nt.yMin+Nt.height]].forEach(function(ue){var be=Vz(it,ue),De=be[0],ze=be[1];$t=Math.min($t,De),Pt=Math.max(Pt,De),Ut=Math.min(Ut,ze),re=Math.max(re,ze)}),kt.relativeBoundingBox={xMin:$t,xMax:Pt,yMin:Ut,yMax:re,width:Pt-$t,height:re-Ut}}),G}(M,y),(0,m.dispose)([u,f,w,x,T]),[2,$]}})})},l.prototype.estimateFaces=function(i,o){return T0(this,void 0,void 0,function(){var u,c;return A0(this,function(f){return u=Bz(i),c=!!o&&o.flipHorizontal,[2,this.detectFaces(i,c).then(function(y){return y.map(function(w){for(var C=w.locationData.relativeKeypoints.map(function(V,G){return a1(a1({},V),{x:V.x*u.width,y:V.y*u.height,name:zz[G]})}),T=w.locationData.relativeBoundingBox,x=0,A=["width","xMax","xMin"];x<A.length;x++)T[A[x]]*=u.width;for(var M=0,$=["height","yMax","yMin"];M<$.length;M++)T[$[M]]*=u.height;return{keypoints:C,box:T}})})]})})},l}();function mft(l){return T0(this,void 0,void 0,function(){var i,o,u;return A0(this,function(c){switch(c.label){case 0:return i=function(f){if(f==null)return a1({},GI);var y=a1({},f);return y.modelType==null&&(y.modelType=GI.modelType),y.maxFaces==null&&(y.maxFaces=GI.maxFaces),y.detectorModelUrl==null&&(y.modelType==="full"?y.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/face_detection/full/1":y.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/face_detection/short/1"),y}(l),o=typeof i.detectorModelUrl=="string"&&i.detectorModelUrl.indexOf("https://tfhub.dev")>-1,[4,Vc(i.detectorModelUrl,{fromTFHub:o})];case 1:return u=c.sent(),[2,new pft(i.modelType,u,i.maxFaces)]}})})}function TQ(l,i){return T0(this,void 0,void 0,function(){var o,u;return A0(this,function(c){if(l===Nb.MediaPipeFaceDetector){if(u=void 0,(o=i)!=null){if(o.runtime==="tfjs")return[2,mft(o)];if(o.runtime==="mediapipe")return[2,kQ(o)];u=o.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+u)}throw new Error(l+" is not a supported model name.")})})}function HI(l){return l.width*l.height}function AQ(l){var i=l.xCenter-l.width/2,o=i+l.width,u=l.yCenter-l.height/2;return{xMin:i,xMax:o,yMin:u,yMax:u+l.height,width:l.width,height:l.height}}function IQ(l){return l instanceof m.Tensor?{height:l.shape[0],width:l.shape[1]}:{height:l.height,width:l.width}}function NQ(l){return l-2*Math.PI*Math.floor((l+Math.PI)/(2*Math.PI))}function MQ(l){return l instanceof m.Tensor?l:m.browser.fromPixels(l)}function Gz(l,i){m.util.assert(l.width!==0,function(){return i+" width cannot be 0."}),m.util.assert(l.height!==0,function(){return i+" height cannot be 0."})}function gft(l,i,o){var u=i.outputTensorSize,c=i.keepAspectRatio,f=i.outputTensorFloatRange,y=IQ(l),w=function(A,M){return M?{xCenter:M.xCenter*A.width,yCenter:M.yCenter*A.height,width:M.width*A.width,height:M.height*A.height,rotation:M.rotation}:{xCenter:.5*A.width,yCenter:.5*A.height,width:A.width,height:A.height,rotation:0}}(y,o),C=function(A,M,$){if($===void 0&&($=!1),!$)return{top:0,left:0,right:0,bottom:0};var V=M.height,G=M.width;Gz(M,"targetSize"),Gz(A,"roi");var Q,nt,it=V/G,ht=A.height/A.width,kt=0,Nt=0;return it>ht?(Q=A.width,nt=A.width*it,Nt=(1-ht/it)/2):(Q=A.height/it,nt=A.height,kt=(1-it/ht)/2),A.width=Q,A.height=nt,{top:Nt,left:kt,right:kt,bottom:Nt}}(w,u,c),T=function(A,M,$,V){var G=A.width,Q=A.height,nt=1,it=Math.cos(A.rotation),ht=Math.sin(A.rotation),kt=A.xCenter,Nt=A.yCenter,$t=1/M,Ut=1/$,Pt=new Array(16);return Pt[0]=G*it*nt*$t,Pt[1]=-Q*ht*$t,Pt[2]=0,Pt[3]=(-.5*G*it*nt+.5*Q*ht+kt)*$t,Pt[4]=G*ht*nt*Ut,Pt[5]=Q*it*Ut,Pt[6]=0,Pt[7]=(-.5*Q*it-.5*G*ht*nt+Nt)*Ut,Pt[8]=0,Pt[9]=0,Pt[10]=G*$t,Pt[11]=0,Pt[12]=0,Pt[13]=0,Pt[14]=0,Pt[15]=1,function(re){if(re.length!==16)throw new Error("Array length must be 16 but got "+re.length);return[[re[0],re[1],re[2],re[3]],[re[4],re[5],re[6],re[7]],[re[8],re[9],re[10],re[11]],[re[12],re[13],re[14],re[15]]]}(Pt)}(w,y.width,y.height),x=m.tidy(function(){var A=MQ(l),M=m.tensor2d(function(G,Q,nt){return Gz(nt,"inputResolution"),[1/nt.width*G[0][0]*Q.width,1/nt.height*G[0][1]*Q.width,G[0][3]*Q.width,1/nt.width*G[1][0]*Q.height,1/nt.height*G[1][1]*Q.height,G[1][3]*Q.height,0,0]}(T,y,u),[1,8]),$="nearest",V=m.image.transform(m.expandDims(m.cast(A,"float32")),M,"bilinear",$,0,[u.height,u.width]);return f!=null?function(G,Q){var nt=function(it,ht,kt,Nt){var $t=(Nt-kt)/255;return{scale:$t,offset:kt-0*$t}}(0,0,Q[0],Q[1]);return m.tidy(function(){return m.add(m.mul(G,nt.scale),nt.offset)})}(V,f):V});return{imageTensor:x,padding:C,transformationMatrix:T}}function Mb(l){return{xCenter:l.xMin+l.width/2,yCenter:l.yMin+l.height/2,width:l.width,height:l.height}}function yft(l){var i=l.relativeKeypoints;if(i.length<=1)throw new Error("2 or more keypoints required to calculate a rect.");var o=Number.MAX_VALUE,u=Number.MAX_VALUE,c=Number.MIN_VALUE,f=Number.MIN_VALUE;return i.forEach(function(y){o=Math.min(o,y.x),c=Math.max(c,y.x),u=Math.min(u,y.y),f=Math.max(f,y.y)}),{xCenter:(o+c)/2,yCenter:(u+f)/2,width:c-o,height:f-u}}function DQ(l,i,o,u,c){var f=o==="rect"?function(y,w,C){var T,x=y.locationData;return T=Mb(x.boundingBox),T}(l):function(y,w){var C=y.locationData;return w==="boundingbox"?Mb(C.relativeBoundingBox):yft(C)}(l,i);return c&&(f.rotation=function(y,w,C){var T,x=y.locationData,A=C.rotationVectorStartKeypointIndex,M=C.rotationVectorEndKeypointIndex;T=C.rotationVectorTargetAngle?C.rotationVectorTargetAngle:Math.PI*C.rotationVectorTargetAngleDegree/180;var $=x.relativeKeypoints[A].x*w.width,V=x.relativeKeypoints[A].y*w.height,G=x.relativeKeypoints[M].x*w.width,Q=x.relativeKeypoints[M].y*w.height;return NQ(T-Math.atan2(-(Q-V),G-$))}(l,u,c)),f}function vft(l,i,o){for(var u=0;u<i.length;++u){var c=i[u],f=o[l[u]];f.x=c.x,f.y=c.y}}function l4(l,i,o,u){if(typeof i=="string"){if(i==="copy")for(var c=0;c<o.length;++c)u[l[c]].z=o[c].z}else{var f=function(y,w){for(var C=0,T=0;T<w.length;++T)C+=y[w[T]].z;return C/w.length}(u,i);for(c=0;c<l.length;++c)u[l[c]].z=f}}function bft(l,i){for(var o=function(w){var C=[].concat.apply([],w.map(function($){return $.indexesMapping}));if(C.length===0)throw new Error("There should be at least one landmark in indexes mapping");var T=C[0],x=C[0],A=new Set(C);A.forEach(function($){T=Math.min(T,$),x=Math.max(x,$)});var M=A.size;if(T!==0)throw new Error("Indexes are expected to start with 0 instead of "+T);if(x+1!==M)throw new Error("Indexes should have no gaps but "+(x-M+1)+" indexes are missing");return M}(i),u=new Array(o).fill(null).map(Object),c=0;c<l.length;++c){var f=l[c],y=i[c];if(f.length!==y.indexesMapping.length)throw new Error("There are "+f.length+" refinement landmarks while mapping has "+y.indexesMapping.length);vft(y.indexesMapping,f,u),l4(y.indexesMapping,y.zRefinement,f,u)}return u}function wft(l,i){return l.map(function(o){var u=Np(Np({},o),{x:o.x*i.width,y:o.y*i.height});return o.z!=null&&(u.z=o.z*i.width),u})}function m6(l,i){return l==="none"?i:function(o){return 1/(1+Math.exp(-o))}(i)}function Db(l,i,o,u){return $m(this,void 0,void 0,function(){var c,f,y,w,C,T,x,A;return zm(this,function(M){switch(M.label){case 0:return o=o||i.flipHorizontally||!1,u=u||i.flipVertically||!1,c=l.size,f=c/i.numLandmarks,[4,l.data()];case 1:for(y=M.sent(),w=[],C=0;C<i.numLandmarks;++C)T=C*f,(A={x:0,y:0}).x=o?i.inputImageWidth-y[T]:y[T],f>1&&(A.y=u?i.inputImageHeight-y[T+1]:y[T+1]),f>2&&(A.z=y[T+2]),f>3&&(A.score=m6(i.visibilityActivation,y[T+3])),w.push(A);for(x=0;x<w.length;++x)(A=w[x]).x=A.x/i.inputImageWidth,A.y=A.y/i.inputImageHeight,A.z=A.z/i.inputImageWidth/(i.normalizeZ||1);return[2,w]}})})}function RQ(l,i,o){var u=l.width,c=l.height,f=l.rotation;if(o.rotation==null&&o.rotationDegree==null||(f=function(T,x){return x.rotation!=null?T+=x.rotation:x.rotationDegree!=null&&(T+=Math.PI*x.rotationDegree/180),NQ(T)}(f,o)),f===0)l.xCenter=l.xCenter+u*o.shiftX,l.yCenter=l.yCenter+c*o.shiftY;else{var y=(i.width*u*o.shiftX*Math.cos(f)-i.height*c*o.shiftY*Math.sin(f))/i.width,w=(i.width*u*o.shiftX*Math.sin(f)+i.height*c*o.shiftY*Math.cos(f))/i.height;l.xCenter=l.xCenter+y,l.yCenter=l.yCenter+w}{var C=Math.max(u*i.width,c*i.height);u=C/i.width,c=C/i.height}return l.width=u*o.scaleX,l.height=c*o.scaleY,l}(Nb||(Nb={})).MediaPipeFaceDetector="MediaPipeFaceDetector";var Bm,Hz={runtime:"tfjs",maxFaces:1,refineLandmarks:!1,landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/face_landmarks_detection/face_mesh/1"},Yz={flipHorizontal:!1,staticImageMode:!1},FQ={shiftX:0,shiftY:0,scaleX:1.5,scaleY:1.5},xft={outputTensorSize:{width:192,height:192},outputTensorFloatRange:[0,1]},YI={numLandmarks:468,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},qz={numLandmarks:80,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},Jl={numLandmarks:71,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},g6={numLandmarks:5,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},Rb={indexesMapping:Array.from(Array(468).keys()),zRefinement:"copy"},qI={indexesMapping:[61,146,91,181,84,17,314,405,321,375,291,185,40,39,37,0,267,269,270,409,78,95,88,178,87,14,317,402,318,324,308,191,80,81,82,13,312,311,310,415,76,77,90,180,85,16,315,404,320,307,306,184,74,73,72,11,302,303,304,408,62,96,89,179,86,15,316,403,319,325,292,183,42,41,38,12,268,271,272,407],zRefinement:"none"},OQ={indexesMapping:[33,7,163,144,145,153,154,155,133,246,161,160,159,158,157,173,130,25,110,24,23,22,26,112,243,247,30,29,27,28,56,190,226,31,228,229,230,231,232,233,244,113,225,224,223,222,221,189,35,124,46,53,52,65,143,111,117,118,119,120,121,128,245,156,70,63,105,66,107,55,193],zRefinement:"none"},LQ={indexesMapping:[263,249,390,373,374,380,381,382,362,466,388,387,386,385,384,398,359,255,339,254,253,252,256,341,463,467,260,259,257,258,286,414,446,261,448,449,450,451,452,453,464,342,445,444,443,442,441,413,265,353,276,283,282,295,372,340,346,347,348,349,350,357,465,383,300,293,334,296,336,285,417],zRefinement:"none"},kft={indexesMapping:[468,469,470,471,472],zRefinement:[33,7,163,144,145,153,154,155,133,246,161,160,159,158,157,173]},XI={indexesMapping:[473,474,475,476,477],zRefinement:[263,249,390,373,374,380,381,382,362,466,388,387,386,385,384,398]},Fb=function(){function l(i,o,u,c){this.detector=i,this.landmarkModel=o,this.maxFaces=u,this.withAttention=c,this.prevFaceRectsFromLandmarks=null}return l.prototype.estimateFaces=function(i,o){return $m(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M,$,V,G,Q=this;return zm(this,function(nt){switch(nt.label){case 0:return u=function(ht){if(ht==null)return Np({},Yz);var kt=Np({},ht);return kt.flipHorizontal==null&&(kt.flipHorizontal=Yz.flipHorizontal),kt.staticImageMode==null&&(kt.staticImageMode=Yz.staticImageMode),kt}(o),i==null?(this.reset(),[2,[]]):(c=IQ(i),f=m.tidy(function(){var ht=m.cast(MQ(i),"float32");return u.flipHorizontal&&(ht=m.squeeze(m.image.flipLeftRight(m.expandDims(ht,0)),[0])),ht}),y=this.prevFaceRectsFromLandmarks,u.staticImageMode||y==null||y.length<this.maxFaces?[4,this.detector.detectFaces(f,!1)]:[3,2]);case 1:return(C=nt.sent()).length===0?(this.reset(),f.dispose(),[2,[]]):(w=C.map(function(ht){return Q.faceDetectionFrontDetectionToRoi(ht,c)}),[3,3]);case 2:w=[],nt.label=3;case 3:return it=[],[w,y||[]].forEach(function(ht){return ht.forEach(function(kt){(it=it.filter(function(Nt){return function($t,Ut){var Pt=AQ($t),re=AQ(Ut);if(!function(De,ze){return!(De.xMax<ze.xMin||ze.xMax<De.xMin||De.yMax<ze.yMin||ze.yMax<De.yMin)}(Pt,re))return 0;var ue=HI(function(De,ze){var Qe=Math.max(De.xMin,ze.xMin),cn=Math.min(De.xMax,ze.xMax),en=Math.max(De.yMin,ze.yMin),sn=Math.min(De.yMax,ze.yMax);return{xMin:Qe,xMax:cn,yMin:en,yMax:sn,width:Math.max(cn-Qe,0),height:Math.max(sn-en,0)}}(Pt,re)),be=HI(Pt)+HI(re)-ue;return be>0?ue/be:0}(kt,Nt)<=.5})).push(kt)})}),T=it,[4,Promise.all(T.map(function(ht){return Q.faceLandmark(ht,f)}))];case 4:for(x=nt.sent(),A=[],this.prevFaceRectsFromLandmarks=[],M=0;M<x.length;++M)($=x[M])!=null&&(this.prevFaceRectsFromLandmarks.push(this.faceLandmarksToRoi($,c)),(V=wft($,c))!=null&&V.forEach(function(ht,kt){var Nt=bQ.get(kt);Nt!=null&&(ht.name=Nt)}),G=Oz(V),A.push({keypoints:V,box:G.locationData.relativeBoundingBox}));return f.dispose(),[2,A]}var it})})},l.prototype.dispose=function(){this.detector.dispose(),this.landmarkModel.dispose()},l.prototype.reset=function(){this.detector.reset(),this.prevFaceRectsFromLandmarks=null},l.prototype.faceDetectionFrontDetectionToRoi=function(i,o){return RQ(DQ(i,"boundingbox","normRect",o,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:0}),o,FQ)},l.prototype.faceLandmark=function(i,o){return $m(this,void 0,void 0,function(){var u,c,f,y,w,C,T;return zm(this,function(x){switch(x.label){case 0:return u=gft(o,xft,i).imageTensor,c=["output_faceflag"].concat(this.withAttention?["output_mesh_identity","output_lips","Identity_6:0","Identity_1:0","Identity_2:0","Identity_5:0"]:["output_mesh"]),f=this.landmarkModel.execute(u,c),y=f[0],w=f.slice(1),[4,y.data()];case 1:return x.sent()[0]<.5?(m.dispose(f),m.dispose(u),[2,null]):this.withAttention?[4,this.tensorsToFaceLandmarksWithAttention(w)]:[3,3];case 2:return C=x.sent(),[3,5];case 3:return[4,this.tensorsToFaceLandmarks(w)];case 4:C=x.sent(),x.label=5;case 5:return T=function(A,M,$){$===void 0&&($={ignoreRotation:!1});for(var V=[],G=0,Q=A;G<Q.length;G++){var nt=Q[G],it=nt.x-.5,ht=nt.y-.5,kt=$.ignoreRotation?0:M.rotation,Nt=Math.cos(kt)*it-Math.sin(kt)*ht,$t=Math.sin(kt)*it+Math.cos(kt)*ht;Nt=Nt*M.width+M.xCenter,$t=$t*M.height+M.yCenter;var Ut=nt.z*M.width,Pt=Np({},nt);Pt.x=Nt,Pt.y=$t,Pt.z=Ut,V.push(Pt)}return V}(C,i),m.dispose(f),m.dispose(u),[2,T]}})})},l.prototype.tensorsToFaceLandmarks=function(i){return $m(this,void 0,void 0,function(){return zm(this,function(o){return[2,Db(i[0],YI)]})})},l.prototype.tensorsToFaceLandmarksWithAttention=function(i){return $m(this,void 0,void 0,function(){var o,u,c,f,y,w;return zm(this,function(C){switch(C.label){case 0:return[4,Db(i[0],YI)];case 1:return o=C.sent(),[4,Db(i[1],qz)];case 2:return u=C.sent(),[4,Db(i[3],Jl)];case 3:return c=C.sent(),[4,Db(i[5],Jl)];case 4:return f=C.sent(),[4,Db(i[4],g6)];case 5:return y=C.sent(),[4,Db(i[2],g6)];case 6:return w=C.sent(),[2,bft([o,u,c,f,y,w],[Rb,qI,OQ,LQ,kft,XI])]}})})},l.prototype.faceLandmarksToRoi=function(i,o){return RQ(DQ(Oz(i),"boundingbox","normRect",o,{rotationVectorStartKeypointIndex:33,rotationVectorEndKeypointIndex:263,rotationVectorTargetAngleDegree:0}),o,FQ)},l}();function $Q(l){return $m(this,void 0,void 0,function(){var i,o,u,c;return zm(this,function(f){switch(f.label){case 0:return i=function(y){if(y==null)return Np({},Hz);var w=Np({},y);return w.runtime="tfjs",w.maxFaces==null&&(w.maxFaces=Hz.maxFaces),w.refineLandmarks==null&&(w.refineLandmarks=Hz.refineLandmarks),w.landmarkModelUrl==null&&(w.landmarkModelUrl=w.refineLandmarks?"https://tfhub.dev/mediapipe/tfjs-model/face_landmarks_detection/attention_mesh/1":"https://tfhub.dev/mediapipe/tfjs-model/face_landmarks_detection/face_mesh/1"),w}(l),o=typeof i.landmarkModelUrl=="string"&&i.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Vc(i.landmarkModelUrl,{fromTFHub:o})];case 1:return u=f.sent(),[4,TQ(Nb.MediaPipeFaceDetector,{modelType:"short",maxFaces:i.maxFaces,detectorModelUrl:i.detectorModelUrl,runtime:i.runtime})];case 2:return c=f.sent(),[2,new Fb(c,u,i.maxFaces,i.refineLandmarks)]}})})}(function(l){l.MediaPipeFaceMesh="MediaPipeFaceMesh"})(Bm||(Bm={}));var Xz=Object.freeze({__proto__:null,getKeypointIndexByContour:function(l){if(l===Bm.MediaPipeFaceMesh)return Pm;throw new Error("Model "+l+" is not supported.")},getAdjacentPairs:function(l){if(l===Bm.MediaPipeFaceMesh)return sft;throw new Error("Model "+l+" is not supported.")}});let KI=[[.499976992607117,.652534008026123],[.500025987625122,.547487020492554],[.499974012374878,.602371990680695],[.482113003730774,.471979022026062],[.500150978565216,.527155995368958],[.499909996986389,.498252987861633],[.499523013830185,.40106201171875],[.289712011814117,.380764007568359],[.499954998493195,.312398016452789],[.499987006187439,.269918978214264],[.500023007392883,.107050001621246],[.500023007392883,.666234016418457],[.5000159740448,.679224014282227],[.500023007392883,.692348003387451],[.499976992607117,.695277988910675],[.499976992607117,.70593398809433],[.499976992607117,.719385027885437],[.499976992607117,.737019002437592],[.499967992305756,.781370997428894],[.499816000461578,.562981009483337],[.473773002624512,.573909997940063],[.104906998574734,.254140973091125],[.365929991006851,.409575998783112],[.338757991790771,.41302502155304],[.311120003461838,.409460008144379],[.274657994508743,.389131009578705],[.393361985683441,.403706014156342],[.345234006643295,.344011008739471],[.370094001293182,.346076011657715],[.319321990013123,.347265005111694],[.297903001308441,.353591024875641],[.24779200553894,.410809993743896],[.396889001131058,.842755019664764],[.280097991228104,.375599980354309],[.106310002505779,.399955987930298],[.2099249958992,.391353011131287],[.355807989835739,.534406006336212],[.471751004457474,.65040397644043],[.474155008792877,.680191993713379],[.439785003662109,.657229006290436],[.414617002010345,.66654098033905],[.450374007225037,.680860996246338],[.428770989179611,.682690978050232],[.374971002340317,.727805018424988],[.486716985702515,.547628998756409],[.485300987958908,.527395009994507],[.257764995098114,.314490020275116],[.401223003864288,.455172002315521],[.429818987846375,.548614978790283],[.421351999044418,.533740997314453],[.276895999908447,.532056987285614],[.483370006084442,.499586999416351],[.33721199631691,.282882988452911],[.296391993761063,.293242990970612],[.169294998049736,.193813979625702],[.447580009698868,.302609980106354],[.392390012741089,.353887975215912],[.354490011930466,.696784019470215],[.067304998636246,.730105042457581],[.442739009857178,.572826027870178],[.457098007202148,.584792017936707],[.381974011659622,.694710969924927],[.392388999462128,.694203019142151],[.277076005935669,.271932005882263],[.422551989555359,.563233017921448],[.385919004678726,.281364023685455],[.383103013038635,.255840003490448],[.331431001424789,.119714021682739],[.229923993349075,.232002973556519],[.364500999450684,.189113974571228],[.229622006416321,.299540996551514],[.173287004232407,.278747975826263],[.472878992557526,.666198015213013],[.446828007698059,.668527007102966],[.422762006521225,.673889994621277],[.445307999849319,.580065965652466],[.388103008270264,.693961024284363],[.403039008378983,.706539988517761],[.403629004955292,.693953037261963],[.460041999816895,.557139039039612],[.431158006191254,.692366003990173],[.452181994915009,.692366003990173],[.475387006998062,.692366003990173],[.465828001499176,.779190003871918],[.472328990697861,.736225962638855],[.473087012767792,.717857003211975],[.473122000694275,.704625964164734],[.473033010959625,.695277988910675],[.427942007780075,.695277988910675],[.426479011774063,.703539967536926],[.423162013292313,.711845993995667],[.4183090031147,.720062971115112],[.390094995498657,.639572978019714],[.013953999616206,.560034036636353],[.499913990497589,.58014702796936],[.413199990987778,.69539999961853],[.409626007080078,.701822996139526],[.468080013990402,.601534962654114],[.422728985548019,.585985004901886],[.463079988956451,.593783974647522],[.37211999297142,.47341400384903],[.334562003612518,.496073007583618],[.411671012639999,.546965003013611],[.242175996303558,.14767599105835],[.290776997804642,.201445996761322],[.327338010072708,.256527006626129],[.399509996175766,.748921036720276],[.441727995872498,.261676013469696],[.429764986038208,.187834024429321],[.412198007106781,.108901023864746],[.288955003023148,.398952007293701],[.218936994671822,.435410976409912],[.41278201341629,.398970007896423],[.257135003805161,.355440020561218],[.427684992551804,.437960982322693],[.448339998722076,.536936044692993],[.178560003638268,.45755398273468],[.247308000922203,.457193970680237],[.286267012357712,.467674970626831],[.332827985286713,.460712015628815],[.368755996227264,.447206974029541],[.398963987827301,.432654976844788],[.476410001516342,.405806005001068],[.189241006970406,.523923993110657],[.228962004184723,.348950982093811],[.490725994110107,.562400996685028],[.404670000076294,.485132992267609],[.019469000399113,.401564002037048],[.426243007183075,.420431017875671],[.396993011236191,.548797011375427],[.266469985246658,.376977026462555],[.439121007919312,.51895797252655],[.032313998788595,.644356966018677],[.419054001569748,.387154996395111],[.462783008813858,.505746960639954],[.238978996872902,.779744982719421],[.198220998048782,.831938028335571],[.107550002634525,.540755033493042],[.183610007166862,.740257024765015],[.134409993886948,.333683013916016],[.385764002799988,.883153975009918],[.490967005491257,.579378008842468],[.382384985685349,.508572995662689],[.174399003386497,.397670984268188],[.318785011768341,.39623498916626],[.343364000320435,.400596976280212],[.396100014448166,.710216999053955],[.187885001301765,.588537991046906],[.430987000465393,.944064974784851],[.318993002176285,.898285031318665],[.266247987747192,.869701027870178],[.500023007392883,.190576016902924],[.499976992607117,.954452991485596],[.366169989109039,.398822009563446],[.393207013607025,.39553701877594],[.410373002290726,.391080021858215],[.194993004202843,.342101991176605],[.388664990663528,.362284004688263],[.365961998701096,.355970978736877],[.343364000320435,.355356991291046],[.318785011768341,.35834002494812],[.301414996385574,.363156020641327],[.058132998645306,.319076001644135],[.301414996385574,.387449026107788],[.499987989664078,.618434011936188],[.415838003158569,.624195992946625],[.445681989192963,.566076993942261],[.465844005346298,.620640993118286],[.49992299079895,.351523995399475],[.288718998432159,.819945991039276],[.335278987884521,.852819979190826],[.440512001514435,.902418971061707],[.128294005990028,.791940987110138],[.408771991729736,.373893976211548],[.455606997013092,.451801002025604],[.499877005815506,.908990025520325],[.375436991453171,.924192011356354],[.11421000212431,.615022003650665],[.448662012815475,.695277988910675],[.4480200111866,.704632043838501],[.447111994028091,.715808033943176],[.444831997156143,.730794012546539],[.430011987686157,.766808986663818],[.406787008047104,.685672998428345],[.400738000869751,.681069016456604],[.392399996519089,.677703022956848],[.367855995893478,.663918972015381],[.247923001646996,.601333022117615],[.452769994735718,.420849978923798],[.43639200925827,.359887003898621],[.416164010763168,.368713974952698],[.413385987281799,.692366003990173],[.228018000721931,.683571994304657],[.468268007040024,.352671027183533],[.411361992359161,.804327011108398],[.499989002943039,.469825029373169],[.479153990745544,.442654013633728],[.499974012374878,.439637005329132],[.432112008333206,.493588984012604],[.499886006116867,.866917014122009],[.49991300702095,.821729004383087],[.456548988819122,.819200992584229],[.344549000263214,.745438992977142],[.37890899181366,.574010014533997],[.374292999505997,.780184984207153],[.319687992334366,.570737957954407],[.357154995203018,.604269981384277],[.295284003019333,.621580958366394],[.447750002145767,.862477004528046],[.410986006259918,.508723020553589],[.31395098567009,.775308012962341],[.354128003120422,.812552988529205],[.324548006057739,.703992962837219],[.189096003770828,.646299958229065],[.279776990413666,.71465802192688],[.1338230073452,.682700991630554],[.336768001317978,.644733011722565],[.429883986711502,.466521978378296],[.455527991056442,.548622965812683],[.437114000320435,.558896005153656],[.467287987470627,.529924988746643],[.414712011814117,.335219979286194],[.37704598903656,.322777986526489],[.344107985496521,.320150971412659],[.312875986099243,.32233202457428],[.283526003360748,.333190023899078],[.241245999932289,.382785975933075],[.102986000478268,.468762993812561],[.267612010240555,.424560010433197],[.297879010438919,.433175981044769],[.333433985710144,.433878004550934],[.366427004337311,.426115989685059],[.396012008190155,.416696012020111],[.420121014118195,.41022801399231],[.007561000064015,.480777025222778],[.432949006557465,.569517970085144],[.458638995885849,.479089021682739],[.473466008901596,.545744001865387],[.476087987422943,.563830018043518],[.468472003936768,.555056989192963],[.433990985155106,.582361996173859],[.483518004417419,.562983989715576],[.482482999563217,.57784903049469],[.42645001411438,.389798998832703],[.438998997211456,.39649498462677],[.450067013502121,.400434017181396],[.289712011814117,.368252992630005],[.276670008897781,.363372981548309],[.517862021923065,.471948027610779],[.710287988185883,.380764007568359],[.526226997375488,.573909997940063],[.895093023777008,.254140973091125],[.634069979190826,.409575998783112],[.661242008209229,.41302502155304],[.688880026340485,.409460008144379],[.725341975688934,.389131009578705],[.606630027294159,.40370500087738],[.654766023159027,.344011008739471],[.629905998706818,.346076011657715],[.680678009986877,.347265005111694],[.702096998691559,.353591024875641],[.75221198797226,.410804986953735],[.602918028831482,.842862963676453],[.719901978969574,.375599980354309],[.893692970275879,.399959981441498],[.790081977844238,.391354024410248],[.643998026847839,.534487962722778],[.528249025344849,.65040397644043],[.525849997997284,.680191040039062],[.560214996337891,.657229006290436],[.585384011268616,.66654098033905],[.549625992774963,.680860996246338],[.57122802734375,.682691991329193],[.624852001667023,.72809898853302],[.513050019741058,.547281980514526],[.51509702205658,.527251958847046],[.742246985435486,.314507007598877],[.598631024360657,.454979002475739],[.570338010787964,.548575043678284],[.578631997108459,.533622980117798],[.723087012767792,.532054007053375],[.516445994377136,.499638974666595],[.662801027297974,.282917976379395],[.70362401008606,.293271005153656],[.830704987049103,.193813979625702],[.552385985851288,.302568018436432],[.607609987258911,.353887975215912],[.645429015159607,.696707010269165],[.932694971561432,.730105042457581],[.557260990142822,.572826027870178],[.542901992797852,.584792017936707],[.6180260181427,.694710969924927],[.607590973377228,.694203019142151],[.722943007946014,.271963000297546],[.577413976192474,.563166975975037],[.614082992076874,.281386971473694],[.616907000541687,.255886018276215],[.668509006500244,.119913995265961],[.770092010498047,.232020974159241],[.635536015033722,.189248979091644],[.77039098739624,.299556016921997],[.826722025871277,.278755009174347],[.527121007442474,.666198015213013],[.553171992301941,.668527007102966],[.577238023281097,.673889994621277],[.554691970348358,.580065965652466],[.611896991729736,.693961024284363],[.59696102142334,.706539988517761],[.596370995044708,.693953037261963],[.539958000183105,.557139039039612],[.568841993808746,.692366003990173],[.547818005084991,.692366003990173],[.52461302280426,.692366003990173],[.534089982509613,.779141008853912],[.527670979499817,.736225962638855],[.526912987232208,.717857003211975],[.526877999305725,.704625964164734],[.526966989040375,.695277988910675],[.572058022022247,.695277988910675],[.573521018028259,.703539967536926],[.57683801651001,.711845993995667],[.581691026687622,.720062971115112],[.609944999217987,.639909982681274],[.986046016216278,.560034036636353],[.5867999792099,.69539999961853],[.590372025966644,.701822996139526],[.531915009021759,.601536989212036],[.577268004417419,.585934996604919],[.536915004253387,.593786001205444],[.627542972564697,.473352015018463],[.665585994720459,.495950996875763],[.588353991508484,.546862006187439],[.757824003696442,.14767599105835],[.709249973297119,.201507985591888],[.672684013843536,.256581008434296],[.600408971309662,.74900496006012],[.55826598405838,.261672019958496],[.570303976535797,.187870979309082],[.588165998458862,.109044015407562],[.711045026779175,.398952007293701],[.781069993972778,.435405015945435],[.587247014045715,.398931980133057],[.742869973182678,.355445981025696],[.572156012058258,.437651991844177],[.55186802148819,.536570012569427],[.821442008018494,.457556009292603],[.752701997756958,.457181990146637],[.71375697851181,.467626988887787],[.66711300611496,.460672974586487],[.631101012229919,.447153985500336],[.6008620262146,.432473003864288],[.523481011390686,.405627012252808],[.810747981071472,.523926019668579],[.771045982837677,.348959028720856],[.509127020835876,.562718033790588],[.595292985439301,.485023975372314],[.980530977249146,.401564002037048],[.573499977588654,.420000016689301],[.602994978427887,.548687994480133],[.733529984951019,.376977026462555],[.560611009597778,.519016981124878],[.967685997486115,.644356966018677],[.580985009670258,.387160003185272],[.537728011608124,.505385041236877],[.760966002941132,.779752969741821],[.801778972148895,.831938028335571],[.892440974712372,.54076099395752],[.816350996494293,.740260004997253],[.865594983100891,.333687007427216],[.614073991775513,.883246004581451],[.508952975273132,.579437971115112],[.617941975593567,.508316040039062],[.825608015060425,.397674977779388],[.681214988231659,.39623498916626],[.656635999679565,.400596976280212],[.603900015354156,.710216999053955],[.81208598613739,.588539004325867],[.56801301240921,.944564998149872],[.681007981300354,.898285031318665],[.733752012252808,.869701027870178],[.633830010890961,.398822009563446],[.606792986392975,.39553701877594],[.589659988880157,.391062021255493],[.805015981197357,.342108011245728],[.611334979534149,.362284004688263],[.634037971496582,.355970978736877],[.656635999679565,.355356991291046],[.681214988231659,.35834002494812],[.698584973812103,.363156020641327],[.941866993904114,.319076001644135],[.698584973812103,.387449026107788],[.584177017211914,.624107003211975],[.554318010807037,.566076993942261],[.534153997898102,.62064003944397],[.711217999458313,.819975018501282],[.664629995822906,.852871000766754],[.559099972248077,.902631998062134],[.871706008911133,.791940987110138],[.591234028339386,.373893976211548],[.544341027736664,.451583981513977],[.624562978744507,.924192011356354],[.88577002286911,.615028977394104],[.551338016986847,.695277988910675],[.551980018615723,.704632043838501],[.552887976169586,.715808033943176],[.555167973041534,.730794012546539],[.569944024085999,.767035007476807],[.593203008174896,.685675978660583],[.599261999130249,.681069016456604],[.607599973678589,.677703022956848],[.631937980651855,.663500010967255],[.752032995223999,.601315021514893],[.547226011753082,.420395016670227],[.563543975353241,.359827995300293],[.583841025829315,.368713974952698],[.586614012718201,.692366003990173],[.771915018558502,.683578014373779],[.531597018241882,.352482974529266],[.588370978832245,.804440975189209],[.52079701423645,.442565023899078],[.567984998226166,.493479013442993],[.543282985687256,.819254994392395],[.655317008495331,.745514988899231],[.621008992195129,.574018001556396],[.625559985637665,.78031200170517],[.680198013782501,.570719003677368],[.64276397228241,.604337990283966],[.704662978649139,.621529996395111],[.552012026309967,.862591981887817],[.589071989059448,.508637011051178],[.685944974422455,.775357007980347],[.645735025405884,.812640011310577],[.675342977046967,.703978002071381],[.810858011245728,.646304965019226],[.72012197971344,.714666962623596],[.866151988506317,.682704985141754],[.663187026977539,.644596993923187],[.570082008838654,.466325998306274],[.544561982154846,.548375964164734],[.562758982181549,.558784961700439],[.531987011432648,.530140042304993],[.585271000862122,.335177004337311],[.622952997684479,.32277899980545],[.655896008014679,.320163011550903],[.687132000923157,.322345972061157],[.716481983661652,.333200991153717],[.758756995201111,.382786989212036],[.897013008594513,.468769013881683],[.732392013072968,.424547016620636],[.70211398601532,.433162987232208],[.66652500629425,.433866024017334],[.633504986763,.426087975502014],[.603875994682312,.416586995124817],[.579657971858978,.409945011138916],[.992439985275269,.480777025222778],[.567192018032074,.569419980049133],[.54136598110199,.478899002075195],[.526564002037048,.546118021011353],[.523913025856018,.563830018043518],[.531529009342194,.555056989192963],[.566035985946655,.582329034805298],[.51631098985672,.563053965568542],[.5174720287323,.577877044677734],[.573594987392426,.389806985855103],[.560697972774506,.395331978797913],[.549755990505219,.399751007556915],[.710287988185883,.368252992630005],[.723330020904541,.363372981548309]],Ob={runtime:{type:"enum",enums:["mediapipe","tfjs"],default:"tfjs"},maxFaces:{type:"number",min:1,default:1},refineLandmarks:{type:"boolean",default:!1},solutionPath:{type:"string",default:"https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh",ignore:l=>l.runtime!=="mediapipe"},detectorModelUrl:{type:"string",default:void 0,ignore:l=>l.runtime!=="tfjs"},landmarkModelUrl:{type:"string",default:void 0,ignore:l=>l.runtime!=="tfjs"}},zQ={flipHorizontal:{type:"boolean",alias:"flipped",default:!1}};class PQ{constructor(i,o,u){this.modelName=Lm(i,["FaceMesh"],"FaceMesh","faceMesh"),this.model=null,this.userOptions=o,this.runtimeConfig={},this.detectMedia=null,this.detectCallback=null,this.detecting=!1,this.signalStop=!1,this.prevCall="",this.ready=Ws(this.loadModel(),u)}loadModel(){return ce(this,null,function*(){let i=Bm.MediaPipeFaceMesh,o=Ip(this.userOptions,Ob,"faceMesh");return this.runtimeConfig=Ip(this.userOptions,zQ,"faceMesh"),yield m.ready(),this.model=yield function(u,c){return $m(this,void 0,void 0,function(){var f,y;return zm(this,function(w){if(u===Bm.MediaPipeFaceMesh){if(y=void 0,(f=c)!=null){if(f.runtime==="tfjs")return[2,$Q(f)];if(f.runtime==="mediapipe")return[2,lft(f)];y=f.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+y)}throw new Error(u+" is not a supported model name.")})})}(i,o),this})}detect(...i){return ce(this,null,function*(){let o=Uu(...i);o.require("image","An html or p5.js image, video, or canvas element argument is required for detect().");let{image:u,callback:c}=o;yield E0(u,!1);let f=yield this.model.estimateFaces(u,this.runtimeConfig);return f=this.addKeypoints(f),typeof c=="function"&&c(f),f})}detectStart(...i){let o=Uu(...i);o.require("image","An html or p5.js image, video, or canvas element argument is required for detectStart()."),o.require("callback","A callback function argument is required for detectStart()."),this.detectMedia=o.image,this.detectCallback=o.callback,this.signalStop=!1,this.detecting||(this.detecting=!0,this.detectLoop()),this.prevCall==="start"&&console.warn("detectStart() was called more than once without calling detectStop(). The lastest detectStart() call will be used and the previous calls will be  ignored."),this.prevCall="start"}detectStop(){this.detecting&&(this.signalStop=!0),this.prevCall="stop"}detectLoop(){return ce(this,null,function*(){for(yield E0(this.detectMedia,!1);!this.signalStop;){let i=yield this.model.estimateFaces(this.detectMedia,this.runtimeConfig);i=this.addKeypoints(i),this.detectCallback(i),yield m.nextFrame()}this.detecting=!1,this.signalStop=!1})}addKeypoints(i){let o=Xz.getKeypointIndexByContour(Bm.MediaPipeFaceMesh);o.lips[20]!==291&&o.lips.splice(20,0,291);for(let u of i){u.keypoints[291].name="lips";for(let c in o){for(let f of o[c]){if(f>=u.keypoints.length)continue;u[c]===void 0&&(u[c]={keypoints:[]});let y=u.keypoints[f];u[c].keypoints.push({x:y.x,y:y.y,z:y.z}),u[c].xMin=u[c].xMin===void 0||y.x<u[c].xMin?y.x:u[c].xMin,u[c].xMax=u[c].xMax===void 0||y.x>u[c].xMax?y.x:u[c].xMax,u[c].yMin=u[c].yMin===void 0||y.y<u[c].yMin?y.y:u[c].yMin,u[c].yMax=u[c].yMax===void 0||y.y>u[c].yMax?y.y:u[c].yMax}u[c]&&(u[c].x=u[c].xMin,u[c].y=u[c].yMin,u[c].width=u[c].xMax-u[c].xMin,u[c].height=u[c].yMax-u[c].yMin,u[c].centerX=u[c].x+u[c].width/2,u[c].centerY=u[c].y+u[c].height/2,delete u[c].xMin,delete u[c].xMax,delete u[c].yMin,delete u[c].yMax)}}return i}getTriangles(){let i=Xz.getAdjacentPairs(Bm.MediaPipeFaceMesh),o=[];for(let u=0;u<i.length;u+=3){let c=[i[u][0],i[u+1][0],i[u+2][0]];o.push(c)}return o}getConnections(){return Xz.getAdjacentPairs(Bm.MediaPipeFaceMesh)}getUVCoords(){return KI}}let Sft=(...l)=>{let{string:i,options:o={},callback:u}=Uu(...l);return new PQ(i,o,u)};var _ft=F(3242);let Gd=(0,m.env)();Gd.registerFlag("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE",()=>15),Gd.registerFlag("WEBGPU_CPU_FORWARD",()=>!0),Gd.registerFlag("WEBGPU_MATMUL_PROGRAM_TYPE",()=>-1),Gd.registerFlag("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE",()=>!0),Gd.registerFlag("WEBGPU_USE_LOW_POWER_GPU",()=>!1),Gd.registerFlag("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e3),Gd.registerFlag("WEBGPU_USE_PROFILE_TOOL",()=>!1),Gd.registerFlag("WEBGPU_IMPORT_EXTERNAL_TEXTURE",()=>!0),Gd.registerFlag("WEBGPU_USE_NAIVE_CONV2D_DEBUG",()=>!1),Gd.registerFlag("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL",()=>-1),Gd.registerFlag("WEBGPU_CONV_SEPARATE_IM2COL_SHADER",()=>!1),Gd.registerFlag("WEBGPU_PRINT_SHADER",()=>""),Gd.registerFlag("WEBGPU_ENGINE_COMPILE_ONLY",()=>!1);class Cft{constructor(i){i&&(this.vendor=i.vendor,this.architecture=i.architecture,this.intelGPUGeneration=this.getIntelGPUGeneration())}getIntelGPUGeneration(){if(this.isIntel()){if(this.architecture.startsWith("gen"))return Number(this.architecture.match(/\d+/));if(this.architecture.startsWith("xe"))return 12}return 0}isIntel(){return this.vendor==="intel"}}class Eft{constructor(i){this.device=i,this.numUsedBuffers=0,this.numFreeBuffers=0,this.freeBuffers=new Map,this.usedBuffers=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}acquireBuffer(i,o,u=!1,c=!0){let f,y=BQ(i,o);return c?(this.freeBuffers.has(y)||this.freeBuffers.set(y,[]),this.freeBuffers.get(y).length>0?(f=this.freeBuffers.get(y).pop(),this.numFreeBuffers--):(f=this.device.createBuffer({size:i,usage:o,mappedAtCreation:u}),this.numBytesAllocated+=i)):(f=this.device.createBuffer({size:i,usage:o,mappedAtCreation:u}),this.numBytesAllocated+=i),this.usedBuffers.has(y)||this.usedBuffers.set(y,[]),this.usedBuffers.get(y).push(f),this.numUsedBuffers++,this.numBytesUsed+=i,f}releaseBuffer(i,o=!0){if(this.freeBuffers.size===0)return;let u=i.size,c=BQ(u,i.usage),f=this.usedBuffers.get(c),y=f.indexOf(i);if(y<0)throw new Error("Cannot find the buffer in buffer manager");f[y]=f[f.length-1],f.pop(),this.numUsedBuffers--,this.numBytesUsed-=u,o?(this.freeBuffers.get(c).push(i),this.numFreeBuffers++):(i.destroy(),this.numBytesAllocated-=u)}getNumUsedBuffers(){return this.numUsedBuffers}getNumFreeBuffers(){return this.numFreeBuffers}dispose(){this.freeBuffers.forEach((i,o)=>{i.forEach(u=>{u.destroy()})}),this.usedBuffers.forEach((i,o)=>{i.forEach(u=>{u.destroy()})}),this.freeBuffers=new Map,this.usedBuffers=new Map,this.numUsedBuffers=0,this.numFreeBuffers=0,this.numBytesUsed=0,this.numBytesAllocated=0}}function BQ(l,i){return`${l}_${i}`}class Tft{constructor(i){this.device=i,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures=new Map,this.usedTextures=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}acquireTexture(i,o,u,c){let f=i*o*Kz(u),y=jQ(i,o,u,c);if(this.freeTextures.has(y)||this.freeTextures.set(y,[]),this.usedTextures.has(y)||this.usedTextures.set(y,[]),this.numBytesUsed+=f,this.numUsedTextures++,this.freeTextures.get(y).length>0){this.numFreeTextures--;let C=this.freeTextures.get(y).shift();return this.usedTextures.get(y).push(C),C}this.numBytesAllocated+=f;let w=this.device.createTexture({size:[i,o],format:u,usage:c});return this.usedTextures.get(y).push(w),w}releaseTexture(i){if(this.freeTextures.size===0)return;let o=i.width,u=i.height,c=i.format,f=jQ(o,u,c,i.usage);this.freeTextures.has(f)||this.freeTextures.set(f,[]),this.freeTextures.get(f).push(i),this.numFreeTextures++,this.numUsedTextures--;let y=this.usedTextures.get(f),w=y.indexOf(i);if(w<0)throw new Error("Cannot release a texture that was never provided by this texture manager");y.splice(w,1);let C=o*u*Kz(c);this.numBytesUsed-=C}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){this.freeTextures.forEach((i,o)=>{i.forEach(u=>{u.destroy()})}),this.usedTextures.forEach((i,o)=>{i.forEach(u=>{u.destroy()})}),this.freeTextures=new Map,this.usedTextures=new Map,this.numUsedTextures=0,this.numFreeTextures=0,this.numBytesUsed=0,this.numBytesAllocated=0}}function jQ(l,i,o,u){return`${l}_${i}_${o}_${u}`}function Kz(l){if(l==="rgba8unorm")return 16;throw new Error(`${l} is not supported!`)}function Zz(l,i){if(Math.max(...l)>5)throw new Error("Cannot symbolically compute strides for rank > 6 tensor.");let o=l.length,u=l.map(f=>`${i}.${"xyzwuv"[f]}`),c=new Array(o-1);c[o-2]=u[o-1];for(let f=o-3;f>=0;--f)c[f]=`(${c[f+1]} * ${u[f+1]})`;return c}let o1=(l,i,o)=>o==="int32"?`atomicAdd(${l}, bitcast<i32>(${i}));`:`
          {
            var oldValue = 0;
            loop {
              let newValueF32 = bitcast<f32>(oldValue) + (${i});
              let newValue = bitcast<i32>(newValueF32);
              let res = atomicCompareExchangeWeak(${l}, oldValue, newValue);
              if res.exchanged {
                break;
              }
              oldValue = res.old_value;
            }
          }`;var Lb,ZI;(ZI=Lb||(Lb={}))[ZI.FROM_PIXELS=0]="FROM_PIXELS",ZI[ZI.DRAW=1]="DRAW";let Aft=(l,i,o,u,c)=>{let f=function(C,T,x){let A=[],M=x.workgroupSize[0]*x.workgroupSize[1]*x.workgroupSize[2];if(x.outputComponent=x.outputComponent?x.outputComponent:1,A.push(`

      var<private> localId: vec3<u32>;
      var<private> localIndex: u32;
      var<private> globalId: vec3<u32>;
      var<private> numWorkgroups: vec3<u32>;
      var<private> workgroupId: vec3<u32>;

      // Only used when the y/z dimension of workgroup size is 1.
      fn getGlobalIndex() -> i32 {
        ${Tf(x)?"  return i32(globalId.x);":`  return i32((workgroupId.z * numWorkgroups.x * numWorkgroups.y +
                workgroupId.y * numWorkgroups.x + workgroupId.x) * ${M}u +
                localIndex);
        `}
      }
    `),x.pixelsOpType!=null){let $t=x.pixelsOpType===Lb.FROM_PIXELS?`@group(0) @binding(0) var<storage, read_write> result: array<${vl(T.dtype,x.outputComponent)}>;`:`@group(0) @binding(1) var<storage, read> inBuf : array<${vl(C[0].dtype,x.outputComponent)}>;`,Ut=T.shape.length===3?"vec2<i32>":"i32";A.push(`
        struct Uniform {
          outShapeStrides : ${Ut},
          size            : i32,
          numChannels     : i32,
          alpha           : f32,
        };

        ${$t}
        @group(0) @binding(2) var<uniform> uniforms: Uniform;
      `);let Pt=I0(x);return[Eh,A.join(`
`),Xc(T.shape),x.getUserCode(),UQ(Pt,x)].join(`
`)}let $,V,G="struct Uniforms { NAN : f32, INFINITY : f32, ";x.variableNames.forEach(($t,Ut)=>{let Pt=ol(C[Ut].shape.length);G+=`${$t.charAt(0).toLowerCase()+$t.slice(1)}Shape : ${Pt}, `,$=C[Ut].shape.length-1,V=ol($),G+=`${$t.charAt(0).toLowerCase()+$t.slice(1)}ShapeStrides: ${V}, `});let Q=ol(T.shape.length);G+=`outShape : ${Q}, `,$=T.shape.length-1,V=ol($),G+=`
         outShapeStrides: ${V}, `,x.size&&(G+="size : i32, "),x.uniforms&&(G+=x.uniforms),G+="};",G=function($t){let Ut=/(\w+)\s*:\s*vec(5|6)/g;$t=$t.replace(Ut,re=>"@align(16) "+re);let Pt=/vec(5|6)\s*,\s*(\w+)/g;return $t=$t.replace(Pt,(re,ue,be)=>`vec${ue}, @align(16) ${be}`)}(G),A.push(G),x.atomic?A.push(`
      @group(0) @binding(0) var<storage, read_write> result: array<atomic<i32>>;
    `):A.push(`
      @group(0) @binding(0) var<storage, read_write> result: array<${vl(T.dtype,x.outputComponent)}>;
    `),x.variableNames.forEach(($t,Ut)=>{A.push(`
      @group(0) @binding(${1+Ut}) var<storage, read> ${$t}: array<${x.variableComponents?vl(C[Ut].dtype,x.variableComponents[Ut]):vl(C[Ut].dtype,x.outputComponent)}>;
        `)}),G!==""&&A.push(`
      @group(0) @binding(${1+x.variableNames.length}) var<uniform> uniforms: Uniforms;
      `);let nt=function($t,Ut){let{x:Pt,y:re=[],z:ue=[]}=Ut,be=$t.length,De=Pt.length+re.length+ue.length;if(De!==be)return"";if(Pt.length===be)return`fn getOutputCoords() -> ${ol(be)}{
    let globalIndex = getGlobalIndex();
    return getCoordsFromIndex(globalIndex);
  }
  `;let ze="",Qe=[Pt,re,ue];for(let xn=0;xn<Qe.length;xn++){let Rn=Qe[xn];if(Rn.length!==0)if(Rn.length===1)ze+=`let d${Rn[0]} = i32(globalId[${xn}]);`;else{let Bn=Zz(Rn,"uniforms.outShape");ze+=`var index${xn} = i32(globalId[${xn}]);`;for(let Fn=0;Fn<Bn.length;Fn++)ze+=`let d${Rn[Fn]} = index${xn} / ${Bn[Fn]};`,Fn===Bn.length-1?ze+=`let d${Rn[Fn+1]} = index${xn} - d${Rn[Fn]} * ${Bn[Fn]};`:ze+=`index${xn} = index${xn} - d${Rn[Fn]} * ${Bn[Fn]};`}}let cn=[];for(let xn=0;xn<De;xn++)cn.push(`d${xn}`);let en=ol(De),sn=`fn getOutputCoords() -> ${en} {
  ${ze}
`;return cn.length===0?sn+=`return ${en}(0); }`:sn+=`return ${en}(${cn.join(",")}); }`,sn}(T.shape,x.dispatchLayout),it=[Eh,A.join(`
`)+Mp,Xc(T.shape),nt,Kc(T.shape.length)];x.atomic||it.push(function($t,Ut,Pt){let re=$t.length,ue=vl(Ut,Pt),be=`fn setOutputAtIndex(flatIndex : i32, value : ${ro(Pt)}) {
      result[flatIndex] = ${ue}(value);
    }

    fn setOutputAtIndexI32(flatIndex : i32, value : ${ro(Pt,"i32")}) {
      result[flatIndex] = ${ue}(value);
    }
    `;if(re>=2){let De=["d0","d1","d2","d3","d4","d5"].slice(0,re),ze=ol(re);be+=`
      fn setOutputAtCoords(${De.map(Qe=>`${Qe} : i32`).join(", ")}, value : ${ro(Pt)}) {
        let flatIndex = getOutputIndexFromCoords(${ze}(${De.join(", ")}));
        setOutputAtIndex(flatIndex${Pt===1?"":` / ${Pt}`}, value);
      }
      fn setOutputAtCoordsI32(${De.map(Qe=>`${Qe} : i32`).join(", ")}, value : ${ro(Pt,"i32")}) {
        let flatIndex = getOutputIndexFromCoords(${ze}(${De.join(", ")}));
        setOutputAtIndexI32(flatIndex${Pt===1?"":` / ${Pt}`}, value);
      }
    `}return be}(T.shape,T.dtype,x.outputComponent)),x.variableNames.forEach(($t,Ut)=>{it.push(`${Xc(C[Ut].shape,$t)}`)});let ht=C.map(($t,Ut)=>function(Pt,re,ue,be){let De=function(Qe,cn){let en=Qe.name,sn=Qe.shape.length,xn=ol(sn),Rn="get"+en.charAt(0).toUpperCase()+en.slice(1),Bn=["d0","d1","d2","d3","d4","d5"].slice(0,sn),Fn=Bn.map(kr=>`${kr} : i32`).join(", ");if(sn<1)return`
      fn ${Rn}() -> ${ro(cn)} {
        return ${ro(cn)}(${en}[0]);
      }
    `;let Xn=`uniforms.${en.charAt(0).toLowerCase()+en.slice(1)}Shape`,Nn=`${sn}D`;return sn===0&&(Nn="1D"),`
    fn ${Rn}(${Fn}) -> ${ro(cn)} {
      return ${ro(cn)}(${en}[getIndexFromCoords${Nn}(${xn}(${Bn.join(",")}),
        ${Xn})${cn===1?"":` / ${cn}`}]);
    }
   `}(Pt,ue);return Pt.shape.length<=re.length&&(De+=function(Qe,cn,en,sn){let xn=Qe.name,Rn=xn.charAt(0).toUpperCase()+xn.slice(1),Bn="get"+Rn+"ByOutput",Fn=Qe.shape.length,Xn=cn.length,Nn=ol(Xn);if(m.util.arraysEqual(Qe.shape,cn)&&sn)return`
    fn ${Bn}Index(globalIndex : i32) -> ${ro(en)} {
      return ${ro(en)}(${xn}[globalIndex]);
    }

    fn ${Bn}Coords(coords : ${Nn}) -> ${ro(en)} {
      return ${ro(en)}(${xn}[${Xn>1?"getOutputIndexFromCoords(coords)":"coords"}${en===1?"":` / ${en}`}]);
    }
    `;let kr=m.backend_util.getBroadcastDims(Qe.shape,cn),Tr=Xn-Fn,Ar="";if(Fn===0)return`
    fn ${Bn}Index(globalIndex : i32) -> ${ro(en)}{
      return get${Rn}();
    }

    fn ${Bn}Coords(coords : ${Nn}) -> ${ro(en)}{
      return get${Rn}();
    }
  `;Ar=Xn<2&&kr.length>=1?"coords = 0;":kr.map(Yi=>`coords.${s1(Yi+Tr)} = 0;`).join(`
`);let Dr="";if(Xn<2&&Fn>0)Dr="coords";else if(Xn>1){let Yi=ol(Fn),Hr=Qe.shape.map((wa,Oa)=>`coords.${s1(Oa+Tr)}`).join(", ");Dr=`${Yi}(${Hr})`}else Dr="coords";let Ni=`uniforms.${xn.charAt(0).toLowerCase()+xn.slice(1)}Shape`,Mi=`${Fn}D`;return`
  fn ${Bn}Index(globalIndex : i32) -> ${ro(en)} {
    var coords = getCoordsFromIndex(globalIndex);
    ${Ar}
    return ${ro(en)}(${xn}[getIndexFromCoords${Mi}(${Dr}, ${Ni})${en===1?"":` / ${en}`}]);
  }

  fn ${Bn}Coords(coordsIn : ${Nn}) -> ${ro(en)} {
    var coords = coordsIn;
    ${Ar}
    return ${ro(en)}(${xn}[getIndexFromCoords${Mi}(${Dr}, ${Ni})${en===1?"":` / ${en}`}]);
  }
`}(Pt,re,ue,be)),De}($t,T.shape,x.variableComponents?x.variableComponents[Ut]:x.outputComponent,x.dispatchLayout.x.length===T.shape.length)).join(`
`);it.push(ht),it.push(x.getUserCode());let kt=I0(x);return it.push(UQ(kt,x)),it.join(`
`)}(o,{dtype:u.dtype,shape:u.shape},i),y=l.createShaderModule({code:f,label:i.constructor.name}),w=(0,m.env)().get("WEBGPU_PRINT_SHADER");if(w!==""){w=w.toLowerCase();let C=w.split(",");(w==="all"||C.some(T=>i.shaderKey.toLowerCase().includes(T)))&&(console.group(i.shaderKey),console.debug(f),console.groupEnd())}return c?l.createComputePipelineAsync({compute:{module:y,entryPoint:"_start"},label:i.constructor.name,layout:"auto"}):l.createComputePipeline({compute:{module:y,entryPoint:"_start"},label:i.constructor.name,layout:"auto"})},ro=(l,i="f32")=>{switch(l){case 1:return`${i}`;case 2:return`vec2<${i}>`;case 3:return`vec3<${i}>`;case 4:return`vec4<${i}>`;default:throw new Error(`${l}-component ${i} is not supported.`)}};function ol(l){if(l<=1)return"i32";if(l===2)return"vec2<i32>";if(l===3)return"vec3<i32>";if(l===4)return"vec4<i32>";if(l===5)return"vec5";if(l===6)return"vec6";throw Error(`GPU for rank ${l} is not yet supported`)}function s1(l){if(l===0)return"x";if(l===1)return"y";if(l===2)return"z";if(l===3)return"w";if(l===4)return"u";if(l===5)return"v";throw Error(`Index ${l} is not yet supported`)}function Gr(...l){let i;switch(l.length){case 0:i=`
        fn main()
      `;break;case 1:i=`
        fn main(${l[0]} : i32)
      `;break;default:throw Error("Unreachable")}return i}function UQ(l,i){let o;return o=`
     ${function(u){return`
  @compute @workgroup_size(${u.workgroupSize[0]}, ${u.workgroupSize[1]}, ${u.workgroupSize[2]})
`}(i)}
      fn _start(@builtin(local_invocation_id) LocalId : vec3<u32>,
                @builtin(global_invocation_id) GlobalId : vec3<u32>,
                @builtin(local_invocation_index) LocalIndex: u32,
                @builtin(workgroup_id) WorkgroupId : vec3<u32>,
                @builtin(num_workgroups) NumWorkgroups : vec3<u32>) {
        localId = LocalId;
        localIndex = LocalIndex;
        globalId = GlobalId;
        numWorkgroups = NumWorkgroups;
        workgroupId = WorkgroupId;
        ${l?"main(getGlobalIndex());":"main();"};
      }
    `,o}let Eh=`
  struct vec5 {x: i32, y: i32, z: i32, w: i32, u: i32};
  struct vec6 {x: i32, y: i32, z: i32, w: i32, u: i32, v: i32};

  // Checks whether coordinates lie within the bounds of the shape.
  fn coordsInBounds2D(coord : vec2<i32>, shape : vec2<i32>) -> bool {
    return all(coord >= vec2<i32>(0)) && all(coord < shape);
  }
  fn coordsInBounds3D(coord : vec3<i32>, shape : vec3<i32>) -> bool {
    return all(coord >= vec3<i32>(0)) && all(coord < shape);
  }
  fn coordsInBounds4D(coord : vec4<i32>, shape : vec4<i32>) -> bool {
    return all(coord >= vec4<i32>(0)) && all(coord < shape);
  }

  fn getIndexFromCoords1D(coord : i32, shape : i32) -> i32 {
    return coord;
  }
  fn getIndexFromCoords2D(coords : vec2<i32>, shape : vec2<i32>) -> i32 {
    return dot(coords, vec2<i32>(shape.y, 1));
  }
  fn getIndexFromCoords3D(coords : vec3<i32>, shape : vec3<i32>) -> i32 {
    return dot(coords, vec3<i32>(shape.y * shape.z, shape.z, 1));
  }
  fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
    return dot(coords, vec4<i32>(
        shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
  }
  fn getIndexFromCoords5D(coords : vec5, shape : vec5) -> i32 {
    let shapeStrides: vec5 = vec5(shape.y * shape.z * shape.w * shape.u, shape.z * shape.w * shape.u, shape.w * shape.u, shape.u, 1);
    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u;
  }
  fn getIndexFromCoords6D(coords : vec6, shape : vec6) -> i32 {
    let shapeStrides: vec6 = vec6(shape.y * shape.z * shape.w * shape.u * shape.v, shape.z * shape.w * shape.u * shape.v, shape.w * shape.u * shape.v, shape.u * shape.v, shape.v, 1);
    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u + coords.v*shapeStrides.v;
  }

  // NaN defination in IEEE 754-1985 is :
  //   - sign = either 0 or 1.
  //   - biased exponent = all 1 bits.
  //   - fraction = anything except all 0 bits (since all 0 bits represents infinity).
  // https://en.wikipedia.org/wiki/IEEE_754-1985#Representation_of_non-numbers
  fn isnan(val: f32) -> bool {
    let floatToUint: u32 = bitcast<u32>(val);
    return (floatToUint & 0x7fffffffu) > 0x7f800000u;
  }
  fn isnanVec4(val : vec4<f32>) -> vec4<bool> {
    let floatToUint: vec4<u32> = bitcast<vec4<u32>>(val);
    return (floatToUint & vec4<u32>(0x7fffffffu)) > vec4<u32>(0x7f800000u);
  }
`,Mp=`
  fn isinf(val: f32) -> bool {
    return abs(val) == uniforms.INFINITY;
  }
`;function Xc(l,i=""){let o=l.length,u=i!==""?`get${i.charAt(0).toUpperCase()+i.slice(1)}CoordsFromIndex`:"getCoordsFromIndex",c=i!==""?`${i.charAt(0).toLowerCase()+i.slice(1)}ShapeStrides`:"outShapeStrides";if(o<=1)return`fn ${u}(index : i32) -> i32 { return index; }`;let f=m.util.computeStrides(l),y=ol(o),w=[];for(let T=0;T<o;T++)w.push(`d${T}`);if(f.length===1)return`    fn ${u}(index : i32) -> vec2<i32> {
      let d0 = index / uniforms.${c}; let d1 = index - d0 * uniforms.${c};
      return vec2<i32>(d0, d1);
    }`;let C;return C="var index2 = index;"+f.map((T,x)=>`${`let ${w[x]} = index2 / uniforms.${c}.${s1(x)}`}; ${x===f.length-1?`let ${w[x+1]} = index2 - ${w[x]} * uniforms.${c}.${s1(x)}`:`index2 = index2 - ${w[x]} * uniforms.${c}.${s1(x)}`};`).join(""),`
    fn ${u}(index : i32) -> ${y} {
      ${C}
      return ${y}(${w.join(",")});
    }
  `}function Kc(l){let i="";switch(l){case 0:case 1:i+=`
        fn getOutputIndexFromCoords(coords : i32) -> i32 {
          return coords;
        }
        `;break;case 2:i+=`
        fn getOutputIndexFromCoords(coords : vec2<i32>) -> i32 {
          return dot(coords, vec2<i32>(uniforms.outShapeStrides, 1));
        }
        `;break;case 3:i+=`
        fn getOutputIndexFromCoords(coords : vec3<i32>) -> i32 {
          return dot(coords, vec3<i32>(uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, 1));
        }
        `;break;case 4:i+=`
        fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
          return dot(coords, vec4<i32>(
            uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, uniforms.outShapeStrides.z, 1));
        }
        `;break;case 5:i+=`
        fn getOutputIndexFromCoords(coords : vec5) -> i32 {
          return coords.x * uniforms.outShapeStrides.x +
              coords.y * uniforms.outShapeStrides.y +
              coords.z * uniforms.outShapeStrides.z +
              coords.w * uniforms.outShapeStrides.w +
              coords.u;
        }
        `;break;case 6:i+=`
        fn getOutputIndexFromCoords(coords : vec6) -> i32 {
          return coords.x * uniforms.outShapeStrides.x +
              coords.y * uniforms.outShapeStrides.y +
              coords.z * uniforms.outShapeStrides.z +
              coords.w * uniforms.outShapeStrides.w +
              coords.u * uniforms.outShapeStrides.u +
              coords.v;
        }
        `;break;default:m.util.assert(!1,()=>`Unsupported ${l}D shape`)}return i}function Tf(l){return l.dispatch[1]===1&&l.dispatch[2]===1}function vl(l,i=1){if(l==="float32")return ro(i,"f32");if(l==="int32"||l==="bool")return ro(i,"i32");throw new Error(`type ${l} is not supported.`)}function I0(l){return(!l.dispatchLayout.hasOwnProperty("y")||l.dispatchLayout.y.length===0)&&(!l.dispatchLayout.hasOwnProperty("z")||l.dispatchLayout.z.length===0)}let Zc=l=>{let i=1;for(let o=0;o<l.length;o++)i*=l[o];return i};function Nr(l,i,o=[1,1,1],u=[1,1,1]){let[c,f,y]=[Math.ceil(Zc(l.x.map(w=>i[w]))/(o[0]*u[0])),l.y?Math.ceil(Zc(l.y.map(w=>i[w]))/(o[1]*u[1])):1,l.z?Math.ceil(Zc(l.z.map(w=>i[w]))/(o[2]*u[2])):1];return[c,f,y]}function N0(l,i,o=!1){if(o)return[8,8,1];let u=Zc(l.x.map(f=>i[f])),c=Zc(l.y.map(f=>i[f]));return u<=4?[4,16,1]:c<=4?[16,4,1]:[16,16,1]}function M0(l,i,o=!1){if(o)return[4,4,1];let u=Zc(l.x.map(f=>i[f])),c=Zc(l.y.map(f=>i[f]));return u<=4?[1,2,1]:c<=4?[2,1,1]:[2,2,1]}function hi(l){return{x:l.map((i,o)=>o)}}function QI(l){if(l==="float32"||l==="int32"||l==="bool"||l==="string")return 4;if(l==="complex64")return 8;throw new Error(`Unknown dtype ${l}`)}function Qz(){return!(typeof globalThis>"u"||!globalThis.navigator||!globalThis.navigator.gpu)}function WQ(l,i){Array.isArray(l)||(l=[l]),l.forEach(o=>{o!=null&&m.util.assert(o.dtype!=="complex64",()=>`${i} does not support complex64 tensors in the WebGPU backend.`)})}var jm,Th;(Th=jm||(jm={}))[Th.MatMulReduceProgram=0]="MatMulReduceProgram",Th[Th.MatMulSplitKProgram=1]="MatMulSplitKProgram",Th[Th.MatMulSmallOutputSizeProgram=2]="MatMulSmallOutputSizeProgram",Th[Th.MatMulPackedProgram=3]="MatMulPackedProgram",Th[Th.MatMulMax=4]="MatMulMax";let Jz=(0,m.env)().getNumber("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD");class c4 extends m.KernelBackend{nextDataId(){return c4.nextDataId++}constructor(i,o){if(super(),this.commandQueueOwnedIds=new WeakSet,this.dispatchCountInPass=0,this.disposed=!1,this.downloadWaitMs=0,this.tensorDataPendingDisposal=[],this.queryResolveBuffer=null,this.querySet=null,this.querySetCount=2,this.stagingPendingDisposal=[],this.uniformPendingDisposal=[],this.uploadWaitMs=0,this.hasReadSyncWarned=!1,this.hasTimestampQueryWarned=!1,!Qz())throw new Error("WebGPU is not supported on this device");this.pipelineCache={},this.device=i,this.queue=i.queue,this.commandEncoder=null,this.computePassEncoder=null,this.adapterInfo=new Cft(o),this.supportTimestampQuery=this.device.features.has("timestamp-query"),this.thresholdToIncreaseWorkgroups=this.adapterInfo.intelGPUGeneration>=12?16:8,this.bufferManager=new Eft(this.device),this.textureManager=new Tft(this.device),this.tensorMap=new m.DataStorage(this,(0,m.engine)()),(0,m.env)().getBool("WEBGPU_USE_PROFILE_TOOL")&&(this.dummyCanvas=document.createElement("canvas"),this.dummyCanvas.width=1,this.dummyCanvas.height=1,this.dummyContext=this.dummyCanvas.getContext("webgpu"),this.dummyContext.configure({device:i,format:"bgra8unorm"}),document.body.appendChild(this.dummyCanvas))}floatPrecision(){return 32}disposeData(i,o=!1){if(!this.tensorMap.has(i))return!0;let u=this.tensorMap.get(i);return o?u.refCount=0:u.refCount--,!(u.refCount>0)&&(u.complexTensorInfos!=null&&(this.disposeData(u.complexTensorInfos.real.dataId),this.disposeData(u.complexTensorInfos.imag.dataId)),this.commandQueueOwnedIds.has(i)?(this.tensorDataPendingDisposal.push(i),!0):(this.releaseResource(i),this.tensorMap.delete(i),!0))}memory(){return{numBytesInGPU:this.bufferManager.numBytesUsed,numBytesAllocatedInGPU:this.bufferManager.numBytesAllocated,unreliable:!1}}releaseResource(i){let o=this.tensorMap.get(i);o&&o.resource&&(o.external||(o.resource instanceof GPUBuffer?this.bufferManager.releaseBuffer(o.resource):o.resource instanceof GPUTexture&&this.textureManager.releaseTexture(o.resource)),o.resource=null)}refCount(i){return this.tensorMap.has(i)?this.tensorMap.get(i).refCount:0}incRef(i){this.tensorMap.get(i).refCount++}decRef(i){this.tensorMap.has(i)&&this.tensorMap.get(i).refCount--}write(i,o,u){if(u==="complex64"&&i!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let c={id:this.nextDataId()};return this.tensorMap.set(c,{dtype:u,shape:o,values:i,refCount:1}),c}move(i,o,u,c,f){if(c==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.tensorMap.set(i,{dtype:c,shape:u,values:o,refCount:f})}submitQueue(){this.queue.submit([this.commandEncoder.finish()]),this.commandEncoder=null,this.dispatchCountInPass=0,this.commandQueueOwnedIds=new WeakSet,this.tensorDataPendingDisposal.forEach(i=>{this.releaseResource(i),this.tensorMap.delete(i)}),this.uniformPendingDisposal.forEach(i=>this.bufferManager.releaseBuffer(i)),this.stagingPendingDisposal.forEach(i=>this.bufferManager.releaseBuffer(i,!1)),this.tensorDataPendingDisposal=[],this.uniformPendingDisposal=[],this.stagingPendingDisposal=[]}ensureCommandEncoderReady(){this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder())}endComputePassEncoder(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}checkCompileCompletionAsync(){return ce(this,null,function*(){let i;try{i=yield Promise.all(Object.values(this.pipelineCache))}catch(o){throw new Error(o.message)}Object.keys(this.pipelineCache).map((o,u)=>{this.pipelineCache[o]=i[u]})})}getBufferData(i){return ce(this,null,function*(){if((0,m.env)().getBool("WEBGPU_ENGINE_COMPILE_ONLY"))return console.warn("The data may be invalid since WEBGPU_ENGINE_COMPILE_ONLY is true, this can only be called when WEBGPU_ENGINE_COMPILE_ONLY is false"),null;let o=i.size,u=this.bufferManager.acquireBuffer(o,GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(i,0,u,0,o),this.submitQueue(),yield u.mapAsync(GPUMapMode.READ);let c=u.getMappedRange().slice(0);return u.unmap(),u!=null&&this.bufferManager.releaseBuffer(u),(0,m.env)().getBool("WEBGPU_USE_PROFILE_TOOL")&&(m.util.assert(this.dummyContext!==void 0,()=>"Fail to get context for profiling tool"),this.dummyContext.getCurrentTexture()),c})}convertAndCacheOnCPU(i,o){let u=this.tensorMap.get(i);return u.values=o,u.values}readSync(i){let o=this.tensorMap.get(i),{values:u,complexTensorInfos:c}=o;if(u!=null||o.dtype==="string")return u;if(o.dtype==="complex64"){let G=this.readSync(c.real.dataId),Q=this.readSync(c.imag.dataId),nt=m.util.convertBackendValuesAndArrayBuffer(m.backend_util.mergeRealAndImagArrays(G,Q).buffer,"float32");return this.convertAndCacheOnCPU(i,nt),nt}this.hasReadSyncWarned||(this.hasReadSyncWarned=!0,console.warn("The performance of synchronously reading data from GPU to CPU is poor on the webgpu backend, please use asynchronous APIs instead."));let f=["opaque","premultiplied"],y=o.resource,w=y.size;m.util.assert(w%4==0,()=>"Because there is 4 bytes for one pixel, buffer size must be multiple of 4.");let C=w/4,T=new ArrayBuffer(w),x=256,A=256,M=f.map(G=>new OffscreenCanvas(x,A)),$=new OffscreenCanvas(x,A);this.endComputePassEncoder(),M.map((G,Q)=>{let nt=G.getContext("webgpu");return nt.configure({device:this.device,format:"bgra8unorm",usage:GPUTextureUsage.COPY_DST,alphaMode:f[Q]}),nt.getCurrentTexture()}).map((G,Q)=>{let nt=(Ut,Pt,re)=>{this.ensureCommandEncoderReady(),this.commandEncoder.copyBufferToTexture({buffer:y,bytesPerRow:1024,offset:re},{texture:G},{width:Ut,height:Pt}),this.submitQueue();let ue=$.getContext("2d",{willReadFrequently:!0});ue.clearRect(0,0,Ut,Pt),ue.drawImage(M[Q],0,0);let be=ue.getImageData(0,0,Ut,Pt).data,De=f[Q],ze=new Uint8ClampedArray(T,re,Ut*Pt*4);for(let Qe=0;Qe<ze.length;Qe+=4)if(De==="premultiplied")ze[Qe+3]=be[Qe+3];else{let cn=be[Qe];ze[Qe]=be[Qe+2],ze[Qe+1]=be[Qe+1],ze[Qe+2]=cn}},it=Math.floor(C/65536),ht=x,kt=A,Nt=0;for(let Ut=0;Ut<it;Ut++)nt(ht,kt,Nt),Nt+=262144;let $t=C%65536;kt=Math.floor($t/x),kt>0&&(nt(ht,kt,Nt),Nt+=1024*kt),ht=$t%x,ht>0&&nt(ht,1,Nt)});let V=m.util.convertBackendValuesAndArrayBuffer(T,o.dtype);return this.convertAndCacheOnCPU(i,V),V}read(i){return ce(this,null,function*(){if(!this.tensorMap.has(i))throw new Error(`Tensor ${i} was not registered!`);let o=this.tensorMap.get(i),{values:u}=o;if(u!=null)return u;let c;if(o.dtype==="complex64"){let f=yield Promise.all([this.read(o.complexTensorInfos.real.dataId),this.read(o.complexTensorInfos.imag.dataId)]),y=f[0],w=f[1];c=m.backend_util.mergeRealAndImagArrays(y,w)}else{let f=yield this.getBufferData(o.resource);c=m.util.convertBackendValuesAndArrayBuffer(f,o.dtype)}return this.convertAndCacheOnCPU(i,c),c})}copyBuffer(i){let o=i.size,u=i.usage,c=this.bufferManager.acquireBuffer(o,u);return this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(i,0,c,0,o),this.submitQueue(),c}createTensorFromGPUData(i,o,u){let c=i.buffer;if(u==="complex64")throw new Error("Cannot write to a complex64 dtype. ");let f={id:this.nextDataId()};this.tensorMap.set(f,{dtype:u,shape:o,values:null,refCount:1,external:i.zeroCopy});let y=this.tensorMap.get(f),w=QI(y.dtype)*m.util.sizeFromShape(y.shape);if(i.buffer.size<w)throw new Error(`GPUBuffer size(${i.buffer.size}) is smaller than tensor size(${w})!`);if((i.buffer.usage&(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))!=(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))throw new Error("GPUBuffer.usage should include GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC!");return i.zeroCopy!==!0&&(c=this.copyBuffer(c)),y.resource=c,(0,m.engine)().makeTensorFromDataId(f,o,u,this)}readToGPU(i){let o=this.tensorMap.get(i),{values:u,dtype:c,shape:f,resource:y}=o;if(c==="complex64")throw new Error("Does not support reading buffer for complex64 dtype.");if(y==null)throw u!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");let w=y,C=w.size,T=w.usage,x=this.bufferManager.acquireBuffer(C,T);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(y,0,x,0,C),this.submitQueue();let A=this.makeTensorInfo(f,c),M=(0,m.engine)().makeTensorFromTensorInfo(A);return this.tensorMap.get(A.dataId).resource=x,{tensorRef:M,buffer:x}}bufferSync(i){let o=this.readSync(i.dataId);if(i.dtype==="string")try{let u=o.map(c=>m.util.decodeString(c));return(0,m.buffer)(i.shape,i.dtype,u)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return(0,m.buffer)(i.shape,i.dtype,o)}time(i){return ce(this,null,function*(){this.supportTimestampQuery||this.hasTimestampQueryWarned||(console.warn("This device doesn't support timestamp-query extension. Start Chrome browser with flag --enable-dawn-features=allow_unsafe_apis to try it again. Otherwise, zero will be shown for the kernel time when profiling mode is enabled."),this.hasTimestampQueryWarned=!0);let o=this.activeTimers,u=[],c=!1;this.programTimersStack==null?(this.programTimersStack=u,c=!0):this.activeTimers.push(u),this.activeTimers=u,i();let f=m.util.flatten(this.activeTimers.map(T=>T.query)).filter(T=>T!=null),y=m.util.flatten(this.activeTimers.map(T=>T.name)).filter(T=>T!=null);this.activeTimers=o,c&&(this.programTimersStack=null);let w={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},C=yield Promise.all(f);return w.kernelMs=m.util.sum(C),w.getExtraProfileInfo=()=>C.map((T,x)=>({name:y[x],ms:T})).map(T=>`${T.name}: ${T.ms}`).join(", "),this.uploadWaitMs=0,this.downloadWaitMs=0,w})}makeTensorInfo(i,o,u){return o==="string"&&u!=null&&u.length>0&&m.util.isString(u[0])&&(u=u.map(c=>m.util.encodeString(c))),{dataId:this.write(u,i,o),shape:i,dtype:o}}tensorToBinding(i){if(!i)return null;let o=this.tensorMap.get(i.dataId).resource;return o instanceof GPUBuffer?{buffer:o}:o instanceof GPUTexture?o.createView():o}uploadToGPU(i){let o=this.tensorMap.get(i);if(o.resource!=null)return;let u=QI(o.dtype)*m.util.sizeFromShape(o.shape),c,f=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;if(o.values){if(c=this.bufferManager.acquireBuffer(u,f,!0),c.mapState==="unmapped"){let y=this.bufferManager.acquireBuffer(u,GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC,!0,!1),w=y.getMappedRange();o.dtype==="int32"||o.dtype==="bool"?new Int32Array(w).set(o.values):new Float32Array(w).set(o.values),y.unmap(),this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(y,0,c,0,u),this.stagingPendingDisposal.push(y)}else{let y=c.getMappedRange();o.dtype==="int32"||o.dtype==="bool"?new Int32Array(y).set(o.values):new Float32Array(y).set(o.values),c.unmap()}o.values=null}else c=this.bufferManager.acquireBuffer(u,f);o.resource=c}makeUniforms(i){let o=0,u=0,c=[],f=1;i.forEach(C=>{let T;switch(C.data.length===0&&(C.data=[1]),C.data.length){case 1:T=4;break;case 2:T=8;break;case 3:case 4:case 5:case 6:T=16;break;default:m.util.assert(!1,()=>`Unsupported ${C.data.length}D shape`)}u!==5&&u!==6||(T=16),T>f&&(f=T),o=Math.ceil(o/T)*T,u=C.data.length,c.push(o),o+=4*C.data.length}),o=Math.ceil(o/f)*f;let y=new ArrayBuffer(o);i.forEach((C,T)=>{let x=c[T];C.type==="int32"?new Int32Array(y,x,C.data.length).set(C.data):C.type==="uint32"?new Uint32Array(y,x,C.data.length).set(C.data):new Float32Array(y,x,C.data.length).set(C.data)});let w=this.bufferManager.acquireBuffer(o,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);return this.queue.writeBuffer(w,0,y,0,o),this.uniformPendingDisposal.push(w),{offset:0,size:o,buffer:w}}runWebGPUProgram(i,o,u,c,f){if(f||(f=this.makeTensorInfo(i.outputShape,u)),m.util.sizeFromShape(f.shape)===0)return this.tensorMap.get(f.dataId).values=m.util.getTypedArrayFromDType(f.dtype,0),f;this.uploadToGPU(f.dataId),i.dispatch=((C,T)=>{let x=C.limits.maxComputeWorkgroupsPerDimension,A=T.dispatchLayout,M=T.dispatch;if(M.every(V=>V<=x))return M;m.util.assert(M[0]>x&&A.y===void 0&&A.z===void 0,()=>"Dispatch size exceeds WebGPU limits in Y or Z dimension.");let $=Math.ceil(Math.sqrt(M[0]));return $>x?($=Math.ceil(Math.cbrt(M[0])),m.util.assert($<=x,()=>"Total dispatch size exceeds WebGPU maximum."),[$,$,$]):[$,$,1]})(this.device,i);let y=o.map((C,T)=>{if(C.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");return this.uploadToGPU(C.dataId),{dtype:this.tensorMap.get(C.dataId).dtype,shape:C.shape,name:i.variableNames[T]}});i.shaderKey=function(C,T,x){let A=C.shaderKey;if(C.pixelsOpType!=null)return A;let M=[],$=[];T.forEach(it=>{M.push(it.shape),$.push(it.dtype)}),M.push(x.shape),$.push(x.dtype);let V=T.map(it=>m.backend_util.getBroadcastDims(it.shape,x.shape)),G=T.map(it=>m.util.arraysEqual(it.shape,x.shape)).join("_"),Q=V.map(it=>it.join("_")).join(";"),nt=Tf(C)?"flatDispatch":"";return A+="_"+(C.workgroupSize?C.workgroupSize.join(","):"")+M.map(it=>it.length).join(",")+$.join(",")+C.variableNames.join(",")+Q+G+nt,A}(i,y,f);let w=(0,m.env)().getBool("WEBGPU_ENGINE_COMPILE_ONLY");return i.shaderKey in this.pipelineCache||(this.pipelineCache[i.shaderKey]=Aft(this.device,i,y,f,w)),i.pipeline=this.pipelineCache[i.shaderKey],w||this.recordAndSubmit(i,f,o,c),f}recordAndSubmit(i,o,u,c){if(i.pipeline instanceof Promise)throw new Error("Please call checkCompileCompletionAsync to ensure parallel compilation is done!");let f=[],y=[],w="int32";if(i.pixelsOpType==null){f.push({type:"float32",data:[NaN]},{type:"float32",data:[1/0]}),y=u.concat(o).map($=>$.shape);let M="int32";y.map($=>{f.push({type:M,data:$});let V=m.util.computeStrides($);f.push({type:M,data:V})})}else{let M=m.util.computeStrides(o.shape);f.push({type:w,data:M})}if(i.size){let M=m.util.sizeFromShape(i.outputShape);f.push({type:w,data:[i.outputComponent?M/i.outputComponent:M]})}c&&(f=[...f,...c]);let C=[this.tensorToBinding(o),...u.map(M=>this.tensorToBinding(M)),this.makeUniforms(f)];u.forEach(M=>{this.commandQueueOwnedIds.add(M.dataId)}),this.commandQueueOwnedIds.add(o.dataId);let T=this.device.createBindGroup({layout:i.pipeline.getBindGroupLayout(0),entries:C.map((M,$)=>({binding:$,resource:M}))}),x=this.activeTimers!=null;this.ensureCommandEncoderReady();let A={};x&&this.supportTimestampQuery?(this.endComputePassEncoder(),this.querySet==null&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.querySetCount})),A.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1},this.computePassEncoder=this.commandEncoder.beginComputePass(A)):this.computePassEncoder||(this.computePassEncoder=this.commandEncoder.beginComputePass(A)),this.computePassEncoder.setPipeline(i.pipeline),this.computePassEncoder.setBindGroup(0,T),this.computePassEncoder.dispatchWorkgroups(i.dispatch[0],i.dispatch[1],i.dispatch[2]),this.dispatchCountInPass++,(x||(0,m.env)().get("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE")<=this.dispatchCountInPass||i.pixelsOpType===Lb.DRAW)&&(this.endComputePassEncoder(),x?this.activeTimers.push({name:i.constructor.name,query:this.getQueryTime()}):this.submitQueue())}getQueryTime(){return ce(this,null,function*(){if(!this.supportTimestampQuery)return 0;this.queryResolveBuffer==null&&(this.queryResolveBuffer=this.bufferManager.acquireBuffer(8*this.querySetCount,GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST|GPUBufferUsage.QUERY_RESOLVE)),this.commandEncoder.resolveQuerySet(this.querySet,0,this.querySetCount,this.queryResolveBuffer,0);let i=this.bufferManager.acquireBuffer(8*this.querySetCount,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST);this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,i,0,8*this.querySetCount),this.submitQueue(),yield i.mapAsync(GPUMapMode.READ);let o=new BigUint64Array(i.getMappedRange()),u=Number(o[1]-o[0])/1e6;return i.unmap(),this.bufferManager.releaseBuffer(i),u})}shouldExecuteOnCPU(i,o=Jz){return(0,m.env)().getBool("WEBGPU_CPU_FORWARD")&&i.every(u=>this.tensorMap.get(u.dataId).resource==null&&m.util.sizeFromShape(u.shape)<o)}numDataIds(){return this.tensorMap.numDataIds()-this.tensorDataPendingDisposal.length}dispose(){this.disposed||(this.querySet!=null&&this.querySet.destroy(),this.bufferManager.dispose(),this.textureManager.dispose(),this.disposed=!0)}}var Ma,za;c4.nextDataId=0,Qz()&&(0,m.registerBackend)("webgpu",()=>ce(this,null,function*(){let l={powerPreference:(0,m.env)().get("WEBGPU_USE_LOW_POWER_GPU")?"low-power":"high-performance"},i=yield navigator.gpu.requestAdapter(l),o={},u=[];i.features.has("timestamp-query")&&u.push("timestamp-query"),i.features.has("bgra8unorm-storage")&&u.push(["bgra8unorm-storage"]),o.requiredFeatures=u;let c=i.limits;o.requiredLimits={maxComputeWorkgroupStorageSize:c.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:c.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:c.maxStorageBufferBindingSize,maxBufferSize:c.maxBufferSize,maxComputeWorkgroupSizeX:c.maxComputeWorkgroupSizeX,maxComputeInvocationsPerWorkgroup:c.maxComputeInvocationsPerWorkgroup};let f=yield i.requestDevice(o),y="info"in i?i.info:"requestAdapterInfo"in i?yield i.requestAdapterInfo():void 0;return new c4(f,y)}),3),(za=Ma||(Ma={}))[za.ADD=0]="ADD",za[za.ATAN2=1]="ATAN2",za[za.COMPLEX_MULTIPLY_IMAG=2]="COMPLEX_MULTIPLY_IMAG",za[za.COMPLEX_MULTIPLY_REAL=3]="COMPLEX_MULTIPLY_REAL",za[za.DIV=4]="DIV",za[za.ELU_DER=5]="ELU_DER",za[za.EQUAL=6]="EQUAL",za[za.FLOOR_DIV=7]="FLOOR_DIV",za[za.GREATER=8]="GREATER",za[za.GREATER_EQUAL=9]="GREATER_EQUAL",za[za.LESS=10]="LESS",za[za.LESS_EQUAL=11]="LESS_EQUAL",za[za.LOGICAL_AND=12]="LOGICAL_AND",za[za.LOGICAL_OR=13]="LOGICAL_OR",za[za.MAX=14]="MAX",za[za.MIN=15]="MIN",za[za.MOD=16]="MOD",za[za.MUL=17]="MUL",za[za.NOT_EQUAL=18]="NOT_EQUAL",za[za.POW=19]="POW",za[za.PRELU=20]="PRELU",za[za.SQUARED_DIFFERENCE=21]="SQUARED_DIFFERENCE",za[za.SUB=22]="SUB";function y6(l,i){let o;do{switch(l){case Ma.ATAN2:o="let resultTemp = atan2(a, b);";break;case Ma.MAX:o="let resultTemp = max(a, b);";break;case Ma.MIN:o="let resultTemp = min(a, b);";break;case Ma.MOD:o=i?`
  let isNaN = !vec4<bool>(b);
  var resultTemp = vec4<f32>(a % b);
  if (!((a[0] < 0. && b[0] < 0.) || (a[0] >= 0. && b[0] > 0.))) {
    resultTemp[0] = (resultTemp[0] + b[0]) % b[0];
  }
  if (!((a[1] < 0. && b[1] < 0.) || (a[1] >= 0. && b[1] > 0.))) {
    resultTemp[1] = (resultTemp[1] + b[1]) % b[1];
  }
  if (!((a[2] < 0. && b[2] < 0.) || (a[2] >= 0. && b[2] > 0.))) {
    resultTemp[2] = (resultTemp[2] + b[2]) % b[2];
  }
  if (!((a[3] < 0. && b[3] < 0.) || (a[3] >= 0. && b[3] > 0.))) {
    resultTemp[3] = (resultTemp[3] + b[3]) % b[3];
  }
`:`
  let isNaN = b == 0.;
  var resultTemp = a % b;
  resultTemp = select((resultTemp + b) % b, resultTemp,
      (a < 0. && b < 0.) || (a >= 0. && b > 0.));
`;break;case Ma.NOT_EQUAL:o=i?`
  var resultTemp = vec4<f32>(a != b);
  let valueForNaN = 1.0;
`:`
  var resultTemp = f32(a != b);
  let valueForNaN = 1.0;
`;break;case Ma.POW:o=i?`
  let isModRound1Bool = vec4<i32>(round(abs(b) % vec4<f32>(2.0))) == vec4<i32>(1);
  let isModRound1 = vec4<f32>(isModRound1Bool);
  let multiplier = sign(a) * isModRound1 + (vec4<f32>(1.0) - isModRound1);
  var resultTemp = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  let isExpZero = b == vec4<f32>(0.0);
  if (isExpZero.r) {
    resultTemp.r = 1.0;
  }
  if (isExpZero.g) {
    resultTemp.g = 1.0;
  }
  if (isExpZero.b) {
    resultTemp.b = 1.0;
  }
  if (isExpZero.a) {
    resultTemp.a = 1.0;
  }
  let isNaN = (a < vec4<f32>(0.0)) & (floor(b) < b);
`:`
  let isNaN = a < 0.0 && floor(b) < b;
  if (b == 0.0) {
    return 1.0;
  }
  var resultTemp = select(sign(a) * pow(abs(a), b), pow(abs(a), b),
      round(abs(b) % 2.0) != 1.0);
`;break;default:continue}let u,c,f;return i?(u="isnanVec4",c="vec4<f32>",f="vec4<bool>"):(u="isnan",c="f32",f="bool"),`
      let aIsNaN = ${u}(a);
      let aPostLegalization = select(a, ${c}(42), aIsNaN);
      let bIsNaN = ${u}(b);
      let bPostLegalization = select(b, ${c}(42), bIsNaN);
      let isNaN = false;
      let valueForNaN = uniforms.NAN;
      {
        let a = aPostLegalization;
        let b = bPostLegalization;
        ${o}
        return select(
            resultTemp, ${c}(valueForNaN),
            ${f}(isNaN) | aIsNaN | bIsNaN);
      }
    `}while(!1);switch(l){case Ma.ADD:o="let resultTemp = a + b;";break;case Ma.COMPLEX_MULTIPLY_IMAG:o="let resultTemp = areal * bimag + aimag * breal;";break;case Ma.COMPLEX_MULTIPLY_REAL:o="let resultTemp = areal * breal - aimag * bimag;";break;case Ma.DIV:o="let resultTemp = a / b;";break;case Ma.ELU_DER:o="let resultTemp = select(a * (b + 1.0), a, b >= b - b);";break;case Ma.EQUAL:o=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a == b);
`;break;case Ma.FLOOR_DIV:o=`
  let remainder =
      select(a % b, round(a % b), (round(a) == a) & (round(b) == b));
  let quotient = (a - remainder) / b;
  let resultTemp =
      round(select(quotient, quotient - 1, sign(remainder) == -sign(b)));
`;break;case Ma.GREATER:o=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a > b);
`;break;case Ma.GREATER_EQUAL:o=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a >= b);
`;break;case Ma.LESS:o=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a < b);
`;break;case Ma.LESS_EQUAL:o=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a <= b);
`;break;case Ma.LOGICAL_AND:return i?`return (vec4<f32>(a >= vec4<f32>(1.0)) *
  vec4<f32>(b >= vec4<f32>(1.0)));`:"return f32(a >= 1.0 && b >= 1.0);";case Ma.LOGICAL_OR:return i?`return min(vec4<f32>(a >= vec4<f32>(1.0)) +
  vec4<f32>(b >= vec4<f32>(1.0)), vec4<f32>(1.0));`:"return f32(a >= 1.0 || b >= 1.0);";case Ma.MUL:o="let resultTemp = a * b;";break;case Ma.PRELU:return i?`
  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));
  return (aLessThanZero * (b * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);
`:"if (a < 0.0) { return b * a; }  return a;";case Ma.SQUARED_DIFFERENCE:o="let resultTemp = (a - b) * (a - b);";break;case Ma.SUB:o="let resultTemp = a - b;"}return`
    ${o}
    return resultTemp;
  `}var zr,ei;(ei=zr||(zr={}))[ei.ABS=0]="ABS",ei[ei.ACOS=1]="ACOS",ei[ei.ACOSH=2]="ACOSH",ei[ei.ASIN=3]="ASIN",ei[ei.ASINH=4]="ASINH",ei[ei.ATAN=5]="ATAN",ei[ei.ATANH=6]="ATANH",ei[ei.CEIL=7]="CEIL",ei[ei.COS=8]="COS",ei[ei.COSH=9]="COSH",ei[ei.ELU=10]="ELU",ei[ei.ERF=11]="ERF",ei[ei.EXP=12]="EXP",ei[ei.EXPM1=13]="EXPM1",ei[ei.FLOOR=14]="FLOOR",ei[ei.IS_FINITE=15]="IS_FINITE",ei[ei.IS_INF=16]="IS_INF",ei[ei.IS_NAN=17]="IS_NAN",ei[ei.LINEAR=18]="LINEAR",ei[ei.LOG=19]="LOG",ei[ei.LOG1P=20]="LOG1P",ei[ei.LOGICAL_NOT=21]="LOGICAL_NOT",ei[ei.NEG=22]="NEG",ei[ei.RELU=23]="RELU",ei[ei.RELU6=24]="RELU6",ei[ei.LEAKYRELU=25]="LEAKYRELU",ei[ei.RECIPROCAL=26]="RECIPROCAL",ei[ei.ROUND=27]="ROUND",ei[ei.RSQRT=28]="RSQRT",ei[ei.SELU=29]="SELU",ei[ei.SIGMOID=30]="SIGMOID",ei[ei.SIGN=31]="SIGN",ei[ei.SIN=32]="SIN",ei[ei.SINH=33]="SINH",ei[ei.SOFTPLUS=34]="SOFTPLUS",ei[ei.SQRT=35]="SQRT",ei[ei.SQUARE=36]="SQUARE",ei[ei.STEP=37]="STEP",ei[ei.TAN=38]="TAN",ei[ei.TANH=39]="TANH",ei[ei.TO_INT=40]="TO_INT";let Ift=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  let p = ${m.backend_util.ERF_P};
  let a1 = ${m.backend_util.ERF_A1};
  let a2 = ${m.backend_util.ERF_A2};
  let a3 = ${m.backend_util.ERF_A3};
  let a4 = ${m.backend_util.ERF_A4};
  let a5 = ${m.backend_util.ERF_A5};

  let sign = sign(a);
  let absA = abs(a);
  let t = 1.0 / (1.0 + p * absA);
  return sign * (1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * exp(-absA * absA));
`,Nft=`
  if (a >= 0.0) {
    return ${m.backend_util.SELU_SCALE} * a;
  } else {
    return ${m.backend_util.SELU_SCALEALPHA} * (exp(a) - 1.0);
  }
`;function Q2(l,i){switch(l){case zr.ABS:return"return abs(a);";case zr.ACOS:return`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  return acos(a);
`;case zr.ACOSH:return`
  if (a < 1.) {
    return uniforms.NAN;
  }
  return acosh(a);
`;case zr.ASIN:return`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  return asin(a);
`;case zr.ASINH:return"return asinh(a);";case zr.ATAN:return`
  if (isnan(a)) {
    return uniforms.NAN;
  }
  return atan(a);
`;case zr.ATANH:return`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  if (a == 1.) {
    return uniforms.INFINITY;
  }
  if (a == -1.) {
    return -uniforms.INFINITY;
  }
  return atanh(a);
`;case zr.COS:return"return cos(a);";case zr.COSH:return`
  let e2x = exp(-a);
  return (e2x + 1.0 / e2x) / 2.0;
`;case zr.CEIL:return"return ceil(a);";case zr.ELU:return i?`
  var resFloat = exp(a) - vec4<f32>(1.0);
  if (a.r >= 0.0) {
    resFloat.r = a.r;
  }
  if (a.g >= 0.0) {
    resFloat.g = a.g;
  }
  if (a.b >= 0.0) {
    resFloat.b = a.b;
  }
  if (a.a >= 0.0) {
    resFloat.a = a.a;
  }
  return resFloat;
`:"if (a >= 0.0) { return a; }  return (exp(a) - 1.0);";case zr.ERF:return Ift;case zr.EXP:return"return exp(a);";case zr.EXPM1:return"return exp(a) - 1.0;";case zr.FLOOR:return"return floor(a);";case zr.IS_FINITE:return"return f32(!isnan(a) && !isinf(a));";case zr.IS_INF:return"return f32(isinf(a));";case zr.IS_NAN:return"return f32(isnan(a));";case zr.LINEAR:return"return a;";case zr.LOG:return`if (a < 0.0) { return uniforms.NAN; }
  return log(a);`;case zr.LOG1P:return`
  if (isnan(a)) { return a; }
  return log(1.0 + a);
`;case zr.LOGICAL_NOT:return"return f32(!(a >= 1.0));";case zr.NEG:return"return -a;";case zr.LEAKYRELU:return i?`
  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));
  return (aLessThanZero * (uniforms.alpha * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);
`:"if (a < 0.0) { return uniforms.alpha * a; } return a;";case zr.RECIPROCAL:return"return 1.0 / a;";case zr.RELU:return i?`
  return select(a, vec4<f32>(0.0), a < vec4<f32>(0.0));
`:"return select(a, 0.0, a < 0.0);";case zr.RELU6:return i?"return clamp(a, vec4<f32>(0.0, 0.0, 0.0, 0.0), vec4<f32>(6.0, 6.0, 6.0, 6.0));":"return clamp(a, 0.0, 6.0);";case zr.ROUND:return"return round(a);";case zr.RSQRT:return"return inverseSqrt(a);";case zr.SELU:return Nft;case zr.SIGMOID:return"return 1.0 / (1.0 + exp(-1.0 * a));";case zr.SIGN:return"return sign(a);";case zr.SIN:return"return sin(a);";case zr.SINH:return`
  let e2x = exp(a);
  return (e2x - 1.0 / e2x) / 2.0;
`;case zr.SOFTPLUS:return`
  let epsilon = 1.1920928955078125e-7;
  let threshold = log(epsilon) + 2.0;

  let too_large = a > -threshold;
  let too_small = a < threshold;
  let exp_a = exp(a);

  if (too_large) {
    return a;
  } else if (too_small) {
    return exp_a;
  } else {
    return log(exp_a + 1.0);
  }
`;case zr.SQRT:return"return sqrt(a);";case zr.SQUARE:return"return a * a;";case zr.STEP:return`
  if (isnan(a)) {
    return a;
  }

  return select(uniforms.stepAlpha, 1.0, a > 0.0);
`;case zr.TAN:return"return tan(a);";case zr.TANH:return`
  let e2x = exp(-2.0 * abs(a));
  return sign(a) * (1.0 - e2x) / (1.0 + e2x);
`;case zr.TO_INT:return"return f32(i32((a)));";default:throw new Error(`BinaryType ${l} is not implemented!`)}}function D0(l,i=!1,o=!1,u=3){if(l===null)return"";let c="";if(l==="linear")c=Q2(zr.LINEAR);else if(l==="relu")c=Q2(zr.RELU,o);else if(l==="elu")c=Q2(zr.ELU,o);else if(l==="relu6")c=Q2(zr.RELU6,o);else if(l==="prelu")c=y6(Ma.PRELU,o);else if(l==="sigmoid")c=Q2(zr.SIGMOID,o);else{if(l!=="leakyrelu")throw new Error(`Activation ${l} has not been implemented for the WebGPU backend.`);c=Q2(zr.LEAKYRELU,o)}let f=ro(o?4:1),y="";return y=i?`
      fn activation(a : ${f}, coords : vec${u}<i32>) -> ${f} {
        let b = getPreluActivationWeightsByOutputCoords(coords);
        ${c}
      }`:`
      fn activation(a : ${f}, coords : vec${u}<i32>) -> ${f} {
        ${c}
      }`,y}function u1(l,i){return`
      ${l?"value = value + getBiasByOutputCoords(coords);":""}
      ${i?"value = activation(value, coords);":""}
      `}function VQ(l,i,o=!1,u=!1,c=!1,f=1){m.util.assert(l&&f===1||!l,()=>`transposeA ${l} is not compatible with component size ${f}`);let y=`
      ${l?"value = getA(batch, col, row);":"value = getA(batch, row, col);"}

    `,w=i?"value = getB(batch, col, row);":"value = getB(batch, row, col);";return`
  fn mm_readA(batch: i32, row: i32, col: i32) -> ${ro(f)} {
    var value = ${ro(f)}(0.0);
    ${o&&c?y:`
    ${l?"if(row < uniforms.dimAOuter && col < uniforms.dimInner)":"if(row < uniforms.aShape[1] && col < uniforms.aShape[2])"}
    {
      ${y}
    }
    `}
    return value;
  }

  fn mm_readB(batch: i32, row: i32, col: i32) -> ${ro(f)} {
    var value = ${ro(f)}(0.0);
    ${w}
    return value;
  }
  `}function JI(l,i,o,u,c=!1,f=!1,y=!1,w=1){return`
  ${VQ(o,u,c,f,y,w)}
  fn mm_write(batch: i32, row: i32, col: i32, valueIn: ${ro(w)}) {
    ${c&&f?"":"if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)"}
    {
      var value = valueIn;
      let coords = vec3<i32>(batch, row, col);
      ${u1(l,i)}
      setOutputAtCoords(coords[0], coords[1], coords[2], value);
    }
  }
  `}function l1(l,i,o=!1,u=32,c=!1,f=32,y=!1){let w=i[1]*l[1],C=i[0]*l[0],T=o?w:u,x=o?u:w,A=T/i[0],M=u/i[1],$=l[1],V=l[0];return m.util.assert((o&&A===4&&l[1]===4||!o&&(A===3||A===4))&&T%i[0]==0&&u%i[1]==0&&l[0]===4,()=>`If transposeA ${o} is true, innerElementSize ${A} and workPerThread[1] ${l[1]} must be 4.
          Otherwise, innerElementSize ${A} must be 3 or 4.
      tileAWidth ${T} must be divisible by workgroupSize[0]${i[0]}. tileInner ${u} must be divisible by workgroupSize[1] ${i[1]}. colPerThread ${l[0]} must be 4.`),`
  var<workgroup> mm_Asub : array<array<vec${A}<f32>, ${T/A}>, ${x}>;
  var<workgroup> mm_Bsub : array<array<vec4<f32>, ${C/l[0]}>, ${u}>;

  ${Gr()} {
    let localRow = i32(localId.y);
    let tileRow = localRow * ${$};
    let tileCol = i32(localId.x);

    let globalRow = i32(globalId.y) * ${$};
    let globalCol = i32(globalId.x) * ${V};
    let batch = ${c?"0":"i32(globalId.z)"};
    let batchA = ${c||!y?"batch":"batch % uniforms.aShape[0]"};
    let batchB = ${c||!y?"batch":"batch % uniforms.bShape[0]"};
    let globalRowStart = i32(workgroupId.y) * ${w};

    let numTiles = ${c?`${Math.ceil(f/u)}`:`(uniforms.dimInner - 1) / ${u} + 1`};
    var kStart = ${c?`i32(globalId.z) * ${f}`:"0"};

    var acc: array<vec4<f32>, ${$}>;

    // Loop over shared dimension.
    let tileRowB = localRow * ${M};
    for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        for (var innerRow = 0; innerRow < ${$}; innerRow++) {
            let inputRow = tileRow + innerRow;
            let inputCol = tileCol;
            ${((G,Q)=>G?`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          kStart + inputRow,
          globalRowStart + inputCol * ${Q});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          globalRow + innerRow,
          kStart + inputCol * ${Q});
        `)(o,A)}
        }

        // Load one tile of B into local memory.
        for (var innerRow = 0; innerRow < ${M}; innerRow++) {
            let inputRow = tileRowB + innerRow;
            let inputCol = tileCol;
            mm_Bsub[inputRow][inputCol] = mm_readB(batchB, kStart + inputRow, globalCol);
        }
        kStart = kStart + ${u};
        workgroupBarrier();

        // Compute acc values for a single thread.
        ${((G,Q,nt,it)=>{if(G)return`
      for (var k = 0; k < ${it}; k++) {
        let BCached0 = mm_Bsub[k][tileCol];
        let ACached0 = mm_Asub[k][localRow];
        for (var i = 0; i < ${nt}; i++) {
          acc[i] = fma(BCached0, vec4<f32>(ACached0[i]), acc[i]);
        }
      }`;{let ht="",kt="";for(let Nt=0;Nt<Q;Nt++)ht+=`let BCached${Nt} = mm_Bsub[k * ${Q} + ${Nt}][tileCol];`,kt+=`acc[i] = fma(BCached${Nt}, vec4<f32>(ACached[${Nt}]), acc[i]);`;return`
      for (var k = 0; k < ${it/Q}; k++) {
        ${ht}
        for (var i = 0; i < ${nt}; i++) {
          let ACached = mm_Asub[tileRow + i][k];
          ${kt}
        }
      }`}})(o,A,$,u)}
        workgroupBarrier();
    }

    for (var innerRow = 0; innerRow < ${$}; innerRow++) {
        mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
    }
  }`}let GQ=l=>l?`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          kStart + inputRow,
          globalRowStart + inputCol);
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          globalRowStart + inputRow,
          kStart + inputCol);
        `;function t7(l,i,o=!1,u=32,c=!1,f=32,y=!1,w=!1){let C=l[1]*i[1],T=l[0]*i[0],x=o?C:u,A=o?u:C;m.util.assert(A%i[1]==0&&x%i[0]==0&&u%i[1]==0,()=>`tileAHight ${A} must be divisible by workgroupSize[1]${i[1]}, tileAWidth ${x} must be divisible by workgroupSize[0]${i[0]}, tileInner ${u} must be divisible by workgroupSize[1]${i[1]}`);let M=A/i[1],$=x/i[0],V=u/i[1],G=l[1],Q=l[0],nt=y?`
      let localRow = i32(localId.y);
      let localCol = i32(localId.x);
      let globalRowStart = i32(workgroupId.y) * ${C};
      let globalColStart = i32(workgroupId.x) * ${T};

      // Loop over shared dimension.
      for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        for (var inputRow = localRow; inputRow < ${A}; inputRow = inputRow + ${i[1]}) {
          for (var inputCol = localCol; inputCol < ${x}; inputCol = inputCol + ${i[0]}) {
            ${GQ(o)}
          }
        }
        // Load one tile of B into local memory.
        for (var inputRow = localRow; inputRow < ${u}; inputRow = inputRow + ${i[1]}) {
              for (var inputCol = localCol; inputCol < ${T}; inputCol = inputCol + ${i[0]}) {
            mm_Bsub[inputRow][inputCol] = mm_readB(batchB,
              kStart + inputRow,
              globalColStart + inputCol);
          }
        }
        kStart = kStart + ${u};
        workgroupBarrier();

        // Compute acc values for a single thread.
        var BCached : array<f32, ${Q}>;
        for (var k = 0; k < ${u}; k++) {
          for (var inner = 0; inner < ${Q}; inner++) {
            BCached[inner] = mm_Bsub[k][localCol + inner * ${i[0]}];
          }
          for (var innerRow = 0; innerRow < ${G}; innerRow++) {
            let ACached = ${o?`mm_Asub[k][localRow + innerRow * ${i[1]}];`:`mm_Asub[localRow + innerRow * ${i[1]}][k];`}
            for (var innerCol = 0; innerCol < ${Q}; innerCol++) {
              acc[innerRow][innerCol] =
                  fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);
            }
          }
        }
        workgroupBarrier();
      }
      for (var innerRow = 0; innerRow < ${G}; innerRow++) {
        let gRow = globalRowStart + localRow + innerRow * ${i[1]};
        for (var innerCol = 0; innerCol < ${Q}; innerCol++) {
          let gCol = globalColStart + localCol + innerCol * ${i[0]};
          mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
        }
      }
      `:`
  let tileRow = i32(localId.y) * ${G};
  let tileCol = i32(localId.x) * ${Q};

  let globalRow = i32(globalId.y) * ${G};
  let globalCol = i32(globalId.x) * ${Q};
  let globalRowStart = i32(workgroupId.y) * ${C};

  let tileRowA = i32(localId.y) * ${M};
  let tileColA = i32(localId.x) * ${$};
  let tileRowB = i32(localId.y) * ${V};
  // Loop over shared dimension.
  for (var t = 0; t < numTiles; t++) {
    // Load one tile of A into local memory.
    for (var innerRow = 0; innerRow < ${M}; innerRow++) {
      for (var innerCol = 0; innerCol < ${$}; innerCol++) {
        let inputRow = tileRowA + innerRow;
        let inputCol = tileColA + innerCol;
        ${GQ(o)}
      }
    }

    // Load one tile of B into local memory.
    for (var innerRow = 0; innerRow < ${V}; innerRow++) {
      for (var innerCol = 0; innerCol < ${Q}; innerCol++) {
        let inputRow = tileRowB + innerRow;
        let inputCol = tileCol + innerCol;
        mm_Bsub[inputRow][inputCol] = mm_readB(batchB,
          kStart + inputRow,
          globalCol + innerCol);
      }
    }
    kStart = kStart + ${u};
    workgroupBarrier();

    // Compute acc values for a single thread.
    var BCached : array<f32, ${Q}>;
    for (var k = 0; k < ${u}; k++) {
      for (var inner = 0; inner < ${Q}; inner++) {
        BCached[inner] = mm_Bsub[k][tileCol + inner];
      }

      for (var innerRow = 0; innerRow < ${G}; innerRow++) {
        ${(it=>it?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];")(o)}
        for (var innerCol = 0; innerCol < ${Q}; innerCol++) {
          acc[innerRow][innerCol] =
              fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);
        }
      }
    }

    workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < ${G}; innerRow++) {
    for (var innerCol = 0; innerCol < ${Q}; innerCol++) {
      mm_write(batch, globalRow + innerRow, globalCol + innerCol,
          acc[innerRow][innerCol]);
    }
  }
  `;return`
    var<workgroup> mm_Asub : array<array<f32, ${x}>, ${A}>;
    var<workgroup> mm_Bsub : array<array<f32, ${T}>, ${u}>;

    ${Gr()} {
      let batch = ${c?"0":"i32(globalId.z)"};
      let batchA = ${c||!w?"batch":"batch % uniforms.aShape[0]"};
      let batchB = ${c||!w?"batch":"batch % uniforms.bShape[0]"};
      let numTiles = ${c?`${Math.ceil(f/u)}`:`(uniforms.dimInner - 1) / ${u} + 1`};
      var kStart = ${c?`i32(globalId.z) * ${f}`:"0"};

      var acc : array<array<f32, ${Q}>, ${G}>;

      // Without this initialization strange values show up in acc.
      for (var innerRow = 0; innerRow < ${G}; innerRow++) {
        for (var innerCol = 0; innerCol < ${Q}; innerCol++) {
          acc[innerRow][innerCol] = 0.0;
        }
      }
      ${nt}
    }
  `}class Mft{constructor(i,o,u=!1,c=!1,f=null,y=null,w=null,C=!1){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=o,this.dispatchLayout={x:[2],y:[1],z:[0]};let T=u?i[1]:i[2];if(this.isVec4=(T%4==0&&!u||o[1]%4==0&&u)&&o[2]%4==0&&!c,this.outputComponent=this.isVec4?4:1,this.isVectorA=o[1]===1&&!u,!this.isVec4&&this.isVectorA)this.elementsPerThread=[1,1,1],this.workgroupSize=[32,1,1];else{let M=function($,V,G,Q=!1){let nt=[8,8,1],it=[4,4,1];return Q||($<=8&&(it[1]=1),V<=16&&G<=16&&(nt[0]=4)),{workgroupSize:nt,elementsPerThread:it}}(o[1],T,o[2],u);this.workgroupSize=M.workgroupSize,this.elementsPerThread=M.elementsPerThread}this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread);let x=f!=null,A=w!=null;x&&this.variableNames.push("bias"),A&&this.variableNames.push("preluActivationWeights"),this.sequentialAccessByThreads=C,this.transposeA=u,this.transposeB=c,this.addBias=x,this.activation=y,this.hasPreluActivationWeights=A,[this.fitAOuter,this.fitBOuter,this.fitInner]=this.getShapeFit(o[1],o[2],T),this.shaderKey=`matMulPacked_${this.elementsPerThread}_${u}_${c}_${this.activation}_${this.fitAOuter}_${this.fitBOuter}_${this.fitInner}_${this.isVec4}_${this.isVectorA}_${this.sequentialAccessByThreads}`}getShapeFit(i,o,u){let c=this.workgroupSize[1]*this.elementsPerThread[1],f=this.workgroupSize[0]*this.elementsPerThread[0];return!this.isVec4&&this.isVectorA?this.tileInner=4*this.workgroupSize[0]:this.tileInner=f,[i%c==0,o%f==0,u%this.tileInner==0]}getUserCode(){return`
      ${D0(this.activation,this.hasPreluActivationWeights,this.isVec4)}
      ${JI(this.addBias,this.activation,!1,this.transposeB,this.fitAOuter,this.fitBOuter,this.fitInner,this.isVec4?4:1)}
      ${this.isVec4?l1(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,!0):this.isVectorA?function(i,o=!1){m.util.assert(i[1]===1&&i[2]===1,()=>`A linear work group size is required. But got ${i}.`);let u=4*i[0];return`
    var<workgroup> mm_Asub : array<vec4<f32>, ${i[0]}>;

    ${Gr()} {
      let tileCol = i32(localId.x);
      let globalCol = i32(globalId.x);
      let globalRow = i32(globalId.y);

      let numTiles = (uniforms.dimInner - 1) / ${u} + 1;
      let batch = i32(globalId.z);
      let batchA = batch % uniforms.aShape[0];
      let batchB = batch % uniforms.bShape[0];
      // Without this initialization strange values show up in acc.
      var acc = 0.0;

      // Loop over shared dimension.
      for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        let colA = t * ${u} + tileCol * 4;
        mm_Asub[tileCol] = vec4<f32>(${c=o,c?`
      mm_readA(batchA, colA, globalRow),
      mm_readA(batchA, colA + 1, globalRow),
      mm_readA(batchA, colA + 2, globalRow),
      mm_readA(batchA, colA + 3, globalRow)
  `:`
      mm_readA(batchA, globalRow, colA),
      mm_readA(batchA, globalRow, colA + 1),
      mm_readA(batchA, globalRow, colA + 2),
      mm_readA(batchA, globalRow, colA + 3)
  `});
        workgroupBarrier();

        // Compute acc values for a single thread.
        for (var k = 0; k < ${u/4}; k++) {
          let rowB = t * ${u} + k * 4;
          let BCached = vec4<f32>(mm_readB(batchB, rowB, globalCol),
                              mm_readB(batchB, rowB + 1, globalCol),
                              mm_readB(batchB, rowB + 2, globalCol),
                              mm_readB(batchB, rowB + 3, globalCol));

          let ACached = mm_Asub[k];
          acc = acc + dot(ACached, BCached);
        }

        workgroupBarrier();
      }

      mm_write(batch, globalRow, globalCol, acc);
    }
  `;var c}(this.workgroupSize,this.transposeA):t7(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,this.sequentialAccessByThreads,!0)}
    `}}class Dft{constructor(i,o=!1,u=!1,c=null,f=null,y=null){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[256,1,1],this.outputShape=i,this.dispatchLayout={x:[],y:[1,2],z:[0]},this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize);let w=c!=null,C=y!=null;w&&this.variableNames.push("bias"),C&&this.variableNames.push("preluActivationWeights"),this.transposeA=o,this.transposeB=u,this.addBias=w,this.activation=f,this.hasPreluActivationWeights=C,this.shaderKey=`matMulReduce_${this.activation}_${o}_${u}`}getUserCode(){var i;return`
      ${D0(this.activation,this.hasPreluActivationWeights)}
      ${JI(this.addBias,this.activation,this.transposeA,this.transposeB)}
      ${i=this.workgroupSize[0],`
    var<workgroup> sumValues : array<f32, ${i}>;
    ${Gr()} {
      let coords = getOutputCoords();
      let batch = coords[0];
      let batchA = batch % uniforms.aShape[0];
      let batchB = batch % uniforms.bShape[0];
      let row = coords[1];
      let col = coords[2];
      var sum = 0.0;
      let Length = uniforms.dimInner;
      for (var k = i32(localId.x); k < Length; k = k + ${i}) {
        let dataA = mm_readA(batchA, row, k);
        let dataB = mm_readB(batchB, k, col);
        sum = sum + dataA * dataB;
      }
      sumValues[localId.x] = sum;
      workgroupBarrier();

      for(var currentSize = ${i/2}u; currentSize > 1u;
          currentSize = currentSize / 2u) {
        if (localId.x < currentSize)
        {
          sumValues[localId.x] = sumValues[localId.x] + sumValues[localId.x + currentSize];
        }
        workgroupBarrier();
      }

      if (localId.x == 0u) {
        sum = sumValues[0] + sumValues[1];
        mm_write(batch, row, col, sum);
      }
    }
  `}
    `}}class Rft{constructor(i,o,u,c=!1,f=!1,y=null,w=null,C=null){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[16,8,1],this.outputShape=u,this.dispatchLayout={x:[2],y:[1],z:[0]},this.dispatch=[Math.ceil(u[2]/this.workgroupSize[0]),Math.ceil(u[1]/this.workgroupSize[1]),u[0]];let T=y!=null;T&&this.variableNames.push("bias");let x=C!=null;x&&this.variableNames.push("preluActivationWeights"),this.transposeA=c,this.transposeB=f,this.addBias=T,this.activation=w,this.hasPreluActivationWeights=x,this.shaderKey=`matMulSmallOutputSize_${this.activation}_${c}_${f}`}getUserCode(){return`
      ${D0(this.activation,this.hasPreluActivationWeights)}
      ${JI(this.addBias,this.activation,this.transposeA,this.transposeB)}
      ${function(i){let o=i[1],u=i[0],c=o>u?o:u;return`
  var<workgroup> mm_Asub : array<array<f32, ${c}>, ${o}>;
  var<workgroup> mm_Bsub : array<array<f32, ${u}>, ${c}>;

  // If the output size is small for matrix multiplication, avoid to use vec4
  // and handle some elements per thread to optimally utilize the ALU.
  // Read data from global memory to registers firstly, then store them into
  // shared memory, so it is instruction-Level parallelism for arithmetic
  // operations and others handle IO operations between barrier api, makes ALU
  // and load/store units work simultaneously, could improves the performance.
  ${Gr()} {
    let tileRow = i32(localId.y);
    let tileCol = i32(localId.x);
    let globalRow = i32(globalId.y);
    let globalCol = i32(globalId.x);
    let batch = i32(globalId.z);
    let batchA = batch % uniforms.aShape[0];
    let batchB = batch % uniforms.bShape[0];

    // uniforms.dimInner should be greater than 0.
    let numTiles = (uniforms.dimInner - 1) / ${c} + 1;
    var acc = 0.0;

    var globalColA = tileCol;
    var globalRowB = 0;
    var regA = mm_readA(batchA, globalRow, globalColA);
    var regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);
    var regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);
    globalColA = globalColA + ${c};
    globalRowB = globalRowB + ${c};

    for (var t = 0; t < numTiles; t = t + 1) {
      mm_Asub[tileRow][tileCol] = regA;
      mm_Bsub[2 * tileRow][tileCol] = regB0;
      mm_Bsub[2 * tileRow + 1][tileCol] = regB1;

      workgroupBarrier();

      regA = mm_readA(batchA, globalRow, globalColA);
      regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);
      regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);
      globalColA = globalColA + ${c};
      globalRowB = globalRowB + ${c};

      for (var k = 0; k < ${c}; k = k + 1) {
        acc = acc + mm_Asub[tileRow][k] * mm_Bsub[k][tileCol];
      }
      workgroupBarrier();
    }

    mm_write(batch, globalRow, globalCol, acc);
  }
  `}(this.workgroupSize)}
    `}}class Fft{constructor(i,o,u=!1,c=!1){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[8,8,1],this.atomic=!0,this.splitedDimInner=128,m.util.assert(i[0]===1,()=>"MatMulSplitKProgram only supports batch = 1."),this.outputShape=i,this.dispatchLayout={x:[2],y:[1],z:[0,3]};let f=(u&&this.outputShape[1]%4==0||!u&&o%4==0)&&this.outputShape[2]%4==0;this.elementsPerThread=[4,4,this.splitedDimInner],this.outputComponent=f?4:1,f||(this.outputShape[1]<16&&(this.elementsPerThread[1]=1),this.outputShape[2]<16&&(this.elementsPerThread[0]=1)),this.dispatch=Nr(this.dispatchLayout,[this.outputShape[0],this.outputShape[1],this.outputShape[2],o],this.workgroupSize,this.elementsPerThread),this.transposeA=u,this.transposeB=c,this.shaderKey=`matMulSplitK_${u}_${c}_${this.elementsPerThread}_${this.outputComponent}`}getUserCode(){let i=this.outputComponent;return`
      ${VQ(!1,this.transposeB,!1,!1,!1,i)}
      fn mm_write(batch: i32, row : i32, col : i32, value : ${ro(i)}) {
        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {
          let coords = vec3<i32>(batch, row, col);
          let flatIndex = getOutputIndexFromCoords(coords);
          // The problem is that we should initialize output to zero before using.
          // Otherwise, the original value will be added to the result.
          for (var i = 0; i < ${i}; i = i + 1) {
            ${o1("&result[flatIndex + i]",i>1?"value[i]":"value","float32")}
          }
        }
      }
      ${i===4?l1(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner):t7(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner)}
    `}}class Oft{constructor(i,o=null,u=null,c=null){this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=o!=null,this.hasPreluActivationWeights=c!=null,this.activation=u,this.addBias&&this.variableNames.push("bias"),this.hasPreluActivationWeights&&this.variableNames.push("preluActivationWeights"),this.shaderKey=`biasActivation_${u}`}getUserCode(){return`
    ${D0(this.activation,this.hasPreluActivationWeights)}
    ${Gr("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        var value = getXByOutputIndex(index);
        ${u1(this.addBias,this.activation)}
        setOutputAtIndex(index, value);
      }
    }
    `}}class Lft{constructor(i){this.variableNames=[],this.outputShape=[],this.uniforms="value : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="fill"}getUserCode(){return`
    ${Gr("index")} {
      if (index < uniforms.size) {
        setOutputAtIndex(index, uniforms.value);
      }
    }
  `}}function Qc(l){let{backend:i,attrs:o}=l,{shape:u,value:c}=o,{dtype:f}=o;if(f=f||m.util.inferDtype(c),f==="string"){let y=m.util.getArrayFromDType(f,m.util.sizeFromShape(u));return y.fill(c),i.makeTensorInfo(u,f,y)}{let y=new Lft(u),w=[{type:"float32",data:[c]}];return i.runWebGPUProgram(y,[],f,w)}}let tP={kernelName:m.Fill,backendName:"webgpu",kernelFunc:Qc};function zi(l){let{inputs:i,attrs:o}=l,{x:u}=i,{shape:c}=o,f=m.util.sizeFromShape(u.shape),y=m.util.inferFromImplicitShape(c,f),w=m.util.sizeFromShape(y);return m.util.assert(f===w,()=>`The new shape (${y}) has ${w} elements and the old shape (${u.shape}) has ${f} elements. The new shape and old shape must have the same number of elements.`),l.backend.incRef(u.dataId),{dataId:u.dataId,shape:y,dtype:u.dtype}}let $ft={kernelName:m.Reshape,backendName:"webgpu",kernelFunc:zi};function e7({a:l,b:i,transposeA:o,transposeB:u,backend:c,bias:f=null,preluActivationWeights:y=null,leakyreluAlpha:w=0,activation:C=null}){let T=l.shape.length,x=i.shape.length,A=o?l.shape[T-2]:l.shape[T-1],M=u?i.shape[x-1]:i.shape[x-2],$=o?l.shape[T-1]:l.shape[T-2],V=u?i.shape[x-2]:i.shape[x-1],G=l.shape.slice(0,-2),Q=i.shape.slice(0,-2),nt=m.util.sizeFromShape(G),it=m.util.sizeFromShape(Q),ht=m.broadcast_util.assertAndGetBroadcastShape(l.shape.slice(0,-2),i.shape.slice(0,-2)).concat([$,V]);m.util.assert(A===M,()=>`Error in matMul: inner shapes (${A}) and (${M}) of Tensors with shapes ${l.shape} and ${i.shape} and transposeA=${o} and transposeB=${u} must match.`);let kt=o?[nt,A,$]:[nt,$,A],Nt=u?[it,V,M]:[it,M,V],$t=zi({inputs:{x:l},backend:c,attrs:{shape:kt}}),Ut=zi({inputs:{x:i},backend:c,attrs:{shape:Nt}}),Pt=[$t,Ut],re=Math.max(nt,it),ue=[$t,Ut],be=[{type:"int32",data:[$]},{type:"int32",data:[V]},{type:"int32",data:[A]}],De,ze,Qe=[re,$,V],cn=(0,m.env)().get("WEBGPU_MATMUL_PROGRAM_TYPE");if(cn<0){let sn=(0,m.env)().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),xn=sn>0?sn:c.thresholdToIncreaseWorkgroups,Rn=re*Math.ceil($/32)*Math.ceil(V/32);cn=Rn<=xn||$<=8&&Rn<=2*xn?re*$*V<=128?jm.MatMulReduceProgram:re===1&&M>=2e3?jm.MatMulSplitKProgram:jm.MatMulSmallOutputSizeProgram:jm.MatMulPackedProgram}switch(cn){case jm.MatMulReduceProgram:De=new Dft(Qe,o,u,f,C,y);break;case jm.MatMulSplitKProgram:if(ze=Qc({backend:c,attrs:{shape:Qe,value:0,dtype:l.dtype}}),De=new Fft(Qe,M,o,u),f||C){ze=c.runWebGPUProgram(De,ue,l.dtype,be,ze);let xn=new Oft(ze.shape,f,C,y),Rn=null,Bn=[ze];f&&Bn.push(f),y&&Bn.push(y),C==="leakyrelu"&&(Rn=[{type:"float32",data:[w]}],xn.uniforms+=" alpha : f32,");let Fn=c.runWebGPUProgram(xn,Bn,ze.dtype,Rn);Pt.push(ze);let Xn=zi({inputs:{x:Fn},backend:c,attrs:{shape:ht}});Pt.push(Fn);for(let Nn of Pt)c.disposeData(Nn.dataId);return Xn}break;case jm.MatMulSmallOutputSizeProgram:De=new Rft(kt,Nt,Qe,o,u,f,C,y);break;case jm.MatMulPackedProgram:let sn=c.adapterInfo.isIntel();De=new Mft(kt,Qe,o,u,f,C,y,sn);break;default:throw new Error(`Unsupported MatMulProgramType ${cn}.`)}f&&ue.push(f),y&&ue.push(y),C==="leakyrelu"&&(be.push({type:"float32",data:[w]}),De.uniforms+=" alpha : f32,"),ze=c.runWebGPUProgram(De,ue,l.dtype,be,ze);let en=zi({inputs:{x:ze},backend:c,attrs:{shape:ht}});Pt.push(ze);for(let sn of Pt)c.disposeData(sn.dataId);return en}let HQ={kernelName:m._FusedMatMul,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{a:c,b:f,bias:y,preluActivationWeights:w}=i,{transposeA:C,transposeB:T,activation:x,leakyreluAlpha:A}=u;return e7({a:c,b:f,transposeA:C,transposeB:T,backend:o,bias:y,preluActivationWeights:w,leakyreluAlpha:A,activation:x})}};class YQ{constructor(i,o,u){this.variableNames=["AReal","AImag","BReal","BImag"],this.workgroupSize=[128,1,1],this.size=!0,this.outputShape=m.backend_util.assertAndGetBroadcastShape(o,u),this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`binaryOpComplex_${i}`,this.op=i}getUserCode(){return`
      fn binaryOpComplex(
          areal : f32, aimag : f32, breal : f32, bimag : f32) -> f32 {
        ${y6(this.op,!1)}
      }

      ${Gr("index")} {
        if(index < uniforms.size) {
          let areal = getARealByOutputIndex(index);
          let aimag = getAImagByOutputIndex(index);
          let breal = getBRealByOutputIndex(index);
          let bimag = getBImagByOutputIndex(index);
          setOutputAtIndex(index, binaryOpComplex(areal, aimag, breal, bimag));
        }
      }
    `}}class n7{constructor(i,o,u){if(this.size=!0,this.variableNames=["A","B"],this.outputShape=m.backend_util.assertAndGetBroadcastShape(o,u),this.dispatchLayout=hi(this.outputShape),this.op=i,this.useSharedMemoryWithA=o.length<=1&&u.length>1&&o[0]<128,this.useSharedMemoryWithB=u.length<=1&&o.length>1&&u[0]<128,this.useSharedMemoryWithA||this.useSharedMemoryWithB)this.outputComponent=1,this.variableComponents=[1,1],this.lastDimensionSize=this.useSharedMemoryWithB?u[0]:o[0],this.shaderKey=`binary_${i}_${this.lastDimensionSize}`,this.type="shared",this.workgroupSize=[256,1,1];else{let c=o.length>0&&o[o.length-1]%4==0,f=u.length>0&&u[u.length-1]%4==0;c&&f?(this.outputComponent=4,this.variableComponents=[4,4]):c&&(m.util.isScalarShape(u)||u[u.length-1]===1)||f&&(m.util.isScalarShape(o)||o[o.length-1]===1)?(this.outputComponent=4,this.variableComponents=c?[4,1]:[1,4]):(this.outputComponent=1,this.variableComponents=[1,1]),this.type="nonshared",this.shaderKey=`binary_${i}_${this.variableComponents}`,this.workgroupSize=[128,1,1]}this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.outputComponent,1,1])}getUserCode(){let i,o=this.outputComponent===4?"vec4<f32>":"f32",u=`
    fn binaryOperation(a : ${o}, b : ${o}) -> ${o} {
      ${y6(this.op,this.outputComponent===4)}
    };
    `;if(this.type==="shared"){let c=this.lastDimensionSize>1?`coords[${this.outputShape.length-1}]`:"0",f=this.useSharedMemoryWithB?`let a = getAByOutputIndex(index);
          let b = sharedBuf[${c}];`:`let a = sharedBuf[${c}];
          let b = getBByOutputIndex(index);`;i=`
        ${u}
        var<workgroup> sharedBuf : array<f32, ${this.lastDimensionSize}>;
        ${Gr("index")} {
          // Fill in the shared memory buffer.
          let localIndex = i32(localId.x);
          if(localIndex < ${this.lastDimensionSize}) {
            sharedBuf[localIndex] = f32(${this.useSharedMemoryWithB?"B":"A"}[localIndex]);
          }
          workgroupBarrier();

          if(index < uniforms.size) {
            let coords = getCoordsFromIndex(index);
            ${f}
            setOutputAtIndex(index, binaryOperation(a, b));
          }
        }
        `}else i=`
       ${u}
       ${Gr("index")} {
         if (index < uniforms.size) {
           let coords = getCoordsFromIndex(index * ${this.outputComponent});
           let a = ${o}(getAByOutputCoords(coords));
           let b = ${o}(getBByOutputCoords(coords));
           setOutputAtIndex(index, binaryOperation(a, b));
         }
       }
       `;return i}}function Hd(l){let{inputs:i}=l,{x:o}=i;return l.backend.incRef(o.dataId),{dataId:o.dataId,shape:o.shape,dtype:o.dtype}}let zft={kernelName:m.Identity,backendName:"webgpu",kernelFunc:Hd};function $b(l){let{inputs:i,backend:o}=l,{real:u,imag:c}=i,f=o.makeTensorInfo(u.shape,"complex64"),y=o.tensorMap.get(f.dataId),w=Hd({inputs:{x:u},backend:o}),C=Hd({inputs:{x:c},backend:o});return y.complexTensorInfos={real:w,imag:C},f}let Pft={kernelName:m.Complex,backendName:"webgpu",kernelFunc:$b};class h4{constructor(i,o,u=""){this.variableNames=["A"],this.size=!0,this.workgroupSize=[128,1,1],this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.op=o,u!==""&&(this.uniforms=u),this.shaderKey=`unary_${o}`}getUserCode(){return`
      fn unaryOperation(a : f32) -> f32 {
        ${Q2(this.op,!1)}
      }
      ${Gr("index")} {
        if (index < uniforms.size) {
          let a = getAByOutputIndex(index);
          setOutputAtIndex(index, unaryOperation(a));
        }
      }
      `}}function go({opType:l,cpuKernelImpl:i,dtype:o}){return({inputs:u,backend:c})=>{let{x:f}=u,y=c,w=o||f.dtype;if(y.shouldExecuteOnCPU([f])&&i!=null){let T=y.tensorMap.get(f.dataId),x=i(T.values,w);return y.makeTensorInfo(f.shape,w,x)}let C=new h4(f.shape,l);return y.runWebGPUProgram(C,[f],w)}}function Dl({opType:l,cpuKernelImpl:i,supportsComplex:o=!1,dtype:u}){return({inputs:c,backend:f})=>{let{a:y,b:w}=c,C=f;if(o&&y.dtype==="complex64"){let A=C.tensorMap.get(y.dataId),M=C.tensorMap.get(w.dataId),$,V;if(l!==Ma.MUL)[$,V]=[[A.complexTensorInfos.real,M.complexTensorInfos.real],[A.complexTensorInfos.imag,M.complexTensorInfos.imag]].map(Q=>{let[nt,it]=Q,ht={dataId:nt.dataId,dtype:nt.dtype,shape:y.shape},kt={dataId:it.dataId,dtype:it.dtype,shape:w.shape},Nt=new n7(l,y.shape,w.shape);return C.runWebGPUProgram(Nt,[ht,kt],(0,m.upcastType)(nt.dtype,it.dtype))});else{let Q=new YQ(Ma.COMPLEX_MULTIPLY_REAL,y.shape,w.shape),nt=new YQ(Ma.COMPLEX_MULTIPLY_IMAG,y.shape,w.shape),it=[{dataId:A.complexTensorInfos.real.dataId,dtype:A.complexTensorInfos.real.dtype,shape:y.shape},{dataId:A.complexTensorInfos.imag.dataId,dtype:A.complexTensorInfos.imag.dtype,shape:y.shape},{dataId:M.complexTensorInfos.real.dataId,dtype:M.complexTensorInfos.real.dtype,shape:w.shape},{dataId:M.complexTensorInfos.imag.dataId,dtype:M.complexTensorInfos.imag.dtype,shape:w.shape}];$=C.runWebGPUProgram(Q,it,"float32"),V=C.runWebGPUProgram(nt,it,"float32")}let G=$b({inputs:{real:$,imag:V},backend:C});return C.disposeData($.dataId),C.disposeData(V.dataId),G}let T=u||(0,m.upcastType)(y.dtype,w.dtype);if((y.dtype==="string"||w.dtype==="string"||C.shouldExecuteOnCPU([y,w]))&&i!=null){let A=C.tensorMap.get(y.dataId).values,M=C.tensorMap.get(w.dataId).values,$=y.dtype==="string"?m.backend_util.fromUint8ToStringArray(A):A,V=y.dtype==="string"?m.backend_util.fromUint8ToStringArray(M):M,[G,Q]=i(y.shape,w.shape,$,V,T);return C.makeTensorInfo(Q,T,G)}let x=new n7(l,y.shape,w.shape);return C.runWebGPUProgram(x,[y,w],T)}}let{addImpl:v6,castImpl:b6,ceilImpl:w6,concatImpl:Bft,equalImpl:qQ,expImpl:XQ,expm1Impl:x6,floorImpl:jft,floorDivImpl:d4,gatherNdImpl:Uft,gatherV2Impl:Wft,greaterEqualImpl:Vft,greaterImpl:R0,lessEqualImpl:Gft,lessImpl:KQ,logImpl:ZQ,maxImpl:QQ,maximumImpl:eP,minimumImpl:JQ,multiplyImpl:nP,negImpl:rP,notEqualImpl:Hft,prodImpl:tJ,rangeImpl:iP,rsqrtImpl:aP,scatterImpl:Yft,simpleAbsImpl:eJ,sliceImpl:oP,stridedSliceImpl:nJ,stringNGramsImpl:rJ,subImpl:Yd,tileImpl:qft,topKImpl:Xft,transposeImpl:k6}=Qt,S6=go({opType:zr.ABS,cpuKernelImpl:eJ}),_6={kernelName:m.Abs,backendName:"webgpu",kernelFunc:S6},C6=go({opType:zr.ACOS}),E6={kernelName:m.Acos,backendName:"webgpu",kernelFunc:C6},r7=go({opType:zr.ACOSH}),sP={kernelName:m.Acosh,backendName:"webgpu",kernelFunc:r7},T6=Dl({opType:Ma.ADD,cpuKernelImpl:v6,supportsComplex:!0}),A6={kernelName:m.Add,backendName:"webgpu",kernelFunc:T6};class I6{constructor(i){this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i[0],this.variableNames=i.map((o,u)=>`T${u}`),this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="addN"}getUserCode(){let i=[];this.variableNames.forEach(u=>{i.push(`let v${u} = get${u}ByOutputCoords(coords);`)});let o=this.variableNames.map(u=>`v${u}`).join(" + ");return`
      ${Gr("index")} {
        for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if (flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            ${i.join(`
        `)}
            setOutputAtIndex(flatIndex, ${o});
          }
        }
      }
    `}}let i7={kernelName:m.AddN,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,u=i;if(u.length===1)return Hd({inputs:{x:u[0]},backend:o});let c=u.map(w=>w.dtype).reduce((w,C)=>(0,m.upcastType)(w,C)),f=u.map(w=>w.shape),y=new I6(f);return o.runWebGPUProgram(y,u,c)}};class Kft{constructor(i,o){this.variableNames=["A"],this.workgroupSize=[16,16,1];let u=new Array(i.length);for(let c=0;c<u.length;c++)u[c]=i[o[c]];this.outputShape=u,this.dispatchLayout={x:[0],y:[1]},this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize,[1,1,1]),this.shaderKey="transposeShared"}getUserCode(){m.util.assert(this.workgroupSize[0]===this.workgroupSize[1],()=>`Must be a square tile, current tile shape is ${this.workgroupSize[0]} x ${this.workgroupSize[1]}`);let i=this.workgroupSize[0];return`
      var<workgroup> tile : array<array<f32, ${this.workgroupSize[0]+1}>, ${this.workgroupSize[0]}>;
      ${Gr()} {
        var x = i32(workgroupId.x) * ${i} + i32(localId.x);
        var y = i32(workgroupId.y) * ${i} + i32(localId.y);
        let width = uniforms.outShape[0];
        let height = uniforms.outShape[1];
        if (x < width && y < height) {
          tile[localId.y][localId.x] = f32(A[y * width + x]);
        }
        workgroupBarrier();

        x = i32(workgroupId.y) * ${i} + i32(localId.x);
        y = i32(workgroupId.x) * ${i} + i32(localId.y);
        if (x < height && y < width) {
          setOutputAtIndex((y * height + x), tile[localId.x]
            [localId.y]);
        }
      }
    `}}class Zft{constructor(i,o){this.variableNames=["A"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0;let u=new Array(i.length);for(let c=0;c<u.length;c++)u[c]=i[o[c]];this.outputShape=u,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.newDim=o,this.shaderKey=`transpose_${o}`}getUserCode(){let i=ol(this.outputShape.length),o=iJ(this.newDim);return`
      ${Gr("index")} {
        for(var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if(flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            setOutputAtIndex(flatIndex, A[getIndexFromCoords${this.outputShape.length}D(
              ${i}(${o}), uniforms.aShape)]);
          }
        }
      }
    `}}function iJ(l){let i=l.length;if(i>6)throw Error(`Transpose for rank ${i} is not yet supported`);let o=new Array(i);for(let u=0;u<l.length;u++)o[l[u]]=`coords.${s1(u)}`;return o.join()}function Um(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{perm:f}=u,y=o,w=c.shape.length,C=new Array(w);for(let x=0;x<C.length;x++)C[x]=c.shape[f[x]];if(o.shouldExecuteOnCPU([c])){let x=y.tensorMap.get(c.dataId).values,A=k6(x,c.shape,c.dtype,f,C);return o.makeTensorInfo(C,c.dtype,A)}if(c.shape.length===2&&m.util.arraysEqual(f,[1,0])){let x=new Kft(c.shape,f);return y.runWebGPUProgram(x,[c],c.dtype)}let T=new Zft(c.shape,f);return y.runWebGPUProgram(T,[c],c.dtype)}let a7={kernelName:m.Transpose,backendName:"webgpu",kernelFunc:Um};class uP{constructor(i,o,u){this.variableNames=["x"],this.uniforms="reduceSize : i32,",this.size=!0,this.inputShape=[i.batchSize,i.inSize];let[c]=m.backend_util.computeOutAndReduceShapes(this.inputShape,[1]);this.outputShape=c.length===0?[1]:c,i.inSize>=32768&&u>=512?this.workgroupSize=[512,1,1]:i.inSize>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,[1,1,1]),this.reduceType=o,this.shaderKey=`reduce_${o}`}getUserCode(){let i="",o="0.0",u=this.workgroupSize[0];this.reduceType==="min"||this.reduceType==="max"?(i=`
         if (isnan(candidate)) {
          bestValue = uniforms.NAN;
         } else if (!isnan(bestValue) && candidate ${this.reduceType==="min"?"<":">"} bestValue)
           {  bestValue = candidate; }`,o="f32(x[offset])"):this.reduceType==="sum"||this.reduceType==="mean"?i=" bestValue = bestValue + candidate; ":this.reduceType==="prod"?(i=" bestValue = bestValue * candidate; ",o="1.0"):this.reduceType==="all"?(i=" bestValue = f32(bestValue >= 1.0 && candidate >= 1.0); ",o="1.0"):this.reduceType==="any"&&(i=" bestValue = f32(bestValue >= 1.0 || candidate >= 1.0); ",o="0.0");let c=this.reduceType==="mean"?"setOutputAtIndex(outputIndex, bestValue / f32(uniforms.reduceSize));":"setOutputAtIndex(outputIndex, bestValue);";return`
       fn DIV_CEIL(a : u32, b : u32) -> u32 {
        return ((a - 1u) / b + 1u);
       }

       ${`
         var<workgroup> xBestValues : array<f32, ${u}>;
       `}
       fn getOffset(outputIndex : i32) -> i32 {
         let outputCoords = getCoordsFromIndex(outputIndex);
         let offset = ${this.outputShape.length===1?"outputCoords":"outputCoords[0]"} * uniforms.reduceSize;
          return offset;
       }
       ${Gr("index")} {
         let outputIndex = index / ${u};
         let offset = getOffset(outputIndex);
         var bestValue = ${o};
         let Length = uniforms.reduceSize;
         let WorkPerThread = DIV_CEIL(u32(Length), ${u}u);
         for (var k = i32(localId.x); k < Length && outputIndex < uniforms.size;
             k = k + ${u}) {
           let candidate = f32(x[offset + k]);
           ${i}
         }
         xBestValues[localId.x] = bestValue;
         workgroupBarrier();

         var reduceSize = min(u32(Length), ${u}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (localId.x < currentSize) {
            let candidate = xBestValues[localId.x + interval];
            ${i}
            xBestValues[localId.x] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (localId.x == 0u && outputIndex < uniforms.size) {
          ${c}
        }
       }
     `}}let aJ={mean:"float32",all:"bool",any:"bool"};function J2(l,i,o,u,c){let f=l.shape.length,y=[],w=m.util.parseAxisParam(i,l.shape),C=w,T=m.backend_util.getAxesPermutation(C,f),x=l;T!=null&&(x=Um({inputs:{x:l},attrs:{perm:T},backend:c}),C=m.backend_util.getInnerMostAxes(C.length,f),y.push(x)),m.backend_util.assertAxesAreInnerMostDims(u,C,f);let[A,M]=m.backend_util.computeOutAndReduceShapes(x.shape,C),$,V=A;if(o&&(V=m.backend_util.expandShapeToKeepDim(A,w)),u!=="max"&&u!=="prod"||!c.shouldExecuteOnCPU([x])){let G=m.util.sizeFromShape(M),Q={windowSize:G,inSize:G,batchSize:m.util.sizeFromShape(x.shape)/G,outSize:1},nt=aJ[u]||(0,m.sumOutType)(l.dtype),it=[{type:"int32",data:[G]}],ht=new uP(Q,u,c.device.limits.maxComputeWorkgroupSizeX),kt=c.runWebGPUProgram(ht,[x],nt,it);y.push(kt),$=zi({inputs:{x:kt},attrs:{shape:V},backend:c})}else{let G=c.tensorMap.get(x.dataId).values;switch(u){case"max":let Q=QQ(G,m.util.sizeFromShape(M),V,l.dtype);$=c.makeTensorInfo(V,l.dtype,Q);break;case"prod":let{outVals:nt,outShape:it,outDtype:ht}=tJ(x.shape,x.dtype,G,C);$=c.makeTensorInfo(it,ht,nt);break;default:throw new Error(`${u} CPU implementation is not yet supported.`)}}return y.forEach(G=>c.disposeData(G.dataId)),$}let Qft={kernelName:m.All,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{keepDims:f,axis:y}=u;return J2(c,y,f,"all",o)}},Jft={kernelName:m.Any,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{keepDims:f,axis:y}=u;return J2(c,y,f,"any",o)}};class oJ{constructor(i,o,u){this.workgroupSize=[64,1,1],this.variableNames=["x"],this.uniforms="infinityValue : f32,",this.size=!0;let c=[o];this.op=u==="min"?"<":">";let[f,y]=m.backend_util.computeOutAndReduceShapes(i,c);this.outputShape=f.length===0?[1]:f,this.dispatchLayout=hi(this.outputShape),m.util.sizeFromShape(y)<32?(this.type="plain",this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize)):(this.type="shared",this.dispatch=Nr(this.dispatchLayout,this.outputShape,[1,1,1])),this.inputShape=i,this.shaderKey=`argMinMax_${this.op}_${this.type}`}getUserCode(){let i=this.workgroupSize[0],o=()=>this.inputShape.length===1?"uniforms.xShape":`uniforms.xShape.${s1(this.inputShape.length-1)}`,u=()=>{let c="";if(this.outputShape.length===1)this.inputShape.length!==1&&(c+="outputCoords,");else for(let f=0;f<this.outputShape.length;f++)c+=`outputCoords.${s1(f)},`;return c};return this.type==="shared"?`
      fn DIV_CEIL(a : u32, b : u32) -> u32 {
        return ((a - 1u) / b + 1u);
      }

      ${`
      var<workgroup> xBestIndices : array<i32, ${i}>;
      var<workgroup> xBestValues : array<f32, ${i}>;
    `}

      ${Gr("index")} {
        let outputIndex = index / ${i};
        let reduceLength = ${o()};

        var bestIndex = i32(localId.x);
        var bestValue = uniforms.infinityValue;
        let outputCoords = getCoordsFromIndex(outputIndex);
        for (var k = i32(localId.x); k < reduceLength && outputIndex < uniforms.size;
            k = k + ${i}) {
          let candidate = getX(${u()} k);
          if (!isnan(candidate) && candidate ${this.op} bestValue) {
            bestValue = candidate;
            bestIndex = k;
          }
        }
        xBestValues[localId.x] = bestValue;
        xBestIndices[localId.x] = bestIndex;
        workgroupBarrier();

        var reduceSize = min(u32(reduceLength), ${i}u);
        for (var currentSize = reduceSize / 2u; reduceSize > 1u;
            currentSize = reduceSize / 2u) {
          let interval = DIV_CEIL(reduceSize, 2u);
          if (localId.x < currentSize) {
            let candidate = xBestValues[localId.x + interval];
            if (candidate ${this.op} bestValue) {
              bestValue = candidate;
              xBestValues[localId.x] = bestValue;
              xBestIndices[localId.x] = xBestIndices[localId.x + interval];
            }
          }
          reduceSize = interval;
          workgroupBarrier();
        }

        if (localId.x == 0u && outputIndex < uniforms.size) {
          setOutputAtIndexI32(outputIndex, xBestIndices[localId.x]);
        }
      }
    `:`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let outputCoords = getCoordsFromIndex(index);
          var bestIndex = 0;
          var bestValue = getX(${u()} 0);
          let reduceLength = ${o()};
          for (var i = 1; i < reduceLength; i++) {
            let candidate = getX(${u()} i);
            if (candidate ${this.op} bestValue) {
              bestValue = candidate;
              bestIndex = i;
            }
          }
          setOutputAtIndexI32(index, bestIndex);
        }
      }
      `}}let tpt={kernelName:m.ArgMax,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f}=u,y=m.util.parseAxisParam(f,c.shape),w=m.backend_util.getAxesPermutation(y,c.shape.length),C=c,T=[];w!=null&&(C=Um({inputs:{x:c},backend:o,attrs:{perm:w}}),T.push(C),y=m.backend_util.getInnerMostAxes(y.length,C.shape.length)),m.backend_util.assertAxesAreInnerMostDims("argMax",[y[0]],C.shape.length);let x=new oJ(C.shape,y[0],"max"),A=[{type:"float32",data:[Number.NEGATIVE_INFINITY]}],M=o.runWebGPUProgram(x,[C],"int32",A);return T.forEach($=>o.disposeData($.dataId)),M}},ept={kernelName:m.ArgMin,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f}=u,y=m.util.parseAxisParam(f,c.shape),w=m.backend_util.getAxesPermutation(y,c.shape.length),C=c,T=[];w!=null&&(C=Um({inputs:{x:c},backend:o,attrs:{perm:w}}),T.push(C),y=m.backend_util.getInnerMostAxes(y.length,C.shape.length)),m.backend_util.assertAxesAreInnerMostDims("argMin",[y[0]],C.shape.length);let x=new oJ(C.shape,y[0],"min"),A=[{type:"float32",data:[Number.POSITIVE_INFINITY]}],M=o.runWebGPUProgram(x,[C],"int32",A);return T.forEach($=>o.disposeData($.dataId)),M}},npt=go({opType:zr.ASIN}),rpt={kernelName:m.Asin,backendName:"webgpu",kernelFunc:npt},ipt=go({opType:zr.ASINH}),apt={kernelName:m.Asinh,backendName:"webgpu",kernelFunc:ipt},opt=go({opType:zr.ATAN}),spt={kernelName:m.Atan,backendName:"webgpu",kernelFunc:opt},upt=Dl({opType:Ma.ATAN2}),lpt={kernelName:m.Atan2,backendName:"webgpu",kernelFunc:upt},cpt=go({opType:zr.ATANH}),sJ={kernelName:m.Atanh,backendName:"webgpu",kernelFunc:cpt};class lP{constructor(i){this.variableNames=["x"],this.uniforms="strides : vec2<i32>,",this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=i.outShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="poolWithFilterSizeEqualsOne"}getUserCode(){return`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let batch = coords[0];
          let d = coords[3];

          let xRCCorner = coords.yz * uniforms.strides;
          let xRCorner = xRCCorner.x;
          let xCCorner = xRCCorner.y;

          let value = getX(batch, xRCorner, xCCorner, d);
          setOutputAtIndex(index, value);
        }
      }
    `}}class ty{constructor(i,o,u=!1,c=!1,f=!1){if(this.variableNames=["x"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, convDims : vec2<i32>, filterDims : vec2<i32>,",this.workgroupSize=[128,1,1],this.size=!0,o==="avg"&&u)throw new Error("Cannot compute positions for average pool.");this.outputShape=i.outShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=o,this.computePositions=u,this.flattenPositions=c,this.includeBatchIndex=f,this.shaderKey=`pool2D_${o}_${u}_${c}_${f}`}getUserCode(){let i;this.poolType==="avg"?i="resultValue = resultValue + value; count = count + 1.0;":this.computePositions?i=`let currMaxValue = mix(value, maxValue, maxValueFound);
      if (value >= currMaxValue) {
        maxValue = value;
        maxValueFound = 1.0;
        maxPosition = ${this.flattenPositions?this.includeBatchIndex?"((batch * uniforms.xShape[1] + xR) * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"(xR * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"wR * uniforms.filterDims.y + wC"};
      }`:i="resultValue = max(value, resultValue);";let o="resultValue";return this.poolType==="avg"&&(o="resultValue / max(count, 1.0)"),`
      ${Gr("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
          let batch = coords[0];
          let d = coords[3];
          let xRCCorner = vec2<i32>(coords.yz) * uniforms.strides - uniforms.pads;
          let xRCorner = xRCCorner.x;
          let xCCorner = xRCCorner.y;

          ${this.computePositions?`var maxValue = 0.0;
            var maxValueFound = 0.0;
            var maxPosition = 0;`:`var resultValue = ${this.poolType==="avg"?"0.0":"-1.0 / pow(10.0, -20.0)"};`}

          var count = 0.0;
          for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + uniforms.dilations.x) {
            let xR = xRCorner + wR;

            if (xR < 0 || xR >= uniforms.convDims.x) {
              continue;
            }

            for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + uniforms.dilations.y) {
              let xC = xCCorner + wC;
              if (xC < 0 || xC >= uniforms.convDims.y) {
                continue;
              }

              let value = getX(batch, xR, xC, d);
              ${i}
            }
          }

          ${this.computePositions?"setOutputAtIndexI32(index, maxPosition);":`setOutputAtIndex(index, ${o});`}
        }
      }
    `}}class cP{constructor(i,o,u=!1,c=!1,f=!1){if(this.variableNames=["x"],this.uniforms="strides : vec3<i32>, pads : vec3<i32>, convDims : vec3<i32>, filterDims : vec3<i32>,",this.workgroupSize=[128,1,1],this.size=!0,o==="avg"&&u)throw new Error("Cannot compute positions for average pool.");this.outputShape=i.outShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=o,this.computePositions=u,this.flattenPositions=c,this.includeBatchIndex=f,this.shaderKey=`pool3D_${o}_${u}_${c}_${f}`}getUserCode(){let i;this.poolType==="avg"?i="resultValue += value; count += 1.0;":this.computePositions?i=`let currMaxValue = mix(value, maxValue, maxValueFound);
      if (value >= currMaxValue) {
        maxValue = value;
        maxValueFound = 1.0;
        maxPosition = ${this.flattenPositions?this.includeBatchIndex?"(((batch * uniforms.xShape.y + xD) * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"((xD * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"wD * uniforms.filterDims.y * uniforms.filterDims.y + wR * uniforms.filterDims.z + wC"};
      }`:i="resultValue = max(value, resultValue);";let o="resultValue";return this.poolType==="avg"&&(o="resultValue / max(count, 1.0)"),`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let batch = coords.x;
          let ch = coords.u;

          let xCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;
          let xDCorner = xCorner.x;
          let xRCorner = xCorner.y;
          let xCCorner = xCorner.z;

          ${this.computePositions?`var maxValue = 0.0;
            var maxValueFound = 0.0;
            var maxPosition = 0;`:`var resultValue = ${this.poolType==="avg"?"0.0":"-1.0 / pow(10.0, -20.0)"};`}

          var count = 0.0;
          for (var wD = 0; wD < uniforms.filterDims.x; wD++) {
            let xD = xDCorner + wD;
            if (xD < 0 || xD >= uniforms.convDims.x) {
              continue;
            }

            for (var wR = 0; wR < uniforms.filterDims.y; wR++) {
              let xR = xRCorner + wR;
              if (xR < 0 || xR >= uniforms.convDims.y) {
                continue;
              }

              for (var wC = 0; wC < uniforms.filterDims.z; wC++) {
                let xC = xCCorner + wC;
                if (xC < 0 || xC >= uniforms.convDims.z) {
                  continue;
                }

                let value = getX(batch, xD, xR, xC, ch);
                ${i}
              }
            }
          }

          ${this.computePositions?"setOutputAtIndexI32(index, maxPosition);":`setOutputAtIndex(index, ${o});`}
        }
      }
    `}}function hP(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{reductionIndices:f,keepDims:y}=u;return J2(c,f,y,"max",o)}let uJ={kernelName:m.Max,backendName:"webgpu",kernelFunc:hP};function dP(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{keepDims:f,axis:y}=u;return J2(c,y,f,"mean",o)}let fP={kernelName:m.Mean,backendName:"webgpu",kernelFunc:dP};function o7(l,i,o,u){if(i.filterWidth===1&&i.filterHeight===1&&m.util.arraysEqual(i.inShape,i.outShape))return Hd({inputs:{x:l},backend:u});if(i.filterWidth===i.inWidth&&i.filterHeight===i.inHeight&&i.batchSize===1&&i.padInfo.type==="VALID"){let y=l.shape.length,w=zi({inputs:{x:l},backend:u,attrs:{shape:[l.shape[y-3]*l.shape[y-2],l.shape[y-1]]}}),C;o==="avg"?C=dP({inputs:{x:w},backend:u,attrs:{axis:0,keepDims:!1}}):(m.util.assert(o==="max",()=>`Invalid pool type ${o}`),C=hP({inputs:{x:w},backend:u,attrs:{reductionIndices:0,keepDims:!1}}));let T=zi({inputs:{x:C},backend:u,attrs:{shape:i.outShape}});return u.disposeData(w.dataId),u.disposeData(C.dataId),T}let c,f=[{type:"int32",data:[i.strideHeight,i.strideWidth]}];return i.filterHeight===1&&i.filterWidth===1?c=new lP(i):(o==="avg"?c=new ty(i,"avg"):(m.util.assert(o==="max",()=>`Invalid pool type ${o}`),c=new ty(i,"max")),f.push({type:"int32",data:[i.padInfo.top,i.padInfo.left]},{type:"int32",data:[i.dilationHeight,i.dilationWidth]},{type:"int32",data:[i.inHeight,i.inWidth]},{type:"int32",data:[i.effectiveFilterHeight,i.effectiveFilterWidth]})),u.runWebGPUProgram(c,[l],l.dtype,f)}let hpt={kernelName:m.AvgPool,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{filterSize:f,strides:y,pad:w,dimRoundingMode:C}=u;return o7(c,m.backend_util.computePool2DInfo(c.shape,f,y,1,w,C),"avg",o)}},lJ={kernelName:m.AvgPool3D,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{filterSize:f,strides:y,pad:w,dataFormat:C,dimRoundingMode:T}=u,x=m.backend_util.computePool3DInfo(c.shape,f,y,[1,1,1],w,T,C),A=new cP(x,"avg"),M=[{type:"int32",data:[x.strideDepth,x.strideHeight,x.strideWidth]},{type:"int32",data:[x.padInfo.front,x.padInfo.top,x.padInfo.left]},{type:"int32",data:[x.inDepth,x.inHeight,x.inWidth]},{type:"int32",data:[x.effectiveFilterDepth,x.effectiveFilterHeight,x.effectiveFilterWidth]}];return o.runWebGPUProgram(A,[c],c.dtype,M)}};class s7{constructor(i){this.variableNames=["dy"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32, avgMultiplier : f32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i.inShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool2DBackprop"}getUserCode(){return`
      ${Gr("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d = coords[3];

        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;
        let dyRCorner = dyRCCorner.x;
        let dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR = wR + uniforms.dilations[0]) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims[1]; wC = wC + uniforms.dilations[1]) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }
            let idyC = i32(dyC);

            let dyValue = getDy(batch, idyR, idyC, d);

            dotProd = dotProd + dyValue * uniforms.avgMultiplier;
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}}class pP{constructor(i){this.variableNames=["dy"],this.uniforms=`strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,
       outDepth : i32, outHeight : i32, outWidth : i32, avgMultiplier : f32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i.inShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool3DBackprop"}getUserCode(){return`
      ${Gr("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let ch = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyDCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {
          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);

          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {
            continue;
          }
          let idyD = i32(dyD);

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let dyValue = getDy(batch, idyD, idyR, idyC, ch);
              dotProd += dyValue * uniforms.avgMultiplier;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}}let dpt={kernelName:m.AvgPool3DGrad,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,input:f}=i,y=f,{filterSize:w,strides:C,pad:T,dimRoundingMode:x}=u,A=m.backend_util.computePool3DInfo(y.shape,w,C,1,T,x),M=new pP(A),$=1/(A.filterDepth*A.filterHeight*A.filterWidth),V=[{type:"int32",data:[A.strideDepth,A.strideHeight,A.strideWidth]},{type:"int32",data:[A.effectiveFilterDepth-1-A.padInfo.front,A.effectiveFilterHeight-1-A.padInfo.top,A.effectiveFilterWidth-1-A.padInfo.left]},{type:"int32",data:[A.effectiveFilterDepth,A.effectiveFilterHeight,A.effectiveFilterWidth]},{type:"int32",data:[A.outDepth]},{type:"int32",data:[A.outHeight]},{type:"int32",data:[A.outWidth]},{type:"float32",data:[$]}];return o.runWebGPUProgram(M,[c],y.dtype,V)}},fpt={kernelName:m.AvgPoolGrad,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,input:f}=i,y=f;WQ([c,f],"avgPoolGrad");let{filterSize:w,strides:C,pad:T}=u,x=m.backend_util.computePool2DInfo(y.shape,w,C,1,T),A=new s7(x),M=1/(x.filterHeight*x.filterWidth),$=[{type:"int32",data:[x.strideHeight,x.strideWidth]},{type:"int32",data:[x.effectiveFilterHeight-1-x.padInfo.top,x.effectiveFilterWidth-1-x.padInfo.left]},{type:"int32",data:[x.dilationHeight,x.dilationWidth]},{type:"int32",data:[x.effectiveFilterHeight,x.effectiveFilterWidth]},{type:"int32",data:[x.outHeight]},{type:"int32",data:[x.outWidth]},{type:"float32",data:[M]}];return o.runWebGPUProgram(A,[c],y.dtype,$)}},ppt={kernelName:m.BatchMatMul,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{a:c,b:f}=i,{transposeA:y,transposeB:w}=u;return e7({a:c,b:f,transposeA:y,transposeB:w,backend:o})}};class f4{constructor(i,o){this.variableNames=["source"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=o,this.rank=o.length,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.start=i,this.uniforms=`start : ${ol(i.length)}, `,this.shaderKey="slice"}getUserCode(){let i=ol(this.rank),o=function(c){if(c===1)return"sourceLoc";if(c<=6)return mP.slice(0,c).map(f=>`sourceLoc.${f}`).join(",");throw Error(`Slicing for rank ${c} is not yet supported`)}(this.rank),u;return u=this.start.length===1?this.outputShape.map((c,f)=>"sourceLoc = uniforms.start + coords;"):this.outputShape.map((c,f)=>`sourceLoc.${mP[f]} = uniforms.start.${s1(f)} + coords.${mP[f]};`),`
      ${Gr("index")} {
        if (index < uniforms.size) {
          var sourceLoc : ${i};
          let coords = getCoordsFromIndex(index);
          ${u.join(`
`)}
          setOutputAtIndex(index, getSource(${o}));
        }
      }
    `}}let mP=["x","y","z","w","u","v"];function p4(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{begin:f,size:y}=u,[w,C]=m.slice_util.parseSliceParams(c,f,y);if(m.slice_util.assertParamsValid(c,w,C),o.shouldExecuteOnCPU([c])||c.dtype==="string"){let A=o.tensorMap.get(c.dataId),M=oP(A.values,w,C,c.shape,c.dtype);return o.makeTensorInfo(C,c.dtype,M)}if(m.util.sizeFromShape(C)===0)return o.makeTensorInfo(C,c.dtype,[]);let T=new f4(w,C),x=[{type:"int32",data:w}];return o.runWebGPUProgram(T,[c],c.dtype,x)}let mpt={kernelName:m.Slice,backendName:"webgpu",kernelFunc:p4},c1={kernelName:m.BatchToSpaceND,backendName:"webgpu",kernelFunc:l=>{let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{blockShape:f,crops:y}=u;m.util.assert(c.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGPU backend not implemented yet");let w=f.reduce((it,ht)=>it*ht),C=m.backend_util.getReshaped(c.shape,f,w),T=m.backend_util.getPermuted(C.length,f.length),x=m.backend_util.getReshapedPermuted(c.shape,f,w),A=m.backend_util.getSliceBeginCoords(y,f.length),M=m.backend_util.getSliceSize(x,y,f.length),$=[],V=zi({inputs:{x:c},backend:o,attrs:{shape:C}}),G=Um({inputs:{x:V},backend:o,attrs:{perm:T}}),Q=zi({inputs:{x:G},backend:o,attrs:{shape:x}}),nt=p4({inputs:{x:Q},backend:o,attrs:{begin:A,size:M}});return $.push(V),$.push(G),$.push(Q),$.forEach(it=>o.disposeData(it.dataId)),nt}},gpt=`
  fn bincount_write(index: i32, value: f32) {
    ${o1("&result[index]","value","float32")}
  }
`;class cJ{constructor(i,o,u=!1){this.outputShape=[],this.variableNames=["x"],this.uniforms="binCountSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.hasWeights=!0,this.binaryOutput=!1,this.outputShape=i,this.rank=i.length,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.binaryOutput=u,u&&(this.atomic=!1),this.hasWeights=o,this.hasWeights&&this.variableNames.push("w"),this.shaderKey=`bincount_${this.hasWeights}_${this.binaryOutput}_${this.rank}`}getUserCode(){return`
    ${this.binaryOutput?`
  fn bincount_write(index: i32, value: f32) {
    atomicStore(&result[index], bitcast<i32>(value));
  }
`:gpt}
  ${Gr("index")} {
    ${this.rank===1?`if (index < uniforms.xShape) {
      let indexVal = i32(getX(index));
      if (indexVal < uniforms.binCountSize) {
        let value = ${this.binaryOutput?1:this.hasWeights?"getW(index)":"1."};
        bincount_write(indexVal, value);
      }
    }`:`let coord = getCoordsFromIndex(index);
    if (coordsInBounds2D(coord, uniforms.xShape)) {
      let indexVal = i32(getX(coord[0], coord[1]));
      if (indexVal < uniforms.binCountSize) {
        let value = ${this.binaryOutput?1:this.hasWeights?"getW(coord[0], coord[1])":"1."};
        bincount_write(coord.x * uniforms.binCountSize + indexVal, value);
      }
    }`}
  }
  `}}let hJ={kernelName:m.Bincount,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,weights:f}=i,{size:y}=u,w=m.util.sizeFromShape(c.shape),C=m.util.sizeFromShape(f.shape)>0,T=[y],x=f.dtype,A=Qc({backend:o,attrs:{shape:T,value:0,dtype:x}}),M=new cJ([w],C),$=[{type:"int32",data:[y]}],V=C?[c,f]:[c];return o.runWebGPUProgram(M,V,x,$,A)}};class F0{constructor(i){this.outputShape=[],this.variableNames=["s0","s1"],this.uniforms="s0Size : i32, s1Size : i32, ",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[i],this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="broadcastArgs"}getUserCode(){return`
  ${Gr("index")} {
    if (index < uniforms.size) {
      var s0 = 1.0;
      var s1 = 1.0;
      let indexS0 = index - uniforms.size + uniforms.s0Size;
      let indexS1 = index - uniforms.size + uniforms.s1Size;
      if (indexS0 >= 0) {
        s0 = getS0(indexS0);
      }
      if (indexS1 >= 0) {
        s1 = getS1(indexS1);
      }

      if (s0 == 1.0) {
        setOutputAtIndex(index, s1);
      } else if (s1 == 1.0) {
        setOutputAtIndex(index, s0);
      } else if (s0 != s1) {
        setOutputAtIndex(index, uniforms.NAN);
      } else {
        setOutputAtIndex(index, s0);
      }
    }
  }
  `}}let gP={kernelName:m.BroadcastArgs,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{s0:u,s1:c}=i;if(o.shouldExecuteOnCPU([u,c])){let x=o.tensorMap.get(u.dataId),A=o.tensorMap.get(c.dataId),M=x.values,$=A.values,V=m.backend_util.assertAndGetBroadcastShape(Array.from(M),Array.from($));return o.makeTensorInfo([V.length],"int32",Int32Array.from(V))}let f=m.util.sizeFromShape(u.shape),y=m.util.sizeFromShape(c.shape),w=Math.max(f,y),C=new F0(w),T=[{type:"int32",data:[f]},{type:"int32",data:[y]}];return o.runWebGPUProgram(C,[u,c],"int32",T)}},zb=Dl({opType:Ma.NOT_EQUAL,dtype:"bool",cpuKernelImpl:Hft}),ypt={kernelName:m.NotEqual,backendName:"webgpu",kernelFunc:zb};function Pb(l){let{inputs:i,backend:o}=l,{input:u}=i;return Hd({inputs:{x:o.tensorMap.get(u.dataId).complexTensorInfos.real},backend:o})}let u7={kernelName:m.Real,backendName:"webgpu",kernelFunc:Pb},l7={kernelName:m.Cast,backendName:"webgpu",kernelFunc:function l(i){let{inputs:o,backend:u,attrs:c}=i,{x:f}=o,{dtype:y}=c;if(y==="complex64"){if(f.dtype==="complex64")return Hd({inputs:{x:f},backend:u});let w=m.zeros(f.shape),C=l({inputs:{x:f},backend:u,attrs:{dtype:"float32"}}),T=$b({inputs:{real:C,imag:w},backend:u});return w.dispose(),u.disposeData(C.dataId),T}if(f.dtype==="complex64"){let w=Pb({inputs:{input:f},backend:u}),C=l({inputs:{x:w},backend:u,attrs:{dtype:y}});return u.disposeData(w.dataId),C}if(!m.util.hasEncodingLoss(f.dtype,y)){let w=Hd({inputs:{x:f},backend:u});return{dataId:w.dataId,shape:w.shape,dtype:y}}if(u.shouldExecuteOnCPU([f])){let w=u.tensorMap.get(f.dataId).values,[C,T,x]=b6(w,f.shape,f.dtype,y);return u.makeTensorInfo(C,T,x)}if(y==="int32")return function(w,C){let T=new h4(w.shape,zr.TO_INT),x=C.runWebGPUProgram(T,[w],"int32");return{dataId:x.dataId,shape:x.shape,dtype:x.dtype}}(f,u);if(y==="bool"){let w=u.makeTensorInfo([],"bool",m.util.getTypedArrayFromDType("bool",1)),C=zb({inputs:{a:f,b:w},backend:u});return u.disposeData(w.dataId),C}throw new Error(`Error in Cast: failed to cast ${f.dtype} to ${y}`)}},vpt=go({opType:zr.CEIL,cpuKernelImpl:w6}),h1={kernelName:m.Ceil,backendName:"webgpu",kernelFunc:vpt};class m4{constructor(i){this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workPerThread=4,this.workgroupSize=[64,1,1],this.outputComponent=4,this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="clipVec4"}getUserCode(){return`
      ${Gr("index")} {
        if(index < uniforms.size) {
          let value = getAByOutputIndex(index);
          var clampedValue = clamp(
              value, vec4<f32>(uniforms.minVal), vec4<f32>(uniforms.maxVal));
          clampedValue = select(clampedValue, value, isnanVec4(value));
          setOutputAtIndex(index, clampedValue);
        }
      }
    `}}class dJ{constructor(i){this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="clip"}getUserCode(){return`
      ${Gr("index")} {
        if(index < uniforms.size) {
          let value = getAByOutputIndex(index);
          if (isnan(value)) {
            setOutputAtIndex(index, value);
            return;
          }
          setOutputAtIndex(index, clamp(value, uniforms.minVal, uniforms.maxVal));
        }
      }
    `}}let fJ={kernelName:m.ClipByValue,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{clipValueMin:f,clipValueMax:y}=u,w,C=[{type:"float32",data:[f]},{type:"float32",data:[y]}];return w=m.util.sizeFromShape(c.shape)%4==0?new m4(c.shape):new dJ(c.shape),o.runWebGPUProgram(w,[c],c.dtype,C)}};class pJ{constructor(i){this.outputShape=[],this.variableNames=["real","imag"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="complexAbs"}getUserCode(){return`
    ${Gr("index")} {
      if (index < uniforms.size) {
        let re = abs(getRealByOutputIndex(index));
        let im = abs(getImagByOutputIndex(index));
        let mx = max(re, im);

        // The length function in wgsl may be not underflow-safe on some GPUs.
        // So the safe solution is to ensure underflow-safety in all cases.
        setOutputAtIndex(index, select(mx * length(vec2<f32>(1, min(re, im)/mx)), 0.0, mx == 0.0));
      }
    }
  `}}function yP(l,i){return{dataId:i.dataId,dtype:i.dtype,shape:l.shape}}let c7={kernelName:m.ComplexAbs,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{x:u}=i,c=o.tensorMap.get(u.dataId),f=new pJ(u.shape),y=[yP(u,c.complexTensorInfos.real),yP(u,c.complexTensorInfos.imag)];return o.runWebGPUProgram(f,y,y[0].dtype)}};class h7{constructor(i){this.uniforms="",this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=m.backend_util.computeOutShape(i,1),this.variableNames=i.map((o,u)=>`T${u}`),this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.offsetLength=i.length-1;for(let o=0;o<this.offsetLength;o++)this.uniforms+=`offset${o} : i32,`;this.shaderKey="concat"}getUserCode(){let i=[];if(this.offsetLength>0){i.push("if (yC < uniforms.offset0){ setOutputAtCoords(coords.x, coords.y, getT0(yR, yC)); }");for(let c=1;c<this.offsetLength;c++)i.push(`else if (yC < uniforms.offset${[c]}){ setOutputAtCoords(coords.x, coords.y, getT${c}(yR, yC - uniforms.offset${c-1})); }`);let o=this.offsetLength,u=this.offsetLength-1;i.push(`else { setOutputAtCoords(coords.x, coords.y, getT${o}(yR, yC - uniforms.offset${u})); }`)}else i.push("setOutputAtCoords(coords.x, coords.y, getT0(yR, yC));");return`
      ${Gr("index")} {
        for(var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if(flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            let yR = coords.x;
            let yC = coords.y;

            ${i.join(`
        `)}
          }
        }
      }
    `}}function O0(l){let{inputs:i,backend:o}=l,{input:u}=i;return Hd({inputs:{x:o.tensorMap.get(u.dataId).complexTensorInfos.imag},backend:o})}let mJ={kernelName:m.Imag,backendName:"webgpu",kernelFunc:O0};function g4(l,i,o){let u=l[0].dtype;if(u==="complex64"){let V=l.map(ht=>Pb({inputs:{input:ht},backend:o})),G=l.map(ht=>O0({inputs:{input:ht},backend:o})),Q=g4(V,i,o),nt=g4(G,i,o),it=$b({inputs:{real:Q,imag:nt},backend:o});return V.forEach(ht=>o.disposeData(ht.dataId)),G.forEach(ht=>o.disposeData(ht.dataId)),o.disposeData(Q.dataId),o.disposeData(nt.dataId),it}let c=o.shouldExecuteOnCPU(l);if(u==="string"&&(c=!0),c){let V=l.map(Nt=>{let $t=m.util.sizeFromShape(Nt.shape.slice(i));return zi({inputs:{x:Nt},backend:o,attrs:{shape:[-1,$t]}})}),G=V.map(Nt=>({vals:o.readSync(Nt.dataId),shape:Nt.shape})),Q=m.backend_util.computeOutShape(V.map(Nt=>Nt.shape),1),nt=V[0].shape[0]===1,it=Bft(G,Q,u,nt),ht=m.backend_util.computeOutShape(l.map(Nt=>Nt.shape),i),kt=o.makeTensorInfo(ht,u,it);return V.forEach(Nt=>o.disposeData(Nt.dataId)),kt}let f=o.device.limits.maxStorageBuffersPerShaderStage-1;if(l.length>f){let V=[];for(let Q=0;Q<l.length;Q+=f){let nt=l.slice(Q,Q+f);V.push(g4(nt,i,o))}let G=g4(V,i,o);for(let Q of V)o.disposeData(Q.dataId);return G}let{tensors2D:y,outShape:w}=function(V,G,Q){let nt=m.backend_util.computeOutShape(V.map(ht=>ht.shape),G);return{tensors2D:V.map(ht=>zi({inputs:{x:ht},backend:Q,attrs:{shape:[m.util.sizeFromShape(ht.shape.slice(0,G)),m.util.sizeFromShape(ht.shape.slice(G))]}})),outShape:nt}}(l,i,o),C=y.map(V=>V.shape),T=new h7(C),x=[],A=new Array(C.length-1);if(A.length>0){A[0]=C[0][1],x.push({type:"int32",data:[A[0]]});for(let V=1;V<A.length;V++)A[V]=A[V-1]+C[V][1],x.push({type:"int32",data:[A[V]]})}let M=o.runWebGPUProgram(T,y,y[0].dtype,x);y.forEach(V=>o.disposeData(V.dataId));let $=zi({inputs:{x:M},backend:o,attrs:{shape:w}});return o.disposeData(M.dataId),$}function vP(l){let{inputs:i,backend:o,attrs:u}=l,{axis:c}=u,f=m.util.parseAxisParam(c,i[0].shape)[0],y=i.map(T=>T.shape);m.backend_util.assertParamsConsistent(y,f);let w=m.backend_util.computeOutShape(i.map(T=>T.shape),f);if(m.util.sizeFromShape(w)===0)return o.makeTensorInfo(w,i[0].dtype,[]);let C=i.filter(T=>m.util.sizeFromShape(T.shape)>0);return C.length===1?Hd({inputs:{x:C[0]},backend:o}):g4(C,f,o)}let bpt={kernelName:m.Concat,backendName:"webgpu",kernelFunc:vP};class d7{constructor(i,o,u,c,f=!1,y=null,w=!1,C=!1){this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=i.outShape,this.isChannelsLast=i.dataFormat==="channelsLast",this.isVec4=((i.inChannels%4==0||i.inChannels%3==0)&&this.isChannelsLast||i.outWidth%4==0&&!this.isChannelsLast)&&i.outChannels%4==0,this.dispatchLayout=this.isChannelsLast?{x:[3],y:[1,2],z:[0]}:{x:[2,3],y:[1],z:[0]},this.workgroupSize=N0(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=M0(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4?(this.outputComponent=4,this.isChannelsLast&&i.inChannels%4!=0?(this.innerElementSize=3,this.variableComponents=[1,4]):(this.innerElementSize=4,this.variableComponents=[4,4]),f&&(this.variableNames.push("bias"),this.variableComponents.push(4)),w&&(this.variableNames.push("preluActivationWeights"),this.variableComponents.push(4))):(this.innerElementSize=this.elementsPerThread[0],f&&this.variableNames.push("bias"),w&&this.variableNames.push("preluActivationWeights")),this.sequentialAccessByThreads=C,this.addBias=f,this.activation=y,this.hasPreluActivationWeights=w,this.tileAOuter=this.workgroupSize[1]*this.elementsPerThread[1],this.tileBOuter=this.workgroupSize[0]*this.elementsPerThread[0],this.tileInner=Math.max(this.workgroupSize[0]*this.innerElementSize,this.workgroupSize[1]),this.fitAOuter=o%this.tileAOuter==0,this.fitBOuter=u%this.tileBOuter==0,this.fitInner=c%this.tileInner==0,this.shaderKey=`conv2DMM_${this.elementsPerThread}_${this.activation}}_${this.fitAOuter}_${this.fitBOuter}_${this.fitInner}_${this.isVec4}_${this.innerElementSize}_${this.isChannelsLast}_${this.sequentialAccessByThreads}`}getUserCode(){let i=this.isVec4?l1(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner):t7(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner,!1,null,this.sequentialAccessByThreads),o=this.isVec4?[this.innerElementSize,4,4]:[1,1,1];return`
    ${function(u,c,f,y,w=!1,C=null,T=!1,x=4,A=4,M=4){let $=u?`
      let coord = vec4<i32>(batch, xRow, xCol, xCh);
      `:`
      let coord = vec4<i32>(batch, xCh, xRow, xCol);
      `,V=u?`
      let coords = vec4<i32>(
        batch,
        row / outWidth,
        row % outWidth,
        col);
      `:`
      let coords = vec4<i32>(
        batch,
        row,
        col / outWidth,
        col % outWidth);
      `,G=u?"uniforms.xShape[1]":"uniforms.xShape[2]",Q=u?"uniforms.xShape[2]":"uniforms.xShape[3]",nt=u?"row":"col",it=u?"col":"row",ht=`
      let inChannels = uniforms.wShape[2];
      let outWidth = ${u?"uniforms.outShape[2]":"uniforms.outShape[3]"};
      let outRow = ${nt} / outWidth;
      let outCol = ${nt} % outWidth;

      let WRow = ${it} / (uniforms.filterDims[1] * inChannels);
      let WCol = ${it} / inChannels % uniforms.filterDims[1];
      let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * WRow - uniforms.pads[0];
      let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * WCol - uniforms.pads[1];
      let xCh = ${it} % inChannels;
      var resData = ${ro(x)}(0.0);
      // The bounds checking is always needed since we use it to pad zero for
      // the 'same' padding type.
      if (xRow >= 0 && xRow < ${G} && xCol >= 0 && xCol < ${Q}) {
        ${$}
        let xIndex = getIndexFromCoords4D(coord, uniforms.xShape);
        ${(re=>{switch(re){case 1:return"resData = f32(x[xIndex]);";case 3:return"resData = vec3<f32>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);";case 4:return"resData = vec4<f32>(x[xIndex / 4]);";default:throw new Error(`innerElementSize ${re} is not supported.`)}})(x)}
      }
      return resData;`,kt=u?c&&y?`
      ${ht}`:`
      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {
        ${ht}
      }
      return ${ro(x)}(0.0);`:y&&f?`
      ${ht}`:`
      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {
        ${ht}
      }
      return ${ro(x)}(0.0);`,Nt=`${(re=>{switch(re){case 1:return"return f32(W[row * uniforms.wShape[3] + col]);";case 4:return"return vec4<f32>(W[(row * uniforms.wShape[3] + col) / 4]);";default:throw new Error(`innerElementSize ${re} is not supported.`)}})(A)}`,$t=ro(M),Ut=ro(u?x:A),Pt=ro(u?A:x);return`
      ${D0(C,T,M===4,4)}
      fn mm_readA(batch: i32, row : i32, col : i32) -> ${Ut} {
        ${u?kt:Nt}
      }

      fn mm_readB(batch: i32, row : i32, col : i32) -> ${Pt} {
        ${u?Nt:kt}
      }

      fn mm_write(batch: i32, row : i32, col : i32, valueIn : ${$t}) {
        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)
        {
        var value = valueIn;
        let outWidth = ${u?"uniforms.outShape[2]":"uniforms.outShape[3]"};
        ${V}
        ${u1(w,C)}
        setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }`}(this.isChannelsLast,this.fitAOuter,this.fitBOuter,this.fitInner,this.addBias,this.activation,this.hasPreluActivationWeights,o[0],o[1],o[2])}
    ${i}
  `}}class bP{constructor(i,o=!1,u=null,c=!1){this.variableNames=["x","W"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>,",this.workgroupSize=[4,4,8],this.outputShape=i.outShape,this.isChannelsLast=i.dataFormat==="channelsLast",this.dispatchLayout=this.isChannelsLast?{x:[2],y:[1],z:[0,3]}:{x:[3],y:[2],z:[0,1]},this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=o,this.activation=u,this.hasPreluActivationWeights=c,o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),this.shaderKey=`conv2dnaive_${this.activation}_${this.isChannelsLast}`}getUserCode(){return`
       ${D0(this.activation,this.hasPreluActivationWeights,!1,4)}
       fn readInp(batch : i32, row : i32, col : i32, chan : i32) -> f32{
         let coords = vec4<i32>(batch, row, col, chan);
         if (coordsInBounds4D(coords, uniforms.xShape)) {
           return  getX(batch, row, col, chan);
         } else {
          return 0.0;
         }
       }
       fn readFilt(row : i32, col : i32, xChannel : i32, outChannel : i32) -> f32{
         let coords = vec4<i32>(row, col, xChannel, outChannel);
         if(coordsInBounds4D(coords, uniforms.wShape)) {
           return getW(row, col, xChannel, outChannel);
          } else {
            return 0.0;
          }
       }
       fn writeResult(batch : i32, row : i32, col : i32, chan : i32, valueIn : f32) {
         let coords = ${this.isChannelsLast?"vec4<i32>(batch, row, col, chan);":"vec4<i32>(batch, chan, row, col);"}
         if (coordsInBounds4D(coords, uniforms.outShape)) {
           var value = valueIn;
           ${u1(this.addBias,this.activation)}
           setOutputAtCoords(coords.x, coords.y, coords.z, coords.w, value);
         }
       }
       ${Gr("index")} {
         let coords = getOutputCoords();
         let batch = coords[0];
         let outChannel = ${this.isChannelsLast?"coords[3];":"coords[1];"}
         let outRow = ${this.isChannelsLast?"coords[1];":"coords[2];"}
         let outCol = ${this.isChannelsLast?"coords[2];":"coords[3];"}
         var acc : f32 = 0.0;
         for (var row = 0; row < uniforms.filterDims[0]; row = row + 1) {
           for (var col = 0; col < uniforms.filterDims[1]; col = col + 1) {
             let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * row - uniforms.pads[0];
             let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * col - uniforms.pads[1];
             for (var xChannel = 0; xChannel < ${this.isChannelsLast?"uniforms.xShape[3];":"uniforms.xShape[1];"} xChannel = xChannel + 1) {
               ${this.isChannelsLast?"let v = readInp(batch, xRow, xCol, xChannel);":"let v = readInp(batch, xChannel, xRow, xCol);"}
               let f = readFilt(row, col, xChannel, outChannel);
               acc = acc + v * f;
             }
           }
         }
         writeResult(batch, outRow, outCol, outChannel, acc);
       }
     `}}class wpt{constructor(i,o){this.variableNames=["x"],this.uniforms=`pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, outWidth : i32, itemsPerBlockRow : i32,
       inChannels : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=o,this.shaderKey=`im2col_${this.isChannelsLast}`}getUserCode(){let i=this.isChannelsLast?1:2,o=this.isChannelsLast?2:3,u=this.isChannelsLast?"coords[1]":"coords[2]",c=this.isChannelsLast?"coords[2]":"coords[1]",f=this.isChannelsLast?"getX(batch, xRow, xCol, ch)":"getX(batch, ch, xRow, xCol)";return`
    ${Gr("index")} {
      let coords = getCoordsFromIndex(index);
      if(index < uniforms.size) {
        let batch = coords[0];
        let row = ${u};
        let col = ${c};
        let offsetY = (row / uniforms.outWidth) * uniforms.strides[0] - uniforms.pads[0];
        let xRow = offsetY + uniforms.dilations[0] * (col / uniforms.itemsPerBlockRow);
        var value = 0.0;
        if(xRow < uniforms.xShape[${i}] && xRow >= 0) {
          let offsetX = (row % uniforms.outWidth) * uniforms.strides[1] -
              uniforms.pads[1];
          let xCol = offsetX + uniforms.dilations[1] * ((col %
              uniforms.itemsPerBlockRow) / uniforms.inChannels);
          let ch = col % uniforms.inChannels;
          if(xCol < uniforms.xShape[${o}] && xCol >= 0) {
            value = ${f};
          }
        }
        setOutputAtIndex(index, value);
      }
    }
   `}}function y4(l,i){let o=l.length;return o>=3?i?[...l.slice(0,-3),l[o-3]*l[o-2],l[o-1]]:[...l.slice(0,-3),l[o-3],l[o-2]*l[o-1]]:!i&&o===1&&l[0]>1?[l[0],1]:null}function gJ({x:l,filter:i,convInfo:o,backend:u,bias:c=null,preluActivationWeights:f=null,leakyreluAlpha:y=0,activation:w=null}){let C=c!=null,T=f!=null,x=o.dataFormat==="channelsLast",A=x&&o.filterHeight===o.inHeight&&o.filterWidth===o.inWidth&&o.padInfo.type==="VALID",M=(0,m.env)().getBool("WEBGPU_USE_NAIVE_CONV2D_DEBUG");if(!M&&(A||o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID")))return function({x:$t,filter:Ut,convInfo:Pt,backend:re,bias:ue=null,preluActivationWeights:be=null,leakyreluAlpha:De=0,activation:ze=null}){let Qe=Pt.dataFormat==="channelsLast",cn=!Qe,en=[],sn,xn;if(Qe&&Pt.filterHeight===Pt.inHeight&&Pt.filterWidth===Pt.inWidth&&Pt.padInfo.type==="VALID"){let Fn=Pt.inHeight*Pt.inWidth*Pt.inChannels;sn=zi({inputs:{x:$t},backend:re,attrs:{shape:[1,Pt.batchSize,Fn]}}),xn=zi({inputs:{x:Ut},backend:re,attrs:{shape:[1,Fn,Pt.outChannels]}})}else sn=zi({inputs:{x:$t},backend:re,attrs:{shape:Qe?[Pt.batchSize,Pt.inHeight*Pt.inWidth,Pt.inChannels]:[Pt.batchSize,Pt.inChannels,Pt.inHeight*Pt.inWidth]}}),xn=zi({inputs:{x:Ut},backend:re,attrs:{shape:[1,Pt.inChannels,Pt.outChannels]}});if(en.push(sn),en.push(xn),be!=null){let Fn=y4(be.shape,Qe);Fn!=null&&(be=zi({inputs:{x:be},backend:re,attrs:{shape:Fn}}),en.push(be))}if(ue!=null){let Fn=y4(ue.shape,Qe);Fn!=null&&(ue=zi({inputs:{x:ue},backend:re,attrs:{shape:Fn}}),en.push(ue))}let Rn=e7({a:Qe?sn:xn,b:Qe?xn:sn,transposeA:cn,transposeB:!1,backend:re,bias:ue,activation:ze,preluActivationWeights:be,leakyreluAlpha:De}),Bn=zi({inputs:{x:Rn},backend:re,attrs:{shape:Pt.outShape}});en.push(Rn);for(let Fn of en)re.disposeData(Fn.dataId);return Bn}({x:l,filter:i,convInfo:o,backend:u,bias:c,activation:w,preluActivationWeights:f,leakyreluAlpha:y});let $=(0,m.env)().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),V=$>-1?$:u.thresholdToIncreaseWorkgroups,G=o.batchSize*Math.ceil(o.outHeight*o.outWidth/32)*Math.ceil(o.outChannels/32);if((0,m.env)().getBool("WEBGPU_CONV_SEPARATE_IM2COL_SHADER")||G<=V)return function({x:$t,filter:Ut,convInfo:Pt,backend:re,bias:ue=null,preluActivationWeights:be=null,leakyreluAlpha:De=0,activation:ze=null}){let{filterWidth:Qe,filterHeight:cn,inChannels:en,strideWidth:sn,strideHeight:xn,padInfo:Rn,outWidth:Bn,outHeight:Fn,dilationWidth:Xn,dilationHeight:Nn,dataFormat:kr}=Pt,Tr=kr==="channelsLast",Ar=Qe*cn*en,Dr=Fn*Bn,Ni=Tr?[Pt.batchSize,Dr,Ar]:[Pt.batchSize,Ar,Dr],Mi=new wpt(Ni,Tr),Yi=[{type:"int32",data:[Rn.top,Rn.left]},{type:"int32",data:[xn,sn]},{type:"int32",data:[Nn,Xn]},{type:"int32",data:[Bn]},{type:"int32",data:[en*Qe]},{type:"int32",data:[en]}],Hr=re.runWebGPUProgram(Mi,[$t],$t.dtype,Yi),wa=[];wa.push(Hr);let Oa=zi({inputs:{x:Ut},backend:re,attrs:{shape:[1,Ar,-1]}});if(wa.push(Oa),be!=null){let xa=y4(be.shape,Tr);xa!=null&&(be=zi({inputs:{x:be},backend:re,attrs:{shape:xa}}),wa.push(be))}if(ue!=null){let xa=y4(ue.shape,Tr);xa!=null&&(ue=zi({inputs:{x:ue},backend:re,attrs:{shape:xa}}),wa.push(ue))}let Xa=e7({a:Tr?Hr:Oa,b:Tr?Oa:Hr,transposeA:!Tr,transposeB:!1,backend:re,bias:ue,activation:ze,preluActivationWeights:be,leakyreluAlpha:De}),ta=zi({inputs:{x:Xa},backend:re,attrs:{shape:Pt.outShape}});wa.push(Xa);for(let xa of wa)re.disposeData(xa.dataId);return ta}({x:l,filter:i,convInfo:o,backend:u,bias:c,preluActivationWeights:f,leakyreluAlpha:y,activation:w});let Q,nt=[o.padInfo.top,o.padInfo.left],it=[{type:"int32",data:[o.filterHeight,o.filterWidth]},{type:"int32",data:[...nt]},{type:"int32",data:[o.strideHeight,o.strideWidth]},{type:"int32",data:[o.dilationHeight,o.dilationWidth]}];if(M)Q=new bP(o,C,w,T);else{let $t=x?o.outHeight*o.outWidth:o.outChannels,Ut=x?o.outChannels:o.outHeight*o.outWidth,Pt=o.filterHeight*o.filterWidth*o.inChannels;it.push({type:"int32",data:[$t]},{type:"int32",data:[Ut]},{type:"int32",data:[Pt]});let re=u.adapterInfo.isIntel();Q=new d7(o,$t,Ut,Pt,C,w,T,re)}let ht=[],kt=[l,i];C&&(x||c.shape.length!==1||(c=zi({inputs:{x:c},backend:u,attrs:{shape:[c.shape[0],1,1]}}),ht.push(c)),kt.push(c)),T&&(x||f.shape.length!==1||(f=zi({inputs:{x:f},backend:u,attrs:{shape:[f.shape[0],1,1]}}),ht.push(f)),kt.push(f)),w==="leakyrelu"&&(it.push({type:"float32",data:[y]}),Q.uniforms+=" alpha : f32,");let Nt=u.runWebGPUProgram(Q,kt,l.dtype,it);for(let $t of ht)u.disposeData($t.dataId);return Nt}let wP={kernelName:m.Conv2D,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,attrs:o,backend:u}=l,{x:c,filter:f}=i,{strides:y,pad:w,dataFormat:C,dilations:T,dimRoundingMode:x}=o,A=m.backend_util.convertConv2DDataFormat(C);return gJ({x:c,filter:f,convInfo:m.backend_util.computeConv2DInfo(c.shape,f.shape,y,T,w,x,!1,A),backend:u})}};class xpt{constructor(i){this.variableNames=["dy","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>,",this.workgroupSize=[64,1,1],this.size=!1,this.isVec4=!1,this.workPerThread=1,this.outputShape=i.inShape,this.isChannelsLast=i.dataFormat==="channelsLast",this.isVec4=this.isChannelsLast&&i.outChannels%4==0&&i.inChannels%4==0,this.isVec4?(this.workPerThread=2,this.outputComponent=4,this.workgroupSize=[4,4,4],this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize,[4,this.workPerThread,1])):(this.size=!0,this.workPerThread=1,this.workgroupSize=[64,1,1],this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize)),this.shaderKey=`conv2DDerInput_${this.isChannelsLast}_${this.isVec4}_${this.workPerThread}`}getUserCode(){let i=this.isChannelsLast?1:2,o=this.isChannelsLast?2:3,u=this.isChannelsLast?3:1,c=`
    ${Gr()} {
      let batch = i32(globalId.z) / uniforms.outShape[1];
      let r = i32(globalId.z) % uniforms.outShape[1];
      let c = i32(globalId.y) * ${this.workPerThread};
      let d1 = i32(globalId.x) * 4;

      let dyCorner = vec2<i32>(r, c) - uniforms.pads;

      // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
      // ? = to be determined. : = across all values in that axis.
      var dotProd: array<vec4<f32>, ${this.workPerThread}>;
      for (var i = 0; i < ${this.workPerThread}; i++) {
        dotProd[i] = vec4<f32>(0.0);
      }
      for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {
        let dyR = f32(dyCorner.x + wR) / f32(uniforms.strides.x);
        let wRPerm = uniforms.filterDims.x - 1 - wR;
        if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) ||
            fract(dyR) > 0.0) {
          continue;
        }
        let idyR = i32(dyR);

        for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {
          let dyC = f32(dyCorner.y + wC) / f32(uniforms.strides.y);
          let dyC2 = f32(dyCorner.y + 1 + wC) / f32(uniforms.strides.y);
          let wCPerm = uniforms.filterDims.y - 1 - wC;
          var bDyCVal = true;
          var bDyCVal2 = true;
          if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||
              fract(dyC) > 0.0) {
            bDyCVal = false;
          }
          if (dyC2 < 0.0 || dyC2 >= f32(uniforms.outBackprop[2]) ||
              fract(dyC2) > 0.0) {
            bDyCVal2 = false;
          }

          let idyC = i32(dyC);
          let idyC2 = i32(dyC2);
          if (bDyCVal && bDyCVal2) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[0] = dotProd[0] + tmpval;
              xValue = getDy(batch, idyR, idyC2, d2);
              dotProd[1] = dotProd[1] + vec4<f32>(dot(xValue, wValue0),
                                                  dot(xValue, wValue1),
                                                  dot(xValue, wValue2),
                                                  dot(xValue, wValue3));
            }
          } else if (bDyCVal) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[0] = dotProd[0] + tmpval;
            }
          } else if (bDyCVal2) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC2, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[1] = dotProd[1] + tmpval;
            }
          }
        }
      }

      for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
        let coords = vec4<i32>(batch, r, c + i, d1);
        if (coordsInBounds4D(coords, uniforms.outShape)) {
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], dotProd[i]);
        }
      }
    }
    `;return this.isVec4?`
    ${c}
    `:`
    ${Gr("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d1 = coords[${u}];

        let dyCorner = vec2<i32>(coords[${i}], coords[${o}]) - uniforms.pads;
        let dyRCorner = dyCorner.x;
        let dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {
          let dyR = (f32(dyRCorner) + f32(wR)) / f32(uniforms.strides.x);
          let wRPerm = uniforms.filterDims.x - 1 - wR;
          if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) || fract(dyR) > 0.0 ||
              wRPerm < 0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {
            let dyC = (f32(dyCCorner) + f32(wC)) / f32(uniforms.strides.y);
            let wCPerm = uniforms.filterDims.y - 1 - wC;
            if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||
                fract(dyC) > 0.0 || wCPerm < 0) {
              continue;
            }
            let idyC = i32(dyC);

            for (var d2 = 0; d2 < uniforms.outBackprop[3]; d2 = d2 + 1) {
              let xValue = ${this.isChannelsLast?"getDy(batch, idyR, idyC, d2)":"getDy(batch, d2, idyR, idyC)"};
              let wValue = getW(wRPerm, wCPerm, d1, d2);
              dotProd = dotProd + xValue * wValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}}class yJ{constructor(i){this.variableNames=["x","dy"],this.uniforms="pads : vec2<i32>, strides : vec2<i32>, batchSize : i32, outHeight : i32, outWidth : i32, inHeight : i32, inWidth : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i.filterShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=i.dataFormat==="channelsLast",this.shaderKey=`conv2DDerFilter_${this.isChannelsLast}`}getUserCode(){return`
    ${Gr("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wR = coords[0];
        let wC = coords[1];
        let d1 = coords[2];
        let d2 = coords[3];

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b = b + 1) {
          for (var yR = 0; yR < uniforms.outHeight; yR = yR + 1) {
            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];
            if (xR < 0 || xR >= uniforms.inHeight) {
              continue;
            }

            for (var yC = 0; yC < uniforms.outWidth; yC = yC + 1) {
              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];

              if (xC < 0 || xC >= uniforms.inWidth) {
                continue;
              }

              if (${this.isChannelsLast}) {
                let dyValue = getDy(b, yR, yC, d2);
                let xValue = getX(b, xR, xC, d1);
                dotProd = dotProd + xValue * dyValue;
              } else {
                let dyValue = getDy(b, d2, yR, yC);
                let xValue = getX(b, d1, xR, xC);
                dotProd = dotProd + xValue * dyValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}}class Ah{constructor(i){this.variableNames=["x","dy"],this.uniforms=`pads : vec3<i32>, strides : vec3<i32>, batchSize : i32, outDepth : i32,
       outHeight : i32, outWidth : i32, inDepth : i32, inHeight : i32, inWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i.filterShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerFilter"}getUserCode(){return`
    ${Gr("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wF = coords.x;
        let wR = coords.y;
        let wC = coords.z;
        let d1 = coords.w;
        let d2 = coords.u;

        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b++) {
          for (var yF = 0; yF < uniforms.outDepth; yF++) {
            let xF = wF + yF * uniforms.strides[0] - uniforms.pads[0];
            if (xF < 0 || xF >= uniforms.inDepth) {
              continue;
            }

            for (var yR = 0; yR < uniforms.outHeight; yR++) {
              let xR = wR + yR * uniforms.strides[1] - uniforms.pads[1];
              if (xR < 0 || xR >= uniforms.inHeight) {
                continue;
              }

              for (var yC = 0; yC < uniforms.outWidth; yC++) {
                let xC = wC + yC * uniforms.strides[2] - uniforms.pads[2];
                if (xC < 0 || xC >= uniforms.inWidth) {
                  continue;
                }

                let dyValue = getDy(b, yF, yR, yC, d2);
                let xValue = getX(b, xF, xR, xC, d1);
                dotProd += xValue * dyValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}}class Bb{constructor(i){this.variableNames=["dy","W"],this.uniforms=`filterDims : vec3<i32>, pads : vec3<i32>, strides : vec3<i32>,
      outDepth : i32, outHeight : i32, outWidth : i32, outChannels : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i.inShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerInput"}getUserCode(){return`
    ${Gr("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let d1 = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyFCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        var dotProd = 0.0;
        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {
          let dyF = f32(dyFCorner + wF) / f32(uniforms.strides[0]);
          if (dyF < 0.0 || dyF >= f32(uniforms.outDepth) || fract(dyF) > 0.0) {
            continue;
          }
          let idyF = i32(dyF);

          let wFPerm = uniforms.filterDims[0] - 1 - wF;

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            let wRPerm = uniforms.filterDims[1] - 1 - wR;

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let wCPerm = uniforms.filterDims[2] - 1 - wC;

              for (var d2 = 0; d2 < uniforms.outChannels; d2++) {
                let xValue = getDy(batch, idyF, idyR, idyC, d2);
                let wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}}let kpt={kernelName:m.Conv2DBackpropFilter,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,dy:f}=i,{strides:y,pad:w,dataFormat:C,dimRoundingMode:T,filterShape:x}=u,A=m.backend_util.convertConv2DDataFormat(C),M=m.backend_util.computeConv2DInfo(c.shape,x,y,1,w,T,!1,A),$=new yJ(M),V=[{type:"int32",data:[M.padInfo.top,M.padInfo.left]},{type:"int32",data:[M.strideHeight,M.strideWidth]},{type:"int32",data:[M.batchSize]},{type:"int32",data:[M.outHeight]},{type:"int32",data:[M.outWidth]},{type:"int32",data:[M.inHeight]},{type:"int32",data:[M.inWidth]}];return o.runWebGPUProgram($,[c,f],c.dtype,V)}};class xP{constructor(i){this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=i.inShape,m.util.assert(i.dataFormat==="channelsLast",()=>"TODO: NCHW is unimplemented"),this.isVec4=i.inChannels%4==0&&i.outChannels%4==0,this.dispatchLayout={x:[3],y:[1,2],z:[0]},this.workgroupSize=N0(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=M0(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4&&(this.outputComponent=4,this.variableComponents=[4,1]),this.shaderKey=`conv2DDerInputMM_${this.isVec4}_${this.elementsPerThread}`}getUserCode(){let i=this.isVec4?l1(this.elementsPerThread,this.workgroupSize):t7(this.elementsPerThread,this.workgroupSize);return`
    ${function(o=4){let u=`if (row < uniforms.dimAOuter && col < uniforms.dimInner) {
        
      let outRow = row / uniforms.outShape[2];
      let outCol = row % uniforms.outShape[2];

      let WRow = col / (uniforms.filterDims[1] * uniforms.outBackprop[3]);
      let WCol = col / uniforms.outBackprop[3] % uniforms.filterDims[1];
      let xR = f32(outRow - uniforms.pads[0] + WRow) / f32(uniforms.strides[0]);
      let xC = f32(outCol - uniforms.pads[1] + WCol) / f32(uniforms.strides[1]);
      if (xR < 0.0 || xR >= f32(uniforms.outBackprop[1]) || fract(xR) > 0.0) {
        return ${ro(o)}(0.0);
      }
      if (xC < 0.0 || xC >= f32(uniforms.outBackprop[2]) || fract(xC) > 0.0) {
        return ${ro(o)}(0.0);
      }
      let coord = vec4<i32>(
          batch,
          i32(xR),
          i32(xC),
          col % uniforms.outBackprop[3]);
      return x[getIndexFromCoords4D(coord, uniforms.xShape)/${o}];
      }
      return ${ro(o)}(0.0);`;return`
  fn mm_readA(batch: i32, row : i32, col : i32) -> ${ro(o)} {
    ${u}
  }

  fn mm_readB(batch: i32, row : i32, col : i32) -> ${ro(o)} {
    let coordX = uniforms.filterDims.x - 1 -
        row / (uniforms.filterDims[1] * uniforms.outBackprop[3]);
    let coordY = uniforms.filterDims.y - 1 -
        (row / uniforms.outBackprop[3]) % uniforms.filterDims[1];
    if (row < uniforms.dimInner && col < uniforms.dimBOuter &&
        coordX >= 0 && coordY >= 0) {
      let rowInner = row % uniforms.outBackprop[3];
      let coord = vec4<i32>(coordX, coordY, col, rowInner);
      ${(c=>{switch(c){case 1:return"return W[getIndexFromCoords4D(coord, uniforms.wShape)];";case 4:return`
            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);
            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);
            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);
            let v0 = W[getIndexFromCoords4D(coord, uniforms.wShape)];
            let v1 = W[getIndexFromCoords4D(coord1, uniforms.wShape)];
            let v2 = W[getIndexFromCoords4D(coord2, uniforms.wShape)];
            let v3 = W[getIndexFromCoords4D(coord3, uniforms.wShape)];
            return vec4<f32>(v0, v1, v2, v3);
            `;default:throw new Error(`innerElementSize ${c} is not supported.`)}})(o)}
    }
    return ${ro(o)}(0.0);
  }

  fn mm_write(batch: i32, row : i32, col : i32, valueInput : ${ro(o)}) {
    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {
      var value = valueInput;
      let outCoord = vec4<i32>(
          batch,
          row / uniforms.outShape[2],
          row % uniforms.outShape[2],
          col);
      result[getIndexFromCoords4D(outCoord, uniforms.outShape)/${o}] = value;
    }
  }`}(this.isVec4?4:1)}
    ${i}
    `}}let Wm={kernelName:m.Conv2DBackpropInput,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,filter:f}=i,{inputShape:y,strides:w,pad:C,dataFormat:T,dimRoundingMode:x}=u,A=m.backend_util.convertConv2DDataFormat(T),M=m.backend_util.computeConv2DInfo(y,f.shape,w,1,C,x,!1,A),$=[{type:"int32",data:[M.filterHeight,M.filterWidth]},{type:"int32",data:[M.filterHeight-1-M.padInfo.top,M.filterWidth-1-M.padInfo.left]},{type:"int32",data:[M.strideHeight,M.strideWidth]},{type:"int32",data:[M.batchSize,M.outHeight,M.outWidth,M.outChannels]}],V;if((0,m.env)().getBool("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE")||M.dataFormat!=="channelsLast")V=new xpt(M);else{V=new xP(M);let G=M.inHeight*M.inWidth,Q=M.inChannels,nt=M.filterHeight*M.filterWidth*M.outChannels;$.push({type:"uint32",data:[G]},{type:"uint32",data:[Q]},{type:"uint32",data:[nt]})}return o.runWebGPUProgram(V,[c,f],"float32",$)}};class v4{constructor(i){this.variableNames=["x","W"],this.uniforms="filterDims: vec3<i32>, pads: vec3<i32>, strides: vec3<i32>, dilations: vec3<i32>,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i.outShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3dnaive"}getUserCode(){return`
    ${Gr("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let batch = coords.x;
        let d2 = coords.u;

        let xFRCCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;
        let xFCorner = xFRCCorner.x;
        let xRCorner = xFRCCorner.y;
        let xCCorner = xFRCCorner.z;

        let inputDepthNearestVec4 = (uniforms.xShape.u / 4) * 4;
        let inputDepthVec4Remainder = uniforms.xShape.u % 4;

        var dotProd = 0.0;
        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {
          let xF = xFCorner + wF * uniforms.dilations[0];
          if (xF < 0 || xF >= uniforms.xShape.y) {
            continue;
          }

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let xR = xRCorner + wR * uniforms.dilations[1];
            if (xR < 0 || xR >= uniforms.xShape.z) {
              continue;
            }

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let xC = xCCorner + wC * uniforms.dilations[2];
              if (xC < 0 || xC >= uniforms.xShape.w) {
                continue;
              }

              for (var d1 = 0; d1 < inputDepthNearestVec4; d1 += 4) {
                let xValues = vec4<f32>(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                let wValues = vec4<f32>(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (inputDepthVec4Remainder == 1) {
                dotProd += getX(batch, xF, xR, xC, inputDepthNearestVec4) *
                  getW(wF, wR, wC, inputDepthNearestVec4, d2);
              } else if (inputDepthVec4Remainder == 2) {
                let xValues = vec2<f32>(
                  getX(batch, xF, xR, xC, inputDepthNearestVec4),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1)
                );
                let wValues = vec2<f32>(
                  getW(wF, wR, wC, inputDepthNearestVec4, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (inputDepthVec4Remainder == 3) {
                let xValues = vec3<f32>(
                  getX(batch, xF, xR, xC, inputDepthNearestVec4),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2)
                );
                let wValues = vec3<f32>(
                  getW(wF, wR, wC, inputDepthNearestVec4, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }`}}let Ih={kernelName:m.Conv3D,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f}=i,{strides:y,pad:w,dilations:C}=u,T=m.backend_util.computeConv3DInfo(c.shape,f.shape,y,C,w),x=[T.padInfo.front,T.padInfo.top,T.padInfo.left],A=[{type:"int32",data:[T.filterDepth,T.filterHeight,T.filterWidth]},{type:"int32",data:[...x]},{type:"int32",data:[T.strideDepth,T.strideHeight,T.strideWidth]},{type:"int32",data:[T.dilationDepth,T.dilationHeight,T.dilationWidth]}],M=new v4(T),$=(0,m.upcastType)(c.dtype,f.dtype);return o.runWebGPUProgram(M,[c,f],$,A)}},b4={kernelName:m.Conv3DBackpropFilterV2,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,dy:f}=i,{strides:y,pad:w,filterShape:C}=u,T=m.backend_util.computeConv3DInfo(c.shape,C,y,1,w),x=new Ah(T),A=[{type:"int32",data:[T.padInfo.front,T.padInfo.top,T.padInfo.left]},{type:"int32",data:[T.strideDepth,T.strideHeight,T.strideWidth]},{type:"int32",data:[T.batchSize]},{type:"int32",data:[T.outDepth]},{type:"int32",data:[T.outHeight]},{type:"int32",data:[T.outWidth]},{type:"int32",data:[T.inDepth]},{type:"int32",data:[T.inHeight]},{type:"int32",data:[T.inWidth]}];return o.runWebGPUProgram(x,[c,f],f.dtype,A)}},f7={kernelName:m.Conv3DBackpropInputV2,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,filter:f}=i,{strides:y,pad:w,inputShape:C}=u,T=m.backend_util.computeConv3DInfo(C,f.shape,y,1,w),x=new Bb(T),A=[{type:"int32",data:[T.filterDepth,T.filterHeight,T.filterWidth]},{type:"int32",data:[T.filterDepth-1-T.padInfo.front,T.filterHeight-1-T.padInfo.top,T.filterWidth-1-T.padInfo.left]},{type:"int32",data:[T.strideDepth,T.strideHeight,T.strideWidth]},{type:"int32",data:[T.outDepth]},{type:"int32",data:[T.outHeight]},{type:"int32",data:[T.outWidth]},{type:"int32",data:[T.outChannels]}];return o.runWebGPUProgram(x,[c,f],c.dtype,A)}},vJ=go({opType:zr.COS}),bJ={kernelName:m.Cos,backendName:"webgpu",kernelFunc:vJ},kP=go({opType:zr.COSH}),wJ={kernelName:m.Cosh,backendName:"webgpu",kernelFunc:kP};class Spt{constructor(i,o,u,c){this.variableNames=["Image","Boxes","BoxInd"],this.uniforms="extrapolationValue : f32,",this.workgroupSize=[64,1,1],this.size=!0;let[f]=o;this.outputShape=[f,u[0],u[1],i],this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.methodId=c==="bilinear"?1:0,this.cropHeightBiggerThan1=this.outputShape[1]>1,this.cropWidthBiggerThan1=this.outputShape[2]>1,this.shaderKey=`cropAndResize_${this.methodId}_${this.cropHeightBiggerThan1}_${this.cropWidthBiggerThan1}`}getUserCode(){let[i,o]=["f32(uniforms.imageShape[1] - 1)","f32(uniforms.imageShape[2] - 1)"],[u,c,f]=this.cropHeightBiggerThan1?[`(${i} / f32(uniforms.outShape[1] - 1))`,"(y2-y1) * height_ratio",`y1*${i} + f32(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${i}`],[y,w,C]=this.cropWidthBiggerThan1?[`(${o} / f32(uniforms.outShape[2] - 1))`,"(x2-x1) * width_ratio",`x1*${o} + f32(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${o}`];return`
    ${Gr("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let height_ratio = f32(${u});
        let width_ratio = f32(${y});
        let b = coords[0];
        let y = coords[1];
        let x = coords[2];
        let d = coords[3];
        // get box vals
        let y1 = getBoxes(b, 0);
        let x1 = getBoxes(b, 1);
        let y2 = getBoxes(b, 2);
        let x2 = getBoxes(b, 3);
        // get image in batch index
        let bInd = i32(round(getBoxInd(b)));
        if(bInd < 0 || bInd >= uniforms.outShape[0]) {
          return;
        }
        let height_scale = ${c};
        let width_scale = ${w};
        let in_y = ${f};
        if( in_y < 0.0 || in_y > ${i} ) {
          setOutputAtIndex(index, uniforms.extrapolationValue);
          return;
        }
        let in_x = ${C};
        if( in_x < 0.0 || in_x > ${o} ) {
          setOutputAtIndex(index, uniforms.extrapolationValue);
          return;
        }
        let sourceFracIndexCR = vec2<f32>(in_x,in_y);
        if(${this.methodId} == 1) {
          // Compute the four integer indices.
          let sourceFloorCR = vec2<i32>(sourceFracIndexCR);
          let sourceCeilCR = vec2<i32>(ceil(sourceFracIndexCR));
          let topLeft = getImage(bInd, sourceFloorCR.y, sourceFloorCR.x, d);
          let bottomLeft = getImage(bInd, sourceCeilCR.y, sourceFloorCR.x, d);
          let topRight = getImage(bInd, sourceFloorCR.y, sourceCeilCR.x, d);
          let bottomRight = getImage(bInd, sourceCeilCR.y, sourceCeilCR.x, d);
          let fracCR = sourceFracIndexCR - vec2<f32>(sourceFloorCR);
          let top = topLeft + (topRight - topLeft) * fracCR.x;
          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          let newValue = top + (bottom - top) * fracCR.y;
          setOutputAtIndex(index, newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          let sourceNearestCR = vec2<i32>(floor(
            sourceFracIndexCR + vec2<f32>(0.5,0.5)));
          let newValue = getImage(
            bInd, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutputAtIndex(index, newValue);
        }
      }
    }
    `}}let xJ={kernelName:m.CropAndResize,backendName:"webgpu",kernelFunc:l=>{let{inputs:i,backend:o,attrs:u}=l,{image:c,boxes:f,boxInd:y}=i,{cropSize:w,method:C,extrapolationValue:T}=u,x=new Spt(c.shape[3],f.shape,w,C),A=[{type:"float32",data:[T]}];return o.runWebGPUProgram(x,[c,f,y],"float32",A)}};var N6;(function(l){l.Prod="*",l.Sum="+"})(N6||(N6={}));class SP{constructor(i,o,u,c){this.variableNames=["x"],this.uniforms="index : f32,",this.size=!0,this.workgroupSize=[128,1,1],this.outputShape=o,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.exclusive=u,this.reverse=c,this.op=i,this.shaderKey=`cum_${this.op}_${this.exclusive}_${this.reverse}`}getUserCode(){let i=this.outputShape.length,o=this.op===N6.Prod?"1.0":"0.0",u=this.exclusive?o:`getX(${kJ(i,"coords",this.op)})`,c=this.outputShape[this.outputShape.length-1],f="",y="";return this.exclusive?(f=this.reverse?"end != "+(c-1):"end != 0",y=this.reverse?"end + 1":"end - 1"):(f=this.reverse?`end + pow2 < ${c}`:"end >= pow2",y=this.reverse?"end + pow2":"end - pow2"),`
      ${Gr("index")} {
       if (index < uniforms.size) {
         var coords = getCoordsFromIndex(index);

         let end = ${_P(i,"coords",this.op)};
         var val = ${u};
         let pow2 = i32(pow(2.0, uniforms.index));
         if (${f}) {
           let idx = ${y};
           ${_P(i,"coords",this.op)} = idx;
           val ${this.op}= getX(${kJ(i,"coords",this.op)});
         }
         setOutputAtIndex(index, val);
       }
      }
    `}}function kJ(l,i,o){if(l===1)return`${i}`;if(l===2)return`${i}.x, ${i}.y`;if(l===3)return`${i}.x, ${i}.y, ${i}.z`;if(l===4)return`${i}.x, ${i}.y, ${i}.z, ${i}.w`;throw Error(`Cumulative ${o} for rank ${l} is not yet supported`)}function _P(l,i,o){if(l===1)return`${i}`;if(l===2)return`${i}.y`;if(l===3)return`${i}.z`;if(l===4)return`${i}.w`;throw Error(`Cumulative ${o} for rank ${l} is not yet supported`)}function p7(l,i,o,u,c,f){let y=i.shape.length,w=m.backend_util.getAxesPermutation([u],y),C=i;w!=null&&(C=Um({inputs:{x:i},backend:o,attrs:{perm:w}}));let T=m.backend_util.getInnerMostAxes(1,y)[0];if(T!==y-1)throw new Error(`WebGPU cumprod shader expects an inner-most axis=${i.shape.length-1} but got axis=${u}`);let x=C.shape[T],A=Hd({inputs:{x:C},backend:o});for(let M=0;M<=Math.ceil(Math.log2(x))-1;M++){let $=new SP(l,C.shape,!1,f),V=A,G=[{type:"float32",data:[M]}];A=o.runWebGPUProgram($,[A],A.dtype,G),o.disposeData(V.dataId)}if(c){let M=new SP(l,C.shape,c,f),$=A,V=[{type:"float32",data:[0]}];A=o.runWebGPUProgram(M,[A],A.dtype,V),o.disposeData($.dataId)}if(w!=null){let M=Um({inputs:{x:A},backend:o,attrs:{perm:m.backend_util.getUndoAxesPermutation(w)}});return o.disposeData(A.dataId),o.disposeData(C.dataId),M}return A}let SJ={kernelName:m.Cumprod,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,exclusive:y,reverse:w}=u;return p7(N6.Prod,c,o,f,y,w)}},_J={kernelName:m.Cumsum,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,exclusive:y,reverse:w}=u;return p7(N6.Sum,c,o,f,y,w)}},CJ={kernelName:m.DenseBincount,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,weights:f}=i,{size:y,binaryOutput:w}=u,C=c.shape.length===1,T=m.util.sizeFromShape(f.shape)>0,x=f.dtype,A=C?[c.shape[0]]:[c.shape[0],c.shape[1]],M=Qc({backend:o,attrs:{shape:C?[y]:[c.shape[0],y],value:0,dtype:x}}),$=new cJ(A,T,w),V=[{type:"int32",data:[y]}],G=T?[c,f]:[c];return o.runWebGPUProgram($,G,x,V,M)}};class EJ{constructor(i,o){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.uniforms="blockSize : i32,",this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`depthToSpace_${o}`,this.dataFormat=o}getUserCode(){return`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let h = ${this.getHeightCoordString()};
          let w = ${this.getWidthCoordString()};
          let d = ${this.getDepthCoordString()};

          let in_h = h / uniforms.blockSize;
          let offset_h = h % uniforms.blockSize;
          let in_w = w / uniforms.blockSize;
          let offset_w = w % uniforms.blockSize;
          let offset_d = (offset_h * uniforms.blockSize + offset_w) *
            ${this.getOutputDepthSize()};
          let in_d = d + offset_d;

          let rlt = ${this.getInputSamplingString()};
          setOutputAtIndex(index, rlt);
        }
      }`}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?"uniforms.outShape[3]":"uniforms.outShape[1]"}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}let CP={kernelName:m.DepthToSpace,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{blockSize:f,dataFormat:y}=u,w=c.shape[0],C=(y==="NHWC"?c.shape[1]:c.shape[2])*f,T=(y==="NHWC"?c.shape[2]:c.shape[3])*f,x=(y==="NHWC"?c.shape[3]:c.shape[1])/(f*f),A=[{type:"int32",data:[f]}],M=new EJ(y==="NHWC"?[w,C,T,x]:[w,x,C,T],y);return o.runWebGPUProgram(M,[c],c.dtype,A)}};class m7{constructor(i,o,u,c=!1,f=null,y=!1){this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>,",this.workgroupSize=[16,16,1],this.outputShape=i,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),c&&this.variableNames.push("bias"),y&&this.variableNames.push("preluActivationWeights"),this.addBias=c,this.activation=f,this.hasPreluActivation=y,this.filterHeight=o,this.filterWidth=u,this.shaderKey=`depthwiseNCHW_${this.activation}_${this.filterHeight}_${this.filterWidth}`}getUserCode(){let i=this.filterWidth*this.filterHeight,o=this.workgroupSize[0]*this.workgroupSize[1]*this.workgroupSize[2],u=this.workgroupSize[1]+this.filterHeight-1,c=this.workgroupSize[0]+this.filterWidth-1;return`
      ${D0(this.activation,this.hasPreluActivation,!1,4)}

      var<workgroup> mm_Asub : array<array<f32, ${c}>, ${u}>;
      var<workgroup> mm_Bsub : array<array<f32, ${this.filterWidth}>, ${this.filterHeight}>;
      fn readX(batch : i32, channel : i32, row : i32, col : i32) -> f32 {
        var value = 0.0;
        if (row >=0 && row < uniforms.inDims[0] && col >=0 && col < uniforms.inDims[1])
        {
          value = getX(batch, channel, row, col);
        }
        return value;
      }

      ${Gr()} {
        let coords = getOutputCoords();
        let batch = coords[0];
        let xRCCorner = vec2<i32>(coords.zw) - uniforms.pads;
        let channelMul = uniforms.wShape[3];
        let d1 = coords[1] / channelMul;
        let q = coords[1] % channelMul;

        let inputRowStart = xRCCorner.x;
        let inputColStart = xRCCorner.y;

        let localRow = i32(localId.y);
        let localCol = i32(localId.x);

        // Load one tile of X into local memory.
        for (var inputRow = localRow; inputRow < ${u}; inputRow = inputRow + ${this.workgroupSize[1]}) {
          for (var inputCol = localCol; inputCol < ${c}; inputCol = inputCol + ${this.workgroupSize[0]}) {
            let rowOffset = inputRow - localRow;
            let colOffset = inputCol - localCol;
            mm_Asub[inputRow][inputCol] = readX(batch, d1, inputRowStart + rowOffset, inputColStart + colOffset);
          }
        }

        // Load one tile of W into local memory.
        var wIndex = i32(localIndex);
        ${i<o?`if (wIndex < ${i})`:`for(; wIndex < ${i}; wIndex = wIndex + ${o})`}

        {
          let wRow = wIndex / ${this.filterWidth};
          let wCol = wIndex % ${this.filterWidth};
          mm_Bsub[wRow][wCol] = getW(wRow, wCol, d1, q);
        }

        workgroupBarrier();

        var value = 0.0;
        for (var wR = 0; wR < ${this.filterHeight}; wR = wR + 1) {
          for (var wC = 0; wC < ${this.filterWidth}; wC = wC + 1) {
            let xVal = mm_Asub[localRow + wR][localCol + wC];
            let wVal = mm_Bsub[wR][wC];
            value = fma(xVal, wVal, value);
          }
        }
        ${u1(this.addBias,this.activation)}
        if (coordsInBounds4D(coords, uniforms.outShape)) {
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }
    `}}class EP{constructor(i,o=!1,u=null,c=!1){this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>, virtualWidth : i32,",this.workgroupSize=[64,1,1],this.workPerThread=4,this.outputComponent=4,this.outputShape=i.outShape,this.virtualWidth=Math.ceil(this.outputShape[2]/this.workPerThread)*this.workPerThread;let f=[this.outputShape[0],this.outputShape[1],this.virtualWidth,this.outputShape[3]];this.dispatchLayout=hi(f),this.dispatch=Nr(this.dispatchLayout,f,this.workgroupSize,[this.outputComponent*this.workPerThread,1,1]),m.util.assert(i.dataFormat==="channelsLast",()=>"TODO: NCHW is unimplemented"),o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),this.convInfo=i,this.addBias=o,this.activation=u,this.hasPreluActivation=c,this.shaderKey=`depthwiseVec4_${u}_${this.convInfo.filterHeight}_${this.convInfo.filterWidth}_${this.convInfo.strideHeight}_${this.convInfo.strideWidth}_${this.workPerThread}`}getUserCode(){let i=(this.workPerThread-1)*this.convInfo.strideWidth+this.convInfo.filterWidth,o=this.convInfo.strideHeight,u=this.convInfo.strideWidth;return`
      ${D0(this.activation,this.hasPreluActivation,!0,4)}
      fn readX(batch : i32, row : i32, col : i32, channel : i32) -> vec4<f32> {
        var value = vec4<f32>(0.0);
        if (col >=0 && col < uniforms.inDims[1]) {
          value = getX(batch, row, col, channel);
        }
        return value;
      }

      ${Gr("index")} {
        let width0 = uniforms.outShape[3] / ${this.outputComponent};
        let d1 = (index % width0) * ${this.outputComponent};
        var index1 = index / width0;
        let width1 = uniforms.virtualWidth / ${this.workPerThread};
        let c = (index1 % width1) * ${this.workPerThread};
        index1 = index1 / width1;
        let r = index1 % uniforms.outShape[1];
        let batch = index1 / uniforms.outShape[1];

        let xRCCorner = vec2<i32>(r, c) * vec2<i32>(${o}, ${u}) - uniforms.pads;

        let xRCorner = xRCCorner.x;
        let xCCorner = xRCCorner.y;
        var xVals : array<vec4<f32>, ${i}>;
        var dotProd : array<vec4<f32>, ${this.workPerThread}>;
        for (var i = 0; i < ${this.workPerThread}; i++) {
          dotProd[i] = vec4<f32>(0.0);
        }

        // Use constant instead of uniform can give better performance.
        for (var wR = 0; wR < ${this.convInfo.filterHeight}; wR = wR + 1) {
          let xR = xRCorner + wR;
          if (xR >=0 && xR < uniforms.inDims[0]) {
            for (var i = 0; i < ${i}; i++) {
              xVals[i] = readX(batch, xR, xCCorner + i, d1);
            }
            for (var wC = 0; wC < ${this.convInfo.filterWidth}; wC = wC + 1) {
              let wValue = getW(wR, wC, d1, 0);
              for (var i = 0; i < ${this.workPerThread}; i++) {
                dotProd[i] = fma(xVals[i * ${u} + wC], wValue, dotProd[i]);
              }
            }
          }
        }

        for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let coords = vec4<i32>(batch, r, c + i, d1);
          if (coordsInBounds4D(coords, uniforms.outShape)) {
            var value = dotProd[i];
            ${u1(this.addBias,this.activation)}
            setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
          }
        }
      }
    `}}class TP{constructor(i,o=!1,u=null,c=!1){this.variableNames=["x","W"],this.uniforms=`pads : vec2<i32>, inDims : vec2<i32>, filterHeight : i32,
      filterWidth : i32, strides : vec2<i32>, dilations : vec2<i32>,`,this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=i.outShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=i.dataFormat==="channelsLast",o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),this.convInfo=i,this.addBias=o,this.activation=u,this.hasPreluActivation=c,this.shaderKey=`depthwise_${this.activation}_${this.isChannelsLast}`}getUserCode(){let i=this.isChannelsLast?"getX(batch, xR, xC, d1);":"getX(batch, d1, xR, xC);";return`
      ${D0(this.activation,this.hasPreluActivation,!1,4)}

      ${Gr("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let batch = coords[0];
          let xRCCorner = vec2<i32>(coords.${this.isChannelsLast?"yz":"zw"}) * uniforms.strides - uniforms.pads;
          let d2 = coords[${this.isChannelsLast?3:1}];
          let channelMul = uniforms.wShape[3];
          let d1 = d2 / channelMul;
          let q = d2 % channelMul;

          let inputRowStart = xRCCorner.x;
          let inputColStart = xRCCorner.y;
          let inputRowEnd = inputRowStart + uniforms.filterHeight *
              uniforms.dilations[0];
          let inputColEnd = inputColStart + uniforms.filterWidth *
              uniforms.dilations[1];

          // Convolve x(?, ?, d1)|x(d1, ?, ?) with w(:, :, d1, q) to get
          // y(yR, yC, d2)|y(d2, yR, yC). ? = to be determined. : = across all
          // values in that axis. x(?, ?, d1) and y(yR, yC, d2) is for NHWC.
          // x(d1, ?, ?) and y(d2, yR, yC) is for NCHW.
          var value = 0.0;

          // Extract if checking out of for loop for performance.
          if (inputRowStart >= 0 && inputColStart >= 0 &&
            inputRowEnd < uniforms.inDims[0] &&
                inputColEnd < uniforms.inDims[1]) {
              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {
                let xR = inputRowStart + wR * uniforms.dilations[0];

                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {
                  let xC = inputColStart + wC * uniforms.dilations[1];

                  let xVal = ${i};
                  let wVal = getW(wR, wC, d1, q);
                  value = value + xVal * wVal;
                }
              }
            } else {
              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {
                let xR = inputRowStart + wR * uniforms.dilations[0];

                if (xR < 0 || xR >= uniforms.inDims[0]) {
                  continue;
                }

                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {
                  let xC = inputColStart + wC * uniforms.dilations[1];

                  if (xC < 0 || xC >= uniforms.inDims[1]) {
                    continue;
                  }

                  let xVal = ${i};
                  let wVal = getW(wR, wC, d1, q);
                  value = value + xVal * wVal;
                }
              }
            }
            ${u1(this.addBias,this.activation)}
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }
    `}}let TJ={kernelName:m.DepthwiseConv2dNative,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f}=i,{strides:y,pad:w,dataFormat:C,dilations:T,dimRoundingMode:x}=u,A=m.backend_util.convertConv2DDataFormat(C),M=T;M==null&&(M=[1,1]);let $=m.backend_util.computeConv2DInfo(c.shape,f.shape,y,M,w,x,!0,A),V=[{type:"int32",data:[$.padInfo.top,$.padInfo.left]},{type:"int32",data:[$.inHeight,$.inWidth]}],G=$.dataFormat==="channelsLast",Q;return!G&&$.inHeight>16&&$.inWidth>16&&$.strideHeight===1&&$.strideWidth===1&&$.dilationWidth===1&&$.dilationHeight===1&&$.inChannels===$.outChannels?Q=new m7($.outShape,$.filterHeight,$.filterWidth):G&&$.outHeight>4&&$.outWidth>4&&$.strideWidth<=2&&$.inChannels===$.outChannels&&$.dilationHeight===1&&$.dilationWidth===1&&$.inChannels%4==0?(Q=new EP($),V.push({type:"int32",data:[Q.virtualWidth]})):(Q=new TP($),V.push({type:"int32",data:[$.filterHeight]},{type:"int32",data:[$.filterWidth]},{type:"int32",data:[$.strideHeight,$.strideWidth]},{type:"int32",data:[$.dilationHeight,$.dilationWidth]})),o.runWebGPUProgram(Q,[c,f],c.dtype,V)}};class AJ{constructor(i){this.variableNames=["x","dy"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>, outHeight : i32,
      outWidth : i32, inHeight : i32, inWidth : i32, batchSize : i32, channelMul : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i.filterShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_filter"}getUserCode(){return`
      ${Gr("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wR = coords[0];
        let wC = coords[1];
        let d1 = coords[2];
        let dm = coords[3];
        let d2 = d1 * uniforms.channelMul + dm;

        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b++) {
          for (var yR = 0; yR < uniforms.outHeight; yR++) {
            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];

            if (xR < 0 || xR >= uniforms.inHeight) {
              continue;
            }

            for (var yC = 0; yC < uniforms.outWidth; yC++) {
              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];

              if (xC < 0 || xC >= uniforms.inWidth) {
                continue;
              }

              let dyValue = getDy(b, yR, yC, d2);
              let xValue = getX(b, xR, xC, d1);
              dotProd += xValue * dyValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}}class g7{constructor(i){this.variableNames=["dy","W"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32, channelMul : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i.inShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_input"}getUserCode(){return`
      ${Gr("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d1 = coords[3];
        let dyCorner = coords.yz - uniforms.pads;
        let dyRCorner = dyCorner.x;
        let dyCCorner = dyCorner.y;

        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }

          let idyR = i32(dyR);
          let wRPerm = uniforms.filterDims[0] - 1 - wR;

          for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }

            let idyC = i32(dyC);
            let wCPerm = uniforms.filterDims[1] - 1 - wC;

            for (var dm = 0; dm < uniforms.channelMul; dm++) {
              let d2 = d1 * uniforms.channelMul + dm;
              let xValue = getDy(batch, idyR, idyC, d2);
              let wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}}let AP={kernelName:m.DepthwiseConv2dNativeBackpropFilter,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,dy:f}=i,{strides:y,dilations:w,pad:C,dimRoundingMode:T,filterShape:x}=u,A=m.backend_util.computeConv2DInfo(c.shape,x,y,w,C,T,!0),M=new AJ(A),$=[{type:"int32",data:[A.strideHeight,A.strideWidth]},{type:"int32",data:[A.padInfo.top,A.padInfo.left]},{type:"int32",data:[A.filterHeight,A.filterWidth]},{type:"int32",data:[A.outHeight]},{type:"int32",data:[A.outWidth]},{type:"int32",data:[A.inHeight]},{type:"int32",data:[A.inWidth]},{type:"int32",data:[A.batchSize]},{type:"int32",data:[A.outChannels/A.inChannels]}];return o.runWebGPUProgram(M,[c,f],"float32",$)}},IP={kernelName:m.DepthwiseConv2dNativeBackpropInput,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,filter:f}=i,{strides:y,dilations:w,pad:C,dimRoundingMode:T,inputShape:x}=u,A=m.backend_util.computeConv2DInfo(x,f.shape,y,w,C,T,!0),M=new g7(A),$=[{type:"int32",data:[A.strideHeight,A.strideWidth]},{type:"int32",data:[A.filterHeight-1-A.padInfo.top,A.filterWidth-1-A.padInfo.left]},{type:"int32",data:[A.filterHeight,A.filterWidth]},{type:"int32",data:[A.outHeight]},{type:"int32",data:[A.outWidth]},{type:"int32",data:[A.outChannels/A.inChannels]}];return o.runWebGPUProgram(M,[c,f],c.dtype,$)}};class jb{constructor(i){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[i,i],this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="diag"}getUserCode(){return`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let value = select(0.0, getX(coords[0]), coords[0] == coords[1]);
          setOutputAtIndex(index, value);
        }
      }
    `}}let _pt={kernelName:m.Diag,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{x:u}=i,c=[...u.shape,...u.shape],f=m.util.sizeFromShape(u.shape),y=zi({inputs:{x:u},backend:o,attrs:{shape:[f]}}),w=new jb(f),C=o.runWebGPUProgram(w,[y],y.dtype),T=zi({inputs:{x:C},backend:o,attrs:{shape:c}});return o.disposeData(y.dataId),o.disposeData(C.dataId),T}};class NP{constructor(i){this.variableNames=["x","w"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i.outShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="dilation2d"}getUserCode(){return`
       ${Gr("index")} {
         if (index < uniforms.size) {
           let neg_infinity = -3.4e38;
           let coords = getOutputCoords();
           let batch = coords.x;
           let d1 = coords.w;
           let outTopLeftCorner = coords.yz * uniforms.strides - uniforms.pads;
           let hBeg = outTopLeftCorner.x;
           let wBeg = outTopLeftCorner.y;

           var curVal = neg_infinity;
           for (var h = 0; h < uniforms.filterDims[0]; h = h + 1) {
             let hIn = hBeg + h * uniforms.dilations[0];

             if (hIn >= 0 && hIn < uniforms.xShape[1]) {
               for (var w = 0; w < uniforms.filterDims[1]; w = w + 1) {
                 let wIn = wBeg + w * uniforms.dilations[1];

                 if (wIn >= 0 && wIn < uniforms.xShape[2]) {
                   let val = getX(batch, hIn, wIn, d1) + getW(h, w, d1);
                   if (val > curVal) {
                     curVal = val;
                   }
                 }
               }
             }
           }

           setOutputAtIndex(index, curVal);
         }
       }
     `}}let IJ={kernelName:m.Dilation2D,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f}=i,{strides:y,pad:w,dilations:C}=u,T=m.backend_util.computeDilation2DInfo(c.shape,f.shape,y,w,"NHWC",C),x=[T.padInfo.top,T.padInfo.left],A=[{type:"int32",data:[T.filterHeight,T.filterWidth]},{type:"int32",data:[...x]},{type:"int32",data:[T.strideHeight,T.strideWidth]},{type:"int32",data:[T.dilationHeight,T.dilationWidth]}],M=new NP(T);return o.runWebGPUProgram(M,[c,f],c.dtype,A)}};class w4{constructor(i,o){if(this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=i.inShape,this.dispatchLayout=hi(i.outShape),this.dispatch=Nr(this.dispatchLayout,i.outShape,this.workgroupSize),o!=="float32"&&o!=="int32")throw new Error(`Dilation2DBackpropInput only supports float32 and int32
          types, does not support ${o} type.`);this.type=o,this.shaderKey="dilation2DBackpropInput"}getUserCode(){return`
       ${Gr("index")} {
         if (index < uniforms.dySize) {
           let coords = getDyCoordsFromIndex(index);
           let b = coords[0];
           let r = coords[1];
           let c = coords[2];
           let d = coords[3];

           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;
           var curVal = -3.4e38;  // neg_infinity
           var xRMax = 0;
           var xCMax = 0;

           // In the case of multiple argmax branches, we only back-propagate
           // along the last branch, i.e., the one with largest value of
           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling
           // backward routines.
           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
             let xR = dyCorner.x + wR * uniforms.dilations[0];

             if (xR >= 0 && xR < uniforms.xShape[1]) {
               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
                 let xC = dyCorner.y + wC * uniforms.dilations[1];

                 if (xC >= 0 && xC < uniforms.xShape[2]) {
                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);
                   if (val > curVal) {
                     curVal = val;
                     xRMax = xR;
                     xCMax = xC;
                   }
                 }
               }
             }
           }

           let flatIndexIn = d + uniforms.xShape[3] *
               (xCMax + uniforms.xShape[2] * (xRMax + uniforms.xShape[1] * b));
           let value = getDy(b, r, c, d);
           ${o1("&result[flatIndexIn]","value",this.type)}
         }
       }
     `}}class Es{constructor(i,o,u){if(this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=i.filterShape,this.dispatchLayout=hi(i.outShape),this.dispatch=Nr(this.dispatchLayout,i.outShape,this.workgroupSize),u!=="float32"&&u!=="int32")throw new Error(`Dilation2DBackpropFilter only supports float32 and int32
          types, does not support ${u} type.`);this.type=u,this.shaderKey="dilation2DBackpropFilter"}getUserCode(){return`
       ${Gr("index")} {
         if (index < uniforms.dySize) {
           let coords = getDyCoordsFromIndex(index);
           let b = coords[0];
           let r = coords[1];
           let c = coords[2];
           let d = coords[3];

           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;
           var curVal = -3.4e38;  // neg_infinity
           var wRMax = 0;
           var wCMax = 0;

           // In the case of multiple argmax branches, we only back-propagate
           // along the last branch, i.e., the one with largest value of
           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling
           // backward routines.
           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
             let xR = dyCorner.x + wR * uniforms.dilations[0];

             if (xR >= 0 && xR < uniforms.xShape[1]) {
               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
                 let xC = dyCorner.y + wC * uniforms.dilations[1];

                 if (xC >= 0 && xC < uniforms.xShape[2]) {
                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);
                   if (val > curVal) {
                     curVal = val;
                     wRMax = wR;
                     wCMax = wC;
                   }
                 }
               }
             }
           }

           let flatIndexIn = d + uniforms.wShape[2] * (wCMax + wRMax * uniforms.wShape[1]);
           let value = getDy(b, r, c, d);
           ${o1("&result[flatIndexIn]","value",this.type)}
         }
       }
     `}}let Cpt={kernelName:m.Dilation2DBackpropFilter,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f,dy:y}=i,{strides:w,pad:C,dilations:T}=u,x=m.backend_util.computeDilation2DInfo(c.shape,f.shape,w,C,"NHWC",T),A=f.dtype,M=new Es(x,f.shape,A),$=[{type:"int32",data:[x.filterHeight,x.filterWidth]},{type:"int32",data:[x.padInfo.top,x.padInfo.left]},{type:"int32",data:[x.strideHeight,x.strideWidth]},{type:"int32",data:[x.dilationHeight,x.dilationWidth]},{type:"int32",data:[m.util.sizeFromShape(x.outShape)]}],V=Qc({backend:o,attrs:{shape:f.shape,value:0,dtype:A}});return o.runWebGPUProgram(M,[c,f,y],A,$,V)}},Ept={kernelName:m.Dilation2DBackpropInput,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f,dy:y}=i,{strides:w,pad:C,dilations:T}=u,x=m.backend_util.computeDilation2DInfo(c.shape,f.shape,w,C,"NHWC",T),A=c.dtype,M=new w4(x,A),$=[{type:"int32",data:[x.filterHeight,x.filterWidth]},{type:"int32",data:[x.padInfo.top,x.padInfo.left]},{type:"int32",data:[x.strideHeight,x.strideWidth]},{type:"int32",data:[x.dilationHeight,x.dilationWidth]},{type:"int32",data:[m.util.sizeFromShape(x.outShape)]}],V=Qc({backend:o,attrs:{shape:x.inShape,value:0,dtype:A}});return o.runWebGPUProgram(M,[c,f,y],A,$,V)}};class Tpt{constructor(i,o,u){this.variableNames=["Image"],this.uniforms="alpha: f32,",this.workgroupSize=[64,1,1],this.pixelsOpType=Lb.DRAW,this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.type=o,this.textureFormat=u,this.shaderKey=`draw_${o}_${u}`}getUserCode(){let i,o=this.type==="float32"?"value":"value / 255.0";return i=`
      if (uniforms.numChannels == 1) {
        rgba[0] = ${o};
        rgba[1] = ${o};
        rgba[2] = ${o};
      } else {
        rgba[d] = ${o};
      }`,`
       @group(0) @binding(0) var outImage : texture_storage_2d<${this.textureFormat}, write>;
       ${Gr("index")} {
         if (index < uniforms.size) {
           var rgba = vec4<f32>(0.0, 0.0, 0.0, uniforms.alpha);
           for (var d = 0; d < uniforms.numChannels; d = d + 1) {
             let value = f32(inBuf[index * uniforms.numChannels + d]);
             ${i}
           }
           rgba.x = rgba.x * rgba.w;
           rgba.y = rgba.y * rgba.w;
           rgba.z = rgba.z * rgba.w;
           let coords = getCoordsFromIndex(index);
           textureStore(outImage, vec2<i32>(coords.yx), rgba);
         }
       }
      `}}let Apt={kernelName:m.Draw,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{image:c}=i,{canvas:f,options:y}=u,[w,C]=c.shape.slice(0,2),{imageOptions:T}=y||{},x=T?.alpha||1,A=o.device.features.has("bgra8unorm-storage")?"bgra8unorm":"rgba8unorm",M=[w,C],$=new Tpt(M,c.dtype,A);f.width=C,f.height=w;let V="webgpu",G,Q=f.getContext(V);Q||(G=new OffscreenCanvas(C,w),Q=G.getContext(V));let nt=c.shape.length===3?c.shape[2]:1;Q.configure({device:o.device,format:A,usage:GPUTextureUsage.STORAGE_BINDING,alphaMode:"premultiplied"});let it="int32",ht=o.makeTensorInfo(M,it),kt=o.tensorMap.get(ht.dataId);kt.resource=Q.getCurrentTexture(),kt.external=!0;let Nt=[{type:"uint32",data:[nt]},{type:"float32",data:[x]}];if(o.runWebGPUProgram($,[c],it,Nt,ht),G){let $t=f.getContext("2d");if(!$t)throw new Error("Please make sure this canvas has only been used for 2d or webgpu context!");$t.drawImage(G,0,0)}return o.disposeData(ht.dataId),c}},NJ=Dl({opType:Ma.MUL,cpuKernelImpl:nP,supportsComplex:!0}),y7={kernelName:m.Multiply,backendName:"webgpu",kernelFunc:NJ};function MP(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,keepDims:y}=u;return J2(c,f,y,"sum",o)}let MJ={kernelName:m.Sum,backendName:"webgpu",kernelFunc:MP},DJ={kernelName:m.Einsum,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{equation:c}=u,f=i,{allDims:y,summedDims:w,idDims:C}=m.backend_util.decodeEinsumEquation(c,f.length);m.backend_util.checkEinsumDimSizes(y.length,C,f);let{path:T,steps:x}=m.backend_util.getEinsumComputePath(w,C),A=x.length,M=null,$=y.length,V=[];for(let G=0;G<A;++G){for(let Q of x[G]){let{permutationIndices:nt,expandDims:it}=m.backend_util.getEinsumPermutation($,C[Q]),ht;m.backend_util.isIdentityPermutation(nt)?ht=f[Q]:(ht=Um({inputs:{x:f[Q]},backend:o,attrs:{perm:nt}}),V.push(ht));let kt=ht.shape.slice();for(let Nt=0;Nt<it.length;++Nt)kt.splice(it[Nt],0,1);m.util.arraysEqual(ht.shape,kt)||(ht=zi({inputs:{x:ht},backend:o,attrs:{shape:kt}}),V.push(ht)),M===null?M=ht:(M=NJ({inputs:{a:ht,b:M},backend:o}),V.push(M))}G<A-1&&(T[G]>=0&&(M=MP({inputs:{x:M},backend:o,attrs:{axis:T[G]-(y.length-$),keepDims:!1}}),V.push(M)),$--)}for(let G of V)G!==M&&o.disposeData(G.dataId);return M}},RJ=go({opType:zr.ELU}),FJ={kernelName:m.Elu,backendName:"webgpu",kernelFunc:RJ},Ipt={kernelName:m.EluGrad,backendName:"webgpu",kernelFunc:l=>{let{inputs:i,backend:o}=l,{dy:u,y:c}=i,f=new n7(Ma.ELU_DER,u.shape,c.shape);return o.runWebGPUProgram(f,[u,c],u.dtype)}},Npt=Dl({opType:Ma.EQUAL,dtype:"bool",cpuKernelImpl:qQ}),DP={kernelName:m.Equal,backendName:"webgpu",kernelFunc:Npt},Lkt=go({opType:zr.ERF}),$kt={kernelName:m.Erf,backendName:"webgpu",kernelFunc:Lkt},zkt=go({opType:zr.EXP,cpuKernelImpl:XQ,dtype:"float32"}),Pkt={kernelName:m.Exp,backendName:"webgpu",kernelFunc:zkt};function OJ(l){let{inputs:i,attrs:o,backend:u}=l,{dim:c}=o,{input:f}=i,y=f.shape.length,w=f.shape.slice(),C=c;return c<0&&(m.util.assert(-(y+1)<=c,()=>`Axis must be in the interval [${-(y+1)}, ${y}]`),C=y+c+1),w.splice(C,0,1),zi({inputs:{x:f},backend:u,attrs:{shape:w}})}let Bkt={kernelName:m.ExpandDims,backendName:"webgpu",kernelFunc:OJ},jkt=go({opType:zr.EXPM1,cpuKernelImpl:x6}),Ukt={kernelName:m.Expm1,backendName:"webgpu",kernelFunc:jkt};class Mpt{constructor(i,o){this.variableNames=["real","imag"],this.outputShape=[],this.uniforms="exponentMultiplier : f32, denominator: f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=o,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.component=i,this.shaderKey=`fft_${i}`}getUserCode(){return`
    fn unaryOpComplex(real: f32, expR: f32, imag: f32, expI: f32) -> f32 {
      ${this.component==="real"?"return real * expR - imag * expI;":"return real * expI + imag * expR;"}
    }

    fn mulMatDFT(batch: i32, index: i32) -> f32 {
      let indexRatio = f32(index) / f32(uniforms.realShape[1]);
      let exponentMultiplierTimesIndexRatio =
          uniforms.exponentMultiplier * indexRatio;

      var result = 0.0;

      for (var i = 0; i < uniforms.realShape[1]; i = i + 1) {
        // x = (-2|2 * PI / N) * index * i;
        let x = exponentMultiplierTimesIndexRatio * f32(i);
        let expR = cos(x);
        let expI = sin(x);
        let real = getReal(batch, i);
        let imag = getImag(batch, i);

        result = result +
            unaryOpComplex(real, expR, imag, expI) / uniforms.denominator;
      }

      return result;
    }

    ${Gr("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        setOutputAtIndex(index, mulMatDFT(coords[0], coords[1]));
      }
    }
  `}}function LJ(l,i,o){let u=o.tensorMap.get(l.dataId),c=m.util.sizeFromShape(l.shape),f=l.shape[l.shape.length-1],y=[],w=zi({inputs:{x:l},backend:o,attrs:{shape:[c/f,f]}});y.push(w);let C=w.shape,T=new Mpt("real",C),x=new Mpt("imag",C),A=[{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:C},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:C}],M=[{type:"float32",data:[i?2*Math.PI:-2*Math.PI]},{type:"float32",data:[i?C[1]:1]}],$=o.runWebGPUProgram(T,A,"float32",M);y.push($);let V=o.runWebGPUProgram(x,A,"float32",M);y.push(V);let G=$b({inputs:{real:$,imag:V},backend:o});y.push(G);let Q=zi({inputs:{x:G},backend:o,attrs:{shape:l.shape}});return y.forEach(nt=>o.disposeData(nt.dataId)),Q}let Dpt={kernelName:m.FFT,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{input:u}=i;return LJ(u,!1,o)}};class Rpt{constructor(i){this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="flipLeftRight"}getUserCode(){return`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let coordX = uniforms.xShape[2] - coords[2] - 1;
          let outputValue = getX(coords[0], coords[1], coordX, coords[3]);
          setOutputAtIndex(index, outputValue);
        }
      }
    `}}let Fpt={kernelName:m.FlipLeftRight,backendName:"webgpu",kernelFunc:({inputs:l,backend:i})=>{let{image:o}=l,u=i,c=new Rpt(o.shape);return u.runWebGPUProgram(c,[o],o.dtype)}},Opt=go({opType:zr.FLOOR,cpuKernelImpl:jft}),Lpt={kernelName:m.Floor,backendName:"webgpu",kernelFunc:Opt},$pt=Dl({opType:Ma.FLOOR_DIV,cpuKernelImpl:d4,dtype:"int32"}),zpt={kernelName:m.FloorDiv,backendName:"webgpu",kernelFunc:$pt};class Ppt{constructor(i,o,u=!1){this.pixelsOpType=Lb.FROM_PIXELS,this.outputShape=[0],this.variableNames=[],this.workgroupSize=[256,1,1],this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize,[o,1,1]),this.importVideo=u,this.shaderKey=`fromPixels_${this.importVideo}`}getUserCode(){let i=this.importVideo?"textureLoad(src, vec2<i32>(coords.yx));":"textureLoad(src, vec2<i32>(coords.yx), 0)";return`
      @binding(1) @group(0) var src: ${this.importVideo?"texture_external":"texture_2d<f32>"};
      ${Gr("index")} {
        let flatIndex = index * uniforms.numChannels;
        if (flatIndex < uniforms.size) {
          let coords = getCoordsFromIndex(flatIndex);
          let values = ${i};
          for (var i = 0; i < uniforms.numChannels; i = i + 1) {
            result[flatIndex + i] = i32(floor(255.0 * values[i]));
          }
        }
      }
  `}}let Bpt={kernelName:m.FromPixels,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{pixels:c}=i,{numChannels:f}=u;if(c==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let y=typeof HTMLVideoElement<"u"&&c instanceof HTMLVideoElement,w=typeof HTMLImageElement<"u"&&c instanceof HTMLImageElement,C=typeof HTMLCanvasElement<"u"&&c instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&c instanceof OffscreenCanvas,T=typeof ImageBitmap<"u"&&c instanceof ImageBitmap,[x,A]=y?[c.videoWidth,c.videoHeight]:[c.width,c.height],M=[A,x,f],$=(0,m.env)().getBool("WEBGPU_IMPORT_EXTERNAL_TEXTURE")&&y,V=y||w;if(T||C||V){let it;if($)it=o.device.importExternalTexture({source:c});else{if(V){let De=(0,m.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");Ub!=null&&De===x4||(x4=De,Ub=document.createElement("canvas").getContext("2d",{willReadFrequently:x4})),Ub.canvas.width=x,Ub.canvas.height=A,Ub.drawImage(c,0,0,x,A),c=Ub.canvas}let re=GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING,ue="rgba8unorm",be=o.textureManager.acquireTexture(M[1],M[0],ue,re);o.queue.copyExternalImageToTexture({source:c},{texture:be},[M[1],M[0]]),it=be}let ht=m.util.sizeFromShape(M),kt=m.util.computeStrides(M),Nt=new Ppt(M,f,$),$t=[{type:"uint32",data:[ht]},{type:"uint32",data:[f]},{type:"uint32",data:[...kt]}],Ut=o.makeTensorInfo([A,x],"int32");o.tensorMap.get(Ut.dataId).resource=it;let Pt=o.runWebGPUProgram(Nt,[Ut],"int32",$t);return o.disposeData(Ut.dataId),Pt}let G=c.data,Q=G;if(f!=null&&f!==4){Q=new Uint8Array(c.width*c.height*f);let it=G.length,ht=0;for(let kt=0;kt<it;kt++)kt%4<f&&(Q[ht++]=G[kt])}let nt=o.makeTensorInfo(M,"int32",new Int32Array(Q));return o.uploadToGPU(nt.dataId),nt}},Ub,x4=(0,m.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");class jpt{constructor(i,o,u,c,f){this.uniforms="varianceEpsilon : f32,",this.workgroupSize=[128,1,1],this.size=!0,this.variableNames=["x","mean","variance"],m.backend_util.assertAndGetBroadcastShape(i,o),m.backend_util.assertAndGetBroadcastShape(i,u),this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),c!=null&&(m.backend_util.assertAndGetBroadcastShape(i,c),this.variableNames.push("offset")),f!=null&&(m.backend_util.assertAndGetBroadcastShape(i,f),this.variableNames.push("scale")),this.offsetShape=c,this.scaleShape=f,this.shaderKey="batchNorm"}getUserCode(){let i="0.0";this.offsetShape!=null&&(i="getOffsetByOutputIndex(index)");let o="1.0";return this.scaleShape!=null&&(o="getScaleByOutputIndex(index)"),`
      ${Gr("index")} {
        if (index < uniforms.size)
        {
          let xValue = getXByOutputIndex(index);
          let meanValue = getMeanByOutputIndex(index);
          let varianValue = getVarianceByOutputIndex(index);
          let offsetValue = ${i};
          let scaleValue = ${o};
          let inv = scaleValue * inverseSqrt(varianValue + f32(uniforms.varianceEpsilon));
          setOutputAtIndex(index,dot(vec3<f32>(xValue, -meanValue, offsetValue), vec3<f32>(inv, inv, 1.0)));
        }
      }
  `}}let $J={kernelName:m.FusedBatchNorm,backendName:"webgpu",kernelFunc:({inputs:l,attrs:i,backend:o})=>{let{x:u,scale:c,offset:f,mean:y,variance:w}=l,{varianceEpsilon:C}=i,T=o,x=[u,y,w],A=null;f!=null&&(A=f.shape,x.push(f));let M=null;c!=null&&(M=c.shape,x.push(c));let $=new jpt(u.shape,y.shape,w.shape,A,M),V=[{type:"float32",data:[C]}];return T.runWebGPUProgram($,x,u.dtype,V)}},Upt={kernelName:m.FusedConv2D,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f,bias:y,preluActivationWeights:w}=i,{strides:C,pad:T,dataFormat:x,dilations:A,dimRoundingMode:M,activation:$,leakyreluAlpha:V}=u,G=m.backend_util.convertConv2DDataFormat(x);return gJ({x:c,filter:f,convInfo:m.backend_util.computeConv2DInfo(c.shape,f.shape,C,A,T,M,!1,G),backend:o,bias:y,preluActivationWeights:w,leakyreluAlpha:V,activation:$})}},Wpt={kernelName:m.FusedDepthwiseConv2D,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,filter:f,bias:y,preluActivationWeights:w}=i,{strides:C,pad:T,dilations:x,dimRoundingMode:A,activation:M,leakyreluAlpha:$}=u,V=x;V==null&&(V=[1,1]),m.util.assert(m.backend_util.eitherStridesOrDilationsAreOne(C,V),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${C} and dilations '${V}'`);let G=m.backend_util.computeConv2DInfo(c.shape,f.shape,C,V,T,A,!0),Q=[c,f],nt=y!=null,it=w!=null;nt&&Q.push(y),it&&Q.push(w);let ht=[{type:"int32",data:[G.padInfo.top,G.padInfo.left]},{type:"int32",data:[G.inHeight,G.inWidth]}],kt;return G.outHeight>4&&G.outWidth>4&&G.strideWidth<=2&&G.inChannels===G.outChannels&&G.dilationHeight===1&&G.dilationWidth===1&&G.inChannels%4==0?(kt=new EP(G,nt,M,it),ht.push({type:"int32",data:[kt.virtualWidth]})):(kt=new TP(G,nt,M,it),ht.push({type:"int32",data:[G.filterHeight]},{type:"int32",data:[G.filterWidth]},{type:"int32",data:[G.strideHeight,G.strideWidth]},{type:"int32",data:[G.dilationHeight,G.dilationWidth]})),M==="leakyrelu"&&(ht.push({type:"float32",data:[$]}),kt.uniforms+=" alpha : f32,"),o.runWebGPUProgram(kt,Q,"float32",ht)}};class RP{constructor(i,o){this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=o,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`gathernd_${i}`,this.sliceDim=i,this.uniforms=`sliceDim : i32, strides : ${ol(i)},`}getUserCode(){let i;return i=this.sliceDim>1?"uniforms.strides[j]":"uniforms.strides",`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          var flattenIndex = 0;
          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {
            let indexTemp = i32(round(getIndices(coords[0], j)));
            let strideNum = ${i};
            flattenIndex = flattenIndex + indexTemp * strideNum;
          }

          setOutputAtIndex(index, getA(flattenIndex, coords[1]));
        }
      }
      `}}let Vpt={kernelName:m.GatherNd,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{params:u,indices:c}=i,f=c.shape,y=f[f.length-1],w=m.util.sizeFromShape(u.shape),[C,T,x,A]=m.backend_util.prepareAndValidate(u,c),M=zi({inputs:{x:c},backend:o,attrs:{shape:[T,y]}}),$=zi({inputs:{x:u},backend:o,attrs:{shape:[m.util.sizeFromShape(u.shape)/x,x]}});if(o.shouldExecuteOnCPU([u,c])||u.dtype==="string"){let it=o.readSync(c.dataId),ht=o.bufferSync(u),kt=Uft(it,ht,u.dtype,T,y,x,A,u.shape,w);return o.makeTensorInfo(C,u.dtype,kt.values)}let V=new RP(y,[T,x]),G=[{type:"int32",data:[y]},{type:"int32",data:A}],Q=o.runWebGPUProgram(V,[$,M],$.dtype,G),nt=zi({inputs:{x:Q},backend:o,attrs:{shape:C}});return o.disposeData(M.dataId),o.disposeData($.dataId),o.disposeData(Q.dataId),nt}};class k4{constructor(i,o){this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i.slice(),this.aShape=i,this.outputShape=o,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="gather"}getUserCode(){let i=function(o){let u=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[];for(let f=0;f<o.length;f++)f===2?c.push("indexZ"):c.push(`${u[f]}`);return c.join()}(this.aShape);return`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          let indexZ = i32(getIndices(resRC.x, resRC.z));
          let inBounds = select(0.0, 1.0, indexZ >= 0 && indexZ < uniforms.aShape[2]);
          setOutputAtIndex(index, inBounds * getA(${i}));
        }
      }
    `}}function S4(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,indices:f}=i,{axis:y,batchDims:w}=u,C=m.util.parseAxisParam(y,c.shape)[0],T=m.backend_util.segment_util.collectGatherOpShapeInfo(c,f,C,w),x=m.util.sizeFromShape(f.shape),A=[],M=zi({inputs:{x:c},backend:o,attrs:{shape:[T.batchSize,T.outerSize,T.dimSize,T.sliceSize]}}),$=zi({inputs:{x:f},backend:o,attrs:{shape:[T.batchSize,x/T.batchSize]}});A.push(M),A.push($);let V=[T.batchSize,T.outerSize,x/T.batchSize,T.sliceSize];if(o.shouldExecuteOnCPU([c,f])){let it=o.tensorMap.get($.dataId).values,ht=(0,m.buffer)($.shape,$.dtype,it),kt=o.tensorMap.get(M.dataId).values,Nt=(0,m.buffer)(M.shape,M.dtype,kt),$t=Wft(Nt,ht,V);return A.forEach(Ut=>o.disposeData(Ut.dataId)),o.makeTensorInfo(T.outputShape,$t.dtype,$t.values)}let G=new k4(M.shape,V),Q=o.runWebGPUProgram(G,[M,$],M.dtype);A.push(Q);let nt=zi({inputs:{x:Q},backend:o,attrs:{shape:T.outputShape}});return A.forEach(it=>o.disposeData(it.dataId)),nt}let ey={kernelName:m.GatherV2,backendName:"webgpu",kernelFunc:S4},_4=Dl({opType:Ma.GREATER,cpuKernelImpl:R0,dtype:"bool"}),C4={kernelName:m.Greater,backendName:"webgpu",kernelFunc:_4},E4=Dl({opType:Ma.GREATER_EQUAL,dtype:"bool",cpuKernelImpl:Vft}),M6={kernelName:m.GreaterEqual,backendName:"webgpu",kernelFunc:E4},Vm={kernelName:m.IFFT,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{input:u}=i;return LJ(u,!0,o)}},Gpt=go({opType:zr.IS_FINITE,dtype:"bool"}),Hpt={kernelName:m.IsFinite,backendName:"webgpu",kernelFunc:Gpt},Ypt=go({opType:zr.IS_INF,dtype:"bool"}),qpt={kernelName:m.IsInf,backendName:"webgpu",kernelFunc:Ypt},Xpt=go({opType:zr.IS_NAN,dtype:"bool"}),Kpt={kernelName:m.IsNan,backendName:"webgpu",kernelFunc:Xpt},Zpt={kernelName:m.LeakyRelu,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{alpha:f}=u,y=[{type:"float32",data:[f]}],w=new h4(c.shape,zr.LEAKYRELU,"alpha : f32,");return o.runWebGPUProgram(w,[c],"float32",y)}},zJ=Dl({opType:Ma.LESS,dtype:"bool",cpuKernelImpl:KQ}),PJ={kernelName:m.Less,backendName:"webgpu",kernelFunc:zJ},BJ=Dl({opType:Ma.LESS_EQUAL,dtype:"bool",cpuKernelImpl:Gft}),D6={kernelName:m.LessEqual,backendName:"webgpu",kernelFunc:BJ};class jJ{constructor(i){this.variableNames=[],this.outputShape=[],this.uniforms="start : f32, step : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[i],this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="linSpace"}getUserCode(){return`
      ${Gr("index")} {
        if (index < uniforms.size) {
          setOutputAtIndex(index, uniforms.start + f32(index) * uniforms.step);
        }
      }
    `}}let v7={kernelName:m.LinSpace,backendName:"webgpu",kernelFunc:function(l){let{backend:i,attrs:o}=l,{start:u,stop:c,num:f}=o,y=(c-u)/(f-1),w=new jJ(f),C=[{type:"float32",data:[u]},{type:"float32",data:[y]}];return i.runWebGPUProgram(w,[],"float32",C)}},FP=go({opType:zr.LOG,cpuKernelImpl:ZQ}),b7={kernelName:m.Log,backendName:"webgpu",kernelFunc:FP},vc=go({opType:zr.LOG1P}),UJ={kernelName:m.Log1p,backendName:"webgpu",kernelFunc:vc},WJ=Dl({opType:Ma.LOGICAL_AND,dtype:"bool"}),w7={kernelName:m.LogicalAnd,backendName:"webgpu",kernelFunc:WJ},Wb=go({opType:zr.LOGICAL_NOT}),Vb={kernelName:m.LogicalNot,backendName:"webgpu",kernelFunc:Wb},VJ=Dl({opType:Ma.LOGICAL_OR}),GJ={kernelName:m.LogicalOr,backendName:"webgpu",kernelFunc:VJ},x7=`
  var powValue = 0.0;
  let basis = uniforms.bias + uniforms.alpha * sum;
  if (uniforms.beta == 0.5) {
    powValue = inverseSqrt(basis);
  } else if (uniforms.beta == 1.0) {
    powValue = 1.0 / basis;
  } else {
    powValue = exp(log(basis) * (-uniforms.beta));
  }
`;class L0{constructor(i){this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn"}getUserCode(){return`
    ${Gr("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let b = coords[0];
        let r = coords[1];
        let c = coords[2];
        let d = coords[3];

        let x = getX(b, r, c, d);
        var sum = 0.0;
        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {
          let idx = d + i;
          if (idx >= 0 && idx < uniforms.xShape[3]) {
            let z = getX(b, r, c, idx);
            sum = sum + z * z;
          }
        }
        ${x7}

        setOutputAtIndex(index, x * powValue);
      }
    }
  `}}class HJ{constructor(i,o){this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[256,1,1],this.maxAllowRadius=16,m.util.assert(o<=this.maxAllowRadius,()=>`Radius must be less than or equal to ${this.maxAllowRadius}, current radius is ${o}`),this.outputShape=i,this.elementsPerWorkgroup=this.workgroupSize[0]-2*this.maxAllowRadius,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=Nr(this.dispatchLayout,this.outputShape,[this.elementsPerWorkgroup,this.workgroupSize[1],this.workgroupSize[2]]),this.shaderKey="lrn_shared"}getUserCode(){return`
    var <workgroup>lrnSub: array<f32, ${this.workgroupSize[0]}>;
    const elementsPerWorkgroup = ${this.elementsPerWorkgroup};
    const maxAllowRadius = ${this.maxAllowRadius};

    ${Gr()} {
      let localDepth = i32(localId.x);
      let workgroupDepth = i32(workgroupId.x) * elementsPerWorkgroup;
      let xDepth = workgroupDepth + localDepth - maxAllowRadius;
      let b = i32(globalId.z) / uniforms.xShape[1];
      let r = i32(globalId.z) - b * uniforms.xShape[1];
      let c = i32(globalId.y);
      let d = workgroupDepth + localDepth;

      var x = 0.0;
      if (xDepth >= 0 && xDepth < uniforms.xShape[3]) {
        x = getX(b, r, c, xDepth);
      }
      lrnSub[localDepth] = x;
      workgroupBarrier();

      if (localDepth < elementsPerWorkgroup && d < uniforms.outShape[3]) {
        var sum = 0.0;
        let index = localDepth + maxAllowRadius;
        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {
          let z = lrnSub[index + i];
          sum = sum + z * z;
        }
        ${x7}

        setOutputAtCoords(b, r, c, d, lrnSub[index] * powValue);
      }
    } `}}let k7={kernelName:m.LRN,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{depthRadius:f,bias:y,alpha:w,beta:C}=u,T;T=f>16?new L0(c.shape):new HJ(c.shape,f);let x=[{type:"int32",data:[f]},{type:"float32",data:[y]},{type:"float32",data:[w]},{type:"float32",data:[C]}];return o.runWebGPUProgram(T,[c],c.dtype,x)}};class OP{constructor(i){this.outputShape=[],this.variableNames=["inputImage","outputImage","dy"],this.uniforms="depthRadius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn_grad"}getUserCode(){return`
    ${Gr("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let b = coords[0];
        let r = coords[1];
        let c = coords[2];

        let MIN_DEPTH_BEGIN = 0;
        let MAX_DEPTH_END = uniforms.outShape[3];
        var result = 0.0;
        for (var d = MIN_DEPTH_BEGIN; d < MAX_DEPTH_END; d++) {
          let depthBegin = max(MIN_DEPTH_BEGIN, d - uniforms.depthRadius);
          let depthEnd = min(MAX_DEPTH_END, d + uniforms.depthRadius + 1);

          var norm = 0.0;
          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {
            if (k < depthBegin) {
              continue;
            } else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            } else {
              break;
            }
          }

          norm = uniforms.alpha * norm + uniforms.bias;

          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {
            if (k < depthBegin) {
              continue;
            } else if (k >= depthBegin && k < depthEnd) {
              var dyi = -2.0 * uniforms.alpha * uniforms.beta
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d) / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * uniforms.beta);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            } else {
              break;
            }
          }
        }

        setOutputAtIndex(index, result);
      }
    }
  `}}let YJ={kernelName:m.LRNGrad,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,y:f,dy:y}=i,{depthRadius:w,bias:C,alpha:T,beta:x}=u,A=new OP(c.shape),M=[{type:"int32",data:[w]},{type:"float32",data:[C]},{type:"float32",data:[T]},{type:"float32",data:[x]}];return o.runWebGPUProgram(A,[c,f,y],c.dtype,M)}},qJ=Dl({opType:Ma.MAX,cpuKernelImpl:eP}),XJ={kernelName:m.Maximum,backendName:"webgpu",kernelFunc:qJ},S7={kernelName:m.MaxPool,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{filterSize:f,strides:y,pad:w,dimRoundingMode:C}=u;return o7(c,m.backend_util.computePool2DInfo(c.shape,f,y,1,w,C),"max",o)}},KJ={kernelName:m.MaxPool3D,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{filterSize:f,strides:y,pad:w,dataFormat:C,dimRoundingMode:T}=u,x=m.backend_util.computePool3DInfo(c.shape,f,y,[1,1,1],w,T,C),A=new cP(x,"max"),M=[{type:"int32",data:[x.strideDepth,x.strideHeight,x.strideWidth]},{type:"int32",data:[x.padInfo.front,x.padInfo.top,x.padInfo.left]},{type:"int32",data:[x.inDepth,x.inHeight,x.inWidth]},{type:"int32",data:[x.effectiveFilterDepth,x.effectiveFilterHeight,x.effectiveFilterWidth]}];return o.runWebGPUProgram(A,[c],c.dtype,M)}};class _7{constructor(i){this.variableNames=["dy","maxPos"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i.inShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool2DBackprop"}getUserCode(){return`
      ${Gr("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d = coords[3];

        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;
        let dyRCorner = dyRCCorner.x;
        let dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] - 1;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR += uniforms.dilations[0]) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims[1]; wC += uniforms.dilations[1]) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }
            let idyC = i32(dyC);

            let dyValue = getDy(batch, idyR, idyC, d);
            let maxPosValue = lastIndex - i32(getMaxPos(batch, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            let curPosValue = wR * uniforms.filterDims[1] + wC;
            let mask = select(0.0, 1.0, maxPosValue == curPosValue);
            dotProd += dyValue * mask;
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}}class Qpt{constructor(i){this.variableNames=["dy","maxPos"],this.uniforms=`strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,
      outDepth : i32, outHeight : i32, outWidth : i32`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i.inShape,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool3DBackprop"}getUserCode(){return`
      ${Gr("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let ch = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyDCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] * uniforms.filterDims[2] - 1;

        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {
          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);

          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {
            continue;
          }
          let idyD = i32(dyD);

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let dyValue = getDy(batch, idyD, idyR, idyC, ch);
              let maxPosValue = lastIndex - i32(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              let curPosValue = wD * uniforms.filterDims[1] * uniforms.filterDims[2] + wR * uniforms.filterDims[2] + wC;
              let mask = select(0.0, 1.0, maxPosValue == curPosValue);
              dotProd += dyValue * mask;
            }
          }
        }

        setOutputAtIndex(index, dotProd);
      }
    }
    `}}let bc={kernelName:m.MaxPool3DGrad,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,input:f}=i,y=f,{filterSize:w,strides:C,pad:T,dimRoundingMode:x}=u,A=m.backend_util.computePool3DInfo(y.shape,w,C,[1,1,1],T,x),M=new cP(A,"max",!0),$=[{type:"int32",data:[A.strideDepth,A.strideHeight,A.strideWidth]},{type:"int32",data:[A.padInfo.front,A.padInfo.top,A.padInfo.left]},{type:"int32",data:[A.inDepth,A.inHeight,A.inWidth]},{type:"int32",data:[A.effectiveFilterDepth,A.effectiveFilterHeight,A.effectiveFilterWidth]}],V=o.runWebGPUProgram(M,[y],"int32",$),G=new Qpt(A);$=[{type:"int32",data:[A.strideDepth,A.strideHeight,A.strideWidth]},{type:"int32",data:[A.effectiveFilterDepth-1-A.padInfo.front,A.effectiveFilterHeight-1-A.padInfo.top,A.effectiveFilterWidth-1-A.padInfo.left]},{type:"int32",data:[A.effectiveFilterDepth,A.effectiveFilterHeight,A.effectiveFilterWidth]},{type:"int32",data:[A.outDepth]},{type:"int32",data:[A.outHeight]},{type:"int32",data:[A.outWidth]}];let Q=o.runWebGPUProgram(G,[c,V],y.dtype,$);return o.disposeData(V.dataId),Q}},LP={kernelName:m.MaxPoolGrad,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{dy:c,input:f,output:y}=i,w=f;WQ([f,y],"maxPoolGrad");let{filterSize:C,strides:T,pad:x,dimRoundingMode:A}=u,M=m.backend_util.computePool2DInfo(w.shape,C,T,1,x,A),$=new ty(M,"max",!0),V=[{type:"int32",data:[M.strideHeight,M.strideWidth]},{type:"int32",data:[M.padInfo.top,M.padInfo.left]},{type:"int32",data:[M.dilationHeight,M.dilationWidth]},{type:"int32",data:[M.inHeight,M.inWidth]},{type:"int32",data:[M.effectiveFilterHeight,M.effectiveFilterWidth]}],G=o.runWebGPUProgram($,[w],"int32",V),Q=new _7(M);V=[{type:"int32",data:[M.strideHeight,M.strideWidth]},{type:"int32",data:[M.effectiveFilterHeight-1-M.padInfo.top,M.effectiveFilterWidth-1-M.padInfo.left]},{type:"int32",data:[M.dilationHeight,M.dilationWidth]},{type:"int32",data:[M.effectiveFilterHeight,M.effectiveFilterWidth]},{type:"int32",data:[M.outHeight]},{type:"int32",data:[M.outWidth]}];let nt=o.runWebGPUProgram(Q,[c,G],w.dtype,V);return o.disposeData(G.dataId),nt}},ZJ={kernelName:m.MaxPoolWithArgmax,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{filterSize:c,strides:f,pad:y,includeBatchInIndex:w}=u,{x:C}=i;m.util.assert(C.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${C.shape.length}.`);let T=[1,1];m.util.assert(m.backend_util.eitherStridesOrDilationsAreOne(f,T),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${f} and dilations '${T}'`);let x=m.backend_util.computePool2DInfo(C.shape,c,f,T,y),A=[{type:"int32",data:[x.strideHeight,x.strideWidth]},{type:"int32",data:[x.padInfo.top,x.padInfo.left]},{type:"int32",data:[x.dilationHeight,x.dilationWidth]},{type:"int32",data:[x.inHeight,x.inWidth]},{type:"int32",data:[x.effectiveFilterHeight,x.effectiveFilterWidth]}],M=new ty(x,"max",!1),$=o.runWebGPUProgram(M,[C],C.dtype,A);return M=new ty(x,"max",!0,!0,w),[$,o.runWebGPUProgram(M,[C],"int32",A)]}},Jpt={kernelName:m.Min,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,keepDims:y}=u;return J2(c,f,y,"min",o)}},t0t=Dl({opType:Ma.MIN,cpuKernelImpl:JQ}),$P={kernelName:m.Minimum,backendName:"webgpu",kernelFunc:t0t};class QJ{constructor(i,o,u){this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=o.map((c,f)=>c[0]+i[f]+c[1]),this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=i,o.map((c,f)=>{this.uniforms+=` pad${f} : vec2<i32>,`}),this.offset=u==="reflect"?0:1,this.shaderKey=`mirrorPad_${u}`}getUserCode(){let i=this.xShape.length,o=this.xShape.map((T,x)=>`uniforms.pad${x}[0]`).join(","),u=this.xShape.map((T,x)=>`uniforms.pad${x}[0] + uniforms.xShape${i>1?`[${x}]`:""}`).join(","),c=i===1?"start":"start[i]",f=i===1?"end":"end[i]",y=i===1?"outC":"outC[i]",w=ol(i),C=i>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i):"coords";return`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let start = ${w}(${o});
          let end = ${w}(${u});
          var outC = getCoordsFromIndex(index);
          for (var i = 0; i < ${i}; i = i + 1) {
            if (${y} < ${c}) {
              ${y} = ${c} * 2 - ${y} - ${this.offset};
            } else if(${y} >= ${f}) {
              ${y} = (${f} - 1) * 2 - ${y} + ${this.offset};
            }
          }
          let coords = outC - start;
          setOutputAtIndex(index, getX(${C}));
        }
      }
    `}}let e0t={kernelName:m.MirrorPad,backendName:"webgpu",kernelFunc:({inputs:l,attrs:i,backend:o})=>{let{x:u}=l,{paddings:c,mode:f}=i,y=o,w=c.map(T=>({type:"int32",data:[T[0],T[1]]})),C=new QJ(u.shape,c,f);return y.runWebGPUProgram(C,[u],u.dtype,w)}},JJ=Dl({opType:Ma.MOD}),ttt={kernelName:m.Mod,backendName:"webgpu",kernelFunc:JJ};class Gm{constructor(i,o){this.variableNames=["probs"],this.outputShape=[],this.uniforms="seed : f32, numOutcomes: i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[i,o],this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="multinomial"}getUserCode(){return`
    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    fn random (seed : f32, resultUV : vec2<f32>) -> f32 {
      let HASHSCALE1 = 443.8975;
      let p = resultUV * seed;
      var p3  = fract(vec3<f32>(p.xyx) * HASHSCALE1);
      p3 = p3 + dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Gr("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let batch = coords[0];

        let resUV = vec2<f32>(f32(coords[1]) / f32(uniforms.outShape[1]),
            f32(coords[0]) / f32(uniforms.outShape[0]));
        let r = random(uniforms.seed, resUV);
        var cdf = 0.0;
        for (var i = 0; i < uniforms.numOutcomes - 1; i = i + 1) {
          cdf = cdf + getProbs(batch, i);

          if (r < cdf) {
            setOutputAtIndexI32(index, i);
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutputAtIndexI32(index, uniforms.numOutcomes - 1);
      }
    }
  `}}class ett{constructor(i){this.variableNames=["logits"],this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=[this.outputShape[0],1,1],this.outputShape[1]>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.shaderKey="softmax"}getUserCode(){return`
    var<workgroup> buf : array<f32, ${this.workgroupSize[0]}>;
    var<workgroup> rowMaxShared : f32;
    var<workgroup> rowSumShared : f32;
    const blockSize = ${this.workgroupSize[0]};
    ${Gr("index")} {
      let row = index / blockSize;
      let tid = i32(localId.x);
      let cols = uniforms.outShape[1];

      var threadMax = -3.402823e+38f;
      for (var col = tid; col < cols; col += blockSize) {
        let value = getLogits(row, col);
        threadMax = max(threadMax, value);
      }
      if (tid < cols) {
        buf[tid] = threadMax;
      }
      workgroupBarrier();

      var reduceSize = min(cols, blockSize);
      for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
        reduceSize = currSize + (reduceSize & 1);
        if (tid < currSize) {
          buf[tid] = max(buf[tid], buf[tid + reduceSize]);
        }
        workgroupBarrier();
      }

      if (tid == 0) {
        rowMaxShared = buf[0];
      }
      workgroupBarrier();

      var threadSum = 0.0;
      for (var col = tid; col < cols; col += blockSize) {
        let subExp = exp(getLogits(row, col) - rowMaxShared);
        threadSum += subExp;
      }
      buf[tid] = threadSum;
      workgroupBarrier();

      for (var currSize = blockSize >> 1;  currSize > 0; currSize = currSize >> 1) {
        if (tid < currSize) {
          buf[tid] = buf[tid] + buf[tid + currSize];
        }
        workgroupBarrier();
      }

      if (tid == 0) {
        rowSumShared = buf[0];
      }
      workgroupBarrier();

      for (var col = tid; col < cols; col += blockSize) {
        let value = exp(getLogits(row, col) - rowMaxShared) / rowSumShared;
        setOutputAtCoords(row, col, value);
      }
  }
    `}}function C7(l){let{inputs:i,backend:o,attrs:u}=l,{logits:c}=i,{dim:f}=u,y=zi({inputs:{x:c},backend:o,attrs:{shape:[m.util.sizeFromShape(c.shape)/c.shape[f],c.shape[f]]}}),w=new ett(y.shape),C=o.runWebGPUProgram(w,[y],c.dtype),T=zi({inputs:{x:C},backend:o,attrs:{shape:c.shape}});return o.disposeData(y.dataId),o.disposeData(C.dataId),T}let zP={kernelName:m.Softmax,backendName:"webgpu",kernelFunc:C7},ntt={kernelName:m.Multinomial,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{logits:c}=i,{numSamples:f,seed:y,normalized:w}=u,C=w?c:C7({inputs:{logits:c},backend:o,attrs:{dim:c.shape.length-1}}),T=C.shape[0],x=C.shape[1],A=new Gm(T,f),M=[{type:"float32",data:[y]},{type:"int32",data:[x]}],$=o.runWebGPUProgram(A,[C],"int32",M);return w||o.disposeData(C.dataId),$}},E7={kernelName:m.Neg,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{x:u}=i;if(o.shouldExecuteOnCPU([u])){let f=o.tensorMap.get(u.dataId),[y,w]=rP(f.values,u.shape,u.dtype);return o.makeTensorInfo(w,u.dtype,y)}let c=new h4(u.shape,zr.NEG);return o.runWebGPUProgram(c,[u],u.dtype)}},rtt={kernelName:m.NonMaxSuppressionV3,backendName:"webgpu",kernelFunc:function(l){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:i,backend:o,attrs:u}=l,{boxes:c,scores:f}=i,{maxOutputSize:y,iouThreshold:w,scoreThreshold:C}=u,T=o.readSync(c.dataId),x=o.readSync(f.dataId),{selectedIndices:A}=m.kernel_impls.nonMaxSuppressionV3Impl(T,x,y,w,C);return o.makeTensorInfo([A.length],"int32",new Int32Array(A))}},n0t={kernelName:m.NonMaxSuppressionV5,backendName:"webgpu",kernelFunc:function(l){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:i,backend:o,attrs:u}=l,{boxes:c,scores:f}=i,{maxOutputSize:y,iouThreshold:w,scoreThreshold:C,softNmsSigma:T}=u,x=o.readSync(c.dataId),A=o.readSync(f.dataId),M=y,$=w,V=C,G=T,{selectedIndices:Q,selectedScores:nt}=m.kernel_impls.nonMaxSuppressionV5Impl(x,A,M,$,V,G);return[o.makeTensorInfo([Q.length],"int32",new Int32Array(Q)),o.makeTensorInfo([nt.length],"float32",new Float32Array(nt))]}};class r0t{constructor(i,o){this.variableNames=["x"],this.uniforms="onValue : f32, offValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[i,o],this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="onehot"}getUserCode(){return`
      ${Gr("index")} {
        if(index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          setOutputAtIndex(index, mix(uniforms.offValue, uniforms.onValue,
                                      f32(i32(round(getX(coords.x))) == coords.y)));
        }
      }
    `}}let i0t={kernelName:m.OneHot,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{indices:c}=i,{dtype:f,depth:y,onValue:w,offValue:C}=u,T=m.util.sizeFromShape(c.shape),x=new r0t(T,y),A=zi({inputs:{x:c},backend:o,attrs:{shape:[T]}}),M=[{type:"float32",data:[w]},{type:"float32",data:[C]}],$=o.runWebGPUProgram(x,[A],f,M);o.disposeData(A.dataId);let V=zi({inputs:{x:$},backend:o,attrs:{shape:[...c.shape,y]}});return o.disposeData($.dataId),V}};function Gb(l){let{inputs:i,backend:o}=l,{x:u}=i;if(u.dtype==="complex64"){let c=Pb({inputs:{input:u},backend:o}),f=Gb({inputs:{x:c},backend:o}),y=O0({inputs:{input:u},backend:o}),w=Gb({inputs:{x:y},backend:o}),C=$b({inputs:{real:f,imag:w},backend:o});return o.disposeData(c.dataId),o.disposeData(f.dataId),o.disposeData(y.dataId),o.disposeData(w.dataId),C}return Qc({attrs:{shape:u.shape,dtype:u.dtype,value:u.dtype==="string"?"":0},backend:o})}let itt={kernelName:m.ZerosLike,backendName:"webgpu",kernelFunc:Gb},PP={kernelName:m.OnesLike,backendName:"webgpu",kernelFunc:function l(i){let{inputs:o,backend:u}=i,{x:c}=o;if(c.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(c.dtype==="complex64"){let f=Pb({inputs:{input:c},backend:u}),y=l({inputs:{x:f},backend:u}),w=O0({inputs:{input:c},backend:u}),C=Gb({inputs:{x:w},backend:u}),T=$b({inputs:{real:y,imag:C},backend:u});return u.disposeData(f.dataId),u.disposeData(y.dataId),u.disposeData(w.dataId),u.disposeData(C.dataId),T}return Qc({attrs:{shape:c.shape,dtype:c.dtype,value:1},backend:u})}},att={kernelName:m.Pack,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{axis:c}=u;if(i.length===1)return OJ({inputs:{input:i[0]},backend:o,attrs:{dim:c}});let f=i[0].shape,y=i[0].dtype;i.forEach(x=>{m.util.assertShapesMatch(f,x.shape,"All tensors passed to stack must have matching shapes"),m.util.assert(y===x.dtype,()=>"All tensors passed to stack must have matching dtypes")});let w=[],C=i.map(x=>{let A=OJ({inputs:{input:x},backend:o,attrs:{dim:c}});return w.push(A),A}),T=vP({inputs:C,backend:o,attrs:{axis:c}});return w.forEach(x=>o.disposeData(x.dataId)),T}};function BP(l,i=!1){let o=l.length,u=ol(o),c=l.map((y,w)=>`uniforms.pad${w}[0]`).join(","),f=l.map((y,w)=>`uniforms.pad${w}[0] + uniforms.xShape${o>1?`[${w}]`:""}`).join(",");return`
        let start = ${o>1?`${u}(${c})`:`${c}`};
        let end = ${o>1?`${u}(${f})`:`${f}`};
        if (${o>1?"any(paddedCoords < start)":"paddedCoords < start"} || ${o>1?"any(paddedCoords >= end)":"paddedCoords >= end"}) {
          setOutputAtIndex(index, ${i?0:"uniforms.constantValue"});
        } else {
          let coords = paddedCoords - start;
          setOutputAtIndex(index, getX(${o>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o):"coords"}));
        }
  `}class a0t{constructor(i,o){this.variableNames=["x"],this.uniforms="constantValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=o.map((u,c)=>u[0]+i[c]+u[1]),this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),o.map((u,c)=>{this.uniforms+=` pad${c} : vec2<i32>,`}),this.xShape=i,this.shaderKey="pad"}getUserCode(){return`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let paddedCoords = getCoordsFromIndex(index);
          ${BP(this.xShape)}
        }
      }
    `}}let o0t={kernelName:m.PadV2,backendName:"webgpu",kernelFunc:l=>{let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{paddings:f,constantValue:y}=u;if(f.every(T=>m.util.arraysEqual(T,[0,0])))return Hd({inputs:{x:c},backend:o});if(m.util.sizeFromShape(c.shape)===0)return Qc({backend:o,attrs:{shape:f.map((T,x)=>T[0]+c.shape[x]+T[1]),value:y,dtype:c.dtype}});let w=[{type:"float32",data:[y]}];f.map(T=>w.push({type:"int32",data:[T[0],T[1]]}));let C=new a0t(c.shape,f);return o.runWebGPUProgram(C,[c],c.dtype,w)}},ott=Dl({opType:Ma.POW}),s0t={kernelName:m.Pow,backendName:"webgpu",kernelFunc:ott},stt={kernelName:m.Prelu,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{x:u,alpha:c}=i,f=new n7(Ma.PRELU,u.shape,c.shape);return o.runWebGPUProgram(f,[u,c],"float32")}},u0t={kernelName:m.Prod,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{axis:f,keepDims:y}=u;return J2(c,f,y,"prod",o)}},l0t={kernelName:m.Range,backendName:"webgpu",kernelFunc:l=>{let{backend:i,attrs:o}=l,{start:u,stop:c,step:f,dtype:y}=o,w=iP(u,c,f,y);return i.makeTensorInfo([w.length],y,w)}},utt=Dl({opType:Ma.DIV}),ltt={kernelName:m.RealDiv,backendName:"webgpu",kernelFunc:utt},ctt=go({opType:zr.RECIPROCAL}),htt={kernelName:m.Reciprocal,backendName:"webgpu",kernelFunc:ctt},dtt=go({opType:zr.RELU}),ftt={kernelName:m.Relu,backendName:"webgpu",kernelFunc:dtt},c0t=go({opType:zr.RELU6}),ptt={kernelName:m.Relu6,backendName:"webgpu",kernelFunc:c0t};class h0t{constructor(i,o,u){this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, halfPixelCenters : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[i[0],o,u,i[3]],this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="resizeBilinear"}getUserCode(){return`
      ${Gr("index")} {
        if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let d = coords[3];
          let rc = coords.yz;

          let effectiveInSize = vec2<f32>(
            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveOutSize = vec2<f32>(
            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveInputOverOutputRatioRC =
              effectiveInSize / effectiveOutSize;

          // Fractional source index
          let sourceFracIndexRC =
            (vec2<f32>(rc) + vec2<f32>(uniforms.halfPixelCenters)) *
            effectiveInputOverOutputRatioRC - vec2<f32>(uniforms.halfPixelCenters);

          // Compute the four integer indices.
          let sourceFloorRC = vec2<i32>(sourceFracIndexRC);
          let sourceCeilRC = vec2<i32>(
            min(vec2<f32>(uniforms.xShape.yz) - vec2<f32>(1.0), ceil(sourceFracIndexRC)));

          let topLeft = getX(b, sourceFloorRC.x, sourceFloorRC.y, d);
          let bottomLeft = getX(b, sourceCeilRC.x, sourceFloorRC.y, d);
          let topRight = getX(b, sourceFloorRC.x, sourceCeilRC.y, d);
          let bottomRight = getX(b, sourceCeilRC.x, sourceCeilRC.y, d);

          let fracRC = sourceFracIndexRC - vec2<f32>(sourceFloorRC);

          let top = topLeft + (topRight - topLeft) * fracRC.y;
          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
          let newValue = top + (bottom - top) * fracRC.x;

          setOutputAtIndex(index, newValue);
        }
      }
    `}}let mtt={kernelName:m.ResizeBilinear,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{images:c}=i,{alignCorners:f,size:y,halfPixelCenters:w}=u,[C,T]=y,x=[{type:"float32",data:[f&&C>1?1:0,f&&T>1?1:0]},{type:"float32",data:[w?.5:0]}],A=new h0t(c.shape,C,T);return o.runWebGPUProgram(A,[c],"float32",x)}};class jP{constructor(i,o){this.variableNames=["dy"],this.uniforms=`effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, heightScale : f32, widthScale : f32,
       invHeightScale : f32, invWidthScale : f32, winHeight : i32, winWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=o,this.shaderKey=`resizeBilinearBackprop_${o}`}getUserCode(){return`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let b = coords[0];
          let d = coords[3];
          let r = coords[1];
          let c = coords[2];

          var accumulator = 0.0;

          // Compute bounds for where in dy we will look
          let startRLerp = floor(f32(r) * uniforms.invHeightScale);
          let startDyR = i32(startRLerp - f32(uniforms.winHeight / 2));

          let startCLerp = floor(f32(c) * uniforms.invWidthScale);
          let startDyC = i32(startCLerp - f32(uniforms.winWidth / 2));

          // Loop over dy
          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {
            let dyR = startDyR + dyROffset;

            // Guard against the window exceeding the bounds of dy
            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {
              continue;
            }

            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {
              let dyC = startDyC + dyCOffset;

              // Guard against the window exceeding the bounds of dy
              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {
                continue;
              }

              let dxR = f32(dyR) * uniforms.heightScale;
              let topDxRIndex = i32(floor(dxR));
              let bottomDxRIndex = i32(min(ceil(dxR), f32(uniforms.outShape[1] - 1)));
              let dxRLerp = dxR - f32(topDxRIndex);
              let inverseDxRLerp = 1.0 - dxRLerp;

              let dxC = f32(dyC) * uniforms.widthScale;
              let leftDxCIndex = i32(floor(dxC));
              let rightDxCIndex = i32(min(ceil(dxC), f32(uniforms.outShape[2] - 1)));
              let dxCLerp = dxC - f32(leftDxCIndex);
              let inverseDxCLerp = 1.0 - dxCLerp;

              if (r == topDxRIndex && c == leftDxCIndex) {
                // topLeft
                accumulator +=
                  getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
              }

              if (r == topDxRIndex && c == rightDxCIndex) {
                // topRight
                accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
              }

              if (r == bottomDxRIndex && c == leftDxCIndex) {
                // bottomLeft
                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
              }

              if (r == bottomDxRIndex && c == rightDxCIndex) {
                // bottomRight
                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
              }
            }
          }
          // End loop over dy

          setOutputAtIndex(index, accumulator);
        }
      }
    `}}let Hm={kernelName:m.ResizeBilinearGrad,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{images:c,dy:f}=i,{alignCorners:y}=u,[,w,C]=c.shape,[,T,x]=f.shape,A=[y&&T>1?w-1:w,y&&x>1?C-1:C],M=[y&&T>1?T-1:T,y&&x>1?x-1:x],$=A[0]/M[0],V=A[1]/M[1],G=1/$,Q=1/V,nt=2*Math.ceil(G)+2,it=2*Math.ceil(Q)+2,ht=new jP(c.shape,y),kt=[{type:"int32",data:A},{type:"int32",data:M},{type:"float32",data:[$]},{type:"float32",data:[V]},{type:"float32",data:[G]},{type:"float32",data:[Q]},{type:"int32",data:[nt]},{type:"int32",data:[it]}];return o.runWebGPUProgram(ht,[f],f.dtype,kt)}};class UP{constructor(i,o,u,c){this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, roundBase : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[i[0],o,u,i[3]],this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.halfPixelCenters=c,this.shaderKey=`resizeNearest_${c}`}getUserCode(){let i;return i=this.halfPixelCenters?"max((vec2<f32>(rc) + vec2<f32>(0.5)) * effectiveInputOverOutputRatioRC, vec2<f32>(0.0))":"vec2<f32>(rc) * effectiveInputOverOutputRatioRC",`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let d = coords[3];
          let rc = coords.yz;

          let effectiveInSize = vec2<f32>(
            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveOutSize = vec2<f32>(
            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveInputOverOutputRatioRC =
              effectiveInSize / effectiveOutSize;

          // Fractional source index
          let sourceFracIndexRC = ${i};

          // Compute the coordinators of nearest neighbor point.
          let inputShapeRC = vec2<f32>(f32(uniforms.xShape.y), f32(uniforms.xShape.z));
          let sourceNearestRC = vec2<i32>(
            min(inputShapeRC - 1.0, floor(sourceFracIndexRC + uniforms.roundBase)));
          let newValue = getX(b, sourceNearestRC.x, sourceNearestRC.y, d);

          setOutputAtIndex(index, newValue);
        }
      }
    `}}let WP={kernelName:m.ResizeNearestNeighbor,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{images:c}=i,{alignCorners:f,halfPixelCenters:y,size:w}=u,[C,T]=w,x=[{type:"float32",data:[f&&C>1?1:0,f&&T>1?1:0]},{type:"float32",data:[f?.5:0]}],A=new UP(c.shape,C,T,y);return o.runWebGPUProgram(A,[c],c.dtype,x)}};class VP{constructor(i,o){this.variableNames=["dy"],this.uniforms=`effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, invHeightScale : f32, invWidthScale : f32,
       winHeight : i32, winWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=o,this.shaderKey=`resizeNearestNeigborBackprop_${o}`}getUserCode(){return`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let b = coords[0];
          let d = coords[3];
          let r = coords[1];
          let c = coords[2];

          var accumulator = 0.0;

          // Compute bounds for where in dy we will look
          let startRLerp = floor(f32(r) * uniforms.invHeightScale);
          let startDyR = i32(floor(startRLerp - f32(uniforms.winHeight / 2)));

          let startCLerp = floor(f32(c) * uniforms.invWidthScale);
          let startDyC = i32(floor(startCLerp - f32(uniforms.winWidth / 2)));

          // Loop over dy
          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {
            let dyR = startDyR + dyROffset;

            // Guard against the window exceeding the bounds of dy
            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {
              continue;
            }

            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {
              let dyC = startDyC + dyCOffset;

              // Guard against the window exceeding the bounds of dy
              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {
                continue;
              }

              let sourceFracRow = f32(uniforms.effectiveXSize[0]) *
                  (f32(dyR) / f32(uniforms.effectiveYSize[0]));

              let sourceFracCol = f32(uniforms.effectiveXSize[1]) *
                  (f32(dyC) / f32(uniforms.effectiveYSize[1]));

              let sourceNearestRow =
                  i32(min(f32(uniforms.outShape[1] - 1),
                  ${this.alignCorners?"floor(sourceFracRow + 0.5)":"floor(sourceFracRow)"}));

              let sourceNearestCol =
                  i32(min(f32(uniforms.outShape[2] - 1),
                  ${this.alignCorners?"floor(sourceFracCol + 0.5)":"floor(sourceFracCol)"}));

              if (r == sourceNearestRow && c == sourceNearestCol) {
                accumulator += getDy(b, dyR, dyC, d);
              }
            }
          }
          // End loop over dy

          setOutputAtIndex(index, accumulator);
        }
      }
    `}}let GP={kernelName:m.ResizeNearestNeighborGrad,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{images:c,dy:f}=i,{alignCorners:y}=u,[,w,C]=c.shape,[,T,x]=f.shape,A=[y&&T>1?w-1:w,y&&x>1?C-1:C],M=[y&&T>1?T-1:T,y&&x>1?x-1:x],$=1/(A[0]/M[0]),V=1/(A[1]/M[1]),G=2*Math.ceil($)+2,Q=2*Math.ceil(V)+2,nt=new VP(c.shape,y),it=[{type:"int32",data:A},{type:"int32",data:M},{type:"float32",data:[$]},{type:"float32",data:[V]},{type:"int32",data:[G]},{type:"int32",data:[Q]}];return o.runWebGPUProgram(nt,[f],f.dtype,it)}};class d0t{constructor(i){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=" axis : vec4<i32>,",this.shaderKey="reverse"}getUserCode(){return`
      
      // Using uniform variables as judging conditions, so the function has
      // coherent execution within all threads.
      fn getReverseCoords(coords : vec4<i32>) -> vec4<i32> {
        var reverseCoords = coords;
        if (uniforms.axis[0] == 1) {
          reverseCoords[0] = uniforms.xShape[0] - coords[0] - 1;
        }
        if (uniforms.axis[1] == 1) {
          reverseCoords[1] = uniforms.xShape[1] - coords[1] - 1;
        }
        if (uniforms.axis[2] == 1) {
          reverseCoords[2] = uniforms.xShape[2] - coords[2] - 1;
        }
        if (uniforms.axis[3] == 1) {
          reverseCoords[3] = uniforms.xShape[3] - coords[3] - 1;
        }

        return reverseCoords;
      }
    
      ${Gr("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let reverseCoords = getReverseCoords(coords);
          setOutputAtIndex(index, getX(reverseCoords[0],
              reverseCoords[1], reverseCoords[2], reverseCoords[3]));
        }
      }
    `}}let HP={kernelName:m.Reverse,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{dims:f}=u,y=c.shape.length;if(y===0)return Hd({inputs:{x:c},backend:o});let w=c.shape,C=[1,1,1,1];w.forEach((Q,nt)=>{C[nt+4-y]=Q});let T=m.util.parseAxisParam(f,c.shape),x=[0,0,0,0];T.forEach(Q=>{x[Q+4-y]=1});let A=[{type:"int32",data:x}],M=zi({inputs:{x:c},backend:o,attrs:{shape:C}}),$=new d0t(C),V=o.runWebGPUProgram($,[M],M.dtype,A);o.disposeData(M.dataId);let G=zi({inputs:{x:V},backend:o,attrs:{shape:w}});return o.disposeData(V.dataId),G}};class d1{constructor(i,o){this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=`centerX : f32, centerY : f32, sinRadians : f32,
          cosRadians : f32,`,this.shaderKey="rotate",this.outputShape=i,typeof o=="number"?(this.uniforms+=" fillValue : f32,",this.fillSnippet="var outputValue = uniforms.fillValue;",this.shaderKey+="_float"):(this.uniforms+=" fillValue : vec3<f32>,",this.fillSnippet="var outputValue = uniforms.fillValue[coords[3]];",this.shaderKey+="_vec3")}getUserCode(){return`
        ${Gr("index")} {
          if (index < uniforms.size) {
            let coords = getCoordsFromIndex(index);
            let coordXFloat = (f32(coords[2]) - uniforms.centerX) *
                uniforms.cosRadians - (f32(coords[1]) - uniforms.centerY) *
                uniforms.sinRadians;
            let coordYFloat = (f32(coords[2]) - uniforms.centerX) *
                uniforms.sinRadians + (f32(coords[1]) - uniforms.centerY) *
                uniforms.cosRadians;
            let coordX = i32(round(coordXFloat + uniforms.centerX));
            let coordY = i32(round(coordYFloat + uniforms.centerY));
            ${this.fillSnippet}
            if(coordX >= 0 && coordX < uniforms.xShape[2] && coordY >= 0 &&
                coordY < uniforms.xShape[1]) {
              outputValue = getX(coords[0], coordY, coordX, coords[3]);
            }
            setOutputAtIndex(index, outputValue);
          }
        }
      `}}let gtt={kernelName:m.RotateWithOffset,backendName:"webgpu",kernelFunc:({inputs:l,attrs:i,backend:o})=>{let{image:u}=l,{radians:c,fillValue:f,center:y}=i,w=o,C=new d1(u.shape,f),[T,x]=m.backend_util.getImageCenter(y,u.shape[1],u.shape[2]),A=[{type:"float32",data:[T]},{type:"float32",data:[x]},{type:"float32",data:[Math.sin(c)]},{type:"float32",data:[Math.cos(c)]}];return typeof f=="number"?A.push({type:"float32",data:[Number.parseFloat(f.toFixed(2))]}):A.push({type:"float32",data:f}),w.runWebGPUProgram(C,[u],u.dtype,A)}},f0t=go({opType:zr.ROUND}),ytt={kernelName:m.Round,backendName:"webgpu",kernelFunc:f0t},p0t=go({opType:zr.RSQRT,cpuKernelImpl:aP}),m0t={kernelName:m.Rsqrt,backendName:"webgpu",kernelFunc:p0t};class R6{constructor(i,o,u,c,f,y,w,C=!0){this.variableNames=["updates","indices"],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=y,this.type=w,this.sumDupeIndices=C,this.dispatchLayout=hi(i),this.dispatch=Nr(this.dispatchLayout,i,this.workgroupSize),this.sliceDimGreaterThanOne=o>1,this.shaderKey=`scatter_${u}_${c}_${this.sliceDimGreaterThanOne}_${w}_${C}_${f.length}`;let T=ol(f.length);this.uniforms=`sliceDim : i32, strides: ${T}, updatesSize: i32,`,this.updatesRank=c,this.indicesRank=u}getUserCode(){let i="";this.indicesRank===1?i="coords[0]":this.indicesRank===2&&(i="coords[0], j");let o=`getIndices(${i})`,u=this.sliceDimGreaterThanOne?"uniforms.strides[j]":"uniforms.strides",c="",f="";this.dispatchLayout.x.length===1?(c="flattenedIndex",f=`
      fn getUpdatesCoordsFromFlatIndex(index : i32) -> i32 {
        return index;
      }
      `):this.dispatchLayout.x.length===2&&(c="vec2<i32>(flattenedIndex, coords[1])",f=`
      fn getUpdatesCoordsFromFlatIndex(index : i32) -> vec2<i32> {
        // N.B. |updates| could be a scalar tensor, conceptually representing a
        // 2D tensor with all values equal to that. By design, its size must be
        // the same as |outShape[1]| in one dimension, and |indicesShape[0]|
        // gives the other.
        let sliceSize = uniforms.outShape[1];
        let d0 = index / sliceSize;
        let d1 = index - d0 * sliceSize;
        return vec2<i32>(d0, d1);
      }
      `);let y=`getUpdates(${Array.from({length:this.updatesRank},(w,C)=>`coords[${C}]`).join(", ")})`;return`
    ${f}
      ${Gr("index")} {
        if (index < uniforms.updatesSize) {
          let coords = getUpdatesCoordsFromFlatIndex(index);
          var flattenedIndex = 0;
          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {
            let indexInside = i32(round(${o}));
            flattenedIndex = flattenedIndex + indexInside * ${u};
          }
          let updateValue =
              ${vl(this.type)}(${y});
          let flatIndex = getOutputIndexFromCoords(${c});

          ${this.sumDupeIndices?o1("&result[flatIndex]","updateValue",this.type):"atomicStore(&result[flatIndex], bitcast<i32>(updateValue));"}
        }
      }`}}let g0t={kernelName:m.ScatterNd,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{indices:c,updates:f}=i,{shape:y}=u,{sliceRank:w,numUpdates:C,sliceSize:T,strides:x,outputSize:A}=m.backend_util.calculateShapes(f,c,y),M=[A/T,T];if(A===0)return o.makeTensorInfo(y,c.dtype);let $=zi({inputs:{x:c},backend:o,attrs:{shape:[C,w]}}),V=zi({inputs:{x:f},backend:o,attrs:{shape:[C,T]}}),G=V.dtype,Q=Qc({backend:o,attrs:{shape:M,value:0,dtype:G}}),nt=[{type:"int32",data:[w]},{type:"int32",data:x},{type:"int32",data:[m.util.sizeFromShape(V.shape)]}],it=new R6(V.shape,w,$.shape.length,V.shape.length,x,M,G),ht=o.runWebGPUProgram(it,[V,$],G,nt,Q),kt=zi({inputs:{x:ht},backend:o,attrs:{shape:y}});return o.disposeData($.dataId),o.disposeData(V.dataId),o.disposeData(ht.dataId),kt}};class vtt{constructor(i,o){this.outputShape=[],this.variableNames=["sortedSequence","values"],this.uniforms="numInputs : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.side=o,this.shaderKey=`search_sorted_${o}`}getUserCode(){return`
      fn findBound(batch: i32, value: f32) -> i32 {
        var left = i32(0);
        var right = uniforms.numInputs;
        while (left < right) {
          var mid = (left + right) / 2;
          if (getSortedSequence(batch, mid) ${this.side==="left"?"<":"<="} value) {
            left = mid + 1;
          } else {
            right = mid;
          }
        }
        return right;
      }

      ${Gr("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let value = getValuesByOutputIndex(index);
          setOutputAtIndexI32(index, findBound(coords[0], value));
        }
      }
    `}}let btt={kernelName:m.SearchSorted,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{sortedSequence:c,values:f}=i,{side:y}=u,w=new vtt([f.shape[0],f.shape[1]],y),C=[{type:"int32",data:[c.shape[1]]}];return o.runWebGPUProgram(w,[c,f],"int32",C)}};class YP{constructor(i,o,u){this.variableNames=["c","a","b"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=o,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.cRank=i,this.rank=u,this.shaderKey="select"}getUserCode(){let i,o;if(this.rank>4)throw Error(`Where for rank ${this.rank} is not yet supported`);if(this.rank===1)o="resRC",i="resRC";else{let u=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],f=[];for(let y=0;y<this.outputShape.length;y++)f.push(`${u[y]}`),y<this.cRank&&c.push(`${u[y]}`);i=c.join(),o=f.join()}return`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          let cVal = getC(${i});
          if (cVal >= 1.0) {
            setOutputAtIndex(index, getA(${o}));
          } else {
            setOutputAtIndex(index, getB(${o}));
          }
        }
      }
    `}}let y0t={kernelName:m.Select,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{condition:u,t:c,e:f}=i,y=new YP(u.shape.length,c.shape,c.shape.length);return o.runWebGPUProgram(y,[u,c,f],(0,m.upcastType)(c.dtype,f.dtype))}},v0t=go({opType:zr.SELU}),b0t={kernelName:m.Selu,backendName:"webgpu",kernelFunc:v0t},qP=go({opType:zr.SIGMOID}),Hb={kernelName:m.Sigmoid,backendName:"webgpu",kernelFunc:qP},wtt=go({opType:zr.SIGN}),w0t={kernelName:m.Sign,backendName:"webgpu",kernelFunc:wtt},x0t=go({opType:zr.SIN}),k0t={kernelName:m.Sin,backendName:"webgpu",kernelFunc:x0t},XP=go({opType:zr.SINH}),ny={kernelName:m.Sinh,backendName:"webgpu",kernelFunc:XP},KP=go({opType:zr.SOFTPLUS}),ZP={kernelName:m.Softplus,backendName:"webgpu",kernelFunc:KP};class QP{constructor(i,o,u,c,f,y){this.variableNames=["x"],this.outputShape=[],this.uniforms="",this.workgroupSize=[64,1,1],this.size=!0;let w=new Array(c.length);for(let C=0;C<w.length;C++)w[C]=c[f[C]];this.outputShape=w,this.newDim=f,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=i,this.paddedXShape=o,this.uniforms+=`reshapedPaddedXShape : ${ol(c.length)}, paddedXShapeStrides : ${ol(y)}, `,u.map((C,T)=>{this.uniforms+=` pad${T} : vec2<i32>,`}),this.shaderKey=`spaceToBatchND_${f}`}getUserCode(){let i=ol(this.outputShape.length),o=iJ(this.newDim);return`
      ${Xc(this.paddedXShape,"PaddedX")}
      ${Gr("index")} {
        if(index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let switchedIndex = getIndexFromCoords${this.outputShape.length}D(${i}(${o}), uniforms.reshapedPaddedXShape);
          let paddedCoords = getPaddedXCoordsFromIndex(switchedIndex);
          ${BP(this.xShape,!0)}
        }
      }
    `}}let F6={kernelName:m.SpaceToBatchND,backendName:"webgpu",kernelFunc:l=>{let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{blockShape:f,paddings:y}=u;m.util.assert(c.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGPU backend not implemented yet");let w=f.reduce((it,ht)=>it*ht),C=[[0,0]];C.push(...y);for(let it=1+f.length;it<c.shape.length;++it)C.push([0,0]);let T=C.map((it,ht)=>it[0]+c.shape[ht]+it[1]),x=m.backend_util.getReshaped(T,f,w,!1),A=m.backend_util.getPermuted(x.length,f.length,!1),M=m.backend_util.getReshapedPermuted(T,f,w,!1),$=m.util.computeStrides(T),V=new QP(c.shape,T,C,x,A,$.length),G=[{type:"int32",data:x},{type:"int32",data:$}];C.map(it=>G.push({type:"int32",data:[it[0],it[1]]}));let Q=o.runWebGPUProgram(V,[c],c.dtype,G),nt=zi({inputs:{x:Q},backend:o,attrs:{shape:M}});return o.disposeData(Q.dataId),nt}};class O6{constructor(i,o,u){this.variableNames=["input","indices","segmentIds"],this.outputShape=[],this.uniforms="segmentSize : i32, sparseSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=i,this.type=u,this.dispatchLayout=hi([o]),this.dispatch=Nr(this.dispatchLayout,[o],this.workgroupSize),this.shaderKey="sparseSegmentSum"}getUserCode(){return`
    ${Gr("index")} {
      if (index < uniforms.sparseSize) {
        let indexInSegmentIds = index / uniforms.segmentSize;
        let indexInSegment = index % uniforms.segmentSize;
        let indexInInput = indices[indexInSegmentIds];
        let segmentId = segmentIds[indexInSegmentIds];

        let value = input[indexInInput * uniforms.segmentSize + indexInSegment];
        let outIndex = segmentId * uniforms.segmentSize + indexInSegment;
        ${o1("&result[outIndex]","value",this.type)}
      }
    }
  `}}class T4{constructor(i,o){this.variableNames=["segmentIds"],this.outputShape=[],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=[i],this.dispatchLayout=hi(o),this.dispatch=Nr(this.dispatchLayout,o,this.workgroupSize),this.shaderKey="sparseSegmentIdCountProgram"}getUserCode(){return`
    ${Gr("index")} {
      if (index < uniforms.segmentIdsShape) {
        let segmentId = segmentIds[index];
        ${o1("&result[segmentId]","1","int32")}
      }
    }
  `}}class L6{constructor(i,o){this.variableNames=["segmentSum","sameSegmentIdCount"],this.outputShape=[],this.uniforms="segmentSize : i32",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.type=o,this.dispatchLayout=hi(i),this.dispatch=Nr(this.dispatchLayout,i,this.workgroupSize),this.shaderKey="sparseSegmentMean"}getUserCode(){return`
    ${Gr("index")} {
      if (index < uniforms.size) {
        let segmentId = index / uniforms.segmentSize;
        let count = sameSegmentIdCount[segmentId];
        if (count != 0) {
          ${this.type==="float32"?"setOutputAtIndex(index, segmentSum[index] / f32(count));":"setOutputAtIndexI32(index, segmentSum[index] / count);"}
        }
      }
    }
  `}}function $6(l,i,o,u=!1,c){let f=m.util.sizeFromShape(l.shape)/l.shape[0],y=l.dtype,w=m.util.sizeFromShape(i.shape),C=c.readSync(o.dataId),T=w>0?C[w-1]+1:0,x,A=l.shape.slice();A[0]=T;let M=w*f,$=Qc({backend:c,attrs:{shape:A,value:0,dtype:y}});x=new O6(A,M,y);let V=[{type:"int32",data:[f]},{type:"int32",data:[M]}],G=c.runWebGPUProgram(x,[l,i,o],y,V,$);if(u)return G;let Q=Qc({backend:c,attrs:{shape:[T],value:0,dtype:"int32"}});x=new T4(T,o.shape);let nt=c.runWebGPUProgram(x,[o],"int32",null,Q),it=Qc({backend:c,attrs:{shape:A,value:0,dtype:y}});x=new L6(A,y),V=[{type:"int32",data:[f]}];let ht=c.runWebGPUProgram(x,[G,nt],y,V,it);return c.disposeData(G.dataId),c.disposeData(nt.dataId),ht}let JP={kernelName:m.SparseSegmentMean,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{data:u,indices:c,segmentIds:f}=i;return $6(u,c,f,!1,o)}},xtt={kernelName:m.SparseSegmentSum,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{data:u,indices:c,segmentIds:f}=i;return $6(u,c,f,!0,o)}};class wc{constructor(i,o){this.variableNames=["A"],this.workgroupSize=[64,1,1],this.size=!0;let u=new Array(i.length);for(let c=0;c<u.length;c++)u[c]=i[c]*o[c];this.outputShape=u,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.rank=this.outputShape.length,this.shaderKey="tile"}getUserCode(){let i=function(o,u=""){if(o>=5)throw Error(`Tile for rank ${o} is not yet supported`);if(o===1)return`(resRC % ${u}aShape)`;let c=["resRC.x","resRC.y","resRC.z","resRC.w"],f=[];for(let y=0;y<o;y++)f.push(`(${c[y]} % ${u}aShape[${y}])`);return f.join()}(this.rank,"uniforms.");return`
      ${Gr("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          setOutputAtIndex(index, getA(${i}));
        }
      }
    `}}function Yb(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{reps:f}=u;if(o.shouldExecuteOnCPU([c])||c.dtype==="string"||c.shape.length>=5){let w=o.readSync(c.dataId),C=c.dtype==="string"?w.map(A=>m.util.decodeString(A)):w,T=(0,m.buffer)(c.shape,c.dtype,C),x=qft(T,f);return o.makeTensorInfo(x.shape,x.dtype,x.values)}let y=new wc(c.shape,f);return o.runWebGPUProgram(y,[c],c.dtype)}let z6={kernelName:m.Tile,backendName:"webgpu",kernelFunc:Yb},$0={kernelName:m.SparseToDense,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{sparseIndices:c,sparseValues:f,defaultValue:y}=i,{outputShape:w}=u,{sliceRank:C,numUpdates:T,sliceSize:x,strides:A,outputSize:M}=m.backend_util.calculateShapes(f,c,w),$=!1;if(f.dtype==="string"){let Ut=o.bufferSync(c),Pt=o.bufferSync(f),re=m.util.decodeString(o.readSync(y.dataId)[0]),ue=Yft(Ut,Pt,w,M,x,T,C,A,re,$);return o.makeTensorInfo(w,ue.dtype,ue.values)}let V=[M/x,x],G=zi({inputs:{x:c},backend:o,attrs:{shape:[T,C]}}),Q=f.shape.length?zi({inputs:{x:f},backend:o,attrs:{shape:[T,x]}}):Hd({inputs:{x:f},backend:o}),nt=Q.dtype,it=o.makeTensorInfo([],nt,m.util.makeZerosTypedArray(1,nt)),ht=zi({inputs:{x:y},backend:o,attrs:{shape:Array(V.length).fill(1)}}),kt=Yb({inputs:{x:ht},backend:o,attrs:{reps:V}}),Nt=[{type:"int32",data:[C]},{type:"int32",data:A},{type:"int32",data:[m.util.sizeFromShape([T,x])]}];switch(T){case 0:break;case 1:{let Ut=new R6([T,x],C,G.shape.length,Q.shape.length,A,V,nt,$);o.runWebGPUProgram(Ut,[Q,G],nt,Nt,kt)}break;default:{let Ut=new R6([T,x],C,G.shape.length,it.shape.length,A,V,nt,$);o.runWebGPUProgram(Ut,[it,G],nt,Nt,kt)}{let Ut=new R6([T,x],C,G.shape.length,Q.shape.length,A,V,nt);o.runWebGPUProgram(Ut,[Q,G],nt,Nt,kt)}}let $t=zi({inputs:{x:kt},backend:o,attrs:{shape:w}});return o.disposeData(G.dataId),o.disposeData(Q.dataId),o.disposeData(ht.dataId),o.disposeData(it.dataId),o.disposeData(kt.dataId),$t}},tB={kernelName:m.SplitV,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{numOrSizeSplits:f,axis:y}=u,w=m.util.parseAxisParam(y,c.shape)[0],C=m.backend_util.prepareSplitSize(c,f,w),T=c.shape.length,x=new Array(T).fill(0),A=c.shape.slice();return C.map(M=>{let $=[...A];$[w]=M;let V=p4({inputs:{x:c},backend:o,attrs:{begin:x,size:$}});return x[w]+=M,V})}},eB=go({opType:zr.SQRT}),ktt={kernelName:m.Sqrt,backendName:"webgpu",kernelFunc:eB},S0t={kernelName:m.Square,backendName:"webgpu",kernelFunc:({inputs:l,backend:i})=>{let{x:o}=l,u=i,c=new h4(o.shape,zr.SQUARE);return u.runWebGPUProgram(c,[o],o.dtype)}},_0t=Dl({opType:Ma.SQUARED_DIFFERENCE}),T7={kernelName:m.SquaredDifference,backendName:"webgpu",kernelFunc:_0t},C0t={kernelName:m.Step,backendName:"webgpu",kernelFunc:function({inputs:l,attrs:i,backend:o}){let{x:u}=l,c=new h4(u.shape,zr.STEP,"stepAlpha : f32,"),f=[{type:"float32",data:[i.alpha]}];return o.runWebGPUProgram(c,[u],u.dtype,f)}};class E0t{constructor(i){this.variableNames=["x"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]);let o=ol(this.outputShape.length);this.uniforms=`begin : ${o},  strides : ${o}, `,this.shaderKey="stridedSlice"}getUserCode(){let i="";if(this.outputShape.length===1)i="coords * uniforms.strides + uniforms.begin";else{let o=0;i=this.outputShape.map((u,c)=>(o++,this.outputShape.length===1?`coords * uniforms.strides[${c}] + uniforms.begin[${c}]`:`coords[${o-1}] * uniforms.strides[${c}] + uniforms.begin[${c}]`)).join(",")}return`
       ${Gr("index")} {
         if (index < uniforms.size) {
           let coords = getCoordsFromIndex(index);
           setOutputAtIndex(index, getX(${i}));
         }
       }
     `}}let eu={kernelName:m.StridedSlice,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{begin:f,end:y,strides:w,beginMask:C,endMask:T,ellipsisMask:x,newAxisMask:A,shrinkAxisMask:M}=u,{finalShapeSparse:$,finalShape:V,isIdentity:G,sliceDim0:Q,isSimpleSlice:nt,begin:it,end:ht,strides:kt}=m.slice_util.sliceInfo(c.shape,f,y,w,C,T,x,A,M),Nt;if(G)Nt=zi({inputs:{x:c},backend:o,attrs:{shape:V}});else if(Q||nt){m.util.assert(c.shape.length>=1,()=>`Input must have rank at least 1, got: ${c.shape.length}`);let $t=m.slice_util.computeOutShape(it,ht,kt),Ut=p4({inputs:{x:c},backend:o,attrs:{begin:it,size:$t}});Nt=zi({inputs:{x:Ut},backend:o,attrs:{shape:V}}),o.disposeData(Ut.dataId)}else if(o.shouldExecuteOnCPU([c])){let $t=o.readSync(c.dataId),Ut=(0,m.buffer)(c.shape,c.dtype,$t),Pt=nJ($,Ut,kt,it);Nt=o.makeTensorInfo(V,c.dtype,Pt.values)}else{let $t=new E0t($),Ut=[{type:"int32",data:it},{type:"int32",data:kt}],Pt=o.runWebGPUProgram($t,[c],c.dtype,Ut);Nt=zi({inputs:{x:Pt},backend:o,attrs:{shape:V}}),o.disposeData(Pt.dataId)}return Nt}},A7={kernelName:m.StringNGrams,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{separator:c,nGramWidths:f,leftPad:y,rightPad:w,padWidth:C,preserveShortSequences:T}=u,{data:x,dataSplits:A}=i,M=o.readSync(x.dataId),$=o.readSync(A.dataId),[V,G]=rJ(M,$,c,f,y,w,C,T);return[o.makeTensorInfo([V.length],"string",V),o.makeTensorInfo(A.shape,"int32",G)]}},Stt=Dl({opType:Ma.SUB,cpuKernelImpl:Yd,supportsComplex:!0}),T0t={kernelName:m.Sub,backendName:"webgpu",kernelFunc:Stt},_tt=go({opType:zr.TAN}),Ctt={kernelName:m.Tan,backendName:"webgpu",kernelFunc:_tt},Ett=go({opType:zr.TANH}),A0t={kernelName:m.Tanh,backendName:"webgpu",kernelFunc:Ett},I0t={kernelName:m.TensorScatterUpdate,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o}=l,{tensor:u,indices:c,updates:f}=i,{sliceRank:y,numUpdates:w,sliceSize:C,strides:T,outputSize:x}=m.backend_util.calculateShapes(f,c,u.shape),A=[x/C,C];if(x===0)return o.makeTensorInfo(u.shape,c.dtype);let M=[],$=zi({inputs:{x:c},backend:o,attrs:{shape:[w,y]}});M.push($);let V=zi({inputs:{x:f},backend:o,attrs:{shape:[w,C]}});M.push(V);let G=zi({inputs:{x:u},backend:o,attrs:{shape:A}});M.push(G);let Q=Yb({inputs:{x:G},backend:o,attrs:{reps:Array(A.length).fill(1)}}),nt=new R6([w,C],y,$.shape.length,V.shape.length,T,A,u.dtype,!1),it=[{type:"int32",data:[y]},{type:"int32",data:T},{type:"int32",data:[m.util.sizeFromShape([w,C])]}],ht=o.runWebGPUProgram(nt,[V,$],G.dtype,it,Q);M.push(ht);let kt=zi({inputs:{x:ht},backend:o,attrs:{shape:u.shape}});return M.forEach(Nt=>o.disposeData(Nt.dataId)),kt}};class N0t{constructor(i){this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=`inputSize : i32, firstPass : i32, negativeInf : f32,
        dir : i32, inc : i32,`,this.shaderKey="swap"}getUserCode(){return`
        ${Gr("index")} {
          if (index < uniforms.size) {
            let outC = getCoordsFromIndex(index);
            let batch = outC[0];
            let elemIdx = outC[1];
            // We compare elements pair-wise within a group of size 2 * inc.
            // The comparing rule for each group alternates between ascending
            // and descending. Within each group, we compare each pair at
            // positions i and i+inc. To decide whether an element at position i
            // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
            // inc, it is in the first half of the group, we denote it as x0,
            // otherwise we denote it as x1.
            // For example, as shown in the Bitonic top K paper referenced
            // above, Figure5(a) shows that element[1] is in the second half of
            // the group when group size is 2, but it is in the first half of
            // the group when group size is 4.
            let isFirstInPair = elemIdx % (2 * uniforms.inc) < uniforms.inc;
            var i = 0;
            if (isFirstInPair) {
              i = elemIdx;
            } else {
              i = elemIdx - uniforms.inc;
            }

            var i0 = 0;
            if (uniforms.firstPass == 1) {
              i0 = i;
            } else {
              i0 = i32(getIndices(batch, i));
            }

            var i1 = 0;
            if (uniforms.firstPass == 1) {
              i1 = i + uniforms.inc;
            } else {
              i1 = i32(getIndices(batch, i + uniforms.inc));
            }

            var x0 = f32(0.0);
            var x1 = f32(0.0);
            if (i0 < uniforms.inputSize) {
              x0 = getX(batch, i0);
            } else {
              x0 = uniforms.negativeInf;
            }
            if (i1 < uniforms.inputSize) {
              x1 = getX(batch, i1);
            } else {
              x1 = uniforms.negativeInf;
            }

            let reverse = elemIdx % (2 * uniforms.dir) >= uniforms.dir;
            let isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
            if (reverse == isGreater) {
              // Elements in opposite order of direction
              let iTemp = i0;
              i0 = i1;
              i1 = iTemp;
            }
            if (isFirstInPair) {
              setOutputAtIndex(index, f32(i0));
            } else {
              setOutputAtIndex(index, f32(i1));
            }
          }
        }
      `}}class M0t{constructor(i){this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms="inputSize : i32, firstPass : i32, k : i32,",this.shaderKey="merge"}getUserCode(){return`
        ${Gr("index")} {
          if (index < uniforms.size) {
            let outC = getCoordsFromIndex(index);
            let batch = outC[0];
            let elemIdx = outC[1];
            // The output size is half of the previous size.
            // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _
            // (k=4), we only need to output the indices at positions |, the
            // indices at positions _ can be thrown away, see Figure5(b) After
            // Phase 2 (Merge phase) in the Bitonic Top K paper referenced
            // above.
            // For example, the paper shows we only need to output the orange
            // bars. The output sequence should look like this | | | | | | | |.
            // Because the sequence is halved, to map the output index back to
            // the previous sequence to find the corresponding value, we need
            // to double the index. When we double the index, we basically
            // interpolate a position, so 2i looks like
            // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k
            // position of each 2k positions by - elemIdx % k. E.g. for output
            // at index 4,5,6,7, we want to get the corresponding element at
            // original index 8,9,10,11, for output at index 8,9,10,11,
            // we want to get the corresponding element at original index
            // 16,17,18,19, so on and so forth.

            var i = 0;
            if (elemIdx < uniforms.k) {
              i = elemIdx;
            } else {
              i = elemIdx * 2 - elemIdx % uniforms.k;
            }
            var i0 = 0;
            if (uniforms.firstPass == 1) {
              i0 = i;
            } else {
              i0 = i32(getIndices(batch, i));
            }
            var i1 = 0;
            if (uniforms.firstPass == 1) {
              i1 = i + uniforms.k;
            } else {
              i1 = i32(getIndices(batch, i + uniforms.k));
            }

            let x0 = getX(batch, i0);
            var x1 = f32(0.0);
            if (i1 < uniforms.inputSize) {
              x1 = getX(batch, i1);
            } else {
              x1 = x0;
            }

            if (x0 >= x1) {
              setOutputAtIndex(index, f32(i0));
            } else {
              setOutputAtIndex(index, f32(i1));
            }
          }
        }
      `}}function qb(l,i){i!==null&&l.disposeData(i.dataId)}function Ttt(l){let i=1;for(;i<l;)i*=2;return i}let D0t={kernelName:m.TopK,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c}=i,{k:f,sorted:y}=u,w=c.shape,C=w[w.length-1];if(o.shouldExecuteOnCPU([c])){let kt=o.readSync(c.dataId),[Nt,$t]=Xft(kt,w,c.dtype,f,y);return[o.makeTensorInfo(Nt.shape,Nt.dtype,Nt.values),o.makeTensorInfo($t.shape,$t.dtype,$t.values)]}if(f===0)return w[w.length-1]=0,[o.makeTensorInfo(w,c.dtype,[]),o.makeTensorInfo(w,"int32",[])];if(C===1)return[c,Qc({attrs:{shape:w,dtype:"int32",value:0},backend:o})];let T=m.util.sizeFromShape(w)/C,x=zi({inputs:{x:c},attrs:{shape:[T,C]},backend:o}),A=Ttt(f),M=Ttt(C),$=null,V=()=>$===null?[x,x]:[x,$],G=(kt,Nt,$t)=>{let Ut=V(),Pt=new N0t($t),re=[{type:"int32",data:[C]},{type:"int32",data:[$===null?1:0]},{type:"float32",data:[Number.NEGATIVE_INFINITY]},{type:"int32",data:[kt]},{type:"int32",data:[Nt]}],ue=$;$=o.runWebGPUProgram(Pt,Ut,"int32",re),qb(o,ue)};for(let kt=1;kt<A;kt*=2){let Nt=2*kt;for(let $t=kt;$t>=1;$t/=2)G(Nt,$t,[T,M])}for(let kt=M;kt>A;kt/=2){let Nt=V(),$t=new M0t([T,kt/2]),Ut=[{type:"int32",data:[C]},{type:"int32",data:[$===null?1:0]},{type:"int32",data:[A]}],Pt=$;$=o.runWebGPUProgram($t,Nt,"int32",Ut),qb(o,Pt);let re=A/2,ue=2*re;for(let be=re;be>=1;be/=2)G(ue,be,$.shape)}let Q=$;$=p4({inputs:{x:$},backend:o,attrs:{begin:0,size:[T,f]}}),qb(o,Q);let nt=S4({inputs:{x,indices:$},backend:o,attrs:{axis:1,batchDims:1}});qb(o,x);let it=w.slice(0,-1);it.push(f),Q=$,$=zi({inputs:{x:$},attrs:{shape:it},backend:o}),qb(o,Q);let ht=nt;return nt=zi({inputs:{x:nt},attrs:{shape:it},backend:o}),qb(o,ht),[nt,$]}};class nB{constructor(i){this.variableNames=["Image","Transforms"],this.uniforms="interpolationModeId : i32, fillModeId : i32, fillValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=i,this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="transform"}getUserCode(){return`
          fn mapCoord(outCoord : f32, len : f32) -> f32{
            var inCoord = outCoord;
            if(uniforms.fillModeId == 2) {
              if (inCoord < 0.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz2 = 2.0 * len;
                  if (inCoord < sz2) {
                    inCoord = sz2 * f32(i32(f32(-inCoord / sz2))) +
                    inCoord;
                  }
                  if (inCoord < -len) {
                    inCoord = inCoord + sz2;
                  } else {
                    inCoord = -inCoord - 1.0;
                  }
                }
              } else if (inCoord > len - 1.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz2 = 2.0 * len;
                  inCoord = inCoord - sz2 * f32(i32(f32(inCoord / sz2)));
                  if (inCoord >= len) {
                    inCoord = sz2 - inCoord - 1.0;
                  }
                }
              }
              return clamp(inCoord, 0.0, len - 1.0);
            } else if (uniforms.fillModeId == 3) {
              if (inCoord < 0.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz = len - 1.0;
                  inCoord = inCoord + len * (f32(i32(f32(-inCoord / sz))) + 1.0);
                }
              } else if (inCoord > len - 1.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz = len - 1.0;
                  inCoord = inCoord - len * f32(i32(f32(inCoord / sz)));
                }
              }
              return clamp(inCoord, 0.0, len - 1.0);
            } else if (uniforms.fillModeId == 4) {
              return clamp(outCoord, 0.0, len - 1.0);
            }
            return outCoord;
          }
          fn readWithFillValue(batch : i32, coordY : i32, coordX : i32,
            channel : i32) -> f32 {
            var outputValue : f32;
            if (0 <= coordY && coordY < uniforms.imageShape[1] && 0 <= coordX && coordX < uniforms.imageShape[2]) {
                outputValue = getImage(batch, coordY, coordX, channel);
            } else {
              outputValue = uniforms.fillValue;
            }
            return outputValue;
          }

          ${Gr("index")} {
            if (index < uniforms.size) {
              let coords = getCoordsFromIndex(index);
              var outputValue : f32;
              let batch = coords[0];
              let x = coords[2];
              let y = coords[1];
              let channel = coords[3];
              let xf = f32(x);
              let yf = f32(y);
              let a1 = getTransforms(batch, 0);
              let a2 = getTransforms(batch, 1);
              let a3 = getTransforms(batch, 2);
              let b1 = getTransforms(batch, 3);
              let b2 = getTransforms(batch, 4);
              let b3 = getTransforms(batch, 5);
              let c1 = getTransforms(batch, 6);
              let c2 = getTransforms(batch, 7);
              let projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = uniforms.fillValue;
              } else {
                let inX = (a1 * xf + a2 * yf + a3) / projection;
                let inY = (b1 * xf + b2 * yf + b3) / projection;
                let mapX = mapCoord(inX, f32(uniforms.imageShape[2]));
                let mapY = mapCoord(inY, f32(uniforms.imageShape[1]));

                if (uniforms.interpolationModeId == 1) {
                  let coordY = i32(round(mapY));
                  let coordX = i32(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  let yFloor = floor(mapY);
                  let xFloor = floor(mapX);
                  let yCeil = yFloor + 1.0;
                  let xCeil = xFloor + 1.0;
                  let valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, i32(yFloor), i32(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, i32(yFloor), i32(xCeil), channel);
                  let valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, i32(yCeil), i32(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, i32(yCeil), i32(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutputAtIndex(index, outputValue);
            }
          }
        `}}let Att={kernelName:m.Transform,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{image:c,transforms:f}=i,{interpolation:y,fillMode:w,fillValue:C,outputShape:T}=u,[x,A,M,$]=c.shape,[V,G]=T??[A,M],Q=new nB([x,V,G,$]),nt=y==="nearest"?1:2,it;switch(w){case"constant":default:it=1;break;case"reflect":it=2;break;case"wrap":it=3;break;case"nearest":it=4}let ht=[{type:"int32",data:[nt]},{type:"int32",data:[it]},{type:"float32",data:[C]}];return o.runWebGPUProgram(Q,[c,f],"float32",ht)}},R0t={kernelName:m.Unpack,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{value:c}=i,{axis:f}=u;f<0&&(f+=c.shape.length);let y=c,w=y.shape.length,C=c.shape[f],T=new Array(w-1),x=0;for(let G=0;G<w;G++)G!==f&&(T[x++]=y.shape[G]);let A=[],M=new Array(w).fill(0),$=y.shape.slice();$[f]=1;let V=new Array(C);for(let G=0;G<V.length;G++){M[f]=G;let Q=p4({inputs:{x:y},backend:o,attrs:{begin:M,size:$}}),nt=zi({inputs:{x:Q},backend:o,attrs:{shape:T}});V[G]=nt,A.push(Q)}return A.forEach(G=>o.disposeData(G.dataId)),V}};class F0t{constructor(i,o,u){if(this.outputShape=[],this.variableNames=["x","segmentIds"],this.uniforms="numSegments : i32, xSize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=o,this.dispatchLayout=hi(i),this.dispatch=Nr(this.dispatchLayout,i,this.workgroupSize),u!=="float32"&&u!=="int32")throw new Error(`UnsortedSegmentSum only supports float32 and int32
              types, does not support ${u} type.`);this.type=u,this.shaderKey="unsortedSegmentSum"}getUserCode(){return`
    ${Gr("index")} {
      if (index < uniforms.xSize) {
        let coords = getXCoordsFromIndex(index);
        let b = coords[0];
        let inCol = coords[1];

        let segmentId = i32(getSegmentIds(inCol));
        if (segmentId >= 0) {
          let flatIndex = b * uniforms.numSegments + segmentId % uniforms.numSegments;
          let value = getX(b, inCol);

          ${o1("&result[flatIndex]","value",this.type)}
        }
      }
    }
  `}}let O0t={kernelName:m.UnsortedSegmentSum,backendName:"webgpu",kernelFunc:function(l){let{inputs:i,backend:o,attrs:u}=l,{x:c,segmentIds:f}=i,{numSegments:y}=u,w=c.shape.length,C=[],T=0,x=m.backend_util.getAxesPermutation([T],w),A=c;x!=null&&(A=Um({inputs:{x:c},backend:o,attrs:{perm:x}}),C.push(A),T=m.backend_util.getInnerMostAxes(1,w)[0]);let M=m.backend_util.segment_util.computeOutShape(A.shape,T,y),$=m.util.sizeFromShape([A.shape[T]]),V=zi({inputs:{x:A},backend:o,attrs:{shape:[-1,$]}});C.push(V);let G=c.dtype,Q=[V.shape[0],y],nt=Qc({backend:o,attrs:{shape:Q,value:0,dtype:G}}),it=new F0t(V.shape,Q,G),ht=[{type:"int32",data:[y]},{type:"int32",data:[m.util.sizeFromShape(V.shape)]}],kt=o.runWebGPUProgram(it,[V,f],G,ht,nt),Nt=zi({inputs:{x:kt},backend:o,attrs:{shape:M}});C.push(kt);let $t=Nt;if(x!=null){C.push(Nt);let Ut=m.backend_util.getUndoAxesPermutation(x);$t=Um({inputs:{x:$t},backend:o,attrs:{perm:Ut}})}return C.forEach(Ut=>o.disposeData(Ut.dataId)),$t}},Itt=[HQ,_6,E6,sP,A6,i7,Qft,Jft,tpt,ept,rpt,apt,spt,lpt,sJ,hpt,lJ,dpt,fpt,ppt,c1,hJ,gP,l7,h1,fJ,Pft,c7,bpt,wP,kpt,Wm,Ih,b4,f7,bJ,wJ,xJ,SJ,_J,CJ,CP,AP,IP,TJ,_pt,IJ,Cpt,Ept,Apt,DJ,FJ,Ipt,DP,$kt,Pkt,Bkt,Ukt,Dpt,tP,Fpt,Bpt,Lpt,zpt,$J,Upt,Wpt,Vpt,ey,C4,M6,zft,Vm,mJ,Hpt,qpt,Kpt,Zpt,PJ,D6,v7,UJ,b7,w7,Vb,GJ,k7,YJ,uJ,XJ,S7,LP,KJ,bc,ZJ,fP,Jpt,$P,e0t,ttt,ntt,y7,E7,rtt,n0t,ypt,i0t,PP,att,o0t,s0t,stt,u0t,l0t,u7,ltt,htt,ftt,ptt,$ft,mtt,Hm,WP,GP,HP,gtt,ytt,m0t,g0t,btt,y0t,b0t,Hb,w0t,k0t,ny,mpt,C0t,eu,A7,zP,ZP,F6,JP,xtt,$0,tB,ktt,S0t,T7,T0t,MJ,Ctt,A0t,I0t,z6,D0t,Att,a7,R0t,O0t,itt];for(let l of Itt)(0,m.registerKernel)(l);var Ntt=function(l,i){return(Ntt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&(o[c]=u[c])})(l,i)};function Mtt(l,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=l}Ntt(l,i),l.prototype=i===null?Object.create(i):(o.prototype=i.prototype,new o)}var Ts=function(){return(Ts=Object.assign||function(l){for(var i,o=1,u=arguments.length;o<u;o++)for(var c in i=arguments[o])Object.prototype.hasOwnProperty.call(i,c)&&(l[c]=i[c]);return l}).apply(this,arguments)};function So(l,i,o,u){return new(o||(o=Promise))(function(c,f){function y(T){try{C(u.next(T))}catch(x){f(x)}}function w(T){try{C(u.throw(T))}catch(x){f(x)}}function C(T){var x;T.done?c(T.value):(x=T.value,x instanceof o?x:new o(function(A){A(x)})).then(y,w)}C((u=u.apply(l,[])).next())})}function yo(l,i){var o,u,c,f,y={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return f={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function w(C){return function(T){return function(x){if(o)throw new TypeError("Generator is already executing.");for(;y;)try{if(o=1,u&&(c=2&x[0]?u.return:x[0]?u.throw||((c=u.return)&&c.call(u),0):u.next)&&!(c=c.call(u,x[1])).done)return c;switch(u=0,c&&(x=[2&x[0],c.value]),x[0]){case 0:case 1:c=x;break;case 4:return y.label++,{value:x[1],done:!1};case 5:y.label++,u=x[1],x=[0];continue;case 7:x=y.ops.pop(),y.trys.pop();continue;default:if(!((c=(c=y.trys).length>0&&c[c.length-1])||x[0]!==6&&x[0]!==2)){y=0;continue}if(x[0]===3&&(!c||x[1]>c[0]&&x[1]<c[3])){y.label=x[1];break}if(x[0]===6&&y.label<c[1]){y.label=c[1],c=x;break}if(c&&y.label<c[2]){y.label=c[2],y.ops.push(x);break}c[2]&&y.ops.pop(),y.trys.pop();continue}x=i.call(l,y)}catch(A){x=[6,A],u=0}finally{o=c=0}if(5&x[0])throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}([C,T])}}}function ry(l,i,o){if(o||arguments.length===2)for(var u,c=0,f=i.length;c<f;c++)!u&&c in i||(u||(u=Array.prototype.slice.call(i,0,c)),u[c]=i[c]);return l.concat(u||Array.prototype.slice.call(i))}var Af=["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"],Xb=["nose","left_eye_inner","left_eye","left_eye_outer","right_eye_inner","right_eye","right_eye_outer","left_ear","right_ear","mouth_left","mouth_right","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_pinky","right_pinky","left_index","right_index","left_thumb","right_thumb","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle","left_heel","right_heel","left_foot_index","right_foot_index"],Dtt={left:[1,2,3,7,9,11,13,15,17,19,21,23,25,27,29,31],right:[4,5,6,8,10,12,14,16,18,20,22,24,26,28,30,32],middle:[0]},Ym={left:[1,3,5,7,9,11,13,15],right:[2,4,6,8,10,12,14,16],middle:[0]},L0t=[[0,1],[0,2],[1,3],[2,4],[5,6],[5,7],[5,11],[6,8],[6,12],[7,9],[8,10],[11,12],[11,13],[12,14],[13,15],[14,16]],Rtt=[[0,1],[0,4],[1,2],[2,3],[3,7],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[11,23],[12,14],[14,16],[12,24],[13,15],[15,17],[16,18],[16,20],[15,17],[15,19],[15,21],[16,22],[17,19],[18,20],[23,25],[23,24],[24,26],[25,27],[26,28],[27,29],[28,30],[27,31],[28,32],[29,31],[30,32]];function A4(l){return l instanceof SVGAnimatedLength?l.baseVal.value:l}function Ftt(l){return So(this,void 0,void 0,function(){var i,o;return yo(this,function(u){switch(u.label){case 0:return i=document.createElement("canvas"),l instanceof m.Tensor?[4,m.browser.toPixels(l,i)]:[3,2];case 1:return u.sent(),[3,3];case 2:i.width=A4(l.width),i.height=A4(l.height),o=i.getContext("2d"),l instanceof ImageData?o.putImageData(l,0,0):o.drawImage(l,0,0),u.label=3;case 3:return[2,i]}})})}function I4(l){return So(this,void 0,void 0,function(){var i,o,u,c,f,y;return yo(this,function(w){switch(w.label){case 0:return l instanceof m.Tensor?(i=l.shape.slice(0,2),o=i[0],u=i[1],c=ImageData.bind,[4,m.browser.toPixels(l)]):[3,2];case 1:return[2,new(c.apply(ImageData,[void 0,w.sent(),u,o]))];case 2:return f=document.createElement("canvas"),y=f.getContext("2d"),f.width=A4(l.width),f.height=A4(l.height),y.drawImage(l,0,0),[2,y.getImageData(0,0,f.width,f.height)]}})})}function P6(l){return So(this,void 0,void 0,function(){var i,o;return yo(this,function(u){switch(u.label){case 0:return l instanceof SVGImageElement||l instanceof OffscreenCanvas?[4,Ftt(l)]:[3,2];case 1:return o=u.sent(),[3,3];case 2:o=l,u.label=3;case 3:return i=o,[2,m.browser.fromPixels(i,4)]}})})}function f1(l){if(l<0||l>=256)throw new Error("Mask value must be in range [0, 255] but got ".concat(l));if(!Number.isInteger(l))throw new Error("Mask value must be an integer but got ".concat(l))}var z0={runtime:"mediapipe",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,modelType:"full"},qm=function(){function l(i){this.mask=i}return l.prototype.toCanvasImageSource=function(){return So(this,void 0,void 0,function(){return yo(this,function(i){return[2,this.mask]})})},l.prototype.toImageData=function(){return So(this,void 0,void 0,function(){return yo(this,function(i){return[2,I4(this.mask)]})})},l.prototype.toTensor=function(){return So(this,void 0,void 0,function(){return yo(this,function(i){return[2,P6(this.mask)]})})},l.prototype.getUnderlyingType=function(){return"canvasimagesource"},l}();function N4(l){return f1(l),"person"}var rB=function(){function l(i){var o,u=this;switch(this.width=0,this.height=0,this.selfieMode=!1,this.poseSolution=new _ft.Pose({locateFile:function(c,f){if(i.solutionPath){var y=i.solutionPath.replace(/\/+$/,"");return"".concat(y,"/").concat(c)}return"".concat(f,"/").concat(c)}}),i.modelType){case"lite":o=0;break;case"heavy":o=2;break;default:o=1}this.poseSolution.setOptions({modelComplexity:o,smoothLandmarks:i.enableSmoothing,enableSegmentation:i.enableSegmentation,smoothSegmentation:i.smoothSegmentation,selfieMode:this.selfieMode}),this.poseSolution.onResults(function(c){if(u.height=c.image.height,u.width=c.image.width,c.poseLandmarks==null)u.poses=[];else{var f=u.translateOutput(c.poseLandmarks,c.poseWorldLandmarks);c.segmentationMask&&(f.segmentation={maskValueToLabel:N4,mask:new qm(c.segmentationMask)}),u.poses=[f]}})}return l.prototype.translateOutput=function(i,o){var u=this,c={keypoints:i.map(function(f,y){return{x:f.x*u.width,y:f.y*u.height,z:f.z,score:f.visibility,name:Xb[y]}})};return o!=null&&(c.keypoints3D=o.map(function(f,y){return{x:f.x,y:f.y,z:f.z,score:f.visibility,name:Xb[y]}})),c},l.prototype.estimatePoses=function(i,o,u){return So(this,void 0,void 0,function(){var c,f;return yo(this,function(y){switch(y.label){case 0:return o&&o.flipHorizontal&&o.flipHorizontal!==this.selfieMode&&(this.selfieMode=o.flipHorizontal,this.poseSolution.setOptions({selfieMode:this.selfieMode})),i instanceof m.Tensor?(f=ImageData.bind,[4,m.browser.toPixels(i)]):[3,2];case 1:return c=new(f.apply(ImageData,[void 0,y.sent(),i.shape[1],i.shape[0]])),[3,3];case 2:c=i,y.label=3;case 3:return i=c,[4,this.poseSolution.send({image:i},u)];case 4:return y.sent(),[2,this.poses]}})})},l.prototype.dispose=function(){this.poseSolution.close()},l.prototype.reset=function(){this.poseSolution.reset()},l.prototype.initialize=function(){return this.poseSolution.initialize()},l}();function iB(l){return So(this,void 0,void 0,function(){var i,o;return yo(this,function(u){switch(u.label){case 0:return i=function(c){if(c==null)return Ts({},z0);var f=Ts({},c);return f.runtime="mediapipe",f.enableSegmentation==null&&(f.enableSegmentation=z0.enableSegmentation),f.enableSmoothing==null&&(f.enableSmoothing=z0.enableSmoothing),f.smoothSegmentation==null&&(f.smoothSegmentation=z0.smoothSegmentation),f.modelType==null&&(f.modelType=z0.modelType),f}(l),[4,(o=new rB(i)).initialize()];case 1:return u.sent(),[2,o]}})})}function Kb(l){return l instanceof m.Tensor?{height:l.shape[0],width:l.shape[1]}:{height:l.height,width:l.width}}function Ott(l){return l-2*Math.PI*Math.floor((l+Math.PI)/(2*Math.PI))}function qd(l){return l instanceof m.Tensor?l:m.browser.fromPixels(l)}function Ltt(l,i,o){return M4(o,"inputResolution"),[1/o.width*l[0][0]*i.width,1/o.height*l[0][1]*i.width,l[0][3]*i.width,1/o.width*l[1][0]*i.height,1/o.height*l[1][1]*i.height,l[1][3]*i.height,0,0]}function M4(l,i){m.util.assert(l.width!==0,function(){return"".concat(i," width cannot be 0.")}),m.util.assert(l.height!==0,function(){return"".concat(i," height cannot be 0.")})}function I7(l,i,o){var u=o.rotationVectorStartKeypointIndex,c=o.rotationVectorEndKeypointIndex,f=l.locationData,y=f.relativeKeypoints[u].x*i.width,w=f.relativeKeypoints[u].y*i.height,C=f.relativeKeypoints[c].x*i.width,T=f.relativeKeypoints[c].y*i.height,x=2*Math.sqrt((C-y)*(C-y)+(T-w)*(T-w)),A=function(M,$,V){var G,Q=M.locationData,nt=V.rotationVectorStartKeypointIndex,it=V.rotationVectorEndKeypointIndex;G=V.rotationVectorTargetAngle?V.rotationVectorTargetAngle:Math.PI*V.rotationVectorTargetAngleDegree/180;var ht=Q.relativeKeypoints[nt].x*$.width,kt=Q.relativeKeypoints[nt].y*$.height,Nt=Q.relativeKeypoints[it].x*$.width,$t=Q.relativeKeypoints[it].y*$.height;return Ott(G-Math.atan2(-($t-kt),Nt-ht))}(l,i,o);return{xCenter:y/i.width,yCenter:w/i.height,width:x/i.width,height:x/i.height,rotation:A}}function aB(l){if(l.length!==16)throw new Error("Array length must be 16 but got ".concat(l.length));return[[l[0],l[1],l[2],l[3]],[l[4],l[5],l[6],l[7]],[l[8],l[9],l[10],l[11]],[l[12],l[13],l[14],l[15]]]}function N7(l,i,o,u,c,f,y){return l[i][c]*(l[o][f]*l[u][y]-l[o][y]*l[u][f])}function Jc(l,i,o){var u=(i+1)%4,c=(i+2)%4,f=(i+3)%4,y=(o+1)%4,w=(o+2)%4,C=(o+3)%4;return N7(l,u,c,f,y,w,C)+N7(l,c,f,u,y,w,C)+N7(l,f,u,c,y,w,C)}function M7(l,i,o){o===void 0&&(o={ignoreRotation:!1});for(var u=[],c=0,f=l;c<f.length;c++){var y=f[c],w=y.x-.5,C=y.y-.5,T=o.ignoreRotation?0:i.rotation,x=Math.cos(T)*w-Math.sin(T)*C,A=Math.sin(T)*w+Math.cos(T)*C;x=x*i.width+i.xCenter,A=A*i.height+i.yCenter;var M=y.z*i.width,$=Ts({},y);$.x=x,$.y=A,$.z=M,u.push($)}return u}function p1(l,i){var o=function(u,c,f,y){var w=(y-f)/255;return{scale:w,offset:f-0*w}}(0,0,i[0],i[1]);return(0,m.tidy)(function(){return(0,m.add)((0,m.mul)(l,o.scale),o.offset)})}function oB(l,i,o){var u,c,f,y,w,C,T,x,A,M,$,V,G=i.outputTensorSize,Q=i.keepAspectRatio,nt=i.borderMode,it=i.outputTensorFloatRange,ht=Kb(l),kt=function(Ut,Pt){return Pt?{xCenter:Pt.xCenter*Ut.width,yCenter:Pt.yCenter*Ut.height,width:Pt.width*Ut.width,height:Pt.height*Ut.height,rotation:Pt.rotation}:{xCenter:.5*Ut.width,yCenter:.5*Ut.height,width:Ut.width,height:Ut.height,rotation:0}}(ht,o),Nt=function(Ut,Pt,re){if(re===void 0&&(re=!1),!re)return{top:0,left:0,right:0,bottom:0};var ue=Pt.height,be=Pt.width;M4(Pt,"targetSize"),M4(Ut,"roi");var De,ze,Qe=ue/be,cn=Ut.height/Ut.width,en=0,sn=0;return Qe>cn?(De=Ut.width,ze=Ut.width*Qe,sn=(1-cn/Qe)/2):(De=Ut.height/Qe,ze=Ut.height,en=(1-Qe/cn)/2),Ut.width=De,Ut.height=ze,{top:sn,left:en,right:en,bottom:sn}}(kt,G,Q),$t=(u=kt,c=ht.width,f=ht.height,y=u.width,w=u.height,C=Math.cos(u.rotation),T=Math.sin(u.rotation),x=u.xCenter,A=u.yCenter,M=1/c,$=1/f,(V=new Array(16))[0]=y*C*1*M,V[1]=-w*T*M,V[2]=0,V[3]=(-.5*y*C*1+.5*w*T+x)*M,V[4]=y*T*1*$,V[5]=w*C*$,V[6]=0,V[7]=(-.5*w*C-.5*y*T*1+A)*$,V[8]=0,V[9]=0,V[10]=y*M,V[11]=0,V[12]=0,V[13]=0,V[14]=0,V[15]=1,aB(V));return{imageTensor:(0,m.tidy)(function(){var Ut=qd(l),Pt=(0,m.tensor2d)(Ltt($t,ht,G),[1,8]),re=nt==="zero"?"constant":"nearest",ue=m.image.transform((0,m.expandDims)((0,m.cast)(Ut,"float32")),Pt,"bilinear",re,0,[G.height,G.width]);return it!=null?p1(ue,it):ue}),padding:Nt,transformationMatrix:$t}}function $tt(l,i,o,u){return u===1?.5*(l+i):l+(i-l)*o/(u-1)}function ztt(l){return l!=null&&l.currentTime!=null}function Ptt(l){for(var i={locationData:{relativeKeypoints:[]}},o=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,f=Number.MIN_SAFE_INTEGER,y=0;y<l.length;++y){var w=l[y];o=Math.min(o,w.x),u=Math.max(u,w.x),c=Math.min(c,w.y),f=Math.max(f,w.y),i.locationData.relativeKeypoints.push({x:w.x,y:w.y})}return i.locationData.relativeBoundingBox={xMin:o,yMin:c,xMax:u,yMax:f,width:u-o,height:f-c},i}function m1(l,i,o,u){return So(this,void 0,void 0,function(){var c,f,y,w,C;return yo(this,function(T){switch(T.label){case 0:return l.sort(function(x,A){return Math.max.apply(Math,A.score)-Math.max.apply(Math,x.score)}),c=(0,m.tensor2d)(l.map(function(x){return[x.locationData.relativeBoundingBox.yMin,x.locationData.relativeBoundingBox.xMin,x.locationData.relativeBoundingBox.yMax,x.locationData.relativeBoundingBox.xMax]})),f=(0,m.tensor1d)(l.map(function(x){return x.score[0]})),[4,m.image.nonMaxSuppressionAsync(c,f,i,o)];case 1:return[4,(y=T.sent()).array()];case 2:return w=T.sent(),C=l.filter(function(x,A){return w.indexOf(A)>-1}),(0,m.dispose)([c,f,y]),[2,C]}})})}function B6(l,i){return l.map(function(o){var u=Ts(Ts({},o),{x:o.x*i.width,y:o.y*i.height});return o.z!=null&&(u.z=o.z*i.width),u})}function Btt(l,i,o){return So(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M,$,V,G,Q,nt,it,ht,kt,Nt,$t,Ut,Pt,re,ue;return yo(this,function(be){switch(be.label){case 0:if(u=(0,m.squeeze)(i,[0]),c=u.shape,f=c[0],y=c[1],w=c[2],l.length!==w)throw new Error("Expected heatmap to have same number of channels as the number of landmarks. But got landmarks length: "+"".concat(l.length,", heatmap length: ").concat(w));return C=[],[4,u.buffer()];case 1:for(T=be.sent(),x=0;x<l.length;x++)if(A=l[x],M=Ts({},A),C.push(M),$=Math.trunc(M.x*y),V=Math.trunc(M.y*f),!($<0||$>=y||V<0||$>=f)){for(G=Math.trunc((o.kernelSize-1)/2),Q=Math.max(0,$-G),nt=Math.min(y,$+G+1),it=Math.max(0,V-G),ht=Math.min(f,V+G+1),kt=0,Nt=0,$t=0,Ut=0,Pt=it;Pt<ht;++Pt)for(re=Q;re<nt;++re)ue=T.get(Pt,re,x),kt+=ue,Ut=Math.max(Ut,ue),Nt+=re*ue,$t+=Pt*ue;Ut>=o.minConfidenceToRefine&&kt>0&&(M.x=Nt/y/kt,M.y=$t/f/kt)}return u.dispose(),[2,C]}})})}function sB(l,i){var o=i.left,u=i.top,c=i.left+i.right,f=i.top+i.bottom;return l.map(function(y){return Ts(Ts({},y),{x:(y.x-o)/(1-c),y:(y.y-u)/(1-f),z:y.z/(1-c)})})}function j6(l,i,o){return So(this,void 0,void 0,function(){var u,c,f,y,w;return yo(this,function(C){switch(C.label){case 0:return u=l[0],c=l[1],f=function(T,x,A){return(0,m.tidy)(function(){var M,$,V,G;$=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+0],[-1,1])),M=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+1],[-1,1])),G=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+2],[-1,1])),V=(0,m.squeeze)((0,m.slice)(T,[0,A.boxCoordOffset+3],[-1,1])),$=(0,m.add)((0,m.mul)((0,m.div)($,A.xScale),x.w),x.x),M=(0,m.add)((0,m.mul)((0,m.div)(M,A.yScale),x.h),x.y),V=(0,m.mul)((0,m.div)(V,A.hScale),x.h),G=(0,m.mul)((0,m.div)(G,A.wScale),x.h);for(var Q=(0,m.sub)(M,(0,m.div)(V,2)),nt=(0,m.sub)($,(0,m.div)(G,2)),it=(0,m.add)(M,(0,m.div)(V,2)),ht=(0,m.add)($,(0,m.div)(G,2)),kt=(0,m.concat)([(0,m.reshape)(Q,[A.numBoxes,1]),(0,m.reshape)(nt,[A.numBoxes,1]),(0,m.reshape)(it,[A.numBoxes,1]),(0,m.reshape)(ht,[A.numBoxes,1])],1),Nt=0;Nt<A.numKeypoints;++Nt){var $t=A.keypointCoordOffset+Nt*A.numValuesPerKeypoint,Ut=void 0,Pt=void 0;Ut=(0,m.squeeze)((0,m.slice)(T,[0,$t],[-1,1])),Pt=(0,m.squeeze)((0,m.slice)(T,[0,$t+1],[-1,1]));var re=(0,m.add)((0,m.mul)((0,m.div)(Ut,A.xScale),x.w),x.x),ue=(0,m.add)((0,m.mul)((0,m.div)(Pt,A.yScale),x.h),x.y);kt=(0,m.concat)([kt,(0,m.reshape)(re,[A.numBoxes,1]),(0,m.reshape)(ue,[A.numBoxes,1])],1)}return kt})}(c,i,o),y=(0,m.tidy)(function(){var T=u;return o.scoreClippingThresh!=null&&(T=(0,m.clipByValue)(u,-o.scoreClippingThresh,o.scoreClippingThresh)),T=(0,m.sigmoid)(T)}),[4,U6(f,y,o)];case 1:return w=C.sent(),(0,m.dispose)([f,y]),[2,w]}})})}function U6(l,i,o){return So(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M,$,V;return yo(this,function(G){switch(G.label){case 0:return u=[],[4,l.data()];case 1:return c=G.sent(),[4,i.data()];case 2:for(f=G.sent(),y=0;y<o.numBoxes;++y)if(!(f[y]<o.minScoreThresh||(w=y*o.numCoords,C=W6(c[w+0],c[w+1],c[w+2],c[w+3],f[y],o.flipVertically,y),(T=C.locationData.relativeBoundingBox).width<0||T.height<0))){for((x=C.locationData).relativeKeypoints=[],A=o.numKeypoints*o.numValuesPerKeypoint,M=0;M<A;M+=o.numValuesPerKeypoint)$=w+o.keypointCoordOffset+M,V={x:c[$+0],y:c[$+1]},x.relativeKeypoints.push(V);u.push(C)}return[2,u]}})})}function W6(l,i,o,u,c,f,y){return{score:[c],ind:y,locationData:{relativeBoundingBox:{xMin:i,yMin:f?1-o:l,xMax:u,yMax:f?1-l:o,width:u-i,height:o-l}}}}function D7(l,i){return l==="none"?i:function(o){return 1/(1+Math.exp(-o))}(i)}function jtt(l,i,o,u){return So(this,void 0,void 0,function(){var c,f,y,w,C,T,x,A;return yo(this,function(M){switch(M.label){case 0:return o=o||i.flipHorizontally||!1,u=u||i.flipVertically||!1,c=l.size,f=c/i.numLandmarks,[4,l.data()];case 1:for(y=M.sent(),w=[],C=0;C<i.numLandmarks;++C)T=C*f,(A={x:0,y:0}).x=o?i.inputImageWidth-y[T]:y[T],f>1&&(A.y=u?i.inputImageHeight-y[T+1]:y[T+1]),f>2&&(A.z=y[T+2]),f>3&&(A.score=D7(i.visibilityActivation,y[T+3])),w.push(A);for(x=0;x<w.length;++x)(A=w[x]).x=A.x/i.inputImageWidth,A.y=A.y/i.inputImageHeight,A.z=A.z/i.inputImageWidth/(i.normalizeZ||1);return[2,w]}})})}function Utt(l,i,o){var u=l.width,c=l.height,f=l.rotation;if(o.rotation==null&&o.rotationDegree==null||(f=function(T,x){return x.rotation!=null?T+=x.rotation:x.rotationDegree!=null&&(T+=Math.PI*x.rotationDegree/180),Ott(T)}(f,o)),f===0)l.xCenter=l.xCenter+u*o.shiftX,l.yCenter=l.yCenter+c*o.shiftY;else{var y=(i.width*u*o.shiftX*Math.cos(f)-i.height*c*o.shiftY*Math.sin(f))/i.width,w=(i.width*u*o.shiftX*Math.sin(f)+i.height*c*o.shiftY*Math.cos(f))/i.height;l.xCenter=l.xCenter+y,l.yCenter=l.yCenter+w}{var C=Math.max(u*i.width,c*i.height);u=C/i.width,c=C/i.height}return l.width=u*o.scaleX,l.height=c*o.scaleY,l}function $0t(l,i){return l.map(function(o){var u=Ts(Ts({},o),{x:o.x/i.width,y:o.y/i.height});return o.z!=null&&(o.z=o.z/i.width),u})}var iy=function(){function l(i){this.alpha=i,this.initialized=!1}return l.prototype.apply=function(i,o){var u;return this.initialized?u=o==null?this.storedValue+this.alpha*(i-this.storedValue):this.storedValue+this.alpha*o*Math.asinh((i-this.storedValue)/o):(u=i,this.initialized=!0),this.rawValue=i,this.storedValue=u,u},l.prototype.applyWithAlpha=function(i,o,u){return this.alpha=o,this.apply(i,u)},l.prototype.hasLastRawValue=function(){return this.initialized},l.prototype.lastRawValue=function(){return this.rawValue},l.prototype.reset=function(){this.initialized=!1},l}(),uB=function(){function l(i){this.frequency=i.frequency,this.minCutOff=i.minCutOff,this.beta=i.beta,this.thresholdCutOff=i.thresholdCutOff,this.thresholdBeta=i.thresholdBeta,this.derivateCutOff=i.derivateCutOff,this.x=new iy(this.getAlpha(this.minCutOff)),this.dx=new iy(this.getAlpha(this.derivateCutOff)),this.lastTimestamp=0}return l.prototype.apply=function(i,o,u){if(i==null)return i;var c=Math.trunc(o);if(this.lastTimestamp>=c)return i;this.lastTimestamp!==0&&c!==0&&(this.frequency=1/(1e-6*(c-this.lastTimestamp))),this.lastTimestamp=c;var f=this.x.hasLastRawValue()?(i-this.x.lastRawValue())*u*this.frequency:0,y=this.dx.applyWithAlpha(f,this.getAlpha(this.derivateCutOff)),w=this.minCutOff+this.beta*Math.abs(y),C=this.thresholdCutOff!=null?this.thresholdCutOff+this.thresholdBeta*Math.abs(y):null;return this.x.applyWithAlpha(i,this.getAlpha(w),C)},l.prototype.getAlpha=function(i){return 1/(1+this.frequency/(2*Math.PI*i))},l}(),lB=function(){function l(i){this.config=i}return l.prototype.apply=function(i,o,u){var c=this;if(i==null)return this.reset(),null;this.initializeFiltersIfEmpty(i);var f=1;if(!this.config.disableValueScaling){if(u<this.config.minAllowedObjectScale)return ry([],i,!0);f=1/u}return i.map(function(y,w){var C=Ts(Ts({},y),{x:c.xFilters[w].apply(y.x,o,f),y:c.yFilters[w].apply(y.y,o,f)});return y.z!=null&&(C.z=c.zFilters[w].apply(y.z,o,f)),C})},l.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},l.prototype.initializeFiltersIfEmpty=function(i){var o=this;this.xFilters!=null&&this.xFilters.length===i.length||(this.xFilters=i.map(function(u){return new uB(o.config)}),this.yFilters=i.map(function(u){return new uB(o.config)}),this.zFilters=i.map(function(u){return new uB(o.config)}))},l}(),cB=function(){function l(i){this.config=i,this.window=[],this.lowPassFilter=new iy(1),this.lastValue=0,this.lastValueScale=1,this.lastTimestamp=-1}return l.prototype.apply=function(i,o,u){if(i==null)return i;var c,f=Math.trunc(o);if(this.lastTimestamp>=f)return i;if(this.lastTimestamp===-1)c=1;else{for(var y=i*u-this.lastValue*this.lastValueScale,w=f-this.lastTimestamp,C=y,T=w,x=(1+this.window.length)*(1e6/30),A=0,M=this.window;A<M.length;A++){var $=M[A];if(T+$.duration>x)break;C+=$.distance,T+=$.duration}var V=C/(1e-6*T);c=1-1/(1+this.config.velocityScale*Math.abs(V)),this.window.unshift({distance:y,duration:w}),this.window.length>this.config.windowSize&&this.window.pop()}return this.lastValue=i,this.lastValueScale=u,this.lastTimestamp=f,this.lowPassFilter.applyWithAlpha(i,c)},l}(),hB=function(){function l(i){this.config=i}return l.prototype.apply=function(i,o,u){var c=this;if(i==null)return this.reset(),null;var f=1;if(!this.config.disableValueScaling){if(u<this.config.minAllowedObjectScale)return ry([],i,!0);f=1/u}return this.initializeFiltersIfEmpty(i),i.map(function(y,w){var C=Ts(Ts({},y),{x:c.xFilters[w].apply(y.x,o,f),y:c.yFilters[w].apply(y.y,o,f)});return y.z!=null&&(C.z=c.zFilters[w].apply(y.z,o,f)),C})},l.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},l.prototype.initializeFiltersIfEmpty=function(i){var o=this;this.xFilters!=null&&this.xFilters.length===i.length||(this.xFilters=i.map(function(u){return new cB(o.config)}),this.yFilters=i.map(function(u){return new cB(o.config)}),this.zFilters=i.map(function(u){return new cB(o.config)}))},l}(),ay=function(){function l(i){if(i.velocityFilter!=null)this.keypointsFilter=new hB(i.velocityFilter);else{if(i.oneEuroFilter==null)throw new Error("Either configure velocityFilter or oneEuroFilter, but got "+"".concat(i,"."));this.keypointsFilter=new lB(i.oneEuroFilter)}}return l.prototype.apply=function(i,o,u,c,f){if(c===void 0&&(c=!1),i==null)return this.keypointsFilter.reset(),null;var y=f!=null?function(T,x){return(T.width*x.width+T.height*x.height)/2}(f,u):1,w=c?B6(i,u):i,C=this.keypointsFilter.apply(w,o,y);return c?$0t(C,u):C},l}(),dB=function(){function l(i){this.alpha=i.alpha}return l.prototype.apply=function(i){var o=this;if(i==null)return this.visibilityFilters=null,null;this.visibilityFilters!=null&&this.visibilityFilters.length===i.length||(this.visibilityFilters=i.map(function(w){return new iy(o.alpha)}));for(var u=[],c=0;c<i.length;++c){var f=i[c],y=Ts({},f);y.score=this.visibilityFilters[c].apply(f.score),u.push(y)}return u},l}(),Wtt={interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:5,minScale:.1484375,maxScale:.75,inputSizeHeight:224,inputSizeWidth:224,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,32,32,32],aspectRatios:[1]},oy={runtime:"tfjs",modelType:"full",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/detector/1",landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"},Xd={maxPoses:1,flipHorizontal:!1},fB={flipVertically:!1,numBoxes:2254,numCoords:12,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:4,numValuesPerKeypoint:2,scoreClippingThresh:100,xScale:224,yScale:224,hScale:224,wScale:224,minScoreThresh:.5},R7={shiftX:0,shiftY:0,scaleX:1.25,scaleY:1.25},pB={outputTensorSize:{width:224,height:224},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},Vtt={outputTensorSize:{width:256,height:256},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},V6={numLandmarks:39,inputImageWidth:256,inputImageHeight:256,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},Zb={numLandmarks:39,inputImageWidth:1,inputImageHeight:1,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},z0t={kernelSize:7,minConfidenceToRefine:.5},G6={alpha:.1},F7={oneEuroFilter:{frequency:30,minCutOff:.05,beta:80,derivateCutOff:1,minAllowedObjectScale:1e-6}},O7={oneEuroFilter:{frequency:30,minCutOff:.01,beta:10,derivateCutOff:1,minAllowedObjectScale:1e-6}},Qb={oneEuroFilter:{frequency:30,minCutOff:.1,beta:40,derivateCutOff:1,minAllowedObjectScale:1e-6,disableValueScaling:!0}},mB={activation:"none"},L7={combineWithPreviousRatio:.7},gB=function(){function l(i){this.mask=i}return l.prototype.toCanvasImageSource=function(){return So(this,void 0,void 0,function(){return yo(this,function(i){return[2,Ftt(this.mask)]})})},l.prototype.toImageData=function(){return So(this,void 0,void 0,function(){return yo(this,function(i){return[2,I4(this.mask)]})})},l.prototype.toTensor=function(){return So(this,void 0,void 0,function(){return yo(this,function(i){return[2,this.mask]})})},l.prototype.getUnderlyingType=function(){return"tensor"},l}();function yB(l){return f1(l),"person"}var sy=function(){function l(i,o,u,c,f,y){this.detectorModel=i,this.landmarkModel=o,this.enableSmoothing=u,this.enableSegmentation=c,this.smoothSegmentation=f,this.modelType=y,this.regionOfInterest=null,this.prevFilteredSegmentationMask=null,this.anchors=function(A){A.reduceBoxesInLowestLayer==null&&(A.reduceBoxesInLowestLayer=!1),A.interpolatedScaleAspectRatio==null&&(A.interpolatedScaleAspectRatio=1);for(var M=[],$=0;$<A.numLayers;){for(var V=[],G=[],Q=[],nt=[],it=$;it<A.strides.length&&A.strides[it]===A.strides[$];){var ht=$tt(A.minScale,A.maxScale,it,A.strides.length);if(it===0&&A.reduceBoxesInLowestLayer)Q.push(1),Q.push(2),Q.push(.5),nt.push(.1),nt.push(ht),nt.push(ht);else{for(var kt=0;kt<A.aspectRatios.length;++kt)Q.push(A.aspectRatios[kt]),nt.push(ht);if(A.interpolatedScaleAspectRatio>0){var Nt=it===A.strides.length-1?1:$tt(A.minScale,A.maxScale,it+1,A.strides.length);nt.push(Math.sqrt(ht*Nt)),Q.push(A.interpolatedScaleAspectRatio)}}it++}for(var $t=0;$t<Q.length;++$t){var Ut=Math.sqrt(Q[$t]);V.push(nt[$t]/Ut),G.push(nt[$t]*Ut)}var Pt=0,re=0;if(A.featureMapHeight.length>0)Pt=A.featureMapHeight[$],re=A.featureMapWidth[$];else{var ue=A.strides[$];Pt=Math.ceil(A.inputSizeHeight/ue),re=Math.ceil(A.inputSizeWidth/ue)}for(var be=0;be<Pt;++be)for(var De=0;De<re;++De)for(var ze=0;ze<V.length;++ze){var Qe={xCenter:(De+A.anchorOffsetX)/re,yCenter:(be+A.anchorOffsetY)/Pt,width:0,height:0};Qe.width=1,Qe.height=1,M.push(Qe)}$=it}return M}(Wtt);var w=(0,m.tensor1d)(this.anchors.map(function(A){return A.width})),C=(0,m.tensor1d)(this.anchors.map(function(A){return A.height})),T=(0,m.tensor1d)(this.anchors.map(function(A){return A.xCenter})),x=(0,m.tensor1d)(this.anchors.map(function(A){return A.yCenter}));this.anchorTensor={x:T,y:x,w,h:C},this.prevFilteredSegmentationMask=this.enableSegmentation?(0,m.tensor2d)([],[0,0]):null}return l.prototype.estimatePoses=function(i,o,u){return So(this,void 0,void 0,function(){var c,f,y,w,C,T,x,A,M,$,V,G,Q,nt,it,ht,kt,Nt,$t,Ut,Pt,re,ue;return yo(this,function(be){switch(be.label){case 0:return c=function(De){var ze;if((ze=De==null?Xd:Ts({},De)).maxPoses==null&&(ze.maxPoses=1),ze.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(ze.maxPoses,". Should be > 0."));if(ze.maxPoses>1)throw new Error("Multi-pose detection is not implemented yet. Please set maxPoses to 1.");return ze}(o),i==null?(this.reset(),[2,[]]):(this.maxPoses=c.maxPoses,this.timestamp=u!=null?1e3*u:ztt(i)?1e6*i.currentTime:null,f=Kb(i),y=(0,m.tidy)(function(){return(0,m.cast)(qd(i),"float32")}),(w=this.regionOfInterest)!=null?[3,2]:[4,this.detectPose(y)]);case 1:if((C=be.sent()).length===0)return this.reset(),y.dispose(),[2,[]];T=C[0],w=this.poseDetectionToRoi(T,f),be.label=2;case 2:return[4,this.poseLandmarksByRoi(w,y)];case 3:return x=be.sent(),y.dispose(),x==null?(this.reset(),[2,[]]):(A=x.landmarks,M=x.auxiliaryLandmarks,$=x.poseScore,V=x.worldLandmarks,G=x.segmentationMask,Q=this.poseLandmarkFiltering(A,M,V,f),nt=Q.actualLandmarksFiltered,it=Q.auxiliaryLandmarksFiltered,ht=Q.actualWorldLandmarksFiltered,kt=this.poseLandmarksToRoi(it,f),this.regionOfInterest=kt,Nt=this.smoothSegmentation&&G!=null?this.poseSegmentationFiltering(G):G,($t=nt!=null?B6(nt,f):null)!=null&&$t.forEach(function(De,ze){De.name=Xb[ze]}),(Ut=ht)!=null&&Ut.forEach(function(De,ze){De.name=Xb[ze]}),Pt={score:$,keypoints:$t,keypoints3D:Ut},Nt!==null&&(re=(0,m.tidy)(function(){var De=(0,m.expandDims)(Nt,2),ze=(0,m.pad)(De,[[0,0],[0,0],[0,1]]);return(0,m.mirrorPad)(ze,[[0,0],[0,0],[0,2]],"symmetric")}),this.smoothSegmentation||(0,m.dispose)(Nt),ue={maskValueToLabel:yB,mask:new gB(re)},Pt.segmentation=ue),[2,[Pt]])}})})},l.prototype.poseSegmentationFiltering=function(i){var o=this.prevFilteredSegmentationMask;return o.size===0?this.prevFilteredSegmentationMask=i:(this.prevFilteredSegmentationMask=function(u,c,f){return(0,m.getBackend)()==="webgl"?function(y,w,C){var T=C.combineWithPreviousRatio.toFixed(2),x={variableNames:["prevMask","newMask"],outputShape:y.shape,userCode:`
  void main() {
      ivec2 coords = getOutputCoords();
      int height = coords[0];
      int width = coords[1];

      float prevMaskValue = getPrevMask(height, width);
      float newMaskValue = getNewMask(height, width);

      /*
      * Assume p := newMaskValue
      * H(p) := 1 + (p * log(p) + (1-p) * log(1-p)) / log(2)
      * uncertainty alpha(p) =
      *   Clamp(1 - (1 - H(p)) * (1 - H(p)), 0, 1) [squaring the
      * uncertainty]
      *
      * The following polynomial approximates uncertainty alpha as a
      * function of (p + 0.5):
      */
      const float c1 = 5.68842;
      const float c2 = -0.748699;
      const float c3 = -57.8051;
      const float c4 = 291.309;
      const float c5 = -624.717;
      float t = newMaskValue - 0.5;
      float x = t * t;

      float uncertainty =
        1.0 - min(1.0, x * (c1 + x * (c2 + x * (c3 + x * (c4 + x * c5)))));

      float outputValue = newMaskValue + (prevMaskValue - newMaskValue) *
                             (uncertainty * `.concat(T,`);

      setOutput(outputValue);
    }
`)},A=(0,m.backend)();return(0,m.tidy)(function(){var M=A.compileAndRun(x,[y,w]);return(0,m.engine)().makeTensorFromDataId(M.dataId,M.shape,M.dtype)})}(u,c,f):(0,m.tidy)(function(){var y=(0,m.sub)(c,.5),w=(0,m.square)(y),C=(0,m.sub)(1,(0,m.minimum)(1,(0,m.mul)(w,(0,m.add)(5.68842,(0,m.mul)(w,(0,m.add)(-.748699,(0,m.mul)(w,(0,m.add)(-57.8051,(0,m.mul)(w,(0,m.add)(291.309,(0,m.mul)(w,-624.717)))))))))));return(0,m.add)(c,(0,m.mul)((0,m.sub)(u,c),(0,m.mul)(C,f.combineWithPreviousRatio)))})}(o,i,L7),(0,m.dispose)(i)),(0,m.dispose)(o),this.prevFilteredSegmentationMask},l.prototype.dispose=function(){this.detectorModel.dispose(),this.landmarkModel.dispose(),(0,m.dispose)([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h,this.prevFilteredSegmentationMask])},l.prototype.reset=function(){this.regionOfInterest=null,this.enableSegmentation&&((0,m.dispose)(this.prevFilteredSegmentationMask),this.prevFilteredSegmentationMask=(0,m.tensor2d)([],[0,0])),this.visibilitySmoothingFilterActual=null,this.visibilitySmoothingFilterAuxiliary=null,this.landmarksSmoothingFilterActual=null,this.landmarksSmoothingFilterAuxiliary=null},l.prototype.detectPose=function(i){return So(this,void 0,void 0,function(){var o,u,c,f,y,w,C,T,x,A;return yo(this,function(M){switch(M.label){case 0:return o=oB(i,pB),u=o.imageTensor,c=o.padding,f=this.detectorModel.predict(u),y=function($){return(0,m.tidy)(function(){var V=function(nt){return(0,m.tidy)(function(){return[(0,m.slice)(nt,[0,0,0],[1,-1,1]),(0,m.slice)(nt,[0,0,1],[1,-1,-1])]})}($),G=V[0],Q=V[1];return{boxes:(0,m.squeeze)(Q),logits:(0,m.squeeze)(G)}})}(f),w=y.boxes,[4,j6([C=y.logits,w],this.anchorTensor,fB)];case 1:return(T=M.sent()).length===0?((0,m.dispose)([u,f,C,w]),[2,T]):[4,m1(T,this.maxPoses,.3)];case 2:return x=M.sent(),A=function($,V){$===void 0&&($=[]);for(var G=V.left,Q=V.top,nt=V.left+V.right,it=V.top+V.bottom,ht=0;ht<$.length;ht++){var kt=$[ht],Nt=kt.locationData.relativeBoundingBox,$t=(Nt.xMin-G)/(1-nt),Ut=(Nt.yMin-Q)/(1-it),Pt=Nt.width/(1-nt),re=Nt.height/(1-it);Nt.xMin=$t,Nt.yMin=Ut,Nt.width=Pt,Nt.height=re,Nt.xMax=$t+Pt,Nt.yMax=Ut+re;var ue=kt.locationData.relativeKeypoints;ue&&ue.forEach(function(be){var De=(be.x-G)/(1-nt),ze=(be.y-Q)/(1-it);be.x=De,be.y=ze})}return $}(x,c),(0,m.dispose)([u,f,C,w]),[2,A]}})})},l.prototype.poseDetectionToRoi=function(i,o){return Utt(I7(i,o,{rotationVectorEndKeypointIndex:1,rotationVectorStartKeypointIndex:0,rotationVectorTargetAngleDegree:90}),o,R7)},l.prototype.poseLandmarksByRoi=function(i,o){return So(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M,$,V,G,Q;return yo(this,function(nt){switch(nt.label){case 0:if(u=Kb(o),c=oB(o,Vtt,i),f=c.imageTensor,y=c.padding,w=c.transformationMatrix,this.modelType!=="lite"&&this.modelType!=="full"&&this.modelType!=="heavy")throw new Error("Model type must be one of lite, full or heavy,"+"but got ".concat(this.modelType));return C=["ld_3d","output_poseflag","activation_heatmap","world_3d"],this.enableSegmentation&&C.push("activation_segmentation"),T=this.landmarkModel.execute(f,C),[4,this.tensorsToPoseLandmarksAndSegmentation(T)];case 1:return(x=nt.sent())==null?((0,m.dispose)(T),(0,m.dispose)(f),[2,null]):(A=x.landmarks,M=x.auxiliaryLandmarks,$=x.poseScore,V=x.worldLandmarks,G=x.segmentationMask,[4,this.poseLandmarksAndSegmentationInverseProjection(u,i,y,w,A,M,V,G)]);case 2:return Q=nt.sent(),(0,m.dispose)(T),(0,m.dispose)(f),[2,Ts({poseScore:$},Q)]}})})},l.prototype.poseLandmarksAndSegmentationInverseProjection=function(i,o,u,c,f,y,w,C){return So(this,void 0,void 0,function(){var T,x,A,M,$,V;return yo(this,function(G){return T=sB(f,u),x=sB(y,u),A=M7(T,o),M=M7(x,o),$=function(Q,nt){for(var it=[],ht=0,kt=Q;ht<kt.length;ht++){var Nt=kt[ht],$t=Nt.x,Ut=Nt.y,Pt=nt.rotation,re=Math.cos(Pt)*$t-Math.sin(Pt)*Ut,ue=Math.sin(Pt)*$t+Math.cos(Pt)*Ut,be=Ts({},Nt);be.x=re,be.y=ue,it.push(be)}return it}(w,o),V=null,this.enableSegmentation&&(V=(0,m.tidy)(function(){var Q=C.shape,nt=Q[0],it=Q[1],ht=function($t){var Ut=aB(new Array(16).fill(0));Ut[0][0]=Jc($t,0,0),Ut[1][0]=-Jc($t,0,1),Ut[2][0]=Jc($t,0,2),Ut[3][0]=-Jc($t,0,3),Ut[0][2]=Jc($t,2,0),Ut[1][2]=-Jc($t,2,1),Ut[2][2]=Jc($t,2,2),Ut[3][2]=-Jc($t,2,3),Ut[0][1]=-Jc($t,1,0),Ut[1][1]=Jc($t,1,1),Ut[2][1]=-Jc($t,1,2),Ut[3][1]=Jc($t,1,3),Ut[0][3]=-Jc($t,3,0),Ut[1][3]=Jc($t,3,1),Ut[2][3]=-Jc($t,3,2),Ut[3][3]=Jc($t,3,3);for(var Pt=$t[0][0]*Ut[0][0]+$t[1][0]*Ut[0][1]+$t[2][0]*Ut[0][2]+$t[3][0]*Ut[0][3],re=0;re<Ut.length;re++)for(var ue=0;ue<Ut.length;ue++)Ut[re][ue]/=Pt;return Ut}(c),kt=(0,m.tensor2d)(Ltt(ht,{width:it,height:nt},i),[1,8]),Nt=[1,nt,it,1];return(0,m.squeeze)(m.image.transform((0,m.reshape)(C,Nt),kt,"bilinear","constant",0,[i.height,i.width]),[0,3])}),(0,m.dispose)(C)),[2,{landmarks:A,auxiliaryLandmarks:M,worldLandmarks:$,segmentationMask:V}]})})},l.prototype.tensorsToPoseLandmarksAndSegmentation=function(i){return So(this,void 0,void 0,function(){var o,u,c,f,y,w,C,T,x,A,M,$,V;return yo(this,function(G){switch(G.label){case 0:return o=i[0],u=i[1],c=i[2],f=i[3],y=this.enableSegmentation?i[4]:null,[4,u.data()];case 1:return(w=G.sent()[0])<.5?[2,null]:[4,jtt(o,V6)];case 2:return[4,Btt(G.sent(),c,z0t)];case 3:return C=G.sent(),T=C.slice(0,33),x=C.slice(33,35),[4,jtt(f,Zb)];case 4:return A=G.sent(),M=A.slice(0,33),$=function(Q,nt,it){for(var ht=[],kt=0;kt<Q.length;kt++){var Nt=Ts({},nt[kt]);Nt.score=Q[kt].score,ht.push(Nt)}return ht}(T,M),V=this.enableSegmentation?function(Q,nt){return(0,m.tidy)(function(){var it=(0,m.squeeze)(Q,[0]),ht=it.shape[2];if(ht===1){var kt=it;switch(nt.activation){case"none":break;case"sigmoid":kt=(0,m.sigmoid)(kt);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported (".concat(nt.activation,")"))}var Nt=kt;return(0,m.squeeze)(Nt,[2])}throw new Error("Unsupported number of tensor channels ".concat(ht))})}(y,mB):null,[2,{landmarks:T,auxiliaryLandmarks:x,poseScore:w,worldLandmarks:$,segmentationMask:V}]}})})},l.prototype.poseLandmarksToRoi=function(i,o){return Utt(I7(Ptt(i),o,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:90}),o,R7)},l.prototype.poseLandmarkFiltering=function(i,o,u,c){var f,y,w;if(this.timestamp!=null&&this.enableSmoothing){var C=I7(Ptt(o),c,{rotationVectorEndKeypointIndex:0,rotationVectorStartKeypointIndex:1,rotationVectorTargetAngleDegree:90});this.visibilitySmoothingFilterActual==null&&(this.visibilitySmoothingFilterActual=new dB(G6)),f=this.visibilitySmoothingFilterActual.apply(i),this.visibilitySmoothingFilterAuxiliary==null&&(this.visibilitySmoothingFilterAuxiliary=new dB(G6)),y=this.visibilitySmoothingFilterAuxiliary.apply(o),w=this.visibilitySmoothingFilterActual.apply(u),this.landmarksSmoothingFilterActual==null&&(this.landmarksSmoothingFilterActual=new ay(F7)),f=this.landmarksSmoothingFilterActual.apply(f,this.timestamp,c,!0,C),this.landmarksSmoothingFilterAuxiliary==null&&(this.landmarksSmoothingFilterAuxiliary=new ay(O7)),y=this.landmarksSmoothingFilterAuxiliary.apply(y,this.timestamp,c,!0,C),this.worldLandmarksSmoothingFilterActual==null&&(this.worldLandmarksSmoothingFilterActual=new ay(Qb)),w=this.worldLandmarksSmoothingFilterActual.apply(u,this.timestamp)}else f=i,y=o,w=u;return{actualLandmarksFiltered:f,auxiliaryLandmarksFiltered:y,actualWorldLandmarksFiltered:w}},l}();function $7(l){return So(this,void 0,void 0,function(){var i,o,u,c,f,y;return yo(this,function(w){switch(w.label){case 0:return i=function(C){var T=Ts({},C??oy);if(T.enableSmoothing==null&&(T.enableSmoothing=oy.enableSmoothing),T.enableSegmentation==null&&(T.enableSegmentation=oy.enableSegmentation),T.smoothSegmentation==null&&(T.smoothSegmentation=oy.smoothSegmentation),T.modelType==null&&(T.modelType=oy.modelType),T.detectorModelUrl==null&&(T.detectorModelUrl=oy.detectorModelUrl),T.landmarkModelUrl==null)switch(T.modelType){case"lite":T.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/lite/2";break;case"heavy":T.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/heavy/2";break;default:T.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"}return T}(l),o=typeof i.detectorModelUrl=="string"&&i.detectorModelUrl.indexOf("https://tfhub.dev")>-1,u=typeof i.landmarkModelUrl=="string"&&i.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Promise.all([Vc(i.detectorModelUrl,{fromTFHub:o}),Vc(i.landmarkModelUrl,{fromTFHub:u})])];case 1:return c=w.sent(),f=c[0],y=c[1],[2,new sy(f,y,i.enableSmoothing,i.enableSegmentation,i.smoothSegmentation,i.modelType)]}})})}var uy,Rl,ly=function(){function l(i){(function(o){if(o.maxTracks<1)throw new Error("Must specify 'maxTracks' to be at least 1, but "+"encountered ".concat(o.maxTracks));if(o.maxAge<=0)throw new Error("Must specify 'maxAge' to be positive, but "+"encountered ".concat(o.maxAge));if(o.keypointTrackerParams!==void 0){if(o.keypointTrackerParams.keypointConfidenceThreshold<0||o.keypointTrackerParams.keypointConfidenceThreshold>1)throw new Error("Must specify 'keypointConfidenceThreshold' to be in the range [0, 1], but encountered "+"".concat(o.keypointTrackerParams.keypointConfidenceThreshold));if(o.keypointTrackerParams.minNumberOfKeypoints<1)throw new Error("Must specify 'minNumberOfKeypoints' to be at least 1, but "+"encountered ".concat(o.keypointTrackerParams.minNumberOfKeypoints));for(var u=0,c=o.keypointTrackerParams.keypointFalloff;u<c.length;u++){var f=c[u];if(f<=0)throw new Error("Must specify each keypoint falloff parameterto be positive "+"but encountered ".concat(f))}}})(i),this.tracks=[],this.maxTracks=i.maxTracks,this.maxAge=1e3*i.maxAge,this.minSimilarity=i.minSimilarity,this.nextID=1}return l.prototype.apply=function(i,o){this.filterOldTracks(o);var u=this.computeSimilarity(i);return this.assignTracks(i,u,o),this.updateTracks(o),i},l.prototype.getTracks=function(){return this.tracks.slice()},l.prototype.getTrackIDs=function(){return new Set(this.tracks.map(function(i){return i.id}))},l.prototype.filterOldTracks=function(i){var o=this;this.tracks=this.tracks.filter(function(u){return i-u.lastTimestamp<=o.maxAge})},l.prototype.assignTracks=function(i,o,u){for(var c=Array.from(Array(o[0].length).keys()),f=[],y=0,w=Array.from(Array(i.length).keys());y<w.length;y++){var C=w[y];if(c.length!==0){for(var T=-1,x=-1,A=0,M=c;A<M.length;A++){var $=M[A],V=o[C][$];V>=this.minSimilarity&&V>x&&(T=$,x=V)}if(T>=0){var G=this.tracks[T];G=Object.assign(G,this.createTrack(i[C],u,G.id)),i[C].id=G.id;var Q=c.indexOf(T);c.splice(Q,1)}else f.push(C)}else f.push(C)}for(var nt=0,it=f;nt<it.length;nt++){C=it[nt];var ht=this.createTrack(i[C],u);this.tracks.push(ht),i[C].id=ht.id}},l.prototype.updateTracks=function(i){this.tracks.sort(function(o,u){return u.lastTimestamp-o.lastTimestamp}),this.tracks=this.tracks.slice(0,this.maxTracks)},l.prototype.createTrack=function(i,o,u){var c={id:u||this.nextTrackID(),lastTimestamp:o,keypoints:ry([],i.keypoints,!0).map(function(f){return Ts({},f)})};return i.box!==void 0&&(c.box=Ts({},i.box)),c},l.prototype.nextTrackID=function(){var i=this.nextID;return this.nextID+=1,i},l.prototype.remove=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];this.tracks=this.tracks.filter(function(u){return!i.includes(u.id)})},l.prototype.reset=function(){this.tracks=[]},l}(),Jb=function(l){function i(o){return l.call(this,o)||this}return Mtt(i,l),i.prototype.computeSimilarity=function(o){var u=this;return o.length===0||this.tracks.length===0?[[]]:o.map(function(c){return u.tracks.map(function(f){return u.iou(c,f)})})},i.prototype.iou=function(o,u){var c=Math.max(o.box.xMin,u.box.xMin),f=Math.max(o.box.yMin,u.box.yMin),y=Math.min(o.box.xMax,u.box.xMax),w=Math.min(o.box.yMax,u.box.yMax);if(c>=y||f>=w)return 0;var C=(y-c)*(w-f);return C/(o.box.width*o.box.height+u.box.width*u.box.height-C)},i}(ly),vB=function(l){function i(o){var u=l.call(this,o)||this;return u.keypointThreshold=o.keypointTrackerParams.keypointConfidenceThreshold,u.keypointFalloff=o.keypointTrackerParams.keypointFalloff,u.minNumKeyoints=o.keypointTrackerParams.minNumberOfKeypoints,u}return Mtt(i,l),i.prototype.computeSimilarity=function(o){if(o.length===0||this.tracks.length===0)return[[]];for(var u=[],c=0,f=o;c<f.length;c++){for(var y=f[c],w=[],C=0,T=this.tracks;C<T.length;C++){var x=T[C];w.push(this.oks(y,x))}u.push(w)}return u},i.prototype.oks=function(o,u){for(var c=this.area(u.keypoints)+1e-6,f=0,y=0,w=0;w<o.keypoints.length;++w){var C=o.keypoints[w],T=u.keypoints[w];if(!(C.score<this.keypointThreshold||T.score<this.keypointThreshold)){y+=1;var x=Math.pow(C.x-T.x,2)+Math.pow(C.y-T.y,2),A=2*this.keypointFalloff[w];f+=Math.exp(-1*x/(2*c*Math.pow(A,2)))}}return y<this.minNumKeyoints?0:f/y},i.prototype.area=function(o){var u=this,c=o.filter(function(C){return C.score>u.keypointThreshold}),f=Math.min.apply(Math,ry([1],c.map(function(C){return C.x}),!1)),y=Math.max.apply(Math,ry([0],c.map(function(C){return C.x}),!1)),w=Math.min.apply(Math,ry([1],c.map(function(C){return C.y}),!1));return(y-f)*(Math.max.apply(Math,ry([0],c.map(function(C){return C.y}),!1))-w)},i}(ly);function z7(l){switch(l){case Rl.BlazePose:return Xb.reduce(function(i,o,u){return i[o]=u,i},{});case Rl.PoseNet:case Rl.MoveNet:return Af.reduce(function(i,o,u){return i[o]=u,i},{});default:throw new Error("Model ".concat(l," is not supported."))}}(function(l){l.Keypoint="keypoint",l.BoundingBox="boundingBox"})(uy||(uy={})),function(l){l.MoveNet="MoveNet",l.BlazePose="BlazePose",l.PoseNet="PoseNet"}(Rl||(Rl={}));var D4=Object.freeze({__proto__:null,getKeypointIndexBySide:function(l){switch(l){case Rl.BlazePose:return Dtt;case Rl.PoseNet:case Rl.MoveNet:return Ym;default:throw new Error("Model ".concat(l," is not supported."))}},getAdjacentPairs:function(l){switch(l){case Rl.BlazePose:return Rtt;case Rl.PoseNet:case Rl.MoveNet:return L0t;default:throw new Error("Model ".concat(l," is not supported."))}},getKeypointIndexByName:z7}),Gtt=["SinglePose.Lightning","SinglePose.Thunder","MultiPose.Lightning"],bB={modelType:"SinglePose.Lightning",enableSmoothing:!0},wB={},xB={frequency:30,minCutOff:2.5,beta:300,derivateCutOff:2.5,thresholdCutOff:.5,thresholdBeta:5,disableValueScaling:!0},Xm={maxTracks:18,maxAge:1e3,minSimilarity:.2,keypointTrackerParams:{keypointConfidenceThreshold:.3,keypointFalloff:[.026,.025,.025,.035,.035,.079,.079,.072,.072,.062,.062,.107,.107,.087,.087,.089,.089],minNumberOfKeypoints:4}},P7={maxTracks:18,maxAge:1e3,minSimilarity:.15,trackerParams:{}};function H6(l,i){var o,u,c,f;return l?i.width>i.height?(o=1,u=i.height/i.width,c=0,f=(i.width/2-i.height/2)/i.width):(o=i.width/i.height,u=1,c=(i.height/2-i.width/2)/i.height,f=0):i.width>i.height?(o=i.width/i.height,u=1,c=(i.height/2-i.width/2)/i.height,f=0):(o=1,u=i.height/i.width,c=0,f=(i.width/2-i.height/2)/i.width),{yMin:c,xMin:f,yMax:c+o,xMax:f+u,height:o,width:u}}function B7(l,i){var o={maxTracks:l.maxTracks,maxAge:l.maxAge,minSimilarity:l.minSimilarity};return i.maxTracks!=null&&(o.maxTracks=i.maxTracks),i.maxAge!=null&&(o.maxAge=i.maxAge),i.minSimilarity!=null&&(o.minSimilarity=i.minSimilarity),o}var Htt=function(){function l(i,o){this.moveNetModel=i,this.modelInputResolution={height:0,width:0},this.keypointIndexByName=z7(Rl.MoveNet),o.modelType==="SinglePose.Lightning"?(this.modelInputResolution.width=192,this.modelInputResolution.height=192):o.modelType==="SinglePose.Thunder"&&(this.modelInputResolution.width=256,this.modelInputResolution.height=256),this.multiPoseModel=o.modelType==="MultiPose.Lightning",this.multiPoseModel||(this.keypointFilter=new lB(xB),this.cropRegionFilterYMin=new iy(.9),this.cropRegionFilterXMin=new iy(.9),this.cropRegionFilterYMax=new iy(.9),this.cropRegionFilterXMax=new iy(.9)),this.enableSmoothing=o.enableSmoothing,o.minPoseScore?this.minPoseScore=o.minPoseScore:this.minPoseScore=.25,o.multiPoseMaxDimension?this.multiPoseMaxDimension=o.multiPoseMaxDimension:this.multiPoseMaxDimension=256,this.enableTracking=o.enableTracking,this.multiPoseModel&&this.enableTracking&&(o.trackerType===uy.Keypoint?this.tracker=new vB(o.trackerConfig):o.trackerType===uy.BoundingBox&&(this.tracker=new Jb(o.trackerConfig)),this.enableSmoothing&&(this.keypointFilterMap=new Map))}return l.prototype.runSinglePersonPoseModel=function(i){return So(this,void 0,void 0,function(){var o,u,c,f,y;return yo(this,function(w){switch(w.label){case 0:if((o=this.moveNetModel.execute(i)).shape.length!==4||o.shape[0]!==1||o.shape[1]!==1||o.shape[2]!==17||o.shape[3]!==3)throw o.dispose(),new Error("Unexpected output shape from model: [".concat(o.shape,"]"));return(0,m.getBackend)()==="webgpu"?[3,1]:(u=o.dataSync(),[3,3]);case 1:return[4,o.data()];case 2:u=w.sent(),w.label=3;case 3:for(o.dispose(),c={keypoints:[],score:0},f=0,y=0;y<17;++y)c.keypoints[y]={y:u[3*y],x:u[3*y+1],score:u[3*y+2]},c.keypoints[y].score>.2&&(++f,c.score+=c.keypoints[y].score);return f>0&&(c.score/=f),[2,c]}})})},l.prototype.runMultiPersonPoseModel=function(i){return So(this,void 0,void 0,function(){var o,u,c,f,y,w,C,T;return yo(this,function(x){switch(x.label){case 0:if((o=this.moveNetModel.execute(i)).shape.length!==3||o.shape[0]!==1||o.shape[2]!==56)throw o.dispose(),new Error("Unexpected output shape from model: [".concat(o.shape,"]"));return(0,m.getBackend)()==="webgpu"?[3,1]:(u=o.dataSync(),[3,3]);case 1:return[4,o.data()];case 2:u=x.sent(),x.label=3;case 3:for(o.dispose(),c=[],f=u.length/56,y=0;y<f;++y)for(c[y]={keypoints:[]},w=56*y+51,c[y].box={yMin:u[w],xMin:u[w+1],yMax:u[w+2],xMax:u[w+3],width:u[w+3]-u[w+1],height:u[w+2]-u[w]},C=56*y+55,c[y].score=u[C],c[y].keypoints=[],T=0;T<17;++T)c[y].keypoints[T]={y:u[56*y+3*T],x:u[56*y+3*T+1],score:u[56*y+3*T+2]};return[2,c]}})})},l.prototype.estimatePoses=function(i,o,u){return o===void 0&&(o=wB),So(this,void 0,void 0,function(){var c,f,y,w,C,T;return yo(this,function(x){switch(x.label){case 0:return o=function(A){return A==null?wB:Ts({},A)}(o),i==null?(this.reset(),[2,[]]):(u==null?ztt(i)&&(u=1e6*i.currentTime):u*=1e3,c=qd(i),f=Kb(c),y=(0,m.expandDims)(c,0),i instanceof m.Tensor||c.dispose(),w=[],this.multiPoseModel?[3,2]:[4,this.estimateSinglePose(y,f,u)]);case 1:return w=x.sent(),[3,4];case 2:return[4,this.estimateMultiplePoses(y,f,u)];case 3:w=x.sent(),x.label=4;case 4:for(C=0;C<w.length;++C)for(T=0;T<w[C].keypoints.length;++T)w[C].keypoints[T].name=Af[T],w[C].keypoints[T].y*=f.height,w[C].keypoints[T].x*=f.width;return[2,w]}})})},l.prototype.estimateSinglePose=function(i,o,u){return So(this,void 0,void 0,function(){var c,f,y,w,C=this;return yo(this,function(T){switch(T.label){case 0:return this.cropRegion||(this.cropRegion=H6(this.cropRegion==null,o)),c=(0,m.tidy)(function(){var x=(0,m.tensor2d)([[C.cropRegion.yMin,C.cropRegion.xMin,C.cropRegion.yMax,C.cropRegion.xMax]]),A=(0,m.zeros)([1],"int32"),M=[C.modelInputResolution.height,C.modelInputResolution.width];return(0,m.cast)(m.image.cropAndResize(i,x,A,M,"bilinear",0),"int32")}),i.dispose(),[4,this.runSinglePersonPoseModel(c)];case 1:if(f=T.sent(),c.dispose(),f.score<this.minPoseScore)return this.reset(),[2,[]];for(y=0;y<f.keypoints.length;++y)f.keypoints[y].y=this.cropRegion.yMin+f.keypoints[y].y*this.cropRegion.height,f.keypoints[y].x=this.cropRegion.xMin+f.keypoints[y].x*this.cropRegion.width;return u!=null&&this.enableSmoothing&&(f.keypoints=this.keypointFilter.apply(f.keypoints,u,1)),w=function(x,A,M,$){for(var V={},G=0,Q=Af;G<Q.length;G++){var nt=Q[G];V[nt]=[A[M[nt]].y*$.height,A[M[nt]].x*$.width]}if(function(De,ze){return(De[ze.left_hip].score>.2||De[ze.right_hip].score>.2)&&(De[ze.left_shoulder].score>.2||De[ze.right_shoulder].score>.2)}(A,M)){var it=(V.left_hip[0]+V.right_hip[0])/2,ht=(V.left_hip[1]+V.right_hip[1])/2,kt=function(De,ze,Qe,cn,en){for(var sn=["left_shoulder","right_shoulder","left_hip","right_hip"],xn=0,Rn=0,Bn=0;Bn<sn.length;Bn++)(Tr=Math.abs(cn-Qe[sn[Bn]][0]))>xn&&(xn=Tr),(Ar=Math.abs(en-Qe[sn[Bn]][1]))>Rn&&(Rn=Ar);for(var Fn=0,Xn=0,Nn=0,kr=Object.keys(Qe);Nn<kr.length;Nn++){var Tr,Ar,Dr=kr[Nn];De[ze[Dr]].score<.2||((Tr=Math.abs(cn-Qe[Dr][0]))>Fn&&(Fn=Tr),(Ar=Math.abs(en-Qe[Dr][1]))>Xn&&(Xn=Ar))}return[xn,Rn,Fn,Xn]}(A,M,V,it,ht),Nt=kt[0],$t=kt[1],Ut=kt[2],Pt=kt[3],re=Math.max(1.9*$t,1.9*Nt,1.2*Ut,1.2*Pt),ue=[it-(re=Math.min(re,Math.max(ht,$.width-ht,it,$.height-it))),ht-re];if(re>Math.max($.width,$.height)/2)return H6(x==null,$);var be=2*re;return{yMin:ue[0]/$.height,xMin:ue[1]/$.width,yMax:(ue[0]+be)/$.height,xMax:(ue[1]+be)/$.width,height:(ue[0]+be)/$.height-ue[0]/$.height,width:(ue[1]+be)/$.width-ue[1]/$.width}}return H6(x==null,$)}(this.cropRegion,f.keypoints,this.keypointIndexByName,o),this.cropRegion=this.filterCropRegion(w),[2,[f]]}})})},l.prototype.estimateMultiplePoses=function(i,o,u){return So(this,void 0,void 0,function(){var c,f,y,w,C,T,x,A,M,$,V,G=this;return yo(this,function(Q){switch(Q.label){case 0:return o.width>o.height?(f=this.multiPoseMaxDimension,y=Math.round(this.multiPoseMaxDimension*o.height/o.width),c=m.image.resizeBilinear(i,[y,f]),C=f,T=32*Math.ceil(y/32),w=(0,m.pad)(c,[[0,0],[0,T-y],[0,0],[0,0]])):(f=Math.round(this.multiPoseMaxDimension*o.width/o.height),y=this.multiPoseMaxDimension,c=m.image.resizeBilinear(i,[y,f]),C=32*Math.ceil(f/32),T=y,w=(0,m.pad)(c,[[0,0],[0,0],[0,C-f],[0,0]])),c.dispose(),i.dispose(),x=(0,m.cast)(w,"int32"),w.dispose(),[4,this.runMultiPersonPoseModel(x)];case 1:for(A=Q.sent(),x.dispose(),A=A.filter(function(nt){return nt.score>=G.minPoseScore}),$=0;$<A.length;++$)for(M=0;M<A[$].keypoints.length;++M)A[$].keypoints[M].y*=T/y,A[$].keypoints[M].x*=C/f;if(this.enableTracking&&(this.tracker.apply(A,u),this.enableSmoothing)){for($=0;$<A.length;++$)this.keypointFilterMap.has(A[$].id)||this.keypointFilterMap.set(A[$].id,new lB(xB)),A[$].keypoints=this.keypointFilterMap.get(A[$].id).apply(A[$].keypoints,u,1);V=this.tracker.getTrackIDs(),this.keypointFilterMap.forEach(function(nt,it){V.has(it)||G.keypointFilterMap.delete(it)})}return[2,A]}})})},l.prototype.filterCropRegion=function(i){if(i){var o=this.cropRegionFilterYMin.apply(i.yMin),u=this.cropRegionFilterXMin.apply(i.xMin),c=this.cropRegionFilterYMax.apply(i.yMax),f=this.cropRegionFilterXMax.apply(i.xMax);return{yMin:o,xMin:u,yMax:c,xMax:f,height:c-o,width:f-u}}return this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset(),null},l.prototype.dispose=function(){this.moveNetModel.dispose()},l.prototype.reset=function(){this.cropRegion=null,this.resetFilters()},l.prototype.resetFilters=function(){this.keypointFilter.reset(),this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset()},l}();function Ytt(l){return l===void 0&&(l=bB),So(this,void 0,void 0,function(){var i,o,u,c;return yo(this,function(f){switch(f.label){case 0:return i=function(y){var w,C=y==null?bB:Ts({},y);if(C.modelType==null)C.modelType="SinglePose.Lightning";else if(Gtt.indexOf(C.modelType)<0)throw new Error("Invalid architecture ".concat(C.modelType,". ")+"Should be one of ".concat(Gtt));if(C.enableSmoothing==null&&(C.enableSmoothing=!0),C.minPoseScore!=null&&(C.minPoseScore<0||C.minPoseScore>1))throw new Error("minPoseScore should be between 0.0 and 1.0");if(C.multiPoseMaxDimension!=null&&(C.multiPoseMaxDimension%32!=0||C.multiPoseMaxDimension<32))throw new Error("multiPoseMaxDimension must be a multiple of 32 and higher than 0");if(C.modelType==="MultiPose.Lightning"&&C.enableTracking==null&&(C.enableTracking=!0),C.modelType==="MultiPose.Lightning"&&C.enableTracking===!0)if(C.trackerType==null&&(C.trackerType=uy.BoundingBox),C.trackerType===uy.Keypoint)C.trackerConfig!=null?C.trackerConfig=function(T){var x=B7(Xm,T);return x.keypointTrackerParams=Ts({},Xm.keypointTrackerParams),T.keypointTrackerParams!=null&&(T.keypointTrackerParams.keypointConfidenceThreshold!=null&&(x.keypointTrackerParams.keypointConfidenceThreshold=T.keypointTrackerParams.keypointConfidenceThreshold),T.keypointTrackerParams.keypointFalloff!=null&&(x.keypointTrackerParams.keypointFalloff=T.keypointTrackerParams.keypointFalloff),T.keypointTrackerParams.minNumberOfKeypoints!=null&&(x.keypointTrackerParams.minNumberOfKeypoints=T.keypointTrackerParams.minNumberOfKeypoints)),x}(C.trackerConfig):C.trackerConfig=Xm;else{if(C.trackerType!==uy.BoundingBox)throw new Error("Tracker type not supported by MoveNet");C.trackerConfig!=null?C.trackerConfig=(w=C.trackerConfig,B7(P7,w)):C.trackerConfig=P7}return C}(l),u=!0,i.modelUrl?(u=typeof i.modelUrl=="string"&&i.modelUrl.indexOf("https://tfhub.dev")>-1,[4,Vc(i.modelUrl,{fromTFHub:u})]):[3,2];case 1:return o=f.sent(),[3,4];case 2:return c=void 0,i.modelType==="SinglePose.Lightning"?c="https://tfhub.dev/google/tfjs-model/movenet/singlepose/lightning/4":i.modelType==="SinglePose.Thunder"?c="https://tfhub.dev/google/tfjs-model/movenet/singlepose/thunder/4":i.modelType==="MultiPose.Lightning"&&(c="https://tfhub.dev/google/tfjs-model/movenet/multipose/lightning/1"),[4,Vc(c,{fromTFHub:u})];case 3:o=f.sent(),f.label=4;case 4:return(0,m.getBackend)()==="webgl"&&(0,m.env)().set("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",0),[2,new Htt(o,i)]}})})}var t3={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:{height:257,width:257}},e3=["MobileNetV1","ResNet50"],Dp={MobileNetV1:[8,16],ResNet50:[16]},qtt=[8,16,32],kB={MobileNetV1:[.5,.75,1],ResNet50:[1]},Y6=[1,2,4],Xtt={maxPoses:1,flipHorizontal:!1},R4={maxPoses:5,flipHorizontal:!1,scoreThreshold:.5,nmsRadius:20},P0t=[-123.15,-115.9,-103.06];function q6(l){return Math.floor(l/2)}var P0=function(){function l(i,o){this.priorityQueue=new Array(i),this.numberOfElements=-1,this.getElementValue=o}return l.prototype.enqueue=function(i){this.priorityQueue[++this.numberOfElements]=i,this.swim(this.numberOfElements)},l.prototype.dequeue=function(){var i=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,i},l.prototype.empty=function(){return this.numberOfElements===-1},l.prototype.size=function(){return this.numberOfElements+1},l.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},l.prototype.max=function(){return this.priorityQueue[0]},l.prototype.swim=function(i){for(;i>0&&this.less(q6(i),i);)this.exchange(i,q6(i)),i=q6(i)},l.prototype.sink=function(i){for(;2*i<=this.numberOfElements;){var o=2*i;if(o<this.numberOfElements&&this.less(o,o+1)&&o++,!this.less(i,o))break;this.exchange(i,o),i=o}},l.prototype.getValueAt=function(i){return this.getElementValue(this.priorityQueue[i])},l.prototype.less=function(i,o){return this.getValueAt(i)<this.getValueAt(o)},l.prototype.exchange=function(i,o){var u=this.priorityQueue[i];this.priorityQueue[i]=this.priorityQueue[o],this.priorityQueue[o]=u},l}();function j7(l,i,o,u,c,f){for(var y=f.shape,w=y[0],C=y[1],T=!0,x=Math.max(o-c,0),A=Math.min(o+c+1,w),M=x;M<A;++M){for(var $=Math.max(u-c,0),V=Math.min(u+c+1,C),G=$;G<V;++G)if(f.get(M,G,l)>i){T=!1;break}if(!T)break}return T}function SB(l){return So(this,void 0,void 0,function(){return yo(this,function(i){return[2,Promise.all(l.map(function(o){return o.buffer()}))]})})}function Ktt(l,i,o,u){return{y:u.get(l,i,o),x:u.get(l,i,o+17)}}function _B(l,i,o){var u=Ktt(l.heatmapY,l.heatmapX,l.id,o),c=u.y,f=u.x;return{x:l.heatmapX*i+f,y:l.heatmapY*i+c}}function X6(l,i,o,u){var c=o.x,f=o.y;return l.some(function(y){var w,C,T,x,A=y.keypoints;return w=f,C=c,(T=A[u].y-w)*T+(x=A[u].x-C)*x<=i})}var F4=Af.reduce(function(l,i,o){return l[i]=o,l},{}),U7=[["nose","left_eye"],["left_eye","left_ear"],["nose","right_eye"],["right_eye","right_ear"],["nose","left_shoulder"],["left_shoulder","left_elbow"],["left_elbow","left_wrist"],["left_shoulder","left_hip"],["left_hip","left_knee"],["left_knee","left_ankle"],["nose","right_shoulder"],["right_shoulder","right_elbow"],["right_elbow","right_wrist"],["right_shoulder","right_hip"],["right_hip","right_knee"],["right_knee","right_ankle"]].map(function(l){var i=l[0],o=l[1];return[F4[i],F4[o]]}),g1=U7.map(function(l){return l[1]}),W7=U7.map(function(l){return l[0]});function CB(l,i,o){return l<i?i:l>o?o:l}function K6(l,i,o,u){return{y:CB(Math.round(l.y/i),0,o-1),x:CB(Math.round(l.x/i),0,u-1)}}function Ztt(l,i){return{x:l.x+i.x,y:l.y+i.y}}function V7(l,i,o,u,c,f,y,w){w===void 0&&(w=2);for(var C=u.shape,T=C[0],x=C[1],A={y:i.y,x:i.x},M=Ztt(A,function(it,ht,kt){var Nt=kt.shape[2]/2;return{y:kt.get(ht.y,ht.x,it),x:kt.get(ht.y,ht.x,Nt+it)}}(l,K6(A,f,T,x),y)),$=0;$<w;$++){var V=K6(M,f,T,x),G=Ktt(V.y,V.x,o,c);M=Ztt({x:V.x*f,y:V.y*f},{x:G.x,y:G.y})}var Q=K6(M,f,T,x),nt=u.get(Q.y,Q.x,o);return{y:M.y,x:M.x,name:Af[o],score:nt}}function B0t(l,i,o,u,c,f){var y=i.shape[2],w=g1.length,C=new Array(y),T=l.part,x=l.score,A=_B(T,u,o);C[T.id]={score:x,name:Af[T.id],y:A.y,x:A.x};for(var M=w-1;M>=0;--M){var $=g1[M],V=W7[M];C[$]&&!C[V]&&(C[V]=V7(M,C[$],V,i,o,u,f))}for(M=0;M<w;++M)$=W7[M],V=g1[M],C[$]&&!C[V]&&(C[V]=V7(M,C[$],V,i,o,u,c));return C}function Qtt(l,i,o){return o.reduce(function(u,c,f){var y=c.y,w=c.x,C=c.score;return X6(l,i,{y,x:w},f)||(u+=C),u},0)/o.length}function Jtt(l,i,o,u,c,f,y,w){return y===void 0&&(y=.5),w===void 0&&(w=20),So(this,void 0,void 0,function(){var C,T,x,A,M,$,V,G,Q,nt,it,ht;return yo(this,function(kt){switch(kt.label){case 0:return[4,SB([l,i,o,u])];case 1:for(C=kt.sent(),T=C[0],x=C[1],A=C[2],M=C[3],$=[],V=function(Nt,$t,Ut){for(var Pt=Ut.shape,re=Pt[0],ue=Pt[1],be=Pt[2],De=new P0(re*ue*be,function(sn){return sn.score}),ze=0;ze<re;++ze)for(var Qe=0;Qe<ue;++Qe)for(var cn=0;cn<be;++cn){var en=Ut.get(ze,Qe,cn);en<Nt||j7(cn,en,ze,Qe,1,Ut)&&De.enqueue({score:en,part:{heatmapY:ze,heatmapX:Qe,id:cn}})}return De}(y,0,T),G=w*w;$.length<f&&!V.empty();)Q=V.dequeue(),nt=_B(Q.part,c,x),X6($,G,nt,Q.part.id)||(it=B0t(Q,T,x,c,A,M),ht=Qtt($,G,it),$.push({keypoints:it,score:ht}));return[2,$]}})})}function EB(){for(var l,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];switch(i.length){case 0:l="fn main() ";break;case 1:l="fn main(".concat(i[0]," : i32)");break;default:throw Error("Unreachable")}return l}var Z6=function(){function l(i){this.variableNames=["A","B"],this.size=!0,this.workgroupSize=[32,1,1],this.outputShape=[i[0],1],this.dispatchLayout=hi(this.outputShape),this.dispatch=Nr(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="getpointsConfidenceOp"}return l.prototype.getUserCode=function(){return`
        `.concat(EB("index"),` {
          if (index < uniforms.size) {
            let y = B[index * 2];
            let x = B[index * 2 + 1];
            let outIndex = y * uniforms.aShape.x * uniforms.aShape.z + x * uniforms.aShape.z + index;
            result[index] = A[outIndex];
          }
        }
        `)},l}(),j0t=function(){function l(i){if(this.variableNames=["A","B"],this.size=!0,this.supportedLastDimension=2,i.length!==2||i[1]!==this.supportedLastDimension)throw new Error("GetOffsetVectorsProgram only supports shape of [x, ".concat(this.supportedLastDimension,"], but current shape is ").concat(i));this.workgroupSize=[32,1,1],this.outputShape=i;var o=[i[0],1];this.dispatchLayout=hi(o),this.dispatch=Nr(this.dispatchLayout,o,this.workgroupSize),this.shaderKey="GetOffsetVectors"}return l.prototype.getUserCode=function(){return`
    fn getOffsetPoint(y: i32, x: i32, index: i32) -> vec2<i32> {
      let outIndexY = y * uniforms.bShape.x * uniforms.bShape.y + x * uniforms.bShape.y + index;
      let outIndexX = outIndexY + uniforms.bShape.z;
      let outY = i32(B[outIndexY]);
      let outX = i32(B[outIndexX]);
      return vec2<i32>(outY, outX);
    }

    `.concat(EB("index"),` {
      if (index < uniforms.size) {
        let indexY = index * `).concat(this.supportedLastDimension,`;
        let indexX = indexY + 1;
        let heatmapY = A[indexY];
        let heatmapX = A[indexX];
        let out = getOffsetPoint(i32(heatmapY), i32(heatmapX), index);
        result[indexY] = f32(out[0]);
        result[indexX] = f32(out[1]);
      }
    }
    `)},l}();function tet(l){var i=l.shape,o=i[0],u=i[1],c=i[2];return(0,m.tidy)(function(){var f,y,w=(0,m.reshape)(l,[o*u,c]),C=(0,m.argMax)(w,0),T=(0,m.expandDims)((0,m.div)(C,(0,m.scalar)(u,"int32")),1),x=(0,m.expandDims)((f=C,y=u,(0,m.tidy)(function(){var A=(0,m.div)(f,(0,m.scalar)(y,"int32"));return(0,m.sub)(f,(0,m.mul)(A,(0,m.scalar)(y,"int32")))})),1);return(0,m.concat)([T,x],1)})}function U0t(l,i,o){return(0,m.tidy)(function(){var u=function(c,f){for(var y=[],w=0;w<Af.length;w++){var C=W0t(c.get(w,0).valueOf(),c.get(w,1).valueOf(),w,f),T=C.x,x=C.y;y.push(x),y.push(T)}return(0,m.tensor2d)(y,[Af.length,2])}(l,o);return(0,m.add)((0,m.cast)((0,m.mul)(l.toTensor(),(0,m.scalar)(i,"int32")),"float32"),u)})}function W0t(l,i,o,u){return{y:u.get(l,i,o),x:u.get(l,i,o+Af.length)}}function Q6(l,i,o){return So(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M;return yo(this,function($){switch($.label){case 0:return u=0,c=tet(l),[4,Promise.all([l.buffer(),i.buffer(),c.buffer()])];case 1:return f=$.sent(),y=f[0],w=f[1],C=f[2],[4,(T=U0t(C,o,w)).buffer()];case 2:return x=$.sent(),A=Array.from(function(V,G){for(var Q=G.shape[0],nt=new Float32Array(Q),it=0;it<Q;it++){var ht=G.get(it,0),kt=G.get(it,1);nt[it]=V.get(ht,kt,it)}return nt}(y,C)),M=A.map(function(V,G){return u+=V,{y:x.get(G,0),x:x.get(G,1),score:V,name:Af[G]}}),c.dispose(),T.dispose(),[2,{keypoints:M,score:u/M.length}]}})})}function TB(l,i,o){return So(this,void 0,void 0,function(){var u,c,f;return yo(this,function(y){return u=tet(l),c=function(w,C,T){return(0,m.tidy)(function(){var x=function(A,M){if((0,m.backend)()instanceof c4)return function($,V){var G=(0,m.backend)(),Q=new j0t($.shape),nt=G.runWebGPUProgram(Q,[$,V],"float32");return(0,m.engine)().makeTensorFromTensorInfo(nt)}(A,M);throw new Error("getOffsetVectorsGPU is not supported in this backend!")}(w,T);return(0,m.add)((0,m.cast)((0,m.mul)(w,(0,m.scalar)(C,"int32")),"float32"),x)})}(u,o,i),f=function(w,C){if((0,m.backend)()instanceof c4)return function(T,x){var A=(0,m.backend)(),M=new Z6(x.shape),$=A.runWebGPUProgram(M,[T,x],"float32");return(0,m.engine)().makeTensorFromTensorInfo($)}(w,C);throw new Error("getPointsConfidenceWebGPU is not supported in this backend!")}(l,u),[2,[c,f]]})})}function G7(l,i){return(l-1)%i==0}var H7="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",J6="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";function tC(l,i){return function(o,u){return(o-1)%u==0}(l,i)?l:Math.floor(l/i)*i+1}var eet=function(){function l(i,o){this.posenetModel=i;var u=this.posenetModel.inputs[0].shape;m.util.assert(u[1]===-1&&u[2]===-1,function(){return"Input shape [".concat(u[1],", ").concat(u[2],"] ")+"must both be equal to or -1"});var c,f,y=(c=o.inputResolution,f=o.outputStride,{height:tC(c.height,f),width:tC(c.width,f)});(function(w){m.util.assert(qtt.indexOf(w)>=0,function(){return"outputStride of ".concat(w," is invalid. ")+"It must be either 8 or 16."})})(o.outputStride),function(w,C){m.util.assert(G7(w.height,C),function(){return"height of ".concat(w.height," is invalid for output stride ")+"".concat(C,".")}),m.util.assert(G7(w.width,C),function(){return"width of ".concat(w.width," is invalid for output stride ")+"".concat(C,".")})}(y,o.outputStride),this.inputResolution=y,this.outputStride=o.outputStride,this.architecture=o.architecture}return l.prototype.estimatePoses=function(i,o){return o===void 0&&(o=Xtt),So(this,void 0,void 0,function(){return yo(this,function(u){return[2,this.estimatePosesGPU(i,o,!1)]})})},l.prototype.estimatePosesGPU=function(i,o,u){return o===void 0&&(o=Xtt),u===void 0&&(u=!1),So(this,void 0,void 0,function(){var c,f,y,w,C,T,x,A,M,$,V,G,Q,nt,it,ht,kt,Nt;return yo(this,function($t){switch($t.label){case 0:return c=function(Ut){var Pt=Ut;if(Pt.maxPoses==null&&(Pt.maxPoses=1),Pt.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(Pt.maxPoses,". Should be > 0."));if(Pt.maxPoses>1){if((Pt=Ts(Ts({},R4),Pt)).scoreThreshold<0||Pt.scoreThreshold>1)throw new Error("Invalid scoreThreshold ".concat(Pt.scoreThreshold,". ")+"Should be in range [0.0, 1.0]");if(Pt.nmsRadius<=0)throw new Error("Invalid nmsRadius ".concat(Pt.nmsRadius,"."))}return Pt}(o),i==null?[2,u?[[],[]]:[]]:(this.maxPoses=c.maxPoses,f=oB(i,{outputTensorSize:this.inputResolution,keepAspectRatio:!0,borderMode:"replicate"}),y=f.imageTensor,w=f.padding,C=this.architecture==="ResNet50"?(0,m.add)(y,P0t):p1(y,[-1,1]),T=this.posenetModel.predict(C),this.architecture==="ResNet50"?(x=(0,m.squeeze)(T[2],[0]),A=(0,m.squeeze)(T[3],[0]),M=(0,m.squeeze)(T[0],[0]),$=(0,m.squeeze)(T[1],[0])):(x=(0,m.squeeze)(T[0],[0]),A=(0,m.squeeze)(T[1],[0]),M=(0,m.squeeze)(T[2],[0]),$=(0,m.squeeze)(T[3],[0])),V=(0,m.sigmoid)(A),this.maxPoses!==1?[3,5]:u?[4,TB(V,x,this.outputStride)]:[3,2]);case 1:return Q=$t.sent(),it=Q[0],nt=Q[1],G=[it,nt],[3,4];case 2:return[4,Q6(V,x,this.outputStride)];case 3:it=$t.sent(),G=[it],$t.label=4;case 4:return[3,7];case 5:if(u)throw new Error("GPU renderer only supports single pose!");return[4,Jtt(V,x,M,$,this.outputStride,this.maxPoses,c.scoreThreshold,c.nmsRadius)];case 6:G=$t.sent(),$t.label=7;case 7:if(u){if(c.flipHorizontal===!0)throw new Error("flipHorizontal is not supported!");ht=this.getCanvasInfo(Kb(i),this.inputResolution,w)}else Nt=Kb(i),kt=function(Ut,Pt,re,ue){var be=Pt.height,De=Pt.width,ze=be/(re.height*(1-ue.top-ue.bottom)),Qe=De/(re.width*(1-ue.left-ue.right)),cn=-ue.top*re.height,en=-ue.left*re.width;if(Qe===1&&ze===1&&cn===0&&en===0)return Ut;for(var sn=0,xn=Ut;sn<xn.length;sn++)for(var Rn=0,Bn=xn[sn].keypoints;Rn<Bn.length;Rn++){var Fn=Bn[Rn];Fn.x=(Fn.x+en)*Qe,Fn.y=(Fn.y+cn)*ze}return Ut}(G,Nt,this.inputResolution,w),c.flipHorizontal&&(kt=function(Ut,Pt){for(var re=0,ue=Ut;re<ue.length;re++)for(var be=0,De=ue[re].keypoints;be<De.length;be++){var ze=De[be];ze.x=Pt.width-1-ze.x}return Ut}(kt,Nt));return y.dispose(),C.dispose(),(0,m.dispose)(T),x.dispose(),A.dispose(),M.dispose(),$.dispose(),V.dispose(),[2,u?[G,ht]:kt]}})})},l.prototype.getCanvasInfo=function(i,o,u){var c=i.height,f=i.width,y=c/(o.height*(1-u.top-u.bottom)),w=f/(o.width*(1-u.left-u.right)),C=-u.top*o.height;return[-u.left*o.width,C,w,y,i.width,i.height]},l.prototype.dispose=function(){this.posenetModel.dispose()},l.prototype.reset=function(){},l}();function V0t(l){return l===void 0&&(l=t3),So(this,void 0,void 0,function(){var i,o,u,c,f;return yo(this,function(y){switch(y.label){case 0:return(i=function(x){var A=x||t3;if(A.architecture==null&&(A.architecture="MobileNetV1"),e3.indexOf(A.architecture)<0)throw new Error("Invalid architecture ".concat(A.architecture,". ")+"Should be one of ".concat(e3));if(A.inputResolution==null&&(A.inputResolution={height:257,width:257}),A.outputStride==null&&(A.outputStride=16),Dp[A.architecture].indexOf(A.outputStride)<0)throw new Error("Invalid outputStride ".concat(A.outputStride,". ")+"Should be one of ".concat(Dp[A.architecture]," ")+"for architecture ".concat(A.architecture,"."));if(A.multiplier==null&&(A.multiplier=1),kB[A.architecture].indexOf(A.multiplier)<0)throw new Error("Invalid multiplier ".concat(A.multiplier,". ")+"Should be one of ".concat(kB[A.architecture]," ")+"for architecture ".concat(A.architecture,"."));if(A.quantBytes==null&&(A.quantBytes=4),Y6.indexOf(A.quantBytes)<0)throw new Error("Invalid quantBytes ".concat(A.quantBytes,". ")+"Should be one of ".concat(Y6," ")+"for architecture ".concat(A.architecture,"."));if(A.architecture==="MobileNetV1"&&A.outputStride===32&&A.multiplier!==1)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return A}(l)).architecture!=="ResNet50"?[3,2]:(w=i.outputStride,C=i.quantBytes,T="model-stride".concat(w,".json"),o=C===4?J6+"float/"+T:J6+"quant".concat(C,"/")+T,[4,Vc(i.modelUrl||o)]);case 1:return u=y.sent(),[2,new eet(u,i)];case 2:return c=function(x,A,M){var $={1:"100",.75:"075",.5:"050"},V="model-stride".concat(x,".json");return M===4?H7+"float/".concat($[A],"/")+V:H7+"quant".concat(M,"/").concat($[A],"/")+V}(i.outputStride,i.multiplier,i.quantBytes),[4,Vc(i.modelUrl||c)];case 3:return f=y.sent(),[2,new eet(f,i)]}var w,C,T})})}var O4={SINGLEPOSE_LIGHTNING:"SinglePose.Lightning",SINGLEPOSE_THUNDER:"SinglePose.Thunder",MULTIPOSE_LIGHTNING:"MultiPose.Lightning"};let G0t={modelType:{type:"enum",enums:["SINGLEPOSE_LIGHTNING","SINGLEPOSE_THUNDER","MULTIPOSE_LIGHTNING"],default:"MULTIPOSE_LIGHTNING"},enableSmoothing:{type:"boolean",default:!0},minPoseScore:{type:"number",min:0,max:1,default:.25},multiPoseMaxDimension:{type:"number",default:256,min:32,integer:!0,multipleOf:32},enableTracking:{type:"boolean",default:!0},trackerType:{type:"enum",enums:["boundingBox","keypoint"],default:"boundingBox"},trackerConfig:{type:"object",default:void 0},modelUrl:{type:"string",default:void 0}},net={runtime:{type:"enum",enums:["mediapipe","tfjs"],default:"tfjs"},enableSmoothing:{type:"boolean",default:!0},enableSegmentation:{type:"boolean",default:!1,ignore:l=>l.runtime!=="mediapipe"},smoothSegmentation:{type:"boolean",default:!0,ignore:l=>l.runtime!=="mediapipe"},modelType:{type:"enum",enums:["lite","full","heavy"],default:"full"},solutionPath:{type:"string",default:"https://cdn.jsdelivr.net/npm/@mediapipe/pose",ignore:l=>l.runtime!=="mediapipe"},detectorModelUrl:{type:"string",default:void 0,ignore:l=>l.runtime!=="tfjs"},landmarkModelUrl:{type:"string",default:void 0,ignore:l=>l.runtime!=="tfjs"}},H0t={flipHorizontal:{type:"boolean",alias:"flipped",default:!1}};class ret{constructor(i,o,u){this.modelName=Lm(i,["BlazePose","MoveNet"],"MoveNet","bodyPose"),this.model=null,this.userOptions=o,this.runtimeConfig={},this.detectMedia=null,this.detectCallback=null,this.detecting=!1,this.signalStop=!1,this.prevCall="",this.ready=Ws(this.loadModel(),u)}loadModel(){return ce(this,null,function*(){let i,o;if(this.modelName==="BlazePose")i=Rl.BlazePose,o=Ip(this.userOptions,net,"bodyPose");else switch(i=Rl.MoveNet,o=Ip(this.userOptions,G0t,"bodyPose"),o.modelType){case"SINGLEPOSE_LIGHTNING":o.modelType=O4.SINGLEPOSE_LIGHTNING;break;case"SINGLEPOSE_THUNDER":o.modelType=O4.SINGLEPOSE_THUNDER;break;default:o.modelType=O4.MULTIPOSE_LIGHTNING}return this.runtimeConfig=Ip(this.userOptions,H0t,"bodyPose"),yield m.ready(),this.model=yield function(u,c){return So(this,void 0,void 0,function(){var f,y;return yo(this,function(w){switch(u){case Rl.PoseNet:return[2,V0t(c)];case Rl.BlazePose:if(y=void 0,(f=c)!=null){if(f.runtime==="tfjs")return[2,$7(c)];if(f.runtime==="mediapipe")return[2,iB(c)];y=f.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' "+"or 'mediapipe', but got ".concat(y));case Rl.MoveNet:return[2,Ytt(c)];default:throw new Error("".concat(u," is not a supported model name."))}})})}(i,o),this})}detect(...i){return ce(this,null,function*(){let o=Uu(...i);o.require("image","An html or p5.js image, video, or canvas element argument is required for detect().");let{image:u,callback:c}=o;yield E0(u,!1);let f=yield this.model.estimatePoses(u);return this.renameScoreToConfidence(f),this.modelName==="MoveNet"&&zx(u)&&this.resizeKeypoints(f,u.videoWidth,u.videoHeight,u.width,u.height),this.runtimeConfig.flipHorizontal&&(this.mirrorKeypoints(f,u.width),this.mirrorBoundingBoxes(f)),this.addKeypoints(f),this.resizeBoundingBoxes(f,u.width,u.height),typeof c=="function"&&c(f),f})}detectStart(...i){let o=Uu(...i);o.require("image","An html or p5.js image, video, or canvas element argument is required for detectStart()."),o.require("callback","A callback function argument is required for detectStart()."),this.detectMedia=o.image,this.detectCallback=o.callback,this.signalStop=!1,this.detecting||(this.detecting=!0,this.detectLoop()),this.prevCall==="start"&&console.warn("detectStart() was called more than once without calling detectStop(). The lastest detectStart() call will be used and the previous calls will be ignored."),this.prevCall="start"}detectLoop(){return ce(this,null,function*(){for(yield E0(this.detectMedia,!1);!this.signalStop;){let i=yield this.model.estimatePoses(this.detectMedia);this.renameScoreToConfidence(i),this.modelName==="MoveNet"&&zx(this.detectMedia)&&this.resizeKeypoints(i,this.detectMedia.videoWidth,this.detectMedia.videoHeight,this.detectMedia.width,this.detectMedia.height),this.runtimeConfig.flipHorizontal&&(this.mirrorKeypoints(i,this.detectMedia.width),this.mirrorBoundingBoxes(i)),this.addKeypoints(i),this.resizeBoundingBoxes(i,this.detectMedia.width,this.detectMedia.height),this.detectCallback(i),yield m.nextFrame()}this.detecting=!1,this.signalStop=!1})}detectStop(){this.detecting&&(this.signalStop=!0),this.prevCall="stop"}renameScoreToConfidence(i){i.forEach(o=>{o.keypoints.forEach(u=>{WI(u,"score","confidence")}),o.keypoints3D&&o.keypoints3D.forEach(u=>{WI(u,"score","confidence")}),o.score&&WI(o,"score","confidence")})}mirrorKeypoints(i,o){i.forEach(u=>{u.keypoints.forEach(c=>{c.x=o-c.x})})}mirrorBoundingBoxes(i){i.forEach(o=>{if(!o.box)return;let u=o.box.xMin;o.box.xMin=1-o.box.xMax,o.box.xMax=1-u})}resizeKeypoints(i,o,u,c,f){i.forEach(y=>{y.keypoints.forEach(w=>{w.x=w.x/o*c,w.y=w.y/u*f})})}addKeypoints(i){i.forEach(o=>{o.keypoints.forEach(u=>{u.z&&delete u.z,o[u.name]={x:u.x,y:u.y,confidence:u.confidence}}),o.keypoints3D&&o.keypoints3D.forEach(u=>{o[u.name].keypoint3D={x:u.x,y:u.y,z:u.z,confidence:u.confidence}})})}resizeBoundingBoxes(i,o,u){i[0]&&i[0].box&&i.forEach(c=>{c.box.height=c.box.height*u,c.box.width=c.box.width*o,c.box.xMax=c.box.xMax*o,c.box.xMin=c.box.xMin*o,c.box.yMax=c.box.yMax*u,c.box.yMin=c.box.yMin*u})}getConnections(){return this.modelName==="BlazePose"?D4.getAdjacentPairs(Rl.BlazePose):D4.getAdjacentPairs(Rl.MoveNet)}getSkeleton(){return this.getConnections()}}let Y0t=(...l)=>{let{string:i,options:o={},callback:u}=Uu(...l);return new ret(i,o,u)};function Y7(l,i,o,u){return new(o||(o=Promise))(function(c,f){function y(T){try{C(u.next(T))}catch(x){f(x)}}function w(T){try{C(u.throw(T))}catch(x){f(x)}}function C(T){var x;T.done?c(T.value):(x=T.value,x instanceof o?x:new o(function(A){A(x)})).then(y,w)}C((u=u.apply(l,[])).next())})}function q7(l,i){var o,u,c,f,y={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return f={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function w(C){return function(T){return function(x){if(o)throw new TypeError("Generator is already executing.");for(;y;)try{if(o=1,u&&(c=2&x[0]?u.return:x[0]?u.throw||((c=u.return)&&c.call(u),0):u.next)&&!(c=c.call(u,x[1])).done)return c;switch(u=0,c&&(x=[2&x[0],c.value]),x[0]){case 0:case 1:c=x;break;case 4:return y.label++,{value:x[1],done:!1};case 5:y.label++,u=x[1],x=[0];continue;case 7:x=y.ops.pop(),y.trys.pop();continue;default:if(!(c=(c=y.trys).length>0&&c[c.length-1])&&(x[0]===6||x[0]===2)){y=0;continue}if(x[0]===3&&(!c||x[1]>c[0]&&x[1]<c[3])){y.label=x[1];break}if(x[0]===6&&y.label<c[1]){y.label=c[1],c=x;break}if(c&&y.label<c[2]){y.label=c[2],y.ops.push(x);break}c[2]&&y.ops.pop(),y.trys.pop();continue}x=i.call(l,y)}catch(A){x=[6,A],u=0}finally{o=c=0}if(5&x[0])throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}([C,T])}}}var iet={0:"tench, Tinca tinca",1:"goldfish, Carassius auratus",2:"great white shark, white shark, man-eater, man-eating shark, Carcharodon carcharias",3:"tiger shark, Galeocerdo cuvieri",4:"hammerhead, hammerhead shark",5:"electric ray, crampfish, numbfish, torpedo",6:"stingray",7:"cock",8:"hen",9:"ostrich, Struthio camelus",10:"brambling, Fringilla montifringilla",11:"goldfinch, Carduelis carduelis",12:"house finch, linnet, Carpodacus mexicanus",13:"junco, snowbird",14:"indigo bunting, indigo finch, indigo bird, Passerina cyanea",15:"robin, American robin, Turdus migratorius",16:"bulbul",17:"jay",18:"magpie",19:"chickadee",20:"water ouzel, dipper",21:"kite",22:"bald eagle, American eagle, Haliaeetus leucocephalus",23:"vulture",24:"great grey owl, great gray owl, Strix nebulosa",25:"European fire salamander, Salamandra salamandra",26:"common newt, Triturus vulgaris",27:"eft",28:"spotted salamander, Ambystoma maculatum",29:"axolotl, mud puppy, Ambystoma mexicanum",30:"bullfrog, Rana catesbeiana",31:"tree frog, tree-frog",32:"tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui",33:"loggerhead, loggerhead turtle, Caretta caretta",34:"leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea",35:"mud turtle",36:"terrapin",37:"box turtle, box tortoise",38:"banded gecko",39:"common iguana, iguana, Iguana iguana",40:"American chameleon, anole, Anolis carolinensis",41:"whiptail, whiptail lizard",42:"agama",43:"frilled lizard, Chlamydosaurus kingi",44:"alligator lizard",45:"Gila monster, Heloderma suspectum",46:"green lizard, Lacerta viridis",47:"African chameleon, Chamaeleo chamaeleon",48:"Komodo dragon, Komodo lizard, dragon lizard, giant lizard, Varanus komodoensis",49:"African crocodile, Nile crocodile, Crocodylus niloticus",50:"American alligator, Alligator mississipiensis",51:"triceratops",52:"thunder snake, worm snake, Carphophis amoenus",53:"ringneck snake, ring-necked snake, ring snake",54:"hognose snake, puff adder, sand viper",55:"green snake, grass snake",56:"king snake, kingsnake",57:"garter snake, grass snake",58:"water snake",59:"vine snake",60:"night snake, Hypsiglena torquata",61:"boa constrictor, Constrictor constrictor",62:"rock python, rock snake, Python sebae",63:"Indian cobra, Naja naja",64:"green mamba",65:"sea snake",66:"horned viper, cerastes, sand viper, horned asp, Cerastes cornutus",67:"diamondback, diamondback rattlesnake, Crotalus adamanteus",68:"sidewinder, horned rattlesnake, Crotalus cerastes",69:"trilobite",70:"harvestman, daddy longlegs, Phalangium opilio",71:"scorpion",72:"black and gold garden spider, Argiope aurantia",73:"barn spider, Araneus cavaticus",74:"garden spider, Aranea diademata",75:"black widow, Latrodectus mactans",76:"tarantula",77:"wolf spider, hunting spider",78:"tick",79:"centipede",80:"black grouse",81:"ptarmigan",82:"ruffed grouse, partridge, Bonasa umbellus",83:"prairie chicken, prairie grouse, prairie fowl",84:"peacock",85:"quail",86:"partridge",87:"African grey, African gray, Psittacus erithacus",88:"macaw",89:"sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita",90:"lorikeet",91:"coucal",92:"bee eater",93:"hornbill",94:"hummingbird",95:"jacamar",96:"toucan",97:"drake",98:"red-breasted merganser, Mergus serrator",99:"goose",100:"black swan, Cygnus atratus",101:"tusker",102:"echidna, spiny anteater, anteater",103:"platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus",104:"wallaby, brush kangaroo",105:"koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus",106:"wombat",107:"jelly fish",108:"sea anemone, anemone",109:"brain coral",110:"flatworm, platyhelminth",111:"nematode, nematode worm, roundworm",112:"conch",113:"snail",114:"slug",115:"sea slug, nudibranch",116:"chiton, coat-of-mail shell, sea cradle, polyplacophore",117:"chambered nautilus, pearly nautilus, nautilus",118:"Dungeness crab, Cancer magister",119:"rock crab, Cancer irroratus",120:"fiddler crab",121:"king crab, Alaska crab, Alaskan king crab, Alaska king crab, Paralithodes camtschatica",122:"American lobster, Northern lobster, Maine lobster, Homarus americanus",123:"spiny lobster, langouste, rock lobster, crawfish, crayfish, sea crawfish",124:"crayfish, crawfish, crawdad, crawdaddy",125:"hermit crab",126:"isopod",127:"white stork, Ciconia ciconia",128:"black stork, Ciconia nigra",129:"spoonbill",130:"flamingo",131:"little blue heron, Egretta caerulea",132:"American egret, great white heron, Egretta albus",133:"bittern",134:"crane",135:"limpkin, Aramus pictus",136:"European gallinule, Porphyrio porphyrio",137:"American coot, marsh hen, mud hen, water hen, Fulica americana",138:"bustard",139:"ruddy turnstone, Arenaria interpres",140:"red-backed sandpiper, dunlin, Erolia alpina",141:"redshank, Tringa totanus",142:"dowitcher",143:"oystercatcher, oyster catcher",144:"pelican",145:"king penguin, Aptenodytes patagonica",146:"albatross, mollymawk",147:"grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus",148:"killer whale, killer, orca, grampus, sea wolf, Orcinus orca",149:"dugong, Dugong dugon",150:"sea lion",151:"Chihuahua",152:"Japanese spaniel",153:"Maltese dog, Maltese terrier, Maltese",154:"Pekinese, Pekingese, Peke",155:"Shih-Tzu",156:"Blenheim spaniel",157:"papillon",158:"toy terrier",159:"Rhodesian ridgeback",160:"Afghan hound, Afghan",161:"basset, basset hound",162:"beagle",163:"bloodhound, sleuthhound",164:"bluetick",165:"black-and-tan coonhound",166:"Walker hound, Walker foxhound",167:"English foxhound",168:"redbone",169:"borzoi, Russian wolfhound",170:"Irish wolfhound",171:"Italian greyhound",172:"whippet",173:"Ibizan hound, Ibizan Podenco",174:"Norwegian elkhound, elkhound",175:"otterhound, otter hound",176:"Saluki, gazelle hound",177:"Scottish deerhound, deerhound",178:"Weimaraner",179:"Staffordshire bullterrier, Staffordshire bull terrier",180:"American Staffordshire terrier, Staffordshire terrier, American pit bull terrier, pit bull terrier",181:"Bedlington terrier",182:"Border terrier",183:"Kerry blue terrier",184:"Irish terrier",185:"Norfolk terrier",186:"Norwich terrier",187:"Yorkshire terrier",188:"wire-haired fox terrier",189:"Lakeland terrier",190:"Sealyham terrier, Sealyham",191:"Airedale, Airedale terrier",192:"cairn, cairn terrier",193:"Australian terrier",194:"Dandie Dinmont, Dandie Dinmont terrier",195:"Boston bull, Boston terrier",196:"miniature schnauzer",197:"giant schnauzer",198:"standard schnauzer",199:"Scotch terrier, Scottish terrier, Scottie",200:"Tibetan terrier, chrysanthemum dog",201:"silky terrier, Sydney silky",202:"soft-coated wheaten terrier",203:"West Highland white terrier",204:"Lhasa, Lhasa apso",205:"flat-coated retriever",206:"curly-coated retriever",207:"golden retriever",208:"Labrador retriever",209:"Chesapeake Bay retriever",210:"German short-haired pointer",211:"vizsla, Hungarian pointer",212:"English setter",213:"Irish setter, red setter",214:"Gordon setter",215:"Brittany spaniel",216:"clumber, clumber spaniel",217:"English springer, English springer spaniel",218:"Welsh springer spaniel",219:"cocker spaniel, English cocker spaniel, cocker",220:"Sussex spaniel",221:"Irish water spaniel",222:"kuvasz",223:"schipperke",224:"groenendael",225:"malinois",226:"briard",227:"kelpie",228:"komondor",229:"Old English sheepdog, bobtail",230:"Shetland sheepdog, Shetland sheep dog, Shetland",231:"collie",232:"Border collie",233:"Bouvier des Flandres, Bouviers des Flandres",234:"Rottweiler",235:"German shepherd, German shepherd dog, German police dog, alsatian",236:"Doberman, Doberman pinscher",237:"miniature pinscher",238:"Greater Swiss Mountain dog",239:"Bernese mountain dog",240:"Appenzeller",241:"EntleBucher",242:"boxer",243:"bull mastiff",244:"Tibetan mastiff",245:"French bulldog",246:"Great Dane",247:"Saint Bernard, St Bernard",248:"Eskimo dog, husky",249:"malamute, malemute, Alaskan malamute",250:"Siberian husky",251:"dalmatian, coach dog, carriage dog",252:"affenpinscher, monkey pinscher, monkey dog",253:"basenji",254:"pug, pug-dog",255:"Leonberg",256:"Newfoundland, Newfoundland dog",257:"Great Pyrenees",258:"Samoyed, Samoyede",259:"Pomeranian",260:"chow, chow chow",261:"keeshond",262:"Brabancon griffon",263:"Pembroke, Pembroke Welsh corgi",264:"Cardigan, Cardigan Welsh corgi",265:"toy poodle",266:"miniature poodle",267:"standard poodle",268:"Mexican hairless",269:"timber wolf, grey wolf, gray wolf, Canis lupus",270:"white wolf, Arctic wolf, Canis lupus tundrarum",271:"red wolf, maned wolf, Canis rufus, Canis niger",272:"coyote, prairie wolf, brush wolf, Canis latrans",273:"dingo, warrigal, warragal, Canis dingo",274:"dhole, Cuon alpinus",275:"African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus",276:"hyena, hyaena",277:"red fox, Vulpes vulpes",278:"kit fox, Vulpes macrotis",279:"Arctic fox, white fox, Alopex lagopus",280:"grey fox, gray fox, Urocyon cinereoargenteus",281:"tabby, tabby cat",282:"tiger cat",283:"Persian cat",284:"Siamese cat, Siamese",285:"Egyptian cat",286:"cougar, puma, catamount, mountain lion, painter, panther, Felis concolor",287:"lynx, catamount",288:"leopard, Panthera pardus",289:"snow leopard, ounce, Panthera uncia",290:"jaguar, panther, Panthera onca, Felis onca",291:"lion, king of beasts, Panthera leo",292:"tiger, Panthera tigris",293:"cheetah, chetah, Acinonyx jubatus",294:"brown bear, bruin, Ursus arctos",295:"American black bear, black bear, Ursus americanus, Euarctos americanus",296:"ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus",297:"sloth bear, Melursus ursinus, Ursus ursinus",298:"mongoose",299:"meerkat, mierkat",300:"tiger beetle",301:"ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle",302:"ground beetle, carabid beetle",303:"long-horned beetle, longicorn, longicorn beetle",304:"leaf beetle, chrysomelid",305:"dung beetle",306:"rhinoceros beetle",307:"weevil",308:"fly",309:"bee",310:"ant, emmet, pismire",311:"grasshopper, hopper",312:"cricket",313:"walking stick, walkingstick, stick insect",314:"cockroach, roach",315:"mantis, mantid",316:"cicada, cicala",317:"leafhopper",318:"lacewing, lacewing fly",319:"dragonfly, darning needle, devil's darning needle, sewing needle, snake feeder, snake doctor, mosquito hawk, skeeter hawk",320:"damselfly",321:"admiral",322:"ringlet, ringlet butterfly",323:"monarch, monarch butterfly, milkweed butterfly, Danaus plexippus",324:"cabbage butterfly",325:"sulphur butterfly, sulfur butterfly",326:"lycaenid, lycaenid butterfly",327:"starfish, sea star",328:"sea urchin",329:"sea cucumber, holothurian",330:"wood rabbit, cottontail, cottontail rabbit",331:"hare",332:"Angora, Angora rabbit",333:"hamster",334:"porcupine, hedgehog",335:"fox squirrel, eastern fox squirrel, Sciurus niger",336:"marmot",337:"beaver",338:"guinea pig, Cavia cobaya",339:"sorrel",340:"zebra",341:"hog, pig, grunter, squealer, Sus scrofa",342:"wild boar, boar, Sus scrofa",343:"warthog",344:"hippopotamus, hippo, river horse, Hippopotamus amphibius",345:"ox",346:"water buffalo, water ox, Asiatic buffalo, Bubalus bubalis",347:"bison",348:"ram, tup",349:"bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky Mountain sheep, Ovis canadensis",350:"ibex, Capra ibex",351:"hartebeest",352:"impala, Aepyceros melampus",353:"gazelle",354:"Arabian camel, dromedary, Camelus dromedarius",355:"llama",356:"weasel",357:"mink",358:"polecat, fitch, foulmart, foumart, Mustela putorius",359:"black-footed ferret, ferret, Mustela nigripes",360:"otter",361:"skunk, polecat, wood pussy",362:"badger",363:"armadillo",364:"three-toed sloth, ai, Bradypus tridactylus",365:"orangutan, orang, orangutang, Pongo pygmaeus",366:"gorilla, Gorilla gorilla",367:"chimpanzee, chimp, Pan troglodytes",368:"gibbon, Hylobates lar",369:"siamang, Hylobates syndactylus, Symphalangus syndactylus",370:"guenon, guenon monkey",371:"patas, hussar monkey, Erythrocebus patas",372:"baboon",373:"macaque",374:"langur",375:"colobus, colobus monkey",376:"proboscis monkey, Nasalis larvatus",377:"marmoset",378:"capuchin, ringtail, Cebus capucinus",379:"howler monkey, howler",380:"titi, titi monkey",381:"spider monkey, Ateles geoffroyi",382:"squirrel monkey, Saimiri sciureus",383:"Madagascar cat, ring-tailed lemur, Lemur catta",384:"indri, indris, Indri indri, Indri brevicaudatus",385:"Indian elephant, Elephas maximus",386:"African elephant, Loxodonta africana",387:"lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens",388:"giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca",389:"barracouta, snoek",390:"eel",391:"coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch",392:"rock beauty, Holocanthus tricolor",393:"anemone fish",394:"sturgeon",395:"gar, garfish, garpike, billfish, Lepisosteus osseus",396:"lionfish",397:"puffer, pufferfish, blowfish, globefish",398:"abacus",399:"abaya",400:"academic gown, academic robe, judge's robe",401:"accordion, piano accordion, squeeze box",402:"acoustic guitar",403:"aircraft carrier, carrier, flattop, attack aircraft carrier",404:"airliner",405:"airship, dirigible",406:"altar",407:"ambulance",408:"amphibian, amphibious vehicle",409:"analog clock",410:"apiary, bee house",411:"apron",412:"ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, dustbin, trash barrel, trash bin",413:"assault rifle, assault gun",414:"backpack, back pack, knapsack, packsack, rucksack, haversack",415:"bakery, bakeshop, bakehouse",416:"balance beam, beam",417:"balloon",418:"ballpoint, ballpoint pen, ballpen, Biro",419:"Band Aid",420:"banjo",421:"bannister, banister, balustrade, balusters, handrail",422:"barbell",423:"barber chair",424:"barbershop",425:"barn",426:"barometer",427:"barrel, cask",428:"barrow, garden cart, lawn cart, wheelbarrow",429:"baseball",430:"basketball",431:"bassinet",432:"bassoon",433:"bathing cap, swimming cap",434:"bath towel",435:"bathtub, bathing tub, bath, tub",436:"beach wagon, station wagon, wagon, estate car, beach waggon, station waggon, waggon",437:"beacon, lighthouse, beacon light, pharos",438:"beaker",439:"bearskin, busby, shako",440:"beer bottle",441:"beer glass",442:"bell cote, bell cot",443:"bib",444:"bicycle-built-for-two, tandem bicycle, tandem",445:"bikini, two-piece",446:"binder, ring-binder",447:"binoculars, field glasses, opera glasses",448:"birdhouse",449:"boathouse",450:"bobsled, bobsleigh, bob",451:"bolo tie, bolo, bola tie, bola",452:"bonnet, poke bonnet",453:"bookcase",454:"bookshop, bookstore, bookstall",455:"bottlecap",456:"bow",457:"bow tie, bow-tie, bowtie",458:"brass, memorial tablet, plaque",459:"brassiere, bra, bandeau",460:"breakwater, groin, groyne, mole, bulwark, seawall, jetty",461:"breastplate, aegis, egis",462:"broom",463:"bucket, pail",464:"buckle",465:"bulletproof vest",466:"bullet train, bullet",467:"butcher shop, meat market",468:"cab, hack, taxi, taxicab",469:"caldron, cauldron",470:"candle, taper, wax light",471:"cannon",472:"canoe",473:"can opener, tin opener",474:"cardigan",475:"car mirror",476:"carousel, carrousel, merry-go-round, roundabout, whirligig",477:"carpenter's kit, tool kit",478:"carton",479:"car wheel",480:"cash machine, cash dispenser, automated teller machine, automatic teller machine, automated teller, automatic teller, ATM",481:"cassette",482:"cassette player",483:"castle",484:"catamaran",485:"CD player",486:"cello, violoncello",487:"cellular telephone, cellular phone, cellphone, cell, mobile phone",488:"chain",489:"chainlink fence",490:"chain mail, ring mail, mail, chain armor, chain armour, ring armor, ring armour",491:"chain saw, chainsaw",492:"chest",493:"chiffonier, commode",494:"chime, bell, gong",495:"china cabinet, china closet",496:"Christmas stocking",497:"church, church building",498:"cinema, movie theater, movie theatre, movie house, picture palace",499:"cleaver, meat cleaver, chopper",500:"cliff dwelling",501:"cloak",502:"clog, geta, patten, sabot",503:"cocktail shaker",504:"coffee mug",505:"coffeepot",506:"coil, spiral, volute, whorl, helix",507:"combination lock",508:"computer keyboard, keypad",509:"confectionery, confectionary, candy store",510:"container ship, containership, container vessel",511:"convertible",512:"corkscrew, bottle screw",513:"cornet, horn, trumpet, trump",514:"cowboy boot",515:"cowboy hat, ten-gallon hat",516:"cradle",517:"crane",518:"crash helmet",519:"crate",520:"crib, cot",521:"Crock Pot",522:"croquet ball",523:"crutch",524:"cuirass",525:"dam, dike, dyke",526:"desk",527:"desktop computer",528:"dial telephone, dial phone",529:"diaper, nappy, napkin",530:"digital clock",531:"digital watch",532:"dining table, board",533:"dishrag, dishcloth",534:"dishwasher, dish washer, dishwashing machine",535:"disk brake, disc brake",536:"dock, dockage, docking facility",537:"dogsled, dog sled, dog sleigh",538:"dome",539:"doormat, welcome mat",540:"drilling platform, offshore rig",541:"drum, membranophone, tympan",542:"drumstick",543:"dumbbell",544:"Dutch oven",545:"electric fan, blower",546:"electric guitar",547:"electric locomotive",548:"entertainment center",549:"envelope",550:"espresso maker",551:"face powder",552:"feather boa, boa",553:"file, file cabinet, filing cabinet",554:"fireboat",555:"fire engine, fire truck",556:"fire screen, fireguard",557:"flagpole, flagstaff",558:"flute, transverse flute",559:"folding chair",560:"football helmet",561:"forklift",562:"fountain",563:"fountain pen",564:"four-poster",565:"freight car",566:"French horn, horn",567:"frying pan, frypan, skillet",568:"fur coat",569:"garbage truck, dustcart",570:"gasmask, respirator, gas helmet",571:"gas pump, gasoline pump, petrol pump, island dispenser",572:"goblet",573:"go-kart",574:"golf ball",575:"golfcart, golf cart",576:"gondola",577:"gong, tam-tam",578:"gown",579:"grand piano, grand",580:"greenhouse, nursery, glasshouse",581:"grille, radiator grille",582:"grocery store, grocery, food market, market",583:"guillotine",584:"hair slide",585:"hair spray",586:"half track",587:"hammer",588:"hamper",589:"hand blower, blow dryer, blow drier, hair dryer, hair drier",590:"hand-held computer, hand-held microcomputer",591:"handkerchief, hankie, hanky, hankey",592:"hard disc, hard disk, fixed disk",593:"harmonica, mouth organ, harp, mouth harp",594:"harp",595:"harvester, reaper",596:"hatchet",597:"holster",598:"home theater, home theatre",599:"honeycomb",600:"hook, claw",601:"hoopskirt, crinoline",602:"horizontal bar, high bar",603:"horse cart, horse-cart",604:"hourglass",605:"iPod",606:"iron, smoothing iron",607:"jack-o'-lantern",608:"jean, blue jean, denim",609:"jeep, landrover",610:"jersey, T-shirt, tee shirt",611:"jigsaw puzzle",612:"jinrikisha, ricksha, rickshaw",613:"joystick",614:"kimono",615:"knee pad",616:"knot",617:"lab coat, laboratory coat",618:"ladle",619:"lampshade, lamp shade",620:"laptop, laptop computer",621:"lawn mower, mower",622:"lens cap, lens cover",623:"letter opener, paper knife, paperknife",624:"library",625:"lifeboat",626:"lighter, light, igniter, ignitor",627:"limousine, limo",628:"liner, ocean liner",629:"lipstick, lip rouge",630:"Loafer",631:"lotion",632:"loudspeaker, speaker, speaker unit, loudspeaker system, speaker system",633:"loupe, jeweler's loupe",634:"lumbermill, sawmill",635:"magnetic compass",636:"mailbag, postbag",637:"mailbox, letter box",638:"maillot",639:"maillot, tank suit",640:"manhole cover",641:"maraca",642:"marimba, xylophone",643:"mask",644:"matchstick",645:"maypole",646:"maze, labyrinth",647:"measuring cup",648:"medicine chest, medicine cabinet",649:"megalith, megalithic structure",650:"microphone, mike",651:"microwave, microwave oven",652:"military uniform",653:"milk can",654:"minibus",655:"miniskirt, mini",656:"minivan",657:"missile",658:"mitten",659:"mixing bowl",660:"mobile home, manufactured home",661:"Model T",662:"modem",663:"monastery",664:"monitor",665:"moped",666:"mortar",667:"mortarboard",668:"mosque",669:"mosquito net",670:"motor scooter, scooter",671:"mountain bike, all-terrain bike, off-roader",672:"mountain tent",673:"mouse, computer mouse",674:"mousetrap",675:"moving van",676:"muzzle",677:"nail",678:"neck brace",679:"necklace",680:"nipple",681:"notebook, notebook computer",682:"obelisk",683:"oboe, hautboy, hautbois",684:"ocarina, sweet potato",685:"odometer, hodometer, mileometer, milometer",686:"oil filter",687:"organ, pipe organ",688:"oscilloscope, scope, cathode-ray oscilloscope, CRO",689:"overskirt",690:"oxcart",691:"oxygen mask",692:"packet",693:"paddle, boat paddle",694:"paddlewheel, paddle wheel",695:"padlock",696:"paintbrush",697:"pajama, pyjama, pj's, jammies",698:"palace",699:"panpipe, pandean pipe, syrinx",700:"paper towel",701:"parachute, chute",702:"parallel bars, bars",703:"park bench",704:"parking meter",705:"passenger car, coach, carriage",706:"patio, terrace",707:"pay-phone, pay-station",708:"pedestal, plinth, footstall",709:"pencil box, pencil case",710:"pencil sharpener",711:"perfume, essence",712:"Petri dish",713:"photocopier",714:"pick, plectrum, plectron",715:"pickelhaube",716:"picket fence, paling",717:"pickup, pickup truck",718:"pier",719:"piggy bank, penny bank",720:"pill bottle",721:"pillow",722:"ping-pong ball",723:"pinwheel",724:"pirate, pirate ship",725:"pitcher, ewer",726:"plane, carpenter's plane, woodworking plane",727:"planetarium",728:"plastic bag",729:"plate rack",730:"plow, plough",731:"plunger, plumber's helper",732:"Polaroid camera, Polaroid Land camera",733:"pole",734:"police van, police wagon, paddy wagon, patrol wagon, wagon, black Maria",735:"poncho",736:"pool table, billiard table, snooker table",737:"pop bottle, soda bottle",738:"pot, flowerpot",739:"potter's wheel",740:"power drill",741:"prayer rug, prayer mat",742:"printer",743:"prison, prison house",744:"projectile, missile",745:"projector",746:"puck, hockey puck",747:"punching bag, punch bag, punching ball, punchball",748:"purse",749:"quill, quill pen",750:"quilt, comforter, comfort, puff",751:"racer, race car, racing car",752:"racket, racquet",753:"radiator",754:"radio, wireless",755:"radio telescope, radio reflector",756:"rain barrel",757:"recreational vehicle, RV, R.V.",758:"reel",759:"reflex camera",760:"refrigerator, icebox",761:"remote control, remote",762:"restaurant, eating house, eating place, eatery",763:"revolver, six-gun, six-shooter",764:"rifle",765:"rocking chair, rocker",766:"rotisserie",767:"rubber eraser, rubber, pencil eraser",768:"rugby ball",769:"rule, ruler",770:"running shoe",771:"safe",772:"safety pin",773:"saltshaker, salt shaker",774:"sandal",775:"sarong",776:"sax, saxophone",777:"scabbard",778:"scale, weighing machine",779:"school bus",780:"schooner",781:"scoreboard",782:"screen, CRT screen",783:"screw",784:"screwdriver",785:"seat belt, seatbelt",786:"sewing machine",787:"shield, buckler",788:"shoe shop, shoe-shop, shoe store",789:"shoji",790:"shopping basket",791:"shopping cart",792:"shovel",793:"shower cap",794:"shower curtain",795:"ski",796:"ski mask",797:"sleeping bag",798:"slide rule, slipstick",799:"sliding door",800:"slot, one-armed bandit",801:"snorkel",802:"snowmobile",803:"snowplow, snowplough",804:"soap dispenser",805:"soccer ball",806:"sock",807:"solar dish, solar collector, solar furnace",808:"sombrero",809:"soup bowl",810:"space bar",811:"space heater",812:"space shuttle",813:"spatula",814:"speedboat",815:"spider web, spider's web",816:"spindle",817:"sports car, sport car",818:"spotlight, spot",819:"stage",820:"steam locomotive",821:"steel arch bridge",822:"steel drum",823:"stethoscope",824:"stole",825:"stone wall",826:"stopwatch, stop watch",827:"stove",828:"strainer",829:"streetcar, tram, tramcar, trolley, trolley car",830:"stretcher",831:"studio couch, day bed",832:"stupa, tope",833:"submarine, pigboat, sub, U-boat",834:"suit, suit of clothes",835:"sundial",836:"sunglass",837:"sunglasses, dark glasses, shades",838:"sunscreen, sunblock, sun blocker",839:"suspension bridge",840:"swab, swob, mop",841:"sweatshirt",842:"swimming trunks, bathing trunks",843:"swing",844:"switch, electric switch, electrical switch",845:"syringe",846:"table lamp",847:"tank, army tank, armored combat vehicle, armoured combat vehicle",848:"tape player",849:"teapot",850:"teddy, teddy bear",851:"television, television system",852:"tennis ball",853:"thatch, thatched roof",854:"theater curtain, theatre curtain",855:"thimble",856:"thresher, thrasher, threshing machine",857:"throne",858:"tile roof",859:"toaster",860:"tobacco shop, tobacconist shop, tobacconist",861:"toilet seat",862:"torch",863:"totem pole",864:"tow truck, tow car, wrecker",865:"toyshop",866:"tractor",867:"trailer truck, tractor trailer, trucking rig, rig, articulated lorry, semi",868:"tray",869:"trench coat",870:"tricycle, trike, velocipede",871:"trimaran",872:"tripod",873:"triumphal arch",874:"trolleybus, trolley coach, trackless trolley",875:"trombone",876:"tub, vat",877:"turnstile",878:"typewriter keyboard",879:"umbrella",880:"unicycle, monocycle",881:"upright, upright piano",882:"vacuum, vacuum cleaner",883:"vase",884:"vault",885:"velvet",886:"vending machine",887:"vestment",888:"viaduct",889:"violin, fiddle",890:"volleyball",891:"waffle iron",892:"wall clock",893:"wallet, billfold, notecase, pocketbook",894:"wardrobe, closet, press",895:"warplane, military plane",896:"washbasin, handbasin, washbowl, lavabo, wash-hand basin",897:"washer, automatic washer, washing machine",898:"water bottle",899:"water jug",900:"water tower",901:"whiskey jug",902:"whistle",903:"wig",904:"window screen",905:"window shade",906:"Windsor tie",907:"wine bottle",908:"wing",909:"wok",910:"wooden spoon",911:"wool, woolen, woollen",912:"worm fence, snake fence, snake-rail fence, Virginia fence",913:"wreck",914:"yawl",915:"yurt",916:"web site, website, internet site, site",917:"comic book",918:"crossword puzzle, crossword",919:"street sign",920:"traffic light, traffic signal, stoplight",921:"book jacket, dust cover, dust jacket, dust wrapper",922:"menu",923:"plate",924:"guacamole",925:"consomme",926:"hot pot, hotpot",927:"trifle",928:"ice cream, icecream",929:"ice lolly, lolly, lollipop, popsicle",930:"French loaf",931:"bagel, beigel",932:"pretzel",933:"cheeseburger",934:"hotdog, hot dog, red hot",935:"mashed potato",936:"head cabbage",937:"broccoli",938:"cauliflower",939:"zucchini, courgette",940:"spaghetti squash",941:"acorn squash",942:"butternut squash",943:"cucumber, cuke",944:"artichoke, globe artichoke",945:"bell pepper",946:"cardoon",947:"mushroom",948:"Granny Smith",949:"strawberry",950:"orange",951:"lemon",952:"fig",953:"pineapple, ananas",954:"banana",955:"jackfruit, jak, jack",956:"custard apple",957:"pomegranate",958:"hay",959:"carbonara",960:"chocolate sauce, chocolate syrup",961:"dough",962:"meat loaf, meatloaf",963:"pizza, pizza pie",964:"potpie",965:"burrito",966:"red wine",967:"espresso",968:"cup",969:"eggnog",970:"alp",971:"bubble",972:"cliff, drop, drop-off",973:"coral reef",974:"geyser",975:"lakeside, lakeshore",976:"promontory, headland, head, foreland",977:"sandbar, sand bar",978:"seashore, coast, seacoast, sea-coast",979:"valley, vale",980:"volcano",981:"ballplayer, baseball player",982:"groom, bridegroom",983:"scuba diver",984:"rapeseed",985:"daisy",986:"yellow lady's slipper, yellow lady-slipper, Cypripedium calceolus, Cypripedium parviflorum",987:"corn",988:"acorn",989:"hip, rose hip, rosehip",990:"buckeye, horse chestnut, conker",991:"coral fungus",992:"agaric",993:"gyromitra",994:"stinkhorn, carrion fungus",995:"earthstar",996:"hen-of-the-woods, hen of the woods, Polyporus frondosus, Grifola frondosa",997:"bolete",998:"ear, spike, capitulum",999:"toilet tissue, toilet paper, bathroom tissue"},L4="2.1.1",y1=224,AB={"1.00":"module_apply_default/MobilenetV1/Logits/global_pool","2.00":"module_apply_default/MobilenetV2/Logits/AvgPool"},n3={"1.00":{.25:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_025_224/classification/1",inputRange:[0,1]},"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_050_224/classification/1",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_075_224/classification/1",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_100_224/classification/1",inputRange:[0,1]}},"2.00":{"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_050_224/classification/2",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_075_224/classification/2",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_100_224/classification/2",inputRange:[0,1]}}};function IB(l){return l===void 0&&(l={version:1,alpha:1}),Y7(this,void 0,void 0,function(){var i,o,u,c,f,y,w;return q7(this,function(C){switch(C.label){case 0:if(m==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(i=l.version.toFixed(2),o=l.alpha?l.alpha.toFixed(2):"",u=-1,c=1,l.modelUrl==null){if(!(i in n3))throw new Error("Invalid version of MobileNet. Valid versions are: "+Object.keys(n3));if(!(o in n3[i]))throw new Error("MobileNet constructed with invalid alpha "+l.alpha+". Valid multipliers for this version are: "+Object.keys(n3[i])+".");y=n3[i][o].inputRange,u=y[0],c=y[1]}return l.inputRange!=null&&(w=l.inputRange,u=w[0],c=w[1]),[4,(f=new aet(i,o,l.modelUrl,u,c)).load()];case 1:return C.sent(),[2,f]}})})}var aet=function(){function l(i,o,u,c,f){c===void 0&&(c=-1),f===void 0&&(f=1),this.version=i,this.alpha=o,this.modelUrl=u,this.inputMin=c,this.inputMax=f,this.normalizationConstant=(f-c)/255}return l.prototype.load=function(){return Y7(this,void 0,void 0,function(){var i,o,u,c,f=this;return q7(this,function(y){switch(y.label){case 0:return this.modelUrl?(i=this,[4,Vc(this.modelUrl)]):[3,2];case 1:return i.model=y.sent(),[3,4];case 2:return o=n3[this.version][this.alpha].url,u=this,[4,Vc(o,{fromTFHub:!0})];case 3:u.model=y.sent(),y.label=4;case 4:return[4,(c=(0,m.tidy)(function(){return f.model.predict((0,m.zeros)([1,y1,y1,3]))})).data()];case 5:return y.sent(),c.dispose(),[2]}})})},l.prototype.infer=function(i,o){var u=this;return o===void 0&&(o=!1),(0,m.tidy)(function(){i instanceof m.Tensor||(i=m.browser.fromPixels(i));var c=(0,m.add)((0,m.mul)((0,m.cast)(i,"float32"),u.normalizationConstant),u.inputMin),f=c;i.shape[0]===y1&&i.shape[1]===y1||(f=m.image.resizeBilinear(c,[y1,y1],!0));var y,w=(0,m.reshape)(f,[-1,y1,y1,3]);if(o){var C=AB[u.version],T=u.model.execute(w,C);y=(0,m.squeeze)(T,[1,2])}else{var x=u.model.predict(w);y=(0,m.slice)(x,[0,1],[-1,1e3])}return y})},l.prototype.classify=function(i,o){return o===void 0&&(o=3),Y7(this,void 0,void 0,function(){var u,c;return q7(this,function(f){switch(f.label){case 0:return[4,Km(u=this.infer(i),o)];case 1:return c=f.sent(),u.dispose(),[2,c]}})})},l}();function Km(l,i){return Y7(this,void 0,void 0,function(){var o,u,c,f,y,w,C;return q7(this,function(T){switch(T.label){case 0:return[4,(o=(0,m.softmax)(l)).data()];case 1:for(u=T.sent(),o.dispose(),c=[],C=0;C<u.length;C++)c.push({value:u[C],index:C});for(c.sort(function(x,A){return A.value-x.value}),f=new Float32Array(i),y=new Int32Array(i),C=0;C<i;C++)f[C]=c[C].value,y[C]=c[C].index;for(w=[],C=0;C<y.length;C++)w.push({className:iet[y[C]],probability:f[C]});return[2,w]}})})}function Zm(l,i,o,u=!1){return ce(this,null,function*(){let c=m.topk(l,i,!0),f=yield c.values.data(),y=yield c.indices.data(),w=Array.from(y).map((C,T)=>({confidence:f[T],label:o?o[C]:C.toString(10)}));return c.values.dispose(),c.indices.dispose(),!u&&l instanceof m.Tensor&&l.dispose(),w})}let eC=["kit fox","English setter","Siberian husky","Australian terrier","English springer","grey whale","lesser panda","Egyptian cat","ibex","Persian cat","cougar","gazelle","porcupine","sea lion","malamute","badger","Great Dane","Walker hound","Welsh springer spaniel","whippet","Scottish deerhound","killer whale","mink","African elephant","Weimaraner","soft-coated wheaten terrier","Dandie Dinmont","red wolf","Old English sheepdog","jaguar","otterhound","bloodhound","Airedale","hyena","meerkat","giant schnauzer","titi","three-toed sloth","sorrel","black-footed ferret","dalmatian","black-and-tan coonhound","papillon","skunk","Staffordshire bullterrier","Mexican hairless","Bouvier des Flandres","weasel","miniature poodle","Cardigan","malinois","bighorn","fox squirrel","colobus","tiger cat","Lhasa","impala","coyote","Yorkshire terrier","Newfoundland","brown bear","red fox","Norwegian elkhound","Rottweiler","hartebeest","Saluki","grey fox","schipperke","Pekinese","Brabancon griffon","West Highland white terrier","Sealyham terrier","guenon","mongoose","indri","tiger","Irish wolfhound","wild boar","EntleBucher","zebra","ram","French bulldog","orangutan","basenji","leopard","Bernese mountain dog","Maltese dog","Norfolk terrier","toy terrier","vizsla","cairn","squirrel monkey","groenendael","clumber","Siamese cat","chimpanzee","komondor","Afghan hound","Japanese spaniel","proboscis monkey","guinea pig","white wolf","ice bear","gorilla","borzoi","toy poodle","Kerry blue terrier","ox","Scotch terrier","Tibetan mastiff","spider monkey","Doberman","Boston bull","Greater Swiss Mountain dog","Appenzeller","Shih-Tzu","Irish water spaniel","Pomeranian","Bedlington terrier","warthog","Arabian camel","siamang","miniature schnauzer","collie","golden retriever","Irish terrier","affenpinscher","Border collie","hare","boxer","silky terrier","beagle","Leonberg","German short-haired pointer","patas","dhole","baboon","macaque","Chesapeake Bay retriever","bull mastiff","kuvasz","capuchin","pug","curly-coated retriever","Norwich terrier","flat-coated retriever","hog","keeshond","Eskimo dog","Brittany spaniel","standard poodle","Lakeland terrier","snow leopard","Gordon setter","dingo","standard schnauzer","hamster","Tibetan terrier","Arctic fox","wire-haired fox terrier","basset","water buffalo","American black bear","Angora","bison","howler monkey","hippopotamus","chow","giant panda","American Staffordshire terrier","Shetland sheepdog","Great Pyrenees","Chihuahua","tabby","marmoset","Labrador retriever","Saint Bernard","armadillo","Samoyed","bluetick","redbone","polecat","marmot","kelpie","gibbon","llama","miniature pinscher","wood rabbit","Italian greyhound","lion","cocker spaniel","Irish setter","dugong","Indian elephant","beaver","Sussex spaniel","Pembroke","Blenheim spaniel","Madagascar cat","Rhodesian ridgeback","lynx","African hunting dog","langur","Ibizan hound","timber wolf","cheetah","English foxhound","briard","sloth bear","Border terrier","German shepherd","otter","koala","tusker","echidna","wallaby","platypus","wombat","revolver","umbrella","schooner","soccer ball","accordion","ant","starfish","chambered nautilus","grand piano","laptop","strawberry","airliner","warplane","airship","balloon","space shuttle","fireboat","gondola","speedboat","lifeboat","canoe","yawl","catamaran","trimaran","container ship","liner","pirate","aircraft carrier","submarine","wreck","half track","tank","missile","bobsled","dogsled","bicycle-built-for-two","mountain bike","freight car","passenger car","barrow","shopping cart","motor scooter","forklift","electric locomotive","steam locomotive","amphibian","ambulance","beach wagon","cab","convertible","jeep","limousine","minivan","Model T","racer","sports car","go-kart","golfcart","moped","snowplow","fire engine","garbage truck","pickup","tow truck","trailer truck","moving van","police van","recreational vehicle","streetcar","snowmobile","tractor","mobile home","tricycle","unicycle","horse cart","jinrikisha","oxcart","bassinet","cradle","crib","four-poster","bookcase","china cabinet","medicine chest","chiffonier","table lamp","file","park bench","barber chair","throne","folding chair","rocking chair","studio couch","toilet seat","desk","pool table","dining table","entertainment center","wardrobe","Granny Smith","orange","lemon","fig","pineapple","banana","jackfruit","custard apple","pomegranate","acorn","hip","ear","rapeseed","corn","buckeye","organ","upright","chime","drum","gong","maraca","marimba","steel drum","banjo","cello","violin","harp","acoustic guitar","electric guitar","cornet","French horn","trombone","harmonica","ocarina","panpipe","bassoon","oboe","sax","flute","daisy","yellow lady's slipper","cliff","valley","alp","volcano","promontory","sandbar","coral reef","lakeside","seashore","geyser","hatchet","cleaver","letter opener","plane","power drill","lawn mower","hammer","corkscrew","can opener","plunger","screwdriver","shovel","plow","chain saw","cock","hen","ostrich","brambling","goldfinch","house finch","junco","indigo bunting","robin","bulbul","jay","magpie","chickadee","water ouzel","kite","bald eagle","vulture","great grey owl","black grouse","ptarmigan","ruffed grouse","prairie chicken","peacock","quail","partridge","African grey","macaw","sulphur-crested cockatoo","lorikeet","coucal","bee eater","hornbill","hummingbird","jacamar","toucan","drake","red-breasted merganser","goose","black swan","white stork","black stork","spoonbill","flamingo","American egret","little blue heron","bittern","crane","limpkin","American coot","bustard","ruddy turnstone","red-backed sandpiper","redshank","dowitcher","oystercatcher","European gallinule","pelican","king penguin","albatross","great white shark","tiger shark","hammerhead","electric ray","stingray","barracouta","coho","tench","goldfish","eel","rock beauty","anemone fish","lionfish","puffer","sturgeon","gar","loggerhead","leatherback turtle","mud turtle","terrapin","box turtle","banded gecko","common iguana","American chameleon","whiptail","agama","frilled lizard","alligator lizard","Gila monster","green lizard","African chameleon","Komodo dragon","triceratops","African crocodile","American alligator","thunder snake","ringneck snake","hognose snake","green snake","king snake","garter snake","water snake","vine snake","night snake","boa constrictor","rock python","Indian cobra","green mamba","sea snake","horned viper","diamondback","sidewinder","European fire salamander","common newt","eft","spotted salamander","axolotl","bullfrog","tree frog","tailed frog","whistle","wing","paintbrush","hand blower","oxygen mask","snorkel","loudspeaker","microphone","screen","mouse","electric fan","oil filter","strainer","space heater","stove","guillotine","barometer","rule","odometer","scale","analog clock","digital clock","wall clock","hourglass","sundial","parking meter","stopwatch","digital watch","stethoscope","syringe","magnetic compass","binoculars","projector","sunglasses","loupe","radio telescope","bow","cannon","assault rifle","rifle","projectile","computer keyboard","typewriter keyboard","crane","lighter","abacus","cash machine","slide rule","desktop computer","hand-held computer","notebook","web site","harvester","thresher","printer","slot","vending machine","sewing machine","joystick","switch","hook","car wheel","paddlewheel","pinwheel","potter's wheel","gas pump","carousel","swing","reel","radiator","puck","hard disc","sunglass","pick","car mirror","solar dish","remote control","disk brake","buckle","hair slide","knot","combination lock","padlock","nail","safety pin","screw","muzzle","seat belt","ski","candle","jack-o'-lantern","spotlight","torch","neck brace","pier","tripod","maypole","mousetrap","spider web","trilobite","harvestman","scorpion","black and gold garden spider","barn spider","garden spider","black widow","tarantula","wolf spider","tick","centipede","isopod","Dungeness crab","rock crab","fiddler crab","king crab","American lobster","spiny lobster","crayfish","hermit crab","tiger beetle","ladybug","ground beetle","long-horned beetle","leaf beetle","dung beetle","rhinoceros beetle","weevil","fly","bee","grasshopper","cricket","walking stick","cockroach","mantis","cicada","leafhopper","lacewing","dragonfly","damselfly","admiral","ringlet","monarch","cabbage butterfly","sulphur butterfly","lycaenid","jellyfish","sea anemone","brain coral","flatworm","nematode","conch","snail","slug","sea slug","chiton","sea urchin","sea cucumber","iron","espresso maker","microwave","Dutch oven","rotisserie","toaster","waffle iron","vacuum","dishwasher","refrigerator","washer","Crock Pot","frying pan","wok","caldron","coffeepot","teapot","spatula","altar","triumphal arch","patio","steel arch bridge","suspension bridge","viaduct","barn","greenhouse","palace","monastery","library","apiary","boathouse","church","mosque","stupa","planetarium","restaurant","cinema","home theater","lumbermill","coil","obelisk","totem pole","castle","prison","grocery store","bakery","barbershop","bookshop","butcher shop","confectionery","shoe shop","tobacco shop","toyshop","fountain","cliff dwelling","yurt","dock","brass","megalith","bannister","breakwater","dam","chainlink fence","picket fence","worm fence","stone wall","grille","sliding door","turnstile","mountain tent","scoreboard","honeycomb","plate rack","pedestal","beacon","mashed potato","bell pepper","head cabbage","broccoli","cauliflower","zucchini","spaghetti squash","acorn squash","butternut squash","cucumber","artichoke","cardoon","mushroom","shower curtain","jean","carton","handkerchief","sandal","ashcan","safe","plate","necklace","croquet ball","fur coat","thimble","pajama","running shoe","cocktail shaker","chest","manhole cover","modem","tub","tray","balance beam","bagel","prayer rug","kimono","hot pot","whiskey jug","knee pad","book jacket","spindle","ski mask","beer bottle","crash helmet","bottlecap","tile roof","mask","maillot","Petri dish","football helmet","bathing cap","teddy","holster","pop bottle","photocopier","vestment","crossword puzzle","golf ball","trifle","suit","water tower","feather boa","cloak","red wine","drumstick","shield","Christmas stocking","hoopskirt","menu","stage","bonnet","meat loaf","baseball","face powder","scabbard","sunscreen","beer glass","hen-of-the-woods","guacamole","lampshade","wool","hay","bow tie","mailbag","water jug","bucket","dishrag","soup bowl","eggnog","mortar","trench coat","paddle","chain","swab","mixing bowl","potpie","wine bottle","shoji","bulletproof vest","drilling platform","binder","cardigan","sweatshirt","pot","birdhouse","hamper","ping-pong ball","pencil box","pay-phone","consomme","apron","punching bag","backpack","groom","bearskin","pencil sharpener","broom","mosquito net","abaya","mortarboard","poncho","crutch","Polaroid camera","space bar","cup","racket","traffic light","quill","radio","dough","cuirass","military uniform","lipstick","shower cap","monitor","oscilloscope","mitten","brassiere","French loaf","vase","milk can","rugby ball","paper towel","earthstar","envelope","miniskirt","cowboy hat","trolleybus","perfume","bathtub","hotdog","coral fungus","bullet train","pillow","toilet tissue","cassette","carpenter's kit","ladle","stinkhorn","lotion","hair spray","academic gown","dome","crate","wig","burrito","pill bottle","chain mail","theater curtain","window shade","barrel","washbasin","ballpoint","basketball","bath towel","cowboy boot","gown","window screen","agaric","cellular telephone","nipple","barbell","mailbox","lab coat","fire screen","minibus","packet","maze","pole","horizontal bar","sombrero","pickelhaube","rain barrel","wallet","cassette player","comic book","piggy bank","street sign","bell cote","fountain pen","Windsor tie","volleyball","overskirt","sarong","purse","bolo tie","bib","parachute","sleeping bag","television","swimming trunks","measuring cup","espresso","pizza","breastplate","shopping basket","wooden spoon","saltshaker","chocolate sauce","ballplayer","goblet","gyromitra","stretcher","water bottle","dial telephone","soap dispenser","jersey","school bus","jigsaw puzzle","plastic bag","reflex camera","diaper","Band Aid","ice lolly","velvet","tennis ball","gasmask","doormat","Loafer","ice cream","pretzel","quilt","maillot","tape player","clog","iPod","bolete","scuba diver","pitcher","matchstick","bikini","sock","CD player","lens cap","thatch","vault","beaker","bubble","cheeseburger","parallel bars","flagpole","coffee mug","rubber eraser","stole","carbonara","dumbbell"],q0t="https://cdn.jsdelivr.net/gh/ml5js/ml5-data-and-models@master/models/darknetclassifier/darknetreference/model.json",cy="https://cdn.jsdelivr.net/gh/ml5js/ml5-data-and-models@master/models/darknetclassifier/darknettiny/model.json",nC=256,X7=224;class K7{constructor(i){switch(this.version=i,this.version){case"reference":this.imgSize=nC;break;case"tiny":this.imgSize=X7}}load(){return ce(this,null,function*(){switch(this.version){case"reference":this.model=yield Dd(q0t);break;case"tiny":this.model=yield Dd(cy)}let i=m.tidy(()=>this.model.predict(m.zeros([1,this.imgSize,this.imgSize,3])));yield i.data(),i.dispose()})}classify(i,o=3){return ce(this,null,function*(){let u=m.tidy(()=>{let c=function(y,w){let C;y instanceof m.Tensor?C=y:y instanceof HTMLImageElement||y instanceof HTMLVideoElement||y instanceof HTMLCanvasElement||y instanceof ImageData?C=m.browser.fromPixels(y):typeof y=="object"&&(y.elt instanceof HTMLImageElement||y.elt instanceof HTMLVideoElement||y.elt instanceof HTMLCanvasElement||y.elt instanceof ImageData)&&(C=m.browser.fromPixels(y.elt));let T=C.toFloat().div(m.scalar(255)),x=T;return(T.shape[0]!==w||T.shape[1]!==w)&&(x=m.image.resizeBilinear(T,[w,w],!0)),x.reshape([1,w,w,3])}(i,this.imgSize),f=this.model.predict(c);return m.softmax(f)});return Zm(u,o,eC)})}}function X0t(l){return ce(this,null,function*(){let{version:i}=l;if(i!=="reference"&&i!=="tiny")throw new Error("Please select a version: darknet-reference or darknet-tiny");let o=new K7(i);return yield o.load(),o})}let rC=["flashlight","belt","mushroom","pond","strawberry","pineapple","sun","cow","ear","bush","pliers","watermelon","apple","baseball","feather","shoe","leaf","lollipop","crown","ocean","horse","mountain","mosquito","mug","hospital","saw","castle","angel","underwear","traffic_light","cruise_ship","marker","blueberry","flamingo","face","hockey_stick","bucket","campfire","asparagus","skateboard","door","suitcase","skull","cloud","paint_can","hockey_puck","steak","house_plant","sleeping_bag","bench","snowman","arm","crayon","fan","shovel","leg","washing_machine","harp","toothbrush","tree","bear","rake","megaphone","knee","guitar","calculator","hurricane","grapes","paintbrush","couch","nose","square","wristwatch","penguin","bridge","octagon","submarine","screwdriver","rollerskates","ladder","wine_bottle","cake","bracelet","broom","yoga","finger","fish","line","truck","snake","bus","stitches","snorkel","shorts","bowtie","pickup_truck","tooth","snail","foot","crab","school_bus","train","dresser","sock","tractor","map","hedgehog","coffee_cup","computer","matches","beard","frog","crocodile","bathtub","rain","moon","bee","knife","boomerang","lighthouse","chandelier","jail","pool","stethoscope","frying_pan","cell_phone","binoculars","purse","lantern","birthday_cake","clarinet","palm_tree","aircraft_carrier","vase","eraser","shark","skyscraper","bicycle","sink","teapot","circle","tornado","bird","stereo","mouth","key","hot_dog","spoon","laptop","cup","bottlecap","The_Great_Wall_of_China","The_Mona_Lisa","smiley_face","waterslide","eyeglasses","ceiling_fan","lobster","moustache","carrot","garden","police_car","postcard","necklace","helmet","blackberry","beach","golf_club","car","panda","alarm_clock","t-shirt","dog","bread","wine_glass","lighter","flower","bandage","drill","butterfly","swan","owl","raccoon","squiggle","calendar","giraffe","elephant","trumpet","rabbit","trombone","sheep","onion","church","flip_flops","spreadsheet","pear","clock","roller_coaster","parachute","kangaroo","duck","remote_control","compass","monkey","rainbow","tennis_racquet","lion","pencil","string_bean","oven","star","cat","pizza","soccer_ball","syringe","flying_saucer","eye","cookie","floor_lamp","mouse","toilet","toaster","The_Eiffel_Tower","airplane","stove","cello","stop_sign","tent","diving_board","light_bulb","hammer","scorpion","headphones","basket","spider","paper_clip","sweater","ice_cream","envelope","sea_turtle","donut","hat","hourglass","broccoli","jacket","backpack","book","lightning","drums","snowflake","radio","banana","camel","canoe","toothpaste","chair","picture_frame","parrot","sandwich","lipstick","pants","violin","brain","power_outlet","triangle","hamburger","dragon","bulldozer","cannon","dolphin","zebra","animal_migration","camouflage","scissors","basketball","elbow","umbrella","windmill","table","rifle","hexagon","potato","anvil","sword","peanut","axe","television","rhinoceros","baseball_bat","speedboat","sailboat","zigzag","garden_hose","river","house","pillow","ant","tiger","stairs","cooler","see_saw","piano","fireplace","popsicle","dumbbell","mailbox","barn","hot_tub","teddy-bear","fork","dishwasher","peas","hot_air_balloon","keyboard","microwave","wheel","fire_hydrant","van","camera","whale","candle","octopus","pig","swing_set","helicopter","saxophone","passport","bat","ambulance","diamond","goatee","fence","grass","mermaid","motorbike","microphone","toe","cactus","nail","telephone","hand","squirrel","streetlight","bed","firetruck"],Z7="https://cdn.jsdelivr.net/gh/ml5js/ml5-data-and-models@master/models/doodlenet/model.json",NB=28;class oet{constructor(){this.imgSize=NB}load(){return ce(this,null,function*(){this.model=yield Dd(Z7);let i=m.tidy(()=>this.model.predict(m.zeros([1,this.imgSize,this.imgSize,1])));yield i.data(),i.dispose()})}classify(i,o=10){return ce(this,null,function*(){let u=m.tidy(()=>{let c=function(f,y){let w;f instanceof m.Tensor?w=f:f instanceof HTMLImageElement||f instanceof HTMLVideoElement||f instanceof HTMLCanvasElement||f instanceof ImageData?w=m.browser.fromPixels(f):typeof f=="object"&&(f.elt instanceof HTMLImageElement||f.elt instanceof HTMLVideoElement||f.elt instanceof HTMLCanvasElement||f.elt instanceof ImageData)&&(w=m.browser.fromPixels(f.elt));let C=m.scalar(1).sub(w.toFloat().div(m.scalar(255))),T=C;C.shape[0]===y&&C.shape[1]===y||(T=m.image.resizeBilinear(C,[y,y]));let[x,A,M]=m.split(T,3,3);return x.add(A).add(M).div(m.scalar(3)).floor().reshape([1,y,y,1])}(i,this.imgSize);return this.model.predict(c)});return Zm(u,o,rC)})}}function K0t(){return ce(this,null,function*(){let l=new oet;return yield l.load(),l})}let B0=["mobilenet","darknet","darknet-tiny","doodlenet"];class MB{constructor(i,o,u){if(this.model=null,this.mapStringToIndex=[],this.isClassifying=!1,this.signalStop=!1,this.prevCall="",typeof i=="string"&&function(c){let f;try{f=new URL(c)}catch{return!1}return f.protocol==="http:"||f.protocol==="https:"}(i))this.modelUrl=i,this.modelUrl.endsWith("/")&&(this.modelUrl+="model.json");else switch(this.modelUrl=null,this.modelName=Lm(i,B0,"mobilenet","imageClassifier"),this.modelName){case"mobilenet":this.modelToUse=Bt;let c=Ip(o,{version:{type:"enum",enums:[1,2],default:2},alpha:{type:"enum",enums:f=>f.version===1?[.25,.5,.75,1]:[.5,.75,1],default:1},topk:{type:"number",integer:!0,default:3}},"imageClassifier");this.version=c.version,this.alpha=c.alpha,this.topk=c.topk;break;case"darknet":this.version="reference",this.modelToUse=Xt;break;case"darknet-tiny":this.version="tiny",this.modelToUse=Xt;break;case"doodlenet":this.modelToUse=we;break;default:this.modelToUse=null}this.ready=Ws(this.loadModel(this.modelUrl),u)}loadModel(i){return ce(this,null,function*(){return yield m.ready(),this.model=i?yield this.loadModelFrom(i):yield this.modelToUse.load({version:this.version,alpha:this.alpha}),this})}loadModelFrom(i=null){return ce(this,null,function*(){try{let o;if(i!==null&&(o=(yield Ch.get(i)).data),o.ml5Specs&&(this.mapStringToIndex=o.ml5Specs.mapStringToIndex),this.mapStringToIndex.length===0){let u=i.split("/"),c=`${u.slice(0,u.length-1).join("/")}/metadata.json`,f=yield Ch.get(c).catch(y=>{console.log("Tried to fetch metadata.json, but it seems to be missing.",y)});if(f){let y=f.data;y.labels&&(this.mapStringToIndex=y.labels)}}return this.model=yield Dd(i),this.model}catch(o){return console.error(o),o}})}classifyInternal(i,o){return ce(this,null,function*(){yield this.ready,yield E0(i,!0);let u=[224,224];if((this.modelName=="doodlenet"||this.modelUrl)&&(i=rz(i,u)),this.modelUrl){yield m.nextFrame();let f=this.model.predict(i),y=yield f.as1D().data();return f.dispose(),Array.from(y).map((w,C)=>({label:this.mapStringToIndex.length>0&&this.mapStringToIndex[C]?this.mapStringToIndex[C]:C,confidence:w})).sort((w,C)=>C.confidence-w.confidence)}let c=yield this.model.classify(i,o);return this.modelName==="mobilenet"?c.map(f=>({label:f.className,confidence:f.probability})):c})}classify(i,o,u){return ce(this,null,function*(){let{image:c,number:f,callback:y}=Uu(i,o,u).require("image","No input image provided. If you want to classify a video, use classifyStart.");return Ws(this.classifyInternal(c,f||this.topk),y)})}classifyStart(i,o,u){return ce(this,null,function*(){let{image:c,number:f,callback:y}=Uu(i,o,u).require("image","No input provided."),w=()=>ce(this,null,function*(){yield E0(c,!0),yield Ws(this.classifyInternal(c,f||this.topk),y),this.signalStop?this.isClassifying=!1:requestAnimationFrame(w)});this.signalStop=!1,this.isClassifying||(this.isClassifying=!0,w()),this.prevCall==="start"&&console.warn("classifyStart() was called more than once without calling classifyStop(). Only the latest classifyStart() call will take effect."),this.prevCall="start"})}classifyStop(){this.isClassifying&&(this.signalStop=!0),this.prevCall="stop"}}let set=(l,i,o)=>{let u=Uu(l,i,o),{string:c,options:f={},callback:y}=u;return new MB(c,f,y)};var uet=F(7006),cet=function(l,i){return(cet=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var c in u)u.hasOwnProperty(c)&&(o[c]=u[c])})(l,i)},Q7=function(){return(Q7=Object.assign||function(l){for(var i,o=1,u=arguments.length;o<u;o++)for(var c in i=arguments[o])Object.prototype.hasOwnProperty.call(i,c)&&(l[c]=i[c]);return l}).apply(this,arguments)};function pu(l,i,o,u){return new(o||(o=Promise))(function(c,f){function y(T){try{C(u.next(T))}catch(x){f(x)}}function w(T){try{C(u.throw(T))}catch(x){f(x)}}function C(T){var x;T.done?c(T.value):(x=T.value,x instanceof o?x:new o(function(A){A(x)})).then(y,w)}C((u=u.apply(l,[])).next())})}function mu(l,i){var o,u,c,f,y={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return f={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function w(C){return function(T){return function(x){if(o)throw new TypeError("Generator is already executing.");for(;y;)try{if(o=1,u&&(c=2&x[0]?u.return:x[0]?u.throw||((c=u.return)&&c.call(u),0):u.next)&&!(c=c.call(u,x[1])).done)return c;switch(u=0,c&&(x=[2&x[0],c.value]),x[0]){case 0:case 1:c=x;break;case 4:return y.label++,{value:x[1],done:!1};case 5:y.label++,u=x[1],x=[0];continue;case 7:x=y.ops.pop(),y.trys.pop();continue;default:if(!(c=(c=y.trys).length>0&&c[c.length-1])&&(x[0]===6||x[0]===2)){y=0;continue}if(x[0]===3&&(!c||x[1]>c[0]&&x[1]<c[3])){y.label=x[1];break}if(x[0]===6&&y.label<c[1]){y.label=c[1],c=x;break}if(c&&y.label<c[2]){y.label=c[2],y.ops.push(x);break}c[2]&&y.ops.pop(),y.trys.pop();continue}x=i.call(l,y)}catch(A){x=[6,A],u=0}finally{o=c=0}if(5&x[0])throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}([C,T])}}}function Nh(l){var i=typeof Symbol=="function"&&Symbol.iterator,o=i&&l[i],u=0;if(o)return o.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&u>=l.length&&(l=void 0),{value:l&&l[u++],done:!l}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")}function J7(l,i){var o=typeof Symbol=="function"&&l[Symbol.iterator];if(!o)return l;var u,c,f=o.call(l),y=[];try{for(;(i===void 0||i-- >0)&&!(u=f.next()).done;)y.push(u.value)}catch(w){c={error:w}}finally{try{u&&!u.done&&(o=f.return)&&o.call(f)}finally{if(c)throw c.error}}return y}function Rp(){for(var l=[],i=0;i<arguments.length;i++)l=l.concat(J7(arguments[i]));return l}function DB(l){return pu(this,void 0,void 0,function(){var i,o,u,c,f;return mu(this,function(y){switch(y.label){case 0:return i="file://",l.indexOf("http://")!==0&&l.indexOf("https://")!==0?[3,3]:[4,fetch(l)];case 1:return[4,y.sent().json()];case 2:return[2,y.sent()];case 3:return l.indexOf(i)!==0?[3,5]:(o=F(7571),u=(0,uet.promisify)(o.readFile),f=(c=JSON).parse,[4,u(l.slice(i.length),{encoding:"utf-8"})]);case 4:return[2,f.apply(c,[y.sent()])];case 5:throw new Error("Unsupported URL scheme in metadata URL: "+l+". Supported schemes are: http://, https://, and (node.js-only) file://")}})})}var tc=null;function sd(l){return tc==null&&(tc=(0,m.backend)().epsilon()),(0,m.tidy)(function(){var i=(0,m.moments)(l),o=i.mean,u=i.variance;return(0,m.div)((0,m.sub)(l,o),(0,m.add)((0,m.sqrt)(u),tc))})}function het(l){if(l.length<2)throw new Error("Cannot normalize a Float32Array with fewer than 2 elements.");return tc==null&&(tc=(0,m.backend)().epsilon()),(0,m.tidy)(function(){var i=(0,m.moments)((0,m.tensor1d)(l)),o=i.mean,u=i.variance,c=o.arraySync(),f=Math.sqrt(u.arraySync()),y=Array.from(l).map(function(w){return(w-c)/(f+tc)});return new Float32Array(y)})}function RB(l){return pu(this,void 0,void 0,function(){return mu(this,function(i){return[2,navigator.mediaDevices.getUserMedia({audio:l==null||l,video:!1})]})})}var Qm=function(){function l(i){var o=this;if(i==null)throw new Error("Required configuration object is missing for BrowserFftFeatureExtractor constructor");if(i.spectrogramCallback==null)throw new Error("spectrogramCallback cannot be null or undefined");if(!(i.numFramesPerSpectrogram>0))throw new Error("Invalid value in numFramesPerSpectrogram: "+i.numFramesPerSpectrogram);if(i.suppressionTimeMillis<0)throw new Error("Expected suppressionTimeMillis to be >= 0, but got "+i.suppressionTimeMillis);if(this.suppressionTimeMillis=i.suppressionTimeMillis,this.spectrogramCallback=i.spectrogramCallback,this.numFrames=i.numFramesPerSpectrogram,this.sampleRateHz=i.sampleRateHz||44100,this.fftSize=i.fftSize||1024,this.frameDurationMillis=this.fftSize/this.sampleRateHz*1e3,this.columnTruncateLength=i.columnTruncateLength||this.fftSize,this.overlapFactor=i.overlapFactor,this.includeRawAudio=i.includeRawAudio,m.util.assert(this.overlapFactor>=0&&this.overlapFactor<1,function(){return"Expected overlapFactor to be >= 0 and < 1, but got "+o.overlapFactor}),this.columnTruncateLength>this.fftSize)throw new Error("columnTruncateLength "+this.columnTruncateLength+" exceeds fftSize ("+this.fftSize+").");this.audioContextConstructor=window.AudioContext||window.webkitAudioContext}return l.prototype.start=function(i){return pu(this,void 0,void 0,function(){var o,u,c;return mu(this,function(f){switch(f.label){case 0:if(this.frameIntervalTask!=null)throw new Error("Cannot start already-started BrowserFftFeatureExtractor");return o=this,[4,RB(i)];case 1:return o.stream=f.sent(),this.audioContext=new this.audioContextConstructor({sampleRate:this.sampleRateHz}),u=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=0,u.connect(this.analyser),this.freqDataQueue=[],this.freqData=new Float32Array(this.fftSize),this.includeRawAudio&&(this.timeDataQueue=[],this.timeData=new Float32Array(this.fftSize)),c=Math.max(1,Math.round(this.numFrames*(1-this.overlapFactor))),this.tracker=new fet(c,Math.round(this.suppressionTimeMillis/this.frameDurationMillis)),this.frameIntervalTask=setInterval(this.onAudioFrame.bind(this),this.fftSize/this.sampleRateHz*1e3),[2]}})})},l.prototype.onAudioFrame=function(){return pu(this,void 0,void 0,function(){var i,o,u,c;return mu(this,function(f){switch(f.label){case 0:return this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0?[2]:(this.freqDataQueue.push(this.freqData.slice(0,this.columnTruncateLength)),this.includeRawAudio&&(this.analyser.getFloatTimeDomainData(this.timeData),this.timeDataQueue.push(this.timeData.slice())),this.freqDataQueue.length>this.numFrames&&this.freqDataQueue.shift(),this.tracker.tick()?(i=det(this.freqDataQueue),o=j0(i,[1,this.numFrames,this.columnTruncateLength,1]),u=void 0,this.includeRawAudio&&(c=det(this.timeDataQueue),u=j0(c,[1,this.numFrames*this.fftSize])),[4,this.spectrogramCallback(o,u)]):[3,2]);case 1:f.sent()&&this.tracker.suppress(),(0,m.dispose)([o,u]),f.label=2;case 2:return[2]}})})},l.prototype.stop=function(){return pu(this,void 0,void 0,function(){return mu(this,function(i){if(this.frameIntervalTask==null)throw new Error("Cannot stop because there is no ongoing streaming activity.");return clearInterval(this.frameIntervalTask),this.frameIntervalTask=null,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop(),[2]})})},l.prototype.setConfig=function(i){throw new Error("setConfig() is not implemented for BrowserFftFeatureExtractor.")},l.prototype.getFeatures=function(){throw new Error("getFeatures() is not implemented for BrowserFftFeatureExtractor. Use the spectrogramCallback field of the constructor config instead.")},l}();function det(l){var i=l[0].length,o=new Float32Array(l.length*i);return l.forEach(function(u,c){return o.set(u,c*i)}),o}function j0(l,i){var o=new Float32Array(m.util.sizeFromShape(i));return o.set(l,o.length-l.length),(0,m.tensor)(o,i)}var fet=function(){function l(i,o){var u=this;this.period=i,this.suppressionTime=o??0,this.counter=0,m.util.assert(this.period>0,function(){return"Expected period to be positive, but got "+u.period})}return l.prototype.tick=function(){return this.counter++,this.counter%this.period==0&&(this.suppressionOnset==null||this.counter-this.suppressionOnset>this.suppressionTime)},l.prototype.suppress=function(){this.suppressionOnset=this.counter},l}();function r3(l){var i=0;l.forEach(function(c){i+=c.byteLength});var o=new Uint8Array(i),u=0;return l.forEach(function(c){o.set(new Uint8Array(c),u),u+=c.byteLength}),o.buffer}function pet(l){var i=0;l.forEach(function(c){return i+=c.length});var o=new Float32Array(i),u=0;return l.forEach(function(c){o.set(c,u),u+=c.length}),o}function tN(l){if(l==null)throw new Error("Received null or undefind string");for(var i=unescape(encodeURIComponent(l)),o=new Uint8Array(i.length),u=0;u<i.length;++u)o[u]=i.charCodeAt(u);return o.buffer}function iC(l){if(l==null)throw new Error("Received null or undefind buffer");var i=new Uint8Array(l);return decodeURIComponent(escape(String.fromCharCode.apply(String,Rp(i))))}var $4="TFJSSCDS",i3="_background_noise_",aC=function(){function l(i){if(this.examples={},this.label2Ids={},i!=null)for(var o=function(w){m.util.assert(w!=null,function(){return"Received null or undefined buffer"});var C=0,T=iC(w.slice(C,8));m.util.assert(T===$4,function(){return"Deserialization error: Invalid descriptor"}),C+=8,C+=4;var x=new Uint32Array(w,C,1),A=C+=4;C=A+x[0];var M=iC(w.slice(A,C));return{manifest:JSON.parse(M),data:w.slice(C)}}(i),u=0,c=0;c<o.manifest.length;++c){var f=o.manifest[c],y=f.spectrogramNumFrames*f.spectrogramFrameSize;f.rawAudioNumSamples!=null&&(y+=f.rawAudioNumSamples),y*=4,this.addExample(eN({spec:f,data:o.data.slice(u,u+y)})),u+=y}}return l.prototype.addExample=function(i){m.util.assert(i!=null,function(){return"Got null or undefined example"}),m.util.assert(i.label!=null&&i.label.length>0,function(){return"Expected label to be a non-empty string, but got "+JSON.stringify(i.label)});var o=function(){function u(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return u()+u()+"-"+u()+"-"+u()+"-"+u()+"-"+u()+u()+u()}();return this.examples[o]=i,i.label in this.label2Ids||(this.label2Ids[i.label]=[]),this.label2Ids[i.label].push(o),o},l.prototype.merge=function(i){var o,u,c,f;m.util.assert(i!==this,function(){return"Cannot merge a dataset into itself"});var y=i.getVocabulary();try{for(var w=Nh(y),C=w.next();!C.done;C=w.next()){var T=C.value,x=i.getExamples(T);try{for(var A=(c=void 0,Nh(x)),M=A.next();!M.done;M=A.next()){var $=M.value;this.addExample($.example)}}catch(V){c={error:V}}finally{try{M&&!M.done&&(f=A.return)&&f.call(A)}finally{if(c)throw c.error}}}}catch(V){o={error:V}}finally{try{C&&!C.done&&(u=w.return)&&u.call(w)}finally{if(o)throw o.error}}},l.prototype.getExampleCounts=function(){var i={};for(var o in this.examples){var u=this.examples[o];u.label in i||(i[u.label]=0),i[u.label]++}return i},l.prototype.getExamples=function(i){var o=this;m.util.assert(i!=null,function(){return"Expected label to be a string, but got "+JSON.stringify(i)}),m.util.assert(i in this.label2Ids,function(){return'No example of label "'+i+'" exists in dataset'});var u=[];return this.label2Ids[i].forEach(function(c){u.push({uid:c,example:o.examples[c]})}),u},l.prototype.getData=function(i,o){var u=this;m.util.assert(this.size()>0,function(){return"Cannot get spectrograms as tensors because the dataset is empty"});var c=this.getVocabulary();i!=null?m.util.assert(c.indexOf(i)!==-1,function(){return"Label "+i+" is not in the vocabulary ("+JSON.stringify(c)+")"}):m.util.assert(c.length>1,function(){return"One-hot encoding of labels requires the vocabulary to have at least two words, but it has only "+c.length+" word."}),o==null&&(o={});var f,y,w=this.getSortedUniqueNumFrames();w.length===1?(f=o.numFrames==null?w[0]:o.numFrames,y=o.hopFrames==null?1:o.hopFrames):(f=o.numFrames,m.util.assert(f!=null&&Number.isInteger(f)&&f>0,function(){return"There are "+w.length+" unique lengths among the "+u.size()+" examples of this Dataset, hence numFrames is required. But it is not provided."}),m.util.assert(f<=w[0],function(){return"numFrames ("+f+") exceeds the minimum numFrames ("+w[0]+") among the examples of the Dataset."}),y=o.hopFrames,m.util.assert(y!=null&&Number.isInteger(y)&&y>0,function(){return"There are "+w.length+" unique lengths among the "+u.size()+" examples of this Dataset, hence hopFrames is required. But it is not provided."}));var C=o.normalize==null||o.normalize;return(0,m.tidy)(function(){for(var T,x,A,M=[],$=[],V=[],G=0;G<c.length;++G){var Q=c[G];if(i==null||Q===i){var nt=u.label2Ids[Q],it=function(Nn){var kr,Tr,Ar=u.examples[Nn].spectrogram,Dr=Ar.frameSize;A==null?A=Dr:m.util.assert(Dr===A,function(){return"Mismatch in frameSize  ("+Dr+" vs "+A+")"});var Ni=Ar.data.length/Dr,Mi=null;Q!==i3&&(Mi=Ar.keyFrameIndex==null?rN(Ar).dataSync()[0]:Ar.keyFrameIndex);var Yi=(0,m.tensor3d)(Ar.data,[Ni,Dr,1]),Hr=nN(Ni,Mi,f,y),wa=function(ta){var xa=(0,m.tidy)(function(){var Ka=(0,m.slice)(Yi,[ta[0],0,0],[ta[1]-ta[0],-1,-1]);return C?sd(Ka):Ka});o.getDataset?$.push(xa.dataSync()):M.push(xa),i==null&&V.push(G)};try{for(var Oa=(kr=void 0,Nh(Hr)),Xa=Oa.next();!Xa.done;Xa=Oa.next())wa(Xa.value)}catch(ta){kr={error:ta}}finally{try{Xa&&!Xa.done&&(Tr=Oa.return)&&Tr.call(Oa)}finally{if(kr)throw kr.error}}(0,m.dispose)(Yi)};try{for(var ht=(T=void 0,Nh(nt)),kt=ht.next();!kt.done;kt=ht.next())it(kt.value)}catch(Nn){T={error:Nn}}finally{try{kt&&!kt.done&&(x=ht.return)&&x.call(ht)}finally{if(T)throw T.error}}}}o.augmentByMixingNoiseRatio!=null&&u.augmentByMixingNoise(o.getDataset?$:M,V,o.augmentByMixingNoiseRatio);var Nt=o.shuffle==null||o.shuffle;if(o.getDataset){var $t=o.datasetBatchSize==null?32:o.datasetBatchSize,Ut=o.datasetValidationSplit==null?.15:o.datasetValidationSplit;m.util.assert(Ut>0&&Ut<1,function(){return"Invalid dataset validation split: "+Ut});var Pt=$.map(function(Nn,kr){return[Nn,V[kr]]});m.util.shuffle(Pt),$=Pt.map(function(Nn){return Nn[0]});var re=Pt.map(function(Nn){return Nn[1]}),ue=function(Nn,kr,Tr){var Ar,Dr,Ni,Mi,Yi,Hr,wa,Oa;m.util.assert(Tr>0&&Tr<1,function(){return"validationSplit is expected to be >0 and <1, but got "+Tr});for(var Xa=!Array.isArray(Nn[0]),ta=kr,xa=[],Ka=0;Ka<ta.length;++Ka){var nu=ta[Ka];xa[nu]==null&&(xa[nu]=[]),xa[nu].push(Ka)}var Ol=xa.length,Wu=[],vo=[];for(xa.map(function(os){return m.util.shuffle(os)}),Ka=0;Ka<Ol;++Ka)for(var eh=xa[Ka],Ll=Math.round(eh.length*(1-Tr)),Cu=0;Cu<eh.length;++Cu)Cu<Ll?Wu.push(eh[Cu]):vo.push(eh[Cu]);if(Xa){var Vu=[],bl=[],$l=[],Zd=[];try{for(var ld=Nh(Wu),Qd=ld.next();!Qd.done;Qd=ld.next()){var kc=Qd.value;Vu.push(Nn[kc]),bl.push(kr[kc])}}catch(os){Ar={error:os}}finally{try{Qd&&!Qd.done&&(Dr=ld.return)&&Dr.call(ld)}finally{if(Ar)throw Ar.error}}try{for(var Jd=Nh(vo),Op=Jd.next();!Op.done;Op=Jd.next())kc=Op.value,$l.push(Nn[kc]),Zd.push(kr[kc])}catch(os){Ni={error:os}}finally{try{Op&&!Op.done&&(Mi=Jd.return)&&Mi.call(Jd)}finally{if(Ni)throw Ni.error}}return{trainXs:Vu,trainYs:bl,valXs:$l,valYs:Zd}}Vu=[],bl=[],$l=[],Zd=[];try{for(var Sc=Nh(Wu),ru=Sc.next();!ru.done;ru=Sc.next())kc=ru.value,Vu.push(Nn[kc]),bl.push(kr[kc])}catch(os){Yi={error:os}}finally{try{ru&&!ru.done&&(Hr=Sc.return)&&Hr.call(Sc)}finally{if(Yi)throw Yi.error}}try{for(var fy=Nh(vo),nh=fy.next();!nh.done;nh=fy.next())kc=nh.value,$l.push(Nn[kc]),Zd.push(kr[kc])}catch(os){wa={error:os}}finally{try{nh&&!nh.done&&(Oa=fy.return)&&Oa.call(fy)}finally{if(wa)throw wa.error}}return{trainXs:Vu,trainYs:bl,valXs:$l,valYs:Zd}}($,re,Ut),be=ue.trainXs,De=ue.trainYs,ze=ue.valXs,Qe=ue.valYs,cn=k2(be).map(function(Nn){return(0,m.tensor3d)(Nn,[f,A,1])}),en=k2(De).map(function(Nn){return(0,m.squeeze)((0,m.oneHot)([Nn],c.length),[0])}),sn=SS({xs:cn,ys:en});Nt&&(sn=sn.shuffle($.length)),sn=sn.batch($t).prefetch(4);var xn=k2(ze).map(function(Nn){return(0,m.tensor3d)(Nn,[f,A,1])}),Rn=k2(Qe).map(function(Nn){return(0,m.squeeze)((0,m.oneHot)([Nn],c.length),[0])}),Bn=SS({xs:xn,ys:Rn});return[sn,Bn=Bn.batch($t).prefetch(4)]}if(Nt){var Fn=[];M.forEach(function(Nn,kr){Fn.push({x:Nn,y:V[kr]})}),m.util.shuffle(Fn),M=Fn.map(function(Nn){return Nn.x}),V=Fn.map(function(Nn){return Nn.y})}var Xn=i==null?(0,m.cast)((0,m.oneHot)((0,m.tensor1d)(V,"int32"),c.length),"float32"):void 0;return{xs:(0,m.stack)(M),ys:Xn}})},l.prototype.augmentByMixingNoise=function(i,o,u){var c,f;if(i==null||i.length===0)throw new Error("Cannot perform augmentation because data is null or empty");for(var y=i[0]instanceof Float32Array,w=this.getVocabulary(),C=[],T=[],x=0;x<o.length;++x)w[o[x]]===i3?C.push(x):T.push(x);if(C.length===0)throw new Error("Cannot perform augmentation by mixing with noise when there is no example with label "+i3);var A=[],M=[],$=function(Q){var nt=C[function(Nt,$t){return Math.floor(($t-Nt)*Math.random())+Nt}(0,C.length)],it=y?(0,m.tensor1d)(i[Q]):i[Q],ht=y?(0,m.tensor1d)(i[nt]):i[nt],kt=(0,m.tidy)(function(){return sd((0,m.add)(it,(0,m.mul)(ht,u)))});y?A.push(kt.dataSync()):A.push(kt),M.push(o[Q])};try{for(var V=Nh(T),G=V.next();!G.done;G=V.next())$(G.value)}catch(Q){c={error:Q}}finally{try{G&&!G.done&&(f=V.return)&&f.call(V)}finally{if(c)throw c.error}}console.log("Data augmentation: mixing noise: added "+A.length+" examples"),A.forEach(function(Q){return i.push(Q)}),o.push.apply(o,Rp(M))},l.prototype.getSortedUniqueNumFrames=function(){for(var i,o,u=new Set,c=this.getVocabulary(),f=0;f<c.length;++f){var y=c[f],w=this.label2Ids[y];try{for(var C=(i=void 0,Nh(w)),T=C.next();!T.done;T=C.next()){var x=T.value,A=this.examples[x].spectrogram,M=A.data.length/A.frameSize;u.add(M)}}catch(V){i={error:V}}finally{try{T&&!T.done&&(o=C.return)&&o.call(C)}finally{if(i)throw i.error}}}var $=Rp(u);return $.sort(),$},l.prototype.removeExample=function(i){if(!(i in this.examples))throw new Error("Nonexistent example UID: "+i);var o=this.examples[i].label;delete this.examples[i];var u=this.label2Ids[o].indexOf(i);this.label2Ids[o].splice(u,1),this.label2Ids[o].length===0&&delete this.label2Ids[o]},l.prototype.setExampleKeyFrameIndex=function(i,o){if(!(i in this.examples))throw new Error("Nonexistent example UID: "+i);var u=this.examples[i].spectrogram,c=u.data.length/u.frameSize;m.util.assert(o>=0&&o<c&&Number.isInteger(o),function(){return"Invalid keyFrameIndex: "+o+". Must be >= 0, < "+c+", and an integer."}),u.keyFrameIndex=o},l.prototype.size=function(){return Object.keys(this.examples).length},l.prototype.durationMillis=function(){var i=0;for(var o in this.examples){var u=this.examples[o].spectrogram,c=23.22|u.frameDurationMillis;i+=u.data.length/u.frameSize*c}return i},l.prototype.empty=function(){return this.size()===0},l.prototype.clear=function(){this.examples={}},l.prototype.getVocabulary=function(){var i=new Set;for(var o in this.examples){var u=this.examples[o];i.add(u.label)}var c=Rp(i);return c.sort(),c},l.prototype.serialize=function(i){var o,u,c,f,y=this.getVocabulary();m.util.assert(!this.empty(),function(){return"Cannot serialize empty Dataset"}),i!=null&&(Array.isArray(i)||(i=[i]),i.forEach(function(nt){if(y.indexOf(nt)===-1)throw new Error('Word label "'+nt+'" does not exist in the vocabulary of this dataset. The vocabulary is: '+JSON.stringify(y)+".")}));var w=[],C=[];try{for(var T=Nh(y),x=T.next();!x.done;x=T.next()){var A=x.value;if(i==null||i.indexOf(A)!==-1){var M=this.label2Ids[A];try{for(var $=(c=void 0,Nh(M)),V=$.next();!V.done;V=$.next()){var G=V.value,Q=met(this.examples[G]);w.push(Q.spec),C.push(Q.data)}}catch(nt){c={error:nt}}finally{try{V&&!V.done&&(f=$.return)&&f.call($)}finally{if(c)throw c.error}}}}}catch(nt){o={error:nt}}finally{try{x&&!x.done&&(u=T.return)&&u.call(T)}finally{if(o)throw o.error}}return function(nt){var it=tN(JSON.stringify(nt.manifest)),ht=tN($4),kt=new Uint32Array([1]),Nt=new Uint32Array([it.byteLength]);return r3([r3([ht,kt.buffer,Nt.buffer]),it,nt.data])}({manifest:w,data:r3(C)})},l}();function met(l){var i=l.rawAudio!=null,o={label:l.label,spectrogramNumFrames:l.spectrogram.data.length/l.spectrogram.frameSize,spectrogramFrameSize:l.spectrogram.frameSize};l.spectrogram.keyFrameIndex!=null&&(o.spectrogramKeyFrameIndex=l.spectrogram.keyFrameIndex);var u=l.spectrogram.data.buffer.slice(0);return i&&(o.rawAudioNumSamples=l.rawAudio.data.length,o.rawAudioSampleRateHz=l.rawAudio.sampleRateHz,u=r3([u,l.rawAudio.data.buffer])),{spec:o,data:u}}function eN(l){var i={frameSize:l.spec.spectrogramFrameSize,data:new Float32Array(l.data.slice(0,4*l.spec.spectrogramFrameSize*l.spec.spectrogramNumFrames))};l.spec.spectrogramKeyFrameIndex!=null&&(i.keyFrameIndex=l.spec.spectrogramKeyFrameIndex);var o={label:l.spec.label,spectrogram:i};return l.spec.rawAudioNumSamples!=null&&(o.rawAudio={sampleRateHz:l.spec.rawAudioSampleRateHz,data:new Float32Array(l.data.slice(4*l.spec.spectrogramFrameSize*l.spec.spectrogramNumFrames))}),o}function nN(l,i,o,u){if(m.util.assert(Number.isInteger(l)&&l>0,function(){return"snippetLength must be a positive integer, but got "+l}),i!=null&&m.util.assert(Number.isInteger(i)&&i>=0,function(){return"focusIndex must be a non-negative integer, but got "+i}),m.util.assert(Number.isInteger(o)&&o>0,function(){return"windowLength must be a positive integer, but got "+o}),m.util.assert(Number.isInteger(u)&&u>0,function(){return"windowHop must be a positive integer, but got "+u}),m.util.assert(o<=l,function(){return"windowLength ("+o+") exceeds snippetLength ("+l+")"}),m.util.assert(i<l,function(){return"focusIndex ("+i+") equals or exceeds snippetLength ("+l+")"}),o===l)return[[0,l]];var c=[];if(i==null){for(var f=0;f+o<=l;)c.push([f,f+o]),f+=u;return c}var y=Math.floor(o/2),w=i-y;for(w<0?w=0:w+o>l&&(w=l-o);!(w-u<0||i>=w-u+o);)w-=u;for(;w+o<=l&&!(i<w);)c.push([w,w+o]),w+=u;return c}function rN(l){return(0,m.tidy)(function(){return(0,m.argMax)(function(i){return(0,m.tidy)(function(){var o=i.data.length/i.frameSize,u=(0,m.tensor2d)(i.data,[o,i.frameSize]);return(0,m.mean)(u,-1)})}(l))})}var get="0.5.4",oC="tfjs-speech-commands-saved-model-metadata",sC="indexeddb://tfjs-speech-commands-model/",uC={localStorage:typeof window>"u"?null:window.localStorage},z4=.25,FB=function(){function l(i,o,u){this.MODEL_URL_PREFIX="https://storage.googleapis.com/tfjs-models/tfjs/speech-commands/v"+function(c){return c.split(".").slice(0,2).join(".")}(get)+"/browser_fft",this.SAMPLE_RATE_HZ=44100,this.FFT_SIZE=1024,this.DEFAULT_SUPPRESSION_TIME_MILLIS=0,this.streaming=!1,this.transferRecognizers={},m.util.assert(o==null&&u==null||o!=null&&u!=null,function(){return"modelURL and metadataURL must be both provided or both not provided."}),o==null?(i==null?i=l.DEFAULT_VOCABULARY_NAME:m.util.assert(l.VALID_VOCABULARY_NAMES.indexOf(i)!==-1,function(){return"Invalid vocabulary name: '"+i+"'"}),this.vocabulary=i,this.modelArtifactsOrURL=this.MODEL_URL_PREFIX+"/"+this.vocabulary+"/model.json",this.metadataOrURL=this.MODEL_URL_PREFIX+"/"+this.vocabulary+"/metadata.json"):(m.util.assert(i==null,function(){return"vocabulary name must be null or undefined when modelURL is provided"}),this.modelArtifactsOrURL=o,this.metadataOrURL=u),this.parameters={sampleRateHz:this.SAMPLE_RATE_HZ,fftSize:this.FFT_SIZE}}return l.prototype.listen=function(i,o){return pu(this,void 0,void 0,function(){var u,c,f,y,w,C=this;return mu(this,function(T){switch(T.label){case 0:if(this.streaming)throw new Error("Cannot start streaming again when streaming is ongoing.");return[4,this.ensureModelLoaded()];case 1:if(T.sent(),o==null&&(o={}),u=o.probabilityThreshold==null?0:o.probabilityThreshold,o.includeEmbedding&&(u=0),m.util.assert(u>=0&&u<=1,function(){return"Invalid probabilityThreshold value: "+u}),c=o.invokeCallbackOnNoiseAndUnknown!=null&&o.invokeCallbackOnNoiseAndUnknown,o.includeEmbedding&&(c=!0),o.suppressionTimeMillis<0)throw new Error("suppressionTimeMillis is expected to be >= 0, but got "+o.suppressionTimeMillis);return f=o.overlapFactor==null?.5:o.overlapFactor,m.util.assert(f>=0&&f<1,function(){return"Expected overlapFactor to be >= 0 and < 1, but got "+f}),y=function(x,A){return pu(C,void 0,void 0,function(){var M,$,V,G,Q,nt,it,ht,kt,Nt,$t;return mu(this,function(Ut){switch(Ut.label){case 0:return M=sd(x),o.includeEmbedding?[4,this.ensureModelWithEmbeddingOutputCreated()]:[3,2];case 1:return Ut.sent(),$t=J7(this.modelWithEmbeddingOutput.predict(M),2),$=$t[0],V=$t[1],[3,3];case 2:$=this.model.predict(M),Ut.label=3;case 3:return[4,$.data()];case 4:return G=Ut.sent(),[4,(Q=$.argMax(-1)).data()];case 5:return nt=Ut.sent()[0],it=Math.max.apply(Math,Rp(G)),(0,m.dispose)([$,Q,M]),it<u?[2,!1]:[3,6];case 6:return ht=void 0,o.includeSpectrogram?(kt={},[4,x.data()]):[3,8];case 7:kt.data=Ut.sent(),kt.frameSize=this.nonBatchInputShape[1],ht=kt,Ut.label=8;case 8:return Nt=!0,c||this.words[nt]!==i3&&this.words[nt]!=="_unknown_"||(Nt=!1),Nt&&i({scores:G,spectrogram:ht,embedding:V}),[2,Nt]}})})},w=o.suppressionTimeMillis==null?this.DEFAULT_SUPPRESSION_TIME_MILLIS:o.suppressionTimeMillis,this.audioDataExtractor=new Qm({sampleRateHz:this.parameters.sampleRateHz,numFramesPerSpectrogram:this.nonBatchInputShape[0],columnTruncateLength:this.nonBatchInputShape[1],suppressionTimeMillis:w,spectrogramCallback:y,overlapFactor:f}),[4,this.audioDataExtractor.start(o.audioTrackConstraints)];case 2:return T.sent(),this.streaming=!0,[2]}})})},l.prototype.ensureModelLoaded=function(){return pu(this,void 0,void 0,function(){var i,o,u,c,f=this;return mu(this,function(y){switch(y.label){case 0:return this.model!=null?[2]:[4,this.ensureMetadataLoaded()];case 1:return y.sent(),typeof this.modelArtifactsOrURL!="string"?[3,3]:[4,Dd(this.modelArtifactsOrURL)];case 2:return i=y.sent(),[3,5];case 3:return[4,Dd(m.io.fromMemory(this.modelArtifactsOrURL.modelTopology,this.modelArtifactsOrURL.weightSpecs,this.modelArtifactsOrURL.weightData))];case 4:i=y.sent(),y.label=5;case 5:if(i.inputs.length!==1)throw new Error("Expected model to have 1 input, but got a model with "+i.inputs.length+" inputs");if(i.inputs[0].shape.length!==4)throw new Error("Expected model to have an input shape of rank 4, but got an input shape of rank "+i.inputs[0].shape.length);if(i.inputs[0].shape[3]!==1)throw new Error("Expected model to have an input shape with 1 as the last dimension, but got input shape"+JSON.stringify(i.inputs[0].shape[3])+"}");if((o=i.outputShape).length!==2)throw new Error("Expected loaded model to have an output shape of rank 2,but received shape "+JSON.stringify(o));if(o[1]!==this.words.length)throw new Error("Mismatch between the last dimension of model's output shape ("+o[1]+") and number of words ("+this.words.length+").");return this.model=i,this.freezeModel(),this.nonBatchInputShape=i.inputs[0].shape.slice(1),this.elementsPerExample=1,i.inputs[0].shape.slice(1).forEach(function(w){return f.elementsPerExample*=w}),this.warmUpModel(),u=this.parameters.fftSize/this.parameters.sampleRateHz*1e3,c=i.inputs[0].shape[1],this.parameters.spectrogramDurationMillis=c*u,[2]}})})},l.prototype.ensureModelWithEmbeddingOutputCreated=function(){return pu(this,void 0,void 0,function(){var i,o;return mu(this,function(u){switch(u.label){case 0:return this.modelWithEmbeddingOutput!=null?[2]:[4,this.ensureModelLoaded()];case 1:for(u.sent(),o=this.model.layers.length-2;o>=0;--o)if(this.model.layers[o].getClassName()==="Dense"){i=this.model.layers[o];break}if(i==null)throw new Error("Failed to find second last dense layer in the original model.");return this.modelWithEmbeddingOutput=SR({inputs:this.model.inputs,outputs:[this.model.outputs[0],i.output]}),[2]}})})},l.prototype.warmUpModel=function(){var i=this;(0,m.tidy)(function(){for(var o=(0,m.zeros)([1].concat(i.nonBatchInputShape)),u=0;u<3;++u)i.model.predict(o)})},l.prototype.ensureMetadataLoaded=function(){return pu(this,void 0,void 0,function(){var i,o,u;return mu(this,function(c){switch(c.label){case 0:return this.words!=null?[2]:typeof this.metadataOrURL!="string"?[3,2]:[4,DB(this.metadataOrURL)];case 1:return o=c.sent(),[3,3];case 2:o=this.metadataOrURL,c.label=3;case 3:if((i=o).wordLabels==null){if((u=i.words)==null)throw new Error('Cannot find field "words" or "wordLabels" in metadata JSON file');this.words=u}else this.words=i.wordLabels;return[2]}})})},l.prototype.stopListening=function(){return pu(this,void 0,void 0,function(){return mu(this,function(i){switch(i.label){case 0:if(!this.streaming)throw new Error("Cannot stop streaming when streaming is not ongoing.");return[4,this.audioDataExtractor.stop()];case 1:return i.sent(),this.streaming=!1,[2]}})})},l.prototype.isListening=function(){return this.streaming},l.prototype.wordLabels=function(){return this.words},l.prototype.params=function(){return this.parameters},l.prototype.modelInputShape=function(){if(this.model==null)throw new Error("Model has not been loaded yet. Load model by calling ensureModelLoaded(), recognize(), or listen().");return this.model.inputs[0].shape},l.prototype.recognize=function(i,o){return pu(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M,$,V,G;return mu(this,function(Q){switch(Q.label){case 0:return o==null&&(o={}),[4,this.ensureModelLoaded()];case 1:return Q.sent(),i!=null?[3,3]:[4,this.recognizeOnline()];case 2:u=Q.sent(),i=u.data,Q.label=3;case 3:if(i instanceof m.Tensor)this.checkInputTensorShape(i),f=i,c=i.shape[0];else{if(i.length%this.elementsPerExample)throw new Error("The length of the input Float32Array "+i.length+" is not divisible by the number of tensor elements per per example expected by the model "+this.elementsPerExample+".");c=i.length/this.elementsPerExample,f=(0,m.tensor4d)(i,[c].concat(this.nonBatchInputShape))}return w={scores:null},o.includeEmbedding?[4,this.ensureModelWithEmbeddingOutputCreated()]:[3,5];case 4:return Q.sent(),C=this.modelWithEmbeddingOutput.predict(f),y=C[0],w.embedding=C[1],[3,6];case 5:y=this.model.predict(f),Q.label=6;case 6:return c!==1?[3,8]:(T=w,[4,y.data()]);case 7:return T.scores=Q.sent(),[3,10];case 8:return x=(0,m.unstack)(y),A=x.map(function(nt){return nt.data()}),M=w,[4,Promise.all(A)];case 9:M.scores=Q.sent(),(0,m.dispose)(x),Q.label=10;case 10:return o.includeSpectrogram?($=w,V={},i instanceof m.Tensor?[4,i.data()]:[3,12]):[3,14];case 11:return G=Q.sent(),[3,13];case 12:G=i,Q.label=13;case 13:$.spectrogram=(V.data=G,V.frameSize=this.nonBatchInputShape[1],V),Q.label=14;case 14:return(0,m.dispose)(y),[2,w]}})})},l.prototype.recognizeOnline=function(){return pu(this,void 0,void 0,function(){var i=this;return mu(this,function(o){return[2,new Promise(function(u,c){i.audioDataExtractor=new Qm({sampleRateHz:i.parameters.sampleRateHz,numFramesPerSpectrogram:i.nonBatchInputShape[0],columnTruncateLength:i.nonBatchInputShape[1],suppressionTimeMillis:0,spectrogramCallback:function(f){return pu(i,void 0,void 0,function(){var y,w,C;return mu(this,function(T){switch(T.label){case 0:return y=sd(f),[4,this.audioDataExtractor.stop()];case 1:return T.sent(),w=u,C={},[4,y.data()];case 2:return w.apply(void 0,[(C.data=T.sent(),C.frameSize=this.nonBatchInputShape[1],C)]),y.dispose(),[2,!1]}})})},overlapFactor:0}),i.audioDataExtractor.start()})]})})},l.prototype.createTransfer=function(i){if(this.model==null)throw new Error("Model has not been loaded yet. Load model by calling ensureModelLoaded(), recognizer(), or listen().");m.util.assert(i!=null&&typeof i=="string"&&i.length>1,function(){return"Expected the name for a transfer-learning recognized to be a non-empty string, but got "+JSON.stringify(i)}),m.util.assert(this.transferRecognizers[i]==null,function(){return"There is already a transfer-learning model named '"+i+"'"});var o=new yet(i,this.parameters,this.model);return this.transferRecognizers[i]=o,o},l.prototype.freezeModel=function(){var i,o;try{for(var u=Nh(this.model.layers),c=u.next();!c.done;c=u.next())c.value.trainable=!1}catch(f){i={error:f}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}},l.prototype.checkInputTensorShape=function(i){var o=this.model.inputs[0].shape.length;if(i.shape.length!==o)throw new Error("Expected input Tensor to have rank "+o+", but got rank "+i.shape.length+" that differs ");var u=i.shape.slice(1),c=this.model.inputs[0].shape.slice(1);if(!m.util.arraysEqual(u,c))throw new Error("Expected input to have shape [null,"+c+"], but got shape [null,"+u+"]")},l.VALID_VOCABULARY_NAMES=["18w","directional4w"],l.DEFAULT_VOCABULARY_NAME="18w",l}(),yet=function(l){function i(o,u,c){var f=l.call(this)||this;return f.name=o,f.parameters=u,f.baseModel=c,m.util.assert(o!=null&&typeof o=="string"&&o.length>0,function(){return"The name of a transfer model must be a non-empty string, but got "+JSON.stringify(o)}),f.nonBatchInputShape=f.baseModel.inputs[0].shape.slice(1),f.words=null,f.dataset=new aC,f}return function(o,u){function c(){this.constructor=o}cet(o,u),o.prototype=u===null?Object.create(u):(c.prototype=u.prototype,new c)}(i,l),i.prototype.collectExample=function(o,u){return pu(this,void 0,void 0,function(){var c,f,y,w,C=this;return mu(this,function(T){if(m.util.assert(!this.streaming,function(){return"Cannot start collection of transfer-learning example because a streaming recognition or transfer-learning example collection is ongoing"}),m.util.assert(o!=null&&typeof o=="string"&&o.length>0,function(){return"Must provide a non-empty string when collecting transfer-learning example"}),u==null&&(u={}),u.durationMultiplier!=null&&u.durationSec!=null)throw new Error("durationMultiplier and durationSec are mutually exclusive, but are both specified.");return u.durationSec!=null?(m.util.assert(u.durationSec>0,function(){return"Expected durationSec to be > 0, but got "+u.durationSec}),f=this.parameters.fftSize/this.parameters.sampleRateHz,c=Math.ceil(u.durationSec/f)):u.durationMultiplier!=null?(m.util.assert(u.durationMultiplier>=1,function(){return"Expected duration multiplier to be >= 1, but got "+u.durationMultiplier}),c=Math.round(this.nonBatchInputShape[0]*u.durationMultiplier)):c=this.nonBatchInputShape[0],u.snippetDurationSec!=null&&(m.util.assert(u.snippetDurationSec>0,function(){return"snippetDurationSec is expected to be > 0, but got "+u.snippetDurationSec}),m.util.assert(u.onSnippet!=null,function(){return"onSnippet must be provided if snippetDurationSec is provided."})),u.onSnippet!=null&&m.util.assert(u.snippetDurationSec!=null,function(){return"snippetDurationSec must be provided if onSnippet is provided."}),y=this.parameters.fftSize/this.parameters.sampleRateHz,w=y*c,this.streaming=!0,[2,new Promise(function(x){var A=u.snippetDurationSec==null?1:u.snippetDurationSec/w,M=1-A,$=Math.round(1/A),V=0,G=-1,Q=[];C.audioDataExtractor=new Qm({sampleRateHz:C.parameters.sampleRateHz,numFramesPerSpectrogram:c,columnTruncateLength:C.nonBatchInputShape[1],suppressionTimeMillis:0,spectrogramCallback:function(nt,it){return pu(C,void 0,void 0,function(){var ht,kt,Nt,$t,Ut,Pt,re,ue,be,De,ze,Qe,cn,en,sn,xn,Rn,Bn,Fn,Xn;return mu(this,function(Nn){switch(Nn.label){case 0:return u.onSnippet!=null?[3,7]:(ht=sd(nt),Nt=(kt=this.dataset).addExample,$t={label:o},Ut={},[4,ht.data()]);case 1:return $t.spectrogram=(Ut.data=Nn.sent(),Ut.frameSize=this.nonBatchInputShape[1],Ut),u.includeRawAudio?(re={},[4,it.data()]):[3,3];case 2:return re.data=Nn.sent(),re.sampleRateHz=this.audioDataExtractor.sampleRateHz,Pt=re,[3,4];case 3:Pt=void 0,Nn.label=4;case 4:return Nt.apply(kt,[($t.rawAudio=Pt,$t)]),ht.dispose(),[4,this.audioDataExtractor.stop()];case 5:return Nn.sent(),this.streaming=!1,this.collateTransferWords(),ue=x,be={},[4,nt.data()];case 6:return ue.apply(void 0,[(be.data=Nn.sent(),be.frameSize=this.nonBatchInputShape[1],be)]),[3,13];case 7:return[4,nt.data()];case 8:for(De=Nn.sent(),G===-1&&(G=De.length),ze=G-1;De[ze]!==0&&ze>=0;)ze--;return Qe=G-ze-1,G=ze+1,cn=De.slice(De.length-Qe,De.length),Q.push(cn),u.onSnippet!=null&&u.onSnippet({data:cn,frameSize:this.nonBatchInputShape[1]}),V++!==$?[3,13]:[4,this.audioDataExtractor.stop()];case 9:return Nn.sent(),this.streaming=!1,this.collateTransferWords(),en=het(pet(Q)),sn={data:en,frameSize:this.nonBatchInputShape[1]},Rn=(xn=this.dataset).addExample,Bn={label:o,spectrogram:sn},u.includeRawAudio?(Xn={},[4,it.data()]):[3,11];case 10:return Xn.data=Nn.sent(),Xn.sampleRateHz=this.audioDataExtractor.sampleRateHz,Fn=Xn,[3,12];case 11:Fn=void 0,Nn.label=12;case 12:Rn.apply(xn,[(Bn.rawAudio=Fn,Bn)]),x(sn),Nn.label=13;case 13:return[2,!1]}})})},overlapFactor:M,includeRawAudio:u.includeRawAudio}),C.audioDataExtractor.start(u.audioTrackConstraints)})]})})},i.prototype.clearExamples=function(){var o=this;m.util.assert(this.words!=null&&this.words.length>0&&!this.dataset.empty(),function(){return"No transfer learning examples exist for model name "+o.name}),this.dataset.clear(),this.words=null},i.prototype.countExamples=function(){if(this.dataset.empty())throw new Error("No examples have been collected for transfer-learning model named '"+this.name+"' yet.");return this.dataset.getExampleCounts()},i.prototype.getExamples=function(o){return this.dataset.getExamples(o)},i.prototype.setExampleKeyFrameIndex=function(o,u){this.dataset.setExampleKeyFrameIndex(o,u)},i.prototype.removeExample=function(o){this.dataset.removeExample(o),this.collateTransferWords()},i.prototype.isDatasetEmpty=function(){return this.dataset.empty()},i.prototype.loadExamples=function(o,u){var c,f,y,w;u===void 0&&(u=!1);var C=new aC(o);u&&this.clearExamples();var T=C.getVocabulary();try{for(var x=Nh(T),A=x.next();!A.done;A=x.next()){var M=A.value,$=C.getExamples(M);try{for(var V=(y=void 0,Nh($)),G=V.next();!G.done;G=V.next()){var Q=G.value;this.dataset.addExample(Q.example)}}catch(nt){y={error:nt}}finally{try{G&&!G.done&&(w=V.return)&&w.call(V)}finally{if(y)throw y.error}}}}catch(nt){c={error:nt}}finally{try{A&&!A.done&&(f=x.return)&&f.call(x)}finally{if(c)throw c.error}}this.collateTransferWords()},i.prototype.serializeExamples=function(o){return this.dataset.serialize(o)},i.prototype.collateTransferWords=function(){this.words=this.dataset.getVocabulary()},i.prototype.collectTransferDataAsTensors=function(o,u){var c=this.nonBatchInputShape[0];o=o||z4;var f=Math.round(o*c),y=this.dataset.getData(null,Q7({numFrames:c,hopFrames:f},u));return{xs:y.xs,ys:y.ys}},i.prototype.collectTransferDataAsTfDataset=function(o,u,c,f){u===void 0&&(u=.15),c===void 0&&(c=32);var y=this.nonBatchInputShape[0];o=o||z4;var w=Math.round(o*y);return this.dataset.getData(null,Q7({numFrames:y,hopFrames:w,getDataset:!0,datasetBatchSize:c,datasetValidationSplit:u},f))},i.prototype.train=function(o){return pu(this,void 0,void 0,function(){var u,c=this;return mu(this,function(f){return m.util.assert(this.words!=null&&this.words.length>0,function(){return"Cannot train transfer-learning model '"+c.name+"' because no transfer learning example has been collected."}),m.util.assert(this.words.length>1,function(){return"Cannot train transfer-learning model '"+c.name+"' because only 1 word label ('"+JSON.stringify(c.words)+"') has been collected for transfer learning. Requires at least 2."}),o.fineTuningEpochs!=null&&m.util.assert(o.fineTuningEpochs>=0&&Number.isInteger(o.fineTuningEpochs),function(){return"If specified, fineTuningEpochs must be a non-negative integer, but received "+o.fineTuningEpochs}),o==null&&(o={}),this.model==null&&this.createTransferModelFromBaseModel(),this.secondLastBaseDenseLayer.trainable=!1,this.model.compile({loss:"categoricalCrossentropy",optimizer:o.optimizer||"sgd",metrics:["acc"]}),u=o.fitDatasetDurationMillisThreshold==null?6e4:o.fitDatasetDurationMillisThreshold,this.dataset.durationMillis()>u?(console.log("Detected large dataset: total duration = "+this.dataset.durationMillis()+" ms > "+u+" ms. Training transfer model using fitDataset() instead of fit()"),[2,this.trainOnDataset(o)]):[2,this.trainOnTensors(o)]})})},i.prototype.trainOnDataset=function(o){return pu(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A;return mu(this,function(M){switch(M.label){case 0:return m.util.assert(o.epochs>0,function(){return"Invalid config.epochs"}),u=o.batchSize==null?32:o.batchSize,c=o.windowHopRatio||z4,f=J7(this.collectTransferDataAsTfDataset(c,o.validationSplit,u,{augmentByMixingNoiseRatio:o.augmentByMixingNoiseRatio}),2),y=f[0],w=f[1],C=m.util.now(),[4,this.model.fitDataset(y,{epochs:o.epochs,validationData:o.validationSplit>0?w:null,callbacks:o.callback==null?null:[o.callback]})];case 1:return T=M.sent(),console.log("fitDataset() took "+(m.util.now()-C).toFixed(2)+" ms"),o.fineTuningEpochs!=null&&o.fineTuningEpochs>0?(x=m.util.now(),[4,this.fineTuningUsingTfDatasets(o,y,w)]):[3,3];case 2:return A=M.sent(),console.log("fitDataset() (fine-tuning) took "+(m.util.now()-x).toFixed(2)+" ms"),[2,[T,A]];case 3:return[2,T]}})})},i.prototype.trainOnTensors=function(o){return pu(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M;return mu(this,function($){switch($.label){case 0:u=o.windowHopRatio||z4,c=this.collectTransferDataAsTensors(u,{augmentByMixingNoiseRatio:o.augmentByMixingNoiseRatio}),f=c.xs,y=c.ys,console.log("Training data: xs.shape = "+f.shape+", ys.shape = "+y.shape),$.label=1;case 1:return $.trys.push([1,,6,7]),o.validationSplit!=null?(x=function(V,G,Q){return m.util.assert(Q>0&&Q<1,function(){return"validationSplit is expected to be >0 and <1, but got "+Q}),(0,m.tidy)(function(){for(var nt=(0,m.argMax)(G,-1).dataSync(),it=[],ht=0;ht<nt.length;++ht){var kt=nt[ht];it[kt]==null&&(it[kt]=[]),it[kt].push(ht)}var Nt=it.length,$t=[],Ut=[];for(it.map(function(be){return m.util.shuffle(be)}),ht=0;ht<Nt;++ht)for(var Pt=it[ht],re=Math.round(Pt.length*(1-Q)),ue=0;ue<Pt.length;++ue)ue<re?$t.push(Pt[ue]):Ut.push(Pt[ue]);return{trainXs:(0,m.gather)(V,$t),trainYs:(0,m.gather)(G,$t),valXs:(0,m.gather)(V,Ut),valYs:(0,m.gather)(G,Ut)}})}(f,y,o.validationSplit),w=x.trainXs,C=x.trainYs,T=[x.valXs,x.valYs]):(w=f,C=y),[4,this.model.fit(w,C,{epochs:o.epochs==null?20:o.epochs,validationData:T,batchSize:o.batchSize,callbacks:o.callback==null?null:[o.callback]})];case 2:return A=$.sent(),o.fineTuningEpochs!=null&&o.fineTuningEpochs>0?[4,this.fineTuningUsingTensors(o,w,C,T)]:[3,4];case 3:return M=$.sent(),[2,[A,M]];case 4:return[2,A];case 5:return[3,7];case 6:return(0,m.dispose)([f,y,w,C,T]),[7];case 7:return[2]}})})},i.prototype.fineTuningUsingTfDatasets=function(o,u,c){return pu(this,void 0,void 0,function(){var f,y,w;return mu(this,function(C){switch(C.label){case 0:return f=this.secondLastBaseDenseLayer.trainable,this.secondLastBaseDenseLayer.trainable=!0,y=o.fineTuningOptimizer==null?"sgd":o.fineTuningOptimizer,this.model.compile({loss:"categoricalCrossentropy",optimizer:y,metrics:["acc"]}),[4,this.model.fitDataset(u,{epochs:o.fineTuningEpochs,validationData:c,callbacks:o.callback==null?null:[o.callback]})];case 1:return w=C.sent(),this.secondLastBaseDenseLayer.trainable=f,[2,w]}})})},i.prototype.fineTuningUsingTensors=function(o,u,c,f){return pu(this,void 0,void 0,function(){var y,w,C;return mu(this,function(T){switch(T.label){case 0:return y=this.secondLastBaseDenseLayer.trainable,this.secondLastBaseDenseLayer.trainable=!0,w=o.fineTuningOptimizer==null?"sgd":o.fineTuningOptimizer,this.model.compile({loss:"categoricalCrossentropy",optimizer:w,metrics:["acc"]}),[4,this.model.fit(u,c,{epochs:o.fineTuningEpochs,validationData:f,batchSize:o.batchSize,callbacks:o.fineTuningCallback==null?null:[o.fineTuningCallback]})];case 1:return C=T.sent(),this.secondLastBaseDenseLayer.trainable=y,[2,C]}})})},i.prototype.evaluate=function(o){return pu(this,void 0,void 0,function(){var u=this;return mu(this,function(c){return m.util.assert(o.wordProbThresholds!=null&&o.wordProbThresholds.length>0,function(){return"Received null or empty wordProbThresholds"}),m.util.assert(this.words[0]===i3,function(){return"Cannot perform evaluation when the first tag is not "+i3}),[2,(0,m.tidy)(function(){for(var f=[],y=0,w=u.collectTransferDataAsTensors(o.windowHopRatio),C=w.xs,T=w.ys.argMax(-1).dataSync(),x=u.model.predict(C),A=(0,m.max)((0,m.slice)(x,[0,1],[x.shape[0],x.shape[1]-1]),-1),M=x.shape[0],$=0;$<o.wordProbThresholds.length;++$){for(var V=o.wordProbThresholds[$],G=A.greater((0,m.scalar)(V)).dataSync(),Q=0,nt=0,it=0,ht=0,kt=0;kt<M;++kt)T[kt]===0?(Q++,G[kt]&&it++):(nt++,G[kt]&&ht++);var Nt=it/Q,$t=ht/nt;f.push({probThreshold:V,fpr:Nt,tpr:$t}),console.log("ROC thresh="+V+": fpr="+Nt.toFixed(4)+", tpr="+$t.toFixed(4)),$>0&&(y+=Math.abs(f[$-1].fpr-f[$].fpr)*(f[$-1].tpr+f[$].tpr)/2)}return{rocCurve:f,auc:y}})]})})},i.prototype.createTransferModelFromBaseModel=function(){var o=this;m.util.assert(this.words!=null,function(){return"No word example is available for tranfer-learning model of name "+o.name});for(var u=this.baseModel.layers,c=u.length-2;c>=0&&u[c].getClassName().toLowerCase()!=="dense";)c--;if(c<0)throw new Error("Cannot find a hidden dense layer in the base model.");this.secondLastBaseDenseLayer=u[c];var f=this.secondLastBaseDenseLayer.output;this.transferHead=sE(),this.transferHead.add(Fg({units:this.words.length,activation:"softmax",inputShape:f.shape.slice(1),name:"NewHeadDense"}));var y=this.transferHead.apply(f);this.model=SR({inputs:this.baseModel.inputs,outputs:y})},i.prototype.modelInputShape=function(){return this.baseModel.inputs[0].shape},i.prototype.getMetadata=function(){return{tfjsSpeechCommandsVersion:get,modelName:this.name,timeStamp:new Date().toISOString(),wordLabels:this.wordLabels()}},i.prototype.save=function(o){return pu(this,void 0,void 0,function(){var u,c,f;return mu(this,function(y){return u=o!=null,o=o||OB(this.name),u||(c=uC.localStorage.getItem(oC),(f=c==null?{}:JSON.parse(c))[this.name]=this.getMetadata(),uC.localStorage.setItem(oC,JSON.stringify(f))),console.log("Saving model to "+o),[2,this.model.save(o)]})})},i.prototype.load=function(o){return pu(this,void 0,void 0,function(){var u,c,f;return mu(this,function(y){switch(y.label){case 0:if(u=o!=null,o=o||OB(this.name),!u){if((c=JSON.parse(uC.localStorage.getItem(oC)))==null||c[this.name]==null)throw new Error("Cannot find metadata for transfer model named "+this.name+'"');this.words=c[this.name].wordLabels,console.log("Loaded word list for model named "+this.name+": "+this.words)}return f=this,[4,Dd(o)];case 1:return f.model=y.sent(),console.log("Loaded model from "+o+":"),this.model.summary(),[2]}})})},i.prototype.createTransfer=function(o){throw new Error("Creating transfer-learned recognizer from a transfer-learned recognizer is not supported.")},i}(FB);function OB(l){return""+sC+l}function vet(l,i,o,u){if(m.util.assert(o==null&&u==null||o!=null&&u!=null,function(){return"customModelURL and customMetadataURL must be both provided or both not provided."}),o!=null&&m.util.assert(i==null,function(){return"vocabulary name must be null or undefined when modelURL is provided."}),l==="BROWSER_FFT")return new FB(i,o,u)}class lC{constructor(i){this.options=i}load(i){return ce(this,null,function*(){if(i){let o=i4(i);this.model=vet("BROWSER_FFT",void 0,o.modelUrl,o.metadataUrl)}else this.model=vet("BROWSER_FFT");yield this.model.ensureModelLoaded(),this.allLabels=this.model.wordLabels()})}classify(i=this.allLabels.length,o){return this.model.listen(u=>ce(this,null,function*(){if(u.scores){let c=yield Zm(u.scores,i,this.allLabels);return P4.signalStop?(this.model.stopListening(),void(P4.isClassifying=!1)):o(c)}return o(null,`ERROR: Cannot find scores in result: ${u}`)}),this.options).catch(u=>o(null,`ERROR: ${u.message}`))}}function bet(l,i){return ce(this,null,function*(){let o=new lC(l);return yield o.load(i),o})}let LB=["speechcommands18w"],P4;class wet{constructor(i,o,u){this.model=null,this.options=o,this.isClassifying=!1,this.signalStop=!1,this.prevCall="",typeof i=="string"&&(LB.includes(i)?(this.modelName=i,this.modelUrl=null,this.modelName==="speechcommands18w"?this.modelToUse=ie:this.modelToUse=null):(this.modelToUse=ie,this.modelUrl=i)),this.ready=Ws(this.loadModel(o,this.modelUrl),u)}loadModel(i){return ce(this,null,function*(){return yield m.ready(),this.model=yield this.modelToUse.load(i,this.modelUrl),this})}classifyInternal(i,o){return ce(this,null,function*(){return yield this.ready,yield m.nextFrame(),this.model.classify(i,o)})}classifyStart(i=null,o){return ce(this,null,function*(){let u=Uu(i,o),c=u.number||this.topk;if(this.signalStop=!1,!this.isClassifying)return this.isClassifying=!0,this.classifyInternal(c,u.callback);this.prevCall==="start"&&console.warn("classifyStart() was called more than once without calling classifyStop(). Only the latest classifyStart() call will take effect."),this.prevCall="start"})}classifyStop(){this.isClassifying&&(this.signalStop=!0),this.prevCall="stop"}}let $B=(l,i,o)=>{let{string:u,options:c={},callback:f}=Uu(l,i,o).require("string",'Please specify a model to use. E.g: "SpeechCommands18w"'),y=u;return y.indexOf("http")===-1&&(y=y.toLowerCase()),P4=new wet(y,c,f),P4};var zB=F(9958),cC=function(l,i){return cC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var c in u)u.hasOwnProperty(c)&&(o[c]=u[c])},cC(l,i)};function PB(l,i){function o(){this.constructor=l}cC(l,i),l.prototype=i===null?Object.create(i):(o.prototype=i.prototype,new o)}var xc=function(){return xc=Object.assign||function(l){for(var i,o=1,u=arguments.length;o<u;o++)for(var c in i=arguments[o])Object.prototype.hasOwnProperty.call(i,c)&&(l[c]=i[c]);return l},xc.apply(this,arguments)};function jo(l,i,o,u){return new(o||(o=Promise))(function(c,f){function y(T){try{C(u.next(T))}catch(x){f(x)}}function w(T){try{C(u.throw(T))}catch(x){f(x)}}function C(T){var x;T.done?c(T.value):(x=T.value,x instanceof o?x:new o(function(A){A(x)})).then(y,w)}C((u=u.apply(l,[])).next())})}function as(l,i){var o,u,c,f,y={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return f={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function w(C){return function(T){return function(x){if(o)throw new TypeError("Generator is already executing.");for(;y;)try{if(o=1,u&&(c=2&x[0]?u.return:x[0]?u.throw||((c=u.return)&&c.call(u),0):u.next)&&!(c=c.call(u,x[1])).done)return c;switch(u=0,c&&(x=[2&x[0],c.value]),x[0]){case 0:case 1:c=x;break;case 4:return y.label++,{value:x[1],done:!1};case 5:y.label++,u=x[1],x=[0];continue;case 7:x=y.ops.pop(),y.trys.pop();continue;default:if(!((c=(c=y.trys).length>0&&c[c.length-1])||x[0]!==6&&x[0]!==2)){y=0;continue}if(x[0]===3&&(!c||x[1]>c[0]&&x[1]<c[3])){y.label=x[1];break}if(x[0]===6&&y.label<c[1]){y.label=c[1],c=x;break}if(c&&y.label<c[2]){y.label=c[2],y.ops.push(x);break}c[2]&&y.ops.pop(),y.trys.pop();continue}x=i.call(l,y)}catch(A){x=[6,A],u=0}finally{o=c=0}if(5&x[0])throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}([C,T])}}}function hC(l){return l instanceof SVGAnimatedLength?l.baseVal.value:l}function iN(l){return jo(this,void 0,void 0,function(){var i,o;return as(this,function(u){switch(u.label){case 0:return i=document.createElement("canvas"),l instanceof m.Tensor?[4,m.browser.toPixels(l,i)]:[3,2];case 1:return u.sent(),[3,3];case 2:i.width=hC(l.width),i.height=hC(l.height),o=i.getContext("2d"),l instanceof ImageData?o.putImageData(l,0,0):o.drawImage(l,0,0),u.label=3;case 3:return[2,i]}})})}function BB(l){return jo(this,void 0,void 0,function(){var i,o,u,c,f,y;return as(this,function(w){switch(w.label){case 0:return l instanceof m.Tensor?(i=l.shape.slice(0,2),o=i[0],u=i[1],c=ImageData.bind,[4,m.browser.toPixels(l)]):[3,2];case 1:return[2,new(c.apply(ImageData,[void 0,w.sent(),u,o]))];case 2:return f=document.createElement("canvas"),y=f.getContext("2d"),f.width=hC(l.width),f.height=hC(l.height),y.drawImage(l,0,0),[2,y.getImageData(0,0,f.width,f.height)]}})})}function jB(l){return jo(this,void 0,void 0,function(){var i,o;return as(this,function(u){switch(u.label){case 0:return l instanceof SVGImageElement||l instanceof OffscreenCanvas?[4,iN(l)]:[3,2];case 1:return o=u.sent(),[3,3];case 2:o=l,u.label=3;case 3:return i=o,[2,m.browser.fromPixels(i,4)]}})})}function B4(l){if(l<0||l>=256)throw new Error("Mask value must be in range [0, 255] but got "+l);if(!Number.isInteger(l))throw new Error("Mask value must be an integer but got "+l)}var aN=[[110,64,170],[143,61,178],[178,60,178],[210,62,167],[238,67,149],[255,78,125],[255,94,99],[255,115,75],[255,140,56],[239,167,47],[217,194,49],[194,219,64],[175,240,91],[135,245,87],[96,247,96],[64,243,115],[40,234,141],[28,219,169],[26,199,194],[33,176,213],[47,150,224],[65,125,224],[84,101,214],[99,81,195]];function UB(l){if(B4(l),l<aN.length){var i=aN[l];return{r:i[0],g:i[1],b:i[2],a:255}}throw new Error("Mask value must be in range [0, "+aN.length+")")}function xet(l){var i=l.shape[2],o=(0,m.argMax)(l,2),u=(0,m.reshape)(o,[-1]);return(0,m.oneHot)(u,i)}function j4(l,i){return(0,m.tidy)(function(){return(0,m.cast)((0,m.greater)(l,(0,m.scalar)(i)),"int32")})}function ket(l,i){var o=i.shape,u=o[0],c=o[1],f=o[2];return(0,m.tidy)(function(){var y=xet(i),w=(0,m.expandDims)((0,m.range)(0,f,1,"int32"),1),C=(0,m.cast)((0,m.matMul)(y,w),"int32"),T=(0,m.reshape)(C,[u,c]),x=(0,m.add)(T,(0,m.scalar)(1,"int32"));return(0,m.sub)(function(A,M){return(0,m.mul)(A,M)}(x,l),(0,m.scalar)(1,"int32"))})}var WB=function(){function l(i,o){this.model=i,this.outputStride=o;var u=this.model.inputs[0].shape;m.util.assert(u[1]===-1&&u[2]===-1,function(){return"Input shape ["+u[1]+", "+u[2]+"] must both be equal to or -1"})}return l.prototype.predict=function(i){var o=this;return(0,m.tidy)(function(){var u=o.preprocessInput((0,m.cast)(i,"float32")),c=(0,m.expandDims)(u,0),f=o.model.predict(c).map(function(w){return(0,m.squeeze)(w,[0])}),y=o.nameOutputResults(f);return{heatmapScores:(0,m.sigmoid)(y.heatmap),offsets:y.offsets,displacementFwd:y.displacementFwd,displacementBwd:y.displacementBwd,segmentation:y.segmentation,partHeatmaps:y.partHeatmaps,longOffsets:y.longOffsets,partOffsets:y.partOffsets}})},l.prototype.dispose=function(){this.model.dispose()},l}(),oN=function(l){function i(){return l!==null&&l.apply(this,arguments)||this}return PB(i,l),i.prototype.preprocessInput=function(o){return(0,m.tidy)(function(){return(0,m.sub)((0,m.div)(o,127.5),1)})},i.prototype.nameOutputResults=function(o){return{offsets:o[0],segmentation:o[1],partHeatmaps:o[2],longOffsets:o[3],heatmap:o[4],displacementFwd:o[5],displacementBwd:o[6],partOffsets:o[7]}},i}(WB),dC=["nose","leftEye","rightEye","leftEar","rightEar","leftShoulder","rightShoulder","leftElbow","rightElbow","leftWrist","rightWrist","leftHip","rightHip","leftKnee","rightKnee","leftAnkle","rightAnkle"],Fp=dC.length,Fl=dC.reduce(function(l,i,o){return l[i]=o,l},{});function fC(l,i,o){var u=l[0],c=l[1],f=i[0],y=i[1],w=o.top,C=o.bottom;return[y/(o.left+o.right+c),f/(w+C+u)]}function sN(l,i,o,u){return{y:u.get(l,i,o),x:u.get(l,i,o+Fp)}}function VB(l,i,o){var u=sN(l.heatmapY,l.heatmapX,l.id,o),c=u.y,f=u.x;return{x:l.heatmapX*i+f,y:l.heatmapY*i+c}}function _et(l,i,o){return l<i?i:l>o?o:l}function Cet(l,i){return{x:l.x+i.x,y:l.y+i.y}}function Eet(l,i,o){o===void 0&&(o=.3);for(var u=0,c=0,f=0;f<l.length;f++)i.keypoints[f].score>o&&(c+=1,u+=Math.pow(l[f].x-i.keypoints[f].position.x,2)+Math.pow(l[f].y-i.keypoints[f].position.y,2));return c===0?u=1/0:u/=c,u}function v1(l,i,o,u,c,f,y){for(var w=y[0],C=y[1],T=o(l),x=T.y*u+T.x,A=c[Fp*(2*x)+i],M=c[Fp*(2*x+1)+i],$=l.y+A,V=l.x+M,G=0;G<f;G++){$=Math.min($,w-1);var Q=o({x:V=Math.min(V,C-1),y:$}),nt=Q.y*u+Q.x;$+=A=c[Fp*(2*nt)+i],V+=M=c[Fp*(2*nt+1)+i]}return{x:V,y:$}}function th(l,i,o,u,c,f,y,w,C,T){for(var x=c[0],A=c[1],M=f[0],$=f[1],V=w[0],G=w[1],Q=[],nt=function(Pt){return function(re,ue,be,De){var ze=ue[0],Qe=ue[1],cn=be[0],en=be[1],sn=Math.round(((ze+re.y+1)*en-1)/De);return{x:Math.round(((Qe+re.x+1)*cn-1)/De),y:sn}}(Pt,[x,A],[M,$],C)},it=0;it<u;it++){var ht=v1(l,it,nt,y,i,T,[V,G]);Q.push(ht)}for(var kt=-1,Nt=1/0,$t=0;$t<o.length;$t++){var Ut=Eet(Q,o[$t]);Ut<Nt&&(kt=$t,Nt=Ut)}return kt}function Tet(l,i){var o=l[0],u=l[1];return[Math.round((u-1)/i+1),Math.round((o-1)/i+1)]}function U4(l,i,o,u,c,f,y,w,C,T,x){for(var A=y[0],M=y[1],$=l.shape,V=$[0],G=$[1],Q=i.shape.slice(0,2),nt=Q[0],it=Q[1],ht=(0,m.reshape)(i,[nt,it,2,Fp]),kt=new Float32Array(x*Fp*3).fill(0),Nt=0;Nt<o.length;Nt++)for(var $t=Nt*Fp*3,Ut=o[Nt],Pt=0;Pt<Fp;Pt++){var re=Ut.keypoints[Pt],ue=$t+3*Pt;kt[ue]=re.score,kt[ue+1]=re.position.y,kt[ue+2]=re.position.x}var be=fC([u,c],[A,M],w),De=be[0],ze=be[1],Qe=(0,m.tensor)(kt,[x,Fp,3]),cn=w.top,en=w.left,sn={variableNames:["segmentation","longOffsets","poses"],outputShape:[V,G],userCode:`
    int convertToPositionInOutput(int pos, int pad, float scale, int stride) {
      return round(((float(pos + pad) + 1.0) * scale - 1.0) / float(stride));
    }

    float convertToPositionInOutputFloat(
        int pos, int pad, float scale, int stride) {
      return ((float(pos + pad) + 1.0) * scale - 1.0) / float(stride);
    }

    float dist(float x1, float y1, float x2, float y2) {
      return pow(x1 - x2, 2.0) + pow(y1 - y2, 2.0);
    }

    float sampleLongOffsets(float h, float w, int d, int k) {
      float fh = fract(h);
      float fw = fract(w);
      int clH = int(ceil(h));
      int clW = int(ceil(w));
      int flH = int(floor(h));
      int flW = int(floor(w));
      float o11 = getLongOffsets(flH, flW, d, k);
      float o12 = getLongOffsets(flH, clW, d, k);
      float o21 = getLongOffsets(clH, flW, d, k);
      float o22 = getLongOffsets(clH, clW, d, k);
      float o1 = mix(o11, o12, fw);
      float o2 = mix(o21, o22, fw);
      return mix(o1, o2, fh);
    }

    int findNearestPose(int h, int w) {
      float prob = getSegmentation(h, w);
      if (prob < 1.0) {
        return -1;
      }

      // Done(Tyler): convert from output space h/w to strided space.
      float stridedH = convertToPositionInOutputFloat(
        h, `+cn+", "+ze+", "+f+`);
      float stridedW = convertToPositionInOutputFloat(
        w, `+en+", "+De+", "+f+`);

      float minDist = 1000000.0;
      int iMin = -1;
      for (int i = 0; i < `+x+`; i++) {
        float curDistSum = 0.0;
        int numKpt = 0;
        for (int k = 0; k < `+Fp+`; k++) {
          float dy = sampleLongOffsets(stridedH, stridedW, 0, k);
          float dx = sampleLongOffsets(stridedH, stridedW, 1, k);

          float y = float(h) + dy;
          float x = float(w) + dx;

          for (int s = 0; s < `+C+`; s++) {
            int yRounded = round(min(y, float(`+(u-1)+`)));
            int xRounded = round(min(x, float(`+(c-1)+`)));

            float yStrided = convertToPositionInOutputFloat(
              yRounded, `+cn+", "+ze+", "+f+`);
            float xStrided = convertToPositionInOutputFloat(
              xRounded, `+en+", "+De+", "+f+`);

            float dy = sampleLongOffsets(yStrided, xStrided, 0, k);
            float dx = sampleLongOffsets(yStrided, xStrided, 1, k);

            y = y + dy;
            x = x + dx;
          }

          float poseScore = getPoses(i, k, 0);
          float poseY = getPoses(i, k, 1);
          float poseX = getPoses(i, k, 2);
          if (poseScore > `+T+`) {
            numKpt = numKpt + 1;
            curDistSum = curDistSum + dist(x, y, poseX, poseY);
          }
        }
        if (numKpt > 0 && curDistSum / float(numKpt) < minDist) {
          minDist = curDistSum / float(numKpt);
          iMin = i;
        }
      }
      return iMin;
    }

    void main() {
        ivec2 coords = getOutputCoords();
        int nearestPose = findNearestPose(coords[0], coords[1]);
        setOutput(float(nearestPose));
      }
  `};return(0,m.backend)().compileAndRun(sn,[l,ht,Qe])}function uN(){return(0,m.getBackend)()==="webgl"}function hy(l,i,o,u,c,f,y,w,C,T,x,A){var M=y[0],$=y[1];return C===void 0&&(C=.2),T===void 0&&(T=8),x===void 0&&(x=.3),A===void 0&&(A=10),jo(this,void 0,void 0,function(){var V,G,Q,nt,it;return as(this,function(ht){switch(ht.label){case 0:return V=o.filter(function(kt){return kt.score>=C}),uN()?(Q=(0,m.tidy)(function(){var kt=U4(l,i,V,u,c,f,[M,$],w,T,x,A),Nt=(0,m.engine)().makeTensorFromDataId(kt.dataId,kt.shape,kt.dtype);return V.map(function($t,Ut){return function(Pt,re){return(0,m.tidy)(function(){return(0,m.cast)((0,m.equal)(Pt,(0,m.scalar)(re)),"int32")})}(Nt,Ut)})}),[4,Promise.all(Q.map(function(kt){return kt.data()}))]):[3,2];case 1:return G=ht.sent(),Q.forEach(function(kt){return kt.dispose()}),[3,5];case 2:return[4,l.data()];case 3:return nt=ht.sent(),[4,i.data()];case 4:it=ht.sent(),G=function(kt,Nt,$t,Ut,Pt,re,ue,be,De,ze){var Qe=ue[0],cn=ue[1];ze===void 0&&(ze=5);for(var en=$t.map(function(Dr){return new Uint8Array(Ut*Pt).fill(0)}),sn=be.top,xn=be.left,Rn=fC([Ut,Pt],[Qe,cn],be),Bn=Rn[0],Fn=Rn[1],Xn=Tet([Qe,cn],re)[0],Nn=0;Nn<Ut;Nn+=1)for(var kr=0;kr<Pt;kr+=1){var Tr=Nn*Pt+kr;if(kt[Tr]===1){var Ar=th({x:kr,y:Nn},Nt,$t,ze,[sn,xn],[Bn,Fn],Xn,[Ut,Pt],re,De);Ar>=0&&(en[Ar][Tr]=1)}}return en}(nt,it,V,u,c,f,[M,$],w,T),ht.label=5;case 5:return[2,G.map(function(kt,Nt){return{data:kt,pose:V[Nt],width:c,height:u}})]}})})}function ud(l,i,o,u,c,f,y,w,C,T,x,A,M){var $=w[0],V=w[1];return T===void 0&&(T=.2),x===void 0&&(x=8),A===void 0&&(A=.3),M===void 0&&(M=10),jo(this,void 0,void 0,function(){var G,Q,nt,it,ht,kt;return as(this,function(Nt){switch(Nt.label){case 0:return G=u.filter(function($t){return $t.score>=T}),uN()?(nt=(0,m.tidy)(function(){var $t=U4(l,i,G,c,f,y,[$,V],C,x,A,M),Ut=(0,m.engine)().makeTensorFromDataId($t.dataId,$t.shape,$t.dtype);return G.map(function(Pt,re){return function(ue,be,De){return(0,m.tidy)(function(){return(0,m.sub)((0,m.mul)((0,m.cast)((0,m.equal)(ue,(0,m.scalar)(De)),"int32"),(0,m.add)(be,1)),1)})}(Ut,o,re)})}),[4,Promise.all(nt.map(function($t){return $t.data()}))]):[3,2];case 1:return Q=Nt.sent(),nt.forEach(function($t){return $t.dispose()}),[3,6];case 2:return[4,l.data()];case 3:return it=Nt.sent(),[4,i.data()];case 4:return ht=Nt.sent(),[4,o.data()];case 5:kt=Nt.sent(),Q=function($t,Ut,Pt,re,ue,be,De,ze,Qe,cn,en){var sn=ze[0],xn=ze[1];en===void 0&&(en=5);for(var Rn=re.map(function(Yi){return new Int32Array(ue*be).fill(-1)}),Bn=Qe.top,Fn=Qe.left,Xn=fC([ue,be],[sn,xn],Qe),Nn=Xn[0],kr=Xn[1],Tr=Tet([sn,xn],De)[0],Ar=0;Ar<ue;Ar+=1)for(var Dr=0;Dr<be;Dr+=1){var Ni=Ar*be+Dr;if($t[Ni]===1){var Mi=th({x:Dr,y:Ar},Ut,re,en,[Bn,Fn],[Nn,kr],Tr,[ue,be],De,cn);Mi>=0&&(Rn[Mi][Ni]=Pt[Ni])}}return Rn}(it,ht,kt,G,c,f,y,[$,V],C,x),Nt.label=6;case 6:return[2,Q.map(function($t,Ut){return{pose:G[Ut],data:$t,height:c,width:f}})]}})})}function lN(l){return Math.floor(l/2)}var GB=function(){function l(i,o){this.priorityQueue=new Array(i),this.numberOfElements=-1,this.getElementValue=o}return l.prototype.enqueue=function(i){this.priorityQueue[++this.numberOfElements]=i,this.swim(this.numberOfElements)},l.prototype.dequeue=function(){var i=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,i},l.prototype.empty=function(){return this.numberOfElements===-1},l.prototype.size=function(){return this.numberOfElements+1},l.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},l.prototype.max=function(){return this.priorityQueue[0]},l.prototype.swim=function(i){for(;i>0&&this.less(lN(i),i);)this.exchange(i,lN(i)),i=lN(i)},l.prototype.sink=function(i){for(;2*i<=this.numberOfElements;){var o=2*i;if(o<this.numberOfElements&&this.less(o,o+1)&&o++,!this.less(i,o))break;this.exchange(i,o),i=o}},l.prototype.getValueAt=function(i){return this.getElementValue(this.priorityQueue[i])},l.prototype.less=function(i,o){return this.getValueAt(i)<this.getValueAt(o)},l.prototype.exchange=function(i,o){var u=this.priorityQueue[i];this.priorityQueue[i]=this.priorityQueue[o],this.priorityQueue[o]=u},l}();function Aet(l,i,o,u,c,f){for(var y=f.shape,w=y[0],C=y[1],T=!0,x=Math.max(o-c,0),A=Math.min(o+c+1,w),M=x;M<A;++M){for(var $=Math.max(u-c,0),V=Math.min(u+c+1,C),G=$;G<V;++G)if(f.get(M,G,l)>i){T=!1;break}if(!T)break}return T}var HB=[["nose","leftEye"],["leftEye","leftEar"],["nose","rightEye"],["rightEye","rightEar"],["nose","leftShoulder"],["leftShoulder","leftElbow"],["leftElbow","leftWrist"],["leftShoulder","leftHip"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["nose","rightShoulder"],["rightShoulder","rightElbow"],["rightElbow","rightWrist"],["rightShoulder","rightHip"],["rightHip","rightKnee"],["rightKnee","rightAnkle"]].map(function(l){var i=l[0],o=l[1];return[Fl[i],Fl[o]]}),YB=HB.map(function(l){return l[1]}),a3=HB.map(function(l){return l[0]});function qB(l,i,o,u){return{y:_et(Math.round(l.y/i),0,o-1),x:_et(Math.round(l.x/i),0,u-1)}}function Iet(l,i,o,u,c,f,y,w){w===void 0&&(w=2);for(var C=u.shape,T=C[0],x=C[1],A=function(it,ht,kt){var Nt=kt.shape[2]/2;return{y:kt.get(ht.y,ht.x,it),x:kt.get(ht.y,ht.x,Nt+it)}}(l,qB(i.position,f,T,x),y),M=Cet(i.position,A),$=0;$<w;$++){var V=qB(M,f,T,x),G=sN(V.y,V.x,o,c);M=Cet({x:V.x*f,y:V.y*f},{x:G.x,y:G.y})}var Q=qB(M,f,T,x),nt=u.get(Q.y,Q.x,o);return{position:M,part:dC[o],score:nt}}function Net(l,i,o,u,c,f){var y=i.shape[2],w=YB.length,C=new Array(y),T=l.part,x=l.score,A=VB(T,u,o);C[T.id]={score:x,part:dC[T.id],position:A};for(var M=w-1;M>=0;--M){var $=YB[M],V=a3[M];C[$]&&!C[V]&&(C[V]=Iet(M,C[$],V,i,o,u,f))}for(M=0;M<w;++M)$=a3[M],V=YB[M],C[$]&&!C[V]&&(C[V]=Iet(M,C[$],V,i,o,u,c));return C}function XB(l,i,o,u){var c=o.x,f=o.y;return l.some(function(y){var w,C,T,x,A=y.keypoints[u].position;return w=f,C=c,(T=A.y-w)*T+(x=A.x-C)*x<=i})}function Met(l,i,o){var u=o.reduce(function(c,f,y){var w=f.position,C=f.score;return XB(l,i,w,y)||(c+=C),c},0);return u/o.length}function W4(l,i,o,u,c,f,y,w){y===void 0&&(y=.5),w===void 0&&(w=20);for(var C=[],T=function(V,G,Q){for(var nt=Q.shape,it=nt[0],ht=nt[1],kt=nt[2],Nt=new GB(it*ht*kt,function(ue){return ue.score}),$t=0;$t<it;++$t)for(var Ut=0;Ut<ht;++Ut)for(var Pt=0;Pt<kt;++Pt){var re=Q.get($t,Ut,Pt);re<V||Aet(Pt,re,$t,Ut,1,Q)&&Nt.enqueue({score:re,part:{heatmapY:$t,heatmapX:Ut,id:Pt}})}return Nt}(y,0,l),x=w*w;C.length<f&&!T.empty();){var A=T.dequeue();if(!XB(C,x,VB(A.part,c,i),A.part.id)){var M=Net(A,l,i,c,o,u),$=Met(C,x,M);C.push({keypoints:M,score:$})}}return C}var pC,Z0t=[-123.15,-115.9,-103.06],KB=function(l){function i(){return l!==null&&l.apply(this,arguments)||this}return PB(i,l),i.prototype.preprocessInput=function(o){return(0,m.add)(o,Z0t)},i.prototype.nameOutputResults=function(o){var u=o[0],c=o[1],f=o[2],y=o[3],w=o[4],C=o[5];return{offsets:w,segmentation:o[6],partHeatmaps:C,longOffsets:y,heatmap:f,displacementFwd:c,displacementBwd:u,partOffsets:o[7]}},i}(WB),ZB="https://storage.googleapis.com/tfjs-models/savedmodel/bodypix/resnet50/",Det="https://storage.googleapis.com/tfjs-models/savedmodel/bodypix/mobilenet/";function Jm(l){if(typeof HTMLCanvasElement<"u"&&l instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&l instanceof OffscreenCanvas||typeof HTMLImageElement<"u"&&l instanceof HTMLImageElement)return function(i){if("offsetHeight"in i&&i.offsetHeight!==0&&"offsetWidth"in i&&i.offsetWidth!==0)return[i.offsetHeight,i.offsetWidth];if(i.height!=null&&i.width!=null)return[i.height,i.width];throw new Error("HTMLImageElement must have height and width attributes set.")}(l);if(typeof ImageData<"u"&&l instanceof ImageData)return[l.height,l.width];if(typeof HTMLVideoElement<"u"&&l instanceof HTMLVideoElement)return function(i){return i.hasAttribute("height")&&i.hasAttribute("width")?[i.height,i.width]:[i.videoHeight,i.videoWidth]}(l);if(l instanceof m.Tensor)return[l.shape[0],l.shape[1]];throw new Error("error: Unknown input type: "+l+".")}function Ret(l,i){return function(o,u){return(o-1)%u==0}(l,i)?l:Math.floor(l/i)*i+1}var mC={low:"low",medium:"medium",high:"high",full:"full"},Q0t=((pC={})[mC.low]=.25,pC[mC.medium]=.5,pC[mC.high]=.75,pC[mC.full]=1,pC);function V4(l,i,o){var u=o[0],c=o[1],f=function(y){if(typeof y=="string"){var w=Q0t[y];return m.util.assert(typeof w=="number",function(){return"string value of inputResolution must be one of "+Object.values(mC).join(",")+" but was "+y+"."}),w}return m.util.assert(typeof y=="number"&&y<=2&&y>=.1,function(){return"inputResolution must be a string or number between 0.1 and 2, but was "+y}),y}(l);return[Ret(u*f,i),Ret(c*f,i)]}function G4(l,i,o,u,c){var f=i[0],y=i[1],w=o[0],C=o[1],T=u[0],x=T[0],A=T[1],M=u[1],$=M[0],V=M[1];return(0,m.tidy)(function(){var G=m.image.resizeBilinear(l,[w,C],!0);return G=(0,m.sigmoid)(G),function(Q,nt,it){var ht=nt[0],kt=nt[1],Nt=it[0],$t=Nt[0],Ut=Nt[1],Pt=it[1],re=Pt[0],ue=Pt[1];return(0,m.tidy)(function(){var be=(0,m.expandDims)(Q);return(0,m.squeeze)(m.image.cropAndResize(be,[[$t/(ht+$t+Ut-1),re/(kt+re+ue-1),($t+ht-1)/(ht+$t+Ut-1),(re+kt-1)/(kt+re+ue-1)]],[0],[ht,kt]),[0])})}(G,[f,y],[[x,A],[$,V]])})}function cN(l,i){var o=i[0],u=i[1],c=Jm(l),f=c[0],y=c[1],w=u/o,C=[0,0,0,0],T=C[0],x=C[1],A=C[2],M=C[3];y/f<w?(T=0,x=0,A=Math.round(.5*(w*f-y)),M=Math.round(.5*(w*f-y))):(T=Math.round(.5*(1/w*y-f)),x=Math.round(.5*(1/w*y-f)),A=0,M=0);var $=(0,m.tidy)(function(){var V=function(G){return G instanceof m.Tensor?G:m.browser.fromPixels(G)}(l);return V=(0,m.pad3d)(V,[[T,x],[A,M],[0,0]]),m.image.resizeBilinear(V,[o,u])});return{resized:$,padding:{top:T,left:A,right:M,bottom:x}}}function hN(l){return jo(this,void 0,void 0,function(){return as(this,function(i){return[2,Promise.all(l.map(function(o){return o.buffer()}))]})})}function gC(l,i,o,u,c){var f=i[0],y=i[1],w=o[0],C=o[1],T=function(x,A,M,$,V){return $===void 0&&($=0),V===void 0&&(V=0),M===1&&A===1&&$===0&&V===0?x:x.map(function(G){return function(Q,nt,it,ht,kt){return ht===void 0&&(ht=0),kt===void 0&&(kt=0),{score:Q.score,keypoints:Q.keypoints.map(function(Nt){var $t=Nt.score,Ut=Nt.part,Pt=Nt.position;return{score:$t,part:Ut,position:{x:Pt.x*it+kt,y:Pt.y*nt+ht}}})}}(G,A,M,$,V)})}(l,(f+u.top+u.bottom)/w,(y+u.left+u.right)/C,-u.top,-u.left);return c?function(x,A){return A<=0?x:x.map(function(M){return function($,V){return{score:$.score,keypoints:$.keypoints.map(function(G){var Q=G.score,nt=G.part,it=G.position;return{score:Q,part:nt,position:{x:V-1-it.x,y:it.y}}})}}(M,A)})}(T,y):T}var Fet={architecture:"MobileNetV1",outputStride:16,quantBytes:4,multiplier:.75},Oet=["MobileNetV1","ResNet50"],Let={MobileNetV1:[8,16,32],ResNet50:[32,16]},$et={MobileNetV1:[.5,.75,1],ResNet50:[1]},U0=[1,2,4],W0={flipHorizontal:!1,internalResolution:"medium",segmentationThreshold:.7,maxDetections:10,scoreThreshold:.4,nmsRadius:20},yC={flipHorizontal:!1,internalResolution:"medium",segmentationThreshold:.7,maxDetections:10,scoreThreshold:.4,nmsRadius:20,minKeypointScore:.3,refineSteps:10};function dN(l){var i=l.segmentationThreshold,o=l.maxDetections,u=l.scoreThreshold,c=l.nmsRadius;if(i<0||i>1)throw new Error("segmentationThreshold "+i+". Should be in range [0.0, 1.0]");if(o<=0)throw new Error("Invalid maxDetections "+o+". Should be > 0");if(u<0||u>1)throw new Error("Invalid scoreThreshold "+u+". Should be in range [0.0, 1.0]");if(c<=0)throw new Error("Invalid nmsRadius "+c+".")}function QB(l){var i=l.segmentationThreshold,o=l.maxDetections,u=l.scoreThreshold,c=l.nmsRadius,f=l.minKeypointScore,y=l.refineSteps;if(i<0||i>1)throw new Error("segmentationThreshold "+i+". Should be in range [0.0, 1.0]");if(o<=0)throw new Error("Invalid maxDetections "+o+". Should be > 0");if(u<0||u>1)throw new Error("Invalid scoreThreshold "+u+". Should be in range [0.0, 1.0]");if(c<=0)throw new Error("Invalid nmsRadius "+c+".");if(f<0||f>1)throw new Error("Invalid minKeypointScore "+f+".Should be in range [0.0, 1.0]");if(y<=0||y>20)throw new Error("Invalid refineSteps "+y+".Should be in range [1, 20]")}var zet=function(){function l(i){this.baseModel=i}return l.prototype.predictForPersonSegmentation=function(i){var o=this.baseModel.predict(i);return{segmentLogits:o.segmentation,heatmapScores:o.heatmapScores,offsets:o.offsets,displacementFwd:o.displacementFwd,displacementBwd:o.displacementBwd}},l.prototype.predictForPersonSegmentationAndPart=function(i){var o=this.baseModel.predict(i);return{segmentLogits:o.segmentation,partHeatmapLogits:o.partHeatmaps,heatmapScores:o.heatmapScores,offsets:o.offsets,displacementFwd:o.displacementFwd,displacementBwd:o.displacementBwd}},l.prototype.predictForMultiPersonInstanceSegmentationAndPart=function(i){var o=this.baseModel.predict(i);return{segmentLogits:o.segmentation,longOffsets:o.longOffsets,heatmapScores:o.heatmapScores,offsets:o.offsets,displacementFwd:o.displacementFwd,displacementBwd:o.displacementBwd,partHeatmaps:o.partHeatmaps}},l.prototype.segmentPersonActivation=function(i,o,u){var c=this;u===void 0&&(u=.5);var f=Jm(i),y=f[0],w=f[1],C=V4(o,this.baseModel.outputStride,[y,w]),T=cN(i,C),x=T.resized,A=T.padding,M=(0,m.tidy)(function(){var it=c.predictForPersonSegmentation(x),ht=it.segmentLogits,kt=it.heatmapScores,Nt=it.offsets,$t=it.displacementFwd,Ut=it.displacementBwd,Pt=x.shape,re=Pt[0],ue=Pt[1],be=G4(ht,[y,w],[re,ue],[[A.top,A.bottom],[A.left,A.right]]);return{segmentation:j4((0,m.squeeze)(be),u),heatmapScores:kt,offsets:Nt,displacementFwd:$t,displacementBwd:Ut}}),$=M.segmentation,V=M.heatmapScores,G=M.offsets,Q=M.displacementFwd,nt=M.displacementBwd;return x.dispose(),{segmentation:$,heatmapScores:V,offsets:G,displacementFwd:Q,displacementBwd:nt,padding:A,internalResolutionHeightAndWidth:C}},l.prototype.segmentPerson=function(i,o){return o===void 0&&(o=W0),jo(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M,$,V,G,Q,nt,it,ht,kt;return as(this,function(Nt){switch(Nt.label){case 0:return dN(o=xc(xc({},W0),o)),u=this.segmentPersonActivation(i,o.internalResolution,o.segmentationThreshold),c=u.segmentation,f=u.heatmapScores,y=u.offsets,w=u.displacementFwd,C=u.displacementBwd,T=u.padding,x=u.internalResolutionHeightAndWidth,A=c.shape,M=A[0],$=A[1],[4,c.data()];case 1:return V=Nt.sent(),c.dispose(),[4,hN([f,y,w,C])];case 2:return G=Nt.sent(),Q=G[0],nt=G[1],it=G[2],ht=G[3],kt=gC(kt=W4(Q,nt,it,ht,this.baseModel.outputStride,o.maxDetections,o.scoreThreshold,o.nmsRadius),[M,$],x,T,!1),f.dispose(),y.dispose(),w.dispose(),C.dispose(),[2,{height:M,width:$,data:V,allPoses:kt}]}})})},l.prototype.segmentMultiPerson=function(i,o){return o===void 0&&(o=yC),jo(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M,$,V,G,Q,nt,it,ht,kt,Nt,$t,Ut,Pt=this;return as(this,function(re){switch(re.label){case 0:return QB(o=xc(xc({},yC),o)),u=Jm(i),c=u[0],f=u[1],y=V4(o.internalResolution,this.baseModel.outputStride,[c,f]),w=cN(i,y),C=w.resized,T=w.padding,x=(0,m.tidy)(function(){var ue,be=Pt.predictForMultiPersonInstanceSegmentationAndPart(C),De=be.segmentLogits,ze=be.longOffsets,Qe=be.heatmapScores,cn=be.offsets,en=be.displacementFwd,sn=be.displacementBwd,xn=G4(De,[c,f],y,[[T.top,T.bottom],[T.left,T.right]]);return ue=ze,{segmentation:j4((0,m.squeeze)(xn),o.segmentationThreshold),longOffsets:ue,heatmapScoresRaw:Qe,offsetsRaw:cn,displacementFwdRaw:en,displacementBwdRaw:sn}}),A=x.segmentation,M=x.longOffsets,$=x.heatmapScoresRaw,V=x.offsetsRaw,G=x.displacementFwdRaw,Q=x.displacementBwdRaw,[4,hN([$,V,G,Q])];case 1:return nt=re.sent(),it=nt[0],ht=nt[1],kt=nt[2],Nt=nt[3],$t=gC($t=W4(it,ht,kt,Nt,this.baseModel.outputStride,o.maxDetections,o.scoreThreshold,o.nmsRadius),[c,f],y,T,!1),[4,hy(A,M,$t,c,f,this.baseModel.outputStride,y,T,o.scoreThreshold,o.refineSteps,o.minKeypointScore,o.maxDetections)];case 2:return Ut=re.sent(),C.dispose(),A.dispose(),M.dispose(),$.dispose(),V.dispose(),G.dispose(),Q.dispose(),[2,Ut]}})})},l.prototype.segmentPersonPartsActivation=function(i,o,u){var c=this;u===void 0&&(u=.5);var f=Jm(i),y=f[0],w=f[1],C=V4(o,this.baseModel.outputStride,[y,w]),T=cN(i,C),x=T.resized,A=T.padding,M=(0,m.tidy)(function(){var it=c.predictForPersonSegmentationAndPart(x),ht=it.segmentLogits,kt=it.partHeatmapLogits,Nt=it.heatmapScores,$t=it.offsets,Ut=it.displacementFwd,Pt=it.displacementBwd,re=x.shape,ue=re[0],be=re[1],De=G4(ht,[y,w],[ue,be],[[A.top,A.bottom],[A.left,A.right]]),ze=G4(kt,[y,w],[ue,be],[[A.top,A.bottom],[A.left,A.right]]);return{partSegmentation:ket(j4((0,m.squeeze)(De),u),ze),heatmapScores:Nt,offsets:$t,displacementFwd:Ut,displacementBwd:Pt}}),$=M.partSegmentation,V=M.heatmapScores,G=M.offsets,Q=M.displacementFwd,nt=M.displacementBwd;return x.dispose(),{partSegmentation:$,heatmapScores:V,offsets:G,displacementFwd:Q,displacementBwd:nt,padding:A,internalResolutionHeightAndWidth:C}},l.prototype.segmentPersonParts=function(i,o){return o===void 0&&(o=W0),jo(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M,$,V,G,Q,nt,it,ht,kt;return as(this,function(Nt){switch(Nt.label){case 0:return dN(o=xc(xc({},W0),o)),u=this.segmentPersonPartsActivation(i,o.internalResolution,o.segmentationThreshold),c=u.partSegmentation,f=u.heatmapScores,y=u.offsets,w=u.displacementFwd,C=u.displacementBwd,T=u.padding,x=u.internalResolutionHeightAndWidth,A=c.shape,M=A[0],$=A[1],[4,c.data()];case 1:return V=Nt.sent(),c.dispose(),[4,hN([f,y,w,C])];case 2:return G=Nt.sent(),Q=G[0],nt=G[1],it=G[2],ht=G[3],kt=gC(kt=W4(Q,nt,it,ht,this.baseModel.outputStride,o.maxDetections,o.scoreThreshold,o.nmsRadius),[M,$],x,T,!1),f.dispose(),y.dispose(),w.dispose(),C.dispose(),[2,{height:M,width:$,data:V,allPoses:kt}]}})})},l.prototype.segmentMultiPersonParts=function(i,o){return o===void 0&&(o=yC),jo(this,void 0,void 0,function(){var u,c,f,y,w,C,T,x,A,M,$,V,G,Q,nt,it,ht,kt,Nt,$t,Ut,Pt,re=this;return as(this,function(ue){switch(ue.label){case 0:return QB(o=xc(xc({},yC),o)),u=Jm(i),c=u[0],f=u[1],y=V4(o.internalResolution,this.baseModel.outputStride,[c,f]),w=cN(i,y),C=w.resized,T=w.padding,x=(0,m.tidy)(function(){var be=re.predictForMultiPersonInstanceSegmentationAndPart(C),De=be.segmentLogits,ze=be.longOffsets,Qe=be.heatmapScores,cn=be.offsets,en=be.displacementFwd,sn=be.displacementBwd,xn=be.partHeatmaps,Rn=G4(De,[c,f],y,[[T.top,T.bottom],[T.left,T.right]]),Bn=G4(xn,[c,f],y,[[T.top,T.bottom],[T.left,T.right]]),Fn=ze,Xn=j4((0,m.squeeze)(Rn),o.segmentationThreshold),Nn=function(kr){var Tr=kr.shape,Ar=Tr[0],Dr=Tr[1],Ni=Tr[2];return(0,m.tidy)(function(){var Mi=xet(kr),Yi=(0,m.expandDims)((0,m.range)(0,Ni,1,"int32"),1),Hr=(0,m.cast)((0,m.matMul)(Mi,Yi),"int32");return(0,m.reshape)(Hr,[Ar,Dr])})}(Bn);return{segmentation:Xn,longOffsets:Fn,heatmapScoresRaw:Qe,offsetsRaw:cn,displacementFwdRaw:en,displacementBwdRaw:sn,partSegmentation:Nn}}),A=x.segmentation,M=x.longOffsets,$=x.heatmapScoresRaw,V=x.offsetsRaw,G=x.displacementFwdRaw,Q=x.displacementBwdRaw,nt=x.partSegmentation,[4,hN([$,V,G,Q])];case 1:return it=ue.sent(),ht=it[0],kt=it[1],Nt=it[2],$t=it[3],Ut=gC(Ut=W4(ht,kt,Nt,$t,this.baseModel.outputStride,o.maxDetections,o.scoreThreshold,o.nmsRadius),[c,f],y,T,!1),[4,ud(A,M,nt,Ut,c,f,this.baseModel.outputStride,y,T,o.scoreThreshold,o.refineSteps,o.minKeypointScore,o.maxDetections)];case 2:return Pt=ue.sent(),C.dispose(),A.dispose(),M.dispose(),$.dispose(),V.dispose(),G.dispose(),Q.dispose(),nt.dispose(),[2,Pt]}})})},l.prototype.dispose=function(){this.baseModel.dispose()},l}();function fN(l){return jo(this,void 0,void 0,function(){var i,o,u,c,f,y;return as(this,function(w){switch(w.label){case 0:if(i=l.outputStride,o=l.quantBytes,u=l.multiplier,m==null)throw new Error(`Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this
        model.`);return c=function(C,T,x){var A={1:"100",.75:"075",.5:"050"},M="model-stride"+C+".json";return x===4?Det+"float/"+A[T]+"/"+M:Det+"quant"+x+"/"+A[T]+"/"+M}(i,u,o),[4,Vc(l.modelUrl||c)];case 1:return f=w.sent(),y=new oN(f,i),[2,new zet(y)]}})})}function JB(l){return jo(this,void 0,void 0,function(){var i,o,u,c,f;return as(this,function(y){switch(y.label){case 0:if(i=l.outputStride,o=l.quantBytes,m==null)throw new Error(`Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this
        model.`);return u=function(w,C){var T="model-stride"+w+".json";return C===4?ZB+"float/"+T:ZB+"quant"+C+"/"+T}(i,o),[4,Vc(l.modelUrl||u)];case 1:return c=y.sent(),f=new KB(c,i),[2,new zet(f)]}})})}function pN(l){return l===void 0&&(l=Fet),jo(this,void 0,void 0,function(){return as(this,function(i){return(l=function(o){if((o=o||Fet).architecture==null&&(o.architecture="MobileNetV1"),Oet.indexOf(o.architecture)<0)throw new Error("Invalid architecture "+o.architecture+". Should be one of "+Oet);if(o.outputStride==null&&(o.outputStride=16),Let[o.architecture].indexOf(o.outputStride)<0)throw new Error("Invalid outputStride "+o.outputStride+". Should be one of "+Let[o.architecture]+" for architecture "+o.architecture+".");if(o.multiplier==null&&(o.multiplier=1),$et[o.architecture].indexOf(o.multiplier)<0)throw new Error("Invalid multiplier "+o.multiplier+". Should be one of "+$et[o.architecture]+" for architecture "+o.architecture+".");if(o.quantBytes==null&&(o.quantBytes=4),U0.indexOf(o.quantBytes)<0)throw new Error("Invalid quantBytes "+o.quantBytes+". Should be one of "+U0+" for architecture "+o.architecture+".");return o}(l)).architecture==="ResNet50"?[2,JB(l)]:l.architecture==="MobileNetV1"?[2,fN(l)]:[2,null]})})}var dy=["left_face","right_face","left_upper_arm_front","left_upper_arm_back","right_upper_arm_front","right_upper_arm_back","left_lower_arm_front","left_lower_arm_back","right_lower_arm_front","right_lower_arm_back","left_hand","right_hand","torso_front","torso_back","left_upper_leg_front","left_upper_leg_back","right_upper_leg_front","right_upper_leg_back","left_lower_leg_front","left_lower_leg_back","right_lower_leg_front","right_lower_leg_back","left_feet","right_feet"],tj=function(){function l(i){this.mask=i}return l.prototype.toCanvasImageSource=function(){return jo(this,void 0,void 0,function(){return as(this,function(i){return[2,iN(this.mask)]})})},l.prototype.toImageData=function(){return jo(this,void 0,void 0,function(){return as(this,function(i){return[2,this.mask]})})},l.prototype.toTensor=function(){return jo(this,void 0,void 0,function(){return as(this,function(i){return[2,jB(this.mask)]})})},l.prototype.getUnderlyingType=function(){return"imagedata"},l}();function Pet(l){if(B4(l),l!==255)throw new Error("Foreground id must be 255 but got "+l);return"person"}function Bet(l){if(B4(l),l>=dy.length)throw new Error("Invalid body part value "+l);return dy[l]}var ej=function(){function l(i){this.bodyPixModel=i}return l.prototype.segmentPeople=function(i,o){return jo(this,void 0,void 0,function(){var u,c,f,y;return as(this,function(w){switch(w.label){case 0:return i instanceof ImageBitmap&&((u=document.createElement("canvas")).getContext("2d").drawImage(i,0,0),i=u),o.segmentBodyParts?o.multiSegmentation?[4,this.bodyPixModel.segmentMultiPersonParts(i,o)]:[3,2]:[3,5];case 1:return f=w.sent(),[3,4];case 2:return[4,this.bodyPixModel.segmentPersonParts(i,o)];case 3:f=[w.sent()],w.label=4;case 4:return c=f.map(function(C){var T=C.data,x=C.width,A=C.height,M=new Uint8ClampedArray(x*A*4).fill(0);return T.forEach(function($,V){$===-1?(M[4*V]=dy.length,M[4*V+3]=0):(M[4*V]=$,M[4*V+3]=255)}),{maskValueToLabel:Bet,mask:new tj(new ImageData(M,x,A))}}),[3,10];case 5:return o.multiSegmentation?[4,this.bodyPixModel.segmentMultiPerson(i,o)]:[3,7];case 6:return y=w.sent(),[3,9];case 7:return[4,this.bodyPixModel.segmentPerson(i,o)];case 8:y=[w.sent()],w.label=9;case 9:c=y.map(function(C){var T=C.data,x=C.width,A=C.height,M=new Uint8ClampedArray(x*A*4).fill(0);return T.forEach(function($,V){$===0?(M[4*V]=0,M[4*V+3]=0):(M[4*V]=255,M[4*V+3]=255)}),{maskValueToLabel:Pet,mask:new tj(new ImageData(M,x,A))}}),w.label=10;case 10:return[2,c]}})})},l.prototype.dispose=function(){this.bodyPixModel.dispose()},l.prototype.reset=function(){},l}();function nj(l){return jo(this,void 0,void 0,function(){return as(this,function(i){return[2,pN(l).then(function(o){return new ej(o)})]})})}var rj={runtime:"mediapipe",modelType:"general"},jet=function(){function l(i){this.mask=i}return l.prototype.toCanvasImageSource=function(){return jo(this,void 0,void 0,function(){return as(this,function(i){return[2,this.mask]})})},l.prototype.toImageData=function(){return jo(this,void 0,void 0,function(){return as(this,function(i){return[2,BB(this.mask)]})})},l.prototype.toTensor=function(){return jo(this,void 0,void 0,function(){return as(this,function(i){return[2,jB(this.mask)]})})},l.prototype.getUnderlyingType=function(){return"canvasimagesource"},l}();function Uet(l){return B4(l),"person"}var J0t=function(){function l(i){var o,u,c=this;this.selfieMode=!1,this.selfieSegmentationSolution=new zB.SelfieSegmentation({locateFile:(o=i.locateFile)!==null&&o!==void 0?o:function(f,y){return i.solutionPath?i.solutionPath.replace(/\/+$/,"")+"/"+f:y+"/"+f}}),u=i.modelType==="landscape"?1:0,this.selfieSegmentationSolution.setOptions({modelSelection:u,selfieMode:this.selfieMode}),this.selfieSegmentationSolution.onResults(function(f){c.segmentation=[{maskValueToLabel:Uet,mask:new jet(f.segmentationMask)}]})}return l.prototype.segmentPeople=function(i,o){return jo(this,void 0,void 0,function(){var u,c;return as(this,function(f){switch(f.label){case 0:return o&&o.flipHorizontal&&o.flipHorizontal!==this.selfieMode&&(this.selfieMode=o.flipHorizontal,this.selfieSegmentationSolution.setOptions({selfieMode:this.selfieMode})),i instanceof m.Tensor?(c=ImageData.bind,[4,m.browser.toPixels(i)]):[3,2];case 1:return u=new(c.apply(ImageData,[void 0,f.sent(),i.shape[1],i.shape[0]])),[3,3];case 2:u=i,f.label=3;case 3:return i=u,[4,this.selfieSegmentationSolution.send({image:i})];case 4:return f.sent(),[2,this.segmentation]}})})},l.prototype.dispose=function(){this.selfieSegmentationSolution.close()},l.prototype.reset=function(){this.selfieSegmentationSolution.reset(),this.segmentation=null,this.selfieMode=!1},l.prototype.initialize=function(){return this.selfieSegmentationSolution.initialize()},l}();function Wet(l){return jo(this,void 0,void 0,function(){var i,o;return as(this,function(u){switch(u.label){case 0:return i=function(c){if(c==null)return xc({},rj);var f=xc({},c);return f.runtime="mediapipe",f.modelType==null&&(f.modelType=rj.modelType),f}(l),[4,(o=new J0t(i)).initialize()];case 1:return u.sent(),[2,o]}})})}function mN(l){return l instanceof m.Tensor?{height:l.shape[0],width:l.shape[1]}:{height:l.height,width:l.width}}function gN(l,i){m.util.assert(l.width!==0,function(){return i+" width cannot be 0."}),m.util.assert(l.height!==0,function(){return i+" height cannot be 0."})}function Kd(l,i,o){var u=i.outputTensorSize,c=i.keepAspectRatio,f=i.borderMode,y=i.outputTensorFloatRange,w=mN(l),C=function(M,$){return{xCenter:.5*M.width,yCenter:.5*M.height,width:M.width,height:M.height,rotation:0}}(w),T=function(M,$,V){if(V===void 0&&(V=!1),!V)return{top:0,left:0,right:0,bottom:0};var G=$.height,Q=$.width;gN($,"targetSize"),gN(M,"roi");var nt,it,ht=G/Q,kt=M.height/M.width,Nt=0,$t=0;return ht>kt?(nt=M.width,it=M.width*ht,$t=(1-kt/ht)/2):(nt=M.height/ht,it=M.height,Nt=(1-ht/kt)/2),M.width=nt,M.height=it,{top:$t,left:Nt,right:Nt,bottom:$t}}(C,u,c),x=function(M,$,V,G){var Q=M.width,nt=M.height,it=1,ht=Math.cos(M.rotation),kt=Math.sin(M.rotation),Nt=M.xCenter,$t=M.yCenter,Ut=1/$,Pt=1/V,re=new Array(16);return re[0]=Q*ht*it*Ut,re[1]=-nt*kt*Ut,re[2]=0,re[3]=(-.5*Q*ht*it+.5*nt*kt+Nt)*Ut,re[4]=Q*kt*it*Pt,re[5]=nt*ht*Pt,re[6]=0,re[7]=(-.5*nt*ht-.5*Q*kt*it+$t)*Pt,re[8]=0,re[9]=0,re[10]=Q*Ut,re[11]=0,re[12]=0,re[13]=0,re[14]=0,re[15]=1,function(ue){if(ue.length!==16)throw new Error("Array length must be 16 but got "+ue.length);return[[ue[0],ue[1],ue[2],ue[3]],[ue[4],ue[5],ue[6],ue[7]],[ue[8],ue[9],ue[10],ue[11]],[ue[12],ue[13],ue[14],ue[15]]]}(re)}(C,w.width,w.height),A=(0,m.tidy)(function(){var M,$=(M=l)instanceof m.Tensor?M:m.browser.fromPixels(M),V=(0,m.tensor2d)(function(nt,it,ht){return gN(ht,"inputResolution"),[1/ht.width*nt[0][0]*it.width,1/ht.height*nt[0][1]*it.width,nt[0][3]*it.width,1/ht.width*nt[1][0]*it.height,1/ht.height*nt[1][1]*it.height,nt[1][3]*it.height,0,0]}(x,w,u),[1,8]),G=f==="zero"?"constant":"nearest",Q=m.image.transform((0,m.expandDims)((0,m.cast)($,"float32")),V,"bilinear",G,0,[u.height,u.width]);return y!=null?function(nt,it){var ht=function(kt,Nt,$t,Ut){var Pt=(Ut-$t)/255;return{scale:Pt,offset:$t-0*Pt}}(0,0,it[0],it[1]);return(0,m.tidy)(function(){return(0,m.add)((0,m.mul)(nt,ht.scale),ht.offset)})}(Q,y):Q});return{imageTensor:A,padding:T,transformationMatrix:x}}var yN={runtime:"tfjs",modelType:"general",modelUrl:"https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/general/1"},Vet={flipHorizontal:!1},tmt={outputTensorSize:{width:256,height:256},keepAspectRatio:!1,borderMode:"zero",outputTensorFloatRange:[0,1]},vC={outputTensorSize:{width:256,height:144},keepAspectRatio:!1,borderMode:"zero",outputTensorFloatRange:[0,1]},vN={activation:"none"},Get=function(){function l(i){this.mask=i}return l.prototype.toCanvasImageSource=function(){return jo(this,void 0,void 0,function(){return as(this,function(i){return[2,iN(this.mask)]})})},l.prototype.toImageData=function(){return jo(this,void 0,void 0,function(){return as(this,function(i){return[2,BB(this.mask)]})})},l.prototype.toTensor=function(){return jo(this,void 0,void 0,function(){return as(this,function(i){return[2,this.mask]})})},l.prototype.getUnderlyingType=function(){return"tensor"},l}();function o3(l){return B4(l),"person"}var s3,Het=function(){function l(i,o){this.modelType=i,this.model=o}return l.prototype.segmentPeople=function(i,o){return jo(this,void 0,void 0,function(){var u,c=this;return as(this,function(f){return o=function(y){if(y==null)return xc({},Vet);var w=xc({},y);return w.flipHorizontal==null&&(w.flipHorizontal=Vet.flipHorizontal),w}(o),i==null?(this.reset(),[2,[]]):(u=(0,m.tidy)(function(){var y=Kd(i,c.modelType==="general"?tmt:vC).imageTensor,w=(0,m.slice)(c.model.predict(y),[0,0,0,1],-1),C=mN(i),T=function(M,$,V){return(0,m.tidy)(function(){var G=(0,m.squeeze)(M,[0]),Q=G.shape[2];if(Q===1){var nt=G;switch($.activation){case"none":break;case"sigmoid":nt=(0,m.sigmoid)(nt);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported ("+$.activation+")")}var it=V?m.image.resizeBilinear(nt,[V.height,V.width]):nt;return(0,m.squeeze)(it,[2])}throw new Error("Unsupported number of tensor channels "+Q)})}(w,vN,C),x=(0,m.expandDims)(T,2),A=(0,m.pad)(x,[[0,0],[0,0],[0,1]]);return(0,m.mirrorPad)(A,[[0,0],[0,0],[0,2]],"symmetric")}),[2,[{maskValueToLabel:o3,mask:new Get(u)}]])})})},l.prototype.dispose=function(){this.model.dispose()},l.prototype.reset=function(){},l}();function Yet(l){return jo(this,void 0,void 0,function(){var i,o,u;return as(this,function(c){switch(c.label){case 0:return i=function(f){if(f==null)return xc({},yN);var y=xc({},f);if(y.runtime="tfjs",y.modelType==null&&(y.modelType=yN.modelType),y.modelType!=="general"&&y.modelType!=="landscape")throw new Error("Model type must be one of general or landscape, but got "+y.modelType);return y.modelUrl==null&&(y.modelType==="general"?y.modelUrl="https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/general/1":y.modelUrl="https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/landscape/1"),y}(l),o=typeof i.modelUrl=="string"&&i.modelUrl.indexOf("https://tfhub.dev")>-1,[4,Vc(i.modelUrl,{fromTFHub:o})];case 1:return u=c.sent(),[2,new Het(i.modelType,u)]}})})}(function(l){l.BodyPix="BodyPix",l.MediaPipeSelfieSegmentation="MediaPipeSelfieSegmentation"})(s3||(s3={}));function emt(l,i,o,u,c,f){f===void 0&&(f={r:0,g:255,b:255,a:255});for(var y=-1;y<=c;y++)for(var w=-1;w<=c;w++)if(y!==0&&w!==0){var C=(i+y)*u+(o+w);l[4*C+0]=f.r,l[4*C+1]=f.g,l[4*C+2]=f.b,l[4*C+3]=f.a}}function nmt(l,i,o,u,c,f,y){y===void 0&&(y=1);for(var w=0,C=-y;C<=y;C++)for(var T=-y;T<=y;T++)if(C!==0&&T!==0){var x=(i+C)*u+(o+T);(!c[l[4*x]]||l[4*x+3]<f)&&(w+=1)}return w>0}function bN(l,i,o,u,c,f){return i===void 0&&(i={r:0,g:0,b:0,a:0}),o===void 0&&(o={r:0,g:0,b:0,a:255}),u===void 0&&(u=!1),c===void 0&&(c=.5),f===void 0&&(f=Array.from(Array(256).keys())),jo(this,void 0,void 0,function(){var y,w,C,T,x,A,M,$,V,G,Q,nt,it,ht;return as(this,function(kt){switch(kt.label){case 0:return(y=Array.isArray(l)?l:[l]).length===0?[2,null]:[4,Promise.all(y.map(function(Nt){return Nt.mask.toImageData()}))];case 1:for(w=kt.sent(),C=w[0],T=C.width,x=C.height,A=new Uint8ClampedArray(T*x*4),M=Math.round(255*c),$=new Array(256).fill(!1),f.forEach(function(Nt){return $[Nt]=!0}),V=0;V<x;V++)for(G=0;G<T;G++)for(A[4*(Q=V*T+G)+0]=o.r,A[4*Q+1]=o.g,A[4*Q+2]=o.b,A[4*Q+3]=o.a,nt=0,it=w;nt<it.length;nt++)ht=it[nt],$[ht.data[4*Q]]&&ht.data[4*Q+3]>=M&&(A[4*Q]=i.r,A[4*Q+1]=i.g,A[4*Q+2]=i.b,A[4*Q+3]=i.a,u&&V-1>=0&&V+1<x&&G-1>=0&&G+1<T&&nmt(ht.data,V,G,T,$,M)&&emt(A,V,G,T,1));return[2,new ImageData(A,T,x)]}})})}function ij(l,i,o,u){return o===void 0&&(o={r:0,g:0,b:0,a:255}),u===void 0&&(u=.5),jo(this,void 0,void 0,function(){var c,f,y,w,C,T,x,A,M,$,V,G,Q,nt;return as(this,function(it){switch(it.label){case 0:return(c=Array.isArray(l)?l:[l]).length===0?[2,null]:[4,Promise.all(c.map(function(ht){return ht.mask.toImageData()}))];case 1:for(f=it.sent(),y=f[0],w=y.width,C=y.height,T=new Uint8ClampedArray(w*C*4),x=Math.round(255*u),A=0;A<C*w;++A)for(T[0+(M=4*A)]=o.r,T[M+1]=o.g,T[M+2]=o.b,T[M+3]=o.a,$=0,V=f;$<V.length;$++)(G=V[$]).data[M+3]>=x&&(Q=G.data[M],nt=i(Q),T[M+0]=nt.r,T[M+1]=nt.g,T[M+2]=nt.b,T[M+3]=nt.a);return[2,new ImageData(T,w,C)]}})})}let wN={LEFT_FACE:{id:0,color:[110,64,170]},RIGHT_FACE:{id:1,color:[143,61,178]},LEFT_UPPER_ARM_FRONT:{id:2,color:[178,60,178]},LEFT_UPPER_ARM_BACK:{id:3,color:[210,62,167]},RIGHT_UPPER_ARM_FRONT:{id:4,color:[238,67,149]},RIGHT_UPPER_ARM_BACK:{id:5,color:[255,78,125]},LEFT_LOWER_ARM_FRONT:{id:6,color:[255,94,99]},LEFT_LOWER_ARM_BACK:{id:7,color:[255,115,75]},RIGHT_LOWER_ARM_FRONT:{id:8,color:[255,140,56]},RIGHT_LOWER_ARM_BACK:{id:9,color:[239,167,47]},LEFT_HAND:{id:10,color:[217,194,49]},RIGHT_HAND:{id:11,color:[194,219,64]},TORSO_FRONT:{id:12,color:[175,240,91]},TORSO_BACK:{id:13,color:[135,245,87]},LEFT_UPPER_LEG_FRONT:{id:14,color:[96,247,96]},LEFT_UPPER_LEG_BACK:{id:15,color:[64,243,115]},RIGHT_UPPER_LEG_FRONT:{id:16,color:[40,234,141]},RIGHT_UPPER_LEG_BACK:{id:17,color:[28,219,169]},LEFT_LOWER_LEG_FRONT:{id:18,color:[26,199,194]},LEFT_LOWER_LEG_BACK:{id:19,color:[33,176,213]},RIGHT_LOWER_LEG_FRONT:{id:20,color:[47,150,224]},RIGHT_LOWER_LEG_BACK:{id:21,color:[65,125,224]},LEFT_FOOT:{id:22,color:[84,101,214]},RIGHT_FOOT:{id:23,color:[99,81,195]}};class qet{constructor(i,o,u){this.modelName=Lm(i,["BodyPix","SelfieSegmentation"],"SelfieSegmentation","bodySegmentation"),this.model=null,this.config=o,this.runtimeConfig={},this.detectMedia=null,this.detectCallback=null,this.ready=Ws(this.loadModel(),u)}loadModel(){return ce(this,null,function*(){let i,o;return this.modelName==="BodyPix"?(i=s3.BodyPix,o=Ip(this.config,{architecture:{type:"enum",enums:["MobileNetV1","ResNet50"],default:"ResNet50"},multiplier:{type:"enum",enums:[.5,.75,1],default:1,ignore:u=>u.architecture!=="MobileNetV1"},outputStride:{type:"enum",enums:u=>u.architecture==="MobileNetV1"?[8,16]:[16,32],default:16},quantBytes:{type:"enum",enums:[1,2,4],default:2},modelURL:{type:"string",default:void 0}},"bodySegmentation"),this.runtimeConfig=Ip(this.config,{maskType:{type:"enum",enums:["person","background","parts"],default:"background"},multiSegmentation:{type:"boolean",default:!1},segmentBodyParts:{type:"boolean",default:!0},flipHorizontal:{type:"boolean",alias:"flipped",default:!1}},"bodySegmentation"),this.getPartsId=()=>{let u={};for(let c in wN)u[c]=wN[c].id;return u}):(i=s3.MediaPipeSelfieSegmentation,o=Ip(this.config,{runtime:{type:"enum",enums:["mediapipe, tfjs"],default:"tfjs"},modelType:{type:"enum",enums:["general","landscape"],default:"general"},solutionPath:{type:"string",default:"https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation",ignore:u=>u.runtime!=="mediapipe"},modelURL:{type:"string",default:void 0}},"bodySegmentation"),this.runtimeConfig=Ip(this.config,{maskType:{type:"enum",enums:["person","background"],default:"background"},flipHorizontal:{type:"boolean",alias:"flipped",default:!1}},"bodySegmentation")),yield m.ready(),this.model=yield function(u,c){return jo(this,void 0,void 0,function(){var f,y;return as(this,function(w){switch(u){case s3.MediaPipeSelfieSegmentation:if(f=void 0,(y=c)!=null){if(y.runtime==="tfjs")return[2,Yet(y)];if(y.runtime==="mediapipe")return[2,Wet(y)];f=y.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+f);case s3.BodyPix:return[2,nj(y=c)];default:throw new Error(u+" is not a supported model name.")}})})}(i,o),this})}detect(...i){return ce(this,null,function*(){let o=Uu(...i);o.require("image","An html or p5.js image, video, or canvas element argument is required for detectStart().");let{image:u,callback:c}=o;yield E0(u,!1);let f=yield this.model.segmentPeople(u,this.runtimeConfig),y={};if(f.length){this.runtimeConfig.flipHorizontal&&(f[0].mask.mask=this.flipImageData(f[0].mask.mask)),y.imageData=yield f[0].mask.toImageData();let w=new Array(y.imageData.width*y.imageData.height);for(let C=0;C<w.length;C++)w[C]=y.imageData.data[4*C];y.data=w}else y.data=[],y.imageData=null;switch(this.runtimeConfig.maskType){case"background":y.maskImageData=yield bN(f,{r:0,g:0,b:0,a:255},{r:0,g:0,b:0,a:0});break;case"person":y.maskImageData=yield bN(f);break;case"parts":y.maskImageData=yield ij(f,UB,{r:255,g:255,b:255,a:255})}return y.mask=this.generateP5Image(y.maskImageData),c&&c(y),y})}detectStart(...i){let o=Uu(...i);o.require("image","An html or p5.js image, video, or canvas element argument is required for detectStart()."),o.require("callback","A callback function argument is required for detectStart()."),this.detectMedia=o.image,this.detectCallback=o.callback,this.signalStop=!1,this.detecting||(this.detecting=!0,this.detectLoop()),this.prevCall==="start"&&console.warn("detectStart() was called more than once without calling detectStop(). Only the latest detectStart() call will take effect."),this.prevCall="start"}detectStop(){this.detecting&&(this.signalStop=!0),this.prevCall="stop"}detectLoop(){return ce(this,null,function*(){for(yield E0(this.detectMedia,!1);!this.signalStop;){let i=yield this.model.segmentPeople(this.detectMedia,this.runtimeConfig),o={};if(i.length){this.runtimeConfig.flipHorizontal&&(i[0].mask.mask=this.flipImageData(i[0].mask.mask)),o.imageData=yield i[0].mask.toImageData();let u=new Array(o.imageData.width*o.imageData.height);for(let c=0;c<u.length;c++)u[c]=o.imageData.data[4*c];o.data=u}else o.data=[],o.imageData=null;switch(this.runtimeConfig.maskType){case"background":o.maskImageData=yield bN(i,{r:0,g:0,b:0,a:255},{r:0,g:0,b:0,a:0});break;case"person":o.maskImageData=yield bN(i);break;case"parts":o.maskImageData=yield ij(i,UB,{r:255,g:255,b:255,a:255})}o.mask=this.generateP5Image(o.maskImageData),this.detectCallback(o),yield m.nextFrame()}this.detecting=!1,this.signalStop=!1})}flipImageData(i){let{width:o,height:u,data:c}=i,f=new Uint8ClampedArray(o*u*4);for(let y=0;y<u;y++)for(let w=0;w<o;w++){let C=4*(y*o+w),T=4*(y*o+(o-w-1));f[T]=c[C],f[T+1]=c[C+1],f[T+2]=c[C+2],f[T+3]=c[C+3]}return new ImageData(f,o,u)}generateP5Image(i){if(window?.p5){let o=new p5.Image(i.width,i.height);return o.drawingContext.putImageData(i,0,0),o}return i}}let Xet="1.2.1",rmt=Xet,xN={bodyPose:Y0t,bodySegmentation:(...l)=>{let{string:i,options:o={},callback:u}=Uu(...l);return new qet(i,o,u)},faceMesh:Sft,handPose:yQ,imageClassifier:set,neuralNetwork:Gdt,sentiment:Fz,soundClassifier:$B},kN=Object.assign({p5Utils:r1},xN,{tf:ee,tfvis:a4,setBackend:function(l){switch(l){case"cpu":m.setBackend("cpu");break;case"webgl":m.setBackend("webgl");break;case"webgpu":m.setBackend("webgpu");break;default:throw new Error(`Invalid backend: ${l}. The backend parameter must be set to one of the following strings: "cpu", "webgl", or "webgpu".`)}return!0},version:Xet,setP5:r1.setP5.bind(r1)});r1.shouldPreload(kN,Object.keys(xN)),console.log(`
\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}
\u{1F31F} Thank you for using ml5.js v${rmt} \u{1F31F}

Please read our community statement to ensure 
that the use of this software reflects the values 
of the ml5.js community:
\u21B3 https://ml5js.org/about

Reporting: 
\u21B3 https://github.com/ml5js/ml5-next-gen/issues
\u21B3 Email: info@ml5js.org 
\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}\u{1F308}`);let Ket=kN})(),W=W.default})())}(fbt)),fbt.exports}var uee=see(),pbt=dbt(uee),txt=class{constructor(){this.started=!1}start(){if(!this.started){this.started=!0;let v=Xe.modelsPath;pbt.setBackend("webgl"),this.classifier=pbt.imageClassifier(v,this.imageClassifierLoaded),this.faceapi=pbt.faceMesh({maxFaces:1,refineLandmarks:!1,flipped:!1},this.faceApiLoaded)}}imageClassifierLoaded(){Xe.debug&&console.log("ML5 imageClassifierLoaded LOADED!!!")}faceApiLoaded(){Xe.debug&&console.log("ML5 faceApiLoaded LOADED!!!")}gotResults(v){Xe.debug&&console.log(v)}},J3=new txt,lee="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzM1IiBoZWlnaHQ9IjIzOCIgdmlld0JveD0iMCAwIDMzNSAyMzgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cGF0aCBkPSJNMzM0Ljg4NiA0Ni45MjQxSDMyNy45MDhWNy45NzUzN0gyODguMjczVjAuOTkzMTY0SDMzNC44ODZWNDYuOTI0MVoiIGZpbGw9IiNFNkU2RTYiLz4NCjxwYXRoIGQ9Ik0zMzUuMDAxIDIzNy4wMDdIMjg5LjA3VjIzMC4wMjVIMzI4LjAxOVYxOTAuMzlIMzM1LjAwMVYyMzcuMDA3WiIgZmlsbD0iI0U2RTZFNiIvPg0KPHBhdGggZD0iTTQ2LjcyNzEgMjM3LjAwN0gwLjEwOTg2M1YxOTEuMDcySDcuMDkyMDdWMjMwLjAyNUg0Ni43MjcxVjIzNy4wMDdaIiBmaWxsPSIjRTZFNkU2Ii8+DQo8cGF0aCBkPSJNNi45ODE3MiA0Ny42MTA0SC0wLjAwMDQ4ODI4MVYwLjk5MzE2NEg0NS45MzA1VjcuOTc1MzdINi45ODE3MlY0Ny42MTA0WiIgZmlsbD0iI0U2RTZFNiIvPg0KPC9zdmc+DQo=",cee="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzM1IiBoZWlnaHQ9IjIzOCIgdmlld0JveD0iMCAwIDMzNSAyMzgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cGF0aCBkPSJNMzM0Ljg4NiA0Ni45MjQxSDMyNy45MDhWNy45NzUzN0gyODguMjczVjAuOTkzMTY0SDMzNC44ODZWNDYuOTI0MVoiIGZpbGw9IiM0Y2E1ODUiLz4NCjxwYXRoIGQ9Ik0zMzUuMDAxIDIzNy4wMDdIMjg5LjA3VjIzMC4wMjVIMzI4LjAxOVYxOTAuMzlIMzM1LjAwMVYyMzcuMDA3WiIgZmlsbD0iIzRjYTU4NSIvPg0KPHBhdGggZD0iTTQ2LjcyNzEgMjM3LjAwN0gwLjEwOTg2M1YxOTEuMDcySDcuMDkyMDdWMjMwLjAyNUg0Ni43MjcxVjIzNy4wMDdaIiBmaWxsPSIjNGNhNTg1Ii8+DQo8cGF0aCBkPSJNNi45ODE3MiA0Ny42MTA0SC0wLjAwMDQ4ODI4MVYwLjk5MzE2NEg0NS45MzA1VjcuOTc1MzdINi45ODE3MlY0Ny42MTA0WiIgZmlsbD0iIzRjYTU4NSIvPg0KPC9zdmc+DQo=",MD=p=>new Promise((v,k)=>{let N=new FileReader;N.onloadend=()=>v(N.result),N.readAsDataURL(p)}),Gst=p=>Math.ceil(p.length*6/8/1e3)/1e3,tp=p=>new Promise(v=>setTimeout(v,p)),DD=(p="",v="",k="")=>ce(void 0,null,function*(){let N=yield qu.getAllEctData();return{store_values:{request_id:Xe.requestId,redirect_id:Xe.redirectId,token:Xe.token},session_values:N,parameter_values:{request_id:p,redirect_id:v,token:k}}});function hee(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(p){let v=Math.random()*16|0;return(p=="x"?v:v&3|8).toString(16)})}var t2=function(p){return p[p.Full=0]="Full",p[p.Tilt=1]="Tilt",p}(t2||{});function n0(p,v){return p||v}function El(p,v){return p[v]}var Yf=void 0,dh=null,b4t="",Kut="function",fG="object",tw="prototype",Hst="__proto__",t8="undefined",Yst="constructor",w4t="Symbol",mD="length",qst="name",Sd="call",pG="toString",x4t="getOwnPropertyDescriptor",np=n0(Object),k4t=El(np,tw),QFt=n0(String),M8=El(QFt,tw),mG=n0(Math),JFt=n0(Array),Zut=El(JFt,tw),lw=El(Zut,"slice"),LNt="_polyfill",$Nt="__nw21$polytype__";function _l(p,v){try{return{v:p.apply(this,v)}}catch(k){return{e:k}}}function dee(p,v,k){var N=_l(p,k);return N.e?v:N.v}var mbt;function Qut(p){return function(v){return typeof v===p}}function tOt(p){var v="[object "+p+"]";return function(k){return!!(k&&fee(k)===v)}}function fee(p){return k4t[pG].call(p)}function Sl(p){return typeof p===t8||p===t8}function pee(p){return p===Yf}function Fr(p){return p===dh||Sl(p)}function S4t(p){return p===dh||p===Yf}function mee(p){return!!p||p!==Yf}function gee(p){return!mbt&&(mbt=["string","number","boolean",t8,"symbol","bigint"]),p!==fG&&mbt.indexOf(p)!==-1}var Sa=Qut("string"),Ia=Qut(Kut);function t0(p){return!p&&Fr(p)?!1:!!p&&typeof p===fG}var to=El(JFt,"isArray"),yee=tOt("Date"),gG=Qut("number"),eOt=Qut("boolean"),_4t=tOt("Error");function f5(p){return!!(p&&p.then&&Ia(p.then))}function Xst(p){return!(!p||dee(function(){return!(p&&0+p)},!p))}function C4t(){}function vee(){return!1}var Kf=n0(QFt),bee="[object Error]";function Bi(p,v){var k=b4t,N=k4t[pG][Sd](p);N===bee&&(p={stack:Kf(p.stack),message:Kf(p.message),name:Kf(p.name)});try{k=JSON.stringify(p,dh,Yf),k=(k?k.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: "):dh)||Kf(p)}catch(F){k=" - "+Bi(F)}return N+": "+k}function em(p){throw new Error(p)}function mv(p){throw new TypeError(p)}function Jut(p){S4t(p)&&mv("Cannot convert undefined or null to object")}function wee(p){Sa(p)||mv("'"+Bi(p)+"' is not a string")}function wg(p,v){return!!p&&k4t.hasOwnProperty[Sd](p,v)}var xee=n0(El(np,x4t),C4t),n5=n0(El(np,"hasOwn"),kee);function kee(p,v){return Jut(p),wg(p,v)||!!xee(p,v)}function Eo(p,v,k){if(p&&(t0(p)||Ia(p))){for(var N in p)if(n5(p,N)&&v[Sd](p,N,p[N])===-1)break}}function Li(p,v,k){if(p)for(var N=p[mD]>>>0,F=0;F<N&&!(F in p&&v[Sd](p,p[F],F,p)===-1);F++);}var D8=tlt;function tlt(p,v,k){var N=v?v[p]:dh;return function(F){var W=(F?F[p]:dh)||N;if(W||k){var L=arguments;return(W||k).apply(F,W?lw[Sd](L,1):L)}mv('"'+Kf(p)+'" not defined for '+Bi(F))}}function See(p){return function(v){return v[p]}}var _ee=n0(El(np,x4t),C4t),Rot={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"};function Cee(p){var v={};if(v[Rot.c]=!0,v[Rot.e]=!0,p.l){v.get=function(){return p.l.v};var k=_ee(p.l,"v");k&&k.set&&(v.set=function(N){p.l.v=N})}return Eo(p,function(N,F){v[Rot[N]]=pee(F)?v[Rot[N]]:F}),v}var cw=El(np,"defineProperty"),Eee=El(np,"defineProperties");function Ro(p,v,k){return cw(p,v,Cee(k))}function nOt(p,v,k,N,F){var W={};return Eo(p,function(L,O){Kst(W,L,v?O:L),Kst(W,O,L)}),N?N(W):W}function Kst(p,v,k,N){cw(p,v,{value:k,enumerable:!0,writable:!1})}var Tee=n0(El(np,"isFrozen"),vee),rOt=El(np,"freeze");function Aee(p){return p}function Iee(p){return Jut(p),p[Hst]||dh}var ext=El(np,"assign"),ew=El(np,"keys");function iOt(p,v){if((to(p)||t0(p)||Ia(p))&&!Tee(p)){for(var k=0;k<v.length;k++)if(v[k]===p)return p;v.push(p),Eo(p,function(N,F){iOt(F,v)}),r2(p)}return p}function yG(p){return rOt?iOt(p,[]):p}var r2=n0(rOt,Aee),nxt=n0(El(np,"getPrototypeOf"),Iee);function Nee(p){return nOt(p,1,0,r2)}function Mee(p){return nOt(p,0,0,r2)}function Dee(p){var v={};return Eo(p,function(k,N){Kst(v,k,N[1]),Kst(v,N[0],N[1])}),r2(v)}function Ree(p){return Dee(p)}var aOt=Mee({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12}),zNt="__tsUtils$gblCfg",gbt;function oOt(){var p;return typeof globalThis!==t8&&(p=globalThis),!p&&typeof self!==t8&&(p=self),!p&&typeof window!==t8&&(p=window),!p&&typeof uw!==t8&&(p=uw),p}function elt(){if(!gbt){var p=_l(oOt).v||{};gbt=p[zNt]=p[zNt]||{}}return gbt}var sOt=El(mG,"min"),NV=El(mG,"max"),PNt=D8("slice",M8),gv=D8("substring",M8),Vk=tlt("substr",M8,Fee);function Fee(p,v,k){return Jut(p),k<0?b4t:(v=v||0,v<0&&(v=NV(v+p[mD],0)),Sl(k)?PNt(p,v):PNt(p,v,v+k))}function E4t(p,v){return gv(p,0,v)}function Oee(p,v){return p&&(_l(function(){p[LNt]=!0,p[$Nt]=v}),_l(Ro,[p,LNt,{v:!0,w:!1,e:!1}]),_l(Ro,[p,$Nt,{v,w:!1,e:!1}])),p}var hw=n0(El(np,"create"),Lee);function Lee(p,v){var k=null;function N(){}if(S4t(p))k={};else{var F=typeof p;F!==fG&&F!==Kut&&mv("Prototype must be an Object or function: "+Bi(p)),N[tw]=p,_l(function(){N[Hst]=p}),k=new N}return v&&_l(Eee,[k,v]),k}function i2(){return(Date.now||$ee)()}function $ee(){return new Date().getTime()}function e8(p,v,k){return p.apply(v,k)}var Mc;function E5(){Mc=elt()}function uOt(p,v){var k={};return!Mc&&E5(),k.b=Mc.lzy,cw(k,"v",{configurable:!0,get:function(){var N=e8(p,null,v);return Mc.lzy||cw(k,"v",{value:N}),k.b=Mc.lzy,N}}),k}var zee=El(mG,"random"),Pee=uOt(function(){for(var p=i2().toString(36).slice(2);p.length<16;)p+=zee().toString(36).slice(2);return p=p.substring(0,16),p}),BNt="_urid",Bee="$nw21sym",ybt,jee=0;function Uee(){if(!ybt){var p=elt();ybt=p.gblSym=p.gblSym||{k:{},s:{}}}return ybt}var Fot;function T4t(p){var v="_"+jee+++"_"+Pee.v,k=w4t+"("+p+")";function N(W,L){Ro(F,W,{v:L,e:!1,w:!1})}var F=hw(null);return N("description",Kf(p)),N(pG,function(){return k+Bee+v}),N("valueOf",function(){return F}),N("v",k),N("_uid",v),Oee(F,"symbol")}function Wee(p){var v=Uee();if(!n5(v.k,p)){var k=T4t(p),N=ew(v.s).length;k[BNt]=function(){return N+"_"+k[pG]()},v.k[p]=k,v.s[k[BNt]()]=Kf(p)}return v.k[p]}function Vee(p){!Fot&&(Fot={});var v,k=aOt[p];return k&&(v=Fot[k]=Fot[k]||T4t(w4t+"."+k)),v}function _g(p){return cw({toJSON:function(){return p}},"v",{value:p})}var lOt="window",MV;function GD(p,v){var k;return function(){return!Mc&&E5(),(!k||Mc.lzy)&&(k=_g(_l(p,v).v)),k.v}}function bg(p){return!Mc&&E5(),(!MV||p===!1||Mc.lzy)&&(MV=_g(_l(oOt).v||dh)),MV.v}function Xu(p,v){var k;if(!MV||v===!1?k=bg(v):k=MV.v,k&&k[p])return k[p];if(p===lOt)try{return window}catch{}return dh}function cOt(){return!!xd()}var xd=GD(Xu,["document"]);function nlt(){return!!am()}var am=GD(Xu,[lOt]);function Gee(){return!!yv()}var yv=GD(Xu,["navigator"]);function Hee(){return!!hOt()}var hOt=GD(Xu,["history"]),Yee=GD(function(){return!!_l(function(){return Iu&&(Iu.versions||{}).node}).v}),dOt=GD(function(){return!!_l(function(){return self&&self instanceof WorkerGlobalScope}).v}),RD,vbt;function rlt(){return RD=_g(_l(Xu,[w4t]).v),RD}function qee(p){var v=(Mc.lzy?0:RD)||rlt();return v.v?v.v[p]:Yf}function Xee(){return!!Kee()}function Kee(){return!Mc&&E5(),((Mc.lzy?0:RD)||rlt()).v}function A4t(p,v){var k=aOt[p];!Mc&&E5();var N=(Mc.lzy?0:RD)||rlt();return N.v?N.v[k||p]:Vee(p)}function YW(p,v){!Mc&&E5();var k=(Mc.lzy?0:RD)||rlt();return k.v?k.v(p):T4t(p)}function I4t(p){return!Mc&&E5(),vbt=(Mc.lzy?0:vbt)||_g(_l(qee,["for"]).v),(vbt.v||Wee)(p)}function rxt(p){return!!p&&Ia(p.next)}function fOt(p){return!S4t(p)&&Ia(p[A4t(3)])}var Oot;function N4t(p,v,k){if(p&&(rxt(p)||(!Oot&&(Oot=_g(A4t(3))),p=p[Oot.v]?p[Oot.v]():dh),rxt(p))){var N=Yf,F=Yf;try{for(var W=0;!(F=p.next()).done&&v[Sd](p,F.value,W,p)!==-1;)W++}catch(L){N={e:L},p.throw&&(F=dh,p.throw(N))}finally{try{F&&!F.done&&p.return&&p.return(F)}finally{if(N)throw N.e}}}}function uD(p,v){return!Sl(v)&&p&&(to(v)?e8(p.push,p,v):rxt(v)||fOt(v)?N4t(v,function(k){p.push(k)}):p.push(v)),p}var gf=D8("indexOf",Zut),jV=D8("map",Zut);function ilt(p,v,k){return((p?p.slice:dh)||lw).apply(p,lw[Sd](arguments,1))}var Zee=D8("reduce",Zut),bbt,pOt=n0(El(np,"setPrototypeOf"),Qee);function Qee(p,v){var k;return!bbt&&(bbt=_g((k={},k[Hst]=[],k instanceof Array))),bbt.v?p[Hst]=v:Eo(v,function(N,F){return p[N]=F}),p}function Jee(p,v,k){_l(Ro,[v,qst,{v:p,c:!0,e:!1}]),v=pOt(v,k);function N(){this[Yst]=v,_l(Ro,[this,qst,{v:p,c:!0,e:!1}])}return v[tw]=k===dh?hw(k):(N[tw]=k[tw],new N),v}function jNt(p,v){v&&(p[qst]=v)}function mOt(p,v,k){var N=Error,F=N[tw][qst],W=Error.captureStackTrace;return Jee(p,function(){var L=this,O=arguments;try{_l(jNt,[N,p]);var S=e8(N,L,lw[Sd](O))||L;if(S!==L){var B=nxt(L);B!==nxt(S)&&pOt(S,B)}return W&&W(S,L[Yst]),v&&v(S,O),S}finally{_l(jNt,[N,F])}},N)}var wbt;function tne(p){throw wbt||(wbt=mOt("UnsupportedError")),new wbt(p)}function ene(p){return function(k){return Jut(k),k&&k.replace&&(k=k.replace(p,b4t)),k}}var nne=ene(/^\s+|(?=\s)\s+$/g),Nu=tlt("trim",M8,nne),rm=El(mG,"floor"),xbt,kbt,Sbt;function Zf(p){if(!p||typeof p!==fG)return!1;Sbt||(Sbt=nlt()?am():!0);var v=!1;if(p!==Sbt){kbt||(xbt=Function[tw][pG],kbt=xbt[Sd](np));try{var k=nxt(p);v=!k,v||(wg(k,Yst)&&(k=k[Yst]),v=!!(k&&typeof k===Kut&&xbt[Sd](k)===kbt))}catch{}}return v}function rne(p){return p.value&&yOt(p),!0}var UNt=[sne,yOt,lne,une];function ine(p,v,k,N){var F;return Li(p,function(W){if(W.k===v)return F=W,-1}),F||(F={k:v,v},p.push(F),N(F)),F.v}function M4t(p,v,k,N){var F=k.handler,W=k.path?N?k.path.concat(N):k.path:[],L={handler:k.handler,src:k.src,path:W},O=typeof v,S=!1,B=v===dh;B||(v&&O===fG?S=Zf(v):B=gee(O));var j={type:O,isPrim:B,isPlain:S,value:v,result:v,path:W,origin:k.src,copy:function(K,Z){return M4t(p,K,Z?L:k,Z)},copyTo:function(K,Z){return gOt(p,K,Z,L)}};return j.isPrim?F&&F[Sd](k,j)?j.result:v:ine(p,v,W,function(K){Ro(j,"result",{g:function(){return K.v},s:function(X){K.v=X}});for(var Z=0,Y=F;!(Y||(Z<UNt.length?UNt[Z++]:rne))[Sd](k,j);)Y=dh})}function gOt(p,v,k,N){if(!Fr(k))for(var F in k)v[F]=M4t(p,k[F],N,F);return v}function ane(p,v,k){var N={handler:k,src:v,path:[]};return gOt([],p,v,N)}function one(p,v){var k={handler:v,src:p};return M4t([],p,k)}function sne(p){var v=p.value;if(to(v)){var k=p.result=[];return k.length=v.length,p.copyTo(k,v),!0}return!1}function une(p){var v=p.value;return yee(v)?(p.result=new Date(v.getTime()),!0):!1}function lne(p){return p.type===Kut}function yOt(p){var v=p.value;if(v&&p.isPlain){var k=p.result={};return p.copyTo(k,v),!0}return!1}function vOt(p,v){return Li(v,function(k){ane(p,k)}),p}function WNt(p,v,k,N,F,W,L){return vOt(one(p)||{},lw[Sd](arguments))}function cne(p,v,k,N,F,W,L){return vOt(p||{},lw[Sd](arguments))}var bOt=D8("split",M8);function wOt(p,v,k){if(p&&v){var N=bOt(v,"."),F=N.pop();Li(N,function(W){Fr(p[W])&&(p[W]={}),p=p[W]}),p[F]=k}}var hne=See(mD),_bt;function dw(){return!Mc&&E5(),(!_bt||Mc.lzy)&&(_bt=_g(_l(Xu,["performance"]).v)),_bt.v}var xOt=El(mG,"round"),dne=n0(El(np,x4t),C4t),kOt=tlt("endsWith",M8,fne);function fne(p,v,k){wee(p);var N=Sa(v)?v:Kf(v),F=!Sl(k)&&k<p[mD]?k:p[mD];return gv(p,F-N[mD],F)===N}var Qf=D8("indexOf",M8),Cbt="ref",Ebt="unref",Tbt="hasRef",pne="enabled";function mne(p,v,k){var N=!0,F=p?v(dh):dh,W;function L(){return N=!1,F&&F[Ebt]&&F[Ebt](),W}function O(){F&&k(F),F=dh}function S(){return F=v(F),N||L(),W}function B(j){!j&&F&&O(),j&&!F&&S()}return W={cancel:O,refresh:S},W[Tbt]=function(){return F&&F[Tbt]?F[Tbt]():N},W[Cbt]=function(){return N=!0,F&&F[Cbt]&&F[Cbt](),W},W[Ebt]=L,W=cw(W,pne,{get:function(){return!!F},set:B}),{h:W,dn:function(){F=dh}}}var gne,yne;function vne(p){var v=Ia(p)?p:gne;if(!v){var k=elt().tmOut||[];to(k)&&k.length>0&&Ia(k[0])&&(v=k[0])}return v||setTimeout}function bne(p){var v=Ia(p)?p:yne;if(!v){var k=elt().tmOut||[];to(k)&&k.length>1&&Ia(k[1])&&(v=k[1])}return v||clearTimeout}function SOt(p,v,k){var N=to(v),F=N?v.length:0,W=vne(F>0?v[0]:N?Yf:v),L=bne(F>1?v[1]:Yf),O=k[0];k[0]=function(){S.dn(),e8(O,Yf,lw[Sd](arguments))};var S=mne(p,function(B){if(B){if(B.refresh)return B.refresh(),B;e8(L,Yf,[B])}return e8(W,Yf,k)},function(B){e8(L,Yf,[B])});return S.h}function xg(p,v){return SOt(!0,Yf,lw[Sd](arguments))}function wne(p,v){return SOt(!1,Yf,lw[Sd](arguments))}var Lot,Zst="constructor",fw="prototype",Qst="function",Jst="_dynInstFuncs",ixt="_isDynProxy",gD="_dynClass",xne="_dynCls$",axt="_dynInstChk",UV=axt,_Ot="_dfOpts",VNt="_unknown_",D4t="__proto__",$ot="_dyn"+D4t,GNt="__dynProto$Gbl",Abt="_dynInstProto",kst="useBaseInst",oxt="setInstFuncs",R4t=Object,WV=R4t.getPrototypeOf,HNt=R4t.getOwnPropertyNames,YNt=bg(),sxt=YNt[GNt]||(YNt[GNt]={o:(Lot={},Lot[oxt]=!0,Lot[kst]=!0,Lot),n:1e3});function Sst(p){return p&&(p===R4t[fw]||p===Array[fw])}function F4t(p){return Sst(p)||p===Function[fw]}function x8(p){var v;if(p){if(WV)return WV(p);var k=p[D4t]||p[fw]||(p[Zst]?p[Zst][fw]:null);v=p[$ot]||k,wg(p,$ot)||(delete p[Abt],v=p[$ot]=p[Abt]||p[$ot],p[Abt]=k)}return v}function tut(p,v){var k=[];if(HNt)k=HNt(p);else for(var N in p)typeof N=="string"&&wg(p,N)&&k.push(N);if(k&&k.length>0)for(var F=0;F<k.length;F++)v(k[F])}function O4t(p,v,k){return v!==Zst&&typeof p[v]===Qst&&(k||wg(p,v))&&v!==D4t&&v!==fw}function eut(p){mv("DynamicProto: "+p)}function kne(p){var v=hw(null);return tut(p,function(k){!v[k]&&O4t(p,k,!1)&&(v[k]=p[k])}),v}function L4t(p,v){for(var k=p.length-1;k>=0;k--)if(p[k]===v)return!0;return!1}function Sne(p,v,k,N){function F(S,B,j){var K=B[j];if(K[ixt]&&N){var Z=S[Jst]||{};Z[UV]!==!1&&(K=(Z[B[gD]]||{})[j]||K)}return function(){return K.apply(S,arguments)}}var W=hw(null);tut(k,function(S){W[S]=F(v,k,S)});for(var L=x8(p),O=[];L&&!F4t(L)&&!L4t(O,L);)tut(L,function(S){!W[S]&&O4t(L,S,!WV)&&(W[S]=F(v,L,S))}),O.push(L),L=x8(L);return W}function _ne(p,v,k,N){var F=null;if(p&&wg(k,gD)){var W=p[Jst]||hw(null);if(F=(W[k[gD]]||hw(null))[v],F||eut("Missing ["+v+"] "+Qst),!F[axt]&&W[UV]!==!1){for(var L=!wg(p,v),O=x8(p),S=[];L&&O&&!F4t(O)&&!L4t(S,O);){var B=O[v];if(B){L=B===N;break}S.push(O),O=x8(O)}try{L&&(p[v]=F),F[axt]=1}catch{W[UV]=!1}}}return F}function Cne(p,v,k){var N=v[p];return N===k&&(N=x8(v)[p]),typeof N!==Qst&&eut("["+p+"] is not a "+Qst),N}function Ene(p,v,k,N,F){function W(S,B){var j=function(){var K=_ne(this,B,S,j)||Cne(B,S,j);return K.apply(this,arguments)};return j[ixt]=1,j}if(!Sst(p)){var L=k[Jst]=k[Jst]||hw(null);if(!Sst(L)){var O=L[v]=L[v]||hw(null);L[UV]!==!1&&(L[UV]=!!F),Sst(O)||tut(k,function(S){O4t(k,S,!1)&&k[S]!==N[S]&&(O[S]=k[S],delete k[S],(!wg(p,S)||p[S]&&!p[S][ixt])&&(p[S]=W(p,S)))})}}}function Tne(p,v){if(WV){for(var k=[],N=x8(v);N&&!F4t(N)&&!L4t(k,N);){if(N===p)return!0;k.push(N),N=x8(N)}return!1}return!0}function Ibt(p,v){return wg(p,fw)?p.name||v||VNt:((p||{})[Zst]||{}).name||v||VNt}function Mu(p,v,k,N){wg(p,fw)||eut("theClass is an invalid class definition.");var F=p[fw];Tne(F,v)||eut("["+Ibt(p)+"] not in hierarchy of ["+Ibt(v)+"]");var W=null;wg(F,gD)?W=F[gD]:(W=xne+Ibt(p,"_")+"$"+sxt.n,sxt.n++,F[gD]=W);var L=Mu[_Ot],O=!!L[kst];O&&N&&N[kst]!==void 0&&(O=!!N[kst]);var S=kne(v),B=Sne(F,v,S,O);k(v,B);var j=!!WV&&!!L[oxt];j&&N&&(j=!!N[oxt]),Ene(F,W,v,S,j!==!1)}Mu[_Ot]=sxt.o;var COt="function",EOt="object",$4t="undefined",sv="prototype",z4t=Object,Ane=z4t[sv];(bg()||{}).Symbol;(bg()||{}).Reflect;var TOt="hasOwnProperty",Ine=function(p){for(var v,k=1,N=arguments.length;k<N;k++){v=arguments[k];for(var F in v)Ane[TOt].call(v,F)&&(p[F]=v[F])}return p},Jf=ext||Ine,uxt=function(p,v){return uxt=z4t.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,N){k.__proto__=N}||function(k,N){for(var F in N)N[TOt](F)&&(k[F]=N[F])},uxt(p,v)};function mw(p,v){typeof v!==COt&&v!==null&&mv("Class extends value "+String(v)+" is not a constructor or null"),uxt(p,v);function k(){this.constructor=p}p[sv]=v===null?hw(v):(k[sv]=v[sv],new k)}function qNt(p,v){for(var k=0,N=v.length,F=p.length;k<N;k++,F++)p[F]=v[k];return p}var AOt=Nee,Nne=Ree,Wk=AOt({NONE:0,PENDING:3,INACTIVE:1,ACTIVE:2}),FD="toLowerCase",Pa="length",nut="warnToConsole",vG="throwInternal",l8="watch",k8="apply",Ho="push",HD="splice",Ic="logger",H9="cancel",bG="initialize",Gk="identifier",rut="removeNotificationListener",iut="addNotificationListener",rv="isInitialized",zot="getNotifyMgr",VV="getPlugin",S8="name",qf="processNext",IOt="getProcessTelContext",n8="value",lD="enabled",XNt="stopPollingInternalLogs",_8="unload",Pot="onComplete",lxt="version",NOt="loggingLevelConsole",C8="createNew",X3="teardown",aut="messageId",c8="message",nw="diagLog",out="_doTeardown",GV="update",uv="getNext",HV="setNextPlugin",cxt="userAgent",OD="split",h8="replace",r5="type",KNt="evtName",q3="status",Mne="indexOf",ZNt="getAllResponseHeaders",hxt="isChildEvt",Y1="data",yD="getCtx",Qy="setCtx",QNt="itemsReceived",Bot="headers",qW="urlString",LM="timeout",dxt="traceFlags",Nbt="getAttribute",Mbt;function Dne(p,v){Mbt||(Mbt=mOt("AggregationError",function(N,F){F[Pa]>1&&(N.errors=F[1])}));var k=p;throw Li(v,function(N,F){k+=`
`.concat(F," > ").concat(Bi(N))}),new Mbt(k,v||[])}var sut="Promise",P4t="rejected";function im(p,v){return MOt(p,function(k){return v?v({status:"fulfilled",rejected:!1,value:k}):k},function(k){return v?v({status:P4t,rejected:!0,reason:k}):k})}function MOt(p,v,k,N){var F=p;try{if(f5(p))(v||k)&&(F=p.then(v,k));else try{v&&(F=v(p))}catch(W){if(k)F=k(W);else throw W}}finally{}return F}var DOt=["pending","resolving","resolved",P4t],JNt="dispatchEvent",jot;function Rne(p){var v;return p&&p.createEvent&&(v=p.createEvent("Event")),!!v&&v.initEvent}function Fne(p,v,k,N){var F=xd();!jot&&(jot=_g(!!_l(Rne,[F]).v));var W=jot.v?F.createEvent("Event"):N?new Event(v):{};if(k&&k(W),jot.v&&W.initEvent(v,!1,!0),W&&p[JNt])p[JNt](W);else{var L=p["on"+v];if(L)L(W);else{var O=Xu("console");O&&(O.error||O.log)(v,Bi(W))}}}var ROt="unhandledRejection",One=ROt.toLowerCase(),Lne=10,Dbt;function tMt(p){return Ia(p)?p.toString():Bi(p)}function FOt(p,v,k){var N=ilt(arguments,3),F=0,W=!1,L,O=[],S=!1,B=null,j;function K(st,lt){try{S=!0,B&&B.cancel(),B=null;var ft=p(function(gt,xt){O.push(function(){try{var wt=F===2?st:lt,_t=Sl(wt)?L:Ia(wt)?wt(L):wt;f5(_t)?_t.then(gt,xt):wt?gt(_t):F===3?xt(_t):gt(_t)}catch(bt){xt(bt)}}),W&&J()},N);return ft}finally{}}function Z(st){return K(void 0,st)}function Y(st){var lt=st,ft=st;return Ia(st)&&(lt=function(gt){return st&&st(),gt},ft=function(gt){throw st&&st(),gt}),K(lt,ft)}function X(){return DOt[F]}function J(){if(O.length>0){var st=O.slice();O=[],S=!0,B&&B.cancel(),B=null,v(st)}}function q(st,lt){return function(ft){if(F===lt){if(st===2&&f5(ft)){F=1,ft.then(q(2,1),q(3,1));return}F=st,W=!0,L=ft,J(),!S&&st===3&&!B&&(B=xg(H,Lne))}}}function H(){if(!S)if(S=!0,Yee())Iu.emit(ROt,L,j);else{var st=am()||bg();!Dbt&&(Dbt=_g(_l(Xu,[sut+"RejectionEvent"]).v)),Fne(st,One,function(lt){return Ro(lt,"promise",{g:function(){return j}}),lt.reason=L,lt},!!Dbt.v)}}j={then:K,catch:Z,finally:Y},cw(j,"state",{get:X}),Xee()&&(j[A4t(11)]="IPromise");function tt(){return"IPromise "+X()+(W?" - "+tMt(L):"")}return j.toString=tt,function(){Ia(k)||mv(sut+": executor is not a function - "+tMt(k));var lt=q(3,0);try{k.call(j,q(2,0),lt)}catch(ft){lt(ft)}}(),j}function $ne(p){return function(v){var k=ilt(arguments,1);return p(function(N,F){try{var W=[],L=1;N4t(v,function(O,S){O&&(L++,MOt(O,function(B){W[S]=B,--L===0&&N(W)},F))}),L--,L===0&&N(W)}catch(O){F(O)}},k)}}function zne(p){return _g(function(v){var k=ilt(arguments,1);return p(function(N,F){var W=[],L=1;function O(S,B){L++,im(S,function(j){j.rejected?W[B]={status:P4t,reason:j.reason}:W[B]={status:"fulfilled",value:j.value},--L===0&&N(W)})}try{to(v)?Li(v,O):fOt(v)?N4t(v,O):mv("Input is not an iterable"),L--,L===0&&N(W)}catch(S){F(S)}},k)})}function OOt(p){Li(p,function(v){try{v()}catch{}})}function Pne(p){var v=gG(p)?p:0;return function(k){xg(function(){OOt(k)},v)}}function LOt(p,v){return FOt(LOt,Pne(v),p,v)}var Rbt;function Bne(p,v){!Rbt&&(Rbt=_g(_l(Xu,[sut]).v||null));var k=Rbt.v;if(!k)return LOt(p);Ia(p)||mv(sut+": executor is not a function - "+Bi(p));var N=0;function F(){return DOt[N]}var W=new k(function(L,O){function S(j){N=2,L(j)}function B(j){N=3,O(j)}p(S,B)});return cw(W,"state",{get:F}),W}var Fbt;function YV(p){return FOt(YV,OOt,p)}function jne(p,v){return!Fbt&&(Fbt=zne(YV)),Fbt.v(p,v)}var Obt;function m5(p,v){return!Obt&&(Obt=_g(Bne)),Obt.v.call(this,p,v)}var Une=$ne(m5),tv=void 0,zo="",JM="channels",Vh="core",fxt="createPerfMgr",pxt="disabled",vD="extensionConfig",tD="extensions",dv="processTelemetry",uut="priority",_st="eventsSent",DV="eventsDiscarded",Cst="eventsSendRequest",r8="perfEvent",Lbt="offlineEventsStored",$bt="offlineBatchSent",zbt="offlineBatchDrop",lut="getPerfMgr",mxt="domain",Pbt="path",Wne="Not dynamic - ",Vne="getPrototypeOf",Gne=/-([a-z])/g,Hne=/([^\w\d_$])/g,Yne=/^(\d+[\w\d_$])/,qne=Object[Vne];function d8(p){return!Fr(p)}function cut(p){var v=p;return v&&Sa(v)&&(v=v[h8](Gne,function(k,N){return N.toUpperCase()}),v=v[h8](Hne,"_"),v=v[h8](Yne,function(k,N){return"_"+N})),v}function mf(p,v){return p&&v?Qf(p,v)!==-1:!1}function LD(p){return p&&p.toISOString()||""}function gs(p){return _4t(p)?p[S8]:zo}function vu(p,v,k,N,F){var W=k;return p&&(W=p[v],W!==k&&(!F||F(W))&&(!N||N(k))&&(W=k,p[v]=W)),W}function Hf(p,v,k){var N;return p?(N=p[v],!N&&Fr(N)&&(N=Sl(k)?{}:k,p[v]=N)):N=Sl(k)?{}:k,N}function $Ot(p,v){var k=null,N=null;return Ia(p)?k=p:N=p,function(){var F=arguments;if(k&&(N=k()),N)return N[v][k8](N,F)}}function Xne(p,v,k){if(p&&v&&t0(p)&&t0(v)){var N=function(W){if(Sa(W)){var L=v[W];Ia(L)?(!k||k(W,!0,v,p))&&(p[W]=$Ot(v,W)):(!k||k(W,!1,v,p))&&(n5(p,W)&&delete p[W],Ro(p,W,{g:function(){return v[W]},s:function(O){v[W]=O}}))}};for(var F in v)N(F)}return p}function hut(p,v,k,N,F){p&&v&&k&&(p[v]=$Ot(k,N))}function vV(p,v,k,N){return p&&v&&t0(p)&&to(k)&&Li(k,function(F){Sa(F)&&hut(p,F,v,F)}),p}function Kne(p){return function(){function v(){var k=this;p&&Eo(p,function(N,F){k[N]=F})}return v}()}function zOt(p){return p&&ext&&(p=z4t(ext({},p))),p}function POt(p,v,k,N,F,W){var L=arguments,O=L[0]||{},S=L[Pa],B=!1,j=1;for(S>0&&eOt(O)&&(B=O,O=L[j]||{},j++),t0(O)||(O={});j<S;j++){var K=L[j],Z=to(K),Y=t0(K);for(var X in K){var J=Z&&X in K||Y&&n5(K,X);if(J){var q=K[X],H=void 0;if(B&&q&&((H=to(q))||Zf(q))){var tt=O[X];H?to(tt)||(tt=[]):Zf(tt)||(tt={}),q=POt(B,tt,q)}q!==void 0&&(O[X]=q)}}}return O}function Est(p,v,k){var N=v&&v.featureOptIn&&v.featureOptIn[p];if(p&&N){var F=N.mode;if(F===3)return!0;if(F===2)return!1}return k}function dut(p){try{return p.responseText}catch{}return null}function BOt(p,v){return p?"XDomainRequest,Response:"+dut(p)||"":v}function fut(p,v){return p?"XMLHttpRequest,Status:"+p[q3]+",Response:"+dut(p)||p.response||"":v}function eMt(p,v){return v&&(gG(v)?p=[v].concat(p):to(v)&&(p=v.concat(p))),p}var Zne="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",nMt="withCredentials",Qne="timeout";function Jne(p,v,k,N,F,W){F===void 0&&(F=!1);function L(S,B,j){try{S[B]=j}catch{}}var O=new XMLHttpRequest;return L(O,Zne,N),k&&L(O,nMt,k),O.open(p,v,!F),k&&L(O,nMt,k),!F&&W&&L(O,Qne,W),O}function tre(p){var v={};if(Sa(p)){var k=Nu(p)[OD](/[\r\n]+/);Li(k,function(N){if(N){var F=N[Mne](": ");if(F!==-1){var W=Nu(N.substring(0,F))[FD](),L=Nu(N.substring(F+1));v[W]=L}else v[Nu(N)]=1}})}return v}function Bbt(p,v,k){if(!p[k]&&v&&v.getResponseHeader){var N=v.getResponseHeader(k);N&&(p[k]=Nu(N))}return p}var ere="kill-duration",nre="kill-duration-seconds",rre="time-delta-millis";function jbt(p,v){var k={};return p[ZNt]?k=tre(p[ZNt]()):v&&(k=Bbt(k,p,rre),k=Bbt(k,p,ere),k=Bbt(k,p,nre)),k}var ire="documentMode",are="location",ore="console",jOt="JSON",sre="crypto",ure="msCrypto",lre="ReactNative",gxt="msie",yxt="trident/",UOt="XMLHttpRequest",Ubt=null,Wbt=null,cre=!1,$M=null,Vbt=null;function WOt(p,v){var k=!1;if(p){try{if(k=v in p,!k){var N=p[sv];N&&(k=v in N)}}catch{}if(!k)try{var F=new p;k=!Sl(F[v])}catch{}}return k}function iv(p){if(p&&cre){var v=Xu("__mockLocation");if(v)return v}return typeof location===EOt&&location?location:Xu(are)}function hre(){return typeof console!==$4t?console:Xu(ore)}function wG(){return!!(typeof JSON===EOt&&JSON||Xu(jOt)!==null)}function a2(){return wG()?JSON||Xu(jOt):null}function dre(){return Xu(sre)}function fre(){return Xu(ure)}function pre(){var p=yv();return p&&p.product?p.product===lre:!1}function vxt(){var p=yv();if(p&&(p[cxt]!==Wbt||Ubt===null)){Wbt=p[cxt];var v=(Wbt||zo)[FD]();Ubt=mf(v,gxt)||mf(v,yxt)}return Ubt}function VOt(p){if(p===void 0&&(p=null),!p){var v=yv()||{};p=v?(v.userAgent||zo)[FD]():zo}var k=(p||zo)[FD]();if(mf(k,gxt)){var N=xd()||{};return NV(parseInt(k[OD](gxt)[1]),N[ire]||0)}else if(mf(k,yxt)){var F=parseInt(k[OD](yxt)[1]);if(F)return F+4}return null}function bV(p){return(Vbt===null||p===!1)&&(Vbt=Gee()&&!!yv().sendBeacon),Vbt}function B4t(p){var v=!1;try{v=!!Xu("fetch");var k=Xu("Request");v&&p&&k&&(v=WOt(k,"keepalive"))}catch{}return v}function mre(){return $M===null&&($M=typeof XDomainRequest!==$4t,$M&&alt()&&($M=$M&&!WOt(Xu(UOt),"withCredentials"))),$M}function alt(){var p=!1;try{var v=Xu(UOt);p=!!v}catch{}return p}function gre(p,v){return p&&p.dispatchEvent&&v?(p.dispatchEvent(v),!0):!1}function yre(p,v){var k=null,N={detail:v||null};if(Ia(CustomEvent))k=new CustomEvent(p,N);else{var F=xd();F&&F.createEvent&&(k=F.createEvent("CustomEvent"),k.initCustomEvent(p,!0,!0,N))}return k}function vre(p,v,k){var N=bg();if(N&&N.CustomEvent)try{var F={cfg:v||null,customDetails:k||null};return gre(N,yre(p,F))}catch{}return!1}var GOt=4294967296,i5=4294967295,HOt=123456789,YOt=987654321,qOt=!1,wV=HOt,xV=YOt;function bre(p){p<0&&(p>>>=0),wV=HOt+p&i5,xV=YOt-p&i5,qOt=!0}function wre(){try{var p=i2()&2147483647;bre((Math.random()*GOt^p)+p)}catch{}}function xre(p){return rm(qV()/i5*(p+1))>>>0}function qV(p){var v=0,k=dre()||fre();return k&&k.getRandomValues&&(v=k.getRandomValues(new Uint32Array(1))[0]&i5),v===0&&vxt()&&(qOt||wre(),v=kre()&i5),v===0&&(v=rm(GOt*Math.random()|0)),v>>>=0,v}function kre(p){xV=36969*(xV&65535)+(xV>>16)&i5,wV=18e3*(wV&65535)+(wV>>16)&i5;var v=(xV<<16)+(wV&65535)>>>0&i5|0;return v>>>=0,v}function j4t(p){p===void 0&&(p=22);for(var v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k=qV()>>>0,N=0,F=zo;F[Pa]<p;)N++,F+=v.charAt(k&63),k>>>=6,N===5&&(k=(qV()<<2&4294967295|k&3)>>>0,N=0);return F}var XOt="3.3.9",Sre="."+j4t(6),_re=0;function KOt(p){return p.nodeType===1||p.nodeType===9||!+p.nodeType}function Cre(p,v){var k=v[p.id];if(!k){k={};try{KOt(v)&&Ro(v,p.id,{e:!1,v:k})}catch{}}return k}function kg(p,v){return v===void 0&&(v=!1),cut(p+_re+++(v?"."+XOt:zo)+Sre)}function ZOt(p){var v={id:kg("_aiData-"+(p||zo)+"."+XOt),accept:function(k){return KOt(k)},get:function(k,N,F,W){var L=k[v.id];return L?L[cut(N)]:(W&&(L=Cre(v,k),L[cut(N)]=F),F)},kill:function(k,N){if(k&&k[N])try{delete k[N]}catch{}}};return v}function Tst(p){return p&&t0(p)&&!to(p)&&(p.isVal||p.fb||n5(p,"v")||n5(p,"mrg")||n5(p,"ref")||p.set)}function QOt(p,v,k){var N,F=k.dfVal||mee;if(v&&k.fb){var W=k.fb;to(W)||(W=[W]);for(var L=0;L<W[Pa];L++){var O=W[L],S=v[O];if(F(S)?N=S:p&&(S=p.cfg[O],F(S)&&(N=S),p.set(p.cfg,Kf(O),S)),F(N))break}}return!F(N)&&F(k.v)&&(N=k.v),N}function bxt(p,v,k){var N=k;if(k&&Tst(k)&&(N=QOt(p,v,k)),N){Tst(N)&&(N=bxt(p,v,N));var F;to(N)?(F=[],F[Pa]=N[Pa]):Zf(N)&&(F={}),F&&(Eo(N,function(W,L){L&&Tst(L)&&(L=bxt(p,v,L)),F[W]=L}),N=F)}return N}function U4t(p,v,k,N){var F,W,L,O=N,S,B,j,K;Tst(O)?(F=O.isVal,W=O.set,j=O.rdOnly,K=O.blkVal,S=O.mrg,B=O.ref,!B&&Sl(B)&&(B=!!S),L=QOt(p,v,O)):L=N,K&&p.blkVal(v,k);var Z,Y=!0,X=v[k];(X||!Fr(X))&&(Z=X,Y=!1,F&&Z!==L&&!F(Z)&&(Z=L,Y=!0),W&&(Z=W(Z,L,v),Y=Z===L)),Y?L?Z=bxt(p,v,L):Z=L:(Zf(Z)||to(L))&&S&&L&&(Zf(L)||to(L))&&Eo(L,function(J,q){U4t(p,Z,J,q)}),p.set(v,k,Z),B&&p.ref(v,k),j&&p.rdOnly(v,k)}var g5=I4t("[[ai_dynCfg_1]]"),JOt=I4t("[[ai_blkDynCfg_1]]"),Ere=I4t("[[ai_frcDynCfg_1]]");function tLt(p){if(p){var v;if(to(p)?(v=[],v[Pa]=p[Pa]):Zf(p)&&(v={}),v)return Eo(p,function(k,N){v[k]=tLt(N)}),v}return p}function Tre(p){if(p){var v=p[g5]||p;if(v.cfg&&(v.cfg===p||v.cfg[g5]===v))return v}return null}function Are(p){if(p&&(Zf(p)||to(p)))try{p[JOt]=!0}catch{}return p}function Gbt(p,v,k){var N=!1;return k&&!p[v.blkVal]&&(N=k[Ere],!N&&!k[JOt]&&(N=Zf(k)||to(k))),N}function eLt(p){mv("InvalidAccess:"+p)}var Ire=["push","pop","shift","unshift","splice"],XV=function(p,v,k,N){p&&p[vG](3,108,"".concat(k," [").concat(v,"] failed - ")+Bi(N))};function Nre(p,v,k){to(v)&&Li(Ire,function(N){var F=v[N];v[N]=function(){for(var W=[],L=0;L<arguments.length;L++)W[L]=arguments[L];var O=F[k8](this,W);return mut(p,v,k,"Patching"),O}})}function put(p,v){var k=dne(p,v);return k&&k.get}function Mre(p,v,k,N){var F={n:k,h:[],trk:function(B){B&&B.fn&&(gf(F.h,B)===-1&&F.h[Ho](B),p.trk(B,F))},clr:function(B){var j=gf(F.h,B);j!==-1&&F.h[HD](j,1)}},W=!0,L=!1;function O(){W&&(L=L||Gbt(O,p,N),N&&!N[g5]&&L&&(N=mut(p,N,k,"Converting")),W=!1);var B=p.act;return B&&F.trk(B),N}O[p.prop]={chng:function(){p.add(F)}};function S(B){if(N!==B){O[p.ro]&&!p.upd&&eLt("["+k+"] is read-only:"+Bi(v)),W&&(L=L||Gbt(O,p,N),W=!1);var j=L&&O[p.rf];if(L)if(j){Eo(N,function(Z){N[Z]=B?B[Z]:tv});try{Eo(B,function(Z,Y){olt(p,N,Z,Y)}),B=N}catch(Z){XV((p.hdlr||{})[Ic],k,"Assigning",Z),L=!1}}else N&&N[g5]&&Eo(N,function(Z){var Y=put(N,Z);if(Y){var X=Y[p.prop];X&&X.chng()}});if(B!==N){var K=B&&Gbt(O,p,B);!j&&K&&(B=mut(p,B,k,"Converting")),N=B,L=K}p.add(F)}}Ro(v,F.n,{g:O,s:S})}function olt(p,v,k,N){if(v){var F=put(v,k),W=F&&!!F[p.prop];W?v[k]=N:Mre(p,v,k,N)}return v}function Hbt(p,v,k,N){if(v){var F=put(v,k),W=F&&!!F[p.prop],L=N&&N[0],O=N&&N[1],S=N&&N[2];if(!W){if(S)try{Are(v)}catch(B){XV((p.hdlr||{})[Ic],k,"Blocking",B)}try{olt(p,v,k,v[k]),F=put(v,k)}catch(B){XV((p.hdlr||{})[Ic],k,"State",B)}}L&&(F[p.rf]=L),O&&(F[p.ro]=O),S&&(F[p.blkVal]=!0)}return v}function mut(p,v,k,N){try{Eo(v,function(F,W){olt(p,v,F,W)}),v[g5]||(cw(v,g5,{get:function(){return p.hdlr}}),Nre(p,v,k))}catch(F){XV((p.hdlr||{})[Ic],k,N,F)}return v}var XW="[[ai_",KW="]]";function Dre(p){var v=YW(XW+"get"+p.uid+KW),k=YW(XW+"ro"+p.uid+KW),N=YW(XW+"rf"+p.uid+KW),F=YW(XW+"blkVal"+p.uid+KW),W=YW(XW+"dtl"+p.uid+KW),L=null,O=null,S;function B(Y,X){var J=S.act;try{S.act=Y,Y&&Y[W]&&(Li(Y[W],function(H){H.clr(Y)}),Y[W]=[]),X({cfg:p.cfg,set:p.set.bind(p),setDf:p.setDf.bind(p),ref:p.ref.bind(p),rdOnly:p.rdOnly.bind(p)})}catch(H){var q=p[Ic];throw q&&q[vG](1,107,Bi(H)),H}finally{S.act=J||null}}function j(){if(L){var Y=L;L=null,O&&O[H9](),O=null;var X=[];if(Li(Y,function(J){if(J&&(J[W]&&(Li(J[W],function(q){q.clr(J)}),J[W]=null),J.fn))try{B(J,J.fn)}catch(q){X[Ho](q)}}),L)try{j()}catch(J){X[Ho](J)}X[Pa]>0&&Dne("Watcher error(s): ",X)}}function K(Y){if(Y&&Y.h[Pa]>0){L||(L=[]),O||(O=xg(function(){O=null,j()},0));for(var X=0;X<Y.h[Pa];X++){var J=Y.h[X];J&&gf(L,J)===-1&&L[Ho](J)}}}function Z(Y,X){if(Y){var J=Y[W]=Y[W]||[];gf(J,X)===-1&&J[Ho](X)}}return S={prop:v,ro:k,rf:N,blkVal:F,hdlr:p,add:K,notify:j,use:B,trk:Z},S}function Rre(p,v){var k={fn:v,rm:function(){k.fn=null,p=null,v=null}};return Ro(k,"toJSON",{v:function(){return"WatcherHandler"+(k.fn?"":"[X]")}}),p.use(k,v),k}function Fre(p,v,k){var N=Tre(v);if(N)return N;var F=kg("dyncfg",!0),W=v&&k!==!1?v:tLt(v),L;function O(){L.notify()}function S(q,H,tt){try{q=olt(L,q,H,tt)}catch(st){XV(p,H,"Setting value",st)}return q[H]}function B(q){return Rre(L,q)}function j(q,H){L.use(null,function(tt){var st=L.upd;try{Sl(H)||(L.upd=H),q(tt)}finally{L.upd=st}})}function K(q,H){var tt;return Hbt(L,q,H,(tt={},tt[0]=!0,tt))[H]}function Z(q,H){var tt;return Hbt(L,q,H,(tt={},tt[1]=!0,tt))[H]}function Y(q,H){var tt;return Hbt(L,q,H,(tt={},tt[2]=!0,tt))[H]}function X(q,H){return H&&Eo(H,function(tt,st){U4t(J,q,tt,st)}),q}var J={uid:null,cfg:W,logger:p,notify:O,set:S,setDf:X,watch:B,ref:K,rdOnly:Z,blkVal:Y,_block:j};return Ro(J,"uid",{c:!1,e:!1,w:!1,v:F}),L=Dre(J),mut(L,W,"config","Creating"),J}function Ore(p,v){p?(p[nut](v),p[vG](2,108,v)):eLt(v)}function Sg(p,v,k,N){var F=Fre(k,p||{},N);return v&&F.setDf(F.cfg,v),F}function ac(p,v,k){var N=p[g5]||p;return N.cfg&&(N.cfg===p||N.cfg[g5]===N)?N[l8](v):(Ore(k,Wne+Bi(p)),Sg(p,null,k)[l8](v))}function cD(p,v){if(p&&p[_8])return p[_8](v)}function nLt(p,v,k){var N;return k||(N=m5(function(F){k=F})),p&&hne(p)>0?im(cD(p[0],v),function(){nLt(ilt(p,1),v,k)}):k(),N}var Lre=500,rMt="Microsoft_ApplicationInsights_BypassAjaxInstrumentation";function $re(p,v,k){return!p&&Fr(p)?v:eOt(p)?p:Kf(p)[FD]()==="true"}function X1(p){return{mrg:!0,v:p}}function iMt(p,v){return{set:p,v}}function gut(p,v,k){return{fb:k,isVal:p,v}}function Nc(p,v){return{fb:v,set:$re,v:!!p}}function zre(p){return{isVal:Sa,v:Kf(zo)}}var Ybt=[_st,DV,Cst,r8],yut=null,Uot;function Pre(p,v){return function(){var k=arguments,N=rLt(v);if(N){var F=N.listener;F&&F[p]&&F[p][k8](F,k)}}}function Bre(){var p=Xu("Microsoft");return p&&(yut=p.ApplicationInsights),yut}function rLt(p){var v=yut;return!v&&p.disableDbgExt!==!0&&(v=yut||Bre()),v?v.ChromeDbgExt:null}function jre(p){if(!Uot){Uot={};for(var v=0;v<Ybt[Pa];v++)Uot[Ybt[v]]=Pre(Ybt[v],p)}return Uot}var zM,iLt="warnToConsole",Ure="AI (Internal): ",Wre="AI: ",Vre="AITR_",Gre={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},Hre=(zM={},zM[0]=null,zM[1]="errorToConsole",zM[2]=iLt,zM[3]="debugToConsole",zM);function aMt(p){return p?'"'+p[h8](/\"/g,zo)+'"':zo}function qbt(p,v){var k=hre();if(k){var N="log";k[p]&&(N=p),Ia(k[N])&&k[N](v)}}var KV=function(){function p(v,k,N,F){N===void 0&&(N=!1);var W=this;W[aut]=v,W[c8]=(N?Wre:Ure)+v;var L=zo;wG()&&(L=a2().stringify(F));var O=(k?" message:"+aMt(k):zo)+(F?" props:"+aMt(L):zo);W[c8]+=O}return p.dataType="MessageData",p}();function R8(p,v){return(p||{})[Ic]||new vut(v)}var vut=function(){function p(v){this.identifier="DiagnosticLogger",this.queue=[];var k=0,N={},F,W,L,O,S;Mu(p,this,function(B){S=K(v||{}),B.consoleLoggingLevel=function(){return F},B[vG]=function(X,J,q,H,tt){tt===void 0&&(tt=!1);var st=new KV(J,q,tt,H);if(O)throw Bi(st);var lt=Hre[X]||iLt;if(Sl(st[c8]))Y("throw"+(X===1?"Critical":"Warning"),st);else{if(tt){var ft=+st[aut];!N[ft]&&F>=X&&(B[lt](st[c8]),N[ft]=!0)}else F>=X&&B[lt](st[c8]);j(X,st)}},B.debugToConsole=function(X){qbt("debug",X),Y("warning",X)},B[nut]=function(X){qbt("warn",X),Y("warning",X)},B.errorToConsole=function(X){qbt("error",X),Y("error",X)},B.resetInternalMessageCount=function(){k=0,N={}},B.logInternalMessage=j,B[_8]=function(X){S&&S.rm(),S=null};function j(X,J){if(!Z()){var q=!0,H=Vre+J[aut];if(N[H]?q=!1:N[H]=!0,q&&(X<=W&&(B.queue[Ho](J),k++,Y(X===1?"error":"warn",J)),k===L)){var tt="Internal events throttle limit per PageView reached for this app.",st=new KV(23,tt,!1);B.queue[Ho](st),X===1?B.errorToConsole(tt):B[nut](tt)}}}function K(X){return ac(Sg(X,Gre,B).cfg,function(J){var q=J.cfg;F=q[NOt],W=q.loggingLevelTelemetry,L=q.maxMessageLimit,O=q.enableDebug})}function Z(){return k>=L}function Y(X,J){var q=rLt(v||{});q&&q[nw]&&q[nw](X,J)}})}return p.__ieDyn=1,p}();function W4t(p){return p||new vut}function ui(p,v,k,N,F,W){W===void 0&&(W=!1),W4t(p)[vG](v,k,N,F,W)}function f8(p,v){W4t(p)[nut](v)}function Yre(p,v,k){W4t(p).logInternalMessage(v,k)}var Xbt,D9,oMt="toGMTString",sMt="toUTCString",V4t="cookie",Kbt="expires",uMt="isCookieUseDisabled",wxt="disableCookiesUsage",hD="_ckMgr",Wot=null,Zbt=null,lMt=null,lv,cMt={},but={},qre=(Xbt={cookieCfg:X1((D9={},D9[mxt]={fb:"cookieDomain",dfVal:d8},D9.path={fb:"cookiePath",dfVal:d8},D9.enabled=tv,D9.ignoreCookies=tv,D9.blockedCookies=tv,D9)),cookieDomain:tv,cookiePath:tv},Xbt[wxt]=tv,Xbt);function G4t(){!lv&&(lv=uOt(function(){return xd()}))}function Xre(p,v){var k=Ast[hD]||but[hD];return k||(k=Ast[hD]=Ast(p,v),but[hD]=k),k}function Vot(p){return p?p.isEnabled():!0}function aLt(p,v){return v&&p&&to(p.ignoreCookies)?gf(p.ignoreCookies,v)!==-1:!1}function Kre(p,v){return v&&p&&to(p.blockedCookies)&&gf(p.blockedCookies,v)!==-1?!0:aLt(p,v)}function hMt(p,v){var k=v[lD];if(Fr(k)){var N=void 0;Sl(p[uMt])||(N=!p[uMt]),Sl(p[wxt])||(N=!p[wxt]),k=N}return k}function H4t(p,v){var k;return p&&(k=p.getCookieMgr()),k||(k=Xre(v,(p||{})[Ic])),k}function Ast(p,v){var k,N,F,W,L,O,S,B;p=Sg(p||but,null,v).cfg,W=ac(p,function(K){K.setDf(K.cfg,qre),k=K.ref(K.cfg,"cookieCfg"),N=k[Pbt]||"/",F=k[mxt],L=hMt(p,k)!==!1,O=k.getCookie||Zre,S=k.setCookie||mMt,B=k.delCookie||mMt},v);var j={isEnabled:function(){var K=hMt(p,k)!==!1&&L&&dMt(v),Z=but[hD];return K&&Z&&j!==Z&&(K=Vot(Z)),K},setEnabled:function(K){L=K!==!1,k[lD]=K},set:function(K,Z,Y,X,J){var q=!1;if(Vot(j)&&!Kre(k,K)){var H={},tt=Nu(Z||zo),st=Qf(tt,";");if(st!==-1&&(tt=Nu(E4t(Z,st)),H=oLt(gv(Z,st+1))),vu(H,mxt,X||F,Xst,Sl),!Fr(Y)){var lt=vxt();if(Sl(H[Kbt])){var ft=i2(),gt=ft+Y*1e3;if(gt>0){var xt=new Date;xt.setTime(gt),vu(H,Kbt,fMt(xt,lt?oMt:sMt)||fMt(xt,lt?oMt:sMt)||zo,Xst)}}lt||vu(H,"max-age",zo+Y,null,Sl)}var wt=iv();wt&&wt.protocol==="https:"&&(vu(H,"secure",null,null,Sl),Zbt===null&&(Zbt=!Qre((yv()||{})[cxt])),Zbt&&vu(H,"SameSite","None",null,Sl)),vu(H,Pbt,J||N,null,Sl),S(K,pMt(tt,H)),q=!0}return q},get:function(K){var Z=zo;return Vot(j)&&!aLt(k,K)&&(Z=O(K)),Z},del:function(K,Z){var Y=!1;return Vot(j)&&(Y=j.purge(K,Z)),Y},purge:function(K,Z){var Y,X=!1;if(dMt(v)){var J=(Y={},Y[Pbt]=Z||"/",Y[Kbt]="Thu, 01 Jan 1970 00:00:01 GMT",Y);vxt()||(J["max-age"]="0"),B(K,pMt(zo,J)),X=!0}return X},unload:function(K){W&&W.rm(),W=null}};return j[hD]=j,j}function dMt(p){if(Wot===null){Wot=!1,!lv&&G4t();try{var v=lv.v||{};Wot=v[V4t]!==void 0}catch(k){ui(p,2,68,"Cannot access document.cookie - "+gs(k),{exception:Bi(k)})}}return Wot}function oLt(p){var v={};if(p&&p[Pa]){var k=Nu(p)[OD](";");Li(k,function(N){if(N=Nu(N||zo),N){var F=Qf(N,"=");F===-1?v[N]=null:v[Nu(E4t(N,F))]=Nu(gv(N,F+1))}})}return v}function fMt(p,v){return Ia(p[v])?p[v]():null}function pMt(p,v){var k=p||zo;return Eo(v,function(N,F){k+="; "+N+(Fr(F)?zo:"="+F)}),k}function Zre(p){var v=zo;if(!lv&&G4t(),lv.v){var k=lv.v[V4t]||zo;lMt!==k&&(cMt=oLt(k),lMt=k),v=Nu(cMt[p]||zo)}return v}function mMt(p,v){!lv&&G4t(),lv.v&&(lv.v[V4t]=p+"="+v)}function Qre(p){return Sa(p)?!!(mf(p,"CPU iPhone OS 12")||mf(p,"iPad; CPU OS 12")||mf(p,"Macintosh; Intel Mac OS X 10_14")&&mf(p,"Version/")&&mf(p,"Safari")||mf(p,"Macintosh; Intel Mac OS X 10_14")&&kOt(p,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||mf(p,"Chrome/5")||mf(p,"Chrome/6")||mf(p,"UnrealEngine")&&!mf(p,"Chrome")||mf(p,"UCBrowser/12")||mf(p,"UCBrowser/11")):!1}var Jre={perfEvtsSendAll:!1};function tie(p){p.h=null;var v=p.cb;p.cb=[],Li(v,function(k){_l(k.fn,[k.arg])})}function Nk(p,v,k,N){Li(p,function(F){F&&F[v]&&(k?(k.cb[Ho]({fn:N,arg:F}),k.h=k.h||xg(tie,0,k)):_l(N,[F]))})}var eie=function(){function p(v){this.listeners=[];var k,N,F=[],W={h:null,cb:[]},L=Sg(v,Jre);N=L[l8](function(O){k=!!O.cfg.perfEvtsSendAll}),Mu(p,this,function(O){Ro(O,"listeners",{g:function(){return F}}),O[iut]=function(S){F[Ho](S)},O[rut]=function(S){for(var B=gf(F,S);B>-1;)F[HD](B,1),B=gf(F,S)},O[_st]=function(S){Nk(F,_st,W,function(B){B[_st](S)})},O[DV]=function(S,B){Nk(F,DV,W,function(j){j[DV](S,B)})},O[Cst]=function(S,B){Nk(F,Cst,B?W:null,function(j){j[Cst](S,B)})},O[r8]=function(S){S&&(k||!S[hxt]())&&Nk(F,r8,null,function(B){S.isAsync?xg(function(){return B[r8](S)},0):B[r8](S)})},O[Lbt]=function(S){S&&S[Pa]&&Nk(F,Lbt,W,function(B){B[Lbt](S)})},O[$bt]=function(S){S&&S[Y1]&&Nk(F,$bt,W,function(B){B[$bt](S)})},O[zbt]=function(S,B){if(S>0){var j=B||0;Nk(F,zbt,W,function(K){K[zbt](S,j)})}},O[_8]=function(S){var B=function(){N&&N.rm(),N=null,F=[],W.h&&W.h[H9](),W.h=null,W.cb=[]},j;if(Nk(F,"unload",null,function(K){var Z=K[_8](S);Z&&(j||(j=[]),j[Ho](Z))}),j)return m5(function(K){return im(Une(j),function(){B(),K()})});B()}})}return p.__ieDyn=1,p}(),bD="ctx",xxt="ParentContextKey",RV="ChildrenContextKey",nie=null,Ist=function(){function p(v,k,N){var F=this;if(F.start=i2(),F[S8]=v,F.isAsync=N,F[hxt]=function(){return!1},Ia(k)){var W;Ro(F,"payload",{g:function(){return!W&&Ia(k)&&(W=k(),k=null),W}})}F[yD]=function(L){return L?L===p[xxt]||L===p[RV]?F[L]:(F[bD]||{})[L]:null},F[Qy]=function(L,O){if(L)if(L===p[xxt])F[L]||(F[hxt]=function(){return!0}),F[L]=O;else if(L===p[RV])F[L]=O;else{var S=F[bD]=F[bD]||{};S[L]=O}},F.complete=function(){var L=0,O=F[yD](p[RV]);if(to(O))for(var S=0;S<O[Pa];S++){var B=O[S];B&&(L+=B.time)}F.time=i2()-F.start,F.exTime=F.time-L,F.complete=function(){}}}return p.ParentContextKey="parent",p.ChildrenContextKey="childEvts",p}(),rie=function(){function p(v){this.ctx={},Mu(p,this,function(k){k.create=function(N,F,W){return new Ist(N,F,W)},k.fire=function(N){N&&(N.complete(),v&&Ia(v[r8])&&v[r8](N))},k[Qy]=function(N,F){if(N){var W=k[bD]=k[bD]||{};W[N]=F}},k[yD]=function(N){return(k[bD]||{})[N]}})}return p.__ieDyn=1,p}(),Qbt="CoreUtils.doPerf";function wut(p,v,k,N,F){if(p){var W=p;if(W[lut]&&(W=W[lut]()),W){var L=void 0,O=W[yD](Qbt);try{if(L=W.create(v(),N,F),L){if(O&&L[Qy]&&(L[Qy](Ist[xxt],O),O[yD]&&O[Qy])){var S=O[yD](Ist[RV]);S||(S=[],O[Qy](Ist[RV],S)),S[Ho](L)}return W[Qy](Qbt,L),k(L)}}catch(B){L&&L[Qy]&&L[Qy]("exception",B)}finally{L&&W.fire(L),W[Qy](Qbt,O)}}}return k()}function iie(){return nie}function Zk(){for(var p=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],v=zo,k,N=0;N<4;N++)k=qV(),v+=p[k&15]+p[k>>4&15]+p[k>>8&15]+p[k>>12&15]+p[k>>16&15]+p[k>>20&15]+p[k>>24&15]+p[k>>28&15];var F=p[8+(qV()&3)|0];return Vk(v,0,8)+Vk(v,9,4)+"4"+Vk(v,13,3)+F+Vk(v,16,3)+Vk(v,19,12)}var kxt="00",aie="ff",sLt="00000000000000000000000000000000",uLt="0000000000000000";function xG(p,v,k){return p&&p[Pa]===v&&p!==k?!!p.match(/^[\da-f]*$/i):!1}function gMt(p,v,k){return xG(p,v)?p:k}function oie(p){(isNaN(p)||p<0||p>255)&&(p=1);for(var v=p.toString(16);v[Pa]<2;)v="0"+v;return v}function yMt(p,v,k,N){return{version:xG(N,2,aie)?N:kxt,traceId:Y4t(p)?p:Zk(),spanId:q4t(v)?v:E4t(Zk(),16),traceFlags:k>=0&&k<=255?k:1}}function Y4t(p){return xG(p,32,sLt)}function q4t(p){return xG(p,16,uLt)}function vMt(p){if(p){var v=oie(p[dxt]);xG(v,2)||(v="01");var k=p[lxt]||kxt;return k!=="00"&&k!=="ff"&&(k=kxt),"".concat(k.toLowerCase(),"-").concat(gMt(p.traceId,32,sLt).toLowerCase(),"-").concat(gMt(p.spanId,16,uLt).toLowerCase(),"-").concat(v.toLowerCase())}return""}function sie(p){var v=p.getElementsByTagName("script"),k=[];return Li(v,function(N){var F=N[Nbt]("src");if(F){var W=N[Nbt]("crossorigin"),L=N.hasAttribute("async")===!0,O=N.hasAttribute("defer")===!0,S=N[Nbt]("referrerpolicy"),B={url:F};W&&(B.crossOrigin=W),L&&(B.async=L),O&&(B.defer=O),S&&(B.referrerPolicy=S),k[Ho](B)}}),k}var uie=ZOt("plugin");function p8(p){return uie.get(p,"state",{},!0)}function bMt(p,v){for(var k=[],N=null,F=p[uv](),W;F;){var L=F[VV]();if(L){N&&N[HV]&&L[dv]&&N[HV](L),W=p8(L);var O=!!W[rv];L[rv]&&(O=L[rv]()),O||k[Ho](L),N=L,F=F[uv]()}}Li(k,function(S){var B=p[Vh]();S[bG](p.getCfg(),B,v,p[uv]()),W=p8(S),!S[Vh]&&!W[Vh]&&(W[Vh]=B),W[rv]=!0,delete W[X3]})}function Jbt(p){return p.sort(function(v,k){var N=0;if(k){var F=k[dv];v[dv]?N=F?v[uut]-k[uut]:1:F&&(N=-1)}else N=v?1:-1;return N})}function lie(p){var v={};return{getName:function(){return v[S8]},setName:function(k){v[S8]=k},getTraceId:function(){return v.traceId},setTraceId:function(k){Y4t(k)&&(v.traceId=k)},getSpanId:function(){return v.spanId},setSpanId:function(k){q4t(k)&&(v.spanId=k)},getTraceFlags:function(){return v[dxt]},setTraceFlags:function(k){v[dxt]=k}}}var cie="TelemetryPluginChain",wMt="_hasRun",xMt="_getTelCtx",kMt=0;function hie(p,v,k){for(;p;){if(p[VV]()===k)return p;p=p[uv]()}return E8([k],v.config||{},v)}function X4t(p,v,k,N){var F=null,W=[];v||(v=Sg({},null,k[Ic])),N!==null&&(F=N?hie(p,k,N):p);var L={_next:S,ctx:{core:function(){return k},diagLog:function(){return R8(k,v.cfg)},getCfg:function(){return v.cfg},getExtCfg:j,getConfig:K,hasNext:function(){return!!F},getNext:function(){return F},setNext:function(Y){F=Y},iterate:Z,onComplete:O}};function O(Y,X){for(var J=[],q=2;q<arguments.length;q++)J[q-2]=arguments[q];Y&&W[Ho]({func:Y,self:Sl(X)?L.ctx:X,args:J})}function S(){var Y=F;if(F=Y?Y[uv]():null,!Y){var X=W;X&&X[Pa]>0&&(Li(X,function(J){try{J.func.call(J.self,J.args)}catch(q){ui(k[Ic],2,73,"Unexpected Exception during onComplete - "+Bi(q))}}),W=[])}return Y}function B(Y,X){var J=null,q=v.cfg;if(q&&Y){var H=q[vD];!H&&X&&(H={}),q[vD]=H,H=v.ref(q,vD),H&&(J=H[Y],!J&&X&&(J={}),H[Y]=J,J=v.ref(H,Y))}return J}function j(Y,X){var J=B(Y,!0);return X&&Eo(X,function(q,H){if(Fr(J[q])){var tt=v.cfg[q];(tt||!Fr(tt))&&(J[q]=tt)}U4t(v,J,q,H)}),v.setDf(J,X)}function K(Y,X,J){J===void 0&&(J=!1);var q,H=B(Y,!1),tt=v.cfg;return H&&(H[X]||!Fr(H[X]))?q=H[X]:(tt[X]||!Fr(tt[X]))&&(q=tt[X]),q||!Fr(q)?q:J}function Z(Y){for(var X;X=L._next();){var J=X[VV]();J&&Y(J)}}return L}function o2(p,v,k,N){var F=Sg(v),W=X4t(p,F,k,N),L=W.ctx;function O(B){var j=W._next();return j&&j[dv](B,L),!j}function S(B,j){return B===void 0&&(B=null),to(B)&&(B=E8(B,F.cfg,k,j)),o2(B||L[uv](),F.cfg,k,j)}return L[qf]=O,L[C8]=S,L}function xut(p,v,k){var N=Sg(v.config),F=X4t(p,N,v,k),W=F.ctx;function L(S){var B=F._next();return B&&B[_8](W,S),!B}function O(S,B){return S===void 0&&(S=null),to(S)&&(S=E8(S,N.cfg,v,B)),xut(S||W[uv](),v,B)}return W[qf]=L,W[C8]=O,W}function K4t(p,v,k){var N=Sg(v.config),F=X4t(p,N,v,k),W=F.ctx;function L(S){return W.iterate(function(B){Ia(B[GV])&&B[GV](W,S)})}function O(S,B){return S===void 0&&(S=null),to(S)&&(S=E8(S,N.cfg,v,B)),K4t(S||W[uv](),v,B)}return W[qf]=L,W[C8]=O,W}function E8(p,v,k,N){var F=null,W=!N;if(to(p)&&p[Pa]>0){var L=null;Li(p,function(O){if(!W&&N===O&&(W=!0),W&&O&&Ia(O[dv])){var S=die(O,v,k);F||(F=S),L&&L._setNext(S),L=S}})}return N&&!F?E8([N],v,k):F}function die(p,v,k){var N=null,F=Ia(p[dv]),W=Ia(p[HV]),L;p?L=p[Gk]+"-"+p[uut]+"-"+kMt++:L="Unknown-0-"+kMt++;var O={getPlugin:function(){return p},getNext:function(){return N},processTelemetry:j,unload:K,update:Z,_id:L,_setNext:function(Y){N=Y}};function S(){var Y;return p&&Ia(p[xMt])&&(Y=p[xMt]()),Y||(Y=o2(O,v,k)),Y}function B(Y,X,J,q,H){var tt=!1,st=p?p[Gk]:cie,lt=Y[wMt];return lt||(lt=Y[wMt]={}),Y.setNext(N),p&&wut(Y[Vh](),function(){return st+":"+J},function(){lt[L]=!0;try{var ft=N?N._id:zo;ft&&(lt[ft]=!1),tt=X(Y)}catch(xt){var gt=N?lt[N._id]:!0;gt&&(tt=!0),(!N||!gt)&&ui(Y[nw](),1,73,"Plugin ["+st+"] failed during "+J+" - "+Bi(xt)+", run flags: "+Bi(lt))}},q,H),tt}function j(Y,X){X=X||S();function J(q){if(!p||!F)return!1;var H=p8(p);return H[X3]||H[pxt]?!1:(W&&p[HV](N),p[dv](Y,q),!0)}B(X,J,"processTelemetry",function(){return{item:Y}},!Y.sync)||X[qf](Y)}function K(Y,X){function J(){var q=!1;if(p){var H=p8(p),tt=p[Vh]||H[Vh];p&&(!tt||tt===Y.core())&&!H[X3]&&(H[Vh]=null,H[X3]=!0,H[rv]=!1,p[X3]&&p[X3](Y,X)===!0&&(q=!0))}return q}B(Y,J,"unload",function(){},X.isAsync)||Y[qf](X)}function Z(Y,X){function J(){var q=!1;if(p){var H=p8(p),tt=p[Vh]||H[Vh];p&&(!tt||tt===Y.core())&&!H[X3]&&p[GV]&&p[GV](Y,X)===!0&&(q=!0)}return q}B(Y,J,"update",function(){},!1)||Y[qf](X)}return r2(O)}function lLt(){var p=[];function v(N){N&&p[Ho](N)}function k(N,F){Li(p,function(W){try{W(N,F)}catch(L){ui(N[nw](),2,73,"Unexpected error calling unload handler - "+Bi(L))}}),p=[]}return{add:v,run:k}}function cLt(){var p=[];function v(N){var F=p;p=[],Li(F,function(W){try{(W.rm||W.remove).call(W)}catch(L){ui(N,2,73,"Unloading:"+Bi(L))}})}function k(N){N&&uD(p,N)}return{run:v,add:k}}var t3t,Mk="getPlugin",fie=(t3t={},t3t[vD]={isVal:d8,v:{}},t3t),YD=function(){function p(){var v=this,k,N,F,W,L;B(),Mu(p,v,function(j){j[bG]=function(K,Z,Y,X){S(K,Z,X),k=!0},j[X3]=function(K,Z){var Y=j[Vh];if(!Y||K&&Y!==K[Vh]())return;var X,J=!1,q=K||xut(null,Y,F&&F[Mk]?F[Mk]():F),H=Z||{reason:0,isAsync:!1};function tt(){J||(J=!0,W.run(q,Z),L.run(q[nw]()),X===!0&&q[qf](H),B())}return!j[out]||j[out](q,H,tt)!==!0?tt():X=!0,X},j[GV]=function(K,Z){var Y=j[Vh];if(!Y||K&&Y!==K[Vh]())return;var X,J=!1,q=K||K4t(null,Y,F&&F[Mk]?F[Mk]():F),H=Z||{reason:0};function tt(){J||(J=!0,S(q.getCfg(),q.core(),q[uv]()))}return!j._doUpdate||j._doUpdate(q,H,tt)!==!0?tt():X=!0,X},hut(j,"_addUnloadCb",function(){return W},"add"),hut(j,"_addHook",function(){return L},"add"),Ro(j,"_unloadHooks",{g:function(){return L}})}),v[nw]=function(j){return O(j)[nw]()},v[rv]=function(){return k},v.setInitialized=function(j){k=j},v[HV]=function(j){F=j},v[qf]=function(j,K){K?K[qf](j):F&&Ia(F[dv])&&F[dv](j,null)},v._getTelCtx=O;function O(j){j===void 0&&(j=null);var K=j;if(!K){var Z=N||o2(null,{},v[Vh]);F&&F[Mk]?K=Z[C8](null,F[Mk]):K=Z[C8](null,F)}return K}function S(j,K,Z){Sg(j,fie,R8(K)),!Z&&K&&(Z=K[IOt]()[uv]());var Y=F;F&&F[Mk]&&(Y=F[Mk]()),v[Vh]=K,N=o2(Z,j,K,Y)}function B(){k=!1,v[Vh]=null,N=null,F=null,L=cLt(),W=lLt()}}return p.__ieDyn=1,p}();function pie(p,v,k){var N={id:v,fn:k};uD(p,N);var F={remove:function(){Li(p,function(W,L){if(W.id===N.id)return p[HD](L,1),-1})}};return F}function mie(p,v,k){for(var N=!1,F=p[Pa],W=0;W<F;++W){var L=p[W];if(L)try{if(L.fn[k8](null,[v])===!1){N=!0;break}}catch(O){ui(k,2,64,"Telemetry initializer failed: "+gs(O),{exception:Bi(O)},!0)}}return!N}var gie=function(p){mw(v,p);function v(){var k=p.call(this)||this;k.identifier="TelemetryInitializerPlugin",k.priority=199;var N,F;W(),Mu(v,k,function(L,O){L.addTelemetryInitializer=function(S){return pie(F,N++,S)},L[dv]=function(S,B){mie(F,S,B?B[nw]():L[nw]())&&L[qf](S,B)},L[out]=function(){W()}});function W(){N=0,F=[]}return k}return v.__ieDyn=1,v}(YD),Dk,hLt="Plugins must provide initialize method",yie="_notificationManager",SMt="SDK is still unloading...",vie="SDK is not initialized",bie=100,wie=5e4,e3t=yG((Dk={cookieCfg:{}},Dk[tD]={rdOnly:!0,ref:!0,v:[]},Dk[JM]={rdOnly:!0,ref:!0,v:[]},Dk[vD]={ref:!0,v:{}},Dk[fxt]=tv,Dk.loggingLevelConsole=0,Dk.diagnosticLogInterval=tv,Dk));function xie(p,v){return new rie(v)}function kie(p,v,k){var N=[],F=[],W={};return Li(k,function(L){(Fr(L)||Fr(L[bG]))&&em(hLt);var O=L[uut],S=L[Gk];L&&O&&(Fr(W[O])?W[O]=S:f8(p,"Two extensions have same priority #"+O+" - "+W[O]+", "+S)),!O||O<v?N[Ho](L):F[Ho](L)}),{core:N,channels:F}}function _Mt(p,v){var k=!1;return Li(v,function(N){if(N===p)return k=!0,-1}),k}function Sxt(p,v,k,N){k&&Eo(k,function(F,W){N&&Zf(W)&&Zf(v[F])&&Sxt(p,v[F],W,N),N&&Zf(W)&&Zf(v[F])?Sxt(p,v[F],W,N):p.set(v,F,W)})}function CMt(p,v){var k=null,N=-1;return Li(p,function(F,W){if(F.w===v)return k=F,N=W,-1}),{i:N,l:k}}function Sie(p,v){var k=CMt(p,v).l;return k||(k={w:v,rm:function(){var N=CMt(p,v);N.i!==-1&&p[HD](N.i,1)}},p[Ho](k)),k}function _ie(p,v,k){Li(v,function(N){var F=ac(p,N.w,k);delete N.w,N.rm=function(){F.rm()}})}function Cie(p,v,k,N){return v.add(p[l8](function(F){var W=F.cfg.disableDbgExt;W===!0&&N&&(k[rut](N),N=null),k&&!N&&W!==!0&&(N=jre(F.cfg),k[iut](N))})),N}function Eie(p){return Ro({rm:function(){p.rm()}},"toJSON",{v:function(){return"aicore::onCfgChange<"+JSON.stringify(p)+">"}})}var Tie=function(){function p(){var v,k,N,F,W,L,O,S,B,j,K,Z,Y,X,J,q,H,tt,st,lt,ft,gt,xt,wt,_t,bt,Tt,qt,It,St,vt,Ft,Qt;Mu(p,this,function(Gt){ie(),Gt._getDbgPlgTargets=function(){return[xt,F]},Gt[rv]=function(){return k},Gt.activeStatus=function(){return bt},Gt._setPendingStatus=function(){bt=3},Gt[bG]=function(Ze,de,Re,Kt){Y&&em(SMt),Gt[rv]()&&em("Core cannot be initialized more than once"),v=Sg(Ze,e3t,Re||Gt[Ic],!1),Ze=v.cfg,Wn(v[l8](function($e){var tn=$e.cfg;qt=tn.initInMemoMaxSize||bie,ge(tn);var wn=$e.ref($e.cfg,vD);Eo(wn,function(Mn){$e.ref(wn,Mn)})})),W=Kt,st=Cie(v,tt,W&&Gt[zot](),st),kn(),Gt[Ic]=Re;var Jt=Ze[tD];if(j=[],j[Ho].apply(j,qNt(qNt([],de,!1),Jt)),K=Ze[JM],ye(null),(!Z||Z[Pa]===0)&&em("No "+JM+" available"),K&&K[Pa]>1){var Ae=Gt[VV]("TeeChannelController");(!Ae||!Ae.plugin)&&ui(N,1,28,"TeeChannel required")}_ie(Ze,gt,N),gt=null,k=!0,bt===Wk.ACTIVE&&Bt()},Gt.getChannels=function(){var Ze=[];return Z&&Li(Z,function(de){Ze[Ho](de)}),r2(Ze)},Gt.track=function(Ze){wut(Gt[lut](),function(){return"AppInsightsCore:track"},function(){Ze===null&&(Sn(Ze),em("Invalid telemetry item")),!Ze[S8]&&Fr(Ze[S8])&&(Sn(Ze),em("telemetry name required")),Ze.iKey=Ze.iKey||ft,Ze.time=Ze.time||LD(new Date),Ze.ver=Ze.ver||"4.0",!Y&&Gt[rv]()&&bt===Wk.ACTIVE?m()[qf](Ze):bt!==Wk.INACTIVE&&F[Pa]<=qt&&F[Ho](Ze)},function(){return{item:Ze}},!Ze.sync)},Gt[IOt]=m,Gt[zot]=function(){return W||(W=new eie(v.cfg),Gt[yie]=W),W},Gt[iut]=function(Ze){Gt.getNotifyMgr()[iut](Ze)},Gt[rut]=function(Ze){W&&W[rut](Ze)},Gt.getCookieMgr=function(){return S||(S=Ast(v.cfg,Gt[Ic])),S},Gt.setCookieMgr=function(Ze){S!==Ze&&(cD(S,!1),S=Ze)},Gt[lut]=function(){return L||O||iie()},Gt.setPerfMgr=function(Ze){L=Ze},Gt.eventCnt=function(){return F[Pa]},Gt.releaseQueue=function(){if(k&&F[Pa]>0){var Ze=F;F=[],bt===2?Li(Ze,function(de){de.iKey=de.iKey||ft,m()[qf](de)}):ui(N,2,20,"core init status is not active")}},Gt.pollInternalLogs=function(Ze){return J=Ze||null,Qt=!1,vt&&vt[H9](),Xt(!0)};function ge(Ze){var de=Ze.instrumentationKey,Re=Ze.endpointUrl;if(bt!==3){if(Fr(de)){ft=null,bt=Wk.INACTIVE;var Kt="Please provide instrumentation key";k?(ui(N,1,100,Kt),Bt()):em(Kt);return}var Jt=[];f5(de)?(Jt[Ho](de),ft=null):ft=de,f5(Re)?(Jt[Ho](Re),Tt=null):Tt=Re,Jt[Pa]?ee(Ze,Jt):Ee()}}function ee(Ze,de){It=!1,bt=3;var Re=d8(Ze.initTimeOut)?Ze.initTimeOut:wie,Kt=jne(de);St&&St[H9](),St=xg(function(){St=null,It||Ee()},Re),im(Kt,function(Jt){try{if(It)return;if(!Jt.rejected){var Ae=Jt[n8];if(Ae&&Ae[Pa]){var $e=Ae[0];if(ft=$e&&$e[n8],Ae[Pa]>1){var tn=Ae[1];Tt=tn&&tn[n8]}}ft&&(Ze.instrumentationKey=ft,Ze.endpointUrl=Tt)}Ee()}catch{It||Ee()}})}function Ee(){It=!0,Fr(ft)?(bt=Wk.INACTIVE,ui(N,1,112,"ikey can't be resolved from promises")):bt=Wk.ACTIVE,Bt()}function Bt(){k&&(Gt.releaseQueue(),Gt.pollInternalLogs())}function Xt(Ze){if((!vt||!vt[lD])&&!Qt){var de=Ze||N&&N.queue[Pa]>0;de&&(Ft||(Ft=!0,Wn(v[l8](function(Re){var Kt=Re.cfg.diagnosticLogInterval;(!Kt||!(Kt>0))&&(Kt=1e4);var Jt=!1;vt&&(Jt=vt[lD],vt[H9]()),vt=wne(Ye,Kt),vt.unref(),vt[lD]=Jt}))),vt[lD]=!0)}return vt}Gt[XNt]=function(){Qt=!0,vt&&vt[H9](),Ye()},vV(Gt,function(){return X},["addTelemetryInitializer"]),Gt[_8]=function(Ze,de,Re){Ze===void 0&&(Ze=!0),k||em(vie),Y&&em(SMt);var Kt={reason:50,isAsync:Ze,flushComplete:!1},Jt;Ze&&!de&&(Jt=m5(function(tn){de=tn}));var Ae=xut(te(),Gt);Ae[Pot](function(){tt.run(Gt[Ic]),nLt([S,W,N],Ze,function(){ie(),de&&de(Kt)})},Gt);function $e(tn){Kt.flushComplete=tn,Y=!0,H.run(Ae,Kt),Gt[XNt](),Ae[qf](Kt)}return Ye(),Ue(Ze,$e,6,Re),Jt},Gt[VV]=Ge,Gt.addPlugin=function(Ze,de,Re,Kt){if(!Ze){Kt&&Kt(!1),Kn(hLt);return}var Jt=Ge(Ze[Gk]);if(Jt&&!de){Kt&&Kt(!1),Kn("Plugin ["+Ze[Gk]+"] is already loaded!");return}var Ae={reason:16};function $e(Mn){j[Ho](Ze),Ae.added=[Ze],ye(Ae),Kt&&Kt(!0)}if(Jt){var tn=[Jt.plugin],wn={reason:2,isAsync:!!Re};Me(tn,wn,function(Mn){Mn?(Ae.removed=tn,Ae.reason|=32,$e()):Kt&&Kt(!1)})}else $e()},Gt.updateCfg=function(Ze,de){de===void 0&&(de=!0);var Re;if(Gt[rv]()){Re={reason:1,cfg:v.cfg,oldCfg:WNt({},v.cfg),newConfig:WNt({},Ze),merge:de},Ze=Re.newConfig;var Kt=v.cfg;Ze[tD]=Kt[tD],Ze[JM]=Kt[JM]}v._block(function(Jt){var Ae=Jt.cfg;Sxt(Jt,Ae,Ze,de),de||Eo(Ae,function($e){n5(Ze,$e)||Jt.set(Ae,$e,tv)}),Jt.setDf(Ae,e3t)},!0),v.notify(),Re&&mn(Re)},Gt.evtNamespace=function(){return q},Gt.flush=Ue,Gt.getTraceCtx=function(Ze){return lt||(lt=lie()),lt},Gt.setTraceCtx=function(Ze){lt=Ze||null},Gt.addUnloadHook=Wn,hut(Gt,"addUnloadCb",function(){return H},"add"),Gt.onCfgChange=function(Ze){var de;return k?de=ac(v.cfg,Ze,Gt[Ic]):de=Sie(gt,Ze),Eie(de)},Gt.getWParam=function(){return cOt()||v.cfg.enableWParam?0:-1};function we(){var Ze={};wt=[];var de=function(Re){Re&&Li(Re,function(Kt){if(Kt[Gk]&&Kt[lxt]&&!Ze[Kt.identifier]){var Jt=Kt[Gk]+"="+Kt[lxt];wt[Ho](Jt),Ze[Kt.identifier]=Kt}})};de(Z),K&&Li(K,function(Re){de(Re)}),de(j)}function ie(){k=!1,v=Sg({},e3t,Gt[Ic]),v.cfg[NOt]=1,Ro(Gt,"config",{g:function(){return v.cfg},s:function(de){Gt.updateCfg(de,!1)}}),Ro(Gt,"pluginVersionStringArr",{g:function(){return wt||we(),wt}}),Ro(Gt,"pluginVersionString",{g:function(){return _t||(wt||we(),_t=wt.join(";")),_t||zo}}),Ro(Gt,"logger",{g:function(){return N||(N=new vut(v.cfg),v[Ic]=N),N},s:function(de){v[Ic]=de,N!==de&&(cD(N,!1),N=de)}}),Gt[Ic]=new vut(v.cfg),xt=[];var Ze=Gt.config[tD]||[];Ze.splice(0,Ze[Pa]),uD(Ze,xt),X=new gie,F=[],cD(W,!1),W=null,L=null,O=null,cD(S,!1),S=null,B=null,j=[],K=null,Z=null,Y=!1,J=null,q=kg("AIBaseCore",!0),H=lLt(),lt=null,ft=null,tt=cLt(),gt=[],_t=null,wt=null,Qt=!1,vt=null,Ft=!1,bt=0,Tt=null,qt=null,It=!1,St=null}function m(){var Ze=o2(te(),v.cfg,Gt);return Ze[Pot](Xt),Ze}function ye(Ze){var de=kie(Gt[Ic],Lre,j);B=null,_t=null,wt=null,Z=(K||[])[0]||[],Z=Jbt(uD(Z,de[JM]));var Re=uD(Jbt(de[Vh]),Z);xt=r2(Re);var Kt=Gt.config[tD]||[];Kt.splice(0,Kt[Pa]),uD(Kt,xt);var Jt=m();Z&&Z[Pa]>0&&bMt(Jt[C8](Z),Re),bMt(Jt,Re),Ze&&mn(Ze)}function Ge(Ze){var de=null,Re=null,Kt=[];return Li(xt,function(Jt){if(Jt[Gk]===Ze&&Jt!==X)return Re=Jt,-1;Jt.getChannel&&Kt[Ho](Jt)}),!Re&&Kt[Pa]>0&&Li(Kt,function(Jt){if(Re=Jt.getChannel(Ze),!Re)return-1}),Re&&(de={plugin:Re,setEnabled:function(Jt){p8(Re)[pxt]=!Jt},isEnabled:function(){var Jt=p8(Re);return!Jt[X3]&&!Jt[pxt]},remove:function(Jt,Ae){Jt===void 0&&(Jt=!0);var $e=[Re],tn={reason:1,isAsync:Jt};Me($e,tn,function(wn){wn&&ye({reason:32,removed:$e}),Ae&&Ae(wn)})}}),de}function te(){if(!B){var Ze=(xt||[]).slice();gf(Ze,X)===-1&&Ze[Ho](X),B=E8(Jbt(Ze),v.cfg,Gt)}return B}function Me(Ze,de,Re){if(Ze&&Ze[Pa]>0){var Kt=E8(Ze,v.cfg,Gt),Jt=xut(Kt,Gt);Jt[Pot](function(){var Ae=!1,$e=[];Li(j,function(wn,Mn){_Mt(wn,Ze)?Ae=!0:$e[Ho](wn)}),j=$e,_t=null,wt=null;var tn=[];K&&(Li(K,function(wn,Mn){var Hn=[];Li(wn,function(Zn){_Mt(Zn,Ze)?Ae=!0:Hn[Ho](Zn)}),tn[Ho](Hn)}),K=tn),Re&&Re(Ae),Xt()}),Jt[qf](de)}else Re(!1)}function Ye(){if(N&&N.queue){var Ze=N.queue.slice(0);N.queue[Pa]=0,Li(Ze,function(de){var Re={name:J||"InternalMessageId: "+de[aut],iKey:ft,time:LD(new Date),baseType:KV.dataType,baseData:{message:de[c8]}};Gt.track(Re)})}}function Ue(Ze,de,Re,Kt){var Jt=1,Ae=!1,$e=null;Kt=Kt||5e3;function tn(){Jt--,Ae&&Jt===0&&($e&&$e[H9](),$e=null,de&&de(Ae),de=null)}if(Z&&Z[Pa]>0){var wn=m()[C8](Z);wn.iterate(function(Mn){if(Mn.flush){Jt++;var Hn=!1;Mn.flush(Ze,function(){Hn=!0,tn()},Re)||Hn||(Ze&&$e==null?$e=xg(function(){$e=null,tn()},Kt):tn())}})}return Ae=!0,tn(),!0}function kn(){var Ze;Wn(v[l8](function(de){var Re=de.cfg.enablePerfMgr;if(Re){var Kt=de.cfg[fxt];(Ze!==Kt||!Ze)&&(Kt||(Kt=xie),Hf(de.cfg,fxt,Kt),Ze=Kt,O=null),!L&&!O&&Ia(Kt)&&(O=Kt(Gt,Gt[zot]()))}else O=null,Ze=null}))}function mn(Ze){var de=K4t(te(),Gt);de[Pot](Xt),(!Gt._updateHook||Gt._updateHook(de,Ze)!==!0)&&de[qf](Ze)}function Kn(Ze){var de=Gt[Ic];de?(ui(de,2,73,Ze),Xt()):em(Ze)}function Sn(Ze){var de=Gt[zot]();de&&de[DV]([Ze],2)}function Wn(Ze){tt.add(Ze)}})}return p.__ieDyn=1,p}();function n3t(p,v){try{if(p&&p!==""){var k=a2().parse(p);if(k&&k[QNt]&&k[QNt]>=k.itemsAccepted&&k.itemsReceived-k.itemsAccepted===k.errors[Pa])return k}}catch(N){ui(v,1,43,"Cannot parse the response. "+(N[S8]||Bi(N)),{response:p})}return null}var H1="",Aie="NoResponseBody",EMt="&"+Aie+"=true",r3t="POST",Iie=function(){function p(){var v=0,k,N,F,W,L,O,S,B,j,K,Z,Y,X,J;Mu(p,this,function(q,H){var tt=!0;It(),q[bG]=function(St,vt){F=vt,N&&ui(F,1,28,"Sender is already initialized"),q.SetConfig(St),N=!0},q._getDbgPlgTargets=function(){return[N,W,O,k]},q.SetConfig=function(St){try{if(L=St.senderOnCompleteCallBack||{},O=!!St.disableCredentials,S=St.fetchCredentials,W=!!St.isOneDs,k=!!St.enableSendPromise,j=!!St.disableXhr,K=!!St.disableBeacon,Z=!!St.disableBeaconSync,J=St.timeWrapper,X=!!St.addNoResponse,Y=!!St.disableFetchKeepAlive,B={sendPOST:bt},W||(tt=!1),O){var vt=iv();vt&&vt.protocol&&vt.protocol[FD]()==="file:"&&(tt=!1)}return!0}catch{}return!1},q.getSyncFetchPayload=function(){return v},q.getSenderInst=function(St,vt){return St&&St[Pa]?gt(St,vt):null},q.getFallbackInst=function(){return B},q[out]=function(St,vt){It()},q.preparePayload=function(St,vt,Ft,Qt){if(!vt||Qt||!Ft[Y1]){St(Ft);return}try{var Gt=Xu("CompressionStream");if(!Ia(Gt)){St(Ft);return}var ge=new ReadableStream({start:function(ie){ie.enqueue(Sa(Ft[Y1])?new TextEncoder().encode(Ft[Y1]):Ft[Y1]),ie.close()}}),ee=ge.pipeThrough(new Gt("gzip")),Ee=ee.getReader(),Bt=[],Xt=0,we=!1;return im(Ee.read(),function ie(m){if(!we&&!m.rejected){var ye=m[n8];if(!ye.done)return Bt[Ho](ye[n8]),Xt+=ye.value[Pa],im(Ee.read(),ie);for(var Ge=new Uint8Array(Xt),te=0,Me=0,Ye=Bt;Me<Ye.length;Me++){var Ue=Ye[Me];Ge.set(Ue,te),te+=Ue[Pa]}Ft[Y1]=Ge,Ft[Bot]["Content-Encoding"]="gzip",Ft._chunkCount=Bt[Pa]}we||(we=!0,St(Ft))}),Ee}catch{St(Ft);return}};function st(St,vt){xt(vt,200,{},St)}function lt(St,vt){ui(F,2,26,"Failed to send telemetry.",{message:St}),xt(vt,400,{})}function ft(St){lt("No endpoint url is provided for the batch",St)}function gt(St,vt){for(var Ft=0,Qt=null,Gt=0;Qt==null&&Gt<St[Pa];)Ft=St[Gt],!j&&Ft===1?mre()?Qt=qt:alt()&&(Qt=bt):Ft===2&&B4t(vt)&&(!vt||!Y)?Qt=Tt:Ft===3&&bV()&&(vt?!Z:!K)&&(Qt=_t),Gt++;return Qt?{_transport:Ft,_isSync:vt,sendPOST:Qt}:null}function xt(St,vt,Ft,Qt){try{St&&St(vt,Ft,Qt)}catch{}}function wt(St,vt){var Ft=yv(),Qt=St[qW];if(!Qt)return ft(vt),!0;Qt=St[qW]+(X?EMt:H1);var Gt=St[Y1],ge=W?Gt:new Blob([Gt],{type:"text/plain;charset=UTF-8"}),ee=Ft.sendBeacon(Qt,ge);return ee}function _t(St,vt,Ft){var Qt=St[Y1];try{if(Qt)if(wt(St,vt))st(H1,vt);else{var Gt=L&&L.beaconOnRetry;Gt&&Ia(Gt)?Gt(St,vt,wt):(B&&B.sendPOST(St,vt,!0),ui(F,2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}catch(ge){W&&f8(F,"Failed to send telemetry using sendBeacon API. Ex:"+Bi(ge)),xt(vt,W?0:400,{},H1)}}function bt(St,vt,Ft){var Qt,Gt,ge,ee=St[Bot]||{};!Ft&&k&&(Qt=m5(function(we,ie){Gt=we,ge=ie})),W&&Ft&&St.disableXhrSync&&(Ft=!1);var Ee=St[qW];if(!Ee){ft(vt),Gt&&Gt(!1);return}var Bt=Jne(r3t,Ee,tt,!0,Ft,St[LM]);W||Bt.setRequestHeader("Content-type","application/json"),Li(ew(ee),function(we){Bt.setRequestHeader(we,ee[we])}),Bt.onreadystatechange=function(){W||(Xt(Bt),Bt.readyState===4&&Gt&&Gt(!0))},Bt.onload=function(){W&&Xt(Bt)};function Xt(we){var ie=L&&L.xhrOnComplete,m=ie&&Ia(ie);if(m)ie(we,vt,St);else{var ye=dut(we);xt(vt,we[q3],jbt(we,W),ye)}}return Bt.onerror=function(we){xt(vt,W?Bt[q3]:400,jbt(Bt,W),W?H1:fut(Bt)),ge&&ge(we)},Bt.ontimeout=function(){xt(vt,W?Bt[q3]:500,jbt(Bt,W),W?H1:fut(Bt)),Gt&&Gt(!1)},Bt.send(St[Y1]),Qt}function Tt(St,vt,Ft){var Qt,Gt=St[qW],ge=St[Y1],ee=W?ge:new Blob([ge],{type:"application/json"}),Ee,Bt,Xt,we=new Headers,ie=ge[Pa],m=!1,ye=!1,Ge=St[Bot]||{},te=(Qt={method:r3t,body:ee},Qt[rMt]=!0,Qt);St.headers&&ew(St.headers)[Pa]>0&&(Li(ew(Ge),function(kn){we.append(kn,Ge[kn])}),te[Bot]=we),S?te.credentials=S:tt&&W&&(te.credentials="include"),Ft&&(te.keepalive=!0,v+=ie,W?St._sendReason===2&&(m=!0,X&&(Gt+=EMt)):m=!0);var Me=new Request(Gt,te);try{Me[rMt]=!0}catch{}if(!Ft&&k&&(Ee=m5(function(kn,mn){Bt=kn,Xt=mn})),!Gt){ft(vt),Bt&&Bt(!1);return}function Ye(kn,mn){mn?xt(vt,W?0:mn,{},W?H1:kn):xt(vt,W?0:400,{},W?H1:kn)}function Ue(kn,mn,Kn){var Sn=kn[q3],Wn=L.fetchOnComplete;Wn&&Ia(Wn)?Wn(kn,vt,Kn||H1,mn):xt(vt,Sn,{},Kn||H1)}try{im(fetch(W?Gt:Me,W?te:null),function(kn){if(Ft&&(v-=ie,ie=0),!ye)if(ye=!0,kn.rejected)Ye(kn.reason&&kn.reason[c8],499),Xt&&Xt(kn.reason);else{var mn=kn[n8];try{!W&&!mn.ok?(mn[q3]?Ye(mn.statusText,mn[q3]):Ye(mn.statusText,499),Bt&&Bt(!1)):W&&!mn.body?(Ue(mn,null,H1),Bt&&Bt(!0)):im(mn.text(),function(Kn){Ue(mn,St,Kn[n8]),Bt&&Bt(!0)})}catch(Kn){mn&&mn[q3]?Ye(Bi(Kn),mn[q3]):Ye(Bi(Kn),499),Xt&&Xt(Kn)}}})}catch(kn){ye||(Ye(Bi(kn),499),Xt&&Xt(kn))}return m&&!ye&&(ye=!0,xt(vt,200,{}),Bt&&Bt(!0)),W&&!ye&&St[LM]>0&&J&&J.set(function(){ye||(ye=!0,xt(vt,500,{}),Bt&&Bt(!0))},St[LM]),Ee}function qt(St,vt,Ft){var Qt=am(),Gt=new XDomainRequest,ge=St[Y1];Gt.onload=function(){var we=dut(Gt),ie=L&&L.xdrOnComplete;ie&&Ia(ie)?ie(Gt,vt,St):xt(vt,200,{},we)},Gt.onerror=function(){xt(vt,400,{},W?H1:BOt(Gt))},Gt.ontimeout=function(){xt(vt,500,{})},Gt.onprogress=function(){};var ee=Qt&&Qt.location&&Qt.location.protocol||"",Ee=St[qW];if(!Ee){ft(vt);return}if(!W&&Ee.lastIndexOf(ee,0)!==0){var Bt="Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.";ui(F,2,40,". "+Bt),lt(Bt,vt);return}var Xt=W?Ee:Ee[h8](/^(https?:)/,"");Gt.open(r3t,Xt),St[LM]&&(Gt[LM]=St[LM]),Gt.send(ge),W&&Ft?J&&J.set(function(){Gt.send(ge)},0):Gt.send(ge)}function It(){v=0,N=!1,k=!1,F=null,W=null,L=null,O=null,S=null,B=null,j=!1,K=!1,Z=!1,Y=!1,X=!1,J=null}})}return p.__ieDyn=1,p}(),dLt="on",TMt="attachEvent",AMt="addEventListener",IMt="detachEvent",NMt="removeEventListener",_xt="events",Cxt="visibilitychange",slt="pagehide",fLt="unload",pLt="beforeunload",mLt=kg("aiEvtPageHide");kg("aiEvtPageShow");var Nie=/\.[\.]+/g,Mie=/[\.]+$/,Die=1,kut=ZOt("events"),Rie=/^([^.]*)(?:\.(.+)|)/;function MMt(p){return p&&p[h8]?p[h8](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,zo):p}function Z4t(p,v){if(v){var k=zo;to(v)?(k=zo,Li(v,function(F){F=MMt(F),F&&(F[0]!=="."&&(F="."+F),k+=F)})):k=MMt(v),k&&(k[0]!=="."&&(k="."+k),p=(p||zo)+k)}var N=Rie.exec(p||zo)||[];return{type:N[1],ns:(N[2]||zo).replace(Nie,".").replace(Mie,zo)[OD](".").sort().join(".")}}function gLt(p,v,k){k===void 0&&(k=!0);var N=kut.get(p,_xt,{},k),F=N[v];return F||(F=N[v]=[]),F}function yLt(p,v,k,N){p&&v&&v[r5]&&(p[NMt]?p[NMt](v[r5],k,N):p[IMt]&&p[IMt](dLt+v[r5],k))}function Fie(p,v,k,N){var F=!1;return p&&v&&v[r5]&&k&&(p[AMt]?(p[AMt](v[r5],k,N),F=!0):p[TMt]&&(p[TMt](dLt+v[r5],k),F=!0)),F}function DMt(p,v,k,N){for(var F=v[Pa];F--;){var W=v[F];W&&(!k.ns||k.ns===W[KNt].ns)&&(!N||N(W))&&(yLt(p,W[KNt],W.handler,W.capture),v[HD](F,1))}}function Oie(p,v,k){if(v[r5])DMt(p,gLt(p,v[r5]),v,k);else{var N=kut.get(p,_xt,{});Eo(N,function(F,W){DMt(p,W,v,k)}),ew(N)[Pa]===0&&kut.kill(p,_xt)}}function T5(p,v){var k;return v?(to(v)?k=[p].concat(v):k=[p,v],k=Z4t("xx",k).ns[OD](".")):k=p,k}function rw(p,v,k,N,F){F===void 0&&(F=!1);var W=!1;if(p)try{var L=Z4t(v,N);if(W=Fie(p,L,k,F),W&&kut.accept(p)){var O={guid:Die++,evtName:L,handler:k,capture:F};gLt(p,L.type)[Ho](O)}}catch{}return W}function wD(p,v,k,N,F){if(F===void 0&&(F=!1),p)try{var W=Z4t(v,N),L=!1;Oie(p,W,function(O){return W.ns||O.handler===k?(L=!0,!0):!1}),L||yLt(p,W,k,F)}catch{}}function Lie(p,v,k){var N=!1,F=am();F&&(N=rw(F,p,v,k),N=rw(F.body,p,v,k)||N);var W=xd();return W&&(N=rw(W,p,v,k)||N),N}function $ie(p,v,k){var N=am();N&&(wD(N,p,v,k),wD(N.body,p,v,k));var F=xd();F&&wD(F,p,v,k)}function Sut(p,v,k,N){var F=!1;return v&&p&&p[Pa]>0&&Li(p,function(W){W&&(!k||gf(k,W)===-1)&&(F=Lie(W,v,N)||F)}),F}function zie(p,v,k,N){var F=!1;return v&&p&&to(p)&&(F=Sut(p,v,k,N),!F&&k&&k[Pa]>0&&(F=Sut(p,v,null,N))),F}function Ext(p,v,k){p&&to(p)&&Li(p,function(N){N&&$ie(N,v,k)})}function Pie(p,v,k){return zie([pLt,fLt,slt],p,v,k)}function Bie(p,v){Ext([pLt,fLt,slt],p,v)}function Txt(p,v,k){function N(L){var O=xd();p&&O&&O.visibilityState==="hidden"&&p(L)}var F=T5(mLt,k),W=Sut([slt],p,v,F);return(!v||gf(v,Cxt)===-1)&&(W=Sut([Cxt],N,v,F)||W),!W&&v&&(W=Txt(p,null,k)),W}function jie(p,v){var k=T5(mLt,v);Ext([slt],p,k),Ext([Cxt],null,k)}var RMt="_aiHooks",FMt=["req","rsp","hkErr","fnErr"];function Q4t(p,v){if(p)for(var k=0;k<p[Pa]&&!v(p[k],k);k++);}function i3t(p,v,k,N,F){F>=0&&F<=2&&Q4t(p,function(W,L){var O=W.cbks,S=O[FMt[F]];if(S){v.ctx=function(){var K=N[L]=N[L]||{};return K};try{S[k8](v.inst,k)}catch(K){var B=v.err;try{var j=O[FMt[2]];j&&(v.err=K,j[k8](v.inst,k))}catch{}finally{v.err=B}}}})}function Uie(p){return function(){var v=this,k=arguments,N=p.h,F={name:p.n,inst:v,ctx:null,set:S},W=[],L=O([F],k);F.evt=Xu("event");function O(j,K){return Q4t(K,function(Z){j[Ho](Z)}),j}function S(j,K){k=O([],k),k[j]=K,L=O([F],k)}i3t(N,F,L,W,0);var B=p.f;if(B)try{F.rslt=B[k8](v,k)}catch(j){throw F.err=j,i3t(N,F,L,W,3),j}return i3t(N,F,L,W,1),F.rslt}}function J4t(p,v,k,N){var F=null;return p&&(wg(p,v)?F=p:k&&(F=J4t(qne(p),v,N,!1))),F}function Wie(p,v,k){return p?Axt(p[sv],v,k,!1):null}function vLt(p,v,k,N){var F=k&&k[RMt];if(!F){F={i:0,n:v,f:k,h:[]};var W=Uie(F);W[RMt]=F,p[v]=W}var L={id:F.i,cbks:N,rm:function(){var O=this.id;Q4t(F.h,function(S,B){if(S.id===O)return F.h[HD](B,1),1})}};return F.i++,F.h[Ho](L),L}function Axt(p,v,k,N,F){if(N===void 0&&(N=!0),p&&v&&k){var W=J4t(p,v,N,F);if(W){var L=W[v];if(typeof L===COt)return vLt(W,v,L,k)}}return null}function Got(p,v,k,N,F){if(p&&v&&k){var W=J4t(p,v,N,F)||p;if(W)return vLt(W,v,W[v],k)}return null}var i8="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",bLt="sampleRate",a3t="ProcessLegacy",OMt="http.method",tkt="https://dc.services.visualstudio.com",xD="/v2/track",fv="not_specified",o3t="iKey",su=Nne({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]}),$D="split",Va="length",ZV="toLowerCase",R9="ingestionendpoint",QV="toString",ekt="removeItem",kG="message",eD="count",s3t="preTriggerDate",u3t="getUTCDate",_ut="stringify",l3t="pathname",JV="match",LMt="correlationHeaderExcludePatterns",pv="name",av="properties",iw="measurements",Nst="sizeInBytes",Mst="typeName",ZW="exceptions",kV="severityLevel",c3t="problemGroup",kD="parsedStack",Cut="hasFullStack",Eut="assembly",aw="fileName",zD="line",ult="aiDataContract",Tut="duration";function wLt(p,v,k){var N=v[Va],F=Vie(p,v);if(F[Va]!==N){for(var W=0,L=F;k[L]!==void 0;)W++,L=gv(F,0,147)+Yie(W);F=L}return F}function Vie(p,v){var k;return v&&(v=Nu(Kf(v)),v[Va]>150&&(k=gv(v,0,150),ui(p,2,57,"name is too long.  It has been truncated to 150 characters.",{name:v},!0))),k||v}function Dc(p,v,k){k===void 0&&(k=1024);var N;return v&&(k=k||1024,v=Nu(Kf(v)),v[Va]>k&&(N=gv(v,0,k),ui(p,2,61,"string value is too long. It has been truncated to "+k+" characters.",{value:v},!0))),N||v}function llt(p,v){return kLt(p,v,2048,66)}function xLt(p,v){var k;return v&&v[Va]>32768&&(k=gv(v,0,32768),ui(p,2,56,"message is too long, it has been truncated to 32768 characters.",{message:v},!0)),k||v}function Gie(p,v){var k;if(v){var N=""+v;N[Va]>32768&&(k=gv(N,0,32768),ui(p,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:v},!0))}return k||v}function F8(p,v){if(v){var k={};Eo(v,function(N,F){if(t0(F)&&wG())try{F=a2()[_ut](F)}catch(W){ui(p,2,49,"custom property is not valid",{exception:W},!0)}F=Dc(p,F,8192),N=wLt(p,N,k),k[N]=F}),v=k}return v}function O8(p,v){if(v){var k={};Eo(v,function(N,F){N=wLt(p,N,k),k[N]=F}),v=k}return v}function Hie(p,v){return v&&kLt(p,v,128,69)[QV]()}function kLt(p,v,k,N){var F;return v&&(v=Nu(Kf(v)),v[Va]>k&&(F=gv(v,0,k),ui(p,2,N,"input is too long, it has been truncated to "+k+" characters.",{data:v},!0))),F||v}function Yie(p){var v="00"+p;return Vk(v,v[Va]-3)}var $Mt=xd()||{},zMt=0,qie=[null,null,null,null,null];function nkt(p){var v=zMt,k=qie,N=k[v];return $Mt.createElement?k[v]||(N=k[v]=$Mt.createElement("a")):N={host:Zie(p)},N.href=p,v++,v>=k[Va]&&(v=0),zMt=v,N}function Xie(p){var v,k=nkt(p);return k&&(v=k.href),v}function Kie(p,v){return p?p.toUpperCase()+" "+v:v}function Zie(p,v){var k=SLt(p)||"";if(k){var N=k[JV](/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(N!=null&&N[Va]>3&&Sa(N[2])&&N[2][Va]>0)return N[2]+(N[3]||"")}return k}function SLt(p,v){var k=null;if(p){var N=p[JV](/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(N!=null&&N[Va]>2&&Sa(N[2])&&N[2][Va]>0&&(k=N[2]||"",N[Va]>2)){var F=(N[1]||"")[ZV](),W=N[3]||"";(F==="http"&&W===":80"||F==="https"&&W===":443")&&(W=""),k+=W}}return k}var Qie=[tkt+xD,"https://breeze.aimon.applicationinsights.io"+xD,"https://dc-int.services.visualstudio.com"+xD],Jie="cid-v1:";function Ixt(p){return gf(Qie,p[ZV]())!==-1}function PMt(p,v,k){if(!v||p&&p.disableCorrelationHeaders)return!1;if(p&&p[LMt]){for(var N=0;N<p.correlationHeaderExcludePatterns[Va];N++)if(p[LMt][N].test(v))return!1}var F=nkt(v).host[ZV]();if(F&&(Qf(F,":443")!==-1||Qf(F,":80")!==-1)&&(F=(SLt(v)||"")[ZV]()),(!p||!p.enableCorsCorrelation)&&F&&F!==k)return!1;var W=p&&p.correlationHeaderDomains;if(W){var L;if(Li(W,function(B){var j=new RegExp(B.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));L=L||j.test(F)}),!L)return!1}var O=p&&p.correlationHeaderExcludedDomains;if(!O||O[Va]===0)return!0;for(var N=0;N<O[Va];N++){var S=new RegExp(O[N].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));if(S.test(F))return!1}return F&&F[Va]>0}function BMt(p){if(p){var v=tae(p,su[1]);if(v&&v!==Jie)return v}}function tae(p,v){if(p)for(var k=p[$D](","),N=0;N<k[Va];++N){var F=k[N][$D]("=");if(F[Va]===2&&F[0]===v)return F[1]}}function eae(p,v,k,N){var F,W=N,L=N;if(v&&v[Va]>0){var O=nkt(v);if(F=O.host,!W)if(O[l3t]!=null){var S=O.pathname[Va]===0?"/":O[l3t];S.charAt(0)!=="/"&&(S="/"+S),L=O[l3t],W=Dc(p,k?k+" "+S:S)}else W=Dc(p,v)}else F=N,W=N;return{target:F,name:W,data:L}}function Hot(){var p=dw();if(p&&p.now&&p.timing){var v=p.now()+p.timing.navigationStart;if(v>0)return v}return i2()}function Qp(p,v){var k=null;return p!==0&&v!==0&&!Fr(p)&&!Fr(v)&&(k=v-p),k}function rkt(p,v){var k=p||{};return{getName:function(){return k[pv]},setName:function(N){v&&v.setName(N),k[pv]=N},getTraceId:function(){return k.traceID},setTraceId:function(N){v&&v.setTraceId(N),Y4t(N)&&(k.traceID=N)},getSpanId:function(){return k.parentID},setSpanId:function(N){v&&v.setSpanId(N),q4t(N)&&(k.parentID=N)},getTraceFlags:function(){return k.traceFlags},setTraceFlags:function(N){v&&v.setTraceFlags(N),k.traceFlags=N}}}var SG=AOt({LocalStorage:0,SessionStorage:1}),a5=void 0,o5=void 0,_Lt="";function ikt(){return hlt()?clt(SG.LocalStorage):null}function clt(p){try{if(Fr(bg()))return null;var v=new Date()[QV](),k=Xu(p===SG.LocalStorage?"localStorage":"sessionStorage"),N=_Lt+v;k.setItem(N,v);var F=k.getItem(N)!==v;if(k[ekt](N),!F)return k}catch{}return null}function akt(){return tG()?clt(SG.SessionStorage):null}function nae(){a5=!1,o5=!1}function okt(p){_Lt=p||""}function rae(){a5=hlt(!0),o5=tG(!0)}function hlt(p){return(p||a5===void 0)&&(a5=!!clt(SG.LocalStorage)),a5}function CLt(p,v){var k=ikt();if(k!==null)try{return k.getItem(v)}catch(N){a5=!1,ui(p,2,1,"Browser failed read of local storage. "+gs(N),{exception:Bi(N)})}return null}function ELt(p,v,k){var N=ikt();if(N!==null)try{return N.setItem(v,k),!0}catch(F){a5=!1,ui(p,2,3,"Browser failed write to local storage. "+gs(F),{exception:Bi(F)})}return!1}function iae(p,v){var k=ikt();if(k!==null)try{return k[ekt](v),!0}catch(N){a5=!1,ui(p,2,5,"Browser failed removal of local storage item. "+gs(N),{exception:Bi(N)})}return!1}function tG(p){return(p||o5===void 0)&&(o5=!!clt(SG.SessionStorage)),o5}function Nxt(p,v){var k=akt();if(k!==null)try{return k.getItem(v)}catch(N){o5=!1,ui(p,2,2,"Browser failed read of session storage. "+gs(N),{exception:Bi(N)})}return null}function TLt(p,v,k){var N=akt();if(N!==null)try{return N.setItem(v,k),!0}catch(F){o5=!1,ui(p,2,4,"Browser failed write to session storage. "+gs(F),{exception:Bi(F)})}return!1}function ALt(p,v){var k=akt();if(k!==null)try{return k[ekt](v),!0}catch(N){o5=!1,ui(p,2,6,"Browser failed removal of session storage item. "+gs(N),{exception:Bi(N)})}return!1}var aae="appInsightsThrottle",oae=function(){function p(v,k){var N=this,F,W,L,O,S,B,j,K=!1,Z=!1;X(),N._getDbgPlgTargets=function(){return[j]},N.getConfig=function(){return L},N.canThrottle=function(St){var vt=Tt(St),Ft=J(St);return tt(Ft,F,vt)},N.isTriggered=function(St){return qt(St)},N.isReady=function(){return K},N.flush=function(St){try{var vt=It(St);if(vt&&vt[Va]>0){var Ft=vt.slice(0);return j[St]=[],Li(Ft,function(Qt){Y(Qt.msgID,Qt[kG],Qt.severity,!1)}),!0}}catch{}return!1},N.flushAll=function(){try{if(j){var St=!0;return Eo(j,function(vt){var Ft=N.flush(parseInt(vt));St=St&&Ft}),St}}catch{}return!1},N.onReadyState=function(St,vt){return vt===void 0&&(vt=!0),K=Fr(St)?!0:St,K&&vt?N.flushAll():null},N.sendMessage=function(St,vt,Ft){return Y(St,vt,Ft,!0)};function Y(St,vt,Ft,Qt){if(K){var Gt=bt(St);if(!Gt)return;var ge=J(St),ee=Tt(St),Ee=tt(ge,F,ee),Bt=!1,Xt=0,we=qt(St);try{Ee&&!we?(Xt=sOt(ge.limit.maxSendNumber,ee[eD]+1),ee[eD]=0,Bt=!0,S[St]=!0,ee[s3t]=new Date):(S[St]=Ee,ee[eD]+=1);var ie=st(St);xt(W,ie,ee);for(var m=0;m<Xt;m++)_t(St,W,vt,Ft)}catch{}return{isThrottled:Bt,throttleNum:Xt}}else if(Qt){var ye=It(St);ye.push({msgID:St,message:vt,severity:Ft})}return null}function X(){W=R8(v),S={},O={},j={},L={},q(109),B=d8(k)?k:"",v.addUnloadHook(ac(v.config,function(St){var vt=St.cfg;F=hlt();var Ft=vt.throttleMgrCfg||{};Eo(Ft,function(Qt,Gt){q(parseInt(Qt),Gt)})}))}function J(St){return L[St]||L[109]}function q(St,vt){var Ft,Qt;try{var Gt=vt||{},ge={};ge.disabled=!!Gt.disabled;var ee=Gt.interval||{};Z=ee?.daysOfMonth&&ee?.daysOfMonth[Va]>0,ge.interval=H(ee);var Ee={samplingRate:((Ft=Gt.limit)===null||Ft===void 0?void 0:Ft.samplingRate)||100,maxSendNumber:((Qt=Gt.limit)===null||Qt===void 0?void 0:Qt.maxSendNumber)||1};ge.limit=Ee,L[St]=ge}catch{}}function H(St){St=St||{};var vt=St?.monthInterval,Ft=St?.dayInterval;return Fr(vt)&&Fr(Ft)&&(St.monthInterval=3,Z||(St.daysOfMonth=[28],Z=!0)),St={monthInterval:St?.monthInterval,dayInterval:St?.dayInterval,daysOfMonth:St?.daysOfMonth},St}function tt(St,vt,Ft){if(St&&!St.disabled&&vt&&d8(Ft)){var Qt=gt(),Gt=Ft.date,ge=St.interval,ee=1;if(ge?.monthInterval){var Ee=(Qt.getUTCFullYear()-Gt.getUTCFullYear())*12+Qt.getUTCMonth()-Gt.getUTCMonth();ee=wt(ge.monthInterval,0,Ee)}var Bt=1;if(Z)Bt=gf(ge.daysOfMonth,Qt[u3t]());else if(ge?.dayInterval){var Xt=rm((Qt.getTime()-Gt.getTime())/864e5);Bt=wt(ge.dayInterval,0,Xt)}return ee>=0&&Bt>=0}return!1}function st(St,vt){var Ft=d8(vt)?vt:"";return St?aae+Ft+"-"+St:null}function lt(St){try{if(St){var vt=new Date;return St.getUTCFullYear()===vt.getUTCFullYear()&&St.getUTCMonth()===vt.getUTCMonth()&&St[u3t]()===vt[u3t]()}}catch{}return!1}function ft(St,vt,Ft){try{var Qt={date:gt(),count:0};if(St){var Gt=JSON.parse(St),ge={date:gt(Gt.date)||Qt.date,count:Gt[eD]||Qt[eD],preTriggerDate:Gt.preTriggerDate?gt(Gt[s3t]):void 0};return ge}else return xt(vt,Ft,Qt),Qt}catch{}return null}function gt(St){try{if(St){var vt=new Date(St);if(!isNaN(vt.getDate()))return vt}else return new Date}catch{}return null}function xt(St,vt,Ft){try{return ELt(St,vt,Nu(JSON[_ut](Ft)))}catch{}return!1}function wt(St,vt,Ft){return St<=0?1:Ft>=vt&&(Ft-vt)%St==0?rm((Ft-vt)/St)+1:-1}function _t(St,vt,Ft,Qt){ui(vt,Qt||1,St,Ft)}function bt(St){try{var vt=J(St);return xre(1e6)<=vt.limit.samplingRate}catch{}return!1}function Tt(St){try{var vt=O[St];if(!vt){var Ft=st(St,B);vt=ft(CLt(W,Ft),W,Ft),O[St]=vt}return O[St]}catch{}return null}function qt(St){var vt=S[St];if(Fr(vt)){vt=!1;var Ft=Tt(St);Ft&&(vt=lt(Ft[s3t])),S[St]=vt}return S[St]}function It(St){return j=j||{},Fr(j[St])&&(j[St]=[]),j[St]}}return p}(),sae=";",uae="=";function ILt(p){if(!p)return{};var v=p[$D](sae),k=Zee(v,function(F,W){var L=W[$D](uae);if(L[Va]===2){var O=L[0][ZV](),S=L[1];F[O]=S}return F},{});if(ew(k)[Va]>0){if(k.endpointsuffix){var N=k.location?k.location+".":"";k[R9]=k[R9]||"https://"+N+"dc."+k.endpointsuffix}k[R9]=k[R9]||tkt,kOt(k[R9],"/")&&(k[R9]=k[R9].slice(0,-1))}return k}var lae=function(){function p(v,k,N){var F=this,W=this;W.ver=1,W.sampleRate=100,W.tags={},W[pv]=Dc(v,N)||fv,W.data=k,W.time=LD(new Date),W[ult]={time:1,iKey:1,name:1,sampleRate:function(){return F.sampleRate===100?4:1},tags:1,data:1}}return p}(),Hk=function(){function p(v,k,N,F){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var W=this;W.ver=2,W[pv]=Dc(v,k)||fv,W[av]=F8(v,N),W[iw]=O8(v,F)}return p.envelopeType="Microsoft.ApplicationInsights.{0}.Event",p.dataType="EventData",p}(),cae=58,hae=/^\s{0,50}(from\s|at\s|Line\s{1,5}\d{1,10}\s{1,5}of|\w{1,50}@\w{1,80}|[^\(\s\n]+:[0-9\?]+(?::[0-9\?]+)?)/,dae=/^(?:\s{0,50}at)?\s{0,50}([^\@\()\s]+)?\s{0,50}(?:\s|\@|\()\s{0,5}([^\(\s\n\]]+):([0-9\?]+):([0-9\?]+)\)?$/,fae=/^(?:\s{0,50}at)?\s{0,50}([^\@\()\s]+)?\s{0,50}(?:\s|\@|\()\s{0,5}([^\(\s\n\]]+):([0-9\?]+)\)?$/,pae=/^(?:\s{0,50}at)?\s{0,50}([^\@\()\s]+)?\s{0,50}(?:\s|\@|\()\s{0,5}([^\(\s\n\)\]]+)\)?$/,mae=/(?:^|\(|\s{0,10}[\w\)]+\@)?([^\(\n\s\]\)]+)(?:\:([0-9]+)(?:\:([0-9]+))?)?\)?(?:,|$)/,gae=/([^\(\s\n]+):([0-9]+):([0-9]+)$/,yae=/([^\(\s\n]+):([0-9]+)$/,jMt="<no_method>",SD="error",mg="stack",Mxt="stackDetails",UMt="errorSrc",Dxt="message",NLt="description",WMt=[{re:dae,len:5,m:1,fn:2,ln:3,col:4},{chk:bae,pre:vae,re:fae,len:4,m:1,fn:2,ln:3},{re:pae,len:3,m:1,fn:2,hdl:GMt},{re:mae,len:2,fn:1,hdl:GMt}];function vae(p){return p.replace(/(\(anonymous\))/,"<anonymous>")}function bae(p){return Qf(p,"[native")<0}function Rxt(p,v){var k=p;return k&&!Sa(k)&&(JSON&&JSON[_ut]?(k=JSON[_ut](p),v&&(!k||k==="{}")&&(Ia(p[QV])?k=p[QV]():k=""+p)):k=""+p+" - (Missing JSON.stringify)"),k||""}function MLt(p,v){var k=p;return p&&(k&&!Sa(k)&&(k=p[Dxt]||p[NLt]||k),k&&!Sa(k)&&(k=Rxt(k,!0)),p.filename&&(k=k+" @"+(p.filename||"")+":"+(p.lineno||"?")+":"+(p.colno||"?"))),v&&v!=="String"&&v!=="Object"&&v!=="Error"&&Qf(k||"",v)===-1&&(k=v+": "+k),k||""}function wae(p){try{if(t0(p))return"hasFullStack"in p&&"typeName"in p}catch{}return!1}function xae(p){try{if(t0(p))return"ver"in p&&"exceptions"in p&&"properties"in p}catch{}return!1}function VMt(p){return p&&p.src&&Sa(p.src)&&p.obj&&to(p.obj)}function F9(p){var v=p||"";Sa(v)||(Sa(v[mg])?v=v[mg]:v=""+v);var k=v[$D](`
`);return{src:v,obj:k}}function kae(p){for(var v=[],k=p[$D](`
`),N=0;N<k[Va];N++){var F=k[N];k[N+1]&&(F+="@"+k[N+1],N++),v.push(F)}return{src:p,obj:v}}function DLt(p){var v=null;if(p)try{if(p[mg])v=F9(p[mg]);else if(p[SD]&&p[SD][mg])v=F9(p[SD][mg]);else if(p.exception&&p.exception[mg])v=F9(p.exception[mg]);else if(VMt(p))v=p;else if(VMt(p[Mxt]))v=p[Mxt];else if(am()&&am().opera&&p[Dxt])v=kae(p[kG]);else if(p.reason&&p.reason[mg])v=F9(p.reason[mg]);else if(Sa(p))v=F9(p);else{var k=p[Dxt]||p[NLt]||"";Sa(p[UMt])&&(k&&(k+=`
`),k+=" from "+p[UMt]),k&&(v=F9(k))}}catch(N){v=F9(N)}return v||{src:"",obj:null}}function Sae(p){var v="";return p&&(p.obj?v=p.obj.join(`
`):v=p.src||""),v}function _ae(p){var v,k=p.obj;if(k&&k[Va]>0){v=[];var N=0,F=!1,W=0;Li(k,function(J){if(F||Aae(J)){var q=Kf(J);F=!0;var H=Iae(q,N);H&&(W+=H[Nst],v.push(H),N++)}});var L=32*1024;if(W>L)for(var O=0,S=v[Va]-1,B=0,j=O,K=S;O<S;){var Z=v[O][Nst],Y=v[S][Nst];if(B+=Z+Y,B>L){var X=K-j+1;v.splice(j,X);break}j=O,K=S,O++,S--}}return v}function Aut(p){var v="";if(p&&(v=p.typeName||p[pv]||"",!v))try{var k=/function (.{1,200})\(/,N=k.exec(p.constructor[QV]());v=N&&N[Va]>1?N[1]:""}catch{}return v}function h3t(p){if(p)try{if(!Sa(p)){var v=Aut(p),k=Rxt(p,!1);return(!k||k==="{}")&&(p[SD]&&(p=p[SD],v=Aut(p)),k=Rxt(p,!0)),Qf(k,v)!==0&&v!=="String"?v+":"+k:k}}catch{}return""+(p||"")}var gg=function(){function p(v,k,N,F,W,L){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var O=this;O.ver=2,xae(k)?(O[ZW]=k[ZW]||[],O[av]=k[av],O[iw]=k[iw],k[kV]&&(O[kV]=k[kV]),k.id&&(O.id=k.id,k[av].id=k.id),k[c3t]&&(O[c3t]=k[c3t]),Fr(k.isManual)||(O.isManual=k.isManual)):(N||(N={}),L&&(N.id=L),O[ZW]=[RLt(v,k,N)],O[av]=F8(v,N),O[iw]=O8(v,F),W&&(O[kV]=W),L&&(O.id=L))}return p.CreateAutoException=function(v,k,N,F,W,L,O,S){var B=Aut(W||L||v);return{message:MLt(v,B),url:k,lineNumber:N,columnNumber:F,error:h3t(W||L||v),evt:h3t(L||v),typeName:B,stackDetails:DLt(O||W||L),errorSrc:S}},p.CreateFromInterface=function(v,k,N,F){var W=k[ZW]&&jV(k[ZW],function(O){return Tae(v,O)}),L=new p(v,Jf(Jf({},k),{exceptions:W}),N,F);return L},p.prototype.toInterface=function(){var v=this,k=v.exceptions,N=v.properties,F=v.measurements,W=v.severityLevel,L=v.problemGroup,O=v.id,S=v.isManual,B=k instanceof Array&&jV(k,function(j){return j.toInterface()})||void 0;return{ver:"4.0",exceptions:B,severityLevel:W,properties:N,measurements:F,problemGroup:L,id:O,isManual:S}},p.CreateSimpleException=function(v,k,N,F,W,L){var O;return{exceptions:[(O={},O[Cut]=!0,O.message=v,O.stack=W,O.typeName=k,O)]}},p.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",p.dataType="ExceptionData",p.formatError=h3t,p}(),Cae=r2({id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2});function Eae(){var p=this,v=to(p[kD])&&jV(p[kD],function(N){return Mae(N)}),k={id:p.id,outerId:p.outerId,typeName:p[Mst],message:p[kG],hasFullStack:p[Cut],stack:p[mg],parsedStack:v||void 0};return k}function RLt(p,v,k){var N,F,W,L,O,S,B,j;if(wae(v))L=v[Mst],O=v[kG],B=v[mg],j=v[kD]||[],S=v[Cut];else{var K=v,Z=K&&K.evt;_4t(K)||(K=K[SD]||Z||K),L=Dc(p,Aut(K))||fv,O=xLt(p,MLt(v||K,L))||fv;var Y=v[Mxt]||DLt(v);j=_ae(Y),to(j)&&jV(j,function(X){X[Eut]=Dc(p,X[Eut]),X[aw]=Dc(p,X[aw])}),B=Gie(p,Sae(Y)),S=to(j)&&j[Va]>0,k&&(k[Mst]=k[Mst]||L)}return N={},N[ult]=Cae,N.id=F,N.outerId=W,N.typeName=L,N.message=O,N[Cut]=S,N.stack=B,N.parsedStack=j,N.toInterface=Eae,N}function Tae(p,v){var k=to(v[kD])&&jV(v[kD],function(F){return Nae(F)})||v[kD],N=RLt(p,Jf(Jf({},v),{parsedStack:k}));return N}function FLt(p,v){var k=v[JV](gae);if(k&&k[Va]>=4)p[aw]=k[1],p[zD]=parseInt(k[2]);else{var N=v[JV](yae);N&&N[Va]>=3?(p[aw]=N[1],p[zD]=parseInt(N[2])):p[aw]=v}}function GMt(p,v,k){var N=p[aw];v.fn&&k&&k[Va]>v.fn&&(v.ln&&k[Va]>v.ln?(N=Nu(k[v.fn]||""),p[zD]=parseInt(Nu(k[v.ln]||""))||0):N=Nu(k[v.fn]||"")),N&&FLt(p,N)}function Aae(p){var v=!1;if(p&&Sa(p)){var k=Nu(p);k&&(v=hae.test(k))}return v}var OLt=r2({level:1,method:1,assembly:0,fileName:0,line:0});function Iae(p,v){var k,N;if(p&&Sa(p)&&Nu(p)){N=(k={},k[ult]=OLt,k.level=v,k.assembly=Nu(p),k.method=jMt,k.fileName="",k.line=0,k.sizeInBytes=0,k);for(var F=0;F<WMt[Va];){var W=WMt[F];if(W.chk&&!W.chk(p))break;W.pre&&(p=W.pre(p));var L=p[JV](W.re);if(L&&L[Va]>=W.len){W.m&&(N.method=Nu(L[W.m]||jMt)),W.hdl?W.hdl(N,W,L):W.fn&&(W.ln?(N[aw]=Nu(L[W.fn]||""),N[zD]=parseInt(Nu(L[W.ln]||""))||0):FLt(N,L[W.fn]||""));break}F++}}return LLt(N)}function Nae(p){var v,k=(v={},v[ult]=OLt,v.level=p.level,v.method=p.method,v.assembly=p[Eut],v.fileName=p[aw],v.line=p[zD],v.sizeInBytes=0,v);return LLt(k)}function LLt(p){var v=cae;return p&&(v+=p.method[Va],v+=p.assembly[Va],v+=p.fileName[Va],v+=p.level.toString()[Va],v+=p.line.toString()[Va],p[Nst]=v),p}function Mae(p){return{level:p.level,method:p.method,assembly:p[Eut],fileName:p[aw],line:p[zD]}}var Dae=function(){function p(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return p}(),m8=function(){function p(v,k,N,F,W,L,O,S,B){this.aiDataContract={ver:1,metrics:1,properties:0};var j=this;j.ver=2;var K=new Dae;K[eD]=F>0?F:void 0,K.max=isNaN(L)||L===null?void 0:L,K.min=isNaN(W)||W===null?void 0:W,K[pv]=Dc(v,k)||fv,K.value=N,K.stdDev=isNaN(O)||O===null?void 0:O,j.metrics=[K],j[av]=F8(v,S),j[iw]=O8(v,B)}return p.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",p.dataType="MetricData",p}(),QW="";function Yk(p){(isNaN(p)||p<0)&&(p=0),p=xOt(p);var v=QW+p%1e3,k=QW+rm(p/1e3)%60,N=QW+rm(p/(1e3*60))%60,F=QW+rm(p/(1e3*60*60))%24,W=rm(p/(1e3*60*60*24));return v=v[Va]===1?"00"+v:v[Va]===2?"0"+v:v,k=k[Va]<2?"0"+k:k,N=N[Va]<2?"0"+N:N,F=F[Va]<2?"0"+F:F,(W>0?W+".":QW)+F+":"+N+":"+k+"."+v}function Rae(p,v,k,N,F){return!F&&Sa(p)&&(p==="Script error."||p==="Script error")}var s5=function(){function p(v,k,N,F,W,L,O){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var S=this;S.ver=2,S.id=Hie(v,O),S.url=llt(v,N),S[pv]=Dc(v,k)||fv,isNaN(F)||(S[Tut]=Yk(F)),S[av]=F8(v,W),S[iw]=O8(v,L)}return p.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",p.dataType="PageviewData",p}(),g8=function(){function p(v,k,N,F,W,L,O,S,B,j,K,Z){B===void 0&&(B="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var Y=this;Y.ver=2,Y.id=k,Y[Tut]=Yk(W),Y.success=L,Y.resultCode=O+"",Y.type=Dc(v,B);var X=eae(v,N,S,F);Y.data=llt(v,F)||X.data,Y.target=Dc(v,X.target),j&&(Y.target="".concat(Y.target," | ").concat(j)),Y[pv]=Dc(v,X[pv]),Y[av]=F8(v,K),Y[iw]=O8(v,Z)}return p.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",p.dataType="RemoteDependencyData",p}(),_D=function(){function p(v,k,N,F,W){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var L=this;L.ver=2,k=k||fv,L[kG]=xLt(v,k),L[av]=F8(v,F),L[iw]=O8(v,W),N&&(L[kV]=N)}return p.envelopeType="Microsoft.ApplicationInsights.{0}.Message",p.dataType="MessageData",p}(),CD=function(){function p(v,k,N,F,W,L,O){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var S=this;S.ver=2,S.url=llt(v,N),S[pv]=Dc(v,k)||fv,S[av]=F8(v,W),S[iw]=O8(v,L),O&&(S.domProcessing=O.domProcessing,S[Tut]=O[Tut],S.networkConnect=O.networkConnect,S.perfTotal=O.perfTotal,S.receivedResponse=O.receivedResponse,S.sentRequest=O.sentRequest)}return p.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",p.dataType="PageviewPerformanceData",p}(),L8=function(){function p(v,k){this.aiDataContract={baseType:1,baseData:1},this.baseType=v,this.baseData=k}return p}();function A5(p){var v="ai."+p+".";return function(k){return v+k}}var JW=A5("application"),lh=A5("device"),Yot=A5("location"),PM=A5("operation"),d3t=A5("session"),Rk=A5("user"),O9=A5("cloud"),tV=A5("internal"),$Lt=function(p){mw(v,p);function v(){return p.call(this)||this}return v}(Kne({applicationVersion:JW("ver"),applicationBuild:JW("build"),applicationTypeId:JW("typeId"),applicationId:JW("applicationId"),applicationLayer:JW("layer"),deviceId:lh("id"),deviceIp:lh("ip"),deviceLanguage:lh("language"),deviceLocale:lh("locale"),deviceModel:lh("model"),deviceFriendlyName:lh("friendlyName"),deviceNetwork:lh("network"),deviceNetworkName:lh("networkName"),deviceOEMName:lh("oemName"),deviceOS:lh("os"),deviceOSVersion:lh("osVersion"),deviceRoleInstance:lh("roleInstance"),deviceRoleName:lh("roleName"),deviceScreenResolution:lh("screenResolution"),deviceType:lh("type"),deviceMachineName:lh("machineName"),deviceVMName:lh("vmName"),deviceBrowser:lh("browser"),deviceBrowserVersion:lh("browserVersion"),locationIp:Yot("ip"),locationCountry:Yot("country"),locationProvince:Yot("province"),locationCity:Yot("city"),operationId:PM("id"),operationName:PM("name"),operationParentId:PM("parentId"),operationRootId:PM("rootId"),operationSyntheticSource:PM("syntheticSource"),operationCorrelationVector:PM("correlationVector"),sessionId:d3t("id"),sessionIsFirst:d3t("isFirst"),sessionIsNew:d3t("isNew"),userAccountAcquisitionDate:Rk("accountAcquisitionDate"),userAccountId:Rk("accountId"),userAgent:Rk("userAgent"),userId:Rk("id"),userStoreRegion:Rk("storeRegion"),userAuthUserId:Rk("authUserId"),userAnonymousUserAcquisitionDate:Rk("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:Rk("authUserAcquisitionDate"),cloudName:O9("name"),cloudRole:O9("role"),cloudRoleVer:O9("roleVer"),cloudRoleInstance:O9("roleInstance"),cloudEnvironment:O9("environment"),cloudLocation:O9("location"),cloudDeploymentUnit:O9("deploymentUnit"),internalNodeName:tV("nodeName"),internalSdkVersion:tV("sdkVersion"),internalAgentVersion:tV("agentVersion"),internalSnippet:tV("snippet"),internalSdkSrc:tV("sdkSrc")}));function Bk(p,v,k,N,F,W){k=Dc(N,k)||fv,(Fr(p)||Fr(v)||Fr(k))&&em("Input doesn't contain all required fields");var L="";p[o3t]&&(L=p[o3t],delete p[o3t]);var O={name:k,time:LD(new Date),iKey:L,ext:W||{},tags:[],data:{},baseType:v,baseData:p};return Fr(F)||Eo(F,function(S,B){O.data[S]=B}),O}var tm={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os"},Au=new $Lt;function eV(p){var v=null;if(Ia(Event))v=new Event(p);else{var k=xd();k&&k.createEvent&&(v=k.createEvent("Event"),v.initEvent(p,!0,!0))}return v}function HMt(p,v){wD(p,null,null,v)}function Fae(p){var v=xd(),k=yv(),N=!1,F=[],W=1;k&&!Fr(k.onLine)&&!k.onLine&&(W=2);var L=0,O=Z(),S=T5(kg("OfflineListener"),p);try{if(j(am())&&(N=!0),v){var B=v.body||v;B.ononline&&j(B)&&(N=!0)}}catch{N=!1}function j(st){var lt=!1;return st&&(lt=rw(st,"online",J,S),lt&&rw(st,"offline",q,S)),lt}function K(){return O}function Z(){return!(L===2||W===2)}function Y(){var st=Z();O!==st&&(O=st,Li(F,function(lt){var ft={isOnline:O,rState:W,uState:L};try{lt(ft)}catch{}}))}function X(st){L=st,Y()}function J(){W=1,Y()}function q(){W=2,Y()}function H(){var st=am();if(st&&N){if(HMt(st,S),v){var lt=v.body||v;Sl(lt.ononline)||HMt(lt,S)}N=!1}}function tt(st){return F.push(st),{rm:function(){var lt=F.indexOf(st);if(lt>-1)return F.splice(lt,1)}}}return{isOnline:K,isListening:function(){return N},unload:H,addListener:tt,setOnlineState:X}}var dlt="AppInsightsPropertiesPlugin",zLt="AppInsightsChannelPlugin",PLt="ApplicationInsightsAnalytics",Iut="toString",Fxt="isStorageUseDisabled",BM="_addHook",bd="core",Fk="dataType",L9="envelopeType",J0="diagLog",$9="track",Dst="trackPageView",Oxt="trackPreviousPageVisit",Y9="sendPageViewInternal",PD="startTime",SV="properties",Jy="duration",Lxt="sendPageViewPerformanceInternal",skt="populatePageViewPerformanceEvent",nD="href",YMt="sendExceptionInternal",nV="error",f3t="lineNumber",p3t="columnNumber",m3t="CreateAutoException",qot="addTelemetryInitializer",Oae="overridePageViewDuration",g3t="autoExceptionInstrumented",BLt="autoTrackPageVisitTime",jLt="isBrowserLinkTrackingEnabled",eG="length",ULt="enableAutoRouteTracking",WLt="enableUnhandledPromiseRejectionTracking",$xt="autoUnhandledPromiseInstrumented",zxt="getEntriesByType",VLt="isPerformanceTimingSupported",GLt="getPerformanceTiming",Nut="navigationStart",Pxt="shouldCollectDuration",HLt="isPerformanceTimingDataReady",_V="responseStart",Lae="requestStart",Rst="loadEventEnd",Bxt="responseEnd",Fst="connectEnd",$ae=function(){function p(v,k,N,F){Mu(p,this,function(W){var L=null,O=[],S=!1,B=!1,j;N&&(j=N.logger);function K(X){N&&N.flush(X,function(){})}function Z(){L||(L=xg(function(){L=null;var X=O.slice(0),J=!1;O=[],Li(X,function(q){q()?J=!0:O.push(q)}),O[eG]>0&&Z(),J&&K(!0)},100))}function Y(X){O.push(X),Z()}W[Dst]=function(X,J){var q=X.name;if(Fr(q)||typeof q!="string"){var H=xd();q=X.name=H&&H.title||""}var tt=X.uri;if(Fr(tt)||typeof tt!="string"){var st=iv();tt=X.uri=st&&st[nD]||""}if(!B){var lt=dw(),ft=lt&&lt[zxt]&&lt[zxt]("navigation");if(ft&&ft[0]&&!Sl(lt.timeOrigin)){var gt=ft[0].loadEventStart;X[PD]=new Date(lt.timeOrigin+gt)}else{var xt=(J||X[SV]||{})[Jy]||0;X[PD]=new Date(new Date().getTime()-xt)}B=!0}if(!F[VLt]()){v[Y9](X,J),K(!0),dOt()||ui(j,2,25,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");return}var wt=!1,_t,bt=F[GLt]()[Nut];bt>0&&(_t=Qp(bt,+new Date),F[Pxt](_t)||(_t=void 0));var Tt;!Fr(J)&&!Fr(J[Jy])&&(Tt=J[Jy]),(k||!isNaN(Tt))&&(isNaN(Tt)&&(J||(J={}),J[Jy]=_t),v[Y9](X,J),K(!0),wt=!0);var qt=6e4;J||(J={}),Y(function(){var It=!1;try{if(F[HLt]()){It=!0;var St={name:q,uri:tt};F[skt](St),!St.isValid&&!wt?(J[Jy]=_t,v[Y9](X,J)):(wt||(J[Jy]=St.durationMs,v[Y9](X,J)),S||(v[Lxt](St,J),S=!0))}else bt>0&&Qp(bt,+new Date)>qt&&(It=!0,wt||(J[Jy]=qt,v[Y9](X,J)))}catch(vt){ui(j,1,38,"trackPageView failed on page load calculation: "+gs(vt),{exception:Bi(vt)})}return It})},W.teardown=function(X,J){if(L){L.cancel(),L=null;var q=O.slice(0);O=[],Li(q,function(H){H()})}}})}return p.__ieDyn=1,p}(),zae=36e5,qMt=["googlebot","adsbot-google","apis-google","mediapartners-google"];function YLt(){var p=dw();return p&&!!p.timing}function Pae(){var p=dw();return p&&p.getEntriesByType&&p.getEntriesByType("navigation")[eG]>0}function Bae(){var p=dw(),v=p?p.timing:0;return v&&v.domainLookupStart>0&&v[Nut]>0&&v[_V]>0&&v[Lae]>0&&v[Rst]>0&&v[Bxt]>0&&v[Fst]>0&&v.domLoading>0}function XMt(){return YLt()?dw().timing:null}function jae(){return Pae()?dw()[zxt]("navigation")[0]:null}function Uae(){for(var p=[],v=0;v<arguments.length;v++)p[v]=arguments[v];var k=yv()||{},N=k.userAgent,F=!1;if(N)for(var W=0;W<qMt[eG];W++)F=F||Qf(N.toLowerCase(),qMt[W])!==-1;if(F)return!1;for(var W=0;W<p[eG];W++)if(p[W]<0||p[W]>=zae)return!1;return!0}var Wae=function(){function p(v){var k=R8(v);Mu(p,this,function(N){N[skt]=function(F){F.isValid=!1;var W=jae(),L=XMt(),O=0,S=0,B=0,j=0,K=0;(W||L)&&(W?(O=W[Jy],S=W[PD]===0?W[Fst]:Qp(W[PD],W[Fst]),B=Qp(W.requestStart,W[_V]),j=Qp(W[_V],W[Bxt]),K=Qp(W.responseEnd,W[Rst])):(O=Qp(L[Nut],L[Rst]),S=Qp(L[Nut],L[Fst]),B=Qp(L.requestStart,L[_V]),j=Qp(L[_V],L[Bxt]),K=Qp(L.responseEnd,L[Rst])),O===0?ui(k,2,10,"error calculating page view performance.",{total:O,network:S,request:B,response:j,dom:K}):N[Pxt](O,S,B,j,K)?O<rm(S)+rm(B)+rm(j)+rm(K)?ui(k,2,8,"client performance math error.",{total:O,network:S,request:B,response:j,dom:K}):(F.durationMs=O,F.perfTotal=F[Jy]=Yk(O),F.networkConnect=Yk(S),F.sentRequest=Yk(B),F.receivedResponse=Yk(j),F.domProcessing=Yk(K),F.isValid=!0):ui(k,2,45,"Invalid page load duration value. Browser perf data won't be sent.",{total:O,network:S,request:B,response:j,dom:K}))},N[GLt]=XMt,N[VLt]=YLt,N[HLt]=Bae,N[Pxt]=Uae})}return p.__ieDyn=1,p}(),Vae=function(){function p(v,k){var N="prevPageVisitData";Mu(p,this,function(F){F[Oxt]=function(O,S){try{var B=W(O,S);B&&k(B.pageName,B.pageUrl,B.pageVisitTime)}catch(j){f8(v,"Auto track page visit time failed, metric will not be collected: "+Bi(j))}};function W(O,S){var B=null;try{if(B=L(),tG()){Nxt(v,N)!=null&&em("Cannot call startPageVisit consecutively without first calling stopPageVisit");var j=a2().stringify(new Gae(O,S));TLt(v,N,j)}}catch(K){f8(v,"Call to restart failed: "+Bi(K)),B=null}return B}function L(){var O=null;try{if(tG()){var S=i2(),B=Nxt(v,N);B&&wG()&&(O=a2().parse(B),O.pageVisitTime=S-O.pageVisitStartTime,ALt(v,N))}}catch(j){f8(v,"Stop page visit timer failed: "+Bi(j)),O=null}return O}Ro(F,"_logger",{g:function(){return v}}),Ro(F,"pageVisitTimeTrackingHandler",{g:function(){return k}})})}return p.__ieDyn=1,p}(),Gae=function(){function p(v,k){this.pageVisitStartTime=i2(),this.pageName=v,this.pageUrl=k}return p}(),KMt=function(){function p(v,k){var N=this,F={};N.start=function(W){typeof F[W]<"u"&&ui(v,2,62,"start was called more than once for this event without calling stop.",{name:W,key:W},!0),F[W]=+new Date},N.stop=function(W,L,O,S){var B=F[W];if(isNaN(B))ui(v,2,63,"stop was called without a corresponding start.",{name:W,key:W},!0);else{var j=+new Date,K=Qp(B,j);N.action(W,L,K,O,S)}delete F[W],F[W]=void 0}}return p}(),Gf,Hae="event";function rV(p,v){p&&p.dispatchEvent&&v&&p.dispatchEvent(v)}function Yae(p){if(p&&p.reason){var v=p.reason;return!Sa(v)&&Ia(v[Iut])?v[Iut]():Bi(v)}return p||""}var ZMt=6e4,qae=yG((Gf={sessionRenewalMs:iMt(QMt,30*60*1e3),sessionExpirationMs:iMt(QMt,24*60*60*1e3),disableExceptionTracking:Nc()},Gf[BLt]=Nc(),Gf[Oae]=Nc(),Gf[WLt]=Nc(),Gf[$xt]=!1,Gf.samplingPercentage=gut(Xae,100),Gf[Fxt]=Nc(),Gf[jLt]=Nc(),Gf[ULt]=Nc(),Gf.namePrefix=zre(),Gf.enableDebug=Nc(),Gf.disableFlushOnBeforeUnload=Nc(),Gf.disableFlushOnUnload=Nc(!1,"disableFlushOnBeforeUnload"),Gf.expCfg=X1({inclScripts:!1,expLog:void 0,maxLogs:50}),Gf));function QMt(p,v){return p=p||v,p<ZMt&&(p=ZMt),+p}function Xae(p){return!isNaN(p)&&p>0&&p<=100}function Kae(p){Sl(p[Fxt])||(p[Fxt]?nae():rae())}var Zae=function(p){mw(v,p);function v(){var k=p.call(this)||this;k.identifier=PLt,k.priority=180,k.autoRoutePVDelay=500;var N,F,W,L,O,S,B,j,K,Z,Y,X,J,q,H,tt,st,lt,ft,gt,xt;return Mu(v,k,function(wt,_t){var bt=_t[BM];Ee(),wt.getCookieMgr=function(){return H4t(wt[bd])},wt.processTelemetry=function(Bt,Xt){wt.processNext(Bt,Xt)},wt.trackEvent=function(Bt,Xt){try{var we=Bk(Bt,Hk[Fk],Hk[L9],wt[J0](),Xt);wt[bd][$9](we)}catch(ie){ee(2,39,"trackTrace failed, trace will not be collected: "+gs(ie),{exception:Bi(ie)})}},wt.startTrackEvent=function(Bt){try{N.start(Bt)}catch(Xt){ee(1,29,"startTrackEvent failed, event will not be collected: "+gs(Xt),{exception:Bi(Xt)})}},wt.stopTrackEvent=function(Bt,Xt,we){try{N.stop(Bt,void 0,Xt,we)}catch(ie){ee(1,30,"stopTrackEvent failed, event will not be collected: "+gs(ie),{exception:Bi(ie)})}},wt.trackTrace=function(Bt,Xt){try{var we=Bk(Bt,_D[Fk],_D[L9],wt[J0](),Xt);wt[bd][$9](we)}catch(ie){ee(2,39,"trackTrace failed, trace will not be collected: "+gs(ie),{exception:Bi(ie)})}},wt.trackMetric=function(Bt,Xt){try{var we=Bk(Bt,m8[Fk],m8[L9],wt[J0](),Xt);wt[bd][$9](we)}catch(ie){ee(1,36,"trackMetric failed, metric will not be collected: "+gs(ie),{exception:Bi(ie)})}},wt[Dst]=function(Bt,Xt){try{var we=Bt||{};W[Dst](we,Jf(Jf(Jf({},we.properties),we.measurements),Xt)),tt&&O[Oxt](we.name,we.uri)}catch(ie){ee(1,37,"trackPageView failed, page view will not be collected: "+gs(ie),{exception:Bi(ie)})}},wt[Y9]=function(Bt,Xt,we){var ie=xd();if(ie&&(Bt.refUri=Bt.refUri===void 0?ie.referrer:Bt.refUri),Fr(Bt[PD])){var m=(Xt||Bt[SV]||{})[Jy]||0;Bt[PD]=new Date(new Date().getTime()-m)}var ye=Bk(Bt,s5[Fk],s5[L9],wt[J0](),Xt,we);wt[bd][$9](ye)},wt[Lxt]=function(Bt,Xt,we){var ie=Bk(Bt,CD[Fk],CD[L9],wt[J0](),Xt,we);wt[bd][$9](ie)},wt.trackPageViewPerformance=function(Bt,Xt){var we=Bt||{};try{L[skt](we),wt[Lxt](we,Xt)}catch(ie){ee(1,37,"trackPageViewPerformance failed, page view will not be collected: "+gs(ie),{exception:Bi(ie)})}},wt.startTrackPage=function(Bt){try{if(typeof Bt!="string"){var Xt=xd();Bt=Xt&&Xt.title||""}F.start(Bt)}catch(we){ee(1,31,"startTrackPage failed, page view may not be collected: "+gs(we),{exception:Bi(we)})}},wt.stopTrackPage=function(Bt,Xt,we,ie){try{if(typeof Bt!="string"){var m=xd();Bt=m&&m.title||""}if(typeof Xt!="string"){var ye=iv();Xt=ye&&ye[nD]||""}F.stop(Bt,Xt,we,ie),tt&&O[Oxt](Bt,Xt)}catch(Ge){ee(1,32,"stopTrackPage failed, page view will not be collected: "+gs(Ge),{exception:Bi(Ge)})}},wt[YMt]=function(Bt,Xt,we){var ie=Bt&&(Bt.exception||Bt[nV])||_4t(Bt)&&Bt||{name:Bt&&typeof Bt,message:Bt||fv};Bt=Bt||{};var m=new gg(wt[J0](),ie,Bt[SV]||Xt,Bt.measurements,Bt.severityLevel,Bt.id).toInterface(),ye=xd();if(ye&&st?.inclScripts){var Ge=sie(ye);m[SV].exceptionScripts=JSON.stringify(Ge)}if(st?.expLog){var te=st.expLog();te&&te.logs&&to(te.logs)&&(m[SV].exceptionLog=te.logs.slice(0,st.maxLogs).join(`
`))}var Me=Bk(m,gg[Fk],gg[L9],wt[J0](),Xt,we);wt[bd][$9](Me)},wt.trackException=function(Bt,Xt){Bt&&!Bt.exception&&Bt[nV]&&(Bt.exception=Bt[nV]);try{wt[YMt](Bt,Xt)}catch(we){ee(1,35,"trackException failed, exception will not be collected: "+gs(we),{exception:Bi(we)})}},wt._onerror=function(Bt){var Xt=Bt&&Bt[nV],we=Bt&&Bt.evt;try{if(!we){var ie=am();ie&&(we=ie[Hae])}var m=Bt&&Bt.url||(xd()||{}).URL,ye=Bt.errorSrc||"window.onerror@"+m+":"+(Bt[f3t]||0)+":"+(Bt[p3t]||0),Ge={errorSrc:ye,url:m,lineNumber:Bt[f3t]||0,columnNumber:Bt[p3t]||0,message:Bt.message};Rae(Bt.message,Bt.url,Bt.lineNumber,Bt.columnNumber,Bt[nV])?St(gg[m3t]("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",m,Bt[f3t]||0,Bt[p3t]||0,Xt,we,null,ye),Ge):(Bt.errorSrc||(Bt.errorSrc=ye),wt.trackException({exception:Bt,severityLevel:3},Ge))}catch(Me){var te=Xt?Xt.name+", "+Xt.message:"null";ee(1,11,"_onError threw exception while logging error, error will not be collected: "+gs(Me),{exception:Bi(Me),errorString:te})}},wt[qot]=function(Bt){if(wt[bd])return wt[bd][qot](Bt);S||(S=[]),S.push(Bt)},wt.initialize=function(Bt,Xt,we,ie){if(!wt.isInitialized()){Fr(Xt)&&em("Error initializing"),_t.initialize(Bt,Xt,we,ie);try{gt=T5(kg(wt.identifier),Xt.evtNamespace&&Xt.evtNamespace()),S&&(Li(S,function(m){Xt[qot](m)}),S=null),Tt(Bt),L=new Wae(wt[bd]),W=new $ae(wt,H.overridePageViewDuration,wt[bd],L),O=new Vae(wt[J0](),function(m,ye,Ge){return qt(m,ye,Ge)}),N=new KMt(wt[J0](),"trackEvent"),N.action=function(m,ye,Ge,te,Me){te||(te={}),Me||(Me={}),te.duration=Ge[Iut](),wt.trackEvent({name:m,properties:te,measurements:Me})},F=new KMt(wt[J0](),"trackPageView"),F.action=function(m,ye,Ge,te,Me){Fr(te)&&(te={}),te.duration=Ge[Iut]();var Ye={name:m,uri:ye,properties:te,measurements:Me};wt[Y9](Ye,te)},nlt()&&(vt(),Ft())}catch(m){throw wt.setInitialized(!1),m}}},wt._doTeardown=function(Bt,Xt){W&&W.teardown(Bt,Xt),wD(window,null,null,gt),Ee()},wt._getDbgPlgTargets=function(){return[xt,X]};function Tt(Bt){var Xt=wt.identifier,we=wt[bd];wt[BM](ac(Bt,function(){var ie=o2(null,Bt,we);H=ie.getExtCfg(Xt,qae),X=X||Bt[g3t]||H[g3t],st=H.expCfg,tt=H[BLt],Bt.storagePrefix&&okt(Bt.storagePrefix),Kae(H),B=H[jLt],It()}))}function qt(Bt,Xt,we){var ie={PageName:Bt,PageUrl:Xt};wt.trackMetric({name:"PageVisitTime",average:we,max:we,min:we,sampleCount:1},ie)}function It(){if(!j&&B){var Bt=["/browserLinkSignalR/","/__browserLink/"],Xt=function(we){if(B&&we.baseType===g8[Fk]){var ie=we.baseData;if(ie){for(var m=0;m<Bt[eG];m++)if(ie.target&&Qf(ie.target,Bt[m])>=0)return!1}}return!0};wt[BM](wt[qot](Xt)),j=!0}}function St(Bt,Xt){var we=Bk(Bt,gg[Fk],gg[L9],wt[J0](),Xt);wt[bd][$9](we)}function vt(){var Bt=am(),Xt=iv(!0);wt[BM](ac(H,function(){Y=H.disableExceptionTracking,!Y&&!X&&!H[g3t]&&(bt(Got(Bt,"onerror",{ns:gt,rsp:function(we,ie,m,ye,Ge,te){!Y&&we.rslt!==!0&&wt._onerror(gg[m3t](ie,m,ye,Ge,te,we.evt))}},!1)),xt++,X=!0)})),ge(Bt,Xt)}function Ft(){var Bt=am(),Xt=iv(!0);wt[BM](ac(H,function(){if(K=H[ULt]===!0,Bt&&K&&!Z&&Hee()){var we=hOt();Ia(we.pushState)&&Ia(we.replaceState)&&typeof Event!==$4t&&Gt(Bt,we,Xt)}}))}function Qt(){var Bt=null;if(wt[bd]&&wt[bd].getTraceCtx&&(Bt=wt[bd].getTraceCtx(!1)),!Bt){var Xt=wt[bd].getPlugin(dlt);if(Xt){var we=Xt.plugin.context;we&&(Bt=rkt(we.telemetryTrace))}}return Bt}function Gt(Bt,Xt,we){if(Z)return;var ie=H.namePrefix||"";function m(){K&&rV(Bt,eV(ie+"locationchange"))}function ye(){if(ft&&(lt=ft),ft=we&&we[nD]||"",K){var Ge=Qt();if(Ge){Ge.setTraceId(Zk());var te="_unknown_";we&&we.pathname&&(te=we.pathname+(we.hash||"")),Ge.setName(Dc(wt[J0](),te))}xg((function(Me){wt[Dst]({refUri:Me,properties:{duration:0}})}).bind(wt,lt),wt.autoRoutePVDelay)}}bt(Got(Xt,"pushState",{ns:gt,rsp:function(){K&&(rV(Bt,eV(ie+"pushState")),rV(Bt,eV(ie+"locationchange")))}},!0)),bt(Got(Xt,"replaceState",{ns:gt,rsp:function(){K&&(rV(Bt,eV(ie+"replaceState")),rV(Bt,eV(ie+"locationchange")))}},!0)),rw(Bt,ie+"popstate",m,gt),rw(Bt,ie+"locationchange",ye,gt),Z=!0}function ge(Bt,Xt){wt[BM](ac(H,function(){J=H[WLt]===!0,X=X||H[$xt],J&&!q&&(bt(Got(Bt,"onunhandledrejection",{ns:gt,rsp:function(we,ie){J&&we.rslt!==!0&&wt._onerror(gg[m3t](Yae(ie),Xt?Xt[nD]:"",0,0,ie,we.evt))}},!1)),xt++,H[$xt]=q=!0)}))}function ee(Bt,Xt,we,ie,m){wt[J0]().throwInternal(Bt,Xt,we,ie,m)}function Ee(){N=null,F=null,W=null,L=null,O=null,S=null,B=!1,j=!1,K=!1,Z=!1,Y=!1,X=!1,J=!1,q=!1,tt=!1;var Bt=iv(!0);lt=Bt&&Bt[nD]||"",ft=null,gt=null,H=null,xt=0,Ro(wt,"config",{g:function(){return H}})}Ro(wt,"_pageViewManager",{g:function(){return W}}),Ro(wt,"_pageViewPerformanceManager",{g:function(){return L}}),Ro(wt,"_pageVisitTimeManager",{g:function(){return O}}),Ro(wt,"_evtNamespace",{g:function(){return"."+gt}})}),k}return v.Version="3.3.9",v}(YD),Ost="featureOptIn",qLt="scheduleFetchTimeout";function XLt(p,v,k,N){try{var F=k>N;F&&(p=null);var W=k==0?cne({},p):p;return W&&v&&!F&&Eo(W,function(L){var O=v[L];O&&(t0(W[L])&&t0(O)?W[L]=XLt(W[L],O,++k,N):delete W[L])}),W}catch{}return p}var ED="featureOptIn.",KLt=".mode",ZLt=".onCfg",QLt=".offCfg";function Qae(p,v,k){var N;if(!v||!v.enabled)return null;var F=(v[Ost]||{})[p]||{mode:1},W=F.mode,L=F.onCfg,O=F.offCfg,S=(k||{})[p]||{mode:2},B=S.mode,j=S.onCfg,K=S.offCfg,Z=!!S.blockCdnCfg,Y=ED+p+KLt,X=ED+p+ZLt,J=ED+p+QLt,q=B,H=j,tt=K;return Z||(W===4||W===5?(q=W==4?3:2,H=L||j,tt=O||K):W===2||B===2?(q=2,H=j||L,tt=K||O):W===3?(q=3,H=j||L,tt=K||O):W===1&&B===1&&(q=1)),N={},N[Y]=q,N[X]=H,N[J]=tt,N}function Jae(p,v){try{if(!p||!p.enabled)return null;if(!p[Ost])return p.config;var k=p[Ost],N=p.config||{};return Eo(k,function(F){var W=Qae(F,p,v.config[Ost]);Fr(W)||(Eo(W,function(L,O){wOt(N,L,O)}),toe(F,W,N))}),N}catch{}return null}function toe(p,v,k){var N=v[ED+p+KLt],F=v[ED+p+ZLt],W=v[ED+p+QLt],L=null;N===3&&(L=F),N===2&&(L=W),L&&Eo(L,function(O,S){wOt(k,O,S)})}var iV,eoe="ai_cfgsync",JMt="GET",noe=18e5,jM=void 0,roe={instrumentationKey:!0,connectionString:!0,endpointUrl:!0},ioe=yG((iV={syncMode:1,blkCdnCfg:jM,customEvtName:jM,cfgUrl:jM,overrideSyncFn:jM,overrideFetchFn:jM,onCfgChangeReceive:jM},iV[qLt]=noe,iV.nonOverrideConfigs=roe,iV.enableAjax=!1,iV)),aoe=function(p){mw(v,p);function v(){var k=p.call(this)||this;k.priority=198,k.identifier="AppInsightsCfgSyncPlugin";var N,F,W,L,O,S,B,j,K,Z,Y,X,J,q,H,tt,st=!1,lt;return Mu(v,k,function(ft,gt){xt(),ft.initialize=function(Bt,Xt,we,ie){gt.initialize(Bt,Xt,we,ie),L=T5(kg(ft.identifier),Xt.evtNamespace&&Xt.evtNamespace()),wt(Bt)},ft.getCfg=function(){return F},ft.pause=function(){st=!0,Ee()},ft.resume=function(){st=!1,ee()},ft.setCfg=function(Bt){return _t(Bt)},ft.sync=function(Bt){return Tt(Bt)},ft.updateEventListenerName=function(Bt){return qt(Bt)},ft._doTeardown=function(Bt,Xt){bt(),Ee(),xt()},ft._getDbgPlgTargets=function(){return[j,B,W,K,J]};function xt(){F=null,W=null,L=null,O=null,B=null,j=null,J=null,S=null,Z=null,Y=null,K=null,lt=!1,H=null,tt=null,X=null}function wt(Bt){var Xt=ft.identifier,we=ft.core;ft._addHook(ac(Bt,function(){var ie=o2(null,Bt,we);N=ie.getExtCfg(Xt,ioe);var m=K;K=!!N.blkCdnCfg,lt=!!N.enableAjax,!Fr(m)&&m!==K&&(!K&&O?q&&q(O,Ft,j):Ee()),Fr(B)&&(B=N.syncMode===2),Fr(j)&&(j=N.syncMode===1);var ye=N.customEvtName||eoe;W!==ye&&(B?qt(ye):(bt(),W=ye)),Fr(O)&&(O=N.cfgUrl),O||(F=Bt,j&&Tt())})),tt=N.overrideSyncFn,H=N.overrideFetchFn,X=N.onCfgChangeReceive,J=N.nonOverrideConfigs,Z=N[qLt],q=It(),Y=0,O&&!K&&q&&q(O,Ft,j)}function _t(Bt,Xt){if(Bt){if(F=Bt,Xt&&!st)return Tt();if(B&&!st)return ft.core.updateCfg(Bt),!0}return!1}function bt(){try{var Bt=bg();Bt&&wD(Bt,null,null,L)}catch{}}function Tt(Bt){try{return tt&&Ia(tt)?tt(F,Bt):vre(W,F,Bt)}catch{}return!1}function qt(Bt){try{return bt(),Bt&&(W=Bt,Gt()),!0}catch{}return!1}function It(){var Bt=H;return Fr(Bt)&&(B4t()?Bt=St:alt()&&(Bt=vt)),Bt}function St(Bt,Xt,we){var ie=bg(),m=ie&&ie.fetch||null;if(Bt&&m&&Ia(m))try{var ye={method:JMt};lt||(ye[i8]=!0);var Ge=new Request(Bt,ye);if(!lt)try{Ge[i8]=!0}catch{}im(fetch(Ge),function(te){var Me=te.value;te.rejected?Qt(Xt,400):Me.ok?im(Me.text(),function(Ye){Qt(Xt,Me.status,Ye.value,we)}):Qt(Xt,Me.status,null,we)})}catch{}}function vt(Bt,Xt,we){try{var ie=new XMLHttpRequest;lt||(ie[i8]=!0),ie.open(JMt,Bt),ie.onreadystatechange=function(){ie.readyState===XMLHttpRequest.DONE&&Qt(Xt,ie.status,ie.responseText,we)},ie.onerror=function(){Qt(Xt,400)},ie.ontimeout=function(){Qt(Xt,400)},ie.send()}catch{}}function Ft(Bt,Xt,we){try{if(Bt>=200&&Bt<400&&Xt){Y=0;var ie=a2();if(ie){var m=ie.parse(Xt),ye=Jae(m,ft.core),Ge=ye&&Zf(ye)&&ge(ye);Ge&&_t(Ge,we)}}else Y++;Y<3&&ee()}catch{}}function Qt(Bt,Xt,we,ie){try{Bt(Xt,we,ie)}catch{}}function Gt(){if(B){var Bt=bg();if(Bt)try{rw(Bt,W,function(Xt){var we=Xt&&Xt.detail;if(X&&we)X(we);else{var ie=we&&we.cfg,m=ie&&Zf(ie)&&ge(ie);m&&_t(m)}},L,!0)}catch{}}}function ge(Bt,Xt){var we=null;try{Bt&&(we=XLt(Bt,J,0,5))}catch{}return we}function ee(){!S&&Z&&(S=xg(function(){S=null,q(O,Ft,j)},Z),S.unref())}function Ee(){S&&S.cancel(),S=null,Y=0}ft.processTelemetry=function(Bt,Xt){ft.processNext(Bt,Xt)}}),k}return v.__ieDyn=1,v}(YD),W9="duration",wd="tags",y3t="deviceType",nm="data",pw="name",nG="traceID",Co="length",rG="stringify",$8="measurements",cv="dataType",z8="envelopeType",V9="toString",y8="enqueue",v8="count",ow="push",jxt="emitLineDelimitedJson",TD="clear",Mut="markAsSent",FV="clearSent",ukt="bufferOverride",aV="BUFFER_KEY",Ok="SENT_BUFFER_KEY",rD="concat",oV="MAX_BUFFER_SIZE",sV="triggerSend",pf="diagLog",v3t="initialize",uV="_sender",lV="endpointUrl",CV="instrumentationKey",Uxt="customHeaders",JLt="maxBatchSizeInBytes",Wxt="onunloadDisableBeacon",Vxt="isBeaconApiDisabled",t$t="alwaysUseXhrOverride",e$t="enableSessionStorageBuffer",Hy="_buffer",n$t="onunloadDisableFetch",r$t="disableSendBeaconSplit",Xot="getSenderInst",z9="_onError",b3t="_onPartialSuccess",Kot="_onSuccess",w3t="itemsReceived",x3t="itemsAccepted",k3t="baseType",Dut="sampleRate",ooe="getHashCodeScore",S3t="baseType",hl="baseData",Gh="properties",tDt="true";function ic(p,v,k){return vu(p,v,k,Xst)}function soe(p,v,k){var N=k[wd]=k[wd]||{},F=v.ext=v.ext||{},W=v[wd]=v[wd]||[],L=F.user;L&&(ic(N,Au.userAuthUserId,L.authId),ic(N,Au.userId,L.id||L.localId));var O=F.app;O&&ic(N,Au.sessionId,O.sesId);var S=F.device;S&&(ic(N,Au.deviceId,S.id||S.localId),ic(N,Au[y3t],S.deviceClass),ic(N,Au.deviceIp,S.ip),ic(N,Au.deviceModel,S.model),ic(N,Au[y3t],S[y3t]));var B=v.ext.web;if(B){ic(N,Au.deviceLanguage,B.browserLang),ic(N,Au.deviceBrowserVersion,B.browserVer),ic(N,Au.deviceBrowser,B.browser);var j=k[nm]=k[nm]||{},K=j[hl]=j[hl]||{},Z=K[Gh]=K[Gh]||{};ic(Z,"domain",B.domain),ic(Z,"isManual",B.isManual?tDt:null),ic(Z,"screenRes",B.screenRes),ic(Z,"userConsent",B.userConsent?tDt:null)}var Y=F.os;Y&&(ic(N,Au.deviceOS,Y[pw]),ic(N,Au.deviceOSVersion,Y.osVer));var X=F.trace;X&&(ic(N,Au.operationParentId,X.parentID),ic(N,Au.operationName,Dc(p,X[pw])),ic(N,Au.operationId,X[nG]));for(var J={},q=W[Co]-1;q>=0;q--){var H=W[q];Eo(H,function(st,lt){J[st]=lt}),W.splice(q,1)}Eo(W,function(st,lt){J[st]=lt});var tt=Jf(Jf({},N),J);tt[Au.internalSdkVersion]||(tt[Au.internalSdkVersion]=Dc(p,"javascript:".concat(uoe.Version),64)),k[wd]=zOt(tt)}function y5(p,v,k){Fr(p)||Eo(p,function(N,F){gG(F)?k[N]=F:Sa(F)?v[N]=F:wG()&&(v[N]=a2()[rG](F))})}function P8(p,v){Fr(p)||Eo(p,function(k,N){p[k]=N||v})}function B8(p,v,k,N){var F=new lae(p,N,v);ic(F,"sampleRate",k[bLt]),(k[hl]||{}).startTime&&(F.time=LD(k[hl].startTime)),F.iKey=k.iKey;var W=k.iKey.replace(/-/g,"");return F[pw]=F[pw].replace("{0}",W),soe(p,k,F),k[wd]=k[wd]||[],zOt(F)}function j8(p,v){Fr(v[hl])&&ui(p,1,46,"telemetryItem.baseData cannot be null.")}var uoe={Version:"3.3.9"};function loe(p,v,k){j8(p,v);var N=v[hl][$8]||{},F=v[hl][Gh]||{};y5(v[nm],F,N),Fr(k)||P8(F,k);var W=v[hl];if(Fr(W))return f8(p,"Invalid input for dependency data"),null;var L=W[Gh]&&W[Gh][OMt]?W[Gh][OMt]:"GET",O=new g8(p,W.id,W.target,W[pw],W[W9],W.success,W.responseCode,L,W.type,W.correlationContext,F,N),S=new L8(g8[cv],O);return B8(p,g8[z8],v,S)}function i$t(p,v,k){j8(p,v);var N={},F={};v[S3t]!==Hk[cv]&&(N.baseTypeSource=v[S3t]),v[S3t]===Hk[cv]?(N=v[hl][Gh]||{},F=v[hl][$8]||{}):v[hl]&&y5(v[hl],N,F),y5(v[nm],N,F),Fr(k)||P8(N,k);var W=v[hl][pw],L=new Hk(p,W,N,F),O=new L8(Hk[cv],L);return B8(p,Hk[z8],v,O)}function coe(p,v,k){j8(p,v);var N=v[hl][$8]||{},F=v[hl][Gh]||{};y5(v[nm],F,N),Fr(k)||P8(F,k);var W=v[hl],L=gg.CreateFromInterface(p,W,F,N),O=new L8(gg[cv],L);return B8(p,gg[z8],v,O)}function hoe(p,v,k){j8(p,v);var N=v[hl],F=N[Gh]||{},W=N[$8]||{};y5(v[nm],F,W),Fr(k)||P8(F,k);var L=new m8(p,N[pw],N.average,N.sampleCount,N.min,N.max,N.stdDev,F,W),O=new L8(m8[cv],L);return B8(p,m8[z8],v,O)}function doe(p,v,k){j8(p,v);var N,F=v[hl];!Fr(F)&&!Fr(F[Gh])&&!Fr(F[Gh][W9])?(N=F[Gh][W9],delete F[Gh][W9]):!Fr(v[nm])&&!Fr(v[nm][W9])&&(N=v[nm][W9],delete v[nm][W9]);var W=v[hl],L;((v.ext||{}).trace||{})[nG]&&(L=v.ext.trace[nG]);var O=W.id||L,S=W[pw],B=W.uri,j=W[Gh]||{},K=W[$8]||{};if(Fr(W.refUri)||(j.refUri=W.refUri),Fr(W.pageType)||(j.pageType=W.pageType),Fr(W.isLoggedIn)||(j.isLoggedIn=W.isLoggedIn[V9]()),!Fr(W[Gh])){var Z=W[Gh];Eo(Z,function(J,q){j[J]=q})}y5(v[nm],j,K),Fr(k)||P8(j,k);var Y=new s5(p,S,B,N,j,K,O),X=new L8(s5[cv],Y);return B8(p,s5[z8],v,X)}function foe(p,v,k){j8(p,v);var N=v[hl],F=N[pw],W=N.uri||N.url,L=N[Gh]||{},O=N[$8]||{};y5(v[nm],L,O),Fr(k)||P8(L,k);var S=new CD(p,F,W,void 0,L,O,N),B=new L8(CD[cv],S);return B8(p,CD[z8],v,B)}function poe(p,v,k){j8(p,v);var N=v[hl].message,F=v[hl].severityLevel,W=v[hl][Gh]||{},L=v[hl][$8]||{};y5(v[nm],W,L),Fr(k)||P8(W,k);var O=new _D(p,N,F,W,L),S=new L8(_D[cv],O);return B8(p,_D[z8],v,S)}var a$t=function(){function p(v,k){var N=[],F=!1,W=k.maxRetryCnt;this._get=function(){return N},this._set=function(L){return N=L,N},Mu(p,this,function(L){L[y8]=function(O){if(L[v8]()>=k.eventsLimitInMem){F||(ui(v,2,105,"Maximum in-memory buffer size reached: "+L[v8](),!0),F=!0);return}O.cnt=O.cnt||0,!(!Fr(W)&&O.cnt>W)&&N[ow](O)},L[v8]=function(){return N[Co]},L.size=function(){for(var O=N[Co],S=0;S<N[Co];S++)O+=N[S].item[Co];return k[jxt]||(O+=2),O},L[TD]=function(){N=[],F=!1},L.getItems=function(){return N.slice(0)},L.batchPayloads=function(O){if(O&&O[Co]>0){var S=[];Li(O,function(j){S[ow](j.item)});var B=k[jxt]?S.join(`
`):"["+S.join(",")+"]";return B}return null},L.createNew=function(O,S,B){var j=N.slice(0);O=O||v,S=S||{};var K=B?new o$t(O,S):new lkt(O,S);return Li(j,function(Z){K[y8](Z)}),K}})}return p.__ieDyn=1,p}(),lkt=function(p){mw(v,p);function v(k,N){var F=p.call(this,k,N)||this;return Mu(v,F,function(W,L){W[Mut]=function(O){L[TD]()},W[FV]=function(O){}}),F}return v.__ieDyn=1,v}(a$t),moe=["AI_buffer","AI_sentBuffer"],o$t=function(p){mw(v,p);function v(N,F){var W=p.call(this,N,F)||this,L=!1,O=F?.namePrefix,S=F[ukt]||{getItem:Nxt,setItem:TLt},B=S.getItem,j=S.setItem,K=F.maxRetryCnt;return Mu(v,W,function(Z,Y){var X=lt(v[aV]),J=lt(v[Ok]),q=xt(),H=J[rD](q),tt=Z._set(X[rD](H));tt[Co]>v[oV]&&(tt[Co]=v[oV]),gt(v[Ok],[]),gt(v[aV],tt),Z[y8]=function(_t){if(Z[v8]()>=v[oV]){L||(ui(N,2,67,"Maximum buffer size reached: "+Z[v8](),!0),L=!0);return}_t.cnt=_t.cnt||0,!(!Fr(K)&&_t.cnt>K)&&(Y[y8](_t),gt(v[aV],Z._get()))},Z[TD]=function(){Y[TD](),gt(v[aV],Z._get()),gt(v[Ok],[]),L=!1},Z[Mut]=function(_t){gt(v[aV],Z._set(st(_t,Z._get())));var bt=lt(v[Ok]);bt instanceof Array&&_t instanceof Array&&(bt=bt[rD](_t),bt[Co]>v[oV]&&(ui(N,1,67,"Sent buffer reached its maximum size: "+bt[Co],!0),bt[Co]=v[oV]),gt(v[Ok],bt))},Z[FV]=function(_t){var bt=lt(v[Ok]);bt=st(_t,bt),gt(v[Ok],bt)},Z.createNew=function(_t,bt,Tt){Tt=!!Tt;var qt=Z._get().slice(0),It=lt(v[Ok]).slice(0);_t=_t||N,bt=bt||{},Z[TD]();var St=Tt?new v(_t,bt):new lkt(_t,bt);return Li(qt,function(vt){St[y8](vt)}),Tt&&St[Mut](It),St};function st(_t,bt){var Tt=[],qt=[];return Li(_t,function(It){qt[ow](It.item)}),Li(bt,function(It){!Ia(It)&&gf(qt,It.item)===-1&&Tt[ow](It)}),Tt}function lt(_t){var bt=_t;return bt=O?O+"_"+bt:bt,ft(bt)}function ft(_t){try{var bt=B(N,_t);if(bt){var Tt=a2().parse(bt);if(Sa(Tt)&&(Tt=a2().parse(Tt)),Tt&&to(Tt))return Tt}}catch(qt){ui(N,1,42," storage key: "+_t+", "+gs(qt),{exception:Bi(qt)})}return[]}function gt(_t,bt){var Tt=_t;try{Tt=O?O+"_"+Tt:Tt;var qt=JSON[rG](bt);j(N,Tt,qt)}catch(It){j(N,Tt,JSON[rG]([])),ui(N,2,41," storage key: "+Tt+", "+gs(It)+". Buffer cleared",{exception:Bi(It)})}}function xt(){var _t=[];try{return Li(moe,function(bt){var Tt=wt(bt);if(_t=_t[rD](Tt),O){var qt=O+"_"+bt,It=wt(qt);_t=_t[rD](It)}}),_t}catch(bt){ui(N,2,41,"Transfer events from previous buffers: "+gs(bt)+". previous Buffer items can not be removed",{exception:Bi(bt)})}return[]}function wt(_t){try{var bt=ft(_t),Tt=[];return Li(bt,function(qt){var It={item:qt,cnt:0};Tt[ow](It)}),ALt(N,_t),Tt}catch{}return[]}}),W}var k;return k=v,v.VERSION="_1",v.BUFFER_KEY="AI_buffer"+k.VERSION,v.SENT_BUFFER_KEY="AI_sentBuffer"+k.VERSION,v.MAX_BUFFER_SIZE=2e3,v}(a$t),goe=function(){function p(v){Mu(p,this,function(k){k.serialize=function(L){var O=N(L,"root");try{return a2()[rG](O)}catch(S){ui(v,1,48,S&&Ia(S[V9])?S[V9]():"Error serializing object",null,!0)}};function N(L,O){var S="__aiCircularRefCheck",B={};if(!L)return ui(v,1,48,"cannot serialize object because it is null or undefined",{name:O},!0),B;if(L[S])return ui(v,2,50,"Circular reference detected while serializing object",{name:O},!0),B;if(!L.aiDataContract){if(O==="measurements")B=W(L,"number",O);else if(O==="properties")B=W(L,"string",O);else if(O==="tags")B=W(L,"string",O);else if(to(L))B=F(L,O);else{ui(v,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:O},!0);try{a2()[rG](L),B=L}catch(j){ui(v,1,48,j&&Ia(j[V9])?j[V9]():"Error serializing object",null,!0)}}return B}return L[S]=!0,Eo(L.aiDataContract,function(j,K){var Z=Ia(K)?K()&1:K&1,Y=Ia(K)?K()&4:K&4,X=K&2,J=L[j]!==void 0,q=t0(L[j])&&L[j]!==null;if(Z&&!J&&!X)ui(v,1,24,"Missing required field specification. The field is required but not present on source",{field:j,name:O});else if(!Y){var H=void 0;q?X?H=F(L[j],j):H=N(L[j],j):H=L[j],H!==void 0&&(B[j]=H)}}),delete L[S],B}function F(L,O){var S;if(L)if(!to(L))ui(v,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:O},!0);else{S=[];for(var B=0;B<L[Co];B++){var j=L[B],K=N(j,O+"["+B+"]");S[ow](K)}}return S}function W(L,O,S){var B;return L&&(B={},Eo(L,function(j,K){if(O==="string")K===void 0?B[j]="undefined":K===null?B[j]="null":K[V9]?B[j]=K[V9]():B[j]="invalid field: toString() is not defined.";else if(O==="number")if(K===void 0)B[j]="undefined";else if(K===null)B[j]="null";else{var Z=parseFloat(K);B[j]=Z}else B[j]="invalid field: "+S+" is of unknown type.",ui(v,1,B[j],null,!0)})),B}})}return p.__ieDyn=1,p}(),yoe=8,voe=function(){function p(){}return p.prototype.getHashCodeScore=function(v){var k=this.getHashCode(v)/p.INT_MAX_VALUE;return k*100},p.prototype.getHashCode=function(v){if(v==="")return 0;for(;v[Co]<yoe;)v=v[rD](v);for(var k=5381,N=0;N<v[Co];++N)k=(k<<5)+k+v.charCodeAt(N),k=k&k;return Math.abs(k)},p.INT_MAX_VALUE=2147483647,p}(),boe=function(){function p(){var v=this,k=new voe,N=new $Lt;v.getSamplingScore=function(F){var W=0;return F[wd]&&F[wd][N.userId]?W=k.getHashCodeScore(F[wd][N.userId]):F.ext&&F.ext.user&&F.ext.user.id?W=k[ooe](F.ext.user.id):F[wd]&&F[wd][N.operationId]?W=k.getHashCodeScore(F[wd][N.operationId]):F.ext&&F.ext.telemetryTrace&&F.ext.telemetryTrace[nG]?W=k.getHashCodeScore(F.ext.telemetryTrace[nG]):W=Math.random()*100,W}}return p}(),woe=function(){function p(v,k){this.INT_MAX_VALUE=2147483647;var N=k||R8(null);(v>100||v<0)&&(N.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:v},!0),v=100),this[Dut]=v,this.samplingScoreGenerator=new boe}return p.prototype.isSampledIn=function(v){var k=this[Dut],N=!1;return k==null||k>=100||v.baseType===m8[cv]?!0:(N=this.samplingScoreGenerator.getSamplingScore(v)<k,N)},p}(),Tu,V3,q1=void 0,eDt="",xoe=65e3;function nDt(p){try{return p.responseText}catch{}return null}function koe(p){return p&&p.sendPOST}var rDt=yG((Tu={endpointUrl:gut(Xst,tkt+xD)},Tu[jxt]=Nc(),Tu.maxBatchInterval=15e3,Tu[JLt]=102400,Tu.disableTelemetry=Nc(),Tu[e$t]=Nc(!0),Tu.isRetryDisabled=Nc(),Tu[Vxt]=Nc(!0),Tu[r$t]=Nc(!0),Tu.disableXhr=Nc(),Tu[n$t]=Nc(),Tu[Wxt]=Nc(),Tu[CV]=q1,Tu.namePrefix=q1,Tu.samplingPercentage=gut(Soe,100),Tu[Uxt]=q1,Tu.convertUndefined=q1,Tu.eventsLimitInMem=1e4,Tu[ukt]=!1,Tu.httpXHROverride={isVal:koe,v:q1},Tu[t$t]=Nc(),Tu.transports=q1,Tu.retryCodes=q1,Tu.corsPolicy=q1,Tu.maxRetryCnt={isVal:gG,v:10},Tu)),iDt="X-Set-Cross-Origin-Resource-Policy";function Soe(p){return!isNaN(p)&&p>0&&p<=100}var _oe=(V3={},V3[Hk.dataType]=i$t,V3[_D.dataType]=poe,V3[s5.dataType]=doe,V3[CD.dataType]=foe,V3[gg.dataType]=coe,V3[m8.dataType]=hoe,V3[g8.dataType]=loe,V3),Coe=function(p){mw(v,p);function v(){var k=p.call(this)||this;k.priority=1001,k.identifier=zLt;var N,F,W,L,O,S,B,j=0,K,Z,Y,X,J,q,H,tt,st,lt,ft,gt,xt,wt,_t,bt,Tt,qt,It,St,vt,Ft,Qt,Gt,ge,ee,Ee,Bt;return Mu(v,k,function(Xt,we){Ti(),Xt.pause=function(){Mr(),W=!0},Xt.resume=function(){W&&(W=!1,F=null,Jt(),Sr())},Xt.flush=function(Be,En,lr){if(Be===void 0&&(Be=!0),!W){Mr();try{return Xt[sV](Be,null,lr||1)}catch(qn){ui(Xt[pf](),1,22,"flush failed, telemetry will not be collected: "+gs(qn),{exception:Bi(qn)})}}},Xt.onunloadFlush=function(){if(!W)if(H||St)try{return Xt[sV](!0,tn,2)}catch(Be){ui(Xt[pf](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+gs(Be),{exception:Bi(Be)})}else Xt.flush(!1)},Xt.addHeader=function(Be,En){B[Be]=En},Xt[v3t]=function(Be,En,lr,qn){Xt.isInitialized()&&ui(Xt[pf](),1,28,"Sender is already initialized"),we[v3t](Be,En,lr,qn);var fr=Xt.identifier;O=new goe(En.logger),N=0,F=null,Xt[uV]=null,S=0;var Er=Xt[pf]();Y=T5(kg("Sender"),En.evtNamespace&&En.evtNamespace()),Z=Fae(Y),Xt._addHook(ac(Be,function(Qr){var vi=Qr.cfg;vi.storagePrefix&&okt(vi.storagePrefix);var ua=o2(null,vi,En),br=ua.getExtCfg(fr,rDt),eo=br[lV];if(X&&eo===X){var Fo=vi[lV];Fo&&Fo!==eo&&(br[lV]=Fo)}var Wa=Xu("CompressionStream");Bt=Est("zipPayload",vi,!1),Ia(Wa)||(Bt=!1);var Le=br.corsPolicy;Le?(Le==="same-origin"||Le==="same-site"||Le==="cross-origin")&&k.addHeader(iDt,Le):delete B[iDt],f5(br[CV])&&(br[CV]=vi[CV]),Ro(Xt,"_senderConfig",{g:function(){return br}}),J!==br[lV]&&(X=J=br[lV]),En.activeStatus()===Wk.PENDING?Xt.pause():En.activeStatus()===Wk.ACTIVE&&Xt.resume(),lt&&lt!==br[Uxt]&&Li(lt,function(_i){delete B[_i.header]}),q=br[JLt],H=(br[Wxt]===!1||br[Vxt]===!1)&&bV(),tt=br[Wxt]===!1&&bV(),st=br[Vxt]===!1&&bV(),St=br[t$t],vt=!!br.disableXhr,Ee=br.retryCodes;var bn=br[ukt],jn=!!br[e$t]&&(!!bn||tG()),Jn=br.namePrefix,dr=jn!==bt||jn&&qt!==Jn||jn&&Tt!==bn;if(Xt[Hy]){if(dr)try{Xt[Hy]=Xt[Hy].createNew(Er,br,jn)}catch(_i){ui(Xt[pf](),1,12,"failed to transfer telemetry to different buffer storage, telemetry will be lost: "+gs(_i),{exception:Bi(_i)})}Jt()}else Xt[Hy]=jn?new o$t(Er,br):new lkt(Er,br);qt=Jn,bt=jn,Tt=bn,Ft=!br[n$t]&&B4t(!0),ge=!!br[r$t],Xt._sample=new woe(br.samplingPercentage,Er),gt=br[CV],!f5(gt)&&!Cr(gt,vi)&&ui(Er,1,100,"Invalid Instrumentation key "+gt),lt=br[Uxt],Sa(X)&&!Ixt(X)&&lt&&lt[Co]>0?Li(lt,function(_i){k.addHeader(_i.header,_i.value)}):lt=null,It=br.enableSendPromise;var Ur=m();ee?ee.SetConfig(Ur):(ee=new Iie,ee[v3t](Ur,Er));var or=br.httpXHROverride,Yn=null,li=null,Ki=eMt([3,1,2],br.transports);Yn=ee&&ee[Xot](Ki,!1);var Si=ee&&ee.getFallbackInst();Qt=function(_i,la){return de(Si,_i,la)},Gt=function(_i,la){return de(Si,_i,la,!1)},Yn=St?or:Yn||or||Si,Xt[uV]=function(_i,la){return de(Yn,_i,la)},Ft&&(K=Hn);var Da=eMt([3,1],br.unloadTransports);Ft||(Da=Da.filter(function(_i){return _i!==2})),li=ee&&ee[Xot](Da,!0),li=St?or:li||or,(St||br.unloadTransports||!K)&&li&&(K=function(_i,la){return de(li,_i,la)}),K||(K=Qt),ft=br.disableTelemetry,xt=br.convertUndefined||q1,wt=br.isRetryDisabled,_t=br.maxBatchInterval}))},Xt.processTelemetry=function(Be,En){En=Xt._getTelCtx(En);var lr=En[pf]();try{var qn=Ue(Be,lr);if(!qn)return;var fr=kn(Be,lr);if(!fr)return;var Er=O.serialize(fr),Qr=Xt[Hy];Jt(Er);var vi={item:Er,cnt:0};Qr[y8](vi),Sr()}catch(ua){ui(lr,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+gs(ua),{exception:Bi(ua)})}Xt.processNext(Be,En)},Xt.isCompletelyIdle=function(){return!W&&j===0&&Xt._buffer[v8]()===0},Xt.getOfflineListener=function(){return Z},Xt._xhrReadyStateChange=function(Be,En,lr){if(!Mn(En))return ye(Be,En,lr)},Xt[sV]=function(Be,En,lr){Be===void 0&&(Be=!0);var qn;if(!W)try{var fr=Xt[Hy];if(ft)fr[TD]();else if(fr[v8]()>0){var Er=fr.getItems();Pi(lr||0,Be),En?qn=En.call(Xt,Er,Be):qn=Xt[uV](Er,Be)}Mr()}catch(vi){var Qr=VOt();(!Qr||Qr>9)&&ui(Xt[pf](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+gs(vi),{exception:Bi(vi)})}return qn},Xt.getOfflineSupport=function(){return{getUrl:function(){return X},createPayload:Sn,serialize:mn,batch:Kn,shouldProcess:function(Be){return!!Ue(Be)}}},Xt._doTeardown=function(Be,En){Xt.onunloadFlush(),cD(Z,!1),Ti()},Xt[z9]=function(Be,En,lr){if(!Mn(Be))return Ge(Be,En)},Xt[b3t]=function(Be,En){if(!Mn(Be))return te(Be,En)},Xt[Kot]=function(Be,En){if(!Mn(Be))return Me(Be)},Xt._xdrOnLoad=function(Be,En){if(!Mn(En))return ie(Be,En)};function ie(Be,En){var lr=nDt(Be);if(Be&&(lr+""=="200"||lr===""))N=0,Xt[Kot](En,0);else{var qn=n3t(lr);qn&&qn[w3t]&&qn[w3t]>qn[x3t]&&!wt?Xt[b3t](En,qn):Xt[z9](En,BOt(Be))}}function m(){try{var Be={xdrOnComplete:function(lr,qn,fr){var Er=Ye(fr);if(Er)return ie(lr,Er)},fetchOnComplete:function(lr,qn,fr,Er){var Qr=Ye(Er);if(Qr)return Ae(lr.status,Qr,lr.url,Qr[Co],lr.statusText,fr||"")},xhrOnComplete:function(lr,qn,fr){var Er=Ye(fr);if(Er)return ye(lr,Er,Er[Co])},beaconOnRetry:function(lr,qn,fr){return wn(lr,qn,fr)}},En={enableSendPromise:It,isOneDs:!1,disableCredentials:!1,disableXhr:vt,disableBeacon:!st,disableBeaconSync:!tt,senderOnCompleteCallBack:Be};return En}catch{}return null}function ye(Be,En,lr){Be.readyState===4&&Ae(Be.status,En,Be.responseURL,lr,fut(Be),nDt(Be)||Be.response)}function Ge(Be,En,lr){ui(Xt[pf](),2,26,"Failed to send telemetry.",{message:En}),Xt._buffer&&Xt._buffer[FV](Be)}function te(Be,En){for(var lr=[],qn=[],fr=En.errors.reverse(),Er=0,Qr=fr;Er<Qr.length;Er++){var vi=Qr[Er],ua=Be.splice(vi.index,1)[0];ai(vi.statusCode)?qn[ow](ua):lr[ow](ua)}Be[Co]>0&&Xt[Kot](Be,En[x3t]),lr[Co]>0&&Xt[z9](lr,fut(null,["partial success",En[x3t],"of",En.itemsReceived].join(" "))),qn[Co]>0&&(Zn(qn),ui(Xt[pf](),2,40,"Partial success. Delivered: "+Be[Co]+", Failed: "+lr[Co]+". Will retry to send "+qn[Co]+" our of "+En[w3t]+" items"))}function Me(Be,En){Xt._buffer&&Xt._buffer[FV](Be)}function Ye(Be){try{if(Be){var En=Be,lr=En.oriPayload;return lr&&lr[Co]?lr:null}}catch{}return null}function Ue(Be,En){if(ft)return!1;if(!Be)return En&&ui(En,1,7,"Cannot send empty telemetry"),!1;if(Be.baseData&&!Be[k3t])return En&&ui(En,1,70,"Cannot send telemetry without baseData and baseType"),!1;if(Be[k3t]||(Be[k3t]="EventData"),!Xt[uV])return En&&ui(En,1,28,"Sender was not initialized"),!1;if(Wn(Be))Be[bLt]=Xt._sample[Dut];else return En&&ui(En,2,33,"Telemetry item was sampled out and not sent",{SampleRate:Xt._sample[Dut]}),!1;return!0}function kn(Be,En){var lr=Be.iKey||gt,qn=v.constructEnvelope(Be,lr,En,xt);if(!qn){ui(En,1,47,"Unable to create an AppInsights envelope");return}var fr=!1;if(Be[wd]&&Be[wd][a3t]&&(Li(Be[wd][a3t],function(Er){try{Er&&Er(qn)===!1&&(fr=!0,f8(En,"Telemetry processor check returns false"))}catch(Qr){ui(En,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+gs(Qr),{exception:Bi(Qr)},!0)}}),delete Be[wd][a3t]),!fr)return qn}function mn(Be){var En=eDt,lr=Xt[pf]();try{var qn=Ue(Be,lr),fr=null;qn&&(fr=kn(Be,lr)),fr&&(En=O.serialize(fr))}catch{}return En}function Kn(Be){var En=eDt;return Be&&Be[Co]&&(En="["+Be.join(",")+"]"),En}function Sn(Be){var En=Kt();return{urlString:X,data:Be,headers:En}}function Wn(Be){return Xt._sample.isSampledIn(Be)}function Ze(Be,En,lr,qn){En===200&&Be?Xt._onSuccess(Be,Be[Co]):qn&&Xt[z9](Be,qn)}function de(Be,En,lr,qn){qn===void 0&&(qn=!0);var fr=function(vi,ua,br){return Ze(En,vi,ua,br)},Er=Re(En),Qr=Be&&Be.sendPOST;return Qr&&Er&&(qn&&Xt._buffer[Mut](En),ee.preparePayload(function(vi){return Qr(vi,fr,!lr)},Bt,Er,!lr)),null}function Re(Be){if(to(Be)&&Be[Co]>0){var En=Xt[Hy].batchPayloads(Be),lr=Kt(),qn={data:En,urlString:X,headers:lr,disableXhrSync:vt,disableFetchKeepAlive:!Ft,oriPayload:Be};return qn}return null}function Kt(){try{var Be=B||{};return Ixt(X)&&(Be[su[6]]=su[7]),Be}catch{}return null}function Jt(Be){var En=Be?Be[Co]:0;return Xt[Hy].size()+En>q?((!Z||Z.isOnline())&&Xt[sV](!0,null,10),!0):!1}function Ae(Be,En,lr,qn,fr,Er){var Qr=null;if(Xt._appId||(Qr=n3t(Er),Qr&&Qr.appId&&(Xt._appId=Qr.appId)),(Be<200||Be>=300)&&Be!==0){if((Be===301||Be===307||Be===308)&&!$e(lr)){Xt[z9](En,fr);return}if(Z&&!Z.isOnline()){if(!wt){var vi=10;Zn(En,vi),ui(Xt[pf](),2,40,". Offline - Response Code: ".concat(Be,". Offline status: ").concat(!Z.isOnline(),". Will retry to send ").concat(En.length," items."))}return}!wt&&ai(Be)?(Zn(En),ui(Xt[pf](),2,40,". Response code "+Be+". Will retry to send "+En[Co]+" items.")):Xt[z9](En,fr)}else $e(lr),Be===206?(Qr||(Qr=n3t(Er)),Qr&&!wt?Xt[b3t](En,Qr):Xt[z9](En,fr)):(N=0,Xt[Kot](En,qn))}function $e(Be){return S>=10?!1:!Fr(Be)&&Be!==""&&Be!==X?(X=Be,++S,!0):!1}function tn(Be,En){if(K)K(Be,!1);else{var lr=ee&&ee[Xot]([3],!0);return de(lr,Be,En)}}function wn(Be,En,lr){var qn=Be,fr=qn&&qn.oriPayload;if(ge)Gt&&Gt(fr,!0),ui(Xt[pf](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender.");else{for(var Er=[],Qr=0;Qr<fr[Co];Qr++){var vi=fr[Qr],ua=[vi],br=Re(ua);lr(br,En)?Xt._onSuccess(ua,ua[Co]):Er[ow](vi)}Er[Co]>0&&(Gt&&Gt(Er,!0),ui(Xt[pf](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function Mn(Be){try{if(Be&&Be[Co])return Sa(Be[0])}catch{}return null}function Hn(Be,En){var lr=null;if(to(Be)){for(var qn=Be[Co],fr=0;fr<Be[Co];fr++)qn+=Be[fr].item[Co];var Er=ee.getSyncFetchPayload();Er+qn<=xoe?lr=2:bV()?lr=3:(lr=1,ui(Xt[pf](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."));var Qr=ee&&ee[Xot]([lr],!0);return de(Qr,Be,En)}return null}function Zn(Be,En){if(En===void 0&&(En=1),!(!Be||Be[Co]===0)){var lr=Xt[Hy];lr[FV](Be),N++;for(var qn=0,fr=Be;qn<fr.length;qn++){var Er=fr[qn];Er.cnt=Er.cnt||0,Er.cnt++,lr[y8](Er)}_r(En),Sr()}}function _r(Be){var En=10,lr;if(N<=1)lr=En;else{var qn=(Math.pow(2,N)-1)/2,fr=rm(Math.random()*qn*En)+1;fr=Be*fr,lr=NV(sOt(fr,3600),En)}var Er=i2()+lr*1e3;F=Er}function Sr(){if(!L&&!W){var Be=F?NV(0,F-i2()):0,En=NV(_t,Be);L=xg(function(){L=null,Xt[sV](!0,null,1)},En)}}function Mr(){L&&L.cancel(),L=null,F=null}function ai(Be){return Fr(Ee)?Be===401||Be===408||Be===429||Be===500||Be===502||Be===503||Be===504:Ee[Co]&&Ee.indexOf(Be)>-1}function ea(){var Be="getNotifyMgr",En,lr=Xt.core;return lr&&(lr[Be]?En=lr[Be]():En=lr._notificationManager),En}function Pi(Be,En){var lr=ea();if(lr&&lr.eventsSendRequest)try{lr.eventsSendRequest(Be,En)}catch(qn){ui(Xt[pf](),1,74,"send request notification failed: "+gs(qn),{exception:Bi(qn)})}}function Cr(Be,En){var lr=En.disableInstrumentationKeyValidation,qn=Fr(lr)?!1:lr;if(qn)return!0;var fr="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",Er=new RegExp(fr);return Er.test(Be)}function Ti(){Xt[uV]=null,Xt[Hy]=null,Xt._appId=null,Xt._sample=null,B={},Z=null,N=0,F=null,W=!1,L=null,O=null,S=0,j=0,K=null,Y=null,X=null,J=null,q=0,H=!1,lt=null,ft=!1,gt=null,xt=q1,wt=!1,bt=null,qt=q1,vt=!1,Ft=!1,ge=!1,Qt=null,Gt=null,ee=null,Ro(Xt,"_senderConfig",{g:function(){return POt({},rDt)}})}}),k}return v.constructEnvelope=function(k,N,F,W){var L;N!==k.iKey&&!Fr(N)?L=Jf(Jf({},k),{iKey:N}):L=k;var O=_oe[L.baseType]||i$t;return O(F,L,W)},v}(YD),aDt="duration",BD="properties",Q1="requestUrl",a8="length",Qk="traceID",Jk="spanID",J1="traceFlags",OV="context",AD="aborted",Zot="_addHook",Yy="core",_3t="includeCorrelationHeaders",Gxt="getAbsoluteUrl",P9="headers",pg="requestHeaders",C3t="setRequestHeader",oDt="trackDependencyDataInternal",dD="startTime",UM="toLowerCase",Hxt="enableRequestHeaderTracking",s$t="enableAjaxErrorStatusText",u$t="enableAjaxPerfTracking",l$t="maxAjaxCallsPerView",c$t="excludeRequestFromAutoTrackingPatterns",Yxt="disableAjaxTracking",h$t="ajaxPerfLookupDelay",d$t="disableFetchTracking",f$t="enableResponseHeaderTracking",K1="status",q9="statusText",Rut="headerMap",o8="requestSentTime",qxt="getTraceId",Xxt="getTraceFlags",qk="method",Kxt="errorStatusText",p$t="stateChangeAttached",sDt="responseText",EV="responseFinishedTime",Zxt="CreateTrackItem",uDt="getAllResponseHeaders",Qxt="getPartAProps",Fut="perfMark",Jxt="perfTiming",t4t="ajaxDiagnosticsMessage",e4t="correlationContext",E3t="ajaxTotalDuration",T3t="eventTraceCtx";function m$t(p,v,k){var N=0,F=p[v],W=p[k];return F&&W&&(N=Qp(F,W)),N}function B9(p,v,k,N,F){var W=0,L=m$t(k,N,F);return L&&(W=jk(p,v,Yk(L))),W}function jk(p,v,k){var N="ajaxPerf",F=0;if(p&&v&&k){var W=p[N]=p[N]||{};W[v]=k,F=1}return F}function Eoe(p,v){var k=p[Jxt],N=v[BD]||{},F=0,W="name",L="Start",O="End",S="domainLookup",B="connect",j="redirect",K="request",Z="response",Y="startTime",X=S+L,J=S+O,q=B+L,H=B+O,tt=K+L,st=K+O,lt=Z+L,ft=Z+O,gt=j+L,xt=j=O,wt="transferSize",_t="encodedBodySize",bt="decodedBodySize",Tt="serverTiming";if(k){F|=B9(N,j,k,gt,xt),F|=B9(N,S,k,X,J),F|=B9(N,B,k,q,H),F|=B9(N,K,k,tt,st),F|=B9(N,Z,k,lt,ft),F|=B9(N,"networkConnect",k,Y,H),F|=B9(N,"sentRequest",k,tt,ft);var qt=k[aDt];qt||(qt=m$t(k,Y,ft)||0),F|=jk(N,aDt,qt),F|=jk(N,"perfTotal",qt);var It=k[Tt];if(It){var St={};Li(It,function(vt,Ft){var Qt=cut(vt[W]||""+Ft),Gt=St[Qt]||{};Eo(vt,function(ge,ee){(ge!==W&&Sa(ee)||gG(ee))&&(Gt[ge]&&(ee=Gt[ge]+";"+ee),(ee||!Sa(ee))&&(Gt[ge]=ee))}),St[Qt]=Gt}),F|=jk(N,Tt,St)}F|=jk(N,wt,k[wt]),F|=jk(N,_t,k[_t]),F|=jk(N,bt,k[bt])}else p[Fut]&&(F|=jk(N,"missing",p.perfAttempts));F&&(v[BD]=N)}var Toe=function(){function p(){var v=this;v.openDone=!1,v.setRequestHeaderDone=!1,v.sendDone=!1,v.abortDone=!1,v[p$t]=!1}return p}(),lDt=function(){function p(v,k,N,F){var W=this,L=N,O="responseText";W[Fut]=null,W.completed=!1,W.requestHeadersSize=null,W[pg]=null,W.responseReceivingDuration=null,W.callbackDuration=null,W[E3t]=null,W[AD]=0,W.pageUrl=null,W[Q1]=null,W.requestSize=0,W[qk]=null,W[K1]=null,W[o8]=null,W.responseStartedTime=null,W[EV]=null,W.callbackFinishedTime=null,W.endTime=null,W.xhrMonitoringState=new Toe,W.clientFailure=0,W[Qk]=v,W[Jk]=k,W[J1]=F?.getTraceFlags(),F?W[T3t]={traceId:F[qxt](),spanId:F.getSpanId(),traceFlags:F[Xxt]()}:W[T3t]=null,Mu(p,W,function(S){S.getAbsoluteUrl=function(){return S[Q1]?Xie(S[Q1]):null},S.getPathName=function(){return S[Q1]?llt(L,Kie(S[qk],S[Q1])):null},S[Zxt]=function(B,j,K){var Z;if(S.ajaxTotalDuration=xOt(Qp(S.requestSentTime,S.responseFinishedTime)*1e3)/1e3,S[E3t]<0)return null;var Y=(Z={id:"|"+S[Qk]+"."+S[Jk],target:S[Gxt](),name:S.getPathName(),type:B,startTime:null,duration:S[E3t],success:+S[K1]>=200&&+S[K1]<400,responseCode:+S[K1]},Z[BD]={HttpMethod:S[qk]},Z),X=Y[BD];if(S[AD]&&(X[AD]=!0),S[o8]&&(Y[dD]=new Date,Y[dD].setTime(S[o8])),Eoe(S,Y),j&&ew(S.requestHeaders)[a8]>0&&(X[pg]=S[pg]),K){var J=K();if(J){var q=J[e4t];if(q&&(Y.correlationContext=q),J[Rut]&&ew(J.headerMap)[a8]>0&&(X.responseHeaders=J[Rut]),S[Kxt])if(S[K1]>=400){var H=J.type;(H===""||H==="text")&&(X.responseText=J.responseText?J[q9]+" - "+J[O]:J[q9]),H==="json"&&(X.responseText=J.response?J[q9]+" - "+JSON.stringify(J.response):J[q9])}else S[K1]===0&&(X.responseText=J[q9]||"")}}return Y},S[Qxt]=function(){var B=null,j=S[T3t];if(j&&(j.traceId||j.spanId)){B={};var K=B[tm.TraceExt]={traceID:j.traceId,parentID:j.spanId};Fr(j[J1])||(K[J1]=j[J1])}return B}})}return p.__ieDyn=1,p}(),jl,LV="diagLog",u5="_ajaxData",X9="fetch",cV="Failed to monitor XMLHttpRequest",g$t=", monitoring data for this ajax call ",WM=g$t+"may be incorrect.",cDt=g$t+"won't be sent.",hDt="Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",dDt="Failed to add custom defined request context as configured call back may missing a null check.",fDt="Failed to calculate the duration of the ",pDt=0;function Aoe(){var p=bg();return!p||Fr(p.Request)||Fr(p.Request[sv])||Fr(p[X9])?null:p[X9]}function Ioe(p,v){var k,N=!1;if(alt()){var F=XMLHttpRequest[sv];N=!Fr(F)&&!Fr(F.open)&&!Fr(F.send)&&!Fr(F.abort)}var W=VOt();if(W&&W<9&&(N=!1),N)try{var L=new XMLHttpRequest,O={xh:[],i:(k={},k[v]={},k)};L[u5]=O;var S=XMLHttpRequest[sv].open;XMLHttpRequest[sv].open=S}catch(B){N=!1,$V(p,15,"Failed to enable XMLHttpRequest monitoring, extension is not supported",{exception:Bi(B)})}return N}var iD=function(p,v){return p&&v&&p[u5]?(p[u5].i||{})[v]:null},Noe=function(p,v,k){if(p){var N=(p[u5]||{}).xh;N&&N.push({n:v,v:k})}},A3t=function(p,v){var k=!1;if(p){var N=(p[u5]||{}).xh;N&&Li(N,function(F){if(F.n===v)return k=!0,-1})}return k};function Lst(p,v){var k="";try{var N=iD(p,v);N&&N[Q1]&&(k+="(url: '"+N[Q1]+"')")}catch{}return k}function $V(p,v,k,N,F){ui(p[LV](),1,v,k,N,F)}function G3(p,v,k,N,F){ui(p[LV](),2,v,k,N,F)}function hV(p,v,k){return function(N){var F;$V(p,v,k,(F={},F[t4t]=Lst(N.inst,p._ajaxDataId),F.exception=Bi(N.err),F))}}function VM(p,v){return p&&v?Qf(p,v):-1}function mDt(p,v,k){var N={id:v,fn:k};return p.push(N),{remove:function(){Li(p,function(F,W){if(F.id===N.id)return p.splice(W,1),-1})}}}function y$t(p,v,k,N){var F=!0;return Li(v,function(W,L){try{W.fn.call(null,k)===!1&&(F=!1)}catch(O){ui(p&&p.logger,1,64,"Dependency "+N+" [#"+L+"] failed: "+gs(O),{exception:Bi(O)},!0)}}),F}function Moe(p,v,k,N,F,W){var L=p[a8],O=!0;if(L>0){var S={core:v,xhr:N,input:F,init:W,traceId:k[Qk],spanId:k[Jk],traceFlags:k[J1],context:k[OV]||{},aborted:!!k[AD]};O=y$t(v,p,S,"listener"),k[Qk]=S.traceId,k[Jk]=S.spanId,k[J1]=S[J1],k[OV]=S[OV]}return O}var Qot="*.blob.core.",Doe=r2([Qot+"windows.net",Qot+"chinacloudapi.cn",Qot+"cloudapi.de",Qot+"usgovcloudapi.net"]),Roe=[/https:\/\/[^\/]*(\.pipe\.aria|aria\.pipe|events\.data|collector\.azure)\.[^\/]+\/(OneCollector\/1|Collector\/3)\.0/i],Foe=r2((jl={},jl[l$t]=500,jl[Yxt]=!1,jl[d$t]=!1,jl[c$t]=void 0,jl.disableCorrelationHeaders=!1,jl.distributedTracingMode=1,jl.correlationHeaderExcludedDomains=Doe,jl.correlationHeaderDomains=void 0,jl.correlationHeaderExcludePatterns=void 0,jl.appId=void 0,jl.enableCorsCorrelation=!1,jl[Hxt]=!1,jl[f$t]=!1,jl[s$t]=!1,jl[u$t]=!1,jl.maxAjaxPerfLookupAttempts=3,jl[h$t]=25,jl.ignoreHeaders=["Authorization","X-API-Key","WWW-Authenticate"],jl.addRequestContext=void 0,jl.addIntEndpoints=!0,jl)),Ooe=function(p){mw(v,p);function v(){var k=p.call(this)||this;k.identifier=v.identifier,k.priority=120;var N,F,W,L,O,S,B,j,K,Z,Y,X,J,q,H,tt,st,lt,ft,gt,xt,wt,_t,bt,Tt,qt,It,St,vt,Ft;return Mu(v,k,function(Qt,Gt){var ge=Gt[Zot];ee(),Qt.initialize=function(Jt,Ae,$e,tn){Qt.isInitialized()||(Gt.initialize(Jt,Ae,$e,tn),gt=T5(kg("ajax"),Ae&&Ae.evtNamespace&&Ae.evtNamespace()),Ee(Jt),m(),we(),Bt())},Qt._doTeardown=function(){ee()},Qt.trackDependencyData=function(Jt,Ae){Kt(bt,Qt[Yy],null,Jt,Ae)},Qt[_3t]=function(Jt,Ae,$e,tn){var wn=Qt._currentWindowHost||W;if(Moe(_t,Qt[Yy],Jt,tn,Ae,$e)){if(Ae||Ae===""){if(PMt(L,Jt[Gxt](),wn)){$e||($e={});var Mn=new Headers($e[P9]||(Ae instanceof Request?Ae[P9]||{}:{}));if(Z){var Hn="|"+Jt[Qk]+"."+Jt[Jk];Mn.set(su[3],Hn),O&&(Jt[pg][su[3]]=Hn)}var Zn=vt||j&&j.appId();if(Zn&&(Mn.set(su[0],su[2]+Zn),O&&(Jt[pg][su[0]]=su[2]+Zn)),K){var _r=Jt[J1];Fr(_r)&&(_r=1);var Sr=vMt(yMt(Jt[Qk],Jt[Jk],_r));Mn.set(su[4],Sr),O&&(Jt[pg][su[4]]=Sr)}$e[P9]=Mn}return $e}else if(tn){if(PMt(L,Jt[Gxt](),wn)){if(Z)if(A3t(tn,su[3]))G3(Qt,71,"Unable to set ["+su[3]+"] as it has already been set by another instance");else{var Hn="|"+Jt[Qk]+"."+Jt[Jk];tn[C3t](su[3],Hn),O&&(Jt[pg][su[3]]=Hn)}var Zn=vt||j&&j.appId();if(Zn&&(A3t(tn,su[0])?G3(Qt,71,"Unable to set ["+su[0]+"] as it has already been set by another instance"):(tn[C3t](su[0],su[2]+Zn),O&&(Jt[pg][su[0]]=su[2]+Zn))),K){var _r=Jt[J1];if(Fr(_r)&&(_r=1),A3t(tn,su[4]))G3(Qt,71,"Unable to set ["+su[4]+"] as it has already been set by another instance");else{var Sr=vMt(yMt(Jt[Qk],Jt[Jk],_r));tn[C3t](su[4],Sr),O&&(Jt[pg][su[4]]=Sr)}}}return tn}}},Qt[oDt]=function(Jt,Ae,$e){if(J===-1||B<J){(St===2||St===1)&&typeof Jt.id=="string"&&Jt.id[Jt.id[a8]-1]!=="."&&(Jt.id+="."),Fr(Jt[dD])&&(Jt[dD]=new Date);var tn=Bk(Jt,g8.dataType,g8.envelopeType,Qt[LV](),Ae,$e);Qt[Yy].track(tn)}else B===J&&$V(Qt,55,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++B},Qt.addDependencyListener=function(Jt){return mDt(_t,wt++,Jt)},Qt.addDependencyInitializer=function(Jt){return mDt(bt,wt++,Jt)};function ee(){var Jt=iv();N=!1,F=!1,Ft=!1,W=Jt&&Jt.host&&Jt.host[UM](),L=null,O=!1,S=!1,B=0,j=null,K=!1,Z=!1,Y=null,X=!1,J=0,q=!1,H={},tt=!1,st=!1,lt=null,ft=null,gt=null,wt=0,_t=[],bt=[],xt=kg("ajaxData"),Qt._ajaxDataId=xt,Tt=null,qt=1,It=1,St=1,vt=null}function Ee(Jt){Qt[Zot](ac(Jt,function(Ae){var $e=Ae.cfg,tn=o2(null,$e,Qt[Yy]);L=tn.getExtCfg(v.identifier,Foe),St=L.distributedTracingMode,O=L[Hxt],S=L[s$t],X=L[u$t],J=L[l$t],lt=[].concat(L[c$t]||[],L.addIntEndpoints!==!1?Roe:[]),ft=L.addRequestContext,Z=St===0||St===1,K=St===1||St===2,X&&(Y=xt),tt=!!L[Yxt],qt=L.maxAjaxPerfLookupAttempts,It=L[h$t],Tt=L.ignoreHeaders,vt=L.appId}))}function Bt(){var Jt=Qt[Yy].getPlugin(dlt);Jt&&(j=Jt.plugin[OV])}function Xt(Jt){var Ae=!0;return(Jt||Tt)&&Li(Tt,function($e){if($e[UM]()===Jt[UM]())return Ae=!1,-1}),Ae}function we(){var Jt=Aoe();if(Jt){var Ae=bg(),$e=Jt.polyfill;Qt[Zot](ac(L,function(){st=!!L[d$t],q=L[f$t],!st&&!N?(ge(Axt(Ae,X9,{ns:gt,req:function(tn,wn,Mn){var Hn;if(!st&&N&&!ye(null,wn,Mn)&&!($e&&F)){var Zn=tn.ctx();Hn=Wn(wn,Mn);var _r=Qt[_3t](Hn,wn,Mn);_r!==Mn&&tn.set(1,_r),Zn.data=Hn}},rsp:function(tn,wn){if(!st){var Mn=tn.ctx().data;Mn&&(tn.rslt=tn.rslt.then(function(Hn){return de(tn,(Hn||{})[K1],wn,Hn,Mn,function(){var Zn,_r=(Zn={statusText:(Hn||{})[q9],headerMap:null},Zn[e4t]=Re(Hn),Zn);if(q&&Hn){var Sr={};Hn.headers.forEach(function(Mr,ai){Xt(ai)&&(Sr[ai]=Mr)}),_r[Rut]=Sr}return _r}),Hn}).catch(function(Hn){throw de(tn,0,wn,null,Mn,null),Hn}))}},hkErr:hV(Qt,15,"Failed to monitor Window.fetch"+WM)},!0,dOt())),N=!0):$e&&!Ft&&(ge(Axt(Ae,X9,{ns:gt,req:function(tn,wn,Mn){ye(null,wn,Mn)}})),Ft=!0)})),$e&&(Ae[X9].polyfill=$e)}}function ie(Jt,Ae,$e){ge(Wie(Jt,Ae,$e))}function m(){Ioe(Qt,xt)&&Qt[Zot](ac(L,function(){tt=!!L[Yxt],O=L[Hxt],!tt&&!F&&(ie(XMLHttpRequest,"open",{ns:gt,req:function(Jt,Ae,$e,tn){if(!tt){var wn=Jt.inst,Mn=iD(wn,xt);!ye(wn,$e)&&Ge(wn,Mn,!0)&&((!Mn||!Mn.xhrMonitoringState.openDone)&&(Mn=Me(wn,Ae,$e,tn)),Ye(wn,Mn))}},hkErr:hV(Qt,15,cV+".open"+WM)}),ie(XMLHttpRequest,"send",{ns:gt,req:function(Jt,Ae){if(!tt){var $e=Jt.inst,tn=iD($e,xt);Ge($e,tn)&&!tn.xhrMonitoringState.sendDone&&(Kn("xhr",tn),tn[o8]=Hot(),Qt[_3t](tn,void 0,void 0,$e),tn.xhrMonitoringState.sendDone=!0)}},hkErr:hV(Qt,17,cV+WM)}),ie(XMLHttpRequest,"abort",{ns:gt,req:function(Jt){if(!tt){var Ae=Jt.inst,$e=iD(Ae,xt);Ge(Ae,$e)&&!$e.xhrMonitoringState.abortDone&&($e[AD]=1,$e.xhrMonitoringState.abortDone=!0)}},hkErr:hV(Qt,13,cV+".abort"+WM)}),ie(XMLHttpRequest,"setRequestHeader",{ns:gt,req:function(Jt,Ae,$e){if(!tt){var tn=Jt.inst,wn=iD(tn,xt);wn&&Ge(tn,wn)&&(Noe(tn,Ae,$e),O&&Xt(Ae)&&(wn[pg][Ae]=$e))}},hkErr:hV(Qt,71,cV+".setRequestHeader"+WM)}),F=!0)}))}function ye(Jt,Ae,$e){var tn=!1,wn=((Sa(Ae)?Ae:(Ae||{}).url||"")||"")[UM]();if(Li(lt,function(Zn){var _r=Zn;Sa(Zn)&&(_r=new RegExp(Zn)),tn||(tn=_r.test(wn))}),tn)return tn;var Mn=VM(wn,"?"),Hn=VM(wn,"#");return(Mn===-1||Hn!==-1&&Hn<Mn)&&(Mn=Hn),Mn!==-1&&(wn=wn.substring(0,Mn)),Fr(Jt)?Fr(Ae)||(tn=(typeof Ae=="object"?Ae[i8]===!0:!1)||($e?$e[i8]===!0:!1)):tn=Jt[i8]===!0||wn[i8]===!0,!tn&&wn&&Ixt(wn)&&(tn=!0),tn?H[wn]||(H[wn]=1):H[wn]&&(tn=!0),tn}function Ge(Jt,Ae,$e){var tn=!0,wn=F;return Fr(Jt)||(tn=$e===!0||!Fr(Ae)),wn&&tn}function te(){var Jt=null;return Qt[Yy]&&Qt[Yy].getTraceCtx&&(Jt=Qt[Yy].getTraceCtx(!1)),!Jt&&j&&j.telemetryTrace&&(Jt=rkt(j.telemetryTrace)),Jt}function Me(Jt,Ae,$e,tn){var wn,Mn=te(),Hn=Mn&&Mn[qxt]()||Zk(),Zn=Vk(Zk(),0,16),_r=Jt[u5]=Jt[u5]||{xh:[],i:{}},Sr=_r.i=_r.i||{},Mr=Sr[xt]=Sr[xt]||new lDt(Hn,Zn,Qt[LV](),(wn=Qt.core)===null||wn===void 0?void 0:wn.getTraceCtx());return Mr[J1]=Mn&&Mn[Xxt](),Mr[qk]=Ae,Mr[Q1]=$e,Mr.xhrMonitoringState.openDone=!0,Mr[pg]={},Mr.async=tn,Mr[Kxt]=S,Mr}function Ye(Jt,Ae){Ae.xhrMonitoringState[p$t]=rw(Jt,"readystatechange",function(){var $e;try{Jt&&Jt.readyState===4&&Ge(Jt,Ae)&&kn(Jt)}catch(wn){var tn=Bi(wn);(!tn||VM(tn[UM](),"c00c023f")===-1)&&$V(Qt,16,cV+" 'readystatechange' event handler"+WM,($e={},$e[t4t]=Lst(Jt,xt),$e.exception=tn,$e))}},gt)}function Ue(Jt){try{var Ae=Jt.responseType;if(Ae===""||Ae==="text")return Jt[sDt]}catch{}return null}function kn(Jt){var Ae=iD(Jt,xt);Ae[EV]=Hot(),Ae[K1]=Jt[K1];function $e(tn,wn){var Mn=wn||{};Mn.ajaxDiagnosticsMessage=Lst(Jt,xt),tn&&(Mn.exception=Bi(tn)),G3(Qt,14,fDt+"ajax call"+cDt,Mn)}Sn("xmlhttprequest",Ae,function(){try{var tn=Ae[Zxt]("Ajax",O,function(){var _r,Sr=(_r={statusText:Jt[q9],headerMap:null},_r[e4t]=mn(Jt),_r.type=Jt.responseType,_r[sDt]=Ue(Jt),_r.response=Jt.response,_r);if(q){var Mr=Jt[uDt]();if(Mr){var ai=Nu(Mr).split(/[\r\n]+/),ea={};Li(ai,function(Pi){var Cr=Pi.split(": "),Ti=Cr.shift(),Be=Cr.join(": ");Xt(Ti)&&(ea[Ti]=Be)}),Sr[Rut]=ea}}return Sr}),wn=void 0;try{ft&&(wn=ft({status:Jt[K1],xhr:Jt}))}catch{G3(Qt,104,dDt)}if(tn){wn!==void 0&&(tn[BD]=Jf(Jf({},tn.properties),wn));var Mn=Ae[Qxt]();Kt(bt,Qt[Yy],Ae,tn,null,Mn)}else $e(null,{requestSentTime:Ae[o8],responseFinishedTime:Ae[EV]})}finally{try{var Hn=Jt[u5]||{i:{}},Zn=Hn.i||{};Zn[xt]&&(Zn[xt]=null)}catch{}}},function(tn){$e(tn,null)})}function mn(Jt){var Ae;try{var $e=Jt[uDt]();if($e!==null){var tn=VM($e[UM](),su[8]);if(tn!==-1){var wn=Jt.getResponseHeader(su[0]);return BMt(wn)}}}catch(Mn){G3(Qt,18,hDt,(Ae={},Ae[t4t]=Lst(Jt,xt),Ae.exception=Bi(Mn),Ae))}}function Kn(Jt,Ae){if(Ae[Q1]&&Y&&X){var $e=dw();if($e&&Ia($e.mark)){pDt++;var tn=Y+Jt+"#"+pDt;$e.mark(tn);var wn=$e.getEntriesByName(tn);wn&&wn[a8]===1&&(Ae[Fut]=wn[0])}}}function Sn(Jt,Ae,$e,tn){var wn=Ae[Fut],Mn=dw(),Hn=qt,Zn=It,_r=Ae[Q1],Sr=0;(function Mr(){try{if(Mn&&wn){Sr++;for(var ai=null,ea=Mn.getEntries(),Pi=ea[a8]-1;Pi>=0;Pi--){var Cr=ea[Pi];if(Cr){if(Cr.entryType==="resource")Cr.initiatorType===Jt&&(VM(Cr.name,_r)!==-1||VM(_r,Cr.name)!==-1)&&(ai=Cr);else if(Cr.entryType==="mark"&&Cr.name===wn.name){Ae[Jxt]=ai;break}if(Cr[dD]<wn[dD]-1e3)break}}}!wn||Ae[Jxt]||Sr>=Hn||Ae.async===!1?(wn&&Ia(Mn.clearMarks)&&Mn.clearMarks(wn.name),Ae.perfAttempts=Sr,$e()):xg(Mr,Zn)}catch(Ti){tn(Ti)}})()}function Wn(Jt,Ae){var $e,tn=te(),wn=tn&&tn[qxt]()||Zk(),Mn=Vk(Zk(),0,16),Hn=new lDt(wn,Mn,Qt[LV](),($e=Qt.core)===null||$e===void 0?void 0:$e.getTraceCtx());Hn[J1]=tn&&tn[Xxt](),Hn[o8]=Hot(),Hn[Kxt]=S;var Zn;if(Jt instanceof Request?Zn=(Jt||{}).url||"":Zn=Jt,Zn===""){var _r=iv();_r&&_r.href&&(Zn=bOt(_r.href,"#")[0])}Hn[Q1]=Zn;var Sr="GET";Ae&&Ae[qk]?Sr=Ae[qk]:Jt&&Jt instanceof Request&&(Sr=Jt[qk]),Hn[qk]=Sr;var Mr={};if(O){var ai=new Headers((Ae?Ae[P9]:0)||(Jt instanceof Request?Jt[P9]||{}:{}));ai.forEach(function(ea,Pi){Xt(Pi)&&(Mr[Pi]=ea)})}return Hn[pg]=Mr,Kn(X9,Hn),Hn}function Ze(Jt){var Ae="";try{Fr(Jt)||(typeof Jt=="string"?Ae+="(url: '".concat(Jt,"')"):Ae+="(url: '".concat(Jt.url,"')"))}catch($e){$V(Qt,15,"Failed to grab failed fetch diagnostics message",{exception:Bi($e)})}return Ae}function de(Jt,Ae,$e,tn,wn,Mn,Hn){if(!wn)return;function Zn(_r,Sr,Mr){var ai=Mr||{};ai.fetchDiagnosticsMessage=Ze($e),Sr&&(ai.exception=Bi(Sr)),G3(Qt,_r,fDt+"fetch call"+cDt,ai)}wn[EV]=Hot(),wn[K1]=Ae,Sn(X9,wn,function(){var _r=wn[Zxt]("Fetch",O,Mn),Sr;try{ft&&(Sr=ft({status:Ae,request:$e,response:tn}))}catch{G3(Qt,104,dDt)}if(_r){Sr!==void 0&&(_r[BD]=Jf(Jf({},_r.properties),Sr));var Mr=wn[Qxt]();Kt(bt,Qt[Yy],wn,_r,null,Mr)}else Zn(14,null,{requestSentTime:wn[o8],responseFinishedTime:wn[EV]})},function(_r){Zn(18,_r,null)})}function Re(Jt){if(Jt&&Jt[P9])try{var Ae=Jt[P9].get(su[0]);return BMt(Ae)}catch($e){G3(Qt,18,hDt,{fetchDiagnosticsMessage:Ze(Jt),exception:Bi($e)})}}function Kt(Jt,Ae,$e,tn,wn,Mn){var Hn=!0,Zn=Jt[a8];if(Zn>0){var _r={item:tn,properties:wn,sysProperties:Mn,context:$e?$e[OV]:null,aborted:$e?!!$e[AD]:!1};Hn=y$t(Ae,Jt,_r,"initializer")}Hn&&Qt[oDt](tn,wn,Mn)}}),k}return v.prototype.processTelemetry=function(k,N){this.processNext(k,N)},v.prototype.addDependencyInitializer=function(k){return null},v.identifier="AjaxDependencyPlugin",v}(YD),Loe=function(){function p(){}return p}(),$oe=function(){function p(){this.id="browser",this.deviceClass="Browser"}return p}(),zoe="3.3.9",Poe=function(){function p(v,k){var N=this,F=ac(v,function(){var W=v.sdkExtension;N.sdkVersion=(W?W+"_":"")+"javascript:"+zoe});k&&k.add(F)}return p}(),Boe=function(){function p(){}return p}(),Out="session",Lut="sessionManager",$st="isUserCookieSet",$ut="isNewUser",I3t="getTraceCtx",n4t="telemetryTrace",v$t="applySessionContext",b$t="applyApplicationContext",w$t="applyOperationContext",x$t="applyOperatingSystemContxt",k$t="applyLocationContext",S$t="applyInternalContext",zst="getSessionId",_$t="sessionCookiePostfix",G9="automaticSession",aD="accountId",oD="authenticatedId",dV="acquisitionDate",Jot="renewalDate",fV="cookieSeparator",N3t="authUserCookieName",joe="ai_session",Uoe=864e5,Woe=18e5,Voe=6e4,C$t=function(){function p(){}return p}(),Goe=function(){function p(v,k,N){var F=this,W,L,O=R8(k),S=H4t(k),B,j;Mu(p,F,function(K){v||(v={});var Z=ac(v,function(tt){B=v.sessionExpirationMs||Uoe,j=v.sessionRenewalMs||Woe;var st=v[_$t]||v.namePrefix||"";W=joe+st});N&&N.add(Z),K[G9]=new C$t,K.update=function(){var tt=i2(),st=!1,lt=K[G9];if(lt.id||(st=!Y(lt)),!st&&B>0){var ft=tt-lt[dV],gt=tt-lt[Jot];st=ft<0||gt<0,st=st||ft>B,st=st||gt>j}st?J(tt):(!L||tt-L>Voe)&&q(lt,tt)},K.backup=function(){var tt=K[G9];H(tt.id,tt[dV],tt[Jot])};function Y(tt,st){var lt=!1,ft=S.get(W);if(ft&&Ia(ft.split))lt=X(tt,ft);else{var gt=CLt(O,W);gt&&(lt=X(tt,gt))}return lt||!!tt.id}function X(tt,st){var lt=!1,ft=", session will be reset",gt=st.split("|");if(gt.length>=2)try{var xt=+gt[1]||0,wt=+gt[2]||0;isNaN(xt)||xt<=0?ui(O,2,27,"AI session acquisition date is 0"+ft):isNaN(wt)||wt<=0?ui(O,2,27,"AI session renewal date is 0"+ft):gt[0]&&(tt.id=gt[0],tt[dV]=xt,tt[Jot]=wt,lt=!0)}catch(_t){ui(O,1,9,"Error parsing ai_session value ["+(st||"")+"]"+ft+" - "+gs(_t),{exception:Bi(_t)})}return lt}function J(tt){var st=v.getNewId||j4t;K[G9].id=st(v.idLength||22),K[G9][dV]=tt,q(K[G9],tt),hlt()||ui(O,2,0,"Browser does not support local storage. Session durations will be inaccurate.")}function q(tt,st){var lt=tt[dV];tt[Jot]=st;var ft=j,gt=lt+B-st,xt=[tt.id,lt,st],wt=0;gt<ft?wt=gt/1e3:wt=ft/1e3;var _t=v.cookieDomain||null;S.set(W,xt.join("|"),B>0?wt:null,_t),L=st}function H(tt,st,lt){ELt(O,W,[tt,st,lt].join("|"))}})}return p.__ieDyn=1,p}(),Hoe=function(){function p(v,k,N,F){var W=this;W.traceID=v||Zk(),W.parentID=k;var L=iv();!N&&L&&L.pathname&&(N=L.pathname),W.name=Dc(F,N)}return p}();function gDt(p){return!(typeof p!="string"||!p||p.match(/,|;|=| |\|/))}var Yoe=function(){function p(v,k,N){this.isNewUser=!1,this.isUserCookieSet=!1;var F=R8(k),W=H4t(k),L;Mu(p,this,function(O){Ro(O,"config",{g:function(){return v}});var S=ac(v,function(){var Z=v.userCookiePostfix||"";L=p.userCookieName+Z;var Y=W.get(L);if(Y){O[$ut]=!1;var X=Y.split(p[fV]);X.length>0&&(O.id=X[0],O[$st]=!!O.id)}if(!O.id){O.id=B();var J=j(O.id);K(J.join(p[fV]));var q=(v.namePrefix||"")+"ai_session";iae(F,q)}O[aD]=v[aD]||void 0;var H=W.get(p[N3t]);if(H){H=decodeURI(H);var tt=H.split(p[fV]);tt[0]&&(O[oD]=tt[0]),tt.length>1&&tt[1]&&(O[aD]=tt[1])}});N&&N.add(S);function B(){var Z=v||{},Y=Z.getNewId||j4t,X=Y(Z.idLength?v.idLength:22);return X}function j(Z){var Y=LD(new Date);O.accountAcquisitionDate=Y,O[$ut]=!0;var X=[Z,Y];return X}function K(Z){var Y=31536e3;O[$st]=W.set(L,Z,Y)}O.setAuthenticatedUserContext=function(Z,Y,X){X===void 0&&(X=!1);var J=!gDt(Z)||Y&&!gDt(Y);if(J){ui(F,2,60,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);return}O[oD]=Z;var q=O[oD];Y&&(O[aD]=Y,q=[O[oD],O.accountId].join(p[fV])),X&&W.set(p[N3t],encodeURI(q))},O.clearAuthenticatedUserContext=function(){O[oD]=null,O[aD]=null,W.del(p[N3t])},O.update=function(Z){if(O.id!==Z||!O[$st]){var Y=Z||B(),X=j(Y);K(X.join(p[fV]))}}})}return p.cookieSeparator="|",p.userCookieName="ai_user",p.authUserCookieName="ai_authUser",p}(),tst="ext",est="tags";function GM(p,v){p&&p[v]&&ew(p[v]).length===0&&delete p[v]}function yDt(){return null}var qoe=function(){function p(v,k,N,F){var W=this,L=v.logger;Mu(p,this,function(O){if(O.appId=yDt,O[zst]=yDt,O.application=new Loe,O.internal=new Poe(k,F),nlt()){O[Lut]=new Goe(k,v,F),O.device=new $oe,O.location=new Boe,O.user=new Yoe(k,v,F);var S=void 0,B=void 0,j;N&&(S=N.getTraceId(),B=N.getSpanId(),j=N.getName()),O[n4t]=new Hoe(S,B,j,L),O[Out]=new C$t}O[zst]=function(){var K=O[Out],Z=null;if(K&&Sa(K.id))Z=K.id;else{var Y=(O[Lut]||{})[G9];Z=Y&&Sa(Y.id)?Y.id:null}return Z},O[v$t]=function(K,Z){vu(Hf(K.ext,tm.AppExt),"sesId",O[zst](),Sa)},O[x$t]=function(K,Z){vu(K.ext,tm.OSExt,O.os)},O[b$t]=function(K,Z){var Y=O.application;if(Y){var X=Hf(K,est);vu(X,Au.applicationVersion,Y.ver,Sa),vu(X,Au.applicationBuild,Y.build,Sa)}},O.applyDeviceContext=function(K,Z){var Y=O.device;if(Y){var X=Hf(Hf(K,tst),tm.DeviceExt);vu(X,"localId",Y.id,Sa),vu(X,"ip",Y.ip,Sa),vu(X,"model",Y.model,Sa),vu(X,"deviceClass",Y.deviceClass,Sa)}},O[S$t]=function(K,Z){var Y=O.internal;if(Y){var X=Hf(K,est);vu(X,Au.internalAgentVersion,Y.agentVersion,Sa),vu(X,Au.internalSdkVersion,Dc(L,Y.sdkVersion,64),Sa),(K.baseType===KV.dataType||K.baseType===s5.dataType)&&(vu(X,Au.internalSnippet,Y.snippetVer,Sa),vu(X,Au.internalSdkSrc,Y.sdkSrc,Sa))}},O[k$t]=function(K,Z){var Y=W.location;Y&&vu(Hf(K,est,[]),Au.locationIp,Y.ip,Sa)},O[w$t]=function(K,Z){var Y=O[n4t];if(Y){var X=Hf(Hf(K,tst),tm.TraceExt,{traceID:void 0,parentID:void 0});vu(X,"traceID",Y.traceID,Sa,Fr),vu(X,"name",Y.name,Sa,Fr),vu(X,"parentID",Y.parentID,Sa,Fr)}},O.applyWebContext=function(K,Z){var Y=W.web;Y&&vu(Hf(K,tst),tm.WebExt,Y)},O.applyUserContext=function(K,Z){var Y=O.user;if(Y){var X=Hf(K,est,[]);vu(X,Au.userAccountId,Y[aD],Sa);var J=Hf(Hf(K,tst),tm.UserExt);vu(J,"id",Y.id,Sa),vu(J,"authId",Y[oD],Sa)}},O.cleanUp=function(K,Z){var Y=K.ext;Y&&(GM(Y,tm.DeviceExt),GM(Y,tm.UserExt),GM(Y,tm.WebExt),GM(Y,tm.OSExt),GM(Y,tm.AppExt),GM(Y,tm.TraceExt))}})}return p.__ieDyn=1,p}(),Lk,M3t,HM=null,Xoe=yG((Lk={accountId:HM,sessionRenewalMs:30*60*1e3,samplingPercentage:100,sessionExpirationMs:24*60*60*1e3,cookieDomain:HM,sdkExtension:HM,isBrowserLinkTrackingEnabled:!1,appId:HM},Lk[zst]=HM,Lk.namePrefix=M3t,Lk[_$t]=M3t,Lk.userCookiePostfix=M3t,Lk.idLength=22,Lk.getNewId=HM,Lk)),Koe=function(p){mw(v,p);function v(){var k=p.call(this)||this;k.priority=110,k.identifier=dlt;var N,F,W,L,O;return Mu(v,k,function(S,B){j(),Ro(S,"context",{g:function(){return L}}),S.initialize=function(Y,X,J,q){B.initialize(Y,X,J,q),K(Y)},S.processTelemetry=function(Y,X){if(!Fr(Y)){X=S._getTelCtx(X),Y.name===s5.envelopeType&&X.diagLog().resetInternalMessageCount();var J=L||{};J[Out]&&typeof L[Out].id!="string"&&J[Lut]&&J[Lut].update();var q=J.user;if(q&&!q[$st]&&q.update(J.user.id),Z(Y,X),q&&q[$ut]&&(q[$ut]=!1,!O)){var H=new KV(72,(yv()||{}).userAgent||"");Yre(X.diagLog(),1,H)}S.processNext(Y,X)}},S._doTeardown=function(Y,X){var J=(Y||{}).core();if(J&&J[I3t]){var q=J[I3t](!1);q===F&&J.setTraceCtx(W)}j()};function j(){N=null,F=null,W=null,L=null,O=!0}function K(Y){var X=S.identifier,J=S.core;S._addHook(ac(Y,function(){var q=o2(null,Y,J);Y.storagePrefix&&okt(Y.storagePrefix),O=Y.disableUserInitMessage!==!1,N=q.getExtCfg(X,Xoe),S._extConfig=N})),W=J[I3t](!1),L=new qoe(J,N,W,S._unloadHooks),F=rkt(S.context[n4t],W),J.setTraceCtx(F),S.context.appId=function(){var q=J.getPlugin(zLt);return q?q.plugin._appId:null}}function Z(Y,X){Hf(Y,"tags",[]),Hf(Y,"ext",{});var J=S.context;J[v$t](Y,X),J[b$t](Y,X),J.applyDeviceContext(Y,X),J[w$t](Y,X),J.applyUserContext(Y,X),J[x$t](Y,X),J.applyWebContext(Y,X),J[k$t](Y,X),J[S$t](Y,X),J.cleanUp(Y,X)}}),k}return v.__ieDyn=1,v}(YD),E$t="AuthenticatedUserContext",qD="track",r4t="snippet",Zoe="getCookieMgr",Qoe="startTrackPage",Joe="stopTrackPage",D3t="flush",tse="startTrackEvent",ese="stopTrackEvent",nse="addTelemetryInitializer",vDt="pollInternalLogs",R3t="getPlugin",F3t="evtNamespace",rse=qD+"Event",ise=qD+"Trace",ase=qD+"Metric",ose=qD+"PageView",sse=qD+"Exception",use=qD+"DependencyData",lse="set"+E$t,cse="clear"+E$t,hse="https://js.monitor.azure.com/scripts/b/ai.config.1.cfg.json",zut="connectionString",O3t="version",j9="queue",TV="instrumentationKey",sD="userOverrideEndpointUrl",L3t="endpointUrl",pV="onunloadFlush",dg="context",bDt="addHousekeepingBeforeUnload",$3t="sendMessage",dse="updateSnippetDefinitions",qy,YM,qM,z3t,mV,wDt=[r4t,"dependencies","properties","_snippetVersion","appInsightsNew","getSKUDefaults"],T$t="iKeyUsage",A$t="CdnUsage",I$t="SdkLoaderVer",fse="zipPayload",nst=void 0,pse={samplingRate:100,maxSendNumber:1},mse={monthInterval:3,daysOfMonth:[28]},rst={disabled:!0,limit:X1(pse),interval:X1(mse)},gse=(qy={},qy[zut]=nst,qy.endpointUrl=nst,qy[TV]=nst,qy[sD]=nst,qy.diagnosticLogInterval=gut(yse,1e4),qy.featureOptIn=(YM={},YM[T$t]={mode:3},YM[A$t]={mode:2},YM[I$t]={mode:2},YM[fse]={mode:1},YM),qy.throttleMgrCfg=X1((qM={},qM[109]=X1(rst),qM[106]=X1(rst),qM[111]=X1(rst),qM[110]=X1(rst),qM)),qy.extensionConfig=X1((z3t={},z3t.AppInsightsCfgSyncPlugin=X1({cfgUrl:hse,syncMode:2}),z3t)),qy);function yse(p){return p&&p>0}function xDt(p,v){return YV(function(k,N){im(v,function(F){var W=F&&F.value,L=null;!F.rejected&&W&&(p[zut]=W,L=ILt(W)),k(L)})})}var vse=function(){function p(v){var k=this,N,F,W,L,O,S,B,j,K,Z,Y,X,J,q;Mu(p,this,function(H){lt(),Ro(H,"config",{g:function(){return j}}),Li(["pluginVersionStringArr","pluginVersionString"],function(xt){Ro(H,xt,{g:function(){return B?B[xt]:null}})}),L=""+(v.sv||v[O3t]||""),v[j9]=v[j9]||[],v[O3t]=v[O3t]||2;var tt=Sg(v.config||{},gse);j=tt.cfg,K=new Zae,Ro(H,"appInsights",{g:function(){return K}}),F=new Koe,N=new Ooe,W=new Coe,B=new Tie,Ro(H,"core",{g:function(){return B}}),gt(ac(tt,function(){var xt=j[zut];if(f5(xt)){var wt=YV(function(qt,It){im(xDt(j,xt),function(St){if(St.rejected)qt(null);else{var vt=j[TV],Ft=St.value;vt=Ft&&Ft.instrumentationkey||vt,qt(vt)}})}),_t=j[sD];Fr(_t)&&(_t=YV(function(qt,It){im(xDt(j,xt),function(St){if(St.rejected)qt(null);else{var vt=j[L3t],Ft=St.value,Qt=Ft&&Ft.ingestionendpoint;vt=Qt?Qt+xD:vt,qt(vt)}})})),j[TV]=wt,j[L3t]=_t}if(Sa(xt)&&xt){var bt=ILt(xt),Tt=bt.ingestionendpoint;j.endpointUrl=j[sD]?j[sD]:Tt+xD,j[TV]=bt.instrumentationkey||j[TV]}j.endpointUrl=j[sD]?j[sD]:j[L3t]})),H[r4t]=v,H[D3t]=function(xt,wt){xt===void 0&&(xt=!0);var _t;return wut(B,function(){return"AISKU.flush"},function(){xt&&!wt&&(_t=m5(function(qt){wt=qt}));var bt=1,Tt=function(){bt--,bt===0&&wt()};Li(B.getChannels(),function(qt){qt&&(bt++,qt[D3t](xt,Tt))}),Tt()},null,xt),_t},H[pV]=function(xt){xt===void 0&&(xt=!0),Li(B.getChannels(),function(wt){wt[pV]?wt[pV]():wt[D3t](xt)})},H.loadAppInsights=function(xt,wt,_t){xt===void 0&&(xt=!1),xt&&tne("Legacy Mode is no longer supported");function bt(Tt){if(Tt){var qt="";Fr(L)||(qt+=L),H[dg]&&H[dg].internal&&(H[dg].internal.snippetVer=qt||"-"),Eo(H,function(It,St){Sa(It)&&!Ia(St)&&It&&It[0]!=="_"&&gf(wDt,It)===-1&&Tt[It]!==St&&(Tt[It]=St)})}}return wut(H.core,function(){return"AISKU.loadAppInsights"},function(){B.initialize(j,[W,F,N,K,Z],wt,_t),Ro(H,"context",{g:function(){return F[dg]}}),Y||(Y=new oae(B));var Tt=bse();Tt&&H[dg]&&(H[dg].internal.sdkSrc=Tt),bt(H[r4t]),H.emptyQueue(),H[vDt](),H[bDt](H),gt(ac(tt,function(){var qt=!1;j.throttleMgrCfg[109]&&(qt=!j.throttleMgrCfg[109].disabled),!Y.isReady()&&j.extensionConfig&&j.extensionConfig[Z.identifier]&&qt&&Y.onReadyState(!0),!X&&!j[zut]&&Est(T$t,j,!0)&&(Y[$3t](106,"See Instrumentation key support at aka.ms/IkeyMigrate"),X=!0),!J&&H[dg].internal.sdkSrc&&H[dg].internal.sdkSrc.indexOf("az416426")!=-1&&Est(A$t,j,!0)&&(Y[$3t](110,"See Cdn support notice at aka.ms/JsActiveCdn"),J=!0),!q&&parseInt(L)<6&&Est(I$t,j,!0)&&(Y[$3t](111,"An updated Sdk Loader is available, see aka.ms/SnippetVer"),q=!0)}))}),H},H[dse]=function(xt){Xne(xt,H,function(wt){return wt&&gf(wDt,wt)===-1})},H.emptyQueue=function(){try{if(to(H.snippet[j9])){for(var xt=H.snippet[j9].length,wt=0;wt<xt;wt++){var _t=H.snippet[j9][wt];_t()}H.snippet[j9]=void 0,delete H.snippet[j9]}}catch(Tt){var bt={};Tt&&Ia(Tt.toString)&&(bt.exception=Tt.toString())}},H[bDt]=function(xt){if(nlt()||cOt()){var wt=function(){if(xt[pV](!1),Ia(H.core[R3t])){var bt=k.core[R3t](dlt);if(bt){var Tt=bt.plugin;Tt&&Tt[dg]&&Tt[dg]._sessionManager&&Tt[dg]._sessionManager.backup()}}},_t=!1;S||(S=T5(O,B[F3t]&&B[F3t]())),gt(ac(j,function(bt){var Tt=bt.cfg,qt=xt.appInsights,It=o2(null,Tt,qt.core),St=It.getExtCfg(qt.identifier||PLt);ft();var vt=Tt.disablePageUnloadEvents;St.disableFlushOnBeforeUnload||(Pie(wt,vt,S)&&(_t=!0),Txt(wt,vt,S)&&(_t=!0),!_t&&!pre()&&ui(B.logger,1,19,"Could not add handler for beforeunload and pagehide")),!_t&&!St.disableFlushOnUnload&&Txt(wt,vt,S)}))}},H.getSender=function(){return W},H.unload=function(xt,wt,_t){var bt=!1,Tt;xt&&!wt&&(Tt=m5(function(It){wt=It}));function qt(It){bt||(bt=!0,lt(),wt&&wt(It))}return H[pV](xt),ft(),B.unload&&B.unload(xt,qt,_t),Tt},vV(H,K,[Zoe,rse,ose,"trackPageViewPerformance",sse,"_onerror",ise,ase,Qoe,Joe,tse,ese]),vV(H,st,[use,"addDependencyListener","addDependencyInitializer"]),vV(H,B,[nse,vDt,"stopPollingInternalLogs",R3t,"addPlugin",F3t,"addUnloadCb","getTraceCtx","updateCfg","onCfgChange"]),vV(H,function(){var xt=F[dg];return xt?xt.user:null},[lse,cse]);function st(){return N}function lt(){O=kg("AISKU"),S=null,N=null,F=null,W=null,L=null,Y=null,X=!1,J=!1,q=!1,Z=new aoe}function ft(){S&&(Bie(null,S),jie(null,S))}function gt(xt){B.addUnloadHook(xt)}})}return p.prototype.addDependencyInitializer=function(v){return null},p}();function bse(){if(mV)return mV;var p=null,v=["://js.monitor.azure.com/","://az416426.vo.msecnd.net/"];try{var k=(document||{}).currentScript;k&&(p=k.src)}catch{}if(p){try{var N=p.toLowerCase();if(N){var F="";Li(v,function(W,L){if(Qf(N,W)!==-1)return F="cdn"+(L+1),Qf(N,"/scripts/")===-1&&(Qf(N,"/next/")!==-1?F+="-next":Qf(N,"/beta/")!==-1&&(F+="-beta")),mV=F+"",-1})}}catch{}mV=p}return mV}var T8=class p{constructor(){if(Xe.analytics!==!1)try{this.appInsights=new vse({config:{connectionString:"InstrumentationKey=2b60d1de-2e6d-46a0-b0ab-ac29e20e0a9c;IngestionEndpoint=https://westeurope-5.in.applicationinsights.azure.com/;LiveEndpoint=https://westeurope.livediagnostics.monitor.azure.com/;ApplicationId=f5742904-b013-46ab-954b-46ba6f300b95",enableAutoRouteTracking:!0}}),this.appInsights.loadAppInsights(),this.appInsights.trackPageView()}catch(v){Qa.instance.AddLog("AppInsightsService",v)}}static getInstance(){return p.instance||(p.instance=new p),p.instance}trackEvent(v,k){if(Xe.analytics!==!1)try{this.appInsights.trackEvent({name:v},k)}catch(N){Qa.instance.AddLog("AppInsightsService | trackEvent",N)}}trackException(v){if(Xe.analytics!==!1)try{this.appInsights.trackException({exception:v})}catch(k){Qa.instance.AddLog("AppInsightsService | trackException",k)}}trackPageView(v){if(Xe.analytics!==!1)try{this.appInsights.trackPageView({name:v})}catch(k){Qa.instance.AddLog("AppInsightsService | trackPageView",k)}}},i4t=class{constructor(){this.MAX_DETECTION=1e3*25,this.initTime=null,this.appInsights=T8.getInstance()}updateHtmlElements(v,k,N){this.videoElement=v,this.canvasElement=k}initDetector(v){this.initTime=Date.now(),v==t2.Full?(this.targetedLabel="full",this.drawFrame("white")):this.targetedLabel="tilted",this.appInsights.trackEvent("IDML5Detector | initDetector",{requestId:Xe.requestId}),tp(100).then(()=>this.classifyVideo())}classifyVideo(){J3.classifier.ready.then(()=>{J3.classifier.classifyStart(this.videoElement,this.gotResults.bind(this))})}gotResults(v){return ce(this,null,function*(){Date.now()-this.initTime>=this.MAX_DETECTION&&(J3.classifier.classifyStop(),this.stream.timeElapsed()),v[0].label=="full"&&this.stream.infoFullDetected(),v[0].label=="patterns"&&this.stream.infoNoneDetected(),this.appInsights.trackEvent("IDML5Detector | gotResults",{requestId:Xe.requestId,results:v}),Xe.debug&&(console.log(v),yield this.drawResults(JSON.stringify(v))),v[0].label==this.targetedLabel&&v[0].confidence>.6&&(J3.classifier.classifyStop(),this.appInsights.trackEvent("IDML5Detector | detected",{requestId:Xe.requestId}),this.targetedLabel=="tilted"&&(yield this.drawFrame("green",!0)),yield tp(1e3),Xe.debug&&console.log("idml5detector | gotResults | autoCapturing"),this.stream.autoCapturing(),this.stream.verificationReady())})}drawResults(v){return ce(this,null,function*(){return new Promise(k=>{let F=this.canvasElement.getContext("2d");F.reset(),F.font="120px Arial",F.fillText(v,0,100),k()})})}drawFrame(v,k=!1){return ce(this,null,function*(){return new Promise(N=>{let F=new Image;v=="green"?F.src=cee:F.src=lee,F.onload=()=>ce(this,null,function*(){let W=this.canvasElement,L=W.getContext("2d"),O=W.width/F.width,S=W.height/F.height,B=Math.min(O,S),j=50,K=50,Z=(W.width-F.width*B)/2,Y=(W.height-F.height*B)/2;L.drawImage(F,0,0,F.width,F.height,Z+j,Y+K,F.width*B-j*2,F.height*B-K*2),v!="white"&&!k&&(yield tp(1e3),this.targetedLabel=="tilted"&&this.drawFrame("white")),N()})})})}},ist=new i4t,wse="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjIyNC45OTk5OTk5OTk5OTk5NyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIHZlcnNpb249IjEuMSIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQogPGc+DQogIDx0aXRsZT5MYXllciAxPC90aXRsZT4NCiAgPGcgc3Ryb2tlPSJudWxsIiBpZD0iTGF5ZXIgMSI+DQogICA8cGF0aCBzdHJva2U9IiNmZmZmZmYiIGlkPSJzdmdfMSIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZmlsbD0ibm9uZSIgZD0ibTc0LjI3NzY1LDYuOTI3NjFjLTExLjM3NTk3LC0wLjAxNzEzIC0zMy41NjU1MSw1LjEwNDMzIC00Ni44MTMxNiwxOS40OTQ4MWMtNi43NDE0Myw3LjMyMjkyIC0xOC4xMjI2OSwyMy4wNjk2NyAtMTkuMjY3NTgsNTkuNjEzNjljLTAuNTE5MDYsMTYuNTY5MjEgNS4wNDUyNCw2MC42MjUzMyAxMC4yNDAwNiw3Ni40Njc3NWMzLjYzMTMsMTEuMDc0NjggMjcuNDgyMTUsNDMuOTMzNDkgNDQuNDkwNiw1My42ODI1MWM0LjgwNzkxLDIuNzU1NDYgMTEuMjk2NjgsMi42ODI1MSAxMi40MjI1NSwyLjY4MjUxYzEuMTg4NzYsLTAuMDg0NTcgNy4zMzAyNiwwLjA3Mjk0IDEyLjEzNzY1LC0yLjY4MjUxYzE3LjAwODQ2LC05Ljc0OTAyIDQwLjQwMjA4LC00Mi43Njg1MSA0NC40OTA2LC01My42ODI1MWM0LjQwMDM4LC0xMS43NDQ5MSAxMC43NTk2NSwtNTkuODk4NTQgMTAuMjQwMDYsLTc2LjQ2Nzc1Yy0xLjE0NDg5LC0zNi41NDQwMiAtMTIuNTI2MTUsLTUyLjI5MDc3IC0xOS4yNjc1OCwtNTkuNjEzNjljLTEzLjI0NzY1LC0xNC4zOTA0OCAtMzUuMzA2NjMsLTE5LjUyOTMzIC00Ni43NzgyNywtMTkuNDk0ODFjLTAuNzQ2ODgsMC4wMDIyMiAtMS44OTQ5NCwwIC0xLjg5NDk0LDB6IiBzdHJva2Utd2lkdGg9IjciLz4NCiAgPC9nPg0KIDwvZz4NCjwvc3ZnPg0K",xse="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjIyNC45OTk5OTk5OTk5OTk5NyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIHZlcnNpb249IjEuMSIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQogPGc+DQogIDx0aXRsZT5MYXllciAxPC90aXRsZT4NCiAgPGcgc3Ryb2tlPSJudWxsIiBpZD0iTGF5ZXIgMSI+DQogICA8cGF0aCBzdHJva2U9IiM0Y2E1ODUiIGlkPSJzdmdfMSIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZmlsbD0ibm9uZSIgZD0ibTc0LjI3NzY1LDYuOTI3NjFjLTExLjM3NTk3LC0wLjAxNzEzIC0zMy41NjU1MSw1LjEwNDMzIC00Ni44MTMxNiwxOS40OTQ4MWMtNi43NDE0Myw3LjMyMjkyIC0xOC4xMjI2OSwyMy4wNjk2NyAtMTkuMjY3NTgsNTkuNjEzNjljLTAuNTE5MDYsMTYuNTY5MjEgNS4wNDUyNCw2MC42MjUzMyAxMC4yNDAwNiw3Ni40Njc3NWMzLjYzMTMsMTEuMDc0NjggMjcuNDgyMTUsNDMuOTMzNDkgNDQuNDkwNiw1My42ODI1MWM0LjgwNzkxLDIuNzU1NDYgMTEuMjk2NjgsMi42ODI1MSAxMi40MjI1NSwyLjY4MjUxYzEuMTg4NzYsLTAuMDg0NTcgNy4zMzAyNiwwLjA3Mjk0IDEyLjEzNzY1LC0yLjY4MjUxYzE3LjAwODQ2LC05Ljc0OTAyIDQwLjQwMjA4LC00Mi43Njg1MSA0NC40OTA2LC01My42ODI1MWM0LjQwMDM4LC0xMS43NDQ5MSAxMC43NTk2NSwtNTkuODk4NTQgMTAuMjQwMDYsLTc2LjQ2Nzc1Yy0xLjE0NDg5LC0zNi41NDQwMiAtMTIuNTI2MTUsLTUyLjI5MDc3IC0xOS4yNjc1OCwtNTkuNjEzNjljLTEzLjI0NzY1LC0xNC4zOTA0OCAtMzUuMzA2NjMsLTE5LjUyOTMzIC00Ni43NzgyNywtMTkuNDk0ODFjLTAuNzQ2ODgsMC4wMDIyMiAtMS44OTQ5NCwwIC0xLjg5NDk0LDB6IiBzdHJva2Utd2lkdGg9IjciLz4NCiAgPC9nPg0KIDwvZz4NCjwvc3ZnPg0K",a4t=class{constructor(){this.MAX_DETECTION=1e3*30,this.INFO_DETECTION=1e3*3,this.initTime=null,this.checkPose=!1,this.MAX_NUMBER_FACES=1,this.MIN_OCCUPIED_SPACE_FOR_DESKTOP=15,this.MIN_OCCUPIED_SPACE_FOR_MOBILE=20,this.X_OFFSET_FROM_FRAME=0,this.Y_OFFSET_FROM_FRAME=0,this.appInsights=T8.getInstance()}updateHtmlElements(v,k,N){this.videoElement=v,this.canvasElement=k}initDetector(v){this.initTime=Date.now(),this.checkPose=v==t2.Tilt,this.drawFrame("white"),this.appInsights.trackEvent("FaceML5Detector | initDetector",{requestId:Xe.requestId}),tp(100).then(()=>this.detectFaces())}detectFaces(){J3.faceapi.ready.then(()=>{J3.faceapi.detectStart(this.videoElement,this.gotResults.bind(this))})}gotResults(v){return ce(this,null,function*(){Date.now()-this.initTime>=this.MAX_DETECTION&&(J3.faceapi.detectStop(),this.stream.timeElapsed()),Date.now()-this.initTime>=this.INFO_DETECTION&&this.stream.infoTimeElapsed(),v.length>0&&(this.appInsights.trackEvent("FaceML5Detector | gotResults",{requestId:Xe.requestId,results:v}),Xe.debug&&console.log("FaceML5Detector | gotResults"),this.checkPose||this.isSingleFace(v)&&this.checkProbability(v)&&this.checkFaceSize(v)&&this.checkFaceIndent(v)&&(J3.faceapi.detectStop(),this.appInsights.trackEvent("FaceML5Detector | detected",{requestId:Xe.requestId}),yield this.drawFrame("green",!0),yield tp(1e3),Xe.debug&&console.log("faceml5detector | gotResults | autoCapturing"),this.stream.autoCapturing(),this.stream.verificationReady()))})}drawFrame(v,k=!1){return ce(this,null,function*(){return new Promise(N=>{let F=new Image;v=="green"?F.src=xse:F.src=wse,F.onload=()=>ce(this,null,function*(){let W=this.canvasElement,L=W.getContext("2d"),O=W.width<W.height;var S,B,j,K;O?(S=W.width*.1,j=W.width*.8,K=j*(F.height/F.width),B=(W.height-K)/2):(B=W.height*.1,K=W.height*.8,j=K/(F.height/F.width),S=(W.width-j)/2),L.drawImage(F,0,0,F.width,F.height,S,B,j,K),v!="white"&&!k&&this.drawFrame("white"),N()})})})}isSingleFace(v){return v.length==this.MAX_NUMBER_FACES}checkProbability(v){return!0}checkFaceSize(v){let{width:k,height:N}=v[0].box,F=100/(this.videoElement.videoWidth*this.videoElement.videoHeight/(k*N));return Xe.debug&&console.log("size: "+F+"/"+(this.isMobile?this.MIN_OCCUPIED_SPACE_FOR_MOBILE:this.MIN_OCCUPIED_SPACE_FOR_DESKTOP)),F>(this.isMobile?this.MIN_OCCUPIED_SPACE_FOR_MOBILE:this.MIN_OCCUPIED_SPACE_FOR_DESKTOP)}checkFaceIndent(v){let k=v[0].box,{xMin:N,xMax:F,yMin:W,yMax:L}=k,O=this.videoElement.videoWidth,S=this.videoElement.videoHeight,B=W*100/S,j=N*100/O,K=(O-F)*100/O,Z=(S-L)*100/S;return Xe.debug&&console.log("indent: "+B+" | "+j+" | "+K+" | "+Z),!(B<this.Y_OFFSET_FROM_FRAME||j<this.X_OFFSET_FROM_FRAME||K<this.X_OFFSET_FROM_FRAME||Z<this.Y_OFFSET_FROM_FRAME)}},ast=new a4t,N$t=function(p){return p[p.LookLeft=0]="LookLeft",p[p.LookRight=1]="LookRight",p[p.LookUp=2]="LookUp",p[p.LookDown=3]="LookDown",p[p.Main=4]="Main",p}(N$t||{}),o4t=class{static randomEnum(v){let k=Object.keys(v).map(W=>Number.parseInt(W)).filter(W=>!Number.isNaN(W)),N=Math.floor(Math.random()*(k.length-1));return k[N]}},ost={exports:{}},kDt;function kse(){return kDt||(kDt=1,function(p,v){(function(){var k={};k.version="1.0.4",k.remove=function(ft){var gt=!1;if(ft.slice(0,2)!="\xFF\xD8")if(ft.slice(0,23)=="data:image/jpeg;base64,"||ft.slice(0,22)=="data:image/jpg;base64,")ft=Z(ft.split(",")[1]),gt=!0;else throw new Error("Given data is not jpeg.");var xt=q(ft),wt=xt.filter(function(bt){return!(bt.slice(0,2)=="\xFF\xE1"&&bt.slice(4,10)=="Exif\0\0")}),_t=wt.join("");return gt&&(_t="data:image/jpeg;base64,"+K(_t)),_t},k.insert=function(ft,gt){var xt=!1;if(ft.slice(0,6)!="Exif\0\0")throw new Error("Given data is not exif.");if(gt.slice(0,2)!="\xFF\xD8")if(gt.slice(0,23)=="data:image/jpeg;base64,"||gt.slice(0,22)=="data:image/jpg;base64,")gt=Z(gt.split(",")[1]),xt=!0;else throw new Error("Given data is not jpeg.");var wt="\xFF\xE1"+Y(">H",[ft.length+2])+ft,_t=q(gt),bt=tt(_t,wt);return xt&&(bt="data:image/jpeg;base64,"+K(bt)),bt},k.load=function(ft){var gt;if(typeof ft=="string")if(ft.slice(0,2)=="\xFF\xD8")gt=ft;else if(ft.slice(0,23)=="data:image/jpeg;base64,"||ft.slice(0,22)=="data:image/jpg;base64,")gt=Z(ft.split(",")[1]);else if(ft.slice(0,4)=="Exif")gt=ft.slice(6);else throw new Error("'load' gots invalid file data.");else throw new Error("'load' gots invalid type argument.");var xt={"0th":{},Exif:{},GPS:{},Interop:{},"1st":{},thumbnail:null},wt=new j(gt);if(wt.tiftag===null)return xt;wt.tiftag.slice(0,2)=="II"?wt.endian_mark="<":wt.endian_mark=">";var _t=X(wt.endian_mark+"L",wt.tiftag.slice(4,8))[0];xt["0th"]=wt.get_ifd(_t,"0th");var bt=xt["0th"].first_ifd_pointer;if(delete xt["0th"].first_ifd_pointer,34665 in xt["0th"]&&(_t=xt["0th"][34665],xt.Exif=wt.get_ifd(_t,"Exif")),34853 in xt["0th"]&&(_t=xt["0th"][34853],xt.GPS=wt.get_ifd(_t,"GPS")),40965 in xt.Exif&&(_t=xt.Exif[40965],xt.Interop=wt.get_ifd(_t,"Interop")),bt!="\0\0\0\0"&&(_t=X(wt.endian_mark+"L",bt)[0],xt["1st"]=wt.get_ifd(_t,"1st"),513 in xt["1st"]&&514 in xt["1st"])){var Tt=xt["1st"][513]+xt["1st"][514],qt=wt.tiftag.slice(xt["1st"][513],Tt);xt.thumbnail=qt}return xt},k.dump=function(ft){var gt=8,xt=N(ft),wt="Exif\0\0MM\0*\0\0\0\b",_t=!1,bt=!1,Tt=!1,qt=!1,It,St,vt,Ft,Qt;"0th"in xt?It=xt["0th"]:It={},"Exif"in xt&&Object.keys(xt.Exif).length||"Interop"in xt&&Object.keys(xt.Interop).length?(It[34665]=1,_t=!0,St=xt.Exif,"Interop"in xt&&Object.keys(xt.Interop).length?(St[40965]=1,Tt=!0,vt=xt.Interop):Object.keys(St).indexOf(k.ExifIFD.InteroperabilityTag.toString())>-1&&delete St[40965]):Object.keys(It).indexOf(k.ImageIFD.ExifTag.toString())>-1&&delete It[34665],"GPS"in xt&&Object.keys(xt.GPS).length?(It[k.ImageIFD.GPSTag]=1,bt=!0,Ft=xt.GPS):Object.keys(It).indexOf(k.ImageIFD.GPSTag.toString())>-1&&delete It[k.ImageIFD.GPSTag],"1st"in xt&&"thumbnail"in xt&&xt.thumbnail!=null&&(qt=!0,xt["1st"][513]=1,xt["1st"][514]=1,Qt=xt["1st"]);var Gt=B(It,"0th",0),ge=Gt[0].length+_t*12+bt*12+4+Gt[1].length,ee,Ee="",Bt=0,Xt,we="",ie=0,m,ye="",Ge=0,te,Me="",Ye;if(_t&&(ee=B(St,"Exif",ge),Bt=ee[0].length+Tt*12+ee[1].length),bt&&(Xt=B(Ft,"GPS",ge+Bt),we=Xt.join(""),ie=we.length),Tt){var Ue=ge+Bt+ie;m=B(vt,"Interop",Ue),ye=m.join(""),Ge=ye.length}if(qt){var Ue=ge+Bt+ie+Ge;if(te=B(Qt,"1st",Ue),Ye=F(xt.thumbnail),Ye.length>64e3)throw new Error("Given thumbnail is too large. max 64kB")}var kn="",mn="",Kn="",Sn="\0\0\0\0";if(_t){var Wn=gt+ge,Ze=Y(">L",[Wn]),de=34665,Re=Y(">H",[de]),Kt=Y(">H",[st.Long]),Jt=Y(">L",[1]);kn=Re+Kt+Jt+Ze}if(bt){var Wn=gt+ge+Bt,Ze=Y(">L",[Wn]),de=34853,Re=Y(">H",[de]),Kt=Y(">H",[st.Long]),Jt=Y(">L",[1]);mn=Re+Kt+Jt+Ze}if(Tt){var Wn=gt+ge+Bt+ie,Ze=Y(">L",[Wn]),de=40965,Re=Y(">H",[de]),Kt=Y(">H",[st.Long]),Jt=Y(">L",[1]);Kn=Re+Kt+Jt+Ze}if(qt){var Wn=gt+ge+Bt+ie+Ge;Sn=Y(">L",[Wn]);var Ae=Wn+te[0].length+24+4+te[1].length,$e="\0\0\0\0"+Y(">L",[Ae]),tn="\0\0\0\0"+Y(">L",[Ye.length]);Me=te[0]+$e+tn+"\0\0\0\0"+te[1]+Ye}var wn=Gt[0]+kn+mn+Sn+Gt[1];return _t&&(Ee=ee[0]+Kn+ee[1]),wt+wn+Ee+we+ye+Me};function N(ft){return JSON.parse(JSON.stringify(ft))}function F(ft){for(var gt=q(ft);"\xFF\xE0"<=gt[1].slice(0,2)&&gt[1].slice(0,2)<="\xFF\xEF";)gt=[gt[0]].concat(gt.slice(2));return gt.join("")}function W(ft){return Y(">"+J("B",ft.length),ft)}function L(ft){return Y(">"+J("H",ft.length),ft)}function O(ft){return Y(">"+J("L",ft.length),ft)}function S(ft,gt,xt){var wt="",_t="",bt,Tt,qt,It;if(gt=="Byte")bt=ft.length,bt<=4?_t=W(ft)+J("\0",4-bt):(_t=Y(">L",[xt]),wt=W(ft));else if(gt=="Short")bt=ft.length,bt<=2?_t=L(ft)+J("\0\0",2-bt):(_t=Y(">L",[xt]),wt=L(ft));else if(gt=="Long")bt=ft.length,bt<=1?_t=O(ft):(_t=Y(">L",[xt]),wt=O(ft));else if(gt=="Ascii")Tt=ft+"\0",bt=Tt.length,bt>4?(_t=Y(">L",[xt]),wt=Tt):_t=Tt+J("\0",4-bt);else if(gt=="Rational"){if(typeof ft[0]=="number")bt=1,qt=ft[0],It=ft[1],Tt=Y(">L",[qt])+Y(">L",[It]);else{bt=ft.length,Tt="";for(var St=0;St<bt;St++)qt=ft[St][0],It=ft[St][1],Tt+=Y(">L",[qt])+Y(">L",[It])}_t=Y(">L",[xt]),wt=Tt}else if(gt=="SRational"){if(typeof ft[0]=="number")bt=1,qt=ft[0],It=ft[1],Tt=Y(">l",[qt])+Y(">l",[It]);else{bt=ft.length,Tt="";for(var St=0;St<bt;St++)qt=ft[St][0],It=ft[St][1],Tt+=Y(">l",[qt])+Y(">l",[It])}_t=Y(">L",[xt]),wt=Tt}else gt=="Undefined"&&(bt=ft.length,bt>4?(_t=Y(">L",[xt]),wt=ft):_t=ft+J("\0",4-bt));var vt=Y(">L",[bt]);return[vt,_t,wt]}function B(ft,gt,xt){var wt=8,_t=Object.keys(ft).length,bt=Y(">H",[_t]),Tt;["0th","1st"].indexOf(gt)>-1?Tt=2+_t*12+4:Tt=2+_t*12;var qt="",It="",St;for(var St in ft)if(typeof St=="string"&&(St=parseInt(St)),!(gt=="0th"&&[34665,34853].indexOf(St)>-1)){{if(gt=="Exif"&&St==40965)continue;if(gt=="1st"&&[513,514].indexOf(St)>-1)continue}var vt=ft[St],Ft=Y(">H",[St]),Qt=lt[gt][St].type,Gt=Y(">H",[st[Qt]]);typeof vt=="number"&&(vt=[vt]);var ge=wt+Tt+xt+It.length,ee=S(vt,Qt,ge),Ee=ee[0],Bt=ee[1],Xt=ee[2];qt+=Ft+Gt+Ee+Bt,It+=Xt}return[bt+qt,It]}function j(ft){var gt,xt;if(ft.slice(0,2)=="\xFF\xD8")gt=q(ft),xt=H(gt),xt?this.tiftag=xt.slice(10):this.tiftag=null;else if(["II","MM"].indexOf(ft.slice(0,2))>-1)this.tiftag=ft;else if(ft.slice(0,4)=="Exif")this.tiftag=ft.slice(6);else throw new Error("Given file is neither JPEG nor TIFF.")}if(j.prototype={get_ifd:function(ft,gt){var xt={},wt=X(this.endian_mark+"H",this.tiftag.slice(ft,ft+2))[0],_t=ft+2,bt;["0th","1st"].indexOf(gt)>-1?bt="Image":bt=gt;for(var Tt=0;Tt<wt;Tt++){ft=_t+12*Tt;var qt=X(this.endian_mark+"H",this.tiftag.slice(ft,ft+2))[0],It=X(this.endian_mark+"H",this.tiftag.slice(ft+2,ft+4))[0],St=X(this.endian_mark+"L",this.tiftag.slice(ft+4,ft+8))[0],vt=this.tiftag.slice(ft+8,ft+12),Ft=[It,St,vt];qt in lt[bt]&&(xt[qt]=this.convert_value(Ft))}return gt=="0th"&&(ft=_t+12*wt,xt.first_ifd_pointer=this.tiftag.slice(ft,ft+4)),xt},convert_value:function(ft){var gt=null,xt=ft[0],wt=ft[1],_t=ft[2],bt;if(xt==1)wt>4?(bt=X(this.endian_mark+"L",_t)[0],gt=X(this.endian_mark+J("B",wt),this.tiftag.slice(bt,bt+wt))):gt=X(this.endian_mark+J("B",wt),_t.slice(0,wt));else if(xt==2)wt>4?(bt=X(this.endian_mark+"L",_t)[0],gt=this.tiftag.slice(bt,bt+wt-1)):gt=_t.slice(0,wt-1);else if(xt==3)wt>2?(bt=X(this.endian_mark+"L",_t)[0],gt=X(this.endian_mark+J("H",wt),this.tiftag.slice(bt,bt+wt*2))):gt=X(this.endian_mark+J("H",wt),_t.slice(0,wt*2));else if(xt==4)wt>1?(bt=X(this.endian_mark+"L",_t)[0],gt=X(this.endian_mark+J("L",wt),this.tiftag.slice(bt,bt+wt*4))):gt=X(this.endian_mark+J("L",wt),_t);else if(xt==5)if(bt=X(this.endian_mark+"L",_t)[0],wt>1){gt=[];for(var Tt=0;Tt<wt;Tt++)gt.push([X(this.endian_mark+"L",this.tiftag.slice(bt+Tt*8,bt+4+Tt*8))[0],X(this.endian_mark+"L",this.tiftag.slice(bt+4+Tt*8,bt+8+Tt*8))[0]])}else gt=[X(this.endian_mark+"L",this.tiftag.slice(bt,bt+4))[0],X(this.endian_mark+"L",this.tiftag.slice(bt+4,bt+8))[0]];else if(xt==7)wt>4?(bt=X(this.endian_mark+"L",_t)[0],gt=this.tiftag.slice(bt,bt+wt)):gt=_t.slice(0,wt);else if(xt==9)wt>1?(bt=X(this.endian_mark+"L",_t)[0],gt=X(this.endian_mark+J("l",wt),this.tiftag.slice(bt,bt+wt*4))):gt=X(this.endian_mark+J("l",wt),_t);else if(xt==10)if(bt=X(this.endian_mark+"L",_t)[0],wt>1){gt=[];for(var Tt=0;Tt<wt;Tt++)gt.push([X(this.endian_mark+"l",this.tiftag.slice(bt+Tt*8,bt+4+Tt*8))[0],X(this.endian_mark+"l",this.tiftag.slice(bt+4+Tt*8,bt+8+Tt*8))[0]])}else gt=[X(this.endian_mark+"l",this.tiftag.slice(bt,bt+4))[0],X(this.endian_mark+"l",this.tiftag.slice(bt+4,bt+8))[0]];else throw new Error("Exif might be wrong. Got incorrect value type to decode. type:"+xt);return gt instanceof Array&&gt.length==1?gt[0]:gt}},typeof window<"u"&&typeof window.btoa=="function")var K=window.btoa;if(typeof K>"u")var K=function(gt){for(var xt="",wt,_t,bt,Tt,qt,It,St,vt=0,Ft="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";vt<gt.length;)wt=gt.charCodeAt(vt++),_t=gt.charCodeAt(vt++),bt=gt.charCodeAt(vt++),Tt=wt>>2,qt=(wt&3)<<4|_t>>4,It=(_t&15)<<2|bt>>6,St=bt&63,isNaN(_t)?It=St=64:isNaN(bt)&&(St=64),xt=xt+Ft.charAt(Tt)+Ft.charAt(qt)+Ft.charAt(It)+Ft.charAt(St);return xt};if(typeof window<"u"&&typeof window.atob=="function")var Z=window.atob;if(typeof Z>"u")var Z=function(gt){var xt="",wt,_t,bt,Tt,qt,It,St,vt=0,Ft="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(gt=gt.replace(/[^A-Za-z0-9\+\/\=]/g,"");vt<gt.length;)Tt=Ft.indexOf(gt.charAt(vt++)),qt=Ft.indexOf(gt.charAt(vt++)),It=Ft.indexOf(gt.charAt(vt++)),St=Ft.indexOf(gt.charAt(vt++)),wt=Tt<<2|qt>>4,_t=(qt&15)<<4|It>>2,bt=(It&3)<<6|St,xt=xt+String.fromCharCode(wt),It!=64&&(xt=xt+String.fromCharCode(_t)),St!=64&&(xt=xt+String.fromCharCode(bt));return xt};function Y(ft,gt){if(!(gt instanceof Array))throw new Error("'pack' error. Got invalid type argument.");if(ft.length-1!=gt.length)throw new Error("'pack' error. "+(ft.length-1)+" marks, "+gt.length+" elements.");var xt;if(ft[0]=="<")xt=!0;else if(ft[0]==">")xt=!1;else throw new Error("");for(var wt="",_t=1,bt=null,Tt=null,qt=null;Tt=ft[_t];){if(Tt.toLowerCase()=="b"){if(bt=gt[_t-1],Tt=="b"&&bt<0&&(bt+=256),bt>255||bt<0)throw new Error("'pack' error.");qt=String.fromCharCode(bt)}else if(Tt=="H"){if(bt=gt[_t-1],bt>65535||bt<0)throw new Error("'pack' error.");qt=String.fromCharCode(Math.floor(bt%65536/256))+String.fromCharCode(bt%256),xt&&(qt=qt.split("").reverse().join(""))}else if(Tt.toLowerCase()=="l"){if(bt=gt[_t-1],Tt=="l"&&bt<0&&(bt+=4294967296),bt>4294967295||bt<0)throw new Error("'pack' error.");qt=String.fromCharCode(Math.floor(bt/16777216))+String.fromCharCode(Math.floor(bt%16777216/65536))+String.fromCharCode(Math.floor(bt%65536/256))+String.fromCharCode(bt%256),xt&&(qt=qt.split("").reverse().join(""))}else throw new Error("'pack' error.");wt+=qt,_t+=1}return wt}function X(ft,gt){if(typeof gt!="string")throw new Error("'unpack' error. Got invalid type argument.");for(var xt=0,wt=1;wt<ft.length;wt++)if(ft[wt].toLowerCase()=="b")xt+=1;else if(ft[wt].toLowerCase()=="h")xt+=2;else if(ft[wt].toLowerCase()=="l")xt+=4;else throw new Error("'unpack' error. Got invalid mark.");if(xt!=gt.length)throw new Error("'unpack' error. Mismatch between symbol and string length. "+xt+":"+gt.length);var _t;if(ft[0]=="<")_t=!0;else if(ft[0]==">")_t=!1;else throw new Error("'unpack' error.");for(var bt=[],Tt=0,qt=1,It=null,St=null,vt=null,Ft="";St=ft[qt];){if(St.toLowerCase()=="b")vt=1,Ft=gt.slice(Tt,Tt+vt),It=Ft.charCodeAt(0),St=="b"&&It>=128&&(It-=256);else if(St=="H")vt=2,Ft=gt.slice(Tt,Tt+vt),_t&&(Ft=Ft.split("").reverse().join("")),It=Ft.charCodeAt(0)*256+Ft.charCodeAt(1);else if(St.toLowerCase()=="l")vt=4,Ft=gt.slice(Tt,Tt+vt),_t&&(Ft=Ft.split("").reverse().join("")),It=Ft.charCodeAt(0)*16777216+Ft.charCodeAt(1)*65536+Ft.charCodeAt(2)*256+Ft.charCodeAt(3),St=="l"&&It>=2147483648&&(It-=4294967296);else throw new Error("'unpack' error. "+St);bt.push(It),Tt+=vt,qt+=1}return bt}function J(ft,gt){for(var xt="",wt=0;wt<gt;wt++)xt+=ft;return xt}function q(ft){if(ft.slice(0,2)!="\xFF\xD8")throw new Error("Given data isn't JPEG.");for(var gt=2,xt=["\xFF\xD8"];;){if(ft.slice(gt,gt+2)=="\xFF\xDA"){xt.push(ft.slice(gt));break}else{var wt=X(">H",ft.slice(gt+2,gt+4))[0],_t=gt+wt+2;xt.push(ft.slice(gt,_t)),gt=_t}if(gt>=ft.length)throw new Error("Wrong JPEG data.")}return xt}function H(ft){for(var gt,xt=0;xt<ft.length;xt++)if(gt=ft[xt],gt.slice(0,2)=="\xFF\xE1"&&gt.slice(4,10)=="Exif\0\0")return gt;return null}function tt(ft,gt){var xt=!1,wt=[];return ft.forEach(function(_t,bt){_t.slice(0,2)=="\xFF\xE1"&&_t.slice(4,10)=="Exif\0\0"&&(xt?wt.unshift(bt):(ft[bt]=gt,xt=!0))}),wt.forEach(function(_t){ft.splice(_t,1)}),!xt&&gt&&(ft=[ft[0],gt].concat(ft.slice(1))),ft.join("")}var st={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},lt={Image:{11:{name:"ProcessingSoftware",type:"Ascii"},254:{name:"NewSubfileType",type:"Long"},255:{name:"SubfileType",type:"Short"},256:{name:"ImageWidth",type:"Long"},257:{name:"ImageLength",type:"Long"},258:{name:"BitsPerSample",type:"Short"},259:{name:"Compression",type:"Short"},262:{name:"PhotometricInterpretation",type:"Short"},263:{name:"Threshholding",type:"Short"},264:{name:"CellWidth",type:"Short"},265:{name:"CellLength",type:"Short"},266:{name:"FillOrder",type:"Short"},269:{name:"DocumentName",type:"Ascii"},270:{name:"ImageDescription",type:"Ascii"},271:{name:"Make",type:"Ascii"},272:{name:"Model",type:"Ascii"},273:{name:"StripOffsets",type:"Long"},274:{name:"Orientation",type:"Short"},277:{name:"SamplesPerPixel",type:"Short"},278:{name:"RowsPerStrip",type:"Long"},279:{name:"StripByteCounts",type:"Long"},282:{name:"XResolution",type:"Rational"},283:{name:"YResolution",type:"Rational"},284:{name:"PlanarConfiguration",type:"Short"},290:{name:"GrayResponseUnit",type:"Short"},291:{name:"GrayResponseCurve",type:"Short"},292:{name:"T4Options",type:"Long"},293:{name:"T6Options",type:"Long"},296:{name:"ResolutionUnit",type:"Short"},301:{name:"TransferFunction",type:"Short"},305:{name:"Software",type:"Ascii"},306:{name:"DateTime",type:"Ascii"},315:{name:"Artist",type:"Ascii"},316:{name:"HostComputer",type:"Ascii"},317:{name:"Predictor",type:"Short"},318:{name:"WhitePoint",type:"Rational"},319:{name:"PrimaryChromaticities",type:"Rational"},320:{name:"ColorMap",type:"Short"},321:{name:"HalftoneHints",type:"Short"},322:{name:"TileWidth",type:"Short"},323:{name:"TileLength",type:"Short"},324:{name:"TileOffsets",type:"Short"},325:{name:"TileByteCounts",type:"Short"},330:{name:"SubIFDs",type:"Long"},332:{name:"InkSet",type:"Short"},333:{name:"InkNames",type:"Ascii"},334:{name:"NumberOfInks",type:"Short"},336:{name:"DotRange",type:"Byte"},337:{name:"TargetPrinter",type:"Ascii"},338:{name:"ExtraSamples",type:"Short"},339:{name:"SampleFormat",type:"Short"},340:{name:"SMinSampleValue",type:"Short"},341:{name:"SMaxSampleValue",type:"Short"},342:{name:"TransferRange",type:"Short"},343:{name:"ClipPath",type:"Byte"},344:{name:"XClipPathUnits",type:"Long"},345:{name:"YClipPathUnits",type:"Long"},346:{name:"Indexed",type:"Short"},347:{name:"JPEGTables",type:"Undefined"},351:{name:"OPIProxy",type:"Short"},512:{name:"JPEGProc",type:"Long"},513:{name:"JPEGInterchangeFormat",type:"Long"},514:{name:"JPEGInterchangeFormatLength",type:"Long"},515:{name:"JPEGRestartInterval",type:"Short"},517:{name:"JPEGLosslessPredictors",type:"Short"},518:{name:"JPEGPointTransforms",type:"Short"},519:{name:"JPEGQTables",type:"Long"},520:{name:"JPEGDCTables",type:"Long"},521:{name:"JPEGACTables",type:"Long"},529:{name:"YCbCrCoefficients",type:"Rational"},530:{name:"YCbCrSubSampling",type:"Short"},531:{name:"YCbCrPositioning",type:"Short"},532:{name:"ReferenceBlackWhite",type:"Rational"},700:{name:"XMLPacket",type:"Byte"},18246:{name:"Rating",type:"Short"},18249:{name:"RatingPercent",type:"Short"},32781:{name:"ImageID",type:"Ascii"},33421:{name:"CFARepeatPatternDim",type:"Short"},33422:{name:"CFAPattern",type:"Byte"},33423:{name:"BatteryLevel",type:"Rational"},33432:{name:"Copyright",type:"Ascii"},33434:{name:"ExposureTime",type:"Rational"},34377:{name:"ImageResources",type:"Byte"},34665:{name:"ExifTag",type:"Long"},34675:{name:"InterColorProfile",type:"Undefined"},34853:{name:"GPSTag",type:"Long"},34857:{name:"Interlace",type:"Short"},34858:{name:"TimeZoneOffset",type:"Long"},34859:{name:"SelfTimerMode",type:"Short"},37387:{name:"FlashEnergy",type:"Rational"},37388:{name:"SpatialFrequencyResponse",type:"Undefined"},37389:{name:"Noise",type:"Undefined"},37390:{name:"FocalPlaneXResolution",type:"Rational"},37391:{name:"FocalPlaneYResolution",type:"Rational"},37392:{name:"FocalPlaneResolutionUnit",type:"Short"},37393:{name:"ImageNumber",type:"Long"},37394:{name:"SecurityClassification",type:"Ascii"},37395:{name:"ImageHistory",type:"Ascii"},37397:{name:"ExposureIndex",type:"Rational"},37398:{name:"TIFFEPStandardID",type:"Byte"},37399:{name:"SensingMethod",type:"Short"},40091:{name:"XPTitle",type:"Byte"},40092:{name:"XPComment",type:"Byte"},40093:{name:"XPAuthor",type:"Byte"},40094:{name:"XPKeywords",type:"Byte"},40095:{name:"XPSubject",type:"Byte"},50341:{name:"PrintImageMatching",type:"Undefined"},50706:{name:"DNGVersion",type:"Byte"},50707:{name:"DNGBackwardVersion",type:"Byte"},50708:{name:"UniqueCameraModel",type:"Ascii"},50709:{name:"LocalizedCameraModel",type:"Byte"},50710:{name:"CFAPlaneColor",type:"Byte"},50711:{name:"CFALayout",type:"Short"},50712:{name:"LinearizationTable",type:"Short"},50713:{name:"BlackLevelRepeatDim",type:"Short"},50714:{name:"BlackLevel",type:"Rational"},50715:{name:"BlackLevelDeltaH",type:"SRational"},50716:{name:"BlackLevelDeltaV",type:"SRational"},50717:{name:"WhiteLevel",type:"Short"},50718:{name:"DefaultScale",type:"Rational"},50719:{name:"DefaultCropOrigin",type:"Short"},50720:{name:"DefaultCropSize",type:"Short"},50721:{name:"ColorMatrix1",type:"SRational"},50722:{name:"ColorMatrix2",type:"SRational"},50723:{name:"CameraCalibration1",type:"SRational"},50724:{name:"CameraCalibration2",type:"SRational"},50725:{name:"ReductionMatrix1",type:"SRational"},50726:{name:"ReductionMatrix2",type:"SRational"},50727:{name:"AnalogBalance",type:"Rational"},50728:{name:"AsShotNeutral",type:"Short"},50729:{name:"AsShotWhiteXY",type:"Rational"},50730:{name:"BaselineExposure",type:"SRational"},50731:{name:"BaselineNoise",type:"Rational"},50732:{name:"BaselineSharpness",type:"Rational"},50733:{name:"BayerGreenSplit",type:"Long"},50734:{name:"LinearResponseLimit",type:"Rational"},50735:{name:"CameraSerialNumber",type:"Ascii"},50736:{name:"LensInfo",type:"Rational"},50737:{name:"ChromaBlurRadius",type:"Rational"},50738:{name:"AntiAliasStrength",type:"Rational"},50739:{name:"ShadowScale",type:"SRational"},50740:{name:"DNGPrivateData",type:"Byte"},50741:{name:"MakerNoteSafety",type:"Short"},50778:{name:"CalibrationIlluminant1",type:"Short"},50779:{name:"CalibrationIlluminant2",type:"Short"},50780:{name:"BestQualityScale",type:"Rational"},50781:{name:"RawDataUniqueID",type:"Byte"},50827:{name:"OriginalRawFileName",type:"Byte"},50828:{name:"OriginalRawFileData",type:"Undefined"},50829:{name:"ActiveArea",type:"Short"},50830:{name:"MaskedAreas",type:"Short"},50831:{name:"AsShotICCProfile",type:"Undefined"},50832:{name:"AsShotPreProfileMatrix",type:"SRational"},50833:{name:"CurrentICCProfile",type:"Undefined"},50834:{name:"CurrentPreProfileMatrix",type:"SRational"},50879:{name:"ColorimetricReference",type:"Short"},50931:{name:"CameraCalibrationSignature",type:"Byte"},50932:{name:"ProfileCalibrationSignature",type:"Byte"},50934:{name:"AsShotProfileName",type:"Byte"},50935:{name:"NoiseReductionApplied",type:"Rational"},50936:{name:"ProfileName",type:"Byte"},50937:{name:"ProfileHueSatMapDims",type:"Long"},50938:{name:"ProfileHueSatMapData1",type:"Float"},50939:{name:"ProfileHueSatMapData2",type:"Float"},50940:{name:"ProfileToneCurve",type:"Float"},50941:{name:"ProfileEmbedPolicy",type:"Long"},50942:{name:"ProfileCopyright",type:"Byte"},50964:{name:"ForwardMatrix1",type:"SRational"},50965:{name:"ForwardMatrix2",type:"SRational"},50966:{name:"PreviewApplicationName",type:"Byte"},50967:{name:"PreviewApplicationVersion",type:"Byte"},50968:{name:"PreviewSettingsName",type:"Byte"},50969:{name:"PreviewSettingsDigest",type:"Byte"},50970:{name:"PreviewColorSpace",type:"Long"},50971:{name:"PreviewDateTime",type:"Ascii"},50972:{name:"RawImageDigest",type:"Undefined"},50973:{name:"OriginalRawFileDigest",type:"Undefined"},50974:{name:"SubTileBlockSize",type:"Long"},50975:{name:"RowInterleaveFactor",type:"Long"},50981:{name:"ProfileLookTableDims",type:"Long"},50982:{name:"ProfileLookTableData",type:"Float"},51008:{name:"OpcodeList1",type:"Undefined"},51009:{name:"OpcodeList2",type:"Undefined"},51022:{name:"OpcodeList3",type:"Undefined"}},Exif:{33434:{name:"ExposureTime",type:"Rational"},33437:{name:"FNumber",type:"Rational"},34850:{name:"ExposureProgram",type:"Short"},34852:{name:"SpectralSensitivity",type:"Ascii"},34855:{name:"ISOSpeedRatings",type:"Short"},34856:{name:"OECF",type:"Undefined"},34864:{name:"SensitivityType",type:"Short"},34865:{name:"StandardOutputSensitivity",type:"Long"},34866:{name:"RecommendedExposureIndex",type:"Long"},34867:{name:"ISOSpeed",type:"Long"},34868:{name:"ISOSpeedLatitudeyyy",type:"Long"},34869:{name:"ISOSpeedLatitudezzz",type:"Long"},36864:{name:"ExifVersion",type:"Undefined"},36867:{name:"DateTimeOriginal",type:"Ascii"},36868:{name:"DateTimeDigitized",type:"Ascii"},37121:{name:"ComponentsConfiguration",type:"Undefined"},37122:{name:"CompressedBitsPerPixel",type:"Rational"},37377:{name:"ShutterSpeedValue",type:"SRational"},37378:{name:"ApertureValue",type:"Rational"},37379:{name:"BrightnessValue",type:"SRational"},37380:{name:"ExposureBiasValue",type:"SRational"},37381:{name:"MaxApertureValue",type:"Rational"},37382:{name:"SubjectDistance",type:"Rational"},37383:{name:"MeteringMode",type:"Short"},37384:{name:"LightSource",type:"Short"},37385:{name:"Flash",type:"Short"},37386:{name:"FocalLength",type:"Rational"},37396:{name:"SubjectArea",type:"Short"},37500:{name:"MakerNote",type:"Undefined"},37510:{name:"UserComment",type:"Ascii"},37520:{name:"SubSecTime",type:"Ascii"},37521:{name:"SubSecTimeOriginal",type:"Ascii"},37522:{name:"SubSecTimeDigitized",type:"Ascii"},40960:{name:"FlashpixVersion",type:"Undefined"},40961:{name:"ColorSpace",type:"Short"},40962:{name:"PixelXDimension",type:"Long"},40963:{name:"PixelYDimension",type:"Long"},40964:{name:"RelatedSoundFile",type:"Ascii"},40965:{name:"InteroperabilityTag",type:"Long"},41483:{name:"FlashEnergy",type:"Rational"},41484:{name:"SpatialFrequencyResponse",type:"Undefined"},41486:{name:"FocalPlaneXResolution",type:"Rational"},41487:{name:"FocalPlaneYResolution",type:"Rational"},41488:{name:"FocalPlaneResolutionUnit",type:"Short"},41492:{name:"SubjectLocation",type:"Short"},41493:{name:"ExposureIndex",type:"Rational"},41495:{name:"SensingMethod",type:"Short"},41728:{name:"FileSource",type:"Undefined"},41729:{name:"SceneType",type:"Undefined"},41730:{name:"CFAPattern",type:"Undefined"},41985:{name:"CustomRendered",type:"Short"},41986:{name:"ExposureMode",type:"Short"},41987:{name:"WhiteBalance",type:"Short"},41988:{name:"DigitalZoomRatio",type:"Rational"},41989:{name:"FocalLengthIn35mmFilm",type:"Short"},41990:{name:"SceneCaptureType",type:"Short"},41991:{name:"GainControl",type:"Short"},41992:{name:"Contrast",type:"Short"},41993:{name:"Saturation",type:"Short"},41994:{name:"Sharpness",type:"Short"},41995:{name:"DeviceSettingDescription",type:"Undefined"},41996:{name:"SubjectDistanceRange",type:"Short"},42016:{name:"ImageUniqueID",type:"Ascii"},42032:{name:"CameraOwnerName",type:"Ascii"},42033:{name:"BodySerialNumber",type:"Ascii"},42034:{name:"LensSpecification",type:"Rational"},42035:{name:"LensMake",type:"Ascii"},42036:{name:"LensModel",type:"Ascii"},42037:{name:"LensSerialNumber",type:"Ascii"},42240:{name:"Gamma",type:"Rational"}},GPS:{0:{name:"GPSVersionID",type:"Byte"},1:{name:"GPSLatitudeRef",type:"Ascii"},2:{name:"GPSLatitude",type:"Rational"},3:{name:"GPSLongitudeRef",type:"Ascii"},4:{name:"GPSLongitude",type:"Rational"},5:{name:"GPSAltitudeRef",type:"Byte"},6:{name:"GPSAltitude",type:"Rational"},7:{name:"GPSTimeStamp",type:"Rational"},8:{name:"GPSSatellites",type:"Ascii"},9:{name:"GPSStatus",type:"Ascii"},10:{name:"GPSMeasureMode",type:"Ascii"},11:{name:"GPSDOP",type:"Rational"},12:{name:"GPSSpeedRef",type:"Ascii"},13:{name:"GPSSpeed",type:"Rational"},14:{name:"GPSTrackRef",type:"Ascii"},15:{name:"GPSTrack",type:"Rational"},16:{name:"GPSImgDirectionRef",type:"Ascii"},17:{name:"GPSImgDirection",type:"Rational"},18:{name:"GPSMapDatum",type:"Ascii"},19:{name:"GPSDestLatitudeRef",type:"Ascii"},20:{name:"GPSDestLatitude",type:"Rational"},21:{name:"GPSDestLongitudeRef",type:"Ascii"},22:{name:"GPSDestLongitude",type:"Rational"},23:{name:"GPSDestBearingRef",type:"Ascii"},24:{name:"GPSDestBearing",type:"Rational"},25:{name:"GPSDestDistanceRef",type:"Ascii"},26:{name:"GPSDestDistance",type:"Rational"},27:{name:"GPSProcessingMethod",type:"Undefined"},28:{name:"GPSAreaInformation",type:"Undefined"},29:{name:"GPSDateStamp",type:"Ascii"},30:{name:"GPSDifferential",type:"Short"},31:{name:"GPSHPositioningError",type:"Rational"}},Interop:{1:{name:"InteroperabilityIndex",type:"Ascii"}}};lt["0th"]=lt.Image,lt["1st"]=lt.Image,k.TAGS=lt,k.ImageIFD={ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},k.ExifIFD={ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},k.GPSIFD={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},k.InteropIFD={InteroperabilityIndex:1},k.GPSHelper={degToDmsRational:function(ft){var gt=Math.abs(ft),xt=gt%1*60,wt=xt%1*60,_t=Math.floor(gt),bt=Math.floor(xt),Tt=Math.round(wt*100);return[[_t,1],[bt,1],[Tt,100]]},dmsRationalToDeg:function(ft,gt){var xt=gt==="S"||gt==="W"?-1:1,wt=ft[0][0]/ft[0][1]+ft[1][0]/ft[1][1]/60+ft[2][0]/ft[2][1]/3600;return wt*xt}},p.exports&&(v=p.exports=k),v.piexif=k})()}(ost,ost.exports)),ost.exports}var U9=kse(),Sse=(p,v,k)=>ce(void 0,null,function*(){let N=yield MD(p),F=U9.load(N),L=(yield navigator.mediaDevices.enumerateDevices()).filter(K=>K.kind==="videoinput").map(K=>K.label),O={width:k.width,height:k.height,usedCamera:v.label,camerasOnDevice:L},S={"0th":Object.assign(Object.assign({},F["0th"]),{[U9.ImageIFD.Model]:O.usedCamera,[U9.ImageIFD.ImageWidth]:O.width,[U9.ImageIFD.ImageLength]:O.height}),Exif:Object.assign(Object.assign({},F.Exif),{[U9.ExifIFD.UserComment]:JSON.stringify(O)}),GPS:Object.assign({},F.GPS),Interop:Object.assign({},F.Interop),"1st":Object.assign({},F["1st"]),thumbnail:F.thumbnail},B=U9.dump(S),j=U9.insert(B,N);return yield fetch(j).then(K=>K.blob())}),s4t=function(p){return p.JPEG="image/jpeg",p.PNG="image/png",p}(s4t||{}),Xf=(()=>{let p=class AV{setFaceDetection(k){this.faceDetection=k,this.idDetection=!k}setIdDetection(k){this.idDetection=k,this.faceDetection=!k,this.setIdMask(!1)}setIdMask(k){this.showIdMask=k}setCallbackVideoStarted(k){this.callbackVideoStarted=k}setCallbackAutoCapturing(k){this.callbackAutoCapturing=k}setCallbackRecordingReady(k){}setCallbackTimeElapsed(k){this.callbackTimeElapsed=k}setCallbackInfoTimeElapsed(k){this.callbackInfoTimeElapsed=k}setCallbackFullDetected(k){this.callbackFullDetected=k}setCallbackNoneDetected(k){this.callbackNoneDetected=k}setVerificationFinished(k){this.verificationFinished=k}constructor(k){this.streamPaused=!1,this.showIdMask=!1,this.videoSize={width:0,height:0},Xe.debug&&console.log("stream | constructor"),J3.start(),ist.stream=this,ast.stream=this,ast.isMobile=Xe.device.isMobile,this.verificationMode=k}static getNewInstance(k){return Xe.debug&&console.log("stream | getNewInstance"),AV.instance||(AV.instance=new AV(k),Xe.debug&&console.log("stream | getNewInstance | new instance")),AV.instance}autoCapturing(){Xe.debug&&console.log("stream | autoCapturing"),this.callbackAutoCapturing()}timeElapsed(){Xe.debug&&console.log("stream | timeElapsed"),this.callbackTimeElapsed()}infoTimeElapsed(){Xe.debug&&console.log("stream | infoTimeElapsed"),this.callbackInfoTimeElapsed()}infoFullDetected(){Xe.debug&&console.log("stream | infoFullDetected"),this.callbackFullDetected()}infoNoneDetected(){Xe.debug&&console.log("stream | infoNoneDetected"),this.callbackNoneDetected()}verificationReady(){Xe.debug&&console.log("stream | verificationReady"),this.verificationFinished()}updateHtmlElements(k,N,F){this.videoElement=k,this.canvasElement=N,ist.updateHtmlElements(this.videoElement,this.canvasElement,F),ast.updateHtmlElements(this.videoElement,this.canvasElement,F)}startStream(k){Xe.debug&&console.log("stream | startStream"),this.stream&&this.stream.getTracks().forEach(N=>N.stop()),this.stream=k,!(!this.videoElement||this.videoElement==null)&&("srcObject"in this.videoElement?this.videoElement.srcObject=k:this.videoElement.src=window.URL.createObjectURL(k),this.videoElement.addEventListener("loadedmetadata",N=>ce(this,null,function*(){this.videoElement.play().then(()=>{this.streamPaused=!1,this.updateCanvasSize(this.canvasElement),this.updateVideoSize(this.videoElement),this.callbackVideoStarted(),this.idDetection&&this.startIdDetection(),this.faceDetection&&this.startFaceDetection(),this.showIdMask&&ist.drawFrame("white")})}),!1))}initStream(k){return ce(this,null,function*(){this.startStream(k)})}updateCanvasSize(k){this.videoSize={width:this.videoElement.videoWidth,height:this.videoElement.videoHeight},k.width=this.videoSize.width,k.height=this.videoSize.height}updateVideoSize(k){this.videoSize={width:this.videoElement.videoWidth,height:this.videoElement.videoHeight},k.width=this.videoSize.width,k.height=this.videoSize.height}dropStream(){this.mediaRecorder&&this.mediaRecorder.state!="inactive"&&this.mediaRecorder.stop(),this.streamStopped()||(this.stream.getTracks().forEach(k=>k.stop()),this.videoElement.srcObject=null)}streamStopped(){return!(this.stream&&this.stream.getTracks&&this.stream.getTracks().length>0)}takePhoto(){return ce(this,null,function*(){Xe.debug&&console.log("stream | takePhoto");let k=document.createElement("canvas");return k.style.visibility="hidden",k.width=this.videoElement.videoWidth,k.height=this.videoElement.videoHeight,yield this.getFrame(k)})}getFrame(k){return Xe.debug&&console.log("stream | getFrame"),new Promise(N=>{k.getContext("2d").drawImage(this.videoElement,0,0,k.width,k.height),k.toBlob(W=>{if(W&&W.type===s4t.JPEG&&!Xe.device.isAppleDevice)try{Xe.debug&&console.log("stream | getFrame | addExifInImg"),Sse(W,this.stream.getTracks()[0],this.videoSize).then(L=>N(L))}catch{N(W),this.timeElapsed()}else Xe.debug&&console.log("stream | getFrame | resolve"),N(W)},s4t.PNG,1)})}startIdDetection(){return ce(this,null,function*(){this.streamPaused||ist.initDetector(this.verificationMode)})}startFaceDetection(){return ce(this,null,function*(){this.streamPaused||ast.initDetector(this.verificationMode)})}initFacePose(){this.facePose=o4t.randomEnum(N$t)}};return p.mp4MimeType={type:"video/mp4",codec:"codecs:h264",extension:"mp4",mime:"video/mp4;codecs:h264"},p.webmMimeType={type:"video/webm",codec:"codecs=vp8",extension:"webm",mime:"video/webm;codecs=vp8"},p})(),_se="data:image/svg+xml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KDTwhLS0gVXBsb2FkZWQgdG86IFNWRyBSZXBvLCB3d3cuc3ZncmVwby5jb20sIFRyYW5zZm9ybWVkIGJ5OiBTVkcgUmVwbyBNaXhlciBUb29scyAtLT4KPHN2ZyBmaWxsPSIjZmZmZmZmIiBoZWlnaHQ9IjgwMHB4IiB3aWR0aD0iODAwcHgiIHZlcnNpb249IjEuMSIgaWQ9IkNhcGFfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmlld0JveD0iMCAwIDQ4NyA0ODciIHhtbDpzcGFjZT0icHJlc2VydmUiIHN0cm9rZT0iI2ZmZmZmZiI+Cg08ZyBpZD0iU1ZHUmVwb19iZ0NhcnJpZXIiIHN0cm9rZS13aWR0aD0iMCIvPgoNPGcgaWQ9IlNWR1JlcG9fdHJhY2VyQ2FycmllciIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cg08ZyBpZD0iU1ZHUmVwb19pY29uQ2FycmllciI+IDxnPiA8Zz4gPHBhdGggZD0iTTMwOC4xLDI3Ny45NWMwLDM1LjctMjguOSw2NC42LTY0LjYsNjQuNnMtNjQuNi0yOC45LTY0LjYtNjQuNnMyOC45LTY0LjYsNjQuNi02NC42UzMwOC4xLDI0Mi4yNSwzMDguMSwyNzcuOTV6IE00NDAuMywxMTYuMDVjMjUuOCwwLDQ2LjcsMjAuOSw0Ni43LDQ2Ljd2MTIyLjR2MTAzLjhjMCwyNy41LTIyLjMsNDkuOC00OS44LDQ5LjhINDkuOGMtMjcuNSwwLTQ5LjgtMjIuMy00OS44LTQ5Ljh2LTEwMy45IHYtMTIyLjNsMCwwYzAtMjUuOCwyMC45LTQ2LjcsNDYuNy00Ni43aDkzLjRsNC40LTE4LjZjNi43LTI4LjgsMzIuNC00OS4yLDYyLTQ5LjJoNzQuMWMyOS42LDAsNTUuMywyMC40LDYyLDQ5LjJsNC4zLDE4LjZINDQwLjN6IE05Ny40LDE4My40NWMwLTEyLjktMTAuNS0yMy40LTIzLjQtMjMuNGMtMTMsMC0yMy41LDEwLjUtMjMuNSwyMy40czEwLjUsMjMuNCwyMy40LDIzLjRDODYuOSwyMDYuOTUsOTcuNCwxOTYuNDUsOTcuNCwxODMuNDV6IE0zNTguNywyNzcuOTVjMC02My42LTUxLjYtMTE1LjItMTE1LjItMTE1LjJzLTExNS4yLDUxLjYtMTE1LjIsMTE1LjJzNTEuNiwxMTUuMiwxMTUuMiwxMTUuMlMzNTguNywzNDEuNTUsMzU4LjcsMjc3Ljk1eiIvPiA8L2c+IDwvZz4gPC9nPgoNPC9zdmc+",Cse=".camera{color:white;display:flex;align-items:center;justify-content:center;position:relative}.cameraCanvas,.cameraCanvasSelfie,.cameraCanvasSelfieDesk{z-index:3;max-width:100%;max-height:100%;border-radius:10px}.cameraCanvasSelfie,.cameraCanvasSelfieDesk{transform:scale(-1, 1);-webkit-transform:scale(-1, 1)}.cameraVideo,.cameraVideoSelfie,.cameraVideoSelfieDesk{z-index:2;position:absolute;max-width:100%;max-height:100%;border-radius:10px}.cameraVideoSelfie,.cameraVideoSelfieDesk{transform:scale(-1, 1);-webkit-transform:scale(-1, 1)}.cameraMobile{position:fixed;top:0;left:0;background:black}.take-photo{height:36px;background:#40c1ac;border-radius:50px;padding:14px}",Hhe=(()=>{let p=class{constructor(v){ll(this,v),this.eventVideoStarted=ps(this,"videoStarted"),this.eventTakePhoto=ps(this,"takePhoto"),this.eventRecordingSelfieReady=ps(this,"recordingSelfieCapture"),this.eventRecordingIdReady=ps(this,"recordingIdCapture"),this.eventTimeElapsed=ps(this,"timeElapsed"),this.eventInfoTimeElapsed=ps(this,"infoTimeElapsed"),this.verificationFinished=ps(this,"verificationFinished"),this.infoFullDetected=ps(this,"infoFullDetected"),this.infoNoneDetected=ps(this,"infoNoneDetected"),this.callbackAutoCapturing=()=>{this.eventTakePhoto.emit()},this.callbackSelfieRecordingReady=k=>{this.eventRecordingSelfieReady.emit(k)},this.callbackIdRecordingReady=k=>{this.eventRecordingIdReady.emit(k)},this.callbackTimeElapsed=()=>{this.eventTimeElapsed.emit()},this.callbackInfoTimeElapsed=()=>{this.eventInfoTimeElapsed.emit()},this.callbackVideoStarted=()=>{this.eventVideoStarted.emit(this.component.getBoundingClientRect())},this.callbackVerificationFinished=()=>{this.verificationFinished.emit()},this.callbackFullDetected=()=>{this.infoFullDetected.emit()},this.callbackNoneDetected=()=>{this.infoNoneDetected.emit()}}componentDidLoad(){Xe.debug&&console.log("camera | componentDidLoad"),this.startStream()}render(){this.verificationMode=[aa.IDTILT,aa.LIVENESSGESTURE].includes(Xe.flowStatus)?t2.Tilt:t2.Full;let v="cameraVideo",k="cameraCanvas";return Xe.device.isDesktop&&(v="cameraVideoSelfieDesk",k="cameraCanvasSelfieDesk"),this.captureMode=="selfie"&&(v="cameraVideoSelfie",k="cameraCanvasSelfie"),He("div",{key:"6c9484d327e745ae6ec90bf439a5057e7859817f",class:([aa.IDFRONT,aa.IDBACK].includes(Xe.flowStatus)?"":"bg-black ")+"w-100 h-100 rounded"},He("div",{key:"f2103d17d9c73bd48ae0f4673ecde7f59f7a038d",class:"camera rounded"},He("video",{key:"d9104a8581339f1da9d9639251be19acf4a2faaf",id:"video",loop:!0,autoplay:!0,playsinline:!0,muted:!0,class:v,ref:N=>this.cameraVideo=N}),He("canvas",{key:"e5def11989ed1db770236c6fbbd521810d35de29",id:"output",class:k,ref:N=>this.cameraCanvas=N})),[aa.IDFRONT,aa.IDBACK].includes(Xe.flowStatus)?He("div",{class:"flex center"},He("div",{class:"take-photo flex center mt-2 w-100 mx-2",onClick:()=>this.eventTakePhoto.emit()},He("img",{class:"h-100 d-block",src:_se}))):null)}startStream(){Xe.debug&&console.log("camera | startStream");let v=Xf.getNewInstance(this.verificationMode);v.updateHtmlElements(this.cameraVideo,this.cameraCanvas,this.component),this.captureMode=="selfie"?(v.setFaceDetection(!0),v.setCallbackRecordingReady(this.callbackSelfieRecordingReady)):(this.verificationMode==t2.Tilt?v.setIdDetection(!0):v.setIdMask(!0),v.setCallbackRecordingReady(this.callbackIdRecordingReady)),v.setCallbackAutoCapturing(this.callbackAutoCapturing),v.setCallbackVideoStarted(this.callbackVideoStarted),v.setCallbackTimeElapsed(this.callbackTimeElapsed),v.setCallbackInfoTimeElapsed(this.callbackInfoTimeElapsed),v.setCallbackFullDetected(this.callbackFullDetected),v.setCallbackNoneDetected(this.callbackNoneDetected),v.setVerificationFinished(this.callbackVerificationFinished)}get component(){return HW(this)}};return p.style=Cse,p})(),yg=function(p){return p.Android="android",p.iOS="ios",p.Unknown="unknown",p.WindowsPhone="Windows Phone",p}(yg||{}),Zy=function(p){return p.Linux="linux",p.MacOS="mac_os",p.Unix="unix",p.Unknown="unknown",p.Windows="windows",p}(Zy||{}),Xk=function(p){return p.Chrome="chrome",p.Firefox="firefox",p.Safari="safari",p.Mi="mi",p.Unknown="unknown",p}(Xk||{}),gw="data:image/svg+xml;base64,PHN2ZyBpZD0ic3Bpbm5lckxvYWRlclJlZiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiBvdmVyZmxvdz0idmlzaWJsZSIgZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDMwMzAzIiBjbGFzcz0ic2luZ2xlLWxvYWRlciI+DQogIDxkZWZzPg0KICAgIDxjaXJjbGUgaWQ9InNwaW5uZXIiIHI9IjQiIGN4PSI1MCIgY3k9IjUwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0zMCkiLz4gICAgDQogIDwvZGVmcz4NCiAgPHVzZSB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeGxpbms6aHJlZj0iI3NwaW5uZXIiIHRyYW5zZm9ybT0icm90YXRlKDAgNTAgNTApIj4NCiAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJvcGFjaXR5IiB2YWx1ZXM9IjA7MTswIiBkdXI9IjFzIiBiZWdpbj0iMHMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+DQogIDwvdXNlPg0KICA8dXNlIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bGluazpocmVmPSIjc3Bpbm5lciIgdHJhbnNmb3JtPSJyb3RhdGUoNDUgNTAgNTApIj4NCiAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJvcGFjaXR5IiB2YWx1ZXM9IjA7MTswIiBkdXI9IjFzIiBiZWdpbj0iMC4xMjVzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIvPg0KICA8L3VzZT4NCiAgPHVzZSB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeGxpbms6aHJlZj0iI3NwaW5uZXIiIHRyYW5zZm9ybT0icm90YXRlKDkwIDUwIDUwKSI+DQogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIwOzE7MCIgZHVyPSIxcyIgYmVnaW49IjAuMjVzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIvPg0KICA8L3VzZT4NCiAgPHVzZSB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeGxpbms6aHJlZj0iI3NwaW5uZXIiIHRyYW5zZm9ybT0icm90YXRlKDEzNSA1MCA1MCkiPg0KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9Im9wYWNpdHkiIHZhbHVlcz0iMDsxOzAiIGR1cj0iMXMiIGJlZ2luPSIwLjM3NXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+DQogIDwvdXNlPg0KICA8dXNlIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bGluazpocmVmPSIjc3Bpbm5lciIgdHJhbnNmb3JtPSJyb3RhdGUoMTgwIDUwIDUwKSI+DQogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIwOzE7MCIgZHVyPSIxcyIgYmVnaW49IjAuNXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+DQogIDwvdXNlPg0KICA8dXNlIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bGluazpocmVmPSIjc3Bpbm5lciIgdHJhbnNmb3JtPSJyb3RhdGUoMjI1IDUwIDUwKSI+DQogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIwOzE7MCIgZHVyPSIxcyIgYmVnaW49IjAuNjI1cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiLz4NCiAgPC91c2U+DQogIDx1c2UgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhsaW5rOmhyZWY9IiNzcGlubmVyIiB0cmFuc2Zvcm09InJvdGF0ZSgyNzAgNTAgNTApIj4NCiAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJvcGFjaXR5IiB2YWx1ZXM9IjA7MTswIiBkdXI9IjFzIiBiZWdpbj0iMC43NXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+DQogIDwvdXNlPg0KICA8dXNlIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bGluazpocmVmPSIjc3Bpbm5lciIgdHJhbnNmb3JtPSJyb3RhdGUoMzE1IDUwIDUwKSI+DQogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIwOzE7MCIgZHVyPSIxcyIgYmVnaW49IjAuODc1cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiLz4NCiAgPC91c2U+DQo8L3N2Zz4=",Ese="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NS44NzYiIGhlaWdodD0iNjAuNzg4IiB2aWV3Qm94PSIwIDAgNTUuODc2IDYwLjc4OCI+DQogIDxnIGlkPSJtb2JpbGVfcGhvbmVfY2FtZXJhIiBkYXRhLW5hbWU9Im1vYmlsZSBwaG9uZSBjYW1lcmEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNTYgLTc1LjIxMikiPg0KICAgIDxnIGlkPSJHcm91cF80NjE1IiBkYXRhLW5hbWU9Ikdyb3VwIDQ2MTUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01MikiPg0KICAgICAgPGcgaWQ9Ikdyb3VwXzQ2MTQiIGRhdGEtbmFtZT0iR3JvdXAgNDYxNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTgzIC0yNjYuNzg4KSI+DQogICAgICAgIDxwYXRoIGlkPSJQYXRoXzQ3NDYiIGRhdGEtbmFtZT0iUGF0aCA0NzQ2IiBkPSJNMzAuMDQ4LDU1YTEuMDQ4LDEuMDQ4LDAsMSwwLDAsMi4xSDM0LjI0YTEuMDQ4LDEuMDQ4LDAsMSwwLDAtMi4xWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAuNjczIDM0MS41KSIvPg0KICAgICAgICA8cGF0aCBpZD0iUGF0aF80NzQ4IiBkYXRhLW5hbWU9IlBhdGggNDc0OCIgZD0iTTM4LjAyOSw5LjA0OEEuOTkuOTksMCwwLDAsMzYuOTgxLDhIMjcuNTQ4QS45OS45OSwwLDAsMCwyNi41LDkuMDQ4Ljk5Ljk5LDAsMCwwLDI3LjU0OCwxMC4xaDkuNDMzQS45OS45OSwwLDAsMCwzOC4wMjksOS4wNDhaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMC41NTMgMzM5LjI0KSIgZmlsbD0iIzI1MmM4MiIvPg0KICAgICAgICA8ZyBpZD0iR3JvdXBfNDYwNyIgZGF0YS1uYW1lPSJHcm91cCA0NjA3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNSAzNDIpIj4NCiAgICAgICAgICA8cGF0aCBpZD0iUGF0aF80NzQ3IiBkYXRhLW5hbWU9IlBhdGggNDc0NyIgZD0iTTQ4LjUzOCw5LjE4NGExLjA0OCwxLjA0OCwwLDEsMCwyLjEsMEE2LjI2NCw2LjI2NCwwLDAsMCw0NC40NTEsM0gyMS4xODRBNi4yNjQsNi4yNjQsMCwwLDAsMTUsOS4xODRWNTcuNmE2LjIsNi4yLDAsMCwwLDYuMTg0LDYuMTg0SDQ0LjQ1MUE2LjIsNi4yLDAsMCwwLDUwLjYzNSw1Ny42VjQyLjgyN2ExLjA0OCwxLjA0OCwwLDEsMC0yLjEsMFY1Ny42YTQuMDkzLDQuMDkzLDAsMCwxLTQuMDg3LDQuMDg3SDIxLjE4NEE0LjA5Myw0LjA5MywwLDAsMSwxNy4xLDU3LjZWOS4xODRBNC4xNjIsNC4xNjIsMCwwLDEsMjEuMTg0LDUuMUg0NC40NTFhNC4xNjIsNC4xNjIsMCwwLDEsNC4wODcsNC4wODdaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTUgLTMpIiBmaWxsPSIjMjUyYzgyIi8+DQogICAgICAgIDwvZz4NCiAgICAgIDwvZz4NCiAgICAgIDxwYXRoIGlkPSJjYW1lcmFfMV8iIGRhdGEtbmFtZT0iY2FtZXJhICgxKSIgZD0iTTQzLjE0NywyMi43MjlhMTQuNDM4LDE0LjQzOCwwLDEsMCw0LjIyOSwxMC4yMDlBMTQuMzkzLDE0LjM5MywwLDAsMCw0My4xNDcsMjIuNzI5Wk00Mi4wNzMsNDIuMDczYTEyLjkxOSwxMi45MTksMCwxLDEsMy43ODQtOS4xMzVBMTIuODc4LDEyLjg3OCwwLDAsMSw0Mi4wNzMsNDIuMDczWk0zMi45MzgsMjkuNzYxYTMuMzg5LDMuMzg5LDAsMSwwLDIuNC45OTJBMy4zNzgsMy4zNzgsMCwwLDAsMzIuOTM4LDI5Ljc2MVptMS4zMjEsNC43MWExLjg2OSwxLjg2OSwwLDEsMSwuNTQ3LTEuMzIxQTEuODYzLDEuODYzLDAsMCwxLDM0LjI1OSwzNC40N1ptNC40ODYtOC4xMzFIMzYuNDYxdi0uNWExLjc0NiwxLjc0NiwwLDAsMC0xLjc0My0xLjc0M0gzMS4xNTlhMS43NDYsMS43NDYsMCwwLDAtMS43NDMsMS43NDN2LjVIMjcuMTMxYTIuOTE5LDIuOTE5LDAsMCwwLTIuOTEzLDIuOTEzdjcuNzk1YTIuOTE5LDIuOTE5LDAsMCwwLDIuOTEzLDIuOTEzSDM4Ljc0NmEyLjkxOSwyLjkxOSwwLDAsMCwyLjkxMy0yLjkxM1YyOS4yNTJhMi45MTksMi45MTksMCwwLDAtMi45MTMtMi45MTNabTEuMzkzLDEwLjcwOGExLjQsMS40LDAsMCwxLTEuMzkzLDEuMzkzSDI3LjEzMWExLjQsMS40LDAsMCwxLTEuMzkzLTEuMzkzVjI5LjI1MmExLjQsMS40LDAsMCwxLDEuMzkzLTEuMzkzaDMuMDQ1YS43Ni43NiwwLDAsMCwuNzYtLjc2VjI1LjgzNmEuMjI2LjIyNiwwLDAsMSwuMjIzLS4yMjNoMy41NTlhLjIyNi4yMjYsMCwwLDEsLjIyMy4yMjNWMjcuMWEuNzYuNzYsMCwwLDAsLjc2Ljc2aDMuMDQ1YTEuNCwxLjQsMCwwLDEsMS4zOTMsMS4zOTNaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTYuNSA2NS4xMjQpIiBmaWxsPSIjZmY1MzUzIi8+DQogICAgPC9nPg0KICA8L2c+DQo8L3N2Zz4NCg==",Put="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNy44MDYiIGhlaWdodD0iMjcuODA2IiB2aWV3Qm94PSIwIDAgMjcuODA2IDI3LjgwNiI+DQogIDxwYXRoIGlkPSJjaGF0LWluZm8iIGQ9Ik00Ljc0NywzMC4wMTNhMi41LDIuNSwwLDAsMS0yLjM2OC0zLjI4NGwxLjItMy41NTdhMS42OCwxLjY4LDAsMCwwLS4wMzgtMS4yMjEsMTMuOSwxMy45LDAsMSwxLDYuNzg5LDYuNzgzQTEuNjkyLDEuNjkyLDAsMCwwLDkuMDgxLDI4LjdMNS41NCwyOS44ODZBMi41MTksMi41MTksMCwwLDEsNC43NDcsMzAuMDEzWk0xNi4xMzEsNC40QTExLjcxOSwxMS43MTksMCwwLDAsNS40NywyMS4wMzksMy44MTMsMy44MTMsMCwwLDEsNS42LDIzLjgzMkw0LjQsMjcuNDA2YS4zNDIuMzQyLDAsMCwwLC4wOTEuMzYzLjM0Ny4zNDcsMCwwLDAsLjM2Ni4wOTFsMy41NTctMS4xOTRhMy44MTIsMy44MTIsMCwwLDEsMi44Mi4xMzRBMTEuNzM0LDExLjczNCwwLDEsMCwxNi4xMjMsNC40Wm0xLjQ0NCw3LjQ3MmExLjQyMywxLjQyMywwLDAsMC0xLjQyMy0xLjQyM2gtLjAxNGExLjQyMywxLjQyMywwLDEsMCwxLjQzNywxLjQyM1ptLS4zODQsOC41MzhWMTYuMTQxYTEuMDY3LDEuMDY3LDAsMCwwLTIuMTM0LDBWMjAuNDFhMS4wNjcsMS4wNjcsMCwwLDAsMi4xMzQsMFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yLjI1MSAtMi4yMSkiIGZpbGw9IiNmZmE2MDAiLz4NCjwvc3ZnPg0K",M$t="data:image/svg+xml;base64,PHN2ZyBpZD0iY2xvc2UiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjIyLjc0NyIgaGVpZ2h0PSIyMi42IiB2aWV3Qm94PSIwIDAgMjIuNzQ3IDIyLjYiPg0KICA8cGF0aCBpZD0iUGF0aF80NzcxIiBkYXRhLW5hbWU9IlBhdGggNDc3MSIgZD0iTTExLjM3MywyMi42QTExLjMsMTEuMywwLDEsMSwyMi43NDcsMTEuMywxMS4zMzcsMTEuMzM3LDAsMCwxLDExLjM3MywyMi42Wm0wLTIxLjE4N0E5Ljg4OCw5Ljg4OCwwLDEsMCwyMS4zMjUsMTEuM2E5LjkyLDkuOTIsMCwwLDAtOS45NTItOS44ODdaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDApIiBmaWxsPSIjMjUyYzgyIi8+DQogIDxwYXRoIGlkPSJQYXRoXzQ3NzIiIGRhdGEtbmFtZT0iUGF0aCA0NzcyIiBkPSJNMTAuNzQsOS42NDgsMTUuMjMzLDUuMmEuNjkzLjY5MywwLDAsMCwwLS45ODkuNzE1LjcxNSwwLDAsMC0xLDBMOS43MjQsOC42NDUsNS4yMTcsNC4yMWEuNzE1LjcxNSwwLDAsMC0xLDAsLjY5My42OTMsMCwwLDAsMCwuOTg5TDguNzA4LDkuNjQ4LDQuMjE1LDE0LjFhLjY3Mi42NzIsMCwwLDAsMCwuOTg5LjY5My42OTMsMCwwLDAsMSwwbDQuNTA3LTQuNDM1LDQuNTA3LDQuNDM1YS42OTMuNjkzLDAsMCwwLDEsMCwuNjcyLjY3MiwwLDAsMCwwLS45ODlaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjY0OSAxLjY1MikiIGZpbGw9IiMyNTJjODIiLz4NCjwvc3ZnPg0K",Tse="",Yhe=(()=>{let p=class{constructor(v){ll(this,v),this.apiErrorEvent=ps(this,"apiError")}componentWillLoad(){return ce(this,null,function*(){this.translations=yield vd.getValues(),this.modal=!1,this.buttonDisabled=!1,this.title=this.translations.CameraErrorValues.Title,this.description=this.translations.CameraErrorValues.Description,this.info=this.translations.CameraErrorValues.Info,this.infoTitle=this.translations.CameraErrorValues.InfoTitle,this.buttonText=this.translations.CameraErrorValues.Button,this.ectData=yield qu.ectdata.get(Xe.requestId)})}componentDidLoad(){return ce(this,null,function*(){yield dl.initialize(Ns.CameraError),Xe.device.mobileOS!=yg.iOS?(this.demoVideo.src=this.translations.CameraErrorValues.HowToLink,this.demoVideo.loop=!0,this.demoVideo.play()):this.ectData.refreshStarted&&(this.ectData.refreshStarted=!1,yield qu.ectdata.put(this.ectData),Xe.flowStatus=aa.LANDING)})}disconnectedCallback(){return ce(this,null,function*(){yield dl.finalize(Ns.CameraError)})}infoClick(){return ce(this,null,function*(){this.modal=!0})}buttonClick(){return ce(this,null,function*(){this.buttonDisabled=!0,Xe.device.mobileOS==yg.iOS?(this.ectData.refreshStarted=!0,yield qu.ectdata.put(this.ectData),window.location.reload()):Xe.flowStatus=aa.LANDING})}render(){return He("div",{key:"5fde479e2f83125b59840b35641c058e4aef5cda",class:"container flex center"},He("div",{key:"eabfd6ab1e4cc67ccf808355d2fde9b211e34199",hidden:!this.modal,class:"modal flex center w-100"},He("div",{key:"2e4d4c67c2f9b0996ebacbbc499a4d00442e2a5a",class:"inner w-100 text-center mx-1"},He("img",{key:"e41d18d92ab95c5d388327e8d01e7e0857b62cbc",class:"close-modal",src:M$t,onClick:()=>this.modal=!1}),He("img",{key:"af68bf5158603f79297ffa966c7eb0786f53b037",src:Put}),He("h2",{key:"ed1ada6e108112537dc2769beb4d7acc9717b29a",class:"loud-text color-blue mb-1"},He("strong",{key:"b75871a97f4fbc74af1ced28aa1c143a40ea2e8d"},this.infoTitle)),He("video",{key:"b1df51ad00dee8ae21150fc784ab163205d93a25",id:"howtoPermissions",class:"video-demo",playsinline:!0,ref:v=>this.demoVideo=v},He("source",{key:"bf592950eec132fdac00dc2b7e638f34c5793024",type:"video/mp4"})))),He("div",{key:"85a93f6837f68e6d81f39c1d2574562b64fd3b79",class:"px-3 text-center"},He("img",{key:"c010a34c3e24b6420cc13aea354f33553b1a62aa",class:"mb-1 ml-1",src:Ese}),He("h1",{key:"b0d6f3389435b532e5e875f516a18b1ab63096b2",class:"color-red mb-2"},this.title),He("div",{key:"0fd28d9ea2feb730d25edf6efd414ebcfc69f43a",class:"color-blue mb-2 loud-text",innerHTML:this.description}),He("p",{key:"a298b57e9a22366130320d95c2b94dff2970eb63",hidden:Xe.device.mobileOS==yg.iOS,class:"flex center mb-3",onClick:()=>this.infoClick()},He("strong",{key:"82fd00afdc9d217e6b1c3e7ee2a3bc4183bedde7",class:"color-blue loud-text"},this.info)," \xA0\xA0",He("img",{key:"5bd78ff27ed145c76711ad7c7f3dea8b42e123cb",src:Put})),He("div",{key:"6456a3f6ac2ef6402626e8a03c33a0a8b5806b2b",class:"button flex"},this.buttonDisabled?He("div",{class:"img-loader img-loader-button"},He("img",{class:"loading-image loading-image-button",src:gw})):null,He("button",{key:"2ad740b507a038c6859665080c063486ef49377e",class:"main-button",type:"button",disabled:this.buttonDisabled,onClick:()=>this.buttonClick()},this.buttonText)),He("div",{key:"628cb1174f9103401bb96397e1a3849264935d54",class:"footer text-center"},He("img",{key:"19f268fcb3252aea30ebb212f464e565a388c2f0",src:Cd}))))}};return p.style=Tse,p})(),Ase="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2Ny4zNDYiIGhlaWdodD0iNTQuNzA0IiB2aWV3Qm94PSIwIDAgNjcuMzQ2IDU0LjcwNCI+DQogIDxnIGlkPSJpZC1jYXJkX3giIGRhdGEtbmFtZT0iaWQtY2FyZCB4IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTcgLTI5KSI+DQogICAgPHBhdGggaWQ9IlBhdGhfNDc1MSIgZGF0YS1uYW1lPSJQYXRoIDQ3NTEiIGQ9Ik0yMS4zNDUsNzcuODhINTAuMTNhMS4wODYsMS4wODYsMCwwLDAsMC0yLjE3MkgyMS4zNDVhMi4xNzUsMi4xNzUsMCwwLDEtMi4xNzItMi4xNzJWMzMuMzQ1YTIuMTc1LDIuMTc1LDAsMCwxLDIuMTcyLTIuMTcySDgwYTIuMTc1LDIuMTc1LDAsMCwxLDIuMTcyLDIuMTcyVjU1LjA2OWExLjA4NiwxLjA4NiwwLDAsMCwyLjE3MiwwVjMzLjM0NUE0LjM1LDQuMzUsMCwwLDAsODAsMjlIMjEuMzQ1QTQuMzUsNC4zNSwwLDAsMCwxNywzMy4zNDV2NDAuMTlBNC4zNSw0LjM1LDAsMCwwLDIxLjM0NSw3Ny44OFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgMCkiIGZpbGw9IiMyNTJjODIiLz4NCiAgICA8cGF0aCBpZD0iUGF0aF80NzUyIiBkYXRhLW5hbWU9IlBhdGggNDc1MiIgZD0iTTU0LjI5Myw1Mi4xNDdhOC4xNDcsOC4xNDcsMCwxLDAtOC4xNDcsOC4xNDdBOC4xNTYsOC4xNTYsMCwwLDAsNTQuMjkzLDUyLjE0N1ptLTE0LjEyMSwwYTUuOTc0LDUuOTc0LDAsMSwxLDUuOTc0LDUuOTc0QTUuOTgxLDUuOTgxLDAsMCwxLDQwLjE3Miw1Mi4xNDdaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtOS41OTUgLTYuODUzKSIgZmlsbD0iIzI1MmM4MiIvPg0KICAgIDxwYXRoIGlkPSJQYXRoXzQ3NTMiIGRhdGEtbmFtZT0iUGF0aCA0NzUzIiBkPSJNMzIsODYuNjl2NC4zNDVhMS4wODcsMS4wODcsMCwwLDAsMS4wODYsMS4wODZINTMuNzI0YTEuMDg3LDEuMDg3LDAsMCwwLDEuMDg2LTEuMDg2Vjg2LjY5QTguNyw4LjcsMCwwLDAsNDYuMTIxLDc4SDQwLjY5QTguNyw4LjcsMCwwLDAsMzIsODYuNjlabTguNjktNi41MTdoNS40MzFhNi41MjUsNi41MjUsMCwwLDEsNi41MTcsNi41MTd2My4yNTlIMzQuMTcyVjg2LjY5QTYuNTI1LDYuNTI1LDAsMCwxLDQwLjY5LDgwLjE3MloiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC02Ljg1MyAtMjIuMzg4KSIgZmlsbD0iIzI1MmM4MiIvPg0KICAgIDxwYXRoIGlkPSJQYXRoXzQ3NTQiIGRhdGEtbmFtZT0iUGF0aCA0NzU0IiBkPSJNMTA3LjgxMSw0OEg4Ni4wODZhMS4wODYsMS4wODYsMCwxLDAsMCwyLjE3MmgyMS43MjRhMS4wODYsMS4wODYsMCwwLDAsMC0yLjE3MloiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zMS4wNjggLTguNjgxKSIgZmlsbD0iIzI1MmM4MiIvPg0KICAgIDxwYXRoIGlkPSJQYXRoXzQ3NTUiIGRhdGEtbmFtZT0iUGF0aCA0NzU1IiBkPSJNMTA3LjgxMSw2Mkg4Ni4wODZhMS4wODYsMS4wODYsMCwxLDAsMCwyLjE3MmgyMS43MjRhMS4wODYsMS4wODYsMCwwLDAsMC0yLjE3MloiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zMS4wNjggLTE1LjA3NykiIGZpbGw9IiMyNTJjODIiLz4NCiAgICA8ZyBpZD0iXzE5IiBkYXRhLW5hbWU9IjE5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1My45MzIgNTQuNTI2KSI+DQogICAgICA8cGF0aCBpZD0iUGF0aF80NzcxIiBkYXRhLW5hbWU9IlBhdGggNDc3MSIgZD0iTTE0LjU4OSwyOS4xNzhBMTQuNTg5LDE0LjU4OSwwLDEsMSwyOS4xNzgsMTQuNTg5LDE0LjU4OSwxNC41ODksMCwwLDEsMTQuNTg5LDI5LjE3OFptMC0yNy4zNTRBMTIuNzY1LDEyLjc2NSwwLDEsMCwyNy4zNTQsMTQuNTg5LDEyLjc2NSwxMi43NjUsMCwwLDAsMTQuNTg5LDEuODI0WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAwKSIgZmlsbD0iI2ZmNTM1MyIvPg0KICAgICAgPHBhdGggaWQ9IlBhdGhfNDc3MiIgZGF0YS1uYW1lPSJQYXRoIDQ3NzIiIGQ9Ik0xMi41OSwxMS4yOWw1LjcyNi01Ljc0NEEuOS45LDAsMSwwLDE3LjA0LDQuMjY5TDExLjMsMTAsNS41NTEsNC4yNjlBLjkuOSwwLDEsMCw0LjI3NSw1LjU0NkwxMCwxMS4yOSw0LjI3NSwxNy4wMzVhLjkuOSwwLDEsMCwxLjI3NywxLjI3N0wxMS4zLDEyLjU4NWw1Ljc0NCw1LjcyNmEuOS45LDAsMSwwLDEuMjc3LTEuMjc3WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMy4yOTMgMy4yOTkpIiBmaWxsPSIjZmY1MzUzIi8+DQogICAgPC9nPg0KICA8L2c+DQo8L3N2Zz4NCg==",Ise="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2Ny4zNyIgaGVpZ2h0PSI1MS40ODQiIHZpZXdCb3g9IjAgMCA2Ny4zNyA1MS40ODQiPg0KICA8ZyBpZD0iZmFjZV94IiBkYXRhLW5hbWU9ImZhY2UgeCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE1MiAtNzMpIj4NCiAgICA8ZyBpZD0iZmFjZS1zY2FuIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTIgNzMpIj4NCiAgICAgIDxwYXRoIGlkPSJQYXRoXzQ3ODMiIGRhdGEtbmFtZT0iUGF0aCA0NzgzIiBkPSJNNC44NTUsMTkuNzU4QTEuMzU1LDEuMzU1LDAsMCwwLDYuMjEsMTguNFYxMC4yNzVBNC4wNjksNC4wNjksMCwwLDEsMTAuMjc0LDYuMjFIMTguNGExLjM1NSwxLjM1NSwwLDAsMCwwLTIuNzFIMTAuMjc0QTYuNzgyLDYuNzgyLDAsMCwwLDMuNSwxMC4yNzVWMTguNGExLjM1NSwxLjM1NSwwLDAsMCwxLjM1NSwxLjM1NVoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zLjUgLTMuNSkiIGZpbGw9IiMyNTJjODIiLz4NCiAgICAgIDxwYXRoIGlkPSJQYXRoXzQ3ODQiIGRhdGEtbmFtZT0iUGF0aCA0Nzg0IiBkPSJNMy41LDUxLjk4NGE2Ljc4Miw2Ljc4MiwwLDAsMCw2Ljc3NCw2Ljc3NEgxOC40YTEuMzU1LDEuMzU1LDAsMSwwLDAtMi43MUgxMC4yNzRBNC4wNjksNC4wNjksMCwwLDEsNi4yMSw1MS45ODRWNDMuODU1YTEuMzU1LDEuMzU1LDAsMCwwLTIuNzEsMFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zLjUgLTcuMjc1KSIgZmlsbD0iIzI1MmM4MiIvPg0KICAgICAgPHBhdGggaWQ9IlBhdGhfNDc4NSIgZGF0YS1uYW1lPSJQYXRoIDQ3ODUiIGQ9Ik01Ni4wNDgsNDguODg2djMuNjYyYTQuMDY5LDQuMDY5LDAsMCwxLTQuMDY0LDQuMDY0SDQzLjg1NWExLjM1NSwxLjM1NSwwLDAsMCwwLDIuNzFoOC4xMjlhNi43ODIsNi43ODIsMCwwLDAsNi43NzQtNi43NzRWNDguODg2QzU4Ljc1OCw0OC4xMzgsNTYuMDQ5LDQ4LjEzOCw1Ni4wNDgsNDguODg2WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTcuMjc0IC03LjgzOSkiIGZpbGw9IiMyNTJjODIiLz4NCiAgICAgIDxwYXRoIGlkPSJQYXRoXzQ3ODYiIGRhdGEtbmFtZT0iUGF0aCA0Nzg2IiBkPSJNNTEuOTg0LDMuNUg0My44NTVhMS4zNTUsMS4zNTUsMCwwLDAsMCwyLjcxaDguMTI5YTQuMDY5LDQuMDY5LDAsMCwxLDQuMDY0LDQuMDY0bC4wOCw0LjExOWMwLC43NDgsMi41OTEuMjY4LDIuNTkxLjI2OGwuMDM4LTQuMzg3QTYuNzgyLDYuNzgyLDAsMCwwLDUxLjk4NCwzLjVaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNy4yNzQgLTMuNSkiIGZpbGw9IiMyNTJjODIiLz4NCiAgICAgIDxwYXRoIGlkPSJQYXRoXzQ3ODciIGRhdGEtbmFtZT0iUGF0aCA0Nzg3IiBkPSJNMzguODE0LDI0LjdhOC4zNjYsOC4zNjYsMCwwLDAtOC41MDctOC40ODZjLTcuNjMxLS4xNzUtMTEuNzI3LDkuNzctNS4zNzIsMTUuMDQyQzE5LjUwNSwzMi43NjksMTQuODE4LDM2LjY3MSwxNC41LDQzLjMxYTEuMzU1LDEuMzU1LDAsMSwwLDIuNzA2LjEyOWMuMzM1LTcuMDEyLDcuMDI1LTEwLjIsMTMuMS0xMC4yczEyLjc2NSwzLjE5NSwxMy4xLDEwLjJhMS4zNTUsMS4zNTUsMCwxLDAsMi43MDYtLjEyOWMtLjMxNC02LjYzOC01LTEwLjU0LTEwLjQzMy0xMi4wNTJBOC40MDcsOC40MDcsMCwwLDAsMzguODE0LDI0LjdaTTMwLjMwNiwzMC40YTUuNTc4LDUuNTc4LDAsMCwxLTUuOC01LjY5NSw1LjgsNS44LDAsMCwxLDExLjYtLjA0Miw1LjU5NCw1LjU5NCwwLDAsMS01LjgsNS43MzZaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNC41NjUgLTQuNzMxKSIgZmlsbD0iIzI1MmM4MiIvPg0KICAgIDwvZz4NCiAgICA8ZyBpZD0iXzE5IiBkYXRhLW5hbWU9IjE5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOTMuMDE2IDg1LjU2NSkiPg0KICAgICAgPHBhdGggaWQ9IlBhdGhfNDc3MSIgZGF0YS1uYW1lPSJQYXRoIDQ3NzEiIGQ9Ik0xMy4xNzcsMjYuMzU0QTEzLjE3NywxMy4xNzcsMCwxLDEsMjYuMzU0LDEzLjE3NywxMy4xNzcsMTMuMTc3LDAsMCwxLDEzLjE3NywyNi4zNTRabTAtMjQuNzA3YTExLjUzLDExLjUzLDAsMSwwLDExLjUzLDExLjUzLDExLjUzLDExLjUzLDAsMCwwLTExLjUzLTExLjUzWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAwKSIgZmlsbD0iI2ZmNTM1MyIvPg0KICAgICAgPHBhdGggaWQ9IlBhdGhfNDc3MiIgZGF0YS1uYW1lPSJQYXRoIDQ3NzIiIGQ9Ik0xMS43NTksMTAuNTg1LDE2LjkzMSw1LjRhLjgxNS44MTUsMCwxLDAtMS4xNTMtMS4xNTNMMTAuNTg5LDkuNDE2LDUuNCw0LjI0NEEuODE1LjgxNSwwLDAsMCw0LjI0OCw1LjRMOS40MiwxMC41ODUsNC4yNDgsMTUuNzc0QS44MTUuODE1LDAsMSwwLDUuNCwxNi45MjdsNS4xODgtNS4xNzIsNS4xODgsNS4xNzJhLjgxNS44MTUsMCwxLDAsMS4xNTMtMS4xNTNaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyLjU4OCAyLjU5MikiIGZpbGw9IiNmZjUzNTMiLz4NCiAgICA8L2c+DQogIDwvZz4NCjwvc3ZnPg0K",Nse="",qhe=(()=>{let p=class{constructor(v){ll(this,v),this.eventCaptureErrorDone=ps(this,"captureErrorDone")}componentWillLoad(){return ce(this,null,function*(){this.translations=yield vd.getValues(),this.modal=!1,this.buttonEnabled=!1,this.type=="ID"&&(this.titleR1=this.translations.IdCaptureValues.ErrorTitleR1,this.titleR2=this.translations.IdCaptureValues.ErrorTitleR2,this.descriptionR1=this.translations.IdCaptureValues.ErrorR1,this.descriptionR2=this.translations.IdCaptureValues.ErrorR2),this.type=="LIVENESS"&&(this.titleR1=this.translations.SelfieCaptureValues.ErrorTitleR1,this.titleR2=this.translations.SelfieCaptureValues.ErrorTitleR2,this.descriptionR1=this.translations.SelfieCaptureValues.ErrorR1,this.descriptionR2=this.translations.SelfieCaptureValues.ErrorR2)})}componentDidLoad(){return ce(this,null,function*(){yield dl.logStep(Ns.CiError,hg.Initialized);for(let v=5;v>=1;v--)this.buttonText=v.toString(),yield tp(1e3);this.buttonText=this.translations.IdCaptureValues.Button,this.buttonEnabled=!0})}buttonClick(){return ce(this,null,function*(){if(this.buttonEnabled=!1,yield dl.logStep(Ns.CiError,hg.Finalized),this.reason=="Upload Failed"){var v=yield Qa.instance.GetNextStateForCaptureError();Xe.flowStatus=v}else if(this.reason=="Invalid"&&Xe.flowStatus==aa.IDBACK){var v=yield Qa.instance.GetNextStateForCaptureError();Xe.flowStatus=v}this.eventCaptureErrorDone.emit()})}infoClick(){return ce(this,null,function*(){this.modal=!0})}render(){return He("div",{key:"349d7fa03a02951b62722f587305f41a4e1822d5",class:"container flex center"},He("div",{key:"69347f4e7f7b79b21a873b2c6b233bb3812c8d38",hidden:!this.modal,class:"modal flex center w-100"},He("div",{key:"d6bfa730ab7f5e9de1737647ff9a41fd05317b1a",class:"inner w-100 text-center mx-1"},He("img",{key:"10ace42445eed8729731fe4428b6ebe11b4e3bb5",class:"close-modal",src:M$t,onClick:()=>this.modal=!1}),He("img",{key:"51821b42f04de47aa3d291d8bce53e99cdf43c60",src:Put}),He("h2",{key:"c97a89e8b991d9947ce89a1e44f1975ae020642e",class:"loud-text color-blue mb-1"},He("strong",{key:"732bd2e0e71e8d4087b0b95537689d075e751baf"},this.titleR2)),He("div",{key:"5436c6d47968a2d3830fd6242e2fbf1bdd3f7ef1",class:"color-blue checklist loud-text",innerHTML:this.descriptionR2}))),He("div",{key:"c2da9164c0fa361e4a77b6422dbad7c58d831aab",class:"px-3 text-center"},He("img",{key:"ea4faa250945d5ef5c3de281e4e4db10f2b983bf",class:"mb-1 ml-1",src:this.type=="ID"?Ase:Ise}),He("h1",{key:"d811c92d3012c6e6bf597de94096556ea9a53ea4",class:"color-red mb-2",innerHTML:this.titleR1}),He("div",{key:"a8ff782d5b94c0e84c1746de13752900df266f97",class:"color-blue mb-2 loud-text",innerHTML:this.descriptionR1}),He("p",{key:"a76e03a0048f4d5e8b3a88053adb54df00cd1d81",class:"flex center mb-3",onClick:()=>this.infoClick()},He("strong",{key:"4406c5c81501829735231786ea830695d529dd2f",class:"color-blue loud-text"},this.translations.CameraErrorValues.Info)," \xA0\xA0",He("img",{key:"287f1d9cdb1f02c29ede72b9a96e80df66d991d8",src:Put})),Xe.debug?He("p",{class:"font-size-1"},`${this.reason} ${this.error}`):null,He("div",{key:"4c21add72c6fb20ce0fe0ea8732036d963b090dd",class:"button flex"},He("button",{key:"637a6b53ccb431663d5cec1a032cb5de9bcdc98f",class:"main-button",type:"button",disabled:!this.buttonEnabled,onClick:()=>this.buttonClick()},this.buttonText)),He("div",{key:"74645fc1e15e7de1b66dec2da8fd3032ec4bdca9",class:"footer text-center"},He("img",{key:"7afb2ed0b8f0369dee1fbe3072bfde656d263513",src:Cd}))))}};return p.style=Nse,p})(),Mse="",Xhe=(()=>{let p=class{constructor(v){ll(this,v),this.apiErrorEvent=ps(this,"apiError"),this.canCancel=!0,this.selected=null,this.citizenships=[],this.imgClass="cit-selector"}componentWillLoad(){return ce(this,null,function*(){this.ectData=yield qu.ectdata.get(Xe.requestId)})}componentWillRender(){return ce(this,null,function*(){this.translations=yield vd.getValues(),Xe.device.isDesktop&&(this.imgClass="cit-selector-desktop"),Xe.showCitizenshipSelector?this.citizenships=yield Qa.instance.GetCitizenshipList():Xe.citizenship&&Xe.citizenship!=""?yield this.citizenshipSelected(Xe.citizenship):Xe.flowStatus=yield Qa.instance.GetNextFlowState()})}doAction(){return ce(this,null,function*(){if(this.canCancel){this.canCancel=!1;try{let v=yield Qa.instance.AbortRequest();Xe.flowStatus=aa[v.state],yield qu.ectdata.delete(Xe.requestId),hh.flowAborted()}catch(v){hh.flowAborted(),this.apiErrorEvent.emit(v)}}})}setCitizenship(v){return ce(this,null,function*(){this.selected=v,this.citizenshipSelected(v.name)})}citizenshipSelected(v){return ce(this,null,function*(){if(this.canCancel){this.canCancel=!1,Xe.citizenship=v,this.ectData||(yield tp(500),this.ectData||(this.ectData=yield qu.ectdata.get(Xe.requestId))),this.ectData.citizenship=v,qu.ectdata.put(this.ectData);try{yield Qa.instance.SetCitizenship()}catch(k){this.apiErrorEvent.emit(k)}}})}render(){return He("div",{key:"3f258ffcfd6825c5b119d0749336e3ffd58181d9",class:"container flex center"},He("div",{key:"75fd30c4dd64df5e89483f53f7d216a228f3b368",class:"px-3"},He("h1",{key:"82fcb7ed0fbd48c4dbcf9e6c9d5e93ed11f7fa13",class:"text-center"},this.translations.CitizenshipSelectionValues.Title),He("p",{key:"586e7f99106e5c775eeae2de7048c46e3a7e123b",class:"loud-text color-blue text-center"},this.translations.CitizenshipSelectionValues.Description),He("div",{key:"690ead382ac1eaefe830d27987ca9044699640da",class:"py-1"},this.citizenships.map(v=>{var k;return He("div",{class:"d-flex center mb-1",onClick:()=>this.setCitizenship(v)},He("h3",null,v.name),He("div",{class:this.imgClass+" relative ml-1"},((k=this.selected)===null||k===void 0?void 0:k.name)==v.name?He("div",{class:"img-loader rounded w-100 h-100 flex center"},He("img",{class:"loading-image",src:gw})):null,He("img",{class:"rounded d-block w-100",src:v.image})))})),He("div",{key:"bf310e7a30fab061d42d203aa7af5b5705e6f4ff",class:"text-center"},He("p",{key:"9e8f26fd0c46e78c5663da35969b2b575d12e233",class:"main-text link-text",onClick:()=>this.doAction()},this.translations.LandingValues.ButtonLeave)),He("div",{key:"6d4b6317f8b95d2575980258693dddbe0a6851c7",class:"footer text-center"},He("img",{key:"5bc044fc7771776ad5b83eca0ecabbb84e3a1a8a",src:Cd}))))}};return p.style=Mse,p})(),Dse="p{font-size:0.8em;color:silver;font-weight:600}",Khe=(()=>{let p=class{constructor(v){ll(this,v),this.apiErrorEvent=ps(this,"apiError")}componentWillLoad(){return ce(this,null,function*(){this.translations=yield vd.getValues()})}componentDidLoad(){return ce(this,null,function*(){yield qu.ectdata.delete(Xe.requestId),hh.flowCompleted()})}render(){return He("div",{key:"aab8b84fd29b32208c808706b1c18a6649490144",class:"container flex center"},He("div",{key:"ca73f63354843588d88d09ff8bfacb4d72d043f0",class:"px-2 w-100"},He("h1",{key:"ba5699b5d6e27110414bae259aeb2cb0760c286a",class:"text-center mb-1"},this.translations.CompleteValues.Title),He("img",{key:"cc18dc13c92afc3bf1105fcfb72d6eade9373645",class:"w-100 mb-1",src:"https://ekyc.blob.core.windows.net/$web/process_complete.gif"}),He("h1",{key:"794eedcd1fcdd2e86b6044af271249c43716d6ba",class:"text-center"},this.translations.CompleteValues.Message),He("p",{key:"b5005472fb27171b3117f806f69ade353a9e25f3",class:"text-center"},Xe.requestId),He("div",{key:"e40ccb761c25843a0cef010f41043d24dd78e53c",class:"footer text-center"},He("img",{key:"42f21e48f223208de01afdae2c91e36ac9f666c2",src:Cd}))))}};return p.style=Dse,p})(),D$t="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OSIgaGVpZ2h0PSI2MC43ODgiIHZpZXdCb3g9IjAgMCA0OSA2MC43ODgiPg0KICA8ZyBpZD0ibW9iaWxlX3Bob25lX3giIGRhdGEtbmFtZT0ibW9iaWxlIHBob25lIHgiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNjIgLTc4LjIxMikiPg0KICAgIDxnIGlkPSJHcm91cF80NjE2IiBkYXRhLW5hbWU9Ikdyb3VwIDQ2MTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYgMykiPg0KICAgICAgPGcgaWQ9Ikdyb3VwXzQ2MTUiIGRhdGEtbmFtZT0iR3JvdXAgNDYxNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTUyKSI+DQogICAgICAgIDxnIGlkPSJHcm91cF80NjE0IiBkYXRhLW5hbWU9Ikdyb3VwIDQ2MTQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MyAtMjY2Ljc4OCkiPg0KICAgICAgICAgIDxwYXRoIGlkPSJQYXRoXzQ3NDYiIGRhdGEtbmFtZT0iUGF0aCA0NzQ2IiBkPSJNMzAuMDQ4LDU1YTEuMDQ4LDEuMDQ4LDAsMSwwLDAsMi4xSDM0LjI0YTEuMDQ4LDEuMDQ4LDAsMSwwLDAtMi4xWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAuNjczIDM0MS41KSIvPg0KICAgICAgICAgIDxwYXRoIGlkPSJQYXRoXzQ3NDgiIGRhdGEtbmFtZT0iUGF0aCA0NzQ4IiBkPSJNMzguMDI5LDkuMDQ4QS45OS45OSwwLDAsMCwzNi45ODEsOEgyNy41NDhBLjk5Ljk5LDAsMCwwLDI2LjUsOS4wNDguOTkuOTksMCwwLDAsMjcuNTQ4LDEwLjFoOS40MzNBLjk5Ljk5LDAsMCwwLDM4LjAyOSw5LjA0OFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwLjU1MyAzMzkuMjQpIiBmaWxsPSIjMjUyYzgyIi8+DQogICAgICAgICAgPGcgaWQ9Ikdyb3VwXzQ2MDciIGRhdGEtbmFtZT0iR3JvdXAgNDYwNyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjUgMzQyKSI+DQogICAgICAgICAgICA8cGF0aCBpZD0iUGF0aF80NzQ3IiBkYXRhLW5hbWU9IlBhdGggNDc0NyIgZD0iTTQ4LjUzOCw5LjE4NGExLjA0OCwxLjA0OCwwLDEsMCwyLjEsMEE2LjI2NCw2LjI2NCwwLDAsMCw0NC40NTEsM0gyMS4xODRBNi4yNjQsNi4yNjQsMCwwLDAsMTUsOS4xODRWNTcuNmE2LjIsNi4yLDAsMCwwLDYuMTg0LDYuMTg0SDQ0LjQ1MUE2LjIsNi4yLDAsMCwwLDUwLjYzNSw1Ny42VjQyLjgyN2ExLjA0OCwxLjA0OCwwLDEsMC0yLjEsMFY1Ny42YTQuMDkzLDQuMDkzLDAsMCwxLTQuMDg3LDQuMDg3SDIxLjE4NEE0LjA5Myw0LjA5MywwLDAsMSwxNy4xLDU3LjZWOS4xODRBNC4xNjIsNC4xNjIsMCwwLDEsMjEuMTg0LDUuMUg0NC40NTFhNC4xNjIsNC4xNjIsMCwwLDEsNC4wODcsNC4wODdaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTUgLTMpIiBmaWxsPSIjMjUyYzgyIi8+DQogICAgICAgICAgPC9nPg0KICAgICAgICA8L2c+DQogICAgICA8L2c+DQogICAgPC9nPg0KICAgIDxnIGlkPSJHcm91cF80NjI0IiBkYXRhLW5hbWU9Ikdyb3VwIDQ2MjQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4My40NzEgODcuNDMzKSI+DQogICAgICA8cGF0aCBpZD0iUGF0aF80NzU4IiBkYXRhLW5hbWU9IlBhdGggNDc1OCIgZD0iTTk2Ljc2NCw3NWExMy43NjQsMTMuNzY0LDAsMSwwLDEzLjc2NCwxMy43NjRBMTMuNzgsMTMuNzgsMCwwLDAsOTYuNzY0LDc1Wm0wLDI1Ljg2YTEyLjEsMTIuMSwwLDEsMSwxMi4xLTEyLjFBMTIuMTA5LDEyLjEwOSwwLDAsMSw5Ni43NjQsMTAwLjg2WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTgzIC03NSkiIGZpbGw9IiNmZjUzNTMiLz4NCiAgICA8L2c+DQogICAgPHBhdGggaWQ9IlBhdGhfNDc3MiIgZGF0YS1uYW1lPSJQYXRoIDQ3NzIiIGQ9Ik0xMi41OSwxMS4yOWw1LjcyNi01Ljc0NEEuOS45LDAsMSwwLDE3LjA0LDQuMjY5TDExLjMsMTAsNS41NTEsNC4yNjlBLjkuOSwwLDEsMCw0LjI3NSw1LjU0NkwxMCwxMS4yOSw0LjI3NSwxNy4wMzVhLjkuOSwwLDEsMCwxLjI3NywxLjI3N0wxMS4zLDEyLjU4NWw1Ljc0NCw1LjcyNmEuOS45LDAsMSwwLDEuMjc3LTEuMjc3WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTg2LjMzOSA5MC4wMTgpIiBmaWxsPSIjZmY1MzUzIi8+DQogIDwvZz4NCjwvc3ZnPg0K",Rse="",Zhe=(()=>{let p=class{constructor(v){ll(this,v)}componentDidLoad(){return ce(this,null,function*(){})}render(){return He("div",{key:"5ddb044d1f4fa5fdd56cc277dea1588c8010d982",class:"container flex center"},He("div",{key:"e55f0e066dfc5abeae232933a0f879cba3e41ac4",class:"px-3"},He("div",{key:"9157d61e330fa852e3030d730bb92ae81a97ab5e",class:"mb-1 ml-1 text-center"},He("img",{key:"a60d337ebcf226318d449a4319906a71a9ab1e92",src:D$t,style:{width:"60px"}})),He("h1",{key:"09d04b65096ee37e13b78db52fc7374b4bd921ef",class:"text-center mb-2"},this.errorTitle),He("div",{key:"8cf7185666b4a5ae432f423aef635a62b114f5cd",class:"text-center mb-4"},He("p",{key:"e9a53896af07aad0f0f9c589db3aea484a3d9ae3"},Xe.requestId)),He("div",{key:"f63a46afbafdd4bebfbd3395ca431ec4197e0ac9"},He("p",{key:"4fd27395d52bac43a3b152c17160285398cdf25e",class:"color-red text-center"},this.message)),He("div",{key:"a30ce34dac10a5cd38578a921293f7a112d5c599",class:"footer text-center"},He("img",{key:"ed707bfd1ad197a4e2df5ae5abce0cf8efbfd16c",src:Cd}))))}};return p.style=Rse,p})(),Fse="",Qhe=(()=>{let p=class{constructor(v){ll(this,v),this.apiErrorEvent=ps(this,"apiError"),this.loadImage=k=>new Promise((N,F)=>{this.image.onload=()=>{this.imageLoaded=!0,N(this.image)},this.image.onerror=F,this.image.src=k})}componentDidLoad(){return ce(this,null,function*(){Xe.flowStatus==aa.IDFRONTHOWTO?(this.imageLoaded=!1,this.currentStep=Ns.CiFrontHowTo,this.topTitle=this.translations.HowToValues.IdFaceTitle,this.subTitle=this.translations.HowToValues.IdFaceSubTitle,this.buttonText=this.translations.HowToValues.IdButton,this.loadImage("https://ekyc.blob.core.windows.net/$web/howto_id.gif")):Xe.flowStatus==aa.IDBACKHOWTO?(this.currentStep=Ns.CiBackHowTo,this.topTitle=this.translations.HowToValues.IdBackTitle,this.subTitle=this.translations.HowToValues.IdBackSubTitle,this.buttonText=this.translations.HowToValues.IdButton,this.loadImage("https://ekyc.blob.core.windows.net/$web/howto_id_back.gif")):Xe.flowStatus==aa.IDTILTHOWTO?(this.imageLoaded=!1,this.currentStep=Ns.CiTiltHowTo,this.topTitle=this.translations.HowToValues.TiltTitle,this.subTitle=this.translations.HowToValues.TiltSubTitle,this.buttonText=this.translations.HowToValues.TiltButton,this.loadImage("https://ekyc.blob.core.windows.net/$web/howto_id_tilt.gif")):Xe.flowStatus==aa.LIVENESSHOWTO&&(this.imageLoaded=!1,this.currentStep=Ns.SelfieHowTo,this.topTitle=this.translations.HowToValues.SelfieTitle,this.subTitle=this.translations.HowToValues.SelfieSubTitle,this.buttonText=this.translations.HowToValues.SelfieButton,this.loadImage("https://ekyc.blob.core.windows.net/$web/howto_selfie.gif")),yield dl.initialize(this.currentStep)})}disconnectedCallback(){return ce(this,null,function*(){yield dl.finalize(this.currentStep)})}buttonClick(){return ce(this,null,function*(){this.buttonEnabled=!1,Xe.flowStatus=yield Qa.instance.GetNextFlowState()})}componentWillLoad(){return ce(this,null,function*(){this.translations=yield vd.getValues(),this.buttonEnabled=!0})}render(){return He("div",{key:"7148240e3af7ff3e33b052660583a9f0f8070ef0",class:"container flex center"},He("div",{key:"0a92afe9ba7d7413be4f989a88d561b98efb5c87",hidden:this.imageLoaded==!1,class:"px-2 w-100"},He("h1",{key:"a3e17693aba73b1bf8ab4ecf28dec2db25624f3f",class:"text-center px-1 mb-1",innerHTML:this.topTitle}),He("div",{key:"b1ce3e5fb75af0017c936da434dbd0998ac16e6f",class:"mb-1"},He("img",{key:"e07adc4ae239ec8b2b297cc1b5daa3d3e4175aa3",class:"w-100",ref:k=>this.image=k})),He("div",{key:"49322825ea16b96f0350c6866ac20a86aec6cab3",class:"button flex mb-1"},this.buttonEnabled?null:He("div",{class:"img-loader rounded img-loader-button"},He("img",{class:"loading-image loading-image-button",src:gw})),He("button",{key:"d91867f3c1e4b1d271e9c21b597e4635df4e041c",class:"main-button",type:"button",disabled:!this.buttonEnabled,onClick:()=>this.buttonClick()},this.buttonText)),He("div",{key:"567f4ac6f56ab7cc37ed26c27f82abfb61180920",class:"footer text-center"},He("img",{key:"05055f45486d2ffe1c8b93198b96e33890bc85ca",src:Cd}))))}};return p.style=Fse,p})(),A8=class p{static GetCameras(v){return ce(this,null,function*(){var k=[];let F=(yield navigator.mediaDevices.enumerateDevices()).filter(O=>O.kind==="videoinput");for(let O of F){let S=this.GetConstraints(O.deviceId,v,!1,!1),B=yield navigator.mediaDevices.getUserMedia(S);B.getVideoTracks().forEach(j=>{var K,Z;if(v.browser===Xk.Firefox){let Y=j.getSettings(),X=Y.facingMode&&Y.facingMode.length>0?Y.facingMode[0]:"";X=X==="e"?"environment":X,X=X==="u"?"user":X,k.push({deviceId:O.deviceId,name:O.label,height:Y.height,width:Y.width,frameRate:Number(Y.frameRate.max),focusModes:(K=Y.focusMode)!==null&&K!==void 0?K:[],torch:!1,recommended:!1,facingMode:X})}else{let Y=j.getCapabilities(),X=Y.facingMode&&Y.facingMode.length>0?Y.facingMode[0]:"";X=X==="e"?"environment":X,X=X==="u"?"user":X,k.push({deviceId:O.deviceId,name:O.label,height:Y.height.max,width:Y.width.max,frameRate:Number(Y.frameRate.max),focusModes:(Z=Y.focusMode)!==null&&Z!==void 0?Z:[],torch:Y.torch,recommended:!1,facingMode:X})}}),B.getTracks().forEach(j=>{j.stop()})}if(v.isAppleDevice&&(navigator.audioSession.type="playback"),k.length>0){k=k.sort((O,S)=>S.frameRate-O.frameRate);var W=k.find(O=>O.focusModes.length>1&&O.facingMode==="environment");if(W)k[k.indexOf(W)].recommended=!0;else{var L=k.find(O=>O.facingMode==="environment");L&&(k[k.indexOf(L)].recommended=!0)}}return k})}static GetConstraints(v,k,N=!1,F=!1){let W={audio:F},L={frameRate:30};return v&&(L.deviceId={exact:v}),k.isDesktop?L.width={ideal:1280}:(L.facingMode="user",N?L.width={ideal:720}:(L.facingMode="environment",L.width={ideal:1280},L.aspectRatio=9/16)),W.video=L,W}static GetRecommendedCamera(v){if(v&&v.length>0){var k=v.find(N=>N.recommended);if(k)return k}return null}static InitCameras(v){return ce(this,null,function*(){Xe.debug&&console.log("cameras | initCameras");try{let N=yield p.GetCameras(v);Xe.debug&&(console.log(`cameras | initCameras | cameras: ${JSON.stringify(N)}`),yield Qa.instance.AddLog("cameras",N));let F=N.filter(W=>W.facingMode=="environment");var k=p.GetRecommendedCamera(F);return Xe.cameraIds=F.map(W=>W.deviceId),Xe.cameraId=k?.deviceId,!0}catch(N){if(console.log(N),N.message.includes("Permission denied")||N.name.includes("NotAllowedError"))return!1;throw N}})}static switchCamera(){let v=Xe.cameraIds.indexOf(Xe.cameraId),k=v===Xe.cameraIds.length-1?Xe.cameraIds[0]:Xe.cameraIds[v+1];Xe.cameraId==k?Xe.cameraId=null:Xe.cameraId=k}},Ose=".logo{max-height:450px;max-width:450px}.canvas-on-video{max-width:100%;max-height:100%;position:absolute;z-index:2;transform:scale(-1, 1)}",Jhe=(()=>{let p=class{constructor(v){ll(this,v),this.eventPhotoCapture=ps(this,"photoIdCapture"),this.apiErrorEvent=ps(this,"apiError"),this.titleRed="text-center px-1 mb-2 color-red pulsate",this.titleNonRed="text-center px-1 mb-2",this.verified=!1,this.showDemo=!1}eventVideoStarted(v){this.videoStarted=!0,this.cameraSize=v.detail}infoTimeElapsed(){this.titleStyle=this.titleNonRed,this.titleMesage=this.translations.IdCaptureValues.IDPoseMappingMore}infoFullDetected(){this.titleStyle=this.titleNonRed,this.titleMesage=this.translations.IdCaptureValues.IDPoseMappingFull}infoNoneDetected(){this.titleStyle=this.titleRed,this.titleMesage=this.translations.IdCaptureValues.IDPoseMapping}componentWillLoad(){return ce(this,null,function*(){Xe.debug&&console.log("id-capture | componentWillLoad"),this.translations=yield vd.getValues(),navigator.mediaDevices||this.apiErrorEvent.emit({message:"This browser does not support webRTC"}),this.titleStyle="text-center px-1 mb-2"})}initVariables(){Xe.debug&&console.log("id-capture | initVariables"),Xe.flowStatus==aa.IDFRONT?(this.flowStep=Ns.CiFrontCapture,this.titleMesage=this.translations.IdCaptureValues.Title,this.verificationMode=t2.Full):Xe.flowStatus==aa.IDBACK?(this.flowStep=Ns.CiBackCapture,this.titleMesage=this.translations.IdCaptureValues.TitleBack,this.verificationMode=t2.Full):Xe.flowStatus==aa.IDTILT&&(this.titleMesage=this.translations.IdCaptureValues.IDPoseMapping,this.flowStep=Ns.CiTilt,this.verificationMode=t2.Tilt)}componentDidLoad(){return ce(this,null,function*(){Xe.debug&&console.log("id-capture | componentDidLoad"),this.initVariables(),yield dl.logStep(this.flowStep,hg.Initialized),this.openCamera()})}openCamera(){return ce(this,null,function*(){Xe.debug&&console.log("id-capture | openCamera"),Xe.cameraId||(yield A8.InitCameras(Xe.device));let v=A8.GetConstraints(Xe.cameraId,Xe.device);setTimeout(()=>{Xe.device.isAppleDevice&&(navigator.audioSession.type="play-and-record"),navigator.mediaDevices.getUserMedia(v).then(k=>{Xe.debug&&console.log("id-capture | openCamera | streamObtained"),Xf.getNewInstance(this.verificationMode).initStream(k)}).catch(k=>{this.closeCamera(),this.apiErrorEvent.emit(k)})},100)})}closeCamera(){Xe.debug&&console.log("id-capture | closeCamera"),Xf.instance&&Xf.instance.dropStream(),Xe.device.isAppleDevice&&(navigator.audioSession.type="playback")}disconnectedCallback(){this.closeCamera(),Xf.instance=null,Xe.debug&&console.log("id-capture | disconnectedCallback")}takePhoto(){return ce(this,null,function*(){Xe.debug&&console.log("id-capture | takePhoto"),Xe.debug&&console.log("id-capture | takePhoto | sendingPhoto");let v=yield Xf.instance.takePhoto();this.eventPhotoCapture.emit(v),yield dl.logStep(this.flowStep,hg.Finalized)})}verificationFinished(){return ce(this,null,function*(){Xe.debug&&console.log("id-capture | verificationFinished"),!this.verified&&(this.verified=!0,this.closeCamera(),Xe.flowStatus=yield Qa.instance.GetNextFlowState())})}render(){let v;return this.videoStarted&&Xe.debug&&console.log(this.cameraSize),He("div",{key:"afaa7bd12f21a134d3290d466b4a2dc74c0875f9",class:"container flex center"},He("div",{key:"ed7952792f06bcf83eca981fc2f3f127534be57c",class:"px-2 w-100"},He("h1",{key:"7066346670dc14cd199aeca659deaa21058e55af",class:this.titleStyle,innerHTML:this.titleMesage}),He("div",{key:"004c34dfdabb1c46d7efe01b8c1e9f6a5fb85613",hidden:this.showDemo||this.verified},He("div",{key:"f2992dc6a5ad77b02dfdfd7c455283a7c8aeb18d",style:v},He("camera-comp",{key:"60899e08daef8893d1e94b02e16aab3ab7c65bca","capture-mode":"id"}))),He("div",{key:"7b3428aeb4727d12018883c562bfd57c3e156071",class:"footer text-center"},He("img",{key:"363f6855f90e2cd14e73cad88918d29e1d753c94",src:Cd}))))}get component(){return HW(this)}};return p.style=Ose,p})(),tde=class{constructor(p){ll(this,p),this.idCaptureConfirmation=ps(this,"idCaptureConfirmation"),this.idCaptureRetry=ps(this,"idCaptureRetry")}componentWillLoad(){return ce(this,null,function*(){this.translations=yield vd.getValues(),this.image=yield MD(this.capture)})}componentDidLoad(){return ce(this,null,function*(){})}confirm(){this.idCaptureConfirmation.emit()}retry(){this.idCaptureRetry.emit()}render(){return He("div",{key:"2f1a1a0d629434755581f9c23fcedb5534b71439",class:"container flex center"},He("div",{key:"b65b3f62e7848648f3d7f31fcd17c0b286005ab8",class:"px-2 w-100"},He("h1",{key:"d429c2de2298501e26eb7d438a2df385cfe175ac",class:"text-center px-1 mb-2",innerHTML:this.translations.IdCaptureConfirmValues.Title}),He("div",{key:"904e7893e3b92763ab71ea1ae040aa1a5fcb64ac",class:"mb-3"},He("img",{key:"d2d678f5320a9bcdc020b93e179361dc8df2a0f8",class:"w-100 rounded",src:this.image})),He("div",{key:"73ba6dfd7467a5c9351aebdbcf655cdb56914524",class:"button flex mb-1 mx-3"},He("button",{key:"61b4a4885b60250bb45ba37ba08ac7db172a2dbe",class:"main-button",type:"button",onClick:()=>this.confirm()},this.translations.IdCaptureConfirmValues.Confirm)),He("div",{key:"58888a6f50b54b68aa896cb784f4d4b77e43b40e",class:"text-center"},He("p",{key:"1c0835285aec567af9ed31e45fbebb9888f55d15",class:"main-text link-text",onClick:()=>this.retry()},this.translations.IdCaptureConfirmValues.Retry)),He("div",{key:"c1ecc24a23bd309a7f14642b3782a1d8d53492e9",class:"footer text-center"},He("img",{key:"4d363f6a76b20abfae784a699d1fcbd120dd980f",src:Cd}))))}get component(){return HW(this)}},R$t="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1Mi4yOTIiIGhlaWdodD0iNDMuODU4IiB2aWV3Qm94PSIwIDAgNTIuMjkyIDQzLjg1OCI+DQogIDxnIGlkPSJpZC1jYXJkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTcgLTI5KSI+DQogICAgPHBhdGggaWQ9IlBhdGhfNDc1MSIgZGF0YS1uYW1lPSJQYXRoIDQ3NTEiIGQ9Ik0yMC4zNzQsNjYuOTU0aDIyLjM1YS44NDMuODQzLDAsMCwwLDAtMS42ODdIMjAuMzc0YTEuNjg5LDEuNjg5LDAsMCwxLTEuNjg3LTEuNjg3VjMyLjM3NGExLjY4OSwxLjY4OSwwLDAsMSwxLjY4Ny0xLjY4N0g2NS45MThBMS42ODksMS42ODksMCwwLDEsNjcuNiwzMi4zNzRWNDkuMjQyYS44NDMuODQzLDAsMCwwLDEuNjg3LDBWMzIuMzc0QTMuMzc4LDMuMzc4LDAsMCwwLDY1LjkxOCwyOUgyMC4zNzRBMy4zNzgsMy4zNzgsMCwwLDAsMTcsMzIuMzc0VjYzLjU4QTMuMzc4LDMuMzc4LDAsMCwwLDIwLjM3NCw2Ni45NTRaIiBmaWxsPSIjMjUyYzgyIi8+DQogICAgPHBhdGggaWQ9IlBhdGhfNDc1MiIgZGF0YS1uYW1lPSJQYXRoIDQ3NTIiIGQ9Ik01MC42NTEsNTAuMzI2YTYuMzI2LDYuMzI2LDAsMSwwLTYuMzI2LDYuMzI2QTYuMzMzLDYuMzMzLDAsMCwwLDUwLjY1MSw1MC4zMjZabS0xMC45NjQsMGE0LjYzOSw0LjYzOSwwLDEsMSw0LjYzOSw0LjYzOUE0LjY0NCw0LjY0NCwwLDAsMSwzOS42ODcsNTAuMzI2WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyLjE0NCAtOC42NzQpIiBmaWxsPSIjMjUyYzgyIi8+DQogICAgPHBhdGggaWQ9IlBhdGhfNDc1MyIgZGF0YS1uYW1lPSJQYXRoIDQ3NTMiIGQ9Ik0zMiw4NC43NDd2My4zNzRhLjg0NC44NDQsMCwwLDAsLjg0My44NDNINDguODY4YS44NDQuODQ0LDAsMCwwLC44NDMtLjg0M1Y4NC43NDdBNi43NTUsNi43NTUsMCwwLDAsNDIuOTY0LDc4SDM4Ljc0N0E2Ljc1NSw2Ljc1NSwwLDAsMCwzMiw4NC43NDdabTYuNzQ3LTUuMDZoNC4yMTdhNS4wNjYsNS4wNjYsMCwwLDEsNS4wNiw1LjA2djIuNTNIMzMuNjg3di0yLjUzQTUuMDY2LDUuMDY2LDAsMCwxLDM4Ljc0Nyw3OS42ODdaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtOC42NzQgLTI4LjMzNikiIGZpbGw9IiMyNTJjODIiLz4NCiAgICA8cGF0aCBpZD0iUGF0aF80NzU0IiBkYXRhLW5hbWU9IlBhdGggNDc1NCIgZD0iTTEwMi43MTIsNDhIODUuODQzYS44NDMuODQzLDAsMCwwLDAsMS42ODdoMTYuODY4YS44NDMuODQzLDAsMCwwLDAtMS42ODdaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzkuMzI0IC0xMC45ODgpIiBmaWxsPSIjMjUyYzgyIi8+DQogICAgPHBhdGggaWQ9IlBhdGhfNDc1NSIgZGF0YS1uYW1lPSJQYXRoIDQ3NTUiIGQ9Ik0xMDIuNzEyLDYySDg1Ljg0M2EuODQzLjg0MywwLDEsMCwwLDEuNjg3aDE2Ljg2OGEuODQzLjg0MywwLDAsMCwwLTEuNjg3WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTM5LjMyNCAtMTkuMDg0KSIgZmlsbD0iIzI1MmM4MiIvPg0KICAgIDxwYXRoIGlkPSJQYXRoXzQ3NTYiIGRhdGEtbmFtZT0iUGF0aCA0NzU2IiBkPSJNOTUuMjI5LDc1YTEyLjIzLDEyLjIzLDAsMSwwLDEyLjIzLDEyLjIzQTEyLjI0NCwxMi4yNDQsMCwwLDAsOTUuMjI5LDc1Wm0wLDIyLjk3N0ExMC43NDcsMTAuNzQ3LDAsMSwxLDEwNS45NzcsODcuMjMsMTAuNzU5LDEwLjc1OSwwLDAsMSw5NS4yMjksOTcuOTc3WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTM4LjE2NyAtMjYuNjAyKSIgZmlsbD0iIzI1MmM4MiIvPg0KICAgIDxwYXRoIGlkPSJQYXRoXzQ3NTciIGRhdGEtbmFtZT0iUGF0aCA0NzU3IiBkPSJNMTExLjA1OSw5OC43MTdsLTcuNDQ0LDcuNDQzLTQuODUtNC44NDlhLjc0MS43NDEsMCwwLDAtMS4wNDgsMS4wNDhsNS4zNzQsNS4zNzRhLjc0MS43NDEsMCwwLDAsMS4wNDgsMGw3Ljk2OC03Ljk2OGEuNzQxLjc0MSwwLDAsMC0xLjA0OC0xLjA0OFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC00Ny4yOTQgLTQxLjM5MykiIGZpbGw9IiM3YmI0MGYiLz4NCiAgPC9nPg0KPC9zdmc+DQo=",Lse="",ede=(()=>{let p=class{constructor(v){ll(this,v),this.apiErrorEvent=ps(this,"apiError"),this.selected=null}componentWillRender(){return ce(this,null,function*(){this.translations=yield vd.getValues(),this.ids=yield Qa.instance.GetIdList()})}idSelected(v){return ce(this,null,function*(){if(!this.selected){this.selected=v,Xe.idDocument=v.name;try{yield Qa.instance.SetIdentityDocument()}catch(k){this.apiErrorEvent.emit(k)}}})}render(){return He("div",{key:"b4d56340efdcb967d006a47184ac8bed0afd56b2",class:"container flex center"},He("div",{key:"9bf3de75680135d1e937d9a239fc5b7cf06c3ba8",class:"px-3"},He("div",{key:"6483f08e7d0ece32b3aeddb0f2e14132ed09badd",class:"mb-1 ml-1 text-center"},He("img",{key:"9d2c15ed669d71be812752823fea922b998c7083",src:R$t,style:{width:"70px"}})),He("h1",{key:"ea86923562e71482fcfcd71c091e17f7404831de",class:"text-center mb-1"},this.translations.IdSelectionValues.Title),He("div",{key:"700e5dba2789f8a5541509aa2b9ae5495abf5962",class:this.ids.length==3?"px-3":"px-2"},this.ids.map(v=>{var k;return He("div",{class:"flex center relative mb-1"},((k=this.selected)===null||k===void 0?void 0:k.name)==v.name?He("div",{class:"img-loader rounded w-100 h-100 flex center"},He("img",{class:"loading-image",src:gw})):null,He("img",{class:"w-100 rounded",src:v.image,alt:v.image,onClick:()=>this.idSelected(v)}))})),He("div",{key:"efdd90c86349f9cac618d00093c3433ea6ef8c8d",class:"footer text-center"},He("img",{key:"b83ff286338205d0f27e696d00b89b743f929adf",src:Cd}))))}};return p.style=Lse,p})(),$se="4.7.86",zse={version:$se},u4t=class{constructor(){var v,k,N,F;this.motionValues=[],this.orientationValues=[],this.addItemsToOrientation=W=>{this.orientationValues.push({beta:W.beta,gamma:W.gamma}),this.orientationValues.length>5&&window.removeEventListener("deviceorientation",this.addItemsToOrientation)},this.addItemsToMotion=W=>{this.motionValues.push({x:W.acceleration.x,y:W.acceleration.y}),this.motionValues.length>5&&window.removeEventListener("devicemotion",this.addItemsToMotion)},this.supportedScreenOrientation=(k=(v=(screen?.orientation||{}).type)!==null&&v!==void 0?v:screen.mozOrientation)!==null&&k!==void 0?k:screen.msOrientation,this.safariScreenOrientation=!screen?.orientation&&matchMedia("(orientation: portrait)").matches?"portrait-primary":"landscape-primary",this.initialScreenOrientation=(F=(N=this.supportedScreenOrientation)!==null&&N!==void 0?N:this.safariScreenOrientation)!==null&&F!==void 0?F:"portrait-primary",this.userAgent=navigator.userAgent||navigator.vendor||window.opera||void 0,this.isMobile=this.isMobileDevice(),this.isTablet=this.isTabletDevice(),this.isDesktop=!this.isMobile&&!this.isTablet}isMobileDevice(){return[/(Android)(.+)(Mobile)/i,/BlackBerry/i,/iPhone|iPod/i,/Opera Mini/i,/IEMobile/i].some(k=>this.userAgent.match(k))}isTabletDevice(){return/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(this.userAgent.toLowerCase())}getMobileOS(){if(this.isMobileDevice())return/windows phone/i.test(this.userAgent)?yg.WindowsPhone:/android/i.test(this.userAgent)?yg.Android:/iPad|iPhone|iPod/.test(this.userAgent)&&!window.MSStream?yg.iOS:yg.Unknown}getDesktopOS(){if(this.isDesktop)return this.userAgent.indexOf("Win")!==-1?Zy.Windows:this.userAgent.indexOf("Mac")!==-1?Zy.MacOS:this.userAgent.indexOf("X11")!==-1?Zy.Unix:this.userAgent.indexOf("Linux")!==-1?Zy.Linux:Zy.Unknown}getDeviceOS(){var v;return(v=this.getMobileOS())!==null&&v!==void 0?v:this.getDesktopOS()}getBrowser(){if(/XiaoMi/i.test(this.userAgent)||/MiuiBrowser/i.test(this.userAgent))return Xk.Mi;var v=/chrome/i.test(this.userAgent);return v?Xk.Chrome:/firefox/i.test(navigator.userAgent)?Xk.Firefox:!v&&/safari/i.test(navigator.userAgent)?Xk.Safari:Xk.Unknown}checkIfMobileBySensors(){return ce(this,null,function*(){var v,k;if(typeof((v=window.DeviceMotionEvent)===null||v===void 0?void 0:v.requestPermission)=="function"){var N=window.DeviceMotionEvent.requestPermission();N==="granted"&&(yield this.getMotionValues())}else yield this.getMotionValues();yield tp(200);var F=!1;if(this.motionValues.length>0&&(F=this.motionValues.filter(L=>L.x!=0).length>=3),typeof((k=window.DeviceOrientationEvent)===null||k===void 0?void 0:k.requestPermission)=="function"){var N=window.DeviceOrientationEvent.requestPermission();N==="granted"&&(yield this.getOrientationValues())}else yield this.getOrientationValues();yield tp(500);var W=!1;return this.orientationValues.length>0&&(W=this.orientationValues.map(L=>L.beta).every((L,O,S)=>O==0?L!==S[S.length-1]:L!==S[O-1])||this.orientationValues.map(L=>L.gamma).every((L,O,S)=>O==0?L!==S[S.length-1]:L!==S[O-1])),F||W})}getOrientationValues(){return ce(this,null,function*(){window.addEventListener("deviceorientation",this.addItemsToOrientation)})}getMotionValues(){return ce(this,null,function*(){window.addEventListener("devicemotion",this.addItemsToMotion)})}getDevice(){return ce(this,null,function*(){var v=yield this.checkIfMobileBySensors(),k={isMobileBySensors:v,isDesktop:this.isDesktop,desktopOS:this.getDesktopOS(),isWindowsDesktop:this.getDeviceOS()===Zy.Windows,isLinuxOrUnixDesktop:this.getDeviceOS()===Zy.Linux||this.getDeviceOS()===Zy.Unix,isMobile:this.isMobile,mobileOS:this.getMobileOS(),isAndroidDevice:this.getDeviceOS()===yg.Android,isAppleDevice:this.getDeviceOS()===yg.iOS||this.getDeviceOS()===Zy.MacOS,isUnknownMobileDevice:this.getDeviceOS()===yg.Unknown,browser:this.getBrowser(),isTablet:this.isTablet,initialScreenOrientation:this.initialScreenOrientation};return k})}},Pse="@font-face{font-family:'Roboto';font-style:normal;font-display:swap;font-weight:100;src:url(./files/roboto-latin-ext-100-normal.woff2) format('woff2'), url(./files/roboto-latin-ext-100-normal.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-display:swap;font-weight:300;src:url(./files/roboto-latin-ext-300-normal.woff2) format('woff2'), url(./files/roboto-latin-ext-300-normal.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-display:swap;font-weight:400;src:url(./files/roboto-latin-ext-400-normal.woff2) format('woff2'), url(./files/roboto-latin-ext-400-normal.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-display:swap;font-weight:500;src:url(./files/roboto-latin-ext-500-normal.woff2) format('woff2'), url(./files/roboto-latin-ext-500-normal.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-display:swap;font-weight:700;src:url(./files/roboto-latin-ext-700-normal.woff2) format('woff2'), url(./files/roboto-latin-ext-700-normal.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-display:swap;font-weight:900;src:url(./files/roboto-latin-ext-900-normal.woff2) format('woff2'), url(./files/roboto-latin-ext-900-normal.woff) format('woff')}*{font-family:'Nexa', sans-serif}[hidden]{visibility:hidden !important;opacity:0 !important}.full{width:100%;height:100%;left:0;top:0}.container{width:100%;height:100%;background-color:white;max-width:991px;margin:auto;position:relative;overflow:hidden}.flex{display:flex}.relative{position:relative}.d-block{display:block}.center{align-items:center;justify-content:center}.footer{position:relative;width:100%;margin-top:5vh;display:none}.w-100{width:100%}.h-100{height:100%}.px-1{padding-left:1em;padding-right:1em}.px-2{padding-left:2em;padding-right:2em}.px-3{padding-left:3em;padding-right:3em}.px-4{padding-left:4em;padding-right:4em}.py-1{padding-top:1em;padding-bottom:1em}.py-2{padding-top:2em;padding-bottom:2em}.py-3{padding-top:3em;padding-bottom:3em}.py-4{padding-top:4em;padding-bottom:4em}.mx-1{margin-left:1em;margin-right:1em}.mx-2{margin-left:2em;margin-right:2em}.mx-3{margin-left:3em;margin-right:3em}.mx-4{margin-left:4em;margin-right:4em}.my-1{margin-top:1em;margin-bottom:1em}.my-2{margin-top:2em;margin-bottom:2em}.my-3{margin-top:3em;margin-bottom:3em}.my-4{margin-top:4em;margin-bottom:4em}.ml-1{margin-left:1em}.ml-2{margin-left:2em}.ml-3{margin-left:3em}.ml-4{margin-left:4em}.mb-05{margin-bottom:0.5em}.mb-1{margin-bottom:1em}.mb-2{margin-bottom:2em}.mb-3{margin-bottom:3em}.mb-4{margin-bottom:4em}.mt-05{margin-top:0.5em}.mt-1{margin-top:1em}.mt-2{margin-top:2em}.mt-3{margin-top:3em}.mt-4{margin-top:4em}h1{color:#252c82;font-size:1.5em;margin:0}h2{font-weight:600;font-size:1.2em;margin:0;color:#525252}h3{font-size:1.4em;margin:0}.main-text{font-weight:400;color:#525252}.link-text{text-decoration:underline;color:#252c82d9}.rounded{border-radius:8px}.cit-selector{width:50%}.img-text{display:flex;align-items:center}.img-text .bg-img{width:4em;height:5em;display:flex;align-items:center;justify-content:center;flex:none;margin-right:1em}.button{position:relative}.img-loader{position:absolute;left:-2px;top:-2px;background:#ffffffc7;border:2px solid #252c82;box-shadow:3px 3px 6px #00000029}.img-loader.rounded{border-radius:11px}.img-loader-button{width:100%;height:100%}.img-loader-button.rounded{border-radius:50px}.loading-image-button{width:100%;height:100%;border-radius:25px}.main-button{background:#40c1ac;border-radius:50px;text-align:center;width:100%;padding:0.9em;color:#fff;border:0;font-size:1.1em;font-weight:600}.main-button:disabled{color:#fff;background:#bdbdbd}.color-red{color:#ff5353}.color-blue{color:#252c82}.loud-text{font-size:1.2em}.loud-text p{margin:0.6em 0}.modal{position:fixed;left:0;top:0;width:100%;height:100%;z-index:999;background:#8b8b8be0;visibility:visible;opacity:1;transition:visibility 0s, opacity 0.2s linear}.inner{background:white;box-shadow:3px 3px 6px #00000029;border-radius:10px;padding:2em;position:relative}.close-modal{position:absolute;top:1em;right:1em}.document-view{height:100%}.scroll{height:100%;overflow-x:hidden;overflow-y:auto;scroll-behavior:smooth;position:relative}.scroll:before{content:'';display:block;width:100%;height:15px;position:sticky;top:0;left:0;background:linear-gradient(180deg, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 100%)}.scroll:after{content:'';display:block;width:100%;height:15px;position:sticky;bottom:0;left:0;background:linear-gradient(0deg, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 100%)}.main-input{width:calc(100% - 3.2em - 2px);padding:0.8em 1.6em;border:2px solid #464e58;font-size:1.2em;border-radius:10px}.checklist ul{margin:0;padding-left:20px;text-align:left;list-style-image:url('assets/checkmark.svg')}.checklist li{margin-bottom:1em}.checklist li:last-child{margin-bottom:0}.row-validare h1{font-size:28px;line-height:32px}body{margin:0;padding:0;height:100vh;position:relative;height:100vh;}.container-video{height:99vh;text-align:center;position:relative;overflow:hidden}.row{padding:3.5vh 2.5vh;height:100%;overflow:hidden;position:relative;}.ctheight-100{height:99vh}.d-flex{display:flex}.space-between{justify-content:space-between}.img-info img{width:0.8vh;z-index:5;position:relative}.img-info{width:7vh;height:7vh;border-radius:100%;display:flex;align-items:center;justify-content:center;background:radial-gradient(100% 100% at 50% 0%, #d3b6e9 0%, #fbc2bd 100%)}.i-effect{animation:2.5s infinite transition-i;position:absolute;z-index:2;border-radius:100%;background:radial-gradient(100% 100% at 50% 0%, #d3b6e9 0%, #fbc2bd 100%)}.two-buttons{margin-top:3vh;justify-content:center}.align-center{align-items:center}.font-size-2{font-size:2vh}.row-validare .font-size-2{font-size:17px;line-height:19px}.img-text .bg-img img{width:100%;padding:2vh}.cit-selector-desktop{width:200px;height:140px}.img-selector{width:100%}.img-text .cit-selector,.img-text .cit-selector-desktop{border-radius:5%}.img-text h3{color:#333333;font-weight:700;font-size:2.3vh;margin:0}.font-weight-bold{font-weight:bold}.font-size-18{font-size:1.8vh}.row-validare .font-size-18{font-size:15px;line-height:16px}a{font-size:inherit;color:inherit;text-decoration:none}.color-black{color:#000}.normal-button{background:#1feaa6;box-shadow:0 6px 8px rgba(71, 182, 162, 0.2);border-radius:25px;text-align:center;padding:2vh;margin-right:1vw;margin-left:1vw;color:#fff;border:0;font-size:2vh}.red-button{background:#ff535d}.row-validare .main-button{font-size:17px}.text-right{text-align:right}.mb-0{margin-bottom:0}.row-validare.row{padding:29px 21px}.row-validare .main-button{padding:16px}.row-validare .btn-buletin{position:relative;width:100%;bottom:0}.show-bottom{bottom:-2vh}.second-input{width:46px;height:46px;font-weight:700;font-size:16px;font-family:'Inter', sans-serif;text-align:center;border:2px solid #c5c6cc;border-radius:12px;outline:none;padding:2px}.second-input:not(:placeholder-shown){border:2px solid #1feaa6;color:#1feaa6}.mt-9{margin-top:9%}.second-input::placeholder{color:#fff;opacity:0}.second-input:focus{border:2px solid #464e58;color:#464e58}.second-input.error{border:2px solid #b67171}.second-input.error:focus{border:3px solid #b67171;color:#b67171;padding:1px}.second-input.error:not(:placeholder-shown){border:3px solid #b67171;color:#b67171;padding:2px}.second-input-container{margin-top:30%;display:flex;flex-wrap:wrap;justify-content:space-between}.input-container{display:flex;flex-wrap:wrap}.mt-15{margin-top:15%}.row-validare .mt-15{margin-top:40px}.mb-15{margin-bottom:15%}.row-validare .mb-15{margin-bottom:40px}.mb-20{margin-bottom:20%}.row-validare .mb-1{margin-bottom:20px}.row-validare .mb-20{margin-bottom:60px}.mt-90{margin-top:90px}.op-05{opacity:0.5}.error-text{position:relative;top:50px;margin-bottom:0;margin-top:0}.top-50{top:50px}.mt-25{margin-top:25%}.text-center{text-align:center}.scale-2{transform:scale(2)}.mt-20{margin-top:20%}.div-ci img{max-height:40vh;max-width:80vw}.div-ci{text-align:center}.mt-10{margin-top:10vh}.mt-5{margin-top:5vh}.pos-relative{position:relative}.pos-absolute{position:absolute}.btn-buletin{text-align:center}.buletin-container img{width:60%}.buletin-container>img{margin-top:10vh}.buletin-container{text-align:center}.color-white{color:#fff}.chenar-buletin{margin-top:3em;text-align:center}.chenar-buletin .ci-img{width:96%}.chenar-buletin .face-img,.chenar-buletin .chenar-img{left:4%;width:92%;top:-20px;min-height:55vw;display:flex;position:absolute;align-items:center;background-color:rgba(255, 255, 255, 0.2);justify-content:center}.chenar-buletin img{width:auto;height:100%;top:0;left:0;position:absolute;border-radius:10px;z-index:4}.chenar-buletin .face-img{background-color:rgba(255, 255, 255, 0.3)}.buletin-container .w-40{width:40%}.animation{width:100%;height:100%;}.color-black-2{color:#71727a}.font-size-3{font-size:3vh}.font-size-25{font-size:2.5vh}.font-size-1{font-size:1vh}.font-weight-900{font-weight:900}.mt-8{margin-top:8vh}.mt-12{margin-top:12vh}.mt-30-i{margin-top:30% !important}.ml-5{margin-left:5vh}.chenar-buletin .face-img{left:-2%;width:104%;top:-40px}.pl-2-5{padding-left:2.5vh}.container-coin{background-color:transparent;perspective:1000px;rotate:120deg 0deg}.coin-flip{animation:flip 0.4s ease-in;animation-delay:0.5s;transform-style:preserve-3d;animation-fill-mode:forwards;visibility:hidden}.coin-scale{animation:show 0.4s ease-in;animation-delay:0.5s;transform-style:preserve-3d;animation-fill-mode:forwards}.scroll-disabled{height:100%;overflow-x:hidden;pointer-events:none;user-select:none}.scroll-to-top-btn{position:fixed;z-index:200;bottom:20px;left:20px;width:6vh;height:6vh;border-radius:50%;background-color:#1feaa6;color:white;display:flex;align-items:center;justify-content:center;font-size:5vh;cursor:pointer;box-shadow:0 2px 5px rgba(0, 0, 0, 0.3);transition:background-color 0.3s}.scroll-to-top-btn:hover{background-color:#17d296}.scroll-full{margin:4px, 4px;padding:4px;overflow-x:hidden;overflow-y:auto}.video-demo{z-index:0;width:100%;height:100%;border-radius:20px}.video-capture{padding:2.5vh 2.5vh;margin-top:3em;text-align:center;position:relative}.capture-title{z-index:4;margin-top:3vh;position:absolute;bottom:5vh;padding:2.5vh 2.5vh}video::-webkit-media-controls{display:none !important}@keyframes transition-i{from{width:0;height:0;opacity:1}80%{width:10vh;height:10vh;opacity:0.5}100%{opacity:0}}@keyframes flip{0%{transform:rotateX(140deg);visibility:visible}25%{transform:rotateX(120deg);visibility:visible}50%{transform:rotateX(90deg);visibility:visible}75%{transform:rotateX(75deg);visibility:visible}100%{transform:rotateX(0deg);visibility:visible}}@keyframes show{0%{transform:scale(0)}25%{transform:scale(0.2)}40%{transform:scale(0.4)}50%{transform:scale(0.5)}60%{transform:scale(0.6)}70%{transform:scale(0.7)}100%{transform:scale(1)}}@keyframes rise{0%{visibility:hidden}50%{visibility:visible}100%{visibility:visible}}.buletin-container.rotate-x img{animation:transform-rotate-x 2s infinite ease-in}.rotateimg90{animation:transform-rotate-x2 2s forwards;animation-delay:1s;position:absolute}.rotateimg180{animation:transform-rotate-x3 2s forwards;animation-delay:3s;position:absolute;opacity:0}.buletin-back{display:flex;justify-content:center}.loading-state{display:flex;justify-content:center;align-items:center;position:relative}.loading{width:50px;height:50px;border-radius:50%;border:10px solid #ddd;border-top-color:#71727a;animation:loading 1s linear infinite}.pulsate{animation:textPulse 2s ease 0s infinite normal forwards}@keyframes textPulse{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@keyframes loading{to{transform:rotate(360deg)}}@keyframes transform-rotate-x3{from{transform:rotateY(-90deg);opacity:1}to{transform:rotateY(0deg);opacity:1}}@keyframes transform-rotate-x2{to{transform:rotateY(90deg)}}@keyframes transform-rotate-x{to{transform:perspective(600px) rotateX(40deg)}}@media only screen and (max-width: 350px){.second-input{width:36px;height:36px}}@media only screen and (max-width: 390px){.second-input{width:40px;height:40px}.ml-5{margin-left:20vw}}@media only screen and (min-width: 530px) and (max-width: 767px){.chenar-buletin .face-img{width:70%;min-height:auto;margin:auto;left:15%;right:auto;top:-15vh}.ml-5{margin-left:15vw}}@media only screen and (min-width: 600px) and (max-width: 767px){.max-h img{margin-left:15%;margin-right:15%}.max-h{display:flex;align-items:center}.ml-5{margin-left:10vw}}@media only screen and (max-width: 991px){.buletin-container img{max-width:220px}.ml-5{margin-left:2.5vw}}@media only screen and (min-width: 767px){.container{max-width:530px;margin:40px auto;border-radius:20px;box-shadow:1px 1px 10px rgba(0, 0, 0, 0.1);height:calc(100% - 80px)}body{height:90vh}.btn-buletin{max-width:490px;bottom:7vh}.buletin-container img{width:45%}.chenar-buletin .face-img,.chenar-buletin .chenar-img{min-height:300px}.chenar-buletin .face-img{width:80%;min-height:auto;margin:auto;left:10%;right:auto;top:-10vh}.img-selector{width:10vw}}",nde=(()=>{let p=class{onTokenChange(v,k){return ce(this,null,function*(){if(Xe.debug&&console.log("Token change called with value: "+v),v==""){v=Xe.token;return}Xe.token!==v&&(Xe.token=v)})}agreementAcceptanceEmitted(v){try{Qa.instance.GenerateAgreement(v.detail.agreementType)}catch(k){this.apiErrorEmitter(k,"Agreement Acceptance")}}apiErrorEmitter(v,k){return ce(this,null,function*(){var N,F,W,L,O,S;v.detail?(this.errorTitle=(F=(N=v.detail.message)!==null&&N!==void 0?N:v.detail.status)!==null&&F!==void 0?F:"",this.errorMessage=(L=(W=v.detail.stack)!==null&&W!==void 0?W:v.detail.statusText)!==null&&L!==void 0?L:""):v.message?this.errorTitle=v.message:v.status?(this.errorTitle=(O=v.status)!==null&&O!==void 0?O:"",this.errorMessage=(S=v.statusText)!==null&&S!==void 0?S:""):this.errorTitle=v;let B={message:this.errorTitle,stack:this.errorMessage,zone:k};try{yield Qa.instance.AddLog(B,yield DD(this.order_id,this.redirect_id,this.token))}catch{}yield qu.ectdata.delete(Xe.requestId),hh.flowError(this.errorTitle),Xe.flowStatus=aa.ERROREND})}constructor(v){ll(this,v),this.logInit={},this.initialised=!1}componentWillLoad(){return ce(this,null,function*(){var v,k,N;let F=document.createElement("style");F.textContent+='@font-face { font-family: Nexa; src: url(assets/Nexa-ExtraLight.ttf) format("truetype"); }',document.head.append(F),Xe.analytics=(v=this.analytics)!==null&&v!==void 0?v:!0,this.appInsights=T8.getInstance(),this.appInsights.trackEvent("IdentificationComponent | init",{requestId:Xe.requestId}),hh.init(window),hh.flowEvent(Ns.ComponentLoaded,hg.Initialized),Xe.apiBaseUrl=this.api_url,this.env&&this.env!=""&&(Xe.environment=this.env),Xe.environment!="PROD"&&(Xe.debug=!0),Qa.getInstance(),Xe.debug&&(this.logInit=yield DD(this.order_id,this.redirect_id,this.token)),this.token&&(Xe.debug&&console.log("Store Token set with property value: "+this.token),Xe.token=this.token),this.redirect_id&&(Xe.redirectId=this.redirect_id),this.lang_iso&&this.lang_iso!=""&&(Xe.langIso=this.lang_iso),Xe.showCitizenshipSelector=(k=this.show_citizenship_selector)!==null&&k!==void 0?k:!1,Xe.scrollMode=(N=this.scroll_mode)!==null&&N!==void 0?N:!1})}componentDidLoad(){return ce(this,null,function*(){var v,k,N,F,W,L;if(this.order_id&&this.order_id!="")this.ectData=yield qu.getOrCreateEctData(this.order_id),Xe.requestId=this.order_id,Xe.initialized=this.ectData.initialized,Xe.modelsPath=this.ectData.modelsPath,Xe.debug&&console.log("Current RequestId has value: "+this.order_id);else if(!this.redirect_id||this.redirect_id==""){var O=yield qu.getLastEctData(!1);O&&(this.ectData=O,Xe.requestId=this.ectData.orderId,Xe.initialized=this.ectData.initialized)}!((v=this.ectData)===null||v===void 0)&&v.modelsPath&&((k=this.ectData)===null||k===void 0?void 0:k.modelsPath)!=""&&(Xe.modelsPath=this.ectData.modelsPath),this.phone_number&&this.phone_number!=""?(Xe.phoneNumber=this.phone_number,this.ectData.phoneNumber=this.phone_number,yield qu.ectdata.put(this.ectData)):!((N=this.ectData)===null||N===void 0)&&N.phoneNumber&&((F=this.ectData)===null||F===void 0?void 0:F.phoneNumber)!=""&&(Xe.phoneNumber=this.ectData.phoneNumber),this.citizenship&&this.citizenship!=""?(Xe.citizenship=this.citizenship,this.ectData.citizenship=this.citizenship,yield qu.ectdata.put(this.ectData)):!((W=this.ectData)===null||W===void 0)&&W.citizenship&&((L=this.ectData)===null||L===void 0?void 0:L.citizenship)!=""&&(Xe.citizenship=this.ectData.citizenship),yield this.initializeRequest();try{this.ectData.initialized&&(Xe.flowStatus=yield Qa.instance.GetFlowState())}catch{}})}initializeRequest(){return ce(this,null,function*(){if(!this.initialised){if(this.initialised=!0,Xe.device||(Xe.device=yield new u4t().getDevice()),Xe.device.browser==Xk.Mi){this.apiErrorEmitter("Mi Browser nu este acceptat. Va rugam utilizati Chrome.","Request Initialisation RequestId:"+Xe.requestId+" RedirectId:"+Xe.redirectId);return}try{Xe.debug&&(yield Qa.instance.AddLog({phase:"debug mode"},this.logInit))}catch{}try{!Xe.device.isMobile&&Xe.redirectId==""&&Xe.environment!="DEMO"&&(Xe.redirectId=hee(),this.redirect_id=Xe.redirectId),Xe.token!=""&&(Xe.requestId!=""||Xe.redirectId!="")&&!Xe.initialized&&(yield Qa.instance.AddIdentificationRequest(Xe.device,zse.version),yield this.treatMobileRedirect(),this.ectData.initialized=!0,this.ectData.flowStatus=Xe.flowStatus,this.ectData.modelsPath=Xe.modelsPath,yield qu.ectdata.put(this.ectData))}catch(v){this.apiErrorEmitter(v,"Request Initialisation RequestId:"+Xe.requestId+" RedirectId:"+Xe.redirectId)}}})}treatMobileRedirect(){return ce(this,null,function*(){this.order_id&&this.order_id!=""||(this.order_id=Xe.requestId,this.ectData=yield qu.ectdata.get(Xe.requestId),this.ectData||(yield qu.ectdata.add({orderId:Xe.requestId,redirectId:Xe.redirectId,timestamp:new Date,initialized:!0,phoneNumber:Xe.phoneNumber,refreshStarted:!1,flowStatus:Xe.flowStatus,modelsPath:Xe.modelsPath,citizenship:Xe.citizenship,finished:!1}),this.ectData=yield qu.ectdata.get(Xe.requestId)))})}disconnectedCallback(){hh.flowEvent(Ns.ComponentLoaded,hg.Finalized)}render(){let v=He("div",{key:"f48136403825104e12e2d8a428b560dd15b0ffc2",class:"container flex center text-center"},He("img",{key:"8c576923a577ce36fbe5004c0380edaa12603313",src:gw}));return Xe.flowStatus==aa.CITIZENSHIP?v=He("citizenship-selection",{key:"9f51cbe8329823fd8c3f8269815eca550a3856cf"}):Xe.flowStatus==aa.LANDING?v=He("landing-validation",{key:"580f4753204f1cc90ad1cbd728612bff83d6b77a"}):Xe.flowStatus==aa.MOBILE?v=He("mobile-redirect",{key:"3d32d52476b5fc4b3e1f755d8f8e390df6dbc478"}):Xe.flowStatus==aa.AGREEMENT?v=He("agreement-info",{key:"f0c708b516d81d5300b6da3183b6770a65677876"}):Xe.flowStatus==aa.PHONE?v=He("sms-send",{key:"b17cb5f14fa40aecc1dcbd5faeeaae11f3728212"}):Xe.flowStatus==aa.CODE?v=He("sms-code-validation",{key:"88ae3d6c3cb53cbacbc07ee612fc34db3c6900bb"}):Xe.flowStatus==aa.CODEERROR?v=He("sms-code-validation",{key:"a6a15c6f18dd2c55cad08fb469032ebda9f55a99"}):Xe.flowStatus==aa.IDTYPE?v=He("id-selection",{key:"57ca0a82fc51428560d9faf151658379a9274459"}):Xe.flowStatus==aa.IDFRONTHOWTO?(Xe.debug&&console.log("identification-component | render | IDFRONTHOWTO"),v=He("how-to-info",{key:"9ae711549c7bbf265f6c30bc49f092568bb4f107"})):Xe.flowStatus==aa.IDFRONT?(Xe.debug&&console.log("identification-component | render | IDFRONT"),v=He("process-id",{key:"92edff0079fcf3707218da057d92c198f7d5c528",id:"processIdFront",mode:"front"})):Xe.flowStatus==aa.IDBACKHOWTO?(Xe.debug&&console.log("identification-component | render | IDBACKHOWTO"),v=He("how-to-info",{key:"6c42a84312f6628f86df1168c0da653ee059d4ac"})):Xe.flowStatus==aa.IDBACK?(Xe.debug&&console.log("identification-component | render | IDBACK"),v=He("process-id",{key:"bdd8c6b9134daacaa1e154ac57d079e7d49c5179",id:"processIdBack",mode:"back"})):Xe.flowStatus==aa.IDTILTHOWTO?(Xe.debug&&console.log("identification-component | render | IDTILTHOWTO"),v=He("how-to-info",{key:"5ad51d05c27e74ea63b4d101b0e74f870beba542"})):Xe.flowStatus==aa.IDTILT?(Xe.debug&&console.log("identification-component | render | TILT"),v=He("process-id",{key:"dffbd2b2e6be5711b7901322eb473a0e18c0aae3",id:"processIdTilt",mode:"tilt"})):Xe.flowStatus==aa.LIVENESSHOWTO?(Xe.debug&&console.log("identification-component | render | LIVENESSHOWTO"),v=He("how-to-info",{key:"37f1d3df20fae49c98a73aa208d7efb63710fb7a"})):Xe.flowStatus==aa.LIVENESS?(Xe.debug&&console.log("identification-component | render | LIVENESS"),v=He("user-liveness",{key:"9d732b0f6b9b24498780911079a99efb9a10886f",id:"userLiveness",mode:"selfie"})):Xe.flowStatus==aa.LIVENESSGESTUREHOWTO?(Xe.debug&&console.log("identification-component | render | LIVENESSGESTUREHOWTO"),v=He("state-transition",{key:"5d22973f8b36ae21d39364db0afaa23326e20cf0"})):Xe.flowStatus==aa.LIVENESSGESTURE?(Xe.debug&&console.log("identification-component | render | LIVENESSGESTURE"),v=He("user-liveness",{key:"4533ba1509dce70a94594525543225ca072212c3",id:"userLivenessGesture",mode:"selfieGesture"})):Xe.flowStatus==aa.COMPLETE?(Xe.debug&&console.log("identification-component | render | COMPLETE"),v=He("end-redirect",{key:"649e427313f14e41f3d6a1e5131506473a3a2e8b"})):Xe.flowStatus==aa.ERROREND?v=He("error-end",{key:"ca8c1d356573135a17c4a88c1464dfd3c348eef7",errorTitle:this.errorTitle,message:this.errorMessage}):Xe.flowStatus==aa.CAMERAERROR?v=He("camera-error",{key:"d46830a9b22e25442eda81d1555a6e16ff1d1e81"}):Xe.flowStatus==aa.RANDOM&&(Xe.debug&&console.log("identification-component | render | RANDOM"),v=He("random-action",{key:"a0c5e28b2538a2d005325f665957c3a703883553"})),He("div",{key:"27c7c9ba0816482be926851f3ecaee5871ad72a4",class:"full"},v)}static get watchers(){return{token:["onTokenChange"]}}};return p.style=Pse,p})(),ckt="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0Mi4xMDkiIGhlaWdodD0iNTIuNzg4IiB2aWV3Qm94PSIwIDAgNDIuMTA5IDUyLjc4OCI+DQogIDxnIGlkPSJtb2JpbGVfcGhvbmUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yNSAtMzQyKSI+DQogICAgPHBhdGggaWQ9IlBhdGhfNDc0NiIgZGF0YS1uYW1lPSJQYXRoIDQ3NDYiIGQ9Ik0yOS45MSw1NWEuOTEuOTEsMCwxLDAsMCwxLjgyaDMuNjQxYS45MS45MSwwLDEsMCwwLTEuODJaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4Ljc0MiAzMzQuMzI3KSIvPg0KICAgIDxwYXRoIGlkPSJQYXRoXzQ3NDgiIGRhdGEtbmFtZT0iUGF0aCA0NzQ4IiBkPSJNMzYuNTEyLDguOTFBLjg2Ljg2LDAsMCwwLDM1LjYsOEgyNy40MWEuODYuODYsMCwwLDAtLjkxLjkxLjg2Ljg2LDAsMCwwLC45MS45MUgzNS42QS44Ni44NiwwLDAsMCwzNi41MTIsOC45MVoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDguOTY3IDMzOC41NTEpIiBmaWxsPSIjMjUyYzgyIi8+DQogICAgPGcgaWQ9Ikdyb3VwXzQ2MDciIGRhdGEtbmFtZT0iR3JvdXAgNDYwNyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjUgMzQyKSI+DQogICAgICA8cGF0aCBpZD0iUGF0aF80NzQ3IiBkYXRhLW5hbWU9IlBhdGggNDc0NyIgZD0iTTQ0LjEyNSw4LjM3YS45MS45MSwwLDEsMCwxLjgyLDBBNS40MzksNS40MzksMCwwLDAsNDAuNTc1LDNIMjAuMzdBNS40MzksNS40MzksMCwwLDAsMTUsOC4zN1Y1MC40MThhNS4zOCw1LjM4LDAsMCwwLDUuMzcsNS4zN0g0MC41NzVhNS4zOCw1LjM4LDAsMCwwLDUuMzctNS4zN1YzNy41ODVhLjkxLjkxLDAsMSwwLTEuODIsMFY1MC40MThhMy41NTQsMy41NTQsMCwwLDEtMy41NSwzLjU1SDIwLjM3YTMuNTU0LDMuNTU0LDAsMCwxLTMuNTUtMy41NVY4LjM3YTMuNjE0LDMuNjE0LDAsMCwxLDMuNTUtMy41NUg0MC41NzVhMy42MTQsMy42MTQsMCwwLDEsMy41NSwzLjU1WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE1IC0zKSIgZmlsbD0iIzI1MmM4MiIvPg0KICAgICAgPGcgaWQ9Ikdyb3VwXzQ2MDYiIGRhdGEtbmFtZT0iR3JvdXAgNDYwNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTguMjAzIDguMTkxKSI+DQogICAgICAgIDxwYXRoIGlkPSJQYXRoXzQ3NTgiIGRhdGEtbmFtZT0iUGF0aCA0NzU4IiBkPSJNOTQuOTUzLDc1YTExLjk1MywxMS45NTMsMCwxLDAsMTEuOTUzLDExLjk1M0ExMS45NjcsMTEuOTY3LDAsMCwwLDk0Ljk1Myw3NVptMCwyMi40NTdhMTAuNSwxMC41LDAsMSwxLDEwLjUtMTAuNUExMC41MTYsMTAuNTE2LDAsMCwxLDk0Ljk1Myw5Ny40NTdaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtODMgLTc1KSIgZmlsbD0iIzI1MmM4MiIvPg0KICAgICAgICA8cGF0aCBpZD0iUGF0aF80NzU5IiBkYXRhLW5hbWU9IlBhdGggNDc1OSIgZD0iTTExMC43NTIsOTguNzEybC03LjI3NSw3LjI3NS00Ljc0LTQuNzM5YS43MjQuNzI0LDAsMCwwLTEuMDI0LDEuMDI0bDUuMjUyLDUuMjUyYS43MjQuNzI0LDAsMCwwLDEuMDI0LDBsNy43ODctNy43ODdhLjcyNC43MjQsMCwwLDAtMS4wMjQtMS4wMjRaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtOTIuMjQ4IC04OS45ODgpIiBmaWxsPSIjN2JiNDBlIi8+DQogICAgICA8L2c+DQogICAgPC9nPg0KICA8L2c+DQo8L3N2Zz4NCg==",Bse="",rde=(()=>{let p=class{constructor(v){ll(this,v),this.apiErrorEvent=ps(this,"apiError")}componentWillLoad(){return ce(this,null,function*(){hh.flowStarted(),this.translations=yield vd.getValues(),this.buttonDisabled=!1,this.ectData=yield qu.ectdata.get(Xe.requestId),yield this.initRequest()})}componentDidLoad(){return ce(this,null,function*(){yield dl.initialize(Ns.Landing)})}initRequest(){return ce(this,null,function*(){Xe.apiBaseUrl.includes("apimd")?this.warningText=this.translations.LandingValues.WarningMd:this.warningText=this.translations.LandingValues.Warning})}startFlow(){return ce(this,null,function*(){if(!this.buttonDisabled){this.buttonDisabled=!0;var v=yield A8.InitCameras(Xe.device);!v&&Xe.device.mobileOS==yg.iOS&&(this.ectData.refreshStarted=!1,yield qu.ectdata.put(this.ectData));try{Xe.flowStatus=yield Qa.instance.LandingValidationStartFlow(v)}catch(k){this.apiErrorEvent.emit(k)}}})}disconnectedCallback(){return ce(this,null,function*(){yield dl.finalize(Ns.Landing)})}leaveFlow(){return ce(this,null,function*(){if(!this.buttonDisabled)try{let v=yield Qa.instance.AbortRequest();Xe.flowStatus=aa[v.state],yield qu.ectdata.delete(Xe.requestId),hh.flowAborted()}catch(v){hh.flowAborted(),this.apiErrorEvent.emit(v)}})}render(){return He("div",{key:"56029b9bc69ad82a03ed97abc8a288a2798929e3",class:"container flex center"},He("div",{key:"9d09481ba5bbf47706a1911711c4d9316f10092c",class:"px-4"},He("h1",{key:"811c7fd179ac86a6a7a8a641e85cb1ec42f6027f",class:"text-center px-1 mb-1"},this.translations.LandingValues.Title),He("div",{key:"bdbc306ea7eacd5d8ebfa9df8eeb3533c2844287",class:"info-container mb-2"},He("div",{key:"a99ae4fb7fd78b3af4ae0e509e773068f62b00c5",class:"img-text"},He("div",{key:"7961a0c51d9549223833d62a6f3f4ecafb4836ca",class:"bg-img"},He("img",{key:"87324cca0d03254e1ec24fb2788fec92b2918d69",src:R$t})),He("h2",{key:"a283d3189c73e295f3422cc50a7a9b3184eb76a4"},this.translations.LandingValues.IdInfo)),He("div",{key:"cf571c6246621c4f0853e5e237bac63f981e4fac",class:"img-text"},He("div",{key:"dcee11a67447bd325ea7c19a8b0d69b692cc26e3",class:"bg-img"},He("img",{key:"724ba2d804f6fbbbdb02f85579a148a570fe4f18",src:ckt})),He("h2",{key:"5da52670f24c659129a8bbb73f7841e5c554f2e6"},this.translations.LandingValues.DeviceInfo))),He("div",{key:"ec11e12477a948718aa38afe039f679d356328fc",class:"button flex mb-1"},this.buttonDisabled?He("div",{class:"img-loader rounded img-loader-button"},He("img",{class:"loading-image loading-image-button",src:gw})):null,He("button",{key:"d929463b7b73b170e13e374008b1942ad6381ee0",class:"main-button",type:"button",disabled:this.buttonDisabled,onClick:()=>this.startFlow()},this.translations.LandingValues.Button)),He("div",{key:"afd08d532de75d33e7b00dd19769fbf7dfddc6f1",class:"text-center"},He("p",{key:"d3096c9bc8bae638c90db5921597f8708839068f",class:"main-text link-text",onClick:()=>this.leaveFlow()},this.translations.LandingValues.ButtonLeave)),He("div",{key:"3c448e2e0c7cc66286e2a795c775a622ea908729",class:"footer text-center"},He("img",{key:"9a6f8063cc92c61bdbd85f3d0b8842c2c1ba4585",src:Cd}))))}};return p.style=Bse,p})(),H3={},P3t,SDt;function F$t(){return SDt||(SDt=1,P3t=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),P3t}var B3t={},$k={},_Dt;function U8(){if(_Dt)return $k;_Dt=1;let p,v=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return $k.getSymbolSize=function(N){if(!N)throw new Error('"version" cannot be null or undefined');if(N<1||N>40)throw new Error('"version" should be in range from 1 to 40');return N*4+17},$k.getSymbolTotalCodewords=function(N){return v[N]},$k.getBCHDigit=function(k){let N=0;for(;k!==0;)N++,k>>>=1;return N},$k.setToSJISFunction=function(N){if(typeof N!="function")throw new Error('"toSJISFunc" is not a valid function.');p=N},$k.isKanjiModeEnabled=function(){return typeof p<"u"},$k.toSJIS=function(N){return p(N)},$k}var j3t={},CDt;function hkt(){return CDt||(CDt=1,function(p){p.L={bit:1},p.M={bit:0},p.Q={bit:3},p.H={bit:2};function v(k){if(typeof k!="string")throw new Error("Param is not a string");switch(k.toLowerCase()){case"l":case"low":return p.L;case"m":case"medium":return p.M;case"q":case"quartile":return p.Q;case"h":case"high":return p.H;default:throw new Error("Unknown EC Level: "+k)}}p.isValid=function(N){return N&&typeof N.bit<"u"&&N.bit>=0&&N.bit<4},p.from=function(N,F){if(p.isValid(N))return N;try{return v(N)}catch{return F}}}(j3t)),j3t}var U3t,EDt;function jse(){if(EDt)return U3t;EDt=1;function p(){this.buffer=[],this.length=0}return p.prototype={get:function(v){let k=Math.floor(v/8);return(this.buffer[k]>>>7-v%8&1)===1},put:function(v,k){for(let N=0;N<k;N++)this.putBit((v>>>k-N-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(v){let k=Math.floor(this.length/8);this.buffer.length<=k&&this.buffer.push(0),v&&(this.buffer[k]|=128>>>this.length%8),this.length++}},U3t=p,U3t}var W3t,TDt;function Use(){if(TDt)return W3t;TDt=1;function p(v){if(!v||v<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=v,this.data=new Uint8Array(v*v),this.reservedBit=new Uint8Array(v*v)}return p.prototype.set=function(v,k,N,F){let W=v*this.size+k;this.data[W]=N,F&&(this.reservedBit[W]=!0)},p.prototype.get=function(v,k){return this.data[v*this.size+k]},p.prototype.xor=function(v,k,N){this.data[v*this.size+k]^=N},p.prototype.isReserved=function(v,k){return this.reservedBit[v*this.size+k]},W3t=p,W3t}var V3t={},ADt;function Wse(){return ADt||(ADt=1,function(p){let v=U8().getSymbolSize;p.getRowColCoords=function(N){if(N===1)return[];let F=Math.floor(N/7)+2,W=v(N),L=W===145?26:Math.ceil((W-13)/(2*F-2))*2,O=[W-7];for(let S=1;S<F-1;S++)O[S]=O[S-1]-L;return O.push(6),O.reverse()},p.getPositions=function(N){let F=[],W=p.getRowColCoords(N),L=W.length;for(let O=0;O<L;O++)for(let S=0;S<L;S++)O===0&&S===0||O===0&&S===L-1||O===L-1&&S===0||F.push([W[O],W[S]]);return F}}(V3t)),V3t}var G3t={},IDt;function Vse(){if(IDt)return G3t;IDt=1;let p=U8().getSymbolSize,v=7;return G3t.getPositions=function(N){let F=p(N);return[[0,0],[F-v,0],[0,F-v]]},G3t}var H3t={},NDt;function Gse(){return NDt||(NDt=1,function(p){p.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};let v={N1:3,N2:3,N3:40,N4:10};p.isValid=function(F){return F!=null&&F!==""&&!isNaN(F)&&F>=0&&F<=7},p.from=function(F){return p.isValid(F)?parseInt(F,10):void 0},p.getPenaltyN1=function(F){let W=F.size,L=0,O=0,S=0,B=null,j=null;for(let K=0;K<W;K++){O=S=0,B=j=null;for(let Z=0;Z<W;Z++){let Y=F.get(K,Z);Y===B?O++:(O>=5&&(L+=v.N1+(O-5)),B=Y,O=1),Y=F.get(Z,K),Y===j?S++:(S>=5&&(L+=v.N1+(S-5)),j=Y,S=1)}O>=5&&(L+=v.N1+(O-5)),S>=5&&(L+=v.N1+(S-5))}return L},p.getPenaltyN2=function(F){let W=F.size,L=0;for(let O=0;O<W-1;O++)for(let S=0;S<W-1;S++){let B=F.get(O,S)+F.get(O,S+1)+F.get(O+1,S)+F.get(O+1,S+1);(B===4||B===0)&&L++}return L*v.N2},p.getPenaltyN3=function(F){let W=F.size,L=0,O=0,S=0;for(let B=0;B<W;B++){O=S=0;for(let j=0;j<W;j++)O=O<<1&2047|F.get(B,j),j>=10&&(O===1488||O===93)&&L++,S=S<<1&2047|F.get(j,B),j>=10&&(S===1488||S===93)&&L++}return L*v.N3},p.getPenaltyN4=function(F){let W=0,L=F.data.length;for(let S=0;S<L;S++)W+=F.data[S];return Math.abs(Math.ceil(W*100/L/5)-10)*v.N4};function k(N,F,W){switch(N){case p.Patterns.PATTERN000:return(F+W)%2===0;case p.Patterns.PATTERN001:return F%2===0;case p.Patterns.PATTERN010:return W%3===0;case p.Patterns.PATTERN011:return(F+W)%3===0;case p.Patterns.PATTERN100:return(Math.floor(F/2)+Math.floor(W/3))%2===0;case p.Patterns.PATTERN101:return F*W%2+F*W%3===0;case p.Patterns.PATTERN110:return(F*W%2+F*W%3)%2===0;case p.Patterns.PATTERN111:return(F*W%3+(F+W)%2)%2===0;default:throw new Error("bad maskPattern:"+N)}}p.applyMask=function(F,W){let L=W.size;for(let O=0;O<L;O++)for(let S=0;S<L;S++)W.isReserved(S,O)||W.xor(S,O,k(F,S,O))},p.getBestMask=function(F,W){let L=Object.keys(p.Patterns).length,O=0,S=1/0;for(let B=0;B<L;B++){W(B),p.applyMask(B,F);let j=p.getPenaltyN1(F)+p.getPenaltyN2(F)+p.getPenaltyN3(F)+p.getPenaltyN4(F);p.applyMask(B,F),j<S&&(S=j,O=B)}return O}}(H3t)),H3t}var sst={},MDt;function O$t(){if(MDt)return sst;MDt=1;let p=hkt(),v=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],k=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return sst.getBlocksCount=function(F,W){switch(W){case p.L:return v[(F-1)*4+0];case p.M:return v[(F-1)*4+1];case p.Q:return v[(F-1)*4+2];case p.H:return v[(F-1)*4+3];default:return}},sst.getTotalCodewordsCount=function(F,W){switch(W){case p.L:return k[(F-1)*4+0];case p.M:return k[(F-1)*4+1];case p.Q:return k[(F-1)*4+2];case p.H:return k[(F-1)*4+3];default:return}},sst}var Y3t={},gV={},DDt;function Hse(){if(DDt)return gV;DDt=1;let p=new Uint8Array(512),v=new Uint8Array(256);return function(){let N=1;for(let F=0;F<255;F++)p[F]=N,v[N]=F,N<<=1,N&256&&(N^=285);for(let F=255;F<512;F++)p[F]=p[F-255]}(),gV.log=function(N){if(N<1)throw new Error("log("+N+")");return v[N]},gV.exp=function(N){return p[N]},gV.mul=function(N,F){return N===0||F===0?0:p[v[N]+v[F]]},gV}var RDt;function Yse(){return RDt||(RDt=1,function(p){let v=Hse();p.mul=function(N,F){let W=new Uint8Array(N.length+F.length-1);for(let L=0;L<N.length;L++)for(let O=0;O<F.length;O++)W[L+O]^=v.mul(N[L],F[O]);return W},p.mod=function(N,F){let W=new Uint8Array(N);for(;W.length-F.length>=0;){let L=W[0];for(let S=0;S<F.length;S++)W[S]^=v.mul(F[S],L);let O=0;for(;O<W.length&&W[O]===0;)O++;W=W.slice(O)}return W},p.generateECPolynomial=function(N){let F=new Uint8Array([1]);for(let W=0;W<N;W++)F=p.mul(F,new Uint8Array([1,v.exp(W)]));return F}}(Y3t)),Y3t}var q3t,FDt;function qse(){if(FDt)return q3t;FDt=1;let p=Yse();function v(k){this.genPoly=void 0,this.degree=k,this.degree&&this.initialize(this.degree)}return v.prototype.initialize=function(N){this.degree=N,this.genPoly=p.generateECPolynomial(this.degree)},v.prototype.encode=function(N){if(!this.genPoly)throw new Error("Encoder not initialized");let F=new Uint8Array(N.length+this.degree);F.set(N);let W=p.mod(F,this.genPoly),L=this.degree-W.length;if(L>0){let O=new Uint8Array(this.degree);return O.set(W,L),O}return W},q3t=v,q3t}var X3t={},K3t={},Z3t={},ODt;function L$t(){return ODt||(ODt=1,Z3t.isValid=function(v){return!isNaN(v)&&v>=1&&v<=40}),Z3t}var Xy={},LDt;function $$t(){if(LDt)return Xy;LDt=1;let p="[0-9]+",v="[A-Z $%*+\\-./:]+",k="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";k=k.replace(/u/g,"\\u");let N="(?:(?![A-Z0-9 $%*+\\-./:]|"+k+`)(?:.|[\r
]))+`;Xy.KANJI=new RegExp(k,"g"),Xy.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Xy.BYTE=new RegExp(N,"g"),Xy.NUMERIC=new RegExp(p,"g"),Xy.ALPHANUMERIC=new RegExp(v,"g");let F=new RegExp("^"+k+"$"),W=new RegExp("^"+p+"$"),L=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Xy.testKanji=function(S){return F.test(S)},Xy.testNumeric=function(S){return W.test(S)},Xy.testAlphanumeric=function(S){return L.test(S)},Xy}var $Dt;function W8(){return $Dt||($Dt=1,function(p){let v=L$t(),k=$$t();p.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},p.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},p.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},p.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},p.MIXED={bit:-1},p.getCharCountIndicator=function(W,L){if(!W.ccBits)throw new Error("Invalid mode: "+W);if(!v.isValid(L))throw new Error("Invalid version: "+L);return L>=1&&L<10?W.ccBits[0]:L<27?W.ccBits[1]:W.ccBits[2]},p.getBestModeForData=function(W){return k.testNumeric(W)?p.NUMERIC:k.testAlphanumeric(W)?p.ALPHANUMERIC:k.testKanji(W)?p.KANJI:p.BYTE},p.toString=function(W){if(W&&W.id)return W.id;throw new Error("Invalid mode")},p.isValid=function(W){return W&&W.bit&&W.ccBits};function N(F){if(typeof F!="string")throw new Error("Param is not a string");switch(F.toLowerCase()){case"numeric":return p.NUMERIC;case"alphanumeric":return p.ALPHANUMERIC;case"kanji":return p.KANJI;case"byte":return p.BYTE;default:throw new Error("Unknown mode: "+F)}}p.from=function(W,L){if(p.isValid(W))return W;try{return N(W)}catch{return L}}}(K3t)),K3t}var zDt;function Xse(){return zDt||(zDt=1,function(p){let v=U8(),k=O$t(),N=hkt(),F=W8(),W=L$t(),L=7973,O=v.getBCHDigit(L);function S(Z,Y,X){for(let J=1;J<=40;J++)if(Y<=p.getCapacity(J,X,Z))return J}function B(Z,Y){return F.getCharCountIndicator(Z,Y)+4}function j(Z,Y){let X=0;return Z.forEach(function(J){let q=B(J.mode,Y);X+=q+J.getBitsLength()}),X}function K(Z,Y){for(let X=1;X<=40;X++)if(j(Z,X)<=p.getCapacity(X,Y,F.MIXED))return X}p.from=function(Y,X){return W.isValid(Y)?parseInt(Y,10):X},p.getCapacity=function(Y,X,J){if(!W.isValid(Y))throw new Error("Invalid QR Code version");typeof J>"u"&&(J=F.BYTE);let q=v.getSymbolTotalCodewords(Y),H=k.getTotalCodewordsCount(Y,X),tt=(q-H)*8;if(J===F.MIXED)return tt;let st=tt-B(J,Y);switch(J){case F.NUMERIC:return Math.floor(st/10*3);case F.ALPHANUMERIC:return Math.floor(st/11*2);case F.KANJI:return Math.floor(st/13);case F.BYTE:default:return Math.floor(st/8)}},p.getBestVersionForData=function(Y,X){let J,q=N.from(X,N.M);if(Array.isArray(Y)){if(Y.length>1)return K(Y,q);if(Y.length===0)return 1;J=Y[0]}else J=Y;return S(J.mode,J.getLength(),q)},p.getEncodedBits=function(Y){if(!W.isValid(Y)||Y<7)throw new Error("Invalid QR Code version");let X=Y<<12;for(;v.getBCHDigit(X)-O>=0;)X^=L<<v.getBCHDigit(X)-O;return Y<<12|X}}(X3t)),X3t}var Q3t={},PDt;function Kse(){if(PDt)return Q3t;PDt=1;let p=U8(),v=1335,k=21522,N=p.getBCHDigit(v);return Q3t.getEncodedBits=function(W,L){let O=W.bit<<3|L,S=O<<10;for(;p.getBCHDigit(S)-N>=0;)S^=v<<p.getBCHDigit(S)-N;return(O<<10|S)^k},Q3t}var J3t={},twt,BDt;function Zse(){if(BDt)return twt;BDt=1;let p=W8();function v(k){this.mode=p.NUMERIC,this.data=k.toString()}return v.getBitsLength=function(N){return 10*Math.floor(N/3)+(N%3?N%3*3+1:0)},v.prototype.getLength=function(){return this.data.length},v.prototype.getBitsLength=function(){return v.getBitsLength(this.data.length)},v.prototype.write=function(N){let F,W,L;for(F=0;F+3<=this.data.length;F+=3)W=this.data.substr(F,3),L=parseInt(W,10),N.put(L,10);let O=this.data.length-F;O>0&&(W=this.data.substr(F),L=parseInt(W,10),N.put(L,O*3+1))},twt=v,twt}var ewt,jDt;function Qse(){if(jDt)return ewt;jDt=1;let p=W8(),v=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function k(N){this.mode=p.ALPHANUMERIC,this.data=N}return k.getBitsLength=function(F){return 11*Math.floor(F/2)+6*(F%2)},k.prototype.getLength=function(){return this.data.length},k.prototype.getBitsLength=function(){return k.getBitsLength(this.data.length)},k.prototype.write=function(F){let W;for(W=0;W+2<=this.data.length;W+=2){let L=v.indexOf(this.data[W])*45;L+=v.indexOf(this.data[W+1]),F.put(L,11)}this.data.length%2&&F.put(v.indexOf(this.data[W]),6)},ewt=k,ewt}var nwt,UDt;function Jse(){if(UDt)return nwt;UDt=1;let p=W8();function v(k){this.mode=p.BYTE,typeof k=="string"?this.data=new TextEncoder().encode(k):this.data=new Uint8Array(k)}return v.getBitsLength=function(N){return N*8},v.prototype.getLength=function(){return this.data.length},v.prototype.getBitsLength=function(){return v.getBitsLength(this.data.length)},v.prototype.write=function(k){for(let N=0,F=this.data.length;N<F;N++)k.put(this.data[N],8)},nwt=v,nwt}var rwt,WDt;function tue(){if(WDt)return rwt;WDt=1;let p=W8(),v=U8();function k(N){this.mode=p.KANJI,this.data=N}return k.getBitsLength=function(F){return F*13},k.prototype.getLength=function(){return this.data.length},k.prototype.getBitsLength=function(){return k.getBitsLength(this.data.length)},k.prototype.write=function(N){let F;for(F=0;F<this.data.length;F++){let W=v.toSJIS(this.data[F]);if(W>=33088&&W<=40956)W-=33088;else if(W>=57408&&W<=60351)W-=49472;else throw new Error("Invalid SJIS character: "+this.data[F]+`
Make sure your charset is UTF-8`);W=(W>>>8&255)*192+(W&255),N.put(W,13)}},rwt=k,rwt}var iwt={exports:{}},VDt;function eue(){return VDt||(VDt=1,function(p){var v={single_source_shortest_paths:function(k,N,F){var W={},L={};L[N]=0;var O=v.PriorityQueue.make();O.push(N,0);for(var S,B,j,K,Z,Y,X,J,q;!O.empty();){S=O.pop(),B=S.value,K=S.cost,Z=k[B]||{};for(j in Z)Z.hasOwnProperty(j)&&(Y=Z[j],X=K+Y,J=L[j],q=typeof L[j]>"u",(q||J>X)&&(L[j]=X,O.push(j,X),W[j]=B))}if(typeof F<"u"&&typeof L[F]>"u"){var H=["Could not find a path from ",N," to ",F,"."].join("");throw new Error(H)}return W},extract_shortest_path_from_predecessor_list:function(k,N){for(var F=[],W=N;W;)F.push(W),W=k[W];return F.reverse(),F},find_path:function(k,N,F){var W=v.single_source_shortest_paths(k,N,F);return v.extract_shortest_path_from_predecessor_list(W,F)},PriorityQueue:{make:function(k){var N=v.PriorityQueue,F={},W;k=k||{};for(W in N)N.hasOwnProperty(W)&&(F[W]=N[W]);return F.queue=[],F.sorter=k.sorter||N.default_sorter,F},default_sorter:function(k,N){return k.cost-N.cost},push:function(k,N){var F={value:k,cost:N};this.queue.push(F),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};p.exports=v}(iwt)),iwt.exports}var GDt;function nue(){return GDt||(GDt=1,function(p){let v=W8(),k=Zse(),N=Qse(),F=Jse(),W=tue(),L=$$t(),O=U8(),S=eue();function B(H){return unescape(encodeURIComponent(H)).length}function j(H,tt,st){let lt=[],ft;for(;(ft=H.exec(st))!==null;)lt.push({data:ft[0],index:ft.index,mode:tt,length:ft[0].length});return lt}function K(H){let tt=j(L.NUMERIC,v.NUMERIC,H),st=j(L.ALPHANUMERIC,v.ALPHANUMERIC,H),lt,ft;return O.isKanjiModeEnabled()?(lt=j(L.BYTE,v.BYTE,H),ft=j(L.KANJI,v.KANJI,H)):(lt=j(L.BYTE_KANJI,v.BYTE,H),ft=[]),tt.concat(st,lt,ft).sort(function(xt,wt){return xt.index-wt.index}).map(function(xt){return{data:xt.data,mode:xt.mode,length:xt.length}})}function Z(H,tt){switch(tt){case v.NUMERIC:return k.getBitsLength(H);case v.ALPHANUMERIC:return N.getBitsLength(H);case v.KANJI:return W.getBitsLength(H);case v.BYTE:return F.getBitsLength(H)}}function Y(H){return H.reduce(function(tt,st){let lt=tt.length-1>=0?tt[tt.length-1]:null;return lt&&lt.mode===st.mode?(tt[tt.length-1].data+=st.data,tt):(tt.push(st),tt)},[])}function X(H){let tt=[];for(let st=0;st<H.length;st++){let lt=H[st];switch(lt.mode){case v.NUMERIC:tt.push([lt,{data:lt.data,mode:v.ALPHANUMERIC,length:lt.length},{data:lt.data,mode:v.BYTE,length:lt.length}]);break;case v.ALPHANUMERIC:tt.push([lt,{data:lt.data,mode:v.BYTE,length:lt.length}]);break;case v.KANJI:tt.push([lt,{data:lt.data,mode:v.BYTE,length:B(lt.data)}]);break;case v.BYTE:tt.push([{data:lt.data,mode:v.BYTE,length:B(lt.data)}])}}return tt}function J(H,tt){let st={},lt={start:{}},ft=["start"];for(let gt=0;gt<H.length;gt++){let xt=H[gt],wt=[];for(let _t=0;_t<xt.length;_t++){let bt=xt[_t],Tt=""+gt+_t;wt.push(Tt),st[Tt]={node:bt,lastCount:0},lt[Tt]={};for(let qt=0;qt<ft.length;qt++){let It=ft[qt];st[It]&&st[It].node.mode===bt.mode?(lt[It][Tt]=Z(st[It].lastCount+bt.length,bt.mode)-Z(st[It].lastCount,bt.mode),st[It].lastCount+=bt.length):(st[It]&&(st[It].lastCount=bt.length),lt[It][Tt]=Z(bt.length,bt.mode)+4+v.getCharCountIndicator(bt.mode,tt))}}ft=wt}for(let gt=0;gt<ft.length;gt++)lt[ft[gt]].end=0;return{map:lt,table:st}}function q(H,tt){let st,lt=v.getBestModeForData(H);if(st=v.from(tt,lt),st!==v.BYTE&&st.bit<lt.bit)throw new Error('"'+H+'" cannot be encoded with mode '+v.toString(st)+`.
 Suggested mode is: `+v.toString(lt));switch(st===v.KANJI&&!O.isKanjiModeEnabled()&&(st=v.BYTE),st){case v.NUMERIC:return new k(H);case v.ALPHANUMERIC:return new N(H);case v.KANJI:return new W(H);case v.BYTE:return new F(H)}}p.fromArray=function(tt){return tt.reduce(function(st,lt){return typeof lt=="string"?st.push(q(lt,null)):lt.data&&st.push(q(lt.data,lt.mode)),st},[])},p.fromString=function(tt,st){let lt=K(tt,O.isKanjiModeEnabled()),ft=X(lt),gt=J(ft,st),xt=S.find_path(gt.map,"start","end"),wt=[];for(let _t=1;_t<xt.length-1;_t++)wt.push(gt.table[xt[_t]].node);return p.fromArray(Y(wt))},p.rawSplit=function(tt){return p.fromArray(K(tt,O.isKanjiModeEnabled()))}}(J3t)),J3t}var HDt;function z$t(){if(HDt)return B3t;HDt=1;let p=U8(),v=hkt(),k=jse(),N=Use(),F=Wse(),W=Vse(),L=Gse(),O=O$t(),S=qse(),B=Xse(),j=Kse(),K=W8(),Z=nue();function Y(gt,xt){let wt=gt.size,_t=W.getPositions(xt);for(let bt=0;bt<_t.length;bt++){let Tt=_t[bt][0],qt=_t[bt][1];for(let It=-1;It<=7;It++)if(!(Tt+It<=-1||wt<=Tt+It))for(let St=-1;St<=7;St++)qt+St<=-1||wt<=qt+St||(It>=0&&It<=6&&(St===0||St===6)||St>=0&&St<=6&&(It===0||It===6)||It>=2&&It<=4&&St>=2&&St<=4?gt.set(Tt+It,qt+St,!0,!0):gt.set(Tt+It,qt+St,!1,!0))}}function X(gt){let xt=gt.size;for(let wt=8;wt<xt-8;wt++){let _t=wt%2===0;gt.set(wt,6,_t,!0),gt.set(6,wt,_t,!0)}}function J(gt,xt){let wt=F.getPositions(xt);for(let _t=0;_t<wt.length;_t++){let bt=wt[_t][0],Tt=wt[_t][1];for(let qt=-2;qt<=2;qt++)for(let It=-2;It<=2;It++)qt===-2||qt===2||It===-2||It===2||qt===0&&It===0?gt.set(bt+qt,Tt+It,!0,!0):gt.set(bt+qt,Tt+It,!1,!0)}}function q(gt,xt){let wt=gt.size,_t=B.getEncodedBits(xt),bt,Tt,qt;for(let It=0;It<18;It++)bt=Math.floor(It/3),Tt=It%3+wt-8-3,qt=(_t>>It&1)===1,gt.set(bt,Tt,qt,!0),gt.set(Tt,bt,qt,!0)}function H(gt,xt,wt){let _t=gt.size,bt=j.getEncodedBits(xt,wt),Tt,qt;for(Tt=0;Tt<15;Tt++)qt=(bt>>Tt&1)===1,Tt<6?gt.set(Tt,8,qt,!0):Tt<8?gt.set(Tt+1,8,qt,!0):gt.set(_t-15+Tt,8,qt,!0),Tt<8?gt.set(8,_t-Tt-1,qt,!0):Tt<9?gt.set(8,15-Tt-1+1,qt,!0):gt.set(8,15-Tt-1,qt,!0);gt.set(_t-8,8,1,!0)}function tt(gt,xt){let wt=gt.size,_t=-1,bt=wt-1,Tt=7,qt=0;for(let It=wt-1;It>0;It-=2)for(It===6&&It--;;){for(let St=0;St<2;St++)if(!gt.isReserved(bt,It-St)){let vt=!1;qt<xt.length&&(vt=(xt[qt]>>>Tt&1)===1),gt.set(bt,It-St,vt),Tt--,Tt===-1&&(qt++,Tt=7)}if(bt+=_t,bt<0||wt<=bt){bt-=_t,_t=-_t;break}}}function st(gt,xt,wt){let _t=new k;wt.forEach(function(St){_t.put(St.mode.bit,4),_t.put(St.getLength(),K.getCharCountIndicator(St.mode,gt)),St.write(_t)});let bt=p.getSymbolTotalCodewords(gt),Tt=O.getTotalCodewordsCount(gt,xt),qt=(bt-Tt)*8;for(_t.getLengthInBits()+4<=qt&&_t.put(0,4);_t.getLengthInBits()%8!==0;)_t.putBit(0);let It=(qt-_t.getLengthInBits())/8;for(let St=0;St<It;St++)_t.put(St%2?17:236,8);return lt(_t,gt,xt)}function lt(gt,xt,wt){let _t=p.getSymbolTotalCodewords(xt),bt=O.getTotalCodewordsCount(xt,wt),Tt=_t-bt,qt=O.getBlocksCount(xt,wt),It=_t%qt,St=qt-It,vt=Math.floor(_t/qt),Ft=Math.floor(Tt/qt),Qt=Ft+1,Gt=vt-Ft,ge=new S(Gt),ee=0,Ee=new Array(qt),Bt=new Array(qt),Xt=0,we=new Uint8Array(gt.buffer);for(let te=0;te<qt;te++){let Me=te<St?Ft:Qt;Ee[te]=we.slice(ee,ee+Me),Bt[te]=ge.encode(Ee[te]),ee+=Me,Xt=Math.max(Xt,Me)}let ie=new Uint8Array(_t),m=0,ye,Ge;for(ye=0;ye<Xt;ye++)for(Ge=0;Ge<qt;Ge++)ye<Ee[Ge].length&&(ie[m++]=Ee[Ge][ye]);for(ye=0;ye<Gt;ye++)for(Ge=0;Ge<qt;Ge++)ie[m++]=Bt[Ge][ye];return ie}function ft(gt,xt,wt,_t){let bt;if(Array.isArray(gt))bt=Z.fromArray(gt);else if(typeof gt=="string"){let vt=xt;if(!vt){let Ft=Z.rawSplit(gt);vt=B.getBestVersionForData(Ft,wt)}bt=Z.fromString(gt,vt||40)}else throw new Error("Invalid data");let Tt=B.getBestVersionForData(bt,wt);if(!Tt)throw new Error("The amount of data is too big to be stored in a QR Code");if(!xt)xt=Tt;else if(xt<Tt)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+Tt+`.
`);let qt=st(xt,wt,bt),It=p.getSymbolSize(xt),St=new N(It);return Y(St,xt),X(St),J(St,xt),H(St,wt,0),xt>=7&&q(St,xt),tt(St,qt),isNaN(_t)&&(_t=L.getBestMask(St,H.bind(null,St,wt))),L.applyMask(_t,St),H(St,wt,_t),{modules:St,version:xt,errorCorrectionLevel:wt,maskPattern:_t,segments:bt}}return B3t.create=function(xt,wt){if(typeof xt>"u"||xt==="")throw new Error("No input text");let _t=v.M,bt,Tt;return typeof wt<"u"&&(_t=v.from(wt.errorCorrectionLevel,v.M),bt=B.from(wt.version),Tt=L.from(wt.maskPattern),wt.toSJISFunc&&p.setToSJISFunction(wt.toSJISFunc)),ft(xt,bt,_t,Tt)},B3t}var awt={},rue={},iue=Object.freeze({__proto__:null,default:rue}),dkt=M9(iue),owt={},fh;typeof Object.create=="function"?fh=function(v,k){v.super_=k,v.prototype=Object.create(k.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}})}:fh=function(v,k){v.super_=k;var N=function(){};N.prototype=k.prototype,v.prototype=new N,v.prototype.constructor=v};var aue=/%[sdj%]/g;function flt(p){if(!CG(p)){for(var v=[],k=0;k<arguments.length;k++)v.push(e2(arguments[k]));return v.join(" ")}for(var k=1,N=arguments,F=N.length,W=String(p).replace(aue,function(O){if(O==="%%")return"%";if(k>=F)return O;switch(O){case"%s":return String(N[k++]);case"%d":return Number(N[k++]);case"%j":try{return JSON.stringify(N[k++])}catch{return"[Circular]"}default:return O}}),L=N[k];k<F;L=N[++k])_G(L)||!V8(L)?W+=" "+L:W+=" "+e2(L);return W}function plt(p,v){if(ov(uw.process))return function(){return plt(p,v).apply(this,arguments)};if(Iu.noDeprecation===!0)return p;var k=!1;function N(){if(!k){if(Iu.throwDeprecation)throw new Error(v);Iu.traceDeprecation?console.trace(v):console.error(v),k=!0}return p.apply(this,arguments)}return N}var ust={},swt;function fkt(p){if(ov(swt)&&(swt=Iu.env.NODE_DEBUG||""),p=p.toUpperCase(),!ust[p])if(new RegExp("\\b"+p+"\\b","i").test(swt)){var v=0;ust[p]=function(){var k=flt.apply(null,arguments);console.error("%s %d: %s",p,v,k)}}else ust[p]=function(){};return ust[p]}function e2(p,v){var k={seen:[],stylize:sue};return arguments.length>=3&&(k.depth=arguments[2]),arguments.length>=4&&(k.colors=arguments[3]),mlt(v)?k.showHidden=v:v&&ykt(k,v),ov(k.showHidden)&&(k.showHidden=!1),ov(k.depth)&&(k.depth=2),ov(k.colors)&&(k.colors=!1),ov(k.customInspect)&&(k.customInspect=!0),k.colors&&(k.stylize=oue),But(k,p,k.depth)}e2.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};e2.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function oue(p,v){var k=e2.styles[v];return k?"\x1B["+e2.colors[k][0]+"m"+p+"\x1B["+e2.colors[k][1]+"m":p}function sue(p,v){return p}function uue(p){var v={};return p.forEach(function(k,N){v[k]=!0}),v}function But(p,v,k){if(p.customInspect&&v&&w8(v.inspect)&&v.inspect!==e2&&!(v.constructor&&v.constructor.prototype===v)){var N=v.inspect(k,p);return CG(N)||(N=But(p,N,k)),N}var F=lue(p,v);if(F)return F;var W=Object.keys(v),L=uue(W);if(p.showHidden&&(W=Object.getOwnPropertyNames(v)),ID(v)&&(W.indexOf("message")>=0||W.indexOf("description")>=0))return uwt(v);if(W.length===0){if(w8(v)){var O=v.name?": "+v.name:"";return p.stylize("[Function"+O+"]","special")}if(b8(v))return p.stylize(RegExp.prototype.toString.call(v),"regexp");if(jD(v))return p.stylize(Date.prototype.toString.call(v),"date");if(ID(v))return uwt(v)}var S="",B=!1,j=["{","}"];if(pkt(v)&&(B=!0,j=["[","]"]),w8(v)){var K=v.name?": "+v.name:"";S=" [Function"+K+"]"}if(b8(v)&&(S=" "+RegExp.prototype.toString.call(v)),jD(v)&&(S=" "+Date.prototype.toUTCString.call(v)),ID(v)&&(S=" "+uwt(v)),W.length===0&&(!B||v.length==0))return j[0]+S+j[1];if(k<0)return b8(v)?p.stylize(RegExp.prototype.toString.call(v),"regexp"):p.stylize("[Object]","special");p.seen.push(v);var Z;return B?Z=cue(p,v,k,L,W):Z=W.map(function(Y){return l4t(p,v,k,L,Y,B)}),p.seen.pop(),hue(Z,S,j)}function lue(p,v){if(ov(v))return p.stylize("undefined","undefined");if(CG(v)){var k="'"+JSON.stringify(v).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return p.stylize(k,"string")}if(mkt(v))return p.stylize(""+v,"number");if(mlt(v))return p.stylize(""+v,"boolean");if(_G(v))return p.stylize("null","null")}function uwt(p){return"["+Error.prototype.toString.call(p)+"]"}function cue(p,v,k,N,F){for(var W=[],L=0,O=v.length;L<O;++L)W$t(v,String(L))?W.push(l4t(p,v,k,N,String(L),!0)):W.push("");return F.forEach(function(S){S.match(/^\d+$/)||W.push(l4t(p,v,k,N,S,!0))}),W}function l4t(p,v,k,N,F,W){var L,O,S;if(S=Object.getOwnPropertyDescriptor(v,F)||{value:v[F]},S.get?S.set?O=p.stylize("[Getter/Setter]","special"):O=p.stylize("[Getter]","special"):S.set&&(O=p.stylize("[Setter]","special")),W$t(N,F)||(L="["+F+"]"),O||(p.seen.indexOf(S.value)<0?(_G(k)?O=But(p,S.value,null):O=But(p,S.value,k-1),O.indexOf(`
`)>-1&&(W?O=O.split(`
`).map(function(B){return"  "+B}).join(`
`).substr(2):O=`
`+O.split(`
`).map(function(B){return"   "+B}).join(`
`))):O=p.stylize("[Circular]","special")),ov(L)){if(W&&F.match(/^\d+$/))return O;L=JSON.stringify(""+F),L.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(L=L.substr(1,L.length-2),L=p.stylize(L,"name")):(L=L.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),L=p.stylize(L,"string"))}return L+": "+O}function hue(p,v,k){var N=p.reduce(function(F,W){return W.indexOf(`
`)>=0,F+W.replace(/\u001b\[\d\d?m/g,"").length+1},0);return N>60?k[0]+(v===""?"":v+`
 `)+" "+p.join(`,
  `)+" "+k[1]:k[0]+v+" "+p.join(", ")+" "+k[1]}function pkt(p){return Array.isArray(p)}function mlt(p){return typeof p=="boolean"}function _G(p){return p===null}function P$t(p){return p==null}function mkt(p){return typeof p=="number"}function CG(p){return typeof p=="string"}function B$t(p){return typeof p=="symbol"}function ov(p){return p===void 0}function b8(p){return V8(p)&&gkt(p)==="[object RegExp]"}function V8(p){return typeof p=="object"&&p!==null}function jD(p){return V8(p)&&gkt(p)==="[object Date]"}function ID(p){return V8(p)&&(gkt(p)==="[object Error]"||p instanceof Error)}function w8(p){return typeof p=="function"}function jut(p){return p===null||typeof p=="boolean"||typeof p=="number"||typeof p=="string"||typeof p=="symbol"||typeof p>"u"}function j$t(p){return Un.isBuffer(p)}function gkt(p){return Object.prototype.toString.call(p)}function lwt(p){return p<10?"0"+p.toString(10):p.toString(10)}var due=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function fue(){var p=new Date,v=[lwt(p.getHours()),lwt(p.getMinutes()),lwt(p.getSeconds())].join(":");return[p.getDate(),due[p.getMonth()],v].join(" ")}function U$t(){console.log("%s - %s",fue(),flt.apply(null,arguments))}function ykt(p,v){if(!v||!V8(v))return p;for(var k=Object.keys(v),N=k.length;N--;)p[k[N]]=v[k[N]];return p}function W$t(p,v){return Object.prototype.hasOwnProperty.call(p,v)}var pue={inherits:fh,_extend:ykt,log:U$t,isBuffer:j$t,isPrimitive:jut,isFunction:w8,isError:ID,isDate:jD,isObject:V8,isRegExp:b8,isUndefined:ov,isSymbol:B$t,isString:CG,isNumber:mkt,isNullOrUndefined:P$t,isNull:_G,isBoolean:mlt,isArray:pkt,inspect:e2,deprecate:plt,format:flt,debuglog:fkt},mue=Object.freeze({__proto__:null,_extend:ykt,debuglog:fkt,default:pue,deprecate:plt,format:flt,inherits:fh,inspect:e2,isArray:pkt,isBoolean:mlt,isBuffer:j$t,isDate:jD,isError:ID,isFunction:w8,isNull:_G,isNullOrUndefined:P$t,isNumber:mkt,isObject:V8,isPrimitive:jut,isRegExp:b8,isString:CG,isSymbol:B$t,isUndefined:ov,log:U$t}),XD=M9(mue),cwt;function l5(){}l5.prototype=Object.create(null);function Yo(){Yo.init.call(this)}Yo.EventEmitter=Yo;Yo.usingDomains=!1;Yo.prototype.domain=void 0;Yo.prototype._events=void 0;Yo.prototype._maxListeners=void 0;Yo.defaultMaxListeners=10;Yo.init=function(){this.domain=null,Yo.usingDomains&&cwt.active&&!(this instanceof cwt.Domain)&&(this.domain=cwt.active),(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new l5,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Yo.prototype.setMaxListeners=function(v){if(typeof v!="number"||v<0||isNaN(v))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=v,this};function V$t(p){return p._maxListeners===void 0?Yo.defaultMaxListeners:p._maxListeners}Yo.prototype.getMaxListeners=function(){return V$t(this)};function gue(p,v,k){if(v)p.call(k);else for(var N=p.length,F=EG(p,N),W=0;W<N;++W)F[W].call(k)}function yue(p,v,k,N){if(v)p.call(k,N);else for(var F=p.length,W=EG(p,F),L=0;L<F;++L)W[L].call(k,N)}function vue(p,v,k,N,F){if(v)p.call(k,N,F);else for(var W=p.length,L=EG(p,W),O=0;O<W;++O)L[O].call(k,N,F)}function bue(p,v,k,N,F,W){if(v)p.call(k,N,F,W);else for(var L=p.length,O=EG(p,L),S=0;S<L;++S)O[S].call(k,N,F,W)}function wue(p,v,k,N){if(v)p.apply(k,N);else for(var F=p.length,W=EG(p,F),L=0;L<F;++L)W[L].apply(k,N)}Yo.prototype.emit=function(v){var k,N,F,W,L,O,S,B=v==="error";if(O=this._events,O)B=B&&O.error==null;else if(!B)return!1;if(S=this.domain,B){if(k=arguments[1],S)k||(k=new Error('Uncaught, unspecified "error" event')),k.domainEmitter=this,k.domain=S,k.domainThrown=!1,S.emit("error",k);else{if(k instanceof Error)throw k;var j=new Error('Uncaught, unspecified "error" event. ('+k+")");throw j.context=k,j}return!1}if(N=O[v],!N)return!1;var K=typeof N=="function";switch(F=arguments.length,F){case 1:gue(N,K,this);break;case 2:yue(N,K,this,arguments[1]);break;case 3:vue(N,K,this,arguments[1],arguments[2]);break;case 4:bue(N,K,this,arguments[1],arguments[2],arguments[3]);break;default:for(W=new Array(F-1),L=1;L<F;L++)W[L-1]=arguments[L];wue(N,K,this,W)}return!0};function G$t(p,v,k,N){var F,W,L;if(typeof k!="function")throw new TypeError('"listener" argument must be a function');if(W=p._events,W?(W.newListener&&(p.emit("newListener",v,k.listener?k.listener:k),W=p._events),L=W[v]):(W=p._events=new l5,p._eventsCount=0),!L)L=W[v]=k,++p._eventsCount;else if(typeof L=="function"?L=W[v]=N?[k,L]:[L,k]:N?L.unshift(k):L.push(k),!L.warned&&(F=V$t(p),F&&F>0&&L.length>F)){L.warned=!0;var O=new Error("Possible EventEmitter memory leak detected. "+L.length+" "+v+" listeners added. Use emitter.setMaxListeners() to increase limit");O.name="MaxListenersExceededWarning",O.emitter=p,O.type=v,O.count=L.length,xue(O)}return p}function xue(p){typeof console.warn=="function"?console.warn(p):console.log(p)}Yo.prototype.addListener=function(v,k){return G$t(this,v,k,!1)};Yo.prototype.on=Yo.prototype.addListener;Yo.prototype.prependListener=function(v,k){return G$t(this,v,k,!0)};function H$t(p,v,k){var N=!1;function F(){p.removeListener(v,F),N||(N=!0,k.apply(p,arguments))}return F.listener=k,F}Yo.prototype.once=function(v,k){if(typeof k!="function")throw new TypeError('"listener" argument must be a function');return this.on(v,H$t(this,v,k)),this};Yo.prototype.prependOnceListener=function(v,k){if(typeof k!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(v,H$t(this,v,k)),this};Yo.prototype.removeListener=function(v,k){var N,F,W,L,O;if(typeof k!="function")throw new TypeError('"listener" argument must be a function');if(F=this._events,!F)return this;if(N=F[v],!N)return this;if(N===k||N.listener&&N.listener===k)--this._eventsCount===0?this._events=new l5:(delete F[v],F.removeListener&&this.emit("removeListener",v,N.listener||k));else if(typeof N!="function"){for(W=-1,L=N.length;L-- >0;)if(N[L]===k||N[L].listener&&N[L].listener===k){O=N[L].listener,W=L;break}if(W<0)return this;if(N.length===1){if(N[0]=void 0,--this._eventsCount===0)return this._events=new l5,this;delete F[v]}else kue(N,W);F.removeListener&&this.emit("removeListener",v,O||k)}return this};Yo.prototype.removeAllListeners=function(v){var k,N;if(N=this._events,!N)return this;if(!N.removeListener)return arguments.length===0?(this._events=new l5,this._eventsCount=0):N[v]&&(--this._eventsCount===0?this._events=new l5:delete N[v]),this;if(arguments.length===0){for(var F=Object.keys(N),W=0,L;W<F.length;++W)L=F[W],L!=="removeListener"&&this.removeAllListeners(L);return this.removeAllListeners("removeListener"),this._events=new l5,this._eventsCount=0,this}if(k=N[v],typeof k=="function")this.removeListener(v,k);else if(k)do this.removeListener(v,k[k.length-1]);while(k[0]);return this};Yo.prototype.listeners=function(v){var k,N,F=this._events;return F?(k=F[v],k?typeof k=="function"?N=[k.listener||k]:N=Sue(k):N=[]):N=[],N};Yo.listenerCount=function(p,v){return typeof p.listenerCount=="function"?p.listenerCount(v):Y$t.call(p,v)};Yo.prototype.listenerCount=Y$t;function Y$t(p){var v=this._events;if(v){var k=v[p];if(typeof k=="function")return 1;if(k)return k.length}return 0}Yo.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function kue(p,v){for(var k=v,N=k+1,F=p.length;N<F;k+=1,N+=1)p[k]=p[N];p.pop()}function EG(p,v){for(var k=new Array(v);v--;)k[v]=p[v];return k}function Sue(p){for(var v=new Array(p.length),k=0;k<v.length;++k)v[k]=p[k].listener||p[k];return v}function G8(){this.head=null,this.tail=null,this.length=0}G8.prototype.push=function(p){var v={data:p,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length};G8.prototype.unshift=function(p){var v={data:p,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length};G8.prototype.shift=function(){if(this.length!==0){var p=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,p}};G8.prototype.clear=function(){this.head=this.tail=null,this.length=0};G8.prototype.join=function(p){if(this.length===0)return"";for(var v=this.head,k=""+v.data;v=v.next;)k+=p+v.data;return k};G8.prototype.concat=function(p){if(this.length===0)return Un.alloc(0);if(this.length===1)return this.head.data;for(var v=Un.allocUnsafe(p>>>0),k=this.head,N=0;k;)k.data.copy(v,N),N+=k.data.length,k=k.next;return v};var hwt={},lst={exports:{}},q$t=M9(oee);var YDt;function _ue(){return YDt||(YDt=1,function(p,v){var k=q$t,N=k.Buffer;function F(L,O){for(var S in L)O[S]=L[S]}N.from&&N.alloc&&N.allocUnsafe&&N.allocUnsafeSlow?p.exports=k:(F(k,v),v.Buffer=W);function W(L,O,S){return N(L,O,S)}W.prototype=Object.create(N.prototype),F(N,W),W.from=function(L,O,S){if(typeof L=="number")throw new TypeError("Argument must not be a number");return N(L,O,S)},W.alloc=function(L,O,S){if(typeof L!="number")throw new TypeError("Argument must be a number");var B=N(L);return O!==void 0?typeof S=="string"?B.fill(O,S):B.fill(O):B.fill(0),B},W.allocUnsafe=function(L){if(typeof L!="number")throw new TypeError("Argument must be a number");return N(L)},W.allocUnsafeSlow=function(L){if(typeof L!="number")throw new TypeError("Argument must be a number");return k.SlowBuffer(L)}}(lst,lst.exports)),lst.exports}var qDt;function Cue(){if(qDt)return hwt;qDt=1;var p=_ue().Buffer,v=p.isEncoding||function(H){switch(H=""+H,H&&H.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function k(H){if(!H)return"utf8";for(var tt;;)switch(H){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return H;default:if(tt)return;H=(""+H).toLowerCase(),tt=!0}}function N(H){var tt=k(H);if(typeof tt!="string"&&(p.isEncoding===v||!v(H)))throw new Error("Unknown encoding: "+H);return tt||H}hwt.StringDecoder=F;function F(H){this.encoding=N(H);var tt;switch(this.encoding){case"utf16le":this.text=K,this.end=Z,tt=4;break;case"utf8":this.fillLast=S,tt=4;break;case"base64":this.text=Y,this.end=X,tt=3;break;default:this.write=J,this.end=q;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=p.allocUnsafe(tt)}F.prototype.write=function(H){if(H.length===0)return"";var tt,st;if(this.lastNeed){if(tt=this.fillLast(H),tt===void 0)return"";st=this.lastNeed,this.lastNeed=0}else st=0;return st<H.length?tt?tt+this.text(H,st):this.text(H,st):tt||""},F.prototype.end=j,F.prototype.text=B,F.prototype.fillLast=function(H){if(this.lastNeed<=H.length)return H.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);H.copy(this.lastChar,this.lastTotal-this.lastNeed,0,H.length),this.lastNeed-=H.length};function W(H){return H<=127?0:H>>5===6?2:H>>4===14?3:H>>3===30?4:H>>6===2?-1:-2}function L(H,tt,st){var lt=tt.length-1;if(lt<st)return 0;var ft=W(tt[lt]);return ft>=0?(ft>0&&(H.lastNeed=ft-1),ft):--lt<st||ft===-2?0:(ft=W(tt[lt]),ft>=0?(ft>0&&(H.lastNeed=ft-2),ft):--lt<st||ft===-2?0:(ft=W(tt[lt]),ft>=0?(ft>0&&(ft===2?ft=0:H.lastNeed=ft-3),ft):0))}function O(H,tt,st){if((tt[0]&192)!==128)return H.lastNeed=0,"\uFFFD";if(H.lastNeed>1&&tt.length>1){if((tt[1]&192)!==128)return H.lastNeed=1,"\uFFFD";if(H.lastNeed>2&&tt.length>2&&(tt[2]&192)!==128)return H.lastNeed=2,"\uFFFD"}}function S(H){var tt=this.lastTotal-this.lastNeed,st=O(this,H);if(st!==void 0)return st;if(this.lastNeed<=H.length)return H.copy(this.lastChar,tt,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);H.copy(this.lastChar,tt,0,H.length),this.lastNeed-=H.length}function B(H,tt){var st=L(this,H,tt);if(!this.lastNeed)return H.toString("utf8",tt);this.lastTotal=st;var lt=H.length-(st-this.lastNeed);return H.copy(this.lastChar,0,lt),H.toString("utf8",tt,lt)}function j(H){var tt=H&&H.length?this.write(H):"";return this.lastNeed?tt+"\uFFFD":tt}function K(H,tt){if((H.length-tt)%2===0){var st=H.toString("utf16le",tt);if(st){var lt=st.charCodeAt(st.length-1);if(lt>=55296&&lt<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=H[H.length-2],this.lastChar[1]=H[H.length-1],st.slice(0,-1)}return st}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=H[H.length-1],H.toString("utf16le",tt,H.length-1)}function Z(H){var tt=H&&H.length?this.write(H):"";if(this.lastNeed){var st=this.lastTotal-this.lastNeed;return tt+this.lastChar.toString("utf16le",0,st)}return tt}function Y(H,tt){var st=(H.length-tt)%3;return st===0?H.toString("base64",tt):(this.lastNeed=3-st,this.lastTotal=3,st===1?this.lastChar[0]=H[H.length-1]:(this.lastChar[0]=H[H.length-2],this.lastChar[1]=H[H.length-1]),H.toString("base64",tt,H.length-st))}function X(H){var tt=H&&H.length?this.write(H):"";return this.lastNeed?tt+this.lastChar.toString("base64",0,3-this.lastNeed):tt}function J(H){return H.toString(this.encoding)}function q(H){return H&&H.length?this.write(H):""}return hwt}var X$t=Cue();Cl.ReadableState=K$t;var Ks=fkt("stream");fh(Cl,Yo);function Eue(p,v,k){if(typeof p.prependListener=="function")return p.prependListener(v,k);!p._events||!p._events[v]?p.on(v,k):Array.isArray(p._events[v])?p._events[v].unshift(k):p._events[v]=[k,p._events[v]]}function Tue(p,v){return p.listeners(v).length}function K$t(p,v){p=p||{},this.objectMode=!!p.objectMode,v instanceof om&&(this.objectMode=this.objectMode||!!p.readableObjectMode);var k=p.highWaterMark,N=this.objectMode?16:16*1024;this.highWaterMark=k||k===0?k:N,this.highWaterMark=~~this.highWaterMark,this.buffer=new G8,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=p.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,p.encoding&&(this.decoder=new X$t.StringDecoder(p.encoding),this.encoding=p.encoding)}function Cl(p){if(!(this instanceof Cl))return new Cl(p);this._readableState=new K$t(p,this),this.readable=!0,p&&typeof p.read=="function"&&(this._read=p.read),Yo.call(this)}Cl.prototype.push=function(p,v){var k=this._readableState;return!k.objectMode&&typeof p=="string"&&(v=v||k.defaultEncoding,v!==k.encoding&&(p=Un.from(p,v),v="")),Z$t(this,k,p,v,!1)};Cl.prototype.unshift=function(p){var v=this._readableState;return Z$t(this,v,p,"",!0)};Cl.prototype.isPaused=function(){return this._readableState.flowing===!1};function Z$t(p,v,k,N,F){var W=Nue(v,k);if(W)p.emit("error",W);else if(k===null)v.reading=!1,Mue(p,v);else if(v.objectMode||k&&k.length>0)if(v.ended&&!F){var L=new Error("stream.push() after EOF");p.emit("error",L)}else if(v.endEmitted&&F){var O=new Error("stream.unshift() after end event");p.emit("error",O)}else{var S;v.decoder&&!F&&!N&&(k=v.decoder.write(k),S=!v.objectMode&&k.length===0),F||(v.reading=!1),S||(v.flowing&&v.length===0&&!v.sync?(p.emit("data",k),p.read(0)):(v.length+=v.objectMode?1:k.length,F?v.buffer.unshift(k):v.buffer.push(k),v.needReadable&&glt(p))),Due(p,v)}else F||(v.reading=!1);return Aue(v)}function Aue(p){return!p.ended&&(p.needReadable||p.length<p.highWaterMark||p.length===0)}Cl.prototype.setEncoding=function(p){return this._readableState.decoder=new X$t.StringDecoder(p),this._readableState.encoding=p,this};var XDt=8388608;function Iue(p){return p>=XDt?p=XDt:(p--,p|=p>>>1,p|=p>>>2,p|=p>>>4,p|=p>>>8,p|=p>>>16,p++),p}function KDt(p,v){return p<=0||v.length===0&&v.ended?0:v.objectMode?1:p!==p?v.flowing&&v.length?v.buffer.head.data.length:v.length:(p>v.highWaterMark&&(v.highWaterMark=Iue(p)),p<=v.length?p:v.ended?v.length:(v.needReadable=!0,0))}Cl.prototype.read=function(p){Ks("read",p),p=parseInt(p,10);var v=this._readableState,k=p;if(p!==0&&(v.emittedReadable=!1),p===0&&v.needReadable&&(v.length>=v.highWaterMark||v.ended))return Ks("read: emitReadable",v.length,v.ended),v.length===0&&v.ended?dwt(this):glt(this),null;if(p=KDt(p,v),p===0&&v.ended)return v.length===0&&dwt(this),null;var N=v.needReadable;Ks("need readable",N),(v.length===0||v.length-p<v.highWaterMark)&&(N=!0,Ks("length less than watermark",N)),v.ended||v.reading?(N=!1,Ks("reading or ended",N)):N&&(Ks("do read"),v.reading=!0,v.sync=!0,v.length===0&&(v.needReadable=!0),this._read(v.highWaterMark),v.sync=!1,v.reading||(p=KDt(k,v)));var F;return p>0?F=Q$t(p,v):F=null,F===null?(v.needReadable=!0,p=0):v.length-=p,v.length===0&&(v.ended||(v.needReadable=!0),k!==p&&v.ended&&dwt(this)),F!==null&&this.emit("data",F),F};function Nue(p,v){var k=null;return!Un.isBuffer(v)&&typeof v!="string"&&v!==null&&v!==void 0&&!p.objectMode&&(k=new TypeError("Invalid non-string/buffer chunk")),k}function Mue(p,v){if(!v.ended){if(v.decoder){var k=v.decoder.end();k&&k.length&&(v.buffer.push(k),v.length+=v.objectMode?1:k.length)}v.ended=!0,glt(p)}}function glt(p){var v=p._readableState;v.needReadable=!1,v.emittedReadable||(Ks("emitReadable",v.flowing),v.emittedReadable=!0,v.sync?um(ZDt,p):ZDt(p))}function ZDt(p){Ks("emit readable"),p.emit("readable"),vkt(p)}function Due(p,v){v.readingMore||(v.readingMore=!0,um(Rue,p,v))}function Rue(p,v){for(var k=v.length;!v.reading&&!v.flowing&&!v.ended&&v.length<v.highWaterMark&&(Ks("maybeReadMore read 0"),p.read(0),k!==v.length);)k=v.length;v.readingMore=!1}Cl.prototype._read=function(p){this.emit("error",new Error("not implemented"))};Cl.prototype.pipe=function(p,v){var k=this,N=this._readableState;switch(N.pipesCount){case 0:N.pipes=p;break;case 1:N.pipes=[N.pipes,p];break;default:N.pipes.push(p);break}N.pipesCount+=1,Ks("pipe count=%d opts=%j",N.pipesCount,v);var F=!v||v.end!==!1,W=F?O:j;N.endEmitted?um(W):k.once("end",W),p.on("unpipe",L);function L(H){Ks("onunpipe"),H===k&&j()}function O(){Ks("onend"),p.end()}var S=Fue(k);p.on("drain",S);var B=!1;function j(){Ks("cleanup"),p.removeListener("close",X),p.removeListener("finish",J),p.removeListener("drain",S),p.removeListener("error",Y),p.removeListener("unpipe",L),k.removeListener("end",O),k.removeListener("end",j),k.removeListener("data",Z),B=!0,N.awaitDrain&&(!p._writableState||p._writableState.needDrain)&&S()}var K=!1;k.on("data",Z);function Z(H){Ks("ondata"),K=!1;var tt=p.write(H);tt===!1&&!K&&((N.pipesCount===1&&N.pipes===p||N.pipesCount>1&&J$t(N.pipes,p)!==-1)&&!B&&(Ks("false write response, pause",k._readableState.awaitDrain),k._readableState.awaitDrain++,K=!0),k.pause())}function Y(H){Ks("onerror",H),q(),p.removeListener("error",Y),Tue(p,"error")===0&&p.emit("error",H)}Eue(p,"error",Y);function X(){p.removeListener("finish",J),q()}p.once("close",X);function J(){Ks("onfinish"),p.removeListener("close",X),q()}p.once("finish",J);function q(){Ks("unpipe"),k.unpipe(p)}return p.emit("pipe",k),N.flowing||(Ks("pipe resume"),k.resume()),p};function Fue(p){return function(){var v=p._readableState;Ks("pipeOnDrain",v.awaitDrain),v.awaitDrain&&v.awaitDrain--,v.awaitDrain===0&&p.listeners("data").length&&(v.flowing=!0,vkt(p))}}Cl.prototype.unpipe=function(p){var v=this._readableState;if(v.pipesCount===0)return this;if(v.pipesCount===1)return p&&p!==v.pipes?this:(p||(p=v.pipes),v.pipes=null,v.pipesCount=0,v.flowing=!1,p&&p.emit("unpipe",this),this);if(!p){var k=v.pipes,N=v.pipesCount;v.pipes=null,v.pipesCount=0,v.flowing=!1;for(var F=0;F<N;F++)k[F].emit("unpipe",this);return this}var W=J$t(v.pipes,p);return W===-1?this:(v.pipes.splice(W,1),v.pipesCount-=1,v.pipesCount===1&&(v.pipes=v.pipes[0]),p.emit("unpipe",this),this)};Cl.prototype.on=function(p,v){var k=Yo.prototype.on.call(this,p,v);if(p==="data")this._readableState.flowing!==!1&&this.resume();else if(p==="readable"){var N=this._readableState;!N.endEmitted&&!N.readableListening&&(N.readableListening=N.needReadable=!0,N.emittedReadable=!1,N.reading?N.length&&glt(this):um(Oue,this))}return k};Cl.prototype.addListener=Cl.prototype.on;function Oue(p){Ks("readable nexttick read 0"),p.read(0)}Cl.prototype.resume=function(){var p=this._readableState;return p.flowing||(Ks("resume"),p.flowing=!0,Lue(this,p)),this};function Lue(p,v){v.resumeScheduled||(v.resumeScheduled=!0,um($ue,p,v))}function $ue(p,v){v.reading||(Ks("resume read 0"),p.read(0)),v.resumeScheduled=!1,v.awaitDrain=0,p.emit("resume"),vkt(p),v.flowing&&!v.reading&&p.read(0)}Cl.prototype.pause=function(){return Ks("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Ks("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function vkt(p){var v=p._readableState;for(Ks("flow",v.flowing);v.flowing&&p.read()!==null;);}Cl.prototype.wrap=function(p){var v=this._readableState,k=!1,N=this;p.on("end",function(){if(Ks("wrapped end"),v.decoder&&!v.ended){var L=v.decoder.end();L&&L.length&&N.push(L)}N.push(null)}),p.on("data",function(L){if(Ks("wrapped data"),v.decoder&&(L=v.decoder.write(L)),!(v.objectMode&&L==null)&&!(!v.objectMode&&(!L||!L.length))){var O=N.push(L);O||(k=!0,p.pause())}});for(var F in p)this[F]===void 0&&typeof p[F]=="function"&&(this[F]=function(L){return function(){return p[L].apply(p,arguments)}}(F));var W=["error","close","destroy","pause","resume"];return Uue(W,function(L){p.on(L,N.emit.bind(N,L))}),N._read=function(L){Ks("wrapped _read",L),k&&(k=!1,p.resume())},N};Cl._fromList=Q$t;function Q$t(p,v){if(v.length===0)return null;var k;return v.objectMode?k=v.buffer.shift():!p||p>=v.length?(v.decoder?k=v.buffer.join(""):v.buffer.length===1?k=v.buffer.head.data:k=v.buffer.concat(v.length),v.buffer.clear()):k=zue(p,v.buffer,v.decoder),k}function zue(p,v,k){var N;return p<v.head.data.length?(N=v.head.data.slice(0,p),v.head.data=v.head.data.slice(p)):p===v.head.data.length?N=v.shift():N=k?Pue(p,v):Bue(p,v),N}function Pue(p,v){var k=v.head,N=1,F=k.data;for(p-=F.length;k=k.next;){var W=k.data,L=p>W.length?W.length:p;if(L===W.length?F+=W:F+=W.slice(0,p),p-=L,p===0){L===W.length?(++N,k.next?v.head=k.next:v.head=v.tail=null):(v.head=k,k.data=W.slice(L));break}++N}return v.length-=N,F}function Bue(p,v){var k=Un.allocUnsafe(p),N=v.head,F=1;for(N.data.copy(k),p-=N.data.length;N=N.next;){var W=N.data,L=p>W.length?W.length:p;if(W.copy(k,k.length-p,0,L),p-=L,p===0){L===W.length?(++F,N.next?v.head=N.next:v.head=v.tail=null):(v.head=N,N.data=W.slice(L));break}++F}return v.length-=F,k}function dwt(p){var v=p._readableState;if(v.length>0)throw new Error('"endReadable()" called on non-empty stream');v.endEmitted||(v.ended=!0,um(jue,v,p))}function jue(p,v){!p.endEmitted&&p.length===0&&(p.endEmitted=!0,v.readable=!1,v.emit("end"))}function Uue(p,v){for(var k=0,N=p.length;k<N;k++)v(p[k],k)}function J$t(p,v){for(var k=0,N=p.length;k<N;k++)if(p[k]===v)return k;return-1}_d.WritableState=bkt;fh(_d,Yo);function Wue(){}function Vue(p,v,k){this.chunk=p,this.encoding=v,this.callback=k,this.next=null}function bkt(p,v){Object.defineProperty(this,"buffer",{get:plt(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),p=p||{},this.objectMode=!!p.objectMode,v instanceof om&&(this.objectMode=this.objectMode||!!p.writableObjectMode);var k=p.highWaterMark,N=this.objectMode?16:16*1024;this.highWaterMark=k||k===0?k:N,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var F=p.decodeStrings===!1;this.decodeStrings=!F,this.defaultEncoding=p.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(W){Zue(v,W)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new rzt(this)}bkt.prototype.getBuffer=function(){for(var v=this.bufferedRequest,k=[];v;)k.push(v),v=v.next;return k};function _d(p){if(!(this instanceof _d)&&!(this instanceof om))return new _d(p);this._writableState=new bkt(p,this),this.writable=!0,p&&(typeof p.write=="function"&&(this._write=p.write),typeof p.writev=="function"&&(this._writev=p.writev)),Yo.call(this)}_d.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function Gue(p,v){var k=new Error("write after end");p.emit("error",k),um(v,k)}function Hue(p,v,k,N){var F=!0,W=!1;return k===null?W=new TypeError("May not write null values to stream"):!Un.isBuffer(k)&&typeof k!="string"&&k!==void 0&&!v.objectMode&&(W=new TypeError("Invalid non-string/buffer chunk")),W&&(p.emit("error",W),um(N,W),F=!1),F}_d.prototype.write=function(p,v,k){var N=this._writableState,F=!1;return typeof v=="function"&&(k=v,v=null),Un.isBuffer(p)?v="buffer":v||(v=N.defaultEncoding),typeof k!="function"&&(k=Wue),N.ended?Gue(this,k):Hue(this,N,p,k)&&(N.pendingcb++,F=que(this,N,p,v,k)),F};_d.prototype.cork=function(){var p=this._writableState;p.corked++};_d.prototype.uncork=function(){var p=this._writableState;p.corked&&(p.corked--,!p.writing&&!p.corked&&!p.finished&&!p.bufferProcessing&&p.bufferedRequest&&tzt(this,p))};_d.prototype.setDefaultEncoding=function(v){if(typeof v=="string"&&(v=v.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((v+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+v);return this._writableState.defaultEncoding=v,this};function Yue(p,v,k){return!p.objectMode&&p.decodeStrings!==!1&&typeof v=="string"&&(v=Un.from(v,k)),v}function que(p,v,k,N,F){k=Yue(v,k,N),Un.isBuffer(k)&&(N="buffer");var W=v.objectMode?1:k.length;v.length+=W;var L=v.length<v.highWaterMark;if(L||(v.needDrain=!0),v.writing||v.corked){var O=v.lastBufferedRequest;v.lastBufferedRequest=new Vue(k,N,F),O?O.next=v.lastBufferedRequest:v.bufferedRequest=v.lastBufferedRequest,v.bufferedRequestCount+=1}else c4t(p,v,!1,W,k,N,F);return L}function c4t(p,v,k,N,F,W,L){v.writelen=N,v.writecb=L,v.writing=!0,v.sync=!0,k?p._writev(F,v.onwrite):p._write(F,W,v.onwrite),v.sync=!1}function Xue(p,v,k,N,F){--v.pendingcb,k?um(F,N):F(N),p._writableState.errorEmitted=!0,p.emit("error",N)}function Kue(p){p.writing=!1,p.writecb=null,p.length-=p.writelen,p.writelen=0}function Zue(p,v){var k=p._writableState,N=k.sync,F=k.writecb;if(Kue(k),v)Xue(p,k,N,v,F);else{var W=ezt(k);!W&&!k.corked&&!k.bufferProcessing&&k.bufferedRequest&&tzt(p,k),N?um(QDt,p,k,W,F):QDt(p,k,W,F)}}function QDt(p,v,k,N){k||Que(p,v),v.pendingcb--,N(),nzt(p,v)}function Que(p,v){v.length===0&&v.needDrain&&(v.needDrain=!1,p.emit("drain"))}function tzt(p,v){v.bufferProcessing=!0;var k=v.bufferedRequest;if(p._writev&&k&&k.next){var N=v.bufferedRequestCount,F=new Array(N),W=v.corkedRequestsFree;W.entry=k;for(var L=0;k;)F[L]=k,k=k.next,L+=1;c4t(p,v,!0,v.length,F,"",W.finish),v.pendingcb++,v.lastBufferedRequest=null,W.next?(v.corkedRequestsFree=W.next,W.next=null):v.corkedRequestsFree=new rzt(v)}else{for(;k;){var O=k.chunk,S=k.encoding,B=k.callback,j=v.objectMode?1:O.length;if(c4t(p,v,!1,j,O,S,B),k=k.next,v.writing)break}k===null&&(v.lastBufferedRequest=null)}v.bufferedRequestCount=0,v.bufferedRequest=k,v.bufferProcessing=!1}_d.prototype._write=function(p,v,k){k(new Error("not implemented"))};_d.prototype._writev=null;_d.prototype.end=function(p,v,k){var N=this._writableState;typeof p=="function"?(k=p,p=null,v=null):typeof v=="function"&&(k=v,v=null),p!=null&&this.write(p,v),N.corked&&(N.corked=1,this.uncork()),!N.ending&&!N.finished&&Jue(this,N,k)};function ezt(p){return p.ending&&p.length===0&&p.bufferedRequest===null&&!p.finished&&!p.writing}function JDt(p,v){v.prefinished||(v.prefinished=!0,p.emit("prefinish"))}function nzt(p,v){var k=ezt(v);return k&&(v.pendingcb===0?(JDt(p,v),v.finished=!0,p.emit("finish")):JDt(p,v)),k}function Jue(p,v,k){v.ending=!0,nzt(p,v),k&&(v.finished?um(k):p.once("finish",k)),v.ended=!0,p.writable=!1}function rzt(p){var v=this;this.next=null,this.entry=null,this.finish=function(k){var N=v.entry;for(v.entry=null;N;){var F=N.callback;p.pendingcb--,F(k),N=N.next}p.corkedRequestsFree?p.corkedRequestsFree.next=v:p.corkedRequestsFree=v}}fh(om,Cl);var tRt=Object.keys(_d.prototype);for(cst=0;cst<tRt.length;cst++)hst=tRt[cst],om.prototype[hst]||(om.prototype[hst]=_d.prototype[hst]);var hst,cst;function om(p){if(!(this instanceof om))return new om(p);Cl.call(this,p),_d.call(this,p),p&&p.readable===!1&&(this.readable=!1),p&&p.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,p&&p.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",tle)}function tle(){this.allowHalfOpen||this._writableState.ended||um(ele,this)}function ele(p){p.end()}fh(sm,om);function nle(p){this.afterTransform=function(v,k){return rle(p,v,k)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function rle(p,v,k){var N=p._transformState;N.transforming=!1;var F=N.writecb;if(!F)return p.emit("error",new Error("no writecb in Transform class"));N.writechunk=null,N.writecb=null,k!=null&&p.push(k),F(v);var W=p._readableState;W.reading=!1,(W.needReadable||W.length<W.highWaterMark)&&p._read(W.highWaterMark)}function sm(p){if(!(this instanceof sm))return new sm(p);om.call(this,p),this._transformState=new nle(this);var v=this;this._readableState.needReadable=!0,this._readableState.sync=!1,p&&(typeof p.transform=="function"&&(this._transform=p.transform),typeof p.flush=="function"&&(this._flush=p.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(k){eRt(v,k)}):eRt(v)})}sm.prototype.push=function(p,v){return this._transformState.needTransform=!1,om.prototype.push.call(this,p,v)};sm.prototype._transform=function(p,v,k){throw new Error("Not implemented")};sm.prototype._write=function(p,v,k){var N=this._transformState;if(N.writecb=k,N.writechunk=p,N.writeencoding=v,!N.transforming){var F=this._readableState;(N.needTransform||F.needReadable||F.length<F.highWaterMark)&&this._read(F.highWaterMark)}};sm.prototype._read=function(p){var v=this._transformState;v.writechunk!==null&&v.writecb&&!v.transforming?(v.transforming=!0,this._transform(v.writechunk,v.writeencoding,v.afterTransform)):v.needTransform=!0};function eRt(p,v){if(v)return p.emit("error",v);var k=p._writableState,N=p._transformState;if(k.length)throw new Error("Calling transform done when ws.length != 0");if(N.transforming)throw new Error("Calling transform done when still transforming");return p.push(null)}fh(UD,sm);function UD(p){if(!(this instanceof UD))return new UD(p);sm.call(this,p)}UD.prototype._transform=function(p,v,k){k(null,p)};fh(s2,Yo);s2.Readable=Cl;s2.Writable=_d;s2.Duplex=om;s2.Transform=sm;s2.PassThrough=UD;s2.Stream=s2;function s2(){Yo.call(this)}s2.prototype.pipe=function(p,v){var k=this;function N(j){p.writable&&p.write(j)===!1&&k.pause&&k.pause()}k.on("data",N);function F(){k.readable&&k.resume&&k.resume()}p.on("drain",F),!p._isStdio&&(!v||v.end!==!1)&&(k.on("end",L),k.on("close",O));var W=!1;function L(){W||(W=!0,p.end())}function O(){W||(W=!0,typeof p.destroy=="function"&&p.destroy())}function S(j){if(B(),Yo.listenerCount(this,"error")===0)throw j}k.on("error",S),p.on("error",S);function B(){k.removeListener("data",N),p.removeListener("drain",F),k.removeListener("end",L),k.removeListener("close",O),k.removeListener("error",S),p.removeListener("error",S),k.removeListener("end",B),k.removeListener("close",B),p.removeListener("close",B)}return k.on("end",B),k.on("close",B),p.on("close",B),p.emit("pipe",k),p};var ile=Object.freeze({__proto__:null,Duplex:om,PassThrough:UD,Readable:Cl,Stream:s2,Transform:sm,Writable:_d,default:s2}),wkt=M9(ile),fwt={exports:{}},izt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function ale(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function sw(p,v,k,N,F){if(v.subarray&&p.subarray){p.set(v.subarray(k,k+N),F);return}for(var W=0;W<N;W++)p[F+W]=v[k+W]}var Uut=Uint8Array,vg=Uint16Array,Wut=Int32Array,ole=4,nRt=0,rRt=1,sle=2;function KD(p){for(var v=p.length;--v>=0;)p[v]=0}var ule=0,azt=1,lle=2,cle=3,hle=258,xkt=29,TG=256,iG=TG+1+xkt,ND=30,kkt=19,ozt=2*iG+1,s8=15,pwt=16,dle=7,Skt=256,szt=16,uzt=17,lzt=18,h4t=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Pst=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],fle=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],czt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ple=512,K3=new Array((iG+2)*2);KD(K3);var zV=new Array(ND*2);KD(zV);var aG=new Array(ple);KD(aG);var oG=new Array(hle-cle+1);KD(oG);var _kt=new Array(xkt);KD(_kt);var Vut=new Array(ND);KD(Vut);function mwt(p,v,k,N,F){this.static_tree=p,this.extra_bits=v,this.extra_base=k,this.elems=N,this.max_length=F,this.has_stree=p&&p.length}var hzt,dzt,fzt;function gwt(p,v){this.dyn_tree=p,this.max_code=0,this.stat_desc=v}function pzt(p){return p<256?aG[p]:aG[256+(p>>>7)]}function sG(p,v){p.pending_buf[p.pending++]=v&255,p.pending_buf[p.pending++]=v>>>8&255}function Jp(p,v,k){p.bi_valid>pwt-k?(p.bi_buf|=v<<p.bi_valid&65535,sG(p,p.bi_buf),p.bi_buf=v>>pwt-p.bi_valid,p.bi_valid+=k-pwt):(p.bi_buf|=v<<p.bi_valid&65535,p.bi_valid+=k)}function nv(p,v,k){Jp(p,k[v*2],k[v*2+1])}function mzt(p,v){var k=0;do k|=p&1,p>>>=1,k<<=1;while(--v>0);return k>>>1}function mle(p){p.bi_valid===16?(sG(p,p.bi_buf),p.bi_buf=0,p.bi_valid=0):p.bi_valid>=8&&(p.pending_buf[p.pending++]=p.bi_buf&255,p.bi_buf>>=8,p.bi_valid-=8)}function gle(p,v){var k=v.dyn_tree,N=v.max_code,F=v.stat_desc.static_tree,W=v.stat_desc.has_stree,L=v.stat_desc.extra_bits,O=v.stat_desc.extra_base,S=v.stat_desc.max_length,B,j,K,Z,Y,X,J=0;for(Z=0;Z<=s8;Z++)p.bl_count[Z]=0;for(k[p.heap[p.heap_max]*2+1]=0,B=p.heap_max+1;B<ozt;B++)j=p.heap[B],Z=k[k[j*2+1]*2+1]+1,Z>S&&(Z=S,J++),k[j*2+1]=Z,!(j>N)&&(p.bl_count[Z]++,Y=0,j>=O&&(Y=L[j-O]),X=k[j*2],p.opt_len+=X*(Z+Y),W&&(p.static_len+=X*(F[j*2+1]+Y)));if(J!==0){do{for(Z=S-1;p.bl_count[Z]===0;)Z--;p.bl_count[Z]--,p.bl_count[Z+1]+=2,p.bl_count[S]--,J-=2}while(J>0);for(Z=S;Z!==0;Z--)for(j=p.bl_count[Z];j!==0;)K=p.heap[--B],!(K>N)&&(k[K*2+1]!==Z&&(p.opt_len+=(Z-k[K*2+1])*k[K*2],k[K*2+1]=Z),j--)}}function gzt(p,v,k){var N=new Array(s8+1),F=0,W,L;for(W=1;W<=s8;W++)N[W]=F=F+k[W-1]<<1;for(L=0;L<=v;L++){var O=p[L*2+1];O!==0&&(p[L*2]=mzt(N[O]++,O))}}function yle(){var p,v,k,N,F,W=new Array(s8+1);for(k=0,N=0;N<xkt-1;N++)for(_kt[N]=k,p=0;p<1<<h4t[N];p++)oG[k++]=N;for(oG[k-1]=N,F=0,N=0;N<16;N++)for(Vut[N]=F,p=0;p<1<<Pst[N];p++)aG[F++]=N;for(F>>=7;N<ND;N++)for(Vut[N]=F<<7,p=0;p<1<<Pst[N]-7;p++)aG[256+F++]=N;for(v=0;v<=s8;v++)W[v]=0;for(p=0;p<=143;)K3[p*2+1]=8,p++,W[8]++;for(;p<=255;)K3[p*2+1]=9,p++,W[9]++;for(;p<=279;)K3[p*2+1]=7,p++,W[7]++;for(;p<=287;)K3[p*2+1]=8,p++,W[8]++;for(gzt(K3,iG+1,W),p=0;p<ND;p++)zV[p*2+1]=5,zV[p*2]=mzt(p,5);hzt=new mwt(K3,h4t,TG+1,iG,s8),dzt=new mwt(zV,Pst,0,ND,s8),fzt=new mwt(new Array(0),fle,0,kkt,dle)}function yzt(p){var v;for(v=0;v<iG;v++)p.dyn_ltree[v*2]=0;for(v=0;v<ND;v++)p.dyn_dtree[v*2]=0;for(v=0;v<kkt;v++)p.bl_tree[v*2]=0;p.dyn_ltree[Skt*2]=1,p.opt_len=p.static_len=0,p.last_lit=p.matches=0}function vzt(p){p.bi_valid>8?sG(p,p.bi_buf):p.bi_valid>0&&(p.pending_buf[p.pending++]=p.bi_buf),p.bi_buf=0,p.bi_valid=0}function vle(p,v,k,N){vzt(p),sG(p,k),sG(p,~k),sw(p.pending_buf,p.window,v,k,p.pending),p.pending+=k}function iRt(p,v,k,N){var F=v*2,W=k*2;return p[F]<p[W]||p[F]===p[W]&&N[v]<=N[k]}function ywt(p,v,k){for(var N=p.heap[k],F=k<<1;F<=p.heap_len&&(F<p.heap_len&&iRt(v,p.heap[F+1],p.heap[F],p.depth)&&F++,!iRt(v,N,p.heap[F],p.depth));)p.heap[k]=p.heap[F],k=F,F<<=1;p.heap[k]=N}function aRt(p,v,k){var N,F,W=0,L,O;if(p.last_lit!==0)do N=p.pending_buf[p.d_buf+W*2]<<8|p.pending_buf[p.d_buf+W*2+1],F=p.pending_buf[p.l_buf+W],W++,N===0?nv(p,F,v):(L=oG[F],nv(p,L+TG+1,v),O=h4t[L],O!==0&&(F-=_kt[L],Jp(p,F,O)),N--,L=pzt(N),nv(p,L,k),O=Pst[L],O!==0&&(N-=Vut[L],Jp(p,N,O)));while(W<p.last_lit);nv(p,Skt,v)}function d4t(p,v){var k=v.dyn_tree,N=v.stat_desc.static_tree,F=v.stat_desc.has_stree,W=v.stat_desc.elems,L,O,S=-1,B;for(p.heap_len=0,p.heap_max=ozt,L=0;L<W;L++)k[L*2]!==0?(p.heap[++p.heap_len]=S=L,p.depth[L]=0):k[L*2+1]=0;for(;p.heap_len<2;)B=p.heap[++p.heap_len]=S<2?++S:0,k[B*2]=1,p.depth[B]=0,p.opt_len--,F&&(p.static_len-=N[B*2+1]);for(v.max_code=S,L=p.heap_len>>1;L>=1;L--)ywt(p,k,L);B=W;do L=p.heap[1],p.heap[1]=p.heap[p.heap_len--],ywt(p,k,1),O=p.heap[1],p.heap[--p.heap_max]=L,p.heap[--p.heap_max]=O,k[B*2]=k[L*2]+k[O*2],p.depth[B]=(p.depth[L]>=p.depth[O]?p.depth[L]:p.depth[O])+1,k[L*2+1]=k[O*2+1]=B,p.heap[1]=B++,ywt(p,k,1);while(p.heap_len>=2);p.heap[--p.heap_max]=p.heap[1],gle(p,v),gzt(k,S,p.bl_count)}function oRt(p,v,k){var N,F=-1,W,L=v[0*2+1],O=0,S=7,B=4;for(L===0&&(S=138,B=3),v[(k+1)*2+1]=65535,N=0;N<=k;N++)W=L,L=v[(N+1)*2+1],!(++O<S&&W===L)&&(O<B?p.bl_tree[W*2]+=O:W!==0?(W!==F&&p.bl_tree[W*2]++,p.bl_tree[szt*2]++):O<=10?p.bl_tree[uzt*2]++:p.bl_tree[lzt*2]++,O=0,F=W,L===0?(S=138,B=3):W===L?(S=6,B=3):(S=7,B=4))}function sRt(p,v,k){var N,F=-1,W,L=v[0*2+1],O=0,S=7,B=4;for(L===0&&(S=138,B=3),N=0;N<=k;N++)if(W=L,L=v[(N+1)*2+1],!(++O<S&&W===L)){if(O<B)do nv(p,W,p.bl_tree);while(--O!==0);else W!==0?(W!==F&&(nv(p,W,p.bl_tree),O--),nv(p,szt,p.bl_tree),Jp(p,O-3,2)):O<=10?(nv(p,uzt,p.bl_tree),Jp(p,O-3,3)):(nv(p,lzt,p.bl_tree),Jp(p,O-11,7));O=0,F=W,L===0?(S=138,B=3):W===L?(S=6,B=3):(S=7,B=4)}}function ble(p){var v;for(oRt(p,p.dyn_ltree,p.l_desc.max_code),oRt(p,p.dyn_dtree,p.d_desc.max_code),d4t(p,p.bl_desc),v=kkt-1;v>=3&&p.bl_tree[czt[v]*2+1]===0;v--);return p.opt_len+=3*(v+1)+5+5+4,v}function wle(p,v,k,N){var F;for(Jp(p,v-257,5),Jp(p,k-1,5),Jp(p,N-4,4),F=0;F<N;F++)Jp(p,p.bl_tree[czt[F]*2+1],3);sRt(p,p.dyn_ltree,v-1),sRt(p,p.dyn_dtree,k-1)}function xle(p){var v=4093624447,k;for(k=0;k<=31;k++,v>>>=1)if(v&1&&p.dyn_ltree[k*2]!==0)return nRt;if(p.dyn_ltree[9*2]!==0||p.dyn_ltree[10*2]!==0||p.dyn_ltree[13*2]!==0)return rRt;for(k=32;k<TG;k++)if(p.dyn_ltree[k*2]!==0)return rRt;return nRt}var uRt=!1;function kle(p){uRt||(yle(),uRt=!0),p.l_desc=new gwt(p.dyn_ltree,hzt),p.d_desc=new gwt(p.dyn_dtree,dzt),p.bl_desc=new gwt(p.bl_tree,fzt),p.bi_buf=0,p.bi_valid=0,yzt(p)}function bzt(p,v,k,N){Jp(p,(ule<<1)+(N?1:0),3),vle(p,v,k)}function Sle(p){Jp(p,azt<<1,3),nv(p,Skt,K3),mle(p)}function _le(p,v,k,N){var F,W,L=0;p.level>0?(p.strm.data_type===sle&&(p.strm.data_type=xle(p)),d4t(p,p.l_desc),d4t(p,p.d_desc),L=ble(p),F=p.opt_len+3+7>>>3,W=p.static_len+3+7>>>3,W<=F&&(F=W)):F=W=k+5,k+4<=F&&v!==-1?bzt(p,v,k,N):p.strategy===ole||W===F?(Jp(p,(azt<<1)+(N?1:0),3),aRt(p,K3,zV)):(Jp(p,(lle<<1)+(N?1:0),3),wle(p,p.l_desc.max_code+1,p.d_desc.max_code+1,L+1),aRt(p,p.dyn_ltree,p.dyn_dtree)),yzt(p),N&&vzt(p)}function c5(p,v,k){return p.pending_buf[p.d_buf+p.last_lit*2]=v>>>8&255,p.pending_buf[p.d_buf+p.last_lit*2+1]=v&255,p.pending_buf[p.l_buf+p.last_lit]=k&255,p.last_lit++,v===0?p.dyn_ltree[k*2]++:(p.matches++,v--,p.dyn_ltree[(oG[k]+TG+1)*2]++,p.dyn_dtree[pzt(v)*2]++),p.last_lit===p.lit_bufsize-1}function f4t(p,v,k,N){for(var F=p&65535|0,W=p>>>16&65535|0,L=0;k!==0;){L=k>2e3?2e3:k,k-=L;do F=F+v[N++]|0,W=W+F|0;while(--L);F%=65521,W%=65521}return F|W<<16|0}function Cle(){for(var p,v=[],k=0;k<256;k++){p=k;for(var N=0;N<8;N++)p=p&1?3988292384^p>>>1:p>>>1;v[k]=p}return v}var Ele=Cle();function Wh(p,v,k,N){var F=Ele,W=N+k;p^=-1;for(var L=N;L<W;L++)p=p>>>8^F[(p^v[L])&255];return p^-1}var H8=0,Tle=1,Ale=3,h5=4,lRt=5,Kk=0,cRt=1,d5=-2,Ile=-3,vwt=-5,Nle=-1,Mle=1,dst=2,Dle=3,Rle=4,Fle=2,Ckt=8,Ole=9,Lle=29,$le=256,p4t=$le+1+Lle,zle=30,Ple=19,Ble=2*p4t+1,jle=15,Ls=3,t5=258,n2=t5+Ls+1,Ule=32,Ekt=42,m4t=69,Bst=73,jst=91,Ust=103,u8=113,IV=666,ch=1,AG=2,I8=3,ZD=4,Wle=3;function e5(p,v){return p.msg=izt[v],v}function hRt(p){return(p<<1)-(p>4?9:0)}function K9(p){for(var v=p.length;--v>=0;)p[v]=0}function Uk(p){var v=p.state,k=v.pending;k>p.avail_out&&(k=p.avail_out),k!==0&&(sw(p.output,v.pending_buf,v.pending_out,k,p.next_out),p.next_out+=k,v.pending_out+=k,p.total_out+=k,p.avail_out-=k,v.pending-=k,v.pending===0&&(v.pending_out=0))}function kd(p,v){_le(p,p.block_start>=0?p.block_start:-1,p.strstart-p.block_start,v),p.block_start=p.strstart,Uk(p.strm)}function ms(p,v){p.pending_buf[p.pending++]=v}function yV(p,v){p.pending_buf[p.pending++]=v>>>8&255,p.pending_buf[p.pending++]=v&255}function Vle(p,v,k,N){var F=p.avail_in;return F>N&&(F=N),F===0?0:(p.avail_in-=F,sw(v,p.input,p.next_in,F,k),p.state.wrap===1?p.adler=f4t(p.adler,v,F,k):p.state.wrap===2&&(p.adler=Wh(p.adler,v,F,k)),p.next_in+=F,p.total_in+=F,F)}function wzt(p,v){var k=p.max_chain_length,N=p.strstart,F,W,L=p.prev_length,O=p.nice_match,S=p.strstart>p.w_size-n2?p.strstart-(p.w_size-n2):0,B=p.window,j=p.w_mask,K=p.prev,Z=p.strstart+t5,Y=B[N+L-1],X=B[N+L];p.prev_length>=p.good_match&&(k>>=2),O>p.lookahead&&(O=p.lookahead);do if(F=v,!(B[F+L]!==X||B[F+L-1]!==Y||B[F]!==B[N]||B[++F]!==B[N+1])){N+=2,F++;do;while(B[++N]===B[++F]&&B[++N]===B[++F]&&B[++N]===B[++F]&&B[++N]===B[++F]&&B[++N]===B[++F]&&B[++N]===B[++F]&&B[++N]===B[++F]&&B[++N]===B[++F]&&N<Z);if(W=t5-(Z-N),N=Z-t5,W>L){if(p.match_start=v,L=W,W>=O)break;Y=B[N+L-1],X=B[N+L]}}while((v=K[v&j])>S&&--k!==0);return L<=p.lookahead?L:p.lookahead}function IG(p){var v=p.w_size,k,N,F,W,L;do{if(W=p.window_size-p.lookahead-p.strstart,p.strstart>=v+(v-n2)){sw(p.window,p.window,v,v,0),p.match_start-=v,p.strstart-=v,p.block_start-=v,N=p.hash_size,k=N;do F=p.head[--k],p.head[k]=F>=v?F-v:0;while(--N);N=v,k=N;do F=p.prev[--k],p.prev[k]=F>=v?F-v:0;while(--N);W+=v}if(p.strm.avail_in===0)break;if(N=Vle(p.strm,p.window,p.strstart+p.lookahead,W),p.lookahead+=N,p.lookahead+p.insert>=Ls)for(L=p.strstart-p.insert,p.ins_h=p.window[L],p.ins_h=(p.ins_h<<p.hash_shift^p.window[L+1])&p.hash_mask;p.insert&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[L+Ls-1])&p.hash_mask,p.prev[L&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=L,L++,p.insert--,!(p.lookahead+p.insert<Ls)););}while(p.lookahead<n2&&p.strm.avail_in!==0)}function Gle(p,v){var k=65535;for(k>p.pending_buf_size-5&&(k=p.pending_buf_size-5);;){if(p.lookahead<=1){if(IG(p),p.lookahead===0&&v===H8)return ch;if(p.lookahead===0)break}p.strstart+=p.lookahead,p.lookahead=0;var N=p.block_start+k;if((p.strstart===0||p.strstart>=N)&&(p.lookahead=p.strstart-N,p.strstart=N,kd(p,!1),p.strm.avail_out===0)||p.strstart-p.block_start>=p.w_size-n2&&(kd(p,!1),p.strm.avail_out===0))return ch}return p.insert=0,v===h5?(kd(p,!0),p.strm.avail_out===0?I8:ZD):(p.strstart>p.block_start&&(kd(p,!1),p.strm.avail_out===0),ch)}function bwt(p,v){for(var k,N;;){if(p.lookahead<n2){if(IG(p),p.lookahead<n2&&v===H8)return ch;if(p.lookahead===0)break}if(k=0,p.lookahead>=Ls&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+Ls-1])&p.hash_mask,k=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),k!==0&&p.strstart-k<=p.w_size-n2&&(p.match_length=wzt(p,k)),p.match_length>=Ls)if(N=c5(p,p.strstart-p.match_start,p.match_length-Ls),p.lookahead-=p.match_length,p.match_length<=p.max_lazy_match&&p.lookahead>=Ls){p.match_length--;do p.strstart++,p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+Ls-1])&p.hash_mask,k=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart;while(--p.match_length!==0);p.strstart++}else p.strstart+=p.match_length,p.match_length=0,p.ins_h=p.window[p.strstart],p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+1])&p.hash_mask;else N=c5(p,0,p.window[p.strstart]),p.lookahead--,p.strstart++;if(N&&(kd(p,!1),p.strm.avail_out===0))return ch}return p.insert=p.strstart<Ls-1?p.strstart:Ls-1,v===h5?(kd(p,!0),p.strm.avail_out===0?I8:ZD):p.last_lit&&(kd(p,!1),p.strm.avail_out===0)?ch:AG}function XM(p,v){for(var k,N,F;;){if(p.lookahead<n2){if(IG(p),p.lookahead<n2&&v===H8)return ch;if(p.lookahead===0)break}if(k=0,p.lookahead>=Ls&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+Ls-1])&p.hash_mask,k=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),p.prev_length=p.match_length,p.prev_match=p.match_start,p.match_length=Ls-1,k!==0&&p.prev_length<p.max_lazy_match&&p.strstart-k<=p.w_size-n2&&(p.match_length=wzt(p,k),p.match_length<=5&&(p.strategy===Mle||p.match_length===Ls&&p.strstart-p.match_start>4096)&&(p.match_length=Ls-1)),p.prev_length>=Ls&&p.match_length<=p.prev_length){F=p.strstart+p.lookahead-Ls,N=c5(p,p.strstart-1-p.prev_match,p.prev_length-Ls),p.lookahead-=p.prev_length-1,p.prev_length-=2;do++p.strstart<=F&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+Ls-1])&p.hash_mask,k=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart);while(--p.prev_length!==0);if(p.match_available=0,p.match_length=Ls-1,p.strstart++,N&&(kd(p,!1),p.strm.avail_out===0))return ch}else if(p.match_available){if(N=c5(p,0,p.window[p.strstart-1]),N&&kd(p,!1),p.strstart++,p.lookahead--,p.strm.avail_out===0)return ch}else p.match_available=1,p.strstart++,p.lookahead--}return p.match_available&&(N=c5(p,0,p.window[p.strstart-1]),p.match_available=0),p.insert=p.strstart<Ls-1?p.strstart:Ls-1,v===h5?(kd(p,!0),p.strm.avail_out===0?I8:ZD):p.last_lit&&(kd(p,!1),p.strm.avail_out===0)?ch:AG}function Hle(p,v){for(var k,N,F,W,L=p.window;;){if(p.lookahead<=t5){if(IG(p),p.lookahead<=t5&&v===H8)return ch;if(p.lookahead===0)break}if(p.match_length=0,p.lookahead>=Ls&&p.strstart>0&&(F=p.strstart-1,N=L[F],N===L[++F]&&N===L[++F]&&N===L[++F])){W=p.strstart+t5;do;while(N===L[++F]&&N===L[++F]&&N===L[++F]&&N===L[++F]&&N===L[++F]&&N===L[++F]&&N===L[++F]&&N===L[++F]&&F<W);p.match_length=t5-(W-F),p.match_length>p.lookahead&&(p.match_length=p.lookahead)}if(p.match_length>=Ls?(k=c5(p,1,p.match_length-Ls),p.lookahead-=p.match_length,p.strstart+=p.match_length,p.match_length=0):(k=c5(p,0,p.window[p.strstart]),p.lookahead--,p.strstart++),k&&(kd(p,!1),p.strm.avail_out===0))return ch}return p.insert=0,v===h5?(kd(p,!0),p.strm.avail_out===0?I8:ZD):p.last_lit&&(kd(p,!1),p.strm.avail_out===0)?ch:AG}function Yle(p,v){for(var k;;){if(p.lookahead===0&&(IG(p),p.lookahead===0)){if(v===H8)return ch;break}if(p.match_length=0,k=c5(p,0,p.window[p.strstart]),p.lookahead--,p.strstart++,k&&(kd(p,!1),p.strm.avail_out===0))return ch}return p.insert=0,v===h5?(kd(p,!0),p.strm.avail_out===0?I8:ZD):p.last_lit&&(kd(p,!1),p.strm.avail_out===0)?ch:AG}function Ky(p,v,k,N,F){this.good_length=p,this.max_lazy=v,this.nice_length=k,this.max_chain=N,this.func=F}var fD;fD=[new Ky(0,0,0,0,Gle),new Ky(4,4,8,4,bwt),new Ky(4,5,16,8,bwt),new Ky(4,6,32,32,bwt),new Ky(4,4,16,16,XM),new Ky(8,16,32,32,XM),new Ky(8,16,128,128,XM),new Ky(8,32,128,256,XM),new Ky(32,128,258,1024,XM),new Ky(32,258,258,4096,XM)];function qle(p){p.window_size=2*p.w_size,K9(p.head),p.max_lazy_match=fD[p.level].max_lazy,p.good_match=fD[p.level].good_length,p.nice_match=fD[p.level].nice_length,p.max_chain_length=fD[p.level].max_chain,p.strstart=0,p.block_start=0,p.lookahead=0,p.insert=0,p.match_length=p.prev_length=Ls-1,p.match_available=0,p.ins_h=0}function Xle(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ckt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new vg(Ble*2),this.dyn_dtree=new vg((2*zle+1)*2),this.bl_tree=new vg((2*Ple+1)*2),K9(this.dyn_ltree),K9(this.dyn_dtree),K9(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new vg(jle+1),this.heap=new vg(2*p4t+1),K9(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new vg(2*p4t+1),K9(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Kle(p){var v;return!p||!p.state?e5(p,d5):(p.total_in=p.total_out=0,p.data_type=Fle,v=p.state,v.pending=0,v.pending_out=0,v.wrap<0&&(v.wrap=-v.wrap),v.status=v.wrap?Ekt:u8,p.adler=v.wrap===2?0:1,v.last_flush=H8,kle(v),Kk)}function xzt(p){var v=Kle(p);return v===Kk&&qle(p.state),v}function Zle(p,v,k,N,F,W){if(!p)return d5;var L=1;if(v===Nle&&(v=6),N<0?(L=0,N=-N):N>15&&(L=2,N-=16),F<1||F>Ole||k!==Ckt||N<8||N>15||v<0||v>9||W<0||W>Rle)return e5(p,d5);N===8&&(N=9);var O=new Xle;return p.state=O,O.strm=p,O.wrap=L,O.gzhead=null,O.w_bits=N,O.w_size=1<<O.w_bits,O.w_mask=O.w_size-1,O.hash_bits=F+7,O.hash_size=1<<O.hash_bits,O.hash_mask=O.hash_size-1,O.hash_shift=~~((O.hash_bits+Ls-1)/Ls),O.window=new Uut(O.w_size*2),O.head=new vg(O.hash_size),O.prev=new vg(O.w_size),O.lit_bufsize=1<<F+6,O.pending_buf_size=O.lit_bufsize*4,O.pending_buf=new Uut(O.pending_buf_size),O.d_buf=1*O.lit_bufsize,O.l_buf=3*O.lit_bufsize,O.level=v,O.strategy=W,O.method=k,xzt(p)}function Qle(p,v){var k,N,F,W;if(!p||!p.state||v>lRt||v<0)return p?e5(p,d5):d5;if(N=p.state,!p.output||!p.input&&p.avail_in!==0||N.status===IV&&v!==h5)return e5(p,p.avail_out===0?vwt:d5);if(N.strm=p,k=N.last_flush,N.last_flush=v,N.status===Ekt)if(N.wrap===2)p.adler=0,ms(N,31),ms(N,139),ms(N,8),N.gzhead?(ms(N,(N.gzhead.text?1:0)+(N.gzhead.hcrc?2:0)+(N.gzhead.extra?4:0)+(N.gzhead.name?8:0)+(N.gzhead.comment?16:0)),ms(N,N.gzhead.time&255),ms(N,N.gzhead.time>>8&255),ms(N,N.gzhead.time>>16&255),ms(N,N.gzhead.time>>24&255),ms(N,N.level===9?2:N.strategy>=dst||N.level<2?4:0),ms(N,N.gzhead.os&255),N.gzhead.extra&&N.gzhead.extra.length&&(ms(N,N.gzhead.extra.length&255),ms(N,N.gzhead.extra.length>>8&255)),N.gzhead.hcrc&&(p.adler=Wh(p.adler,N.pending_buf,N.pending,0)),N.gzindex=0,N.status=m4t):(ms(N,0),ms(N,0),ms(N,0),ms(N,0),ms(N,0),ms(N,N.level===9?2:N.strategy>=dst||N.level<2?4:0),ms(N,Wle),N.status=u8);else{var L=Ckt+(N.w_bits-8<<4)<<8,O=-1;N.strategy>=dst||N.level<2?O=0:N.level<6?O=1:N.level===6?O=2:O=3,L|=O<<6,N.strstart!==0&&(L|=Ule),L+=31-L%31,N.status=u8,yV(N,L),N.strstart!==0&&(yV(N,p.adler>>>16),yV(N,p.adler&65535)),p.adler=1}if(N.status===m4t)if(N.gzhead.extra){for(F=N.pending;N.gzindex<(N.gzhead.extra.length&65535)&&!(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>F&&(p.adler=Wh(p.adler,N.pending_buf,N.pending-F,F)),Uk(p),F=N.pending,N.pending===N.pending_buf_size));)ms(N,N.gzhead.extra[N.gzindex]&255),N.gzindex++;N.gzhead.hcrc&&N.pending>F&&(p.adler=Wh(p.adler,N.pending_buf,N.pending-F,F)),N.gzindex===N.gzhead.extra.length&&(N.gzindex=0,N.status=Bst)}else N.status=Bst;if(N.status===Bst)if(N.gzhead.name){F=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>F&&(p.adler=Wh(p.adler,N.pending_buf,N.pending-F,F)),Uk(p),F=N.pending,N.pending===N.pending_buf_size)){W=1;break}N.gzindex<N.gzhead.name.length?W=N.gzhead.name.charCodeAt(N.gzindex++)&255:W=0,ms(N,W)}while(W!==0);N.gzhead.hcrc&&N.pending>F&&(p.adler=Wh(p.adler,N.pending_buf,N.pending-F,F)),W===0&&(N.gzindex=0,N.status=jst)}else N.status=jst;if(N.status===jst)if(N.gzhead.comment){F=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>F&&(p.adler=Wh(p.adler,N.pending_buf,N.pending-F,F)),Uk(p),F=N.pending,N.pending===N.pending_buf_size)){W=1;break}N.gzindex<N.gzhead.comment.length?W=N.gzhead.comment.charCodeAt(N.gzindex++)&255:W=0,ms(N,W)}while(W!==0);N.gzhead.hcrc&&N.pending>F&&(p.adler=Wh(p.adler,N.pending_buf,N.pending-F,F)),W===0&&(N.status=Ust)}else N.status=Ust;if(N.status===Ust&&(N.gzhead.hcrc?(N.pending+2>N.pending_buf_size&&Uk(p),N.pending+2<=N.pending_buf_size&&(ms(N,p.adler&255),ms(N,p.adler>>8&255),p.adler=0,N.status=u8)):N.status=u8),N.pending!==0){if(Uk(p),p.avail_out===0)return N.last_flush=-1,Kk}else if(p.avail_in===0&&hRt(v)<=hRt(k)&&v!==h5)return e5(p,vwt);if(N.status===IV&&p.avail_in!==0)return e5(p,vwt);if(p.avail_in!==0||N.lookahead!==0||v!==H8&&N.status!==IV){var S=N.strategy===dst?Yle(N,v):N.strategy===Dle?Hle(N,v):fD[N.level].func(N,v);if((S===I8||S===ZD)&&(N.status=IV),S===ch||S===I8)return p.avail_out===0&&(N.last_flush=-1),Kk;if(S===AG&&(v===Tle?Sle(N):v!==lRt&&(bzt(N,0,0,!1),v===Ale&&(K9(N.head),N.lookahead===0&&(N.strstart=0,N.block_start=0,N.insert=0))),Uk(p),p.avail_out===0))return N.last_flush=-1,Kk}return v!==h5?Kk:N.wrap<=0?cRt:(N.wrap===2?(ms(N,p.adler&255),ms(N,p.adler>>8&255),ms(N,p.adler>>16&255),ms(N,p.adler>>24&255),ms(N,p.total_in&255),ms(N,p.total_in>>8&255),ms(N,p.total_in>>16&255),ms(N,p.total_in>>24&255)):(yV(N,p.adler>>>16),yV(N,p.adler&65535)),Uk(p),N.wrap>0&&(N.wrap=-N.wrap),N.pending!==0?Kk:cRt)}function Jle(p){var v;return!p||!p.state?d5:(v=p.state.status,v!==Ekt&&v!==m4t&&v!==Bst&&v!==jst&&v!==Ust&&v!==u8&&v!==IV?e5(p,d5):(p.state=null,v===u8?e5(p,Ile):Kk))}var fst=30,tce=12;function ece(p,v){var k,N,F,W,L,O,S,B,j,K,Z,Y,X,J,q,H,tt,st,lt,ft,gt,xt,wt,_t,bt;k=p.state,N=p.next_in,_t=p.input,F=N+(p.avail_in-5),W=p.next_out,bt=p.output,L=W-(v-p.avail_out),O=W+(p.avail_out-257),S=k.dmax,B=k.wsize,j=k.whave,K=k.wnext,Z=k.window,Y=k.hold,X=k.bits,J=k.lencode,q=k.distcode,H=(1<<k.lenbits)-1,tt=(1<<k.distbits)-1;t:do{X<15&&(Y+=_t[N++]<<X,X+=8,Y+=_t[N++]<<X,X+=8),st=J[Y&H];e:for(;;){if(lt=st>>>24,Y>>>=lt,X-=lt,lt=st>>>16&255,lt===0)bt[W++]=st&65535;else if(lt&16){ft=st&65535,lt&=15,lt&&(X<lt&&(Y+=_t[N++]<<X,X+=8),ft+=Y&(1<<lt)-1,Y>>>=lt,X-=lt),X<15&&(Y+=_t[N++]<<X,X+=8,Y+=_t[N++]<<X,X+=8),st=q[Y&tt];n:for(;;){if(lt=st>>>24,Y>>>=lt,X-=lt,lt=st>>>16&255,lt&16){if(gt=st&65535,lt&=15,X<lt&&(Y+=_t[N++]<<X,X+=8,X<lt&&(Y+=_t[N++]<<X,X+=8)),gt+=Y&(1<<lt)-1,gt>S){p.msg="invalid distance too far back",k.mode=fst;break t}if(Y>>>=lt,X-=lt,lt=W-L,gt>lt){if(lt=gt-lt,lt>j&&k.sane){p.msg="invalid distance too far back",k.mode=fst;break t}if(xt=0,wt=Z,K===0){if(xt+=B-lt,lt<ft){ft-=lt;do bt[W++]=Z[xt++];while(--lt);xt=W-gt,wt=bt}}else if(K<lt){if(xt+=B+K-lt,lt-=K,lt<ft){ft-=lt;do bt[W++]=Z[xt++];while(--lt);if(xt=0,K<ft){lt=K,ft-=lt;do bt[W++]=Z[xt++];while(--lt);xt=W-gt,wt=bt}}}else if(xt+=K-lt,lt<ft){ft-=lt;do bt[W++]=Z[xt++];while(--lt);xt=W-gt,wt=bt}for(;ft>2;)bt[W++]=wt[xt++],bt[W++]=wt[xt++],bt[W++]=wt[xt++],ft-=3;ft&&(bt[W++]=wt[xt++],ft>1&&(bt[W++]=wt[xt++]))}else{xt=W-gt;do bt[W++]=bt[xt++],bt[W++]=bt[xt++],bt[W++]=bt[xt++],ft-=3;while(ft>2);ft&&(bt[W++]=bt[xt++],ft>1&&(bt[W++]=bt[xt++]))}}else if(lt&64){p.msg="invalid distance code",k.mode=fst;break t}else{st=q[(st&65535)+(Y&(1<<lt)-1)];continue n}break}}else if(lt&64)if(lt&32){k.mode=tce;break t}else{p.msg="invalid literal/length code",k.mode=fst;break t}else{st=J[(st&65535)+(Y&(1<<lt)-1)];continue e}break}}while(N<F&&W<O);ft=X>>3,N-=ft,X-=ft<<3,Y&=(1<<X)-1,p.next_in=N,p.next_out=W,p.avail_in=N<F?5+(F-N):5-(N-F),p.avail_out=W<O?257+(O-W):257-(W-O),k.hold=Y,k.bits=X}var KM=15,dRt=852,fRt=592,pRt=0,wwt=1,mRt=2,nce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],rce=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],ice=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],ace=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function PV(p,v,k,N,F,W,L,O){var S=O.bits,B=0,j=0,K=0,Z=0,Y=0,X=0,J=0,q=0,H=0,tt=0,st,lt,ft,gt,xt,wt=null,_t=0,bt,Tt=new vg(KM+1),qt=new vg(KM+1),It=null,St=0,vt,Ft,Qt;for(B=0;B<=KM;B++)Tt[B]=0;for(j=0;j<N;j++)Tt[v[k+j]]++;for(Y=S,Z=KM;Z>=1&&Tt[Z]===0;Z--);if(Y>Z&&(Y=Z),Z===0)return F[W++]=1<<24|64<<16|0,F[W++]=1<<24|64<<16|0,O.bits=1,0;for(K=1;K<Z&&Tt[K]===0;K++);for(Y<K&&(Y=K),q=1,B=1;B<=KM;B++)if(q<<=1,q-=Tt[B],q<0)return-1;if(q>0&&(p===pRt||Z!==1))return-1;for(qt[1]=0,B=1;B<KM;B++)qt[B+1]=qt[B]+Tt[B];for(j=0;j<N;j++)v[k+j]!==0&&(L[qt[v[k+j]]++]=j);if(p===pRt?(wt=It=L,bt=19):p===wwt?(wt=nce,_t-=257,It=rce,St-=257,bt=256):(wt=ice,It=ace,bt=-1),tt=0,j=0,B=K,xt=W,X=Y,J=0,ft=-1,H=1<<Y,gt=H-1,p===wwt&&H>dRt||p===mRt&&H>fRt)return 1;for(;;){vt=B-J,L[j]<bt?(Ft=0,Qt=L[j]):L[j]>bt?(Ft=It[St+L[j]],Qt=wt[_t+L[j]]):(Ft=96,Qt=0),st=1<<B-J,lt=1<<X,K=lt;do lt-=st,F[xt+(tt>>J)+lt]=vt<<24|Ft<<16|Qt|0;while(lt!==0);for(st=1<<B-1;tt&st;)st>>=1;if(st!==0?(tt&=st-1,tt+=st):tt=0,j++,--Tt[B]===0){if(B===Z)break;B=v[k+L[j]]}if(B>Y&&(tt&gt)!==ft){for(J===0&&(J=Y),xt+=K,X=B-J,q=1<<X;X+J<Z&&(q-=Tt[X+J],!(q<=0));)X++,q<<=1;if(H+=1<<X,p===wwt&&H>dRt||p===mRt&&H>fRt)return 1;ft=tt&gt,F[ft]=Y<<24|X<<16|xt-W|0}}return tt!==0&&(F[xt+tt]=B-J<<24|64<<16|0),O.bits=Y,0}var oce=0,kzt=1,Szt=2,gRt=4,sce=5,pst=6,uG=0,uce=1,lce=2,v5=-2,cce=-3,hce=-4,dce=-5,yRt=8,_zt=1,vRt=2,bRt=3,wRt=4,xRt=5,kRt=6,SRt=7,_Rt=8,CRt=9,ERt=10,TRt=11,Y3=12,xwt=13,ARt=14,kwt=15,IRt=16,NRt=17,MRt=18,DRt=19,mst=20,gst=21,RRt=22,FRt=23,ORt=24,LRt=25,$Rt=26,Swt=27,zRt=28,PRt=29,cl=30,fce=31,pce=32,mce=852,gce=592;function BRt(p){return(p>>>24&255)+(p>>>8&65280)+((p&65280)<<8)+((p&255)<<24)}function yce(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new vg(320),this.work=new vg(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function vce(p){var v;return!p||!p.state?v5:(v=p.state,p.total_in=p.total_out=v.total=0,p.msg="",v.wrap&&(p.adler=v.wrap&1),v.mode=_zt,v.last=0,v.havedict=0,v.dmax=32768,v.head=null,v.hold=0,v.bits=0,v.lencode=v.lendyn=new Wut(mce),v.distcode=v.distdyn=new Wut(gce),v.sane=1,v.back=-1,uG)}function Czt(p){var v;return!p||!p.state?v5:(v=p.state,v.wsize=0,v.whave=0,v.wnext=0,vce(p))}function bce(p,v){var k,N;return!p||!p.state||(N=p.state,v<0?(k=0,v=-v):(k=(v>>4)+1,v<48&&(v&=15)),v&&(v<8||v>15))?v5:(N.window!==null&&N.wbits!==v&&(N.window=null),N.wrap=k,N.wbits=v,Czt(p))}function wce(p,v){var k,N;return p?(N=new yce,p.state=N,N.window=null,k=bce(p,v),k!==uG&&(p.state=null),k):v5}var jRt=!0,_wt,Cwt;function xce(p){if(jRt){var v;for(_wt=new Wut(512),Cwt=new Wut(32),v=0;v<144;)p.lens[v++]=8;for(;v<256;)p.lens[v++]=9;for(;v<280;)p.lens[v++]=7;for(;v<288;)p.lens[v++]=8;for(PV(kzt,p.lens,0,288,_wt,0,p.work,{bits:9}),v=0;v<32;)p.lens[v++]=5;PV(Szt,p.lens,0,32,Cwt,0,p.work,{bits:5}),jRt=!1}p.lencode=_wt,p.lenbits=9,p.distcode=Cwt,p.distbits=5}function kce(p,v,k,N){var F,W=p.state;return W.window===null&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new Uut(W.wsize)),N>=W.wsize?(sw(W.window,v,k-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(F=W.wsize-W.wnext,F>N&&(F=N),sw(W.window,v,k-N,F,W.wnext),N-=F,N?(sw(W.window,v,k-N,N,0),W.wnext=N,W.whave=W.wsize):(W.wnext+=F,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=F))),0}function Sce(p,v){var k,N,F,W,L,O,S,B,j,K,Z,Y,X,J,q=0,H,tt,st,lt,ft,gt,xt,wt,_t=new Uut(4),bt,Tt,qt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!p||!p.state||!p.output||!p.input&&p.avail_in!==0)return v5;k=p.state,k.mode===Y3&&(k.mode=xwt),L=p.next_out,F=p.output,S=p.avail_out,W=p.next_in,N=p.input,O=p.avail_in,B=k.hold,j=k.bits,K=O,Z=S,wt=uG;t:for(;;)switch(k.mode){case _zt:if(k.wrap===0){k.mode=xwt;break}for(;j<16;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}if(k.wrap&2&&B===35615){k.check=0,_t[0]=B&255,_t[1]=B>>>8&255,k.check=Wh(k.check,_t,2,0),B=0,j=0,k.mode=vRt;break}if(k.flags=0,k.head&&(k.head.done=!1),!(k.wrap&1)||(((B&255)<<8)+(B>>8))%31){p.msg="incorrect header check",k.mode=cl;break}if((B&15)!==yRt){p.msg="unknown compression method",k.mode=cl;break}if(B>>>=4,j-=4,xt=(B&15)+8,k.wbits===0)k.wbits=xt;else if(xt>k.wbits){p.msg="invalid window size",k.mode=cl;break}k.dmax=1<<xt,p.adler=k.check=1,k.mode=B&512?ERt:Y3,B=0,j=0;break;case vRt:for(;j<16;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}if(k.flags=B,(k.flags&255)!==yRt){p.msg="unknown compression method",k.mode=cl;break}if(k.flags&57344){p.msg="unknown header flags set",k.mode=cl;break}k.head&&(k.head.text=B>>8&1),k.flags&512&&(_t[0]=B&255,_t[1]=B>>>8&255,k.check=Wh(k.check,_t,2,0)),B=0,j=0,k.mode=bRt;case bRt:for(;j<32;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}k.head&&(k.head.time=B),k.flags&512&&(_t[0]=B&255,_t[1]=B>>>8&255,_t[2]=B>>>16&255,_t[3]=B>>>24&255,k.check=Wh(k.check,_t,4,0)),B=0,j=0,k.mode=wRt;case wRt:for(;j<16;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}k.head&&(k.head.xflags=B&255,k.head.os=B>>8),k.flags&512&&(_t[0]=B&255,_t[1]=B>>>8&255,k.check=Wh(k.check,_t,2,0)),B=0,j=0,k.mode=xRt;case xRt:if(k.flags&1024){for(;j<16;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}k.length=B,k.head&&(k.head.extra_len=B),k.flags&512&&(_t[0]=B&255,_t[1]=B>>>8&255,k.check=Wh(k.check,_t,2,0)),B=0,j=0}else k.head&&(k.head.extra=null);k.mode=kRt;case kRt:if(k.flags&1024&&(Y=k.length,Y>O&&(Y=O),Y&&(k.head&&(xt=k.head.extra_len-k.length,k.head.extra||(k.head.extra=new Array(k.head.extra_len)),sw(k.head.extra,N,W,Y,xt)),k.flags&512&&(k.check=Wh(k.check,N,Y,W)),O-=Y,W+=Y,k.length-=Y),k.length))break t;k.length=0,k.mode=SRt;case SRt:if(k.flags&2048){if(O===0)break t;Y=0;do xt=N[W+Y++],k.head&&xt&&k.length<65536&&(k.head.name+=String.fromCharCode(xt));while(xt&&Y<O);if(k.flags&512&&(k.check=Wh(k.check,N,Y,W)),O-=Y,W+=Y,xt)break t}else k.head&&(k.head.name=null);k.length=0,k.mode=_Rt;case _Rt:if(k.flags&4096){if(O===0)break t;Y=0;do xt=N[W+Y++],k.head&&xt&&k.length<65536&&(k.head.comment+=String.fromCharCode(xt));while(xt&&Y<O);if(k.flags&512&&(k.check=Wh(k.check,N,Y,W)),O-=Y,W+=Y,xt)break t}else k.head&&(k.head.comment=null);k.mode=CRt;case CRt:if(k.flags&512){for(;j<16;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}if(B!==(k.check&65535)){p.msg="header crc mismatch",k.mode=cl;break}B=0,j=0}k.head&&(k.head.hcrc=k.flags>>9&1,k.head.done=!0),p.adler=k.check=0,k.mode=Y3;break;case ERt:for(;j<32;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}p.adler=k.check=BRt(B),B=0,j=0,k.mode=TRt;case TRt:if(k.havedict===0)return p.next_out=L,p.avail_out=S,p.next_in=W,p.avail_in=O,k.hold=B,k.bits=j,lce;p.adler=k.check=1,k.mode=Y3;case Y3:if(v===sce||v===pst)break t;case xwt:if(k.last){B>>>=j&7,j-=j&7,k.mode=Swt;break}for(;j<3;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}switch(k.last=B&1,B>>>=1,j-=1,B&3){case 0:k.mode=ARt;break;case 1:if(xce(k),k.mode=mst,v===pst){B>>>=2,j-=2;break t}break;case 2:k.mode=NRt;break;case 3:p.msg="invalid block type",k.mode=cl}B>>>=2,j-=2;break;case ARt:for(B>>>=j&7,j-=j&7;j<32;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}if((B&65535)!==(B>>>16^65535)){p.msg="invalid stored block lengths",k.mode=cl;break}if(k.length=B&65535,B=0,j=0,k.mode=kwt,v===pst)break t;case kwt:k.mode=IRt;case IRt:if(Y=k.length,Y){if(Y>O&&(Y=O),Y>S&&(Y=S),Y===0)break t;sw(F,N,W,Y,L),O-=Y,W+=Y,S-=Y,L+=Y,k.length-=Y;break}k.mode=Y3;break;case NRt:for(;j<14;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}if(k.nlen=(B&31)+257,B>>>=5,j-=5,k.ndist=(B&31)+1,B>>>=5,j-=5,k.ncode=(B&15)+4,B>>>=4,j-=4,k.nlen>286||k.ndist>30){p.msg="too many length or distance symbols",k.mode=cl;break}k.have=0,k.mode=MRt;case MRt:for(;k.have<k.ncode;){for(;j<3;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}k.lens[qt[k.have++]]=B&7,B>>>=3,j-=3}for(;k.have<19;)k.lens[qt[k.have++]]=0;if(k.lencode=k.lendyn,k.lenbits=7,bt={bits:k.lenbits},wt=PV(oce,k.lens,0,19,k.lencode,0,k.work,bt),k.lenbits=bt.bits,wt){p.msg="invalid code lengths set",k.mode=cl;break}k.have=0,k.mode=DRt;case DRt:for(;k.have<k.nlen+k.ndist;){for(;q=k.lencode[B&(1<<k.lenbits)-1],H=q>>>24,tt=q>>>16&255,st=q&65535,!(H<=j);){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}if(st<16)B>>>=H,j-=H,k.lens[k.have++]=st;else{if(st===16){for(Tt=H+2;j<Tt;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}if(B>>>=H,j-=H,k.have===0){p.msg="invalid bit length repeat",k.mode=cl;break}xt=k.lens[k.have-1],Y=3+(B&3),B>>>=2,j-=2}else if(st===17){for(Tt=H+3;j<Tt;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}B>>>=H,j-=H,xt=0,Y=3+(B&7),B>>>=3,j-=3}else{for(Tt=H+7;j<Tt;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}B>>>=H,j-=H,xt=0,Y=11+(B&127),B>>>=7,j-=7}if(k.have+Y>k.nlen+k.ndist){p.msg="invalid bit length repeat",k.mode=cl;break}for(;Y--;)k.lens[k.have++]=xt}}if(k.mode===cl)break;if(k.lens[256]===0){p.msg="invalid code -- missing end-of-block",k.mode=cl;break}if(k.lenbits=9,bt={bits:k.lenbits},wt=PV(kzt,k.lens,0,k.nlen,k.lencode,0,k.work,bt),k.lenbits=bt.bits,wt){p.msg="invalid literal/lengths set",k.mode=cl;break}if(k.distbits=6,k.distcode=k.distdyn,bt={bits:k.distbits},wt=PV(Szt,k.lens,k.nlen,k.ndist,k.distcode,0,k.work,bt),k.distbits=bt.bits,wt){p.msg="invalid distances set",k.mode=cl;break}if(k.mode=mst,v===pst)break t;case mst:k.mode=gst;case gst:if(O>=6&&S>=258){p.next_out=L,p.avail_out=S,p.next_in=W,p.avail_in=O,k.hold=B,k.bits=j,ece(p,Z),L=p.next_out,F=p.output,S=p.avail_out,W=p.next_in,N=p.input,O=p.avail_in,B=k.hold,j=k.bits,k.mode===Y3&&(k.back=-1);break}for(k.back=0;q=k.lencode[B&(1<<k.lenbits)-1],H=q>>>24,tt=q>>>16&255,st=q&65535,!(H<=j);){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}if(tt&&!(tt&240)){for(lt=H,ft=tt,gt=st;q=k.lencode[gt+((B&(1<<lt+ft)-1)>>lt)],H=q>>>24,tt=q>>>16&255,st=q&65535,!(lt+H<=j);){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}B>>>=lt,j-=lt,k.back+=lt}if(B>>>=H,j-=H,k.back+=H,k.length=st,tt===0){k.mode=$Rt;break}if(tt&32){k.back=-1,k.mode=Y3;break}if(tt&64){p.msg="invalid literal/length code",k.mode=cl;break}k.extra=tt&15,k.mode=RRt;case RRt:if(k.extra){for(Tt=k.extra;j<Tt;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}k.length+=B&(1<<k.extra)-1,B>>>=k.extra,j-=k.extra,k.back+=k.extra}k.was=k.length,k.mode=FRt;case FRt:for(;q=k.distcode[B&(1<<k.distbits)-1],H=q>>>24,tt=q>>>16&255,st=q&65535,!(H<=j);){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}if(!(tt&240)){for(lt=H,ft=tt,gt=st;q=k.distcode[gt+((B&(1<<lt+ft)-1)>>lt)],H=q>>>24,tt=q>>>16&255,st=q&65535,!(lt+H<=j);){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}B>>>=lt,j-=lt,k.back+=lt}if(B>>>=H,j-=H,k.back+=H,tt&64){p.msg="invalid distance code",k.mode=cl;break}k.offset=st,k.extra=tt&15,k.mode=ORt;case ORt:if(k.extra){for(Tt=k.extra;j<Tt;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}k.offset+=B&(1<<k.extra)-1,B>>>=k.extra,j-=k.extra,k.back+=k.extra}if(k.offset>k.dmax){p.msg="invalid distance too far back",k.mode=cl;break}k.mode=LRt;case LRt:if(S===0)break t;if(Y=Z-S,k.offset>Y){if(Y=k.offset-Y,Y>k.whave&&k.sane){p.msg="invalid distance too far back",k.mode=cl;break}Y>k.wnext?(Y-=k.wnext,X=k.wsize-Y):X=k.wnext-Y,Y>k.length&&(Y=k.length),J=k.window}else J=F,X=L-k.offset,Y=k.length;Y>S&&(Y=S),S-=Y,k.length-=Y;do F[L++]=J[X++];while(--Y);k.length===0&&(k.mode=gst);break;case $Rt:if(S===0)break t;F[L++]=k.length,S--,k.mode=gst;break;case Swt:if(k.wrap){for(;j<32;){if(O===0)break t;O--,B|=N[W++]<<j,j+=8}if(Z-=S,p.total_out+=Z,k.total+=Z,Z&&(p.adler=k.check=k.flags?Wh(k.check,F,Z,L-Z):f4t(k.check,F,Z,L-Z)),Z=S,(k.flags?B:BRt(B))!==k.check){p.msg="incorrect data check",k.mode=cl;break}B=0,j=0}k.mode=zRt;case zRt:if(k.wrap&&k.flags){for(;j<32;){if(O===0)break t;O--,B+=N[W++]<<j,j+=8}if(B!==(k.total&4294967295)){p.msg="incorrect length check",k.mode=cl;break}B=0,j=0}k.mode=PRt;case PRt:wt=uce;break t;case cl:wt=cce;break t;case fce:return hce;case pce:default:return v5}return p.next_out=L,p.avail_out=S,p.next_in=W,p.avail_in=O,k.hold=B,k.bits=j,(k.wsize||Z!==p.avail_out&&k.mode<cl&&(k.mode<Swt||v!==gRt))&&kce(p,p.output,p.next_out,Z-p.avail_out),K-=p.avail_in,Z-=p.avail_out,p.total_in+=K,p.total_out+=Z,k.total+=Z,k.wrap&&Z&&(p.adler=k.check=k.flags?Wh(k.check,F,Z,p.next_out-Z):f4t(k.check,F,Z,p.next_out-Z)),p.data_type=k.bits+(k.last?64:0)+(k.mode===Y3?128:0)+(k.mode===mst||k.mode===kwt?256:0),(K===0&&Z===0||v===gRt)&&wt===uG&&(wt=dce),wt}function _ce(p){if(!p||!p.state)return v5;var v=p.state;return v.window&&(v.window=null),p.state=null,uG}var Tkt=0,QD=1,ylt=2,lG=3,Gut=4,WD=5,cG=6,hG=7,Ezt=0,Tzt=1,Azt=2,Izt=3,Nzt=4,Mzt=5,Cce=6,vlt=0,Dzt=1,Ece=2,Tce=-1,Ace=-2,Ice=-3,Nce=-5,Mce=0,Dce=1,Rce=9,Fce=-1,Oce=1,Lce=2,$ce=3,zce=4,Pce=0,Bce=0,jce=1,Uce=2,Rzt=8;function vv(p){if(p<QD||p>hG)throw new TypeError("Bad argument");this.mode=p,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}vv.prototype.init=function(p,v,k,N,F){this.windowBits=p,this.level=v,this.memLevel=k,this.strategy=N,(this.mode===lG||this.mode===Gut)&&(this.windowBits+=16),this.mode===hG&&(this.windowBits+=32),(this.mode===WD||this.mode===cG)&&(this.windowBits=-this.windowBits),this.strm=new ale;var W;switch(this.mode){case QD:case lG:case WD:W=Zle(this.strm,this.level,Rzt,this.windowBits,this.memLevel,this.strategy);break;case ylt:case Gut:case cG:case hG:W=wce(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}if(W!==vlt){this._error(W);return}this.write_in_progress=!1,this.init_done=!0};vv.prototype.params=function(){throw new Error("deflateParams Not supported")};vv.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(this.mode===Tkt)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")};vv.prototype.write=function(p,v,k,N,F,W,L){this._writeCheck(),this.write_in_progress=!0;var O=this;return Iu.nextTick(function(){O.write_in_progress=!1;var S=O._write(p,v,k,N,F,W,L);O.callback(S[0],S[1]),O.pending_close&&O.close()}),this};function Wce(p,v){for(var k=0;k<p.length;k++)this[v+k]=p[k]}vv.prototype.writeSync=function(p,v,k,N,F,W,L){return this._writeCheck(),this._write(p,v,k,N,F,W,L)};vv.prototype._write=function(p,v,k,N,F,W,L){if(this.write_in_progress=!0,p!==Ezt&&p!==Tzt&&p!==Azt&&p!==Izt&&p!==Nzt&&p!==Mzt)throw new Error("Invalid flush value");v==null&&(v=new Un(0),N=0,k=0),F._set?F.set=F._set:F.set=Wce;var O=this.strm;O.avail_in=N,O.input=v,O.next_in=k,O.avail_out=L,O.output=F,O.next_out=W;var S;switch(this.mode){case QD:case lG:case WD:S=Qle(O,p);break;case hG:case ylt:case Gut:case cG:S=Sce(O,p);break;default:throw new Error("Unknown mode "+this.mode)}return S!==Dzt&&S!==vlt&&this._error(S),this.write_in_progress=!1,[O.avail_in,O.avail_out]};vv.prototype.close=function(){if(this.write_in_progress){this.pending_close=!0;return}this.pending_close=!1,this.mode===QD||this.mode===lG||this.mode===WD?Jle(this.strm):_ce(this.strm),this.mode=Tkt};var yst;vv.prototype.reset=function(){switch(this.mode){case QD:case WD:yst=xzt(this.strm);break;case ylt:case cG:yst=Czt(this.strm);break}yst!==vlt&&this._error(yst)};vv.prototype._error=function(p){this.onerror(izt[p]+": "+this.strm.msg,p),this.write_in_progress=!1,this.pending_close&&this.close()};var URt=Object.freeze({__proto__:null,DEFLATE:QD,DEFLATERAW:WD,GUNZIP:Gut,GZIP:lG,INFLATE:ylt,INFLATERAW:cG,NONE:Tkt,UNZIP:hG,Z_BEST_COMPRESSION:Rce,Z_BEST_SPEED:Dce,Z_BINARY:Bce,Z_BLOCK:Mzt,Z_BUF_ERROR:Nce,Z_DATA_ERROR:Ice,Z_DEFAULT_COMPRESSION:Fce,Z_DEFAULT_STRATEGY:Pce,Z_DEFLATED:Rzt,Z_ERRNO:Tce,Z_FILTERED:Oce,Z_FINISH:Nzt,Z_FIXED:zce,Z_FULL_FLUSH:Izt,Z_HUFFMAN_ONLY:Lce,Z_NEED_DICT:Ece,Z_NO_COMPRESSION:Mce,Z_NO_FLUSH:Ezt,Z_OK:vlt,Z_PARTIAL_FLUSH:Tzt,Z_RLE:$ce,Z_STREAM_END:Dzt,Z_STREAM_ERROR:Ace,Z_SYNC_FLUSH:Azt,Z_TEXT:jce,Z_TREES:Cce,Z_UNKNOWN:Uce,Zlib:vv});function Vce(p,v){if(!p)throw new Error(v)}var Oi={};Object.keys(URt).forEach(function(p){Oi[p]=URt[p]});Oi.Z_MIN_WINDOWBITS=8;Oi.Z_MAX_WINDOWBITS=15;Oi.Z_DEFAULT_WINDOWBITS=15;Oi.Z_MIN_CHUNK=64;Oi.Z_MAX_CHUNK=1/0;Oi.Z_DEFAULT_CHUNK=16*1024;Oi.Z_MIN_MEMLEVEL=1;Oi.Z_MAX_MEMLEVEL=9;Oi.Z_DEFAULT_MEMLEVEL=8;Oi.Z_MIN_LEVEL=-1;Oi.Z_MAX_LEVEL=9;Oi.Z_DEFAULT_LEVEL=Oi.Z_DEFAULT_COMPRESSION;var BV={Z_OK:Oi.Z_OK,Z_STREAM_END:Oi.Z_STREAM_END,Z_NEED_DICT:Oi.Z_NEED_DICT,Z_ERRNO:Oi.Z_ERRNO,Z_STREAM_ERROR:Oi.Z_STREAM_ERROR,Z_DATA_ERROR:Oi.Z_DATA_ERROR,Z_MEM_ERROR:Oi.Z_MEM_ERROR,Z_BUF_ERROR:Oi.Z_BUF_ERROR,Z_VERSION_ERROR:Oi.Z_VERSION_ERROR};Object.keys(BV).forEach(function(p){BV[BV[p]]=p});function Fzt(p){return new b5(p)}function Ozt(p){return new w5(p)}function Lzt(p){return new S5(p)}function $zt(p){return new _5(p)}function zzt(p){return new x5(p)}function Pzt(p){return new k5(p)}function Bzt(p){return new C5(p)}function jzt(p,v,k){return typeof v=="function"&&(k=v,v={}),Y8(new b5(v),p,k)}function Uzt(p,v){return q8(new b5(v),p)}function Wzt(p,v,k){return typeof v=="function"&&(k=v,v={}),Y8(new x5(v),p,k)}function Vzt(p,v){return q8(new x5(v),p)}function Gzt(p,v,k){return typeof v=="function"&&(k=v,v={}),Y8(new S5(v),p,k)}function Hzt(p,v){return q8(new S5(v),p)}function Yzt(p,v,k){return typeof v=="function"&&(k=v,v={}),Y8(new C5(v),p,k)}function qzt(p,v){return q8(new C5(v),p)}function Xzt(p,v,k){return typeof v=="function"&&(k=v,v={}),Y8(new w5(v),p,k)}function Kzt(p,v){return q8(new w5(v),p)}function Zzt(p,v,k){return typeof v=="function"&&(k=v,v={}),Y8(new k5(v),p,k)}function Qzt(p,v){return q8(new k5(v),p)}function Jzt(p,v,k){return typeof v=="function"&&(k=v,v={}),Y8(new _5(v),p,k)}function tPt(p,v){return q8(new _5(v),p)}function Y8(p,v,k){var N=[],F=0;p.on("error",L),p.on("end",O),p.end(v),W();function W(){for(var S;(S=p.read())!==null;)N.push(S),F+=S.length;p.once("readable",W)}function L(S){p.removeListener("end",O),p.removeListener("readable",W),k(S)}function O(){var S=Un.concat(N,F);N=[],k(null,S),p.close()}}function q8(p,v){if(typeof v=="string"&&(v=new Un(v)),!Un.isBuffer(v))throw new TypeError("Not a string or buffer");var k=Oi.Z_FINISH;return p._processChunk(v,k)}function b5(p){if(!(this instanceof b5))return new b5(p);fl.call(this,p,Oi.DEFLATE)}function w5(p){if(!(this instanceof w5))return new w5(p);fl.call(this,p,Oi.INFLATE)}function x5(p){if(!(this instanceof x5))return new x5(p);fl.call(this,p,Oi.GZIP)}function k5(p){if(!(this instanceof k5))return new k5(p);fl.call(this,p,Oi.GUNZIP)}function S5(p){if(!(this instanceof S5))return new S5(p);fl.call(this,p,Oi.DEFLATERAW)}function _5(p){if(!(this instanceof _5))return new _5(p);fl.call(this,p,Oi.INFLATERAW)}function C5(p){if(!(this instanceof C5))return new C5(p);fl.call(this,p,Oi.UNZIP)}function fl(p,v){if(this._opts=p=p||{},this._chunkSize=p.chunkSize||Oi.Z_DEFAULT_CHUNK,sm.call(this,p),p.flush&&p.flush!==Oi.Z_NO_FLUSH&&p.flush!==Oi.Z_PARTIAL_FLUSH&&p.flush!==Oi.Z_SYNC_FLUSH&&p.flush!==Oi.Z_FULL_FLUSH&&p.flush!==Oi.Z_FINISH&&p.flush!==Oi.Z_BLOCK)throw new Error("Invalid flush flag: "+p.flush);if(this._flushFlag=p.flush||Oi.Z_NO_FLUSH,p.chunkSize&&(p.chunkSize<Oi.Z_MIN_CHUNK||p.chunkSize>Oi.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+p.chunkSize);if(p.windowBits&&(p.windowBits<Oi.Z_MIN_WINDOWBITS||p.windowBits>Oi.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+p.windowBits);if(p.level&&(p.level<Oi.Z_MIN_LEVEL||p.level>Oi.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+p.level);if(p.memLevel&&(p.memLevel<Oi.Z_MIN_MEMLEVEL||p.memLevel>Oi.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+p.memLevel);if(p.strategy&&p.strategy!=Oi.Z_FILTERED&&p.strategy!=Oi.Z_HUFFMAN_ONLY&&p.strategy!=Oi.Z_RLE&&p.strategy!=Oi.Z_FIXED&&p.strategy!=Oi.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+p.strategy);if(p.dictionary&&!Un.isBuffer(p.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._binding=new Oi.Zlib(v);var k=this;this._hadError=!1,this._binding.onerror=function(W,L){k._binding=null,k._hadError=!0;var O=new Error(W);O.errno=L,O.code=Oi.codes[L],k.emit("error",O)};var N=Oi.Z_DEFAULT_COMPRESSION;typeof p.level=="number"&&(N=p.level);var F=Oi.Z_DEFAULT_STRATEGY;typeof p.strategy=="number"&&(F=p.strategy),this._binding.init(p.windowBits||Oi.Z_DEFAULT_WINDOWBITS,N,p.memLevel||Oi.Z_DEFAULT_MEMLEVEL,F,p.dictionary),this._buffer=new Un(this._chunkSize),this._offset=0,this._closed=!1,this._level=N,this._strategy=F,this.once("end",this.close)}fh(fl,sm);fl.prototype.params=function(p,v,k){if(p<Oi.Z_MIN_LEVEL||p>Oi.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+p);if(v!=Oi.Z_FILTERED&&v!=Oi.Z_HUFFMAN_ONLY&&v!=Oi.Z_RLE&&v!=Oi.Z_FIXED&&v!=Oi.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+v);if(this._level!==p||this._strategy!==v){var N=this;this.flush(Oi.Z_SYNC_FLUSH,function(){N._binding.params(p,v),N._hadError||(N._level=p,N._strategy=v,k&&k())})}else Iu.nextTick(k)};fl.prototype.reset=function(){return this._binding.reset()};fl.prototype._flush=function(p){this._transform(new Un(0),"",p)};fl.prototype.flush=function(p,v){var k=this._writableState;if((typeof p=="function"||p===void 0&&!v)&&(v=p,p=Oi.Z_FULL_FLUSH),k.ended)v&&Iu.nextTick(v);else if(k.ending)v&&this.once("end",v);else if(k.needDrain){var N=this;this.once("drain",function(){N.flush(v)})}else this._flushFlag=p,this.write(new Un(0),"",v)};fl.prototype.close=function(p){if(p&&Iu.nextTick(p),!this._closed){this._closed=!0,this._binding.close();var v=this;Iu.nextTick(function(){v.emit("close")})}};fl.prototype._transform=function(p,v,k){var N,F=this._writableState,W=F.ending||F.ended,L=W&&(!p||F.length===p.length);if(!p===null&&!Un.isBuffer(p))return k(new Error("invalid input"));L?N=Oi.Z_FINISH:(N=this._flushFlag,p.length>=F.length&&(this._flushFlag=this._opts.flush||Oi.Z_NO_FLUSH)),this._processChunk(p,N,k)};fl.prototype._processChunk=function(p,v,k){var N=p&&p.length,F=this._chunkSize-this._offset,W=0,L=this,O=typeof k=="function";if(!O){var S=[],B=0,j;this.on("error",function(J){j=J});do var K=this._binding.writeSync(v,p,W,N,this._buffer,this._offset,F);while(!this._hadError&&X(K[0],K[1]));if(this._hadError)throw j;var Z=Un.concat(S,B);return this.close(),Z}var Y=this._binding.write(v,p,W,N,this._buffer,this._offset,F);Y.buffer=p,Y.callback=X;function X(J,q){if(!L._hadError){var H=F-q;if(Vce(H>=0,"have should not go down"),H>0){var tt=L._buffer.slice(L._offset,L._offset+H);L._offset+=H,O?L.push(tt):(S.push(tt),B+=tt.length)}if((q===0||L._offset>=L._chunkSize)&&(F=L._chunkSize,L._offset=0,L._buffer=new Un(L._chunkSize)),q===0){if(W+=N-J,N=J,!O)return!0;var st=L._binding.write(v,p,W,N,L._buffer,L._offset,L._chunkSize);st.callback=X,st.buffer=p;return}if(!O)return!1;k()}}};fh(b5,fl);fh(w5,fl);fh(x5,fl);fh(k5,fl);fh(S5,fl);fh(_5,fl);fh(C5,fl);var Gce={codes:BV,createDeflate:Fzt,createInflate:Ozt,createDeflateRaw:Lzt,createInflateRaw:$zt,createGzip:zzt,createGunzip:Pzt,createUnzip:Bzt,deflate:jzt,deflateSync:Uzt,gzip:Wzt,gzipSync:Vzt,deflateRaw:Gzt,deflateRawSync:Hzt,unzip:Yzt,unzipSync:qzt,inflate:Xzt,inflateSync:Kzt,gunzip:Zzt,gunzipSync:Qzt,inflateRaw:Jzt,inflateRawSync:tPt,Deflate:b5,Inflate:w5,Gzip:x5,Gunzip:k5,DeflateRaw:S5,InflateRaw:_5,Unzip:C5,Zlib:fl},Hce=Object.freeze({__proto__:null,Deflate:b5,DeflateRaw:S5,Gunzip:k5,Gzip:x5,Inflate:w5,InflateRaw:_5,Unzip:C5,Zlib:fl,codes:BV,createDeflate:Fzt,createDeflateRaw:Lzt,createGunzip:Pzt,createGzip:zzt,createInflate:Ozt,createInflateRaw:$zt,createUnzip:Bzt,default:Gce,deflate:jzt,deflateRaw:Gzt,deflateRawSync:Hzt,deflateSync:Uzt,gunzip:Zzt,gunzipSync:Qzt,gzip:Wzt,gzipSync:Vzt,inflate:Xzt,inflateRaw:Jzt,inflateRawSync:tPt,inflateSync:Kzt,unzip:Yzt,unzipSync:qzt}),NG=M9(Hce),Ewt={exports:{}},WRt;function ePt(){if(WRt)return Ewt.exports;WRt=1;let p=XD,v=wkt,k=Ewt.exports=function(){v.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};return p.inherits(k,v),k.prototype.read=function(N,F){this._reads.push({length:Math.abs(N),allowLess:N<0,func:F}),Iu.nextTick((function(){this._process(),this._paused&&this._reads&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}).bind(this))},k.prototype.write=function(N,F){if(!this.writable)return this.emit("error",new Error("Stream not writable")),!1;let W;return Un.isBuffer(N)?W=N:W=Un.from(N,F||this._encoding),this._buffers.push(W),this._buffered+=W.length,this._process(),this._reads&&this._reads.length===0&&(this._paused=!0),this.writable&&!this._paused},k.prototype.end=function(N,F){N&&this.write(N,F),this.writable=!1,this._buffers&&(this._buffers.length===0?this._end():(this._buffers.push(null),this._process()))},k.prototype.destroySoon=k.prototype.end,k.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("Unexpected end of input")),this.destroy()},k.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},k.prototype._processReadAllowingLess=function(N){this._reads.shift();let F=this._buffers[0];F.length>N.length?(this._buffered-=N.length,this._buffers[0]=F.slice(N.length),N.func.call(this,F.slice(0,N.length))):(this._buffered-=F.length,this._buffers.shift(),N.func.call(this,F))},k.prototype._processRead=function(N){this._reads.shift();let F=0,W=0,L=Un.alloc(N.length);for(;F<N.length;){let O=this._buffers[W++],S=Math.min(O.length,N.length-F);O.copy(L,F,0,S),F+=S,S!==O.length&&(this._buffers[--W]=O.slice(S))}W>0&&this._buffers.splice(0,W),this._buffered-=N.length,N.func.call(this,L)},k.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){let N=this._reads[0];if(N.allowLess)this._processReadAllowingLess(N);else if(this._buffered>=N.length)this._processRead(N);else break}this._buffers&&!this.writable&&this._end()}catch(N){this.emit("error",N)}},Ewt.exports}var Twt={exports:{}},Awt={exports:{}},vst={},VRt;function nPt(){if(VRt)return vst;VRt=1;let p=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];return vst.getImagePasses=function(v,k){let N=[],F=v%8,W=k%8,L=(v-F)/8,O=(k-W)/8;for(let S=0;S<p.length;S++){let B=p[S],j=L*B.x.length,K=O*B.y.length;for(let Z=0;Z<B.x.length&&B.x[Z]<F;Z++)j++;for(let Z=0;Z<B.y.length&&B.y[Z]<W;Z++)K++;j>0&&K>0&&N.push({width:j,height:K,index:S})}return N},vst.getInterlaceIterator=function(v){return function(k,N,F){let W=k%p[F].x.length,L=(k-W)/p[F].x.length*8+p[F].x[W],O=N%p[F].y.length,S=(N-O)/p[F].y.length*8+p[F].y[O];return L*4+S*v*4}},vst}var Iwt,GRt;function rPt(){return GRt||(GRt=1,Iwt=function(v,k,N){let F=v+k-N,W=Math.abs(F-v),L=Math.abs(F-k),O=Math.abs(F-N);return W<=L&&W<=O?v:L<=O?k:N}),Iwt}var HRt;function iPt(){if(HRt)return Awt.exports;HRt=1;let p=nPt(),v=rPt();function k(F,W,L){let O=F*W;return L!==8&&(O=Math.ceil(O/(8/L))),O}let N=Awt.exports=function(F,W){let L=F.width,O=F.height,S=F.interlace,B=F.bpp,j=F.depth;if(this.read=W.read,this.write=W.write,this.complete=W.complete,this._imageIndex=0,this._images=[],S){let K=p.getImagePasses(L,O);for(let Z=0;Z<K.length;Z++)this._images.push({byteWidth:k(K[Z].width,B,j),height:K[Z].height,lineIndex:0})}else this._images.push({byteWidth:k(L,B,j),height:O,lineIndex:0});j===8?this._xComparison=B:j===16?this._xComparison=B*2:this._xComparison=1};return N.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},N.prototype._unFilterType1=function(F,W,L){let O=this._xComparison,S=O-1;for(let B=0;B<L;B++){let j=F[1+B],K=B>S?W[B-O]:0;W[B]=j+K}},N.prototype._unFilterType2=function(F,W,L){let O=this._lastLine;for(let S=0;S<L;S++){let B=F[1+S],j=O?O[S]:0;W[S]=B+j}},N.prototype._unFilterType3=function(F,W,L){let O=this._xComparison,S=O-1,B=this._lastLine;for(let j=0;j<L;j++){let K=F[1+j],Z=B?B[j]:0,Y=j>S?W[j-O]:0,X=Math.floor((Y+Z)/2);W[j]=K+X}},N.prototype._unFilterType4=function(F,W,L){let O=this._xComparison,S=O-1,B=this._lastLine;for(let j=0;j<L;j++){let K=F[1+j],Z=B?B[j]:0,Y=j>S?W[j-O]:0,X=j>S&&B?B[j-O]:0,J=v(Y,Z,X);W[j]=K+J}},N.prototype._reverseFilterLine=function(F){let W=F[0],L,O=this._images[this._imageIndex],S=O.byteWidth;if(W===0)L=F.slice(1,S+1);else switch(L=Un.alloc(S),W){case 1:this._unFilterType1(F,L,S);break;case 2:this._unFilterType2(F,L,S);break;case 3:this._unFilterType3(F,L,S);break;case 4:this._unFilterType4(F,L,S);break;default:throw new Error("Unrecognised filter type - "+W)}this.write(L),O.lineIndex++,O.lineIndex>=O.height?(this._lastLine=null,this._imageIndex++,O=this._images[this._imageIndex]):this._lastLine=L,O?this.read(O.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())},Awt.exports}var YRt;function Yce(){if(YRt)return Twt.exports;YRt=1;let p=XD,v=ePt(),k=iPt(),N=Twt.exports=function(F){v.call(this);let W=[],L=this;this._filter=new k(F,{read:this.read.bind(this),write:function(O){W.push(O)},complete:function(){L.emit("complete",Un.concat(W))}}),this._filter.start()};return p.inherits(N,v),Twt.exports}var Nwt={exports:{}},Mwt,qRt;function MG(){return qRt||(qRt=1,Mwt={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}),Mwt}var Dwt={exports:{}},XRt;function aPt(){if(XRt)return Dwt.exports;XRt=1;let p=[];(function(){for(let k=0;k<256;k++){let N=k;for(let F=0;F<8;F++)N&1?N=3988292384^N>>>1:N=N>>>1;p[k]=N}})();let v=Dwt.exports=function(){this._crc=-1};return v.prototype.write=function(k){for(let N=0;N<k.length;N++)this._crc=p[(this._crc^k[N])&255]^this._crc>>>8;return!0},v.prototype.crc32=function(){return this._crc^-1},v.crc32=function(k){let N=-1;for(let F=0;F<k.length;F++)N=p[(N^k[F])&255]^N>>>8;return N^-1},Dwt.exports}var KRt;function oPt(){if(KRt)return Nwt.exports;KRt=1;let p=MG(),v=aPt(),k=Nwt.exports=function(N,F){this._options=N,N.checkCRC=N.checkCRC!==!1,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[p.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[p.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[p.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[p.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[p.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[p.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=F.read,this.error=F.error,this.metadata=F.metadata,this.gamma=F.gamma,this.transColor=F.transColor,this.palette=F.palette,this.parsed=F.parsed,this.inflateData=F.inflateData,this.finished=F.finished,this.simpleTransparency=F.simpleTransparency,this.headersFinished=F.headersFinished||function(){}};return k.prototype.start=function(){this.read(p.PNG_SIGNATURE.length,this._parseSignature.bind(this))},k.prototype._parseSignature=function(N){let F=p.PNG_SIGNATURE;for(let W=0;W<F.length;W++)if(N[W]!==F[W]){this.error(new Error("Invalid file signature"));return}this.read(8,this._parseChunkBegin.bind(this))},k.prototype._parseChunkBegin=function(N){let F=N.readUInt32BE(0),W=N.readUInt32BE(4),L="";for(let S=4;S<8;S++)L+=String.fromCharCode(N[S]);let O=!!(N[4]&32);if(!this._hasIHDR&&W!==p.TYPE_IHDR){this.error(new Error("Expected IHDR on beggining"));return}if(this._crc=new v,this._crc.write(Un.from(L)),this._chunks[W])return this._chunks[W](F);if(!O){this.error(new Error("Unsupported critical chunk type "+L));return}this.read(F+4,this._skipChunk.bind(this))},k.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},k.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},k.prototype._parseChunkEnd=function(N){let F=N.readInt32BE(0),W=this._crc.crc32();if(this._options.checkCRC&&W!==F){this.error(new Error("Crc error - "+F+" - "+W));return}this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},k.prototype._handleIHDR=function(N){this.read(N,this._parseIHDR.bind(this))},k.prototype._parseIHDR=function(N){this._crc.write(N);let F=N.readUInt32BE(0),W=N.readUInt32BE(4),L=N[8],O=N[9],S=N[10],B=N[11],j=N[12];if(L!==8&&L!==4&&L!==2&&L!==1&&L!==16){this.error(new Error("Unsupported bit depth "+L));return}if(!(O in p.COLORTYPE_TO_BPP_MAP)){this.error(new Error("Unsupported color type"));return}if(S!==0){this.error(new Error("Unsupported compression method"));return}if(B!==0){this.error(new Error("Unsupported filter method"));return}if(j!==0&&j!==1){this.error(new Error("Unsupported interlace method"));return}this._colorType=O;let K=p.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:F,height:W,depth:L,interlace:!!j,palette:!!(O&p.COLORTYPE_PALETTE),color:!!(O&p.COLORTYPE_COLOR),alpha:!!(O&p.COLORTYPE_ALPHA),bpp:K,colorType:O}),this._handleChunkEnd()},k.prototype._handlePLTE=function(N){this.read(N,this._parsePLTE.bind(this))},k.prototype._parsePLTE=function(N){this._crc.write(N);let F=Math.floor(N.length/3);for(let W=0;W<F;W++)this._palette.push([N[W*3],N[W*3+1],N[W*3+2],255]);this.palette(this._palette),this._handleChunkEnd()},k.prototype._handleTRNS=function(N){this.simpleTransparency(),this.read(N,this._parseTRNS.bind(this))},k.prototype._parseTRNS=function(N){if(this._crc.write(N),this._colorType===p.COLORTYPE_PALETTE_COLOR){if(this._palette.length===0){this.error(new Error("Transparency chunk must be after palette"));return}if(N.length>this._palette.length){this.error(new Error("More transparent colors than palette size"));return}for(let F=0;F<N.length;F++)this._palette[F][3]=N[F];this.palette(this._palette)}this._colorType===p.COLORTYPE_GRAYSCALE&&this.transColor([N.readUInt16BE(0)]),this._colorType===p.COLORTYPE_COLOR&&this.transColor([N.readUInt16BE(0),N.readUInt16BE(2),N.readUInt16BE(4)]),this._handleChunkEnd()},k.prototype._handleGAMA=function(N){this.read(N,this._parseGAMA.bind(this))},k.prototype._parseGAMA=function(N){this._crc.write(N),this.gamma(N.readUInt32BE(0)/p.GAMMA_DIVISION),this._handleChunkEnd()},k.prototype._handleIDAT=function(N){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-N,this._parseIDAT.bind(this,N))},k.prototype._parseIDAT=function(N,F){if(this._crc.write(F),this._colorType===p.COLORTYPE_PALETTE_COLOR&&this._palette.length===0)throw new Error("Expected palette not found");this.inflateData(F);let W=N-F.length;W>0?this._handleIDAT(W):this._handleChunkEnd()},k.prototype._handleIEND=function(N){this.read(N,this._parseIEND.bind(this))},k.prototype._parseIEND=function(N){this._crc.write(N),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()},Nwt.exports}var Rwt={},ZRt;function sPt(){if(ZRt)return Rwt;ZRt=1;let p=nPt(),v=[function(){},function(L,O,S,B){if(B===O.length)throw new Error("Ran out of data");let j=O[B];L[S]=j,L[S+1]=j,L[S+2]=j,L[S+3]=255},function(L,O,S,B){if(B+1>=O.length)throw new Error("Ran out of data");let j=O[B];L[S]=j,L[S+1]=j,L[S+2]=j,L[S+3]=O[B+1]},function(L,O,S,B){if(B+2>=O.length)throw new Error("Ran out of data");L[S]=O[B],L[S+1]=O[B+1],L[S+2]=O[B+2],L[S+3]=255},function(L,O,S,B){if(B+3>=O.length)throw new Error("Ran out of data");L[S]=O[B],L[S+1]=O[B+1],L[S+2]=O[B+2],L[S+3]=O[B+3]}],k=[function(){},function(L,O,S,B){let j=O[0];L[S]=j,L[S+1]=j,L[S+2]=j,L[S+3]=B},function(L,O,S){let B=O[0];L[S]=B,L[S+1]=B,L[S+2]=B,L[S+3]=O[1]},function(L,O,S,B){L[S]=O[0],L[S+1]=O[1],L[S+2]=O[2],L[S+3]=B},function(L,O,S){L[S]=O[0],L[S+1]=O[1],L[S+2]=O[2],L[S+3]=O[3]}];function N(L,O){let S=[],B=0;function j(){if(B===L.length)throw new Error("Ran out of data");let K=L[B];B++;let Z,Y,X,J,q,H,tt,st;switch(O){default:throw new Error("unrecognised depth");case 16:tt=L[B],B++,S.push((K<<8)+tt);break;case 4:tt=K&15,st=K>>4,S.push(st,tt);break;case 2:q=K&3,H=K>>2&3,tt=K>>4&3,st=K>>6&3,S.push(st,tt,H,q);break;case 1:Z=K&1,Y=K>>1&1,X=K>>2&1,J=K>>3&1,q=K>>4&1,H=K>>5&1,tt=K>>6&1,st=K>>7&1,S.push(st,tt,H,q,J,X,Y,Z);break}}return{get:function(K){for(;S.length<K;)j();let Z=S.slice(0,K);return S=S.slice(K),Z},resetAfterLine:function(){S.length=0},end:function(){if(B!==L.length)throw new Error("extra data found")}}}function F(L,O,S,B,j,K){let Z=L.width,Y=L.height,X=L.index;for(let J=0;J<Y;J++)for(let q=0;q<Z;q++){let H=S(q,J,X);v[B](O,j,H,K),K+=B}return K}function W(L,O,S,B,j,K){let Z=L.width,Y=L.height,X=L.index;for(let J=0;J<Y;J++){for(let q=0;q<Z;q++){let H=j.get(B),tt=S(q,J,X);k[B](O,H,tt,K)}j.resetAfterLine()}}return Rwt.dataToBitMap=function(L,O){let S=O.width,B=O.height,j=O.depth,K=O.bpp,Z=O.interlace,Y;j!==8&&(Y=N(L,j));let X;j<=8?X=Un.alloc(S*B*4):X=new Uint16Array(S*B*4);let J=Math.pow(2,j)-1,q=0,H,tt;if(Z)H=p.getImagePasses(S,B),tt=p.getInterlaceIterator(S,B);else{let st=0;tt=function(){let lt=st;return st+=4,lt},H=[{width:S,height:B}]}for(let st=0;st<H.length;st++)j===8?q=F(H[st],X,tt,K,L,q):W(H[st],X,tt,K,Y,J);if(j===8){if(q!==L.length)throw new Error("extra data found")}else Y.end();return X},Rwt}var Fwt,QRt;function uPt(){if(QRt)return Fwt;QRt=1;function p(N,F,W,L,O){let S=0;for(let B=0;B<L;B++)for(let j=0;j<W;j++){let K=O[N[S]];if(!K)throw new Error("index "+N[S]+" not in palette");for(let Z=0;Z<4;Z++)F[S+Z]=K[Z];S+=4}}function v(N,F,W,L,O){let S=0;for(let B=0;B<L;B++)for(let j=0;j<W;j++){let K=!1;if(O.length===1?O[0]===N[S]&&(K=!0):O[0]===N[S]&&O[1]===N[S+1]&&O[2]===N[S+2]&&(K=!0),K)for(let Z=0;Z<4;Z++)F[S+Z]=0;S+=4}}function k(N,F,W,L,O){let S=255,B=Math.pow(2,O)-1,j=0;for(let K=0;K<L;K++)for(let Z=0;Z<W;Z++){for(let Y=0;Y<4;Y++)F[j+Y]=Math.floor(N[j+Y]*S/B+.5);j+=4}}return Fwt=function(N,F){let W=F.depth,L=F.width,O=F.height,S=F.colorType,B=F.transColor,j=F.palette,K=N;return S===3?p(N,K,L,O,j):(B&&v(N,K,L,O,B),W!==8&&(W===16&&(K=Un.alloc(L*O*4)),k(N,K,L,O,W))),K},Fwt}var JRt;function qce(){if(JRt)return fwt.exports;JRt=1;let p=XD,v=NG,k=ePt(),N=Yce(),F=oPt(),W=sPt(),L=uPt(),O=fwt.exports=function(S){k.call(this),this._parser=new F(S,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=S,this.writable=!0,this._parser.start()};return p.inherits(O,k),O.prototype._handleError=function(S){this.emit("error",S),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",function(){})),this.errord=!0},O.prototype._inflateData=function(S){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=v.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{let j=((this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3)+1)*this._bitmapInfo.height,K=Math.max(j,v.Z_MIN_CHUNK);this._inflate=v.createInflate({chunkSize:K});let Z=j,Y=this.emit.bind(this,"error");this._inflate.on("error",function(J){Z&&Y(J)}),this._filter.on("complete",this._complete.bind(this));let X=this._filter.write.bind(this._filter);this._inflate.on("data",function(J){Z&&(J.length>Z&&(J=J.slice(0,Z)),Z-=J.length,X(J))}),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(S)},O.prototype._handleMetaData=function(S){this._metaData=S,this._bitmapInfo=Object.create(S),this._filter=new N(this._bitmapInfo)},O.prototype._handleTransColor=function(S){this._bitmapInfo.transColor=S},O.prototype._handlePalette=function(S){this._bitmapInfo.palette=S},O.prototype._simpleTransparency=function(){this._metaData.alpha=!0},O.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},O.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"))},O.prototype._complete=function(S){if(this.errord)return;let B;try{let j=W.dataToBitMap(S,this._bitmapInfo);B=L(j,this._bitmapInfo),j=null}catch(j){this._handleError(j);return}this.emit("parsed",B)},fwt.exports}var Owt={exports:{}},Lwt={exports:{}},$wt,tFt;function Xce(){if(tFt)return $wt;tFt=1;let p=MG();return $wt=function(v,k,N,F){let W=[p.COLORTYPE_COLOR_ALPHA,p.COLORTYPE_ALPHA].indexOf(F.colorType)!==-1;if(F.colorType===F.inputColorType){let J=function(){let q=new ArrayBuffer(2);return new DataView(q).setInt16(0,256,!0),new Int16Array(q)[0]!==256}();if(F.bitDepth===8||F.bitDepth===16&&J)return v}let L=F.bitDepth!==16?v:new Uint16Array(v.buffer),O=255,S=p.COLORTYPE_TO_BPP_MAP[F.inputColorType];S===4&&!F.inputHasAlpha&&(S=3);let B=p.COLORTYPE_TO_BPP_MAP[F.colorType];F.bitDepth===16&&(O=65535,B*=2);let j=Un.alloc(k*N*B),K=0,Z=0,Y=F.bgColor||{};Y.red===void 0&&(Y.red=O),Y.green===void 0&&(Y.green=O),Y.blue===void 0&&(Y.blue=O);function X(){let J,q,H,tt=O;switch(F.inputColorType){case p.COLORTYPE_COLOR_ALPHA:tt=L[K+3],J=L[K],q=L[K+1],H=L[K+2];break;case p.COLORTYPE_COLOR:J=L[K],q=L[K+1],H=L[K+2];break;case p.COLORTYPE_ALPHA:tt=L[K+1],J=L[K],q=J,H=J;break;case p.COLORTYPE_GRAYSCALE:J=L[K],q=J,H=J;break;default:throw new Error("input color type:"+F.inputColorType+" is not supported at present")}return F.inputHasAlpha&&(W||(tt/=O,J=Math.min(Math.max(Math.round((1-tt)*Y.red+tt*J),0),O),q=Math.min(Math.max(Math.round((1-tt)*Y.green+tt*q),0),O),H=Math.min(Math.max(Math.round((1-tt)*Y.blue+tt*H),0),O))),{red:J,green:q,blue:H,alpha:tt}}for(let J=0;J<N;J++)for(let q=0;q<k;q++){let H=X();switch(F.colorType){case p.COLORTYPE_COLOR_ALPHA:case p.COLORTYPE_COLOR:F.bitDepth===8?(j[Z]=H.red,j[Z+1]=H.green,j[Z+2]=H.blue,W&&(j[Z+3]=H.alpha)):(j.writeUInt16BE(H.red,Z),j.writeUInt16BE(H.green,Z+2),j.writeUInt16BE(H.blue,Z+4),W&&j.writeUInt16BE(H.alpha,Z+6));break;case p.COLORTYPE_ALPHA:case p.COLORTYPE_GRAYSCALE:{let tt=(H.red+H.green+H.blue)/3;F.bitDepth===8?(j[Z]=tt,W&&(j[Z+1]=H.alpha)):(j.writeUInt16BE(tt,Z),W&&j.writeUInt16BE(H.alpha,Z+2));break}default:throw new Error("unrecognised color Type "+F.colorType)}K+=S,Z+=B}return j},$wt}var zwt,eFt;function Kce(){if(eFt)return zwt;eFt=1;let p=rPt();function v(Y,X,J,q,H){for(let tt=0;tt<J;tt++)q[H+tt]=Y[X+tt]}function k(Y,X,J){let q=0,H=X+J;for(let tt=X;tt<H;tt++)q+=Math.abs(Y[tt]);return q}function N(Y,X,J,q,H,tt){for(let st=0;st<J;st++){let lt=st>=tt?Y[X+st-tt]:0,ft=Y[X+st]-lt;q[H+st]=ft}}function F(Y,X,J,q){let H=0;for(let tt=0;tt<J;tt++){let st=tt>=q?Y[X+tt-q]:0,lt=Y[X+tt]-st;H+=Math.abs(lt)}return H}function W(Y,X,J,q,H){for(let tt=0;tt<J;tt++){let st=X>0?Y[X+tt-J]:0,lt=Y[X+tt]-st;q[H+tt]=lt}}function L(Y,X,J){let q=0,H=X+J;for(let tt=X;tt<H;tt++){let st=X>0?Y[tt-J]:0,lt=Y[tt]-st;q+=Math.abs(lt)}return q}function O(Y,X,J,q,H,tt){for(let st=0;st<J;st++){let lt=st>=tt?Y[X+st-tt]:0,ft=X>0?Y[X+st-J]:0,gt=Y[X+st]-(lt+ft>>1);q[H+st]=gt}}function S(Y,X,J,q){let H=0;for(let tt=0;tt<J;tt++){let st=tt>=q?Y[X+tt-q]:0,lt=X>0?Y[X+tt-J]:0,ft=Y[X+tt]-(st+lt>>1);H+=Math.abs(ft)}return H}function B(Y,X,J,q,H,tt){for(let st=0;st<J;st++){let lt=st>=tt?Y[X+st-tt]:0,ft=X>0?Y[X+st-J]:0,gt=X>0&&st>=tt?Y[X+st-(J+tt)]:0,xt=Y[X+st]-p(lt,ft,gt);q[H+st]=xt}}function j(Y,X,J,q){let H=0;for(let tt=0;tt<J;tt++){let st=tt>=q?Y[X+tt-q]:0,lt=X>0?Y[X+tt-J]:0,ft=X>0&&tt>=q?Y[X+tt-(J+q)]:0,gt=Y[X+tt]-p(st,lt,ft);H+=Math.abs(gt)}return H}let K={0:v,1:N,2:W,3:O,4:B},Z={0:k,1:F,2:L,3:S,4:j};return zwt=function(Y,X,J,q,H){let tt;if(!("filterType"in q)||q.filterType===-1)tt=[0,1,2,3,4];else if(typeof q.filterType=="number")tt=[q.filterType];else throw new Error("unrecognised filter types");q.bitDepth===16&&(H*=2);let st=X*H,lt=0,ft=0,gt=Un.alloc((st+1)*J),xt=tt[0];for(let wt=0;wt<J;wt++){if(tt.length>1){let _t=1/0;for(let bt=0;bt<tt.length;bt++){let Tt=Z[tt[bt]](Y,ft,st,H);Tt<_t&&(xt=tt[bt],_t=Tt)}}gt[lt]=xt,lt++,K[xt](Y,ft,st,gt,lt,H),lt+=st,ft+=st}return gt},zwt}var nFt;function lPt(){if(nFt)return Lwt.exports;nFt=1;let p=MG(),v=aPt(),k=Xce(),N=Kce(),F=NG,W=Lwt.exports=function(L){if(this._options=L,L.deflateChunkSize=L.deflateChunkSize||32*1024,L.deflateLevel=L.deflateLevel!=null?L.deflateLevel:9,L.deflateStrategy=L.deflateStrategy!=null?L.deflateStrategy:3,L.inputHasAlpha=L.inputHasAlpha!=null?L.inputHasAlpha:!0,L.deflateFactory=L.deflateFactory||F.createDeflate,L.bitDepth=L.bitDepth||8,L.colorType=typeof L.colorType=="number"?L.colorType:p.COLORTYPE_COLOR_ALPHA,L.inputColorType=typeof L.inputColorType=="number"?L.inputColorType:p.COLORTYPE_COLOR_ALPHA,[p.COLORTYPE_GRAYSCALE,p.COLORTYPE_COLOR,p.COLORTYPE_COLOR_ALPHA,p.COLORTYPE_ALPHA].indexOf(L.colorType)===-1)throw new Error("option color type:"+L.colorType+" is not supported at present");if([p.COLORTYPE_GRAYSCALE,p.COLORTYPE_COLOR,p.COLORTYPE_COLOR_ALPHA,p.COLORTYPE_ALPHA].indexOf(L.inputColorType)===-1)throw new Error("option input color type:"+L.inputColorType+" is not supported at present");if(L.bitDepth!==8&&L.bitDepth!==16)throw new Error("option bit depth:"+L.bitDepth+" is not supported at present")};return W.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},W.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},W.prototype.filterData=function(L,O,S){let B=k(L,O,S,this._options),j=p.COLORTYPE_TO_BPP_MAP[this._options.colorType];return N(B,O,S,this._options,j)},W.prototype._packChunk=function(L,O){let S=O?O.length:0,B=Un.alloc(S+12);return B.writeUInt32BE(S,0),B.writeUInt32BE(L,4),O&&O.copy(B,8),B.writeInt32BE(v.crc32(B.slice(4,B.length-4)),B.length-4),B},W.prototype.packGAMA=function(L){let O=Un.alloc(4);return O.writeUInt32BE(Math.floor(L*p.GAMMA_DIVISION),0),this._packChunk(p.TYPE_gAMA,O)},W.prototype.packIHDR=function(L,O){let S=Un.alloc(13);return S.writeUInt32BE(L,0),S.writeUInt32BE(O,4),S[8]=this._options.bitDepth,S[9]=this._options.colorType,S[10]=0,S[11]=0,S[12]=0,this._packChunk(p.TYPE_IHDR,S)},W.prototype.packIDAT=function(L){return this._packChunk(p.TYPE_IDAT,L)},W.prototype.packIEND=function(){return this._packChunk(p.TYPE_IEND,null)},Lwt.exports}var rFt;function Zce(){if(rFt)return Owt.exports;rFt=1;let p=XD,v=wkt,k=MG(),N=lPt(),F=Owt.exports=function(W){v.call(this);let L=W||{};this._packer=new N(L),this._deflate=this._packer.createDeflate(),this.readable=!0};return p.inherits(F,v),F.prototype.pack=function(W,L,O,S){this.emit("data",Un.from(k.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(L,O)),S&&this.emit("data",this._packer.packGAMA(S));let B=this._packer.filterData(W,L,O);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",(function(j){this.emit("data",this._packer.packIDAT(j))}).bind(this)),this._deflate.on("end",(function(){this.emit("data",this._packer.packIEND()),this.emit("end")}).bind(this)),this._deflate.end(B)},Owt.exports}var bst={},wst={exports:{}};function iFt(p,v){if(p===v)return 0;for(var k=p.length,N=v.length,F=0,W=Math.min(k,N);F<W;++F)if(p[F]!==v[F]){k=p[F],N=v[F];break}return k<N?-1:N<k?1:0}var Qce=Object.prototype.hasOwnProperty,aFt=Object.keys||function(p){var v=[];for(var k in p)Qce.call(p,k)&&v.push(k);return v},oFt=Array.prototype.slice,Pwt;function cPt(){return typeof Pwt<"u"?Pwt:Pwt=function(){return(function(){}).name==="foo"}()}function sFt(p){return Object.prototype.toString.call(p)}function uFt(p){return J9(p)||typeof uw.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(p):p?!!(p instanceof DataView||p.buffer&&p.buffer instanceof ArrayBuffer):!1}function rp(p,v){p||ep(p,!0,v,"==",dG)}var Jce=/\s*function\s+([^\(\s]*)\s*/;function hPt(p){if(w8(p)){if(cPt())return p.name;var v=p.toString(),k=v.match(Jce);return k&&k[1]}}rp.AssertionError=blt;function blt(p){this.name="AssertionError",this.actual=p.actual,this.expected=p.expected,this.operator=p.operator,p.message?(this.message=p.message,this.generatedMessage=!1):(this.message=the(this),this.generatedMessage=!0);var v=p.stackStartFunction||ep;if(Error.captureStackTrace)Error.captureStackTrace(this,v);else{var k=new Error;if(k.stack){var N=k.stack,F=hPt(v),W=N.indexOf(`
`+F);if(W>=0){var L=N.indexOf(`
`,W+1);N=N.substring(L+1)}this.stack=N}}}fh(blt,Error);function lFt(p,v){return typeof p=="string"?p.length<v?p:p.slice(0,v):p}function cFt(p){if(cPt()||!w8(p))return e2(p);var v=hPt(p),k=v?": "+v:"";return"[Function"+k+"]"}function the(p){return lFt(cFt(p.actual),128)+" "+p.operator+" "+lFt(cFt(p.expected),128)}function ep(p,v,k,N,F){throw new blt({message:k,actual:p,expected:v,operator:N,stackStartFunction:F})}rp.fail=ep;function dG(p,v){p||ep(p,!0,v,"==",dG)}rp.ok=dG;rp.equal=Akt;function Akt(p,v,k){p!=v&&ep(p,v,k,"==",Akt)}rp.notEqual=Ikt;function Ikt(p,v,k){p==v&&ep(p,v,k,"!=",Ikt)}rp.deepEqual=Nkt;function Nkt(p,v,k){VD(p,v,!1)||ep(p,v,k,"deepEqual",Nkt)}rp.deepStrictEqual=Mkt;function Mkt(p,v,k){VD(p,v,!0)||ep(p,v,k,"deepStrictEqual",Mkt)}function VD(p,v,k,N){if(p===v)return!0;if(J9(p)&&J9(v))return iFt(p,v)===0;if(jD(p)&&jD(v))return p.getTime()===v.getTime();if(b8(p)&&b8(v))return p.source===v.source&&p.global===v.global&&p.multiline===v.multiline&&p.lastIndex===v.lastIndex&&p.ignoreCase===v.ignoreCase;if((p===null||typeof p!="object")&&(v===null||typeof v!="object"))return k?p===v:p==v;if(uFt(p)&&uFt(v)&&sFt(p)===sFt(v)&&!(p instanceof Float32Array||p instanceof Float64Array))return iFt(new Uint8Array(p.buffer),new Uint8Array(v.buffer))===0;if(J9(p)!==J9(v))return!1;N=N||{actual:[],expected:[]};var F=N.actual.indexOf(p);return F!==-1&&F===N.expected.indexOf(v)?!0:(N.actual.push(p),N.expected.push(v),ehe(p,v,k,N))}function hFt(p){return Object.prototype.toString.call(p)=="[object Arguments]"}function ehe(p,v,k,N){if(p==null||v===null||v===void 0)return!1;if(jut(p)||jut(v))return p===v;if(k&&Object.getPrototypeOf(p)!==Object.getPrototypeOf(v))return!1;var F=hFt(p),W=hFt(v);if(F&&!W||!F&&W)return!1;if(F)return p=oFt.call(p),v=oFt.call(v),VD(p,v,k);var L=aFt(p),O=aFt(v),S,B;if(L.length!==O.length)return!1;for(L.sort(),O.sort(),B=L.length-1;B>=0;B--)if(L[B]!==O[B])return!1;for(B=L.length-1;B>=0;B--)if(S=L[B],!VD(p[S],v[S],k,N))return!1;return!0}rp.notDeepEqual=Dkt;function Dkt(p,v,k){VD(p,v,!1)&&ep(p,v,k,"notDeepEqual",Dkt)}rp.notDeepStrictEqual=Rkt;function Rkt(p,v,k){VD(p,v,!0)&&ep(p,v,k,"notDeepStrictEqual",Rkt)}rp.strictEqual=Fkt;function Fkt(p,v,k){p!==v&&ep(p,v,k,"===",Fkt)}rp.notStrictEqual=Okt;function Okt(p,v,k){p===v&&ep(p,v,k,"!==",Okt)}function dFt(p,v){if(!p||!v)return!1;if(Object.prototype.toString.call(v)=="[object RegExp]")return v.test(p);try{if(p instanceof v)return!0}catch{}return Error.isPrototypeOf(v)?!1:v.call({},p)===!0}function nhe(p){var v;try{p()}catch(k){v=k}return v}function dPt(p,v,k,N){var F;if(typeof v!="function")throw new TypeError('"block" argument must be a function');typeof k=="string"&&(N=k,k=null),F=nhe(v),N=(k&&k.name?" ("+k.name+").":".")+(N?" "+N:"."),p&&!F&&ep(F,k,"Missing expected exception"+N);var W=typeof N=="string",L=!p&&ID(F),O=!p&&F&&!k;if((L&&W&&dFt(F,k)||O)&&ep(F,k,"Got unwanted exception"+N),p&&F&&k&&!dFt(F,k)||!p&&F)throw F}rp.throws=fPt;function fPt(p,v,k){dPt(!0,p,v,k)}rp.doesNotThrow=pPt;function pPt(p,v,k){dPt(!1,p,v,k)}rp.ifError=mPt;function mPt(p){if(p)throw p}var rhe=Object.freeze({__proto__:null,AssertionError:blt,assert:dG,deepEqual:Nkt,deepStrictEqual:Mkt,default:rp,doesNotThrow:pPt,equal:Akt,fail:ep,ifError:mPt,notDeepEqual:Dkt,notDeepStrictEqual:Rkt,notEqual:Ikt,notStrictEqual:Okt,ok:dG,strictEqual:Fkt,throws:fPt}),ihe=M9(rhe),fFt;function ahe(){return fFt||(fFt=1,function(p,v){let k=ihe.ok,N=NG,F=XD,W=q$t.kMaxLength;function L(K){if(!(this instanceof L))return new L(K);K&&K.chunkSize<N.Z_MIN_CHUNK&&(K.chunkSize=N.Z_MIN_CHUNK),N.Inflate.call(this,K),this._offset=this._offset===void 0?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,K&&K.maxLength!=null&&(this._maxLength=K.maxLength)}function O(K){return new L(K)}function S(K,Z){K._handle&&(K._handle.close(),K._handle=null)}L.prototype._processChunk=function(K,Z,Y){if(typeof Y=="function")return N.Inflate._processChunk.call(this,K,Z,Y);let X=this,J=K&&K.length,q=this._chunkSize-this._offset,H=this._maxLength,tt=0,st=[],lt=0,ft;this.on("error",function(_t){ft=_t});function gt(_t,bt){if(X._hadError)return;let Tt=q-bt;if(k(Tt>=0,"have should not go down"),Tt>0){let qt=X._buffer.slice(X._offset,X._offset+Tt);if(X._offset+=Tt,qt.length>H&&(qt=qt.slice(0,H)),st.push(qt),lt+=qt.length,H-=qt.length,H===0)return!1}return(bt===0||X._offset>=X._chunkSize)&&(q=X._chunkSize,X._offset=0,X._buffer=Un.allocUnsafe(X._chunkSize)),bt===0?(tt+=J-_t,J=_t,!0):!1}k(this._handle,"zlib binding closed");let xt;do xt=this._handle.writeSync(Z,K,tt,J,this._buffer,this._offset,q),xt=xt||this._writeState;while(!this._hadError&&gt(xt[0],xt[1]));if(this._hadError)throw ft;if(lt>=W)throw S(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+W.toString(16)+" bytes");let wt=Un.concat(st,lt);return S(this),wt},F.inherits(L,N.Inflate);function B(K,Z){if(typeof Z=="string"&&(Z=Un.from(Z)),!(Z instanceof Un))throw new TypeError("Not a string or buffer");let Y=K._finishFlushFlag;return Y==null&&(Y=N.Z_FINISH),K._processChunk(Z,Y)}function j(K,Z){return B(new L(Z),K)}p.exports=v=j,v.Inflate=L,v.createInflate=O,v.inflateSync=j}(wst,wst.exports)),wst.exports}var Bwt={exports:{}},pFt;function gPt(){if(pFt)return Bwt.exports;pFt=1;let p=Bwt.exports=function(v){this._buffer=v,this._reads=[]};return p.prototype.read=function(v,k){this._reads.push({length:Math.abs(v),allowLess:v<0,func:k})},p.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){let v=this._reads[0];if(this._buffer.length&&(this._buffer.length>=v.length||v.allowLess)){this._reads.shift();let k=this._buffer;this._buffer=k.slice(v.length),v.func.call(this,k.slice(0,v.length))}else break}if(this._reads.length>0)return new Error("There are some read requests waitng on finished stream");if(this._buffer.length>0)return new Error("unrecognised content at end of stream")},Bwt.exports}var jwt={},mFt;function ohe(){if(mFt)return jwt;mFt=1;let p=gPt(),v=iPt();return jwt.process=function(k,N){let F=[],W=new p(k);return new v(N,{read:W.read.bind(W),write:function(O){F.push(O)},complete:function(){}}).start(),W.process(),Un.concat(F)},jwt}var Uwt,gFt;function she(){if(gFt)return Uwt;gFt=1;let p=!0,v=NG,k=ahe();v.deflateSync||(p=!1);let N=gPt(),F=ohe(),W=oPt(),L=sPt(),O=uPt();return Uwt=function(S,B){if(!p)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let j;function K(qt){j=qt}let Z;function Y(qt){Z=qt}function X(qt){Z.transColor=qt}function J(qt){Z.palette=qt}function q(){Z.alpha=!0}let H;function tt(qt){H=qt}let st=[];function lt(qt){st.push(qt)}let ft=new N(S);if(new W(B,{read:ft.read.bind(ft),error:K,metadata:Y,gamma:tt,palette:J,transColor:X,inflateData:lt,simpleTransparency:q}).start(),ft.process(),j)throw j;let xt=Un.concat(st);st.length=0;let wt;if(Z.interlace)wt=v.inflateSync(xt);else{let It=((Z.width*Z.bpp*Z.depth+7>>3)+1)*Z.height;wt=k(xt,{chunkSize:It,maxLength:It})}if(xt=null,!wt||!wt.length)throw new Error("bad png - invalid inflate data response");let _t=F.process(wt,Z);xt=null;let bt=L.dataToBitMap(_t,Z);_t=null;let Tt=O(bt,Z);return Z.data=Tt,Z.gamma=H||0,Z},Uwt}var Wwt,yFt;function uhe(){if(yFt)return Wwt;yFt=1;let p=!0,v=NG;v.deflateSync||(p=!1);let k=MG(),N=lPt();return Wwt=function(F,W){if(!p)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let L=W||{},O=new N(L),S=[];S.push(Un.from(k.PNG_SIGNATURE)),S.push(O.packIHDR(F.width,F.height)),F.gamma&&S.push(O.packGAMA(F.gamma));let B=O.filterData(F.data,F.width,F.height),j=v.deflateSync(B,O.getDeflateOptions());if(B=null,!j||!j.length)throw new Error("bad png - invalid compressed data response");return S.push(O.packIDAT(j)),S.push(O.packIEND()),Un.concat(S)},Wwt}var vFt;function lhe(){if(vFt)return bst;vFt=1;let p=she(),v=uhe();return bst.read=function(k,N){return p(k,N||{})},bst.write=function(k,N){return v(k,N)},bst}var bFt;function che(){if(bFt)return owt;bFt=1;let p=XD,v=wkt,k=qce(),N=Zce(),F=lhe(),W=owt.PNG=function(L){v.call(this),L=L||{},this.width=L.width|0,this.height=L.height|0,this.data=this.width>0&&this.height>0?Un.alloc(4*this.width*this.height):null,L.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new k(L),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",(function(O){this.data=O,this.emit("parsed",O)}).bind(this)),this._packer=new N(L),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};return p.inherits(W,v),W.sync=F,W.prototype.pack=function(){return!this.data||!this.data.length?(this.emit("error","No data provided"),this):(Iu.nextTick((function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}).bind(this)),this)},W.prototype.parse=function(L,O){if(O){let S,B;S=(function(j){this.removeListener("error",B),this.data=j,O(null,this)}).bind(this),B=(function(j){this.removeListener("parsed",S),O(j,null)}).bind(this),this.once("parsed",S),this.once("error",B)}return this.end(L),this},W.prototype.write=function(L){return this._parser.write(L),!0},W.prototype.end=function(L){this._parser.end(L)},W.prototype._metadata=function(L){this.width=L.width,this.height=L.height,this.emit("metadata",L)},W.prototype._gamma=function(L){this.gamma=L},W.prototype._handleClose=function(){!this._parser.writable&&!this._packer.readable&&this.emit("close")},W.bitblt=function(L,O,S,B,j,K,Z,Y){if(S|=0,B|=0,j|=0,K|=0,Z|=0,Y|=0,S>L.width||B>L.height||S+j>L.width||B+K>L.height)throw new Error("bitblt reading outside image");if(Z>O.width||Y>O.height||Z+j>O.width||Y+K>O.height)throw new Error("bitblt writing outside image");for(let X=0;X<K;X++)L.data.copy(O.data,(Y+X)*O.width+Z<<2,(B+X)*L.width+S<<2,(B+X)*L.width+S+j<<2)},W.prototype.bitblt=function(L,O,S,B,j,K,Z){return W.bitblt(this,L,O,S,B,j,K,Z),this},W.adjustGamma=function(L){if(L.gamma){for(let O=0;O<L.height;O++)for(let S=0;S<L.width;S++){let B=L.width*O+S<<2;for(let j=0;j<3;j++){let K=L.data[B+j]/255;K=Math.pow(K,1/2.2/L.gamma),L.data[B+j]=Math.round(K*255)}}L.gamma=0}},W.prototype.adjustGamma=function(){W.adjustGamma(this)},owt}var Vwt={},wFt;function wlt(){return wFt||(wFt=1,function(p){function v(k){if(typeof k=="number"&&(k=k.toString()),typeof k!="string")throw new Error("Color should be defined as hex string");let N=k.slice().replace("#","").split("");if(N.length<3||N.length===5||N.length>8)throw new Error("Invalid hex color: "+k);(N.length===3||N.length===4)&&(N=Array.prototype.concat.apply([],N.map(function(W){return[W,W]}))),N.length===6&&N.push("F","F");let F=parseInt(N.join(""),16);return{r:F>>24&255,g:F>>16&255,b:F>>8&255,a:F&255,hex:"#"+N.slice(0,6).join("")}}p.getOptions=function(N){N||(N={}),N.color||(N.color={});let F=typeof N.margin>"u"||N.margin===null||N.margin<0?4:N.margin,W=N.width&&N.width>=21?N.width:void 0,L=N.scale||4;return{width:W,scale:W?4:L,margin:F,color:{dark:v(N.color.dark||"#000000ff"),light:v(N.color.light||"#ffffffff")},type:N.type,rendererOpts:N.rendererOpts||{}}},p.getScale=function(N,F){return F.width&&F.width>=N+F.margin*2?F.width/(N+F.margin*2):F.scale},p.getImageWidth=function(N,F){let W=p.getScale(N,F);return Math.floor((N+F.margin*2)*W)},p.qrToImageData=function(N,F,W){let L=F.modules.size,O=F.modules.data,S=p.getScale(L,W),B=Math.floor((L+W.margin*2)*S),j=W.margin*S,K=[W.color.light,W.color.dark];for(let Z=0;Z<B;Z++)for(let Y=0;Y<B;Y++){let X=(Z*B+Y)*4,J=W.color.light;if(Z>=j&&Y>=j&&Z<B-j&&Y<B-j){let q=Math.floor((Z-j)/S),H=Math.floor((Y-j)/S);J=K[O[q*L+H]?1:0]}N[X++]=J.r,N[X++]=J.g,N[X++]=J.b,N[X]=J.a}}}(Vwt)),Vwt}var xFt;function hhe(){return xFt||(xFt=1,function(p){let v=dkt,k=che().PNG,N=wlt();p.render=function(W,L){let O=N.getOptions(L),S=O.rendererOpts,B=N.getImageWidth(W.modules.size,O);S.width=B,S.height=B;let j=new k(S);return N.qrToImageData(j.data,W,O),j},p.renderToDataURL=function(W,L,O){typeof O>"u"&&(O=L,L=void 0),p.renderToBuffer(W,L,function(S,B){S&&O(S);let j="data:image/png;base64,";j+=B.toString("base64"),O(null,j)})},p.renderToBuffer=function(W,L,O){typeof O>"u"&&(O=L,L=void 0);let S=p.render(W,L),B=[];S.on("error",O),S.on("data",function(j){B.push(j)}),S.on("end",function(){O(null,Un.concat(B))}),S.pack()},p.renderToFile=function(W,L,O,S){typeof S>"u"&&(S=O,O=void 0);let B=!1,j=(...Z)=>{B||(B=!0,S.apply(null,Z))},K=v.createWriteStream(W);K.on("error",j),K.on("close",j),p.renderToFileStream(K,L,O)},p.renderToFileStream=function(W,L,O){p.render(L,O).pack().pipe(W)}}(awt)),awt}var Gwt={},kFt;function dhe(){return kFt||(kFt=1,function(p){let v=wlt(),k={WW:" ",WB:"\u2584",BB:"\u2588",BW:"\u2580"},N={BB:" ",BW:"\u2584",WW:"\u2588",WB:"\u2580"};function F(W,L,O){return W&&L?O.BB:W&&!L?O.BW:!W&&L?O.WB:O.WW}p.render=function(W,L,O){let S=v.getOptions(L),B=k;(S.color.dark.hex==="#ffffff"||S.color.light.hex==="#000000")&&(B=N);let j=W.modules.size,K=W.modules.data,Z="",Y=Array(j+S.margin*2+1).join(B.WW);Y=Array(S.margin/2+1).join(Y+`
`);let X=Array(S.margin+1).join(B.WW);Z+=Y;for(let J=0;J<j;J+=2){Z+=X;for(let q=0;q<j;q++){let H=K[J*j+q],tt=K[(J+1)*j+q];Z+=F(H,tt,B)}Z+=X+`
`}return Z+=Y.slice(0,-1),typeof O=="function"&&O(null,Z),Z},p.renderToFile=function(L,O,S,B){typeof B>"u"&&(B=S,S=void 0);let j=dkt,K=p.render(O,S);j.writeFile(L,K,B)}}(Gwt)),Gwt}var Hwt={},Ywt={},SFt;function fhe(){return SFt||(SFt=1,Ywt.render=function(p,v,k){let N=p.modules.size,F=p.modules.data,W="\x1B[40m  \x1B[0m",L="\x1B[47m  \x1B[0m",O="",S=Array(N+3).join(L),B=Array(2).join(L);O+=S+`
`;for(let j=0;j<N;++j){O+=L;for(let K=0;K<N;K++)O+=F[j*N+K]?W:L;O+=B+`
`}return O+=S+`
`,typeof k=="function"&&k(null,O),O}),Ywt}var qwt={},_Ft;function phe(){if(_Ft)return qwt;_Ft=1;let p="\x1B[47m",v="\x1B[40m",k="\x1B[37m",N="\x1B[30m",F="\x1B[0m",W=p+N,L=v+k,O=function(j,K,Z){return{"00":F+" "+j,"01":F+K+"\u2584"+j,"02":F+Z+"\u2584"+j,10:F+K+"\u2580"+j,11:" ",12:"\u2584",20:F+Z+"\u2580"+j,21:"\u2580",22:"\u2588"}},S=function(j,K,Z,Y){let X=K+1;if(Z>=X||Y>=X||Y<-1||Z<-1)return"0";if(Z>=K||Y>=K||Y<0||Z<0)return"1";let J=Y*K+Z;return j[J]?"2":"1"},B=function(j,K,Z,Y){return S(j,K,Z,Y)+S(j,K,Z,Y+1)};return qwt.render=function(j,K,Z){let Y=j.modules.size,X=j.modules.data,J=!!(K&&K.inverse),q=K&&K.inverse?L:W,st=O(q,J?N:k,J?k:N),lt=F+`
`+q,ft=q;for(let gt=-1;gt<Y+1;gt+=2){for(let xt=-1;xt<Y;xt++)ft+=st[B(X,Y,xt,gt)];ft+=st[B(X,Y,Y,gt)]+lt}return ft+=F,typeof Z=="function"&&Z(null,ft),ft},qwt}var CFt;function mhe(){if(CFt)return Hwt;CFt=1;let p=fhe(),v=phe();return Hwt.render=function(k,N,F){return N&&N.small?v.render(k,N,F):p.render(k,N,F)},Hwt}var Xwt={},Kwt={},EFt;function yPt(){if(EFt)return Kwt;EFt=1;let p=wlt();function v(F,W){let L=F.a/255,O=W+'="'+F.hex+'"';return L<1?O+" "+W+'-opacity="'+L.toFixed(2).slice(1)+'"':O}function k(F,W,L){let O=F+W;return typeof L<"u"&&(O+=" "+L),O}function N(F,W,L){let O="",S=0,B=!1,j=0;for(let K=0;K<F.length;K++){let Z=Math.floor(K%W),Y=Math.floor(K/W);!Z&&!B&&(B=!0),F[K]?(j++,K>0&&Z>0&&F[K-1]||(O+=B?k("M",Z+L,.5+Y+L):k("m",S,0),S=0,B=!1),Z+1<W&&F[K+1]||(O+=k("h",j),j=0)):S++}return O}return Kwt.render=function(W,L,O){let S=p.getOptions(L),B=W.modules.size,j=W.modules.data,K=B+S.margin*2,Z=S.color.light.a?"<path "+v(S.color.light,"fill")+' d="M0 0h'+K+"v"+K+'H0z"/>':"",Y="<path "+v(S.color.dark,"stroke")+' d="'+N(j,B,S.margin)+'"/>',X='viewBox="0 0 '+K+" "+K+'"',q='<svg xmlns="http://www.w3.org/2000/svg" '+(S.width?'width="'+S.width+'" height="'+S.width+'" ':"")+X+' shape-rendering="crispEdges">'+Z+Y+`</svg>
`;return typeof O=="function"&&O(null,q),q},Kwt}var TFt;function ghe(){return TFt||(TFt=1,function(p){let v=yPt();p.render=v.render,p.renderToFile=function(N,F,W,L){typeof L>"u"&&(L=W,W=void 0);let O=dkt,B='<?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'+p.render(F,W);O.writeFile(N,B,L)}}(Xwt)),Xwt}var ZM={},Zwt={},AFt;function yhe(){return AFt||(AFt=1,function(p){let v=wlt();function k(F,W,L){F.clearRect(0,0,W.width,W.height),W.style||(W.style={}),W.height=L,W.width=L,W.style.height=L+"px",W.style.width=L+"px"}function N(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}p.render=function(W,L,O){let S=O,B=L;typeof S>"u"&&(!L||!L.getContext)&&(S=L,L=void 0),L||(B=N()),S=v.getOptions(S);let j=v.getImageWidth(W.modules.size,S),K=B.getContext("2d"),Z=K.createImageData(j,j);return v.qrToImageData(Z.data,W,S),k(K,B,j),K.putImageData(Z,0,0),B},p.renderToDataURL=function(W,L,O){let S=O;typeof S>"u"&&(!L||!L.getContext)&&(S=L,L=void 0),S||(S={});let B=p.render(W,L,S),j=S.type||"image/png",K=S.rendererOpts||{};return B.toDataURL(j,K.quality)}}(Zwt)),Zwt}var IFt;function vhe(){if(IFt)return ZM;IFt=1;let p=F$t(),v=z$t(),k=yhe(),N=yPt();function F(W,L,O,S,B){let j=[].slice.call(arguments,1),K=j.length,Z=typeof j[K-1]=="function";if(!Z&&!p())throw new Error("Callback required as last argument");if(Z){if(K<2)throw new Error("Too few arguments provided");K===2?(B=O,O=L,L=S=void 0):K===3&&(L.getContext&&typeof B>"u"?(B=S,S=void 0):(B=S,S=O,O=L,L=void 0))}else{if(K<1)throw new Error("Too few arguments provided");return K===1?(O=L,L=S=void 0):K===2&&!L.getContext&&(S=O,O=L,L=void 0),new Promise(function(Y,X){try{let J=v.create(O,S);Y(W(J,L,S))}catch(J){X(J)}})}try{let Y=v.create(O,S);B(null,W(Y,L,S))}catch(Y){B(Y)}}return ZM.create=v.create,ZM.toCanvas=F.bind(null,k.render),ZM.toDataURL=F.bind(null,k.renderToDataURL),ZM.toString=F.bind(null,function(W,L,O){return N.render(W,O)}),ZM}var NFt;function bhe(){if(NFt)return H3;NFt=1;let p=F$t(),v=z$t(),k=hhe(),N=dhe(),F=mhe(),W=ghe();function L(K,Z,Y){if(typeof K>"u")throw new Error("String required as first argument");if(typeof Y>"u"&&(Y=Z,Z={}),typeof Y!="function")if(p())Z=Y||{},Y=null;else throw new Error("Callback required as last argument");return{opts:Z,cb:Y}}function O(K){return K.slice((K.lastIndexOf(".")-1>>>0)+2).toLowerCase()}function S(K){switch(K){case"svg":return W;case"txt":case"utf8":return N;case"png":case"image/png":default:return k}}function B(K){switch(K){case"svg":return W;case"terminal":return F;case"utf8":default:return N}}function j(K,Z,Y){if(!Y.cb)return new Promise(function(X,J){try{let q=v.create(Z,Y.opts);return K(q,Y.opts,function(H,tt){return H?J(H):X(tt)})}catch(q){J(q)}});try{let X=v.create(Z,Y.opts);return K(X,Y.opts,Y.cb)}catch(X){Y.cb(X)}}return H3.create=v.create,H3.toCanvas=vhe().toCanvas,H3.toString=function(Z,Y,X){let J=L(Z,Y,X),q=J.opts?J.opts.type:void 0,H=B(q);return j(H.render,Z,J)},H3.toDataURL=function(Z,Y,X){let J=L(Z,Y,X),q=S(J.opts.type);return j(q.renderToDataURL,Z,J)},H3.toBuffer=function(Z,Y,X){let J=L(Z,Y,X),q=S(J.opts.type);return j(q.renderToBuffer,Z,J)},H3.toFile=function(Z,Y,X,J){if(typeof Z!="string"||!(typeof Y=="string"||typeof Y=="object"))throw new Error("Invalid argument");if(arguments.length<3&&!p())throw new Error("Too few arguments provided");let q=L(Y,X,J),H=q.opts.type||O(Z),st=S(H).renderToFile.bind(null,Z);return j(st,Y,q)},H3.toFileStream=function(Z,Y,X){if(arguments.length<2)throw new Error("Too few arguments provided");let J=L(Y,X,Z.emit.bind(Z,"error")),H=S("png").renderToFileStream.bind(null,Z);j(H,Y,J)},H3}var Qwt,MFt;function whe(){return MFt||(MFt=1,Qwt=bhe()),Qwt}var xhe=whe(),khe=dbt(xhe),She=".qr-canvas{max-height:60vh;max-width:80vw;text-align:center}.qr-canvas>canvas{width:100%;height:100%}",ide=(()=>{let p=class{constructor(v){ll(this,v),this.apiErrorEvent=ps(this,"apiError"),this.prefilledPhone=!1,this.invalidValue=!1,this.waitingMobile=!1}componentWillLoad(){return ce(this,null,function*(){hh.flowStarted(),this.translations=yield vd.getValues(),this.infoTextTop=this.translations.MobileRedirectValues.InfoTop,this.infoTextBottom=this.translations.MobileRedirectValues.InfoBottom;let v=Xe.environment=="QA"?"test":"ontr",k=Xe.apiBaseUrl.includes("apimd")?"https://onmd.id-kyc.com/":"https://onro.id-kyc.com/";this.redirectLink=k+v+"/mobileredirect?redirectId="+Xe.redirectId,Xe.phoneNumber&&Xe.phoneNumber!=""&&(this.contact=Xe.phoneNumber,this.prefilledPhone=!0);var N=this;khe.toDataURL(this.redirectLink,{type:"image/png",errorCorrectionLevel:"M",scale:6},function(F,W){F&&console.error(F),N.qrCode=W})})}componentDidLoad(){return ce(this,null,function*(){for(yield dl.initialize(Ns.MobileRedirect),yield tp(5e3),yield this.checkStatus();this.orderStatus!=aa.COMPLETE;)yield this.checkStatus(),yield tp(5e3)})}checkStatus(){return ce(this,null,function*(){this.orderStatus=yield Qa.instance.GetStatusUi(Xe.requestId),this.orderStatus==null?this.apiErrorEvent.emit({message:"No order was started for this process."}):this.orderStatus==aa.ABORTED?(this.waitingMobile=!1,this.infoTextTop=this.translations.MobileRedirectValues.InfoAborted,hh.flowAborted()):this.orderStatus==aa.COMPLETE?(this.waitingMobile=!1,Xe.flowStatus=aa.COMPLETE):this.orderStatus!=aa.MOBILE&&(this.infoTextTop=this.translations.MobileRedirectValues.InfoWaiting,this.waitingMobile=!0)})}disconnectedCallback(){return ce(this,null,function*(){yield dl.finalize(Ns.MobileRedirect)})}buttonClick(){return ce(this,null,function*(){if(!(this.contact==""||this.contact.length!=10)){this.waitingMobile=!0,this.infoTextTop=this.translations.MobileRedirectValues.InfoWaiting;try{yield Qa.instance.SendLink(this.redirectLink,this.contact)}catch(v){this.apiErrorEvent.emit(v)}}})}handleChangeContact(v){let k=v.target?v.target.value:"";this.contact=k.replace(/\D/g,""),this.contact.length>10&&(this.contact=this.contact.substring(0,10)),this.invalidValue=this.contact.length!=10,v.target.value=this.contact}render(){return He("div",{key:"f79587a59a2fef3401598d2ba696d31a394e91c2",class:"container flex center"},He("div",{key:"7b5b427d18aaafd5c6298f7e96c0ea6cfc752633",class:"px-2 w-100"},He("div",{key:"a6876add2b92eeb2b873f4462f584756267dceb1",hidden:this.waitingMobile},He("h1",{key:"e732388e87d727338d1002d7a8bf252ca8d56517",class:"text-center px-2 mb-1"},this.infoTextTop),He("div",{key:"33d30a0bc95096fd6af869a3ce41ee76d2f02cc7",class:"flex center"},He("img",{key:"40ee02bf680c13a9f12bc2a1dd5c7bdc8d83ac10",src:this.qrCode})),He("h2",{key:"3bcb59da595248b10654dc3bad75b4fdf9e3ff13",class:"text-center px-2 mb-2"},this.infoTextBottom),He("div",{key:"15eaf8df1f604069ed977f0606c14306dd6f4fd7",class:"input-container mb-3 px-3"},He("label",{key:"5457757c20dd4581303087eab0462cb4241ee14f",class:"font-size-18 mb-1 color-red",hidden:this.invalidValue==!1},He("b",{key:"eba4702f98a13f72155884abc1a89a6ac5100d8a"},this.translations.MobileRedirectValues.Validation)),He("input",{key:"411e1d3e7057ae4d66589778bcc27704ae057e7b",type:"text",id:"codeInput",class:"main-input",disabled:this.prefilledPhone,value:this.contact,onInput:v=>this.handleChangeContact(v)})),He("div",{key:"cb1ea10c38ad4e1f321acc2a89666fc28f572232",class:"px-3"},He("button",{key:"0c8f84c8b3f2f2deca30264b3ad8b37c299281fe",class:"main-button",onClick:()=>this.buttonClick()},this.translations.MobileRedirectValues.Send))),He("div",{key:"94ec3c9577d145ad186fd80748a38513347bc364",hidden:this.waitingMobile==!1},He("div",{key:"b570891ce02871a23cd2e579f4a55bbd66ef7b45",class:"text-center"},He("p",{key:"ff1674cc8c2a2b937d2acbbe30cd700c965189e2",class:"font-size-2"},this.infoTextTop))),He("div",{key:"d4815855f1c36b797cd642363ba3f811b2794ca5",class:"footer text-center"},He("img",{key:"af419f452f4829595d549fcccefcbfae1d625af8",src:Cd}))))}};return p.style=She,p})(),Z1=function(p){return p.IdFront="IdFront",p.IdBack="IdBack",p.IdFrontVideo="IdFrontVideo",p.IdBackVideo="IdBackVideo",p.Selfie="Selfie",p.SelfieVideo="SelfieVideo",p.SelfieGestureVideo="SelfieGestureVideo",p.TiltVideo="TiltVideo",p.None="None",p}(Z1||{}),_he="",ade=(()=>{let p=class{constructor(v){ll(this,v),this.apiErrorEvent=ps(this,"apiError"),this.recordingResultCount=0,this.uploading=!1,this.appInsights=T8.getInstance()}componentWillLoad(){this.captureRetryCount=0,this.initFlow(),this.appInsights.trackEvent("ProcessId | init",{requestId:Xe.requestId})}initFlow(){this.mode=="front"?(this.currentStep=Ns.CiFront,this.flow={fileName:"idImage.png",recName:"idVideo.",photoType:Z1.IdFront,recType:Z1.IdFrontVideo,imageSize:0,videoSize:0}):this.mode=="back"?(this.currentStep=Ns.CiBack,this.flow={fileName:"idBackImage.png",recName:"idBackVideo.",photoType:Z1.IdBack,recType:Z1.IdBackVideo,imageSize:0,videoSize:0}):this.mode=="tilt"&&(this.currentStep=Ns.CiTilt,this.flow={fileName:"idTiltImage.png",recName:"idTiltVideo.",photoType:Z1.None,recType:Z1.TiltVideo,imageSize:0,videoSize:0}),Xe.debug&&console.log("process-id | initFlow")}timeElapsed(){this.errorReason="Timeout",this.showTimeout=!0}captureErrorDone(){Xe.debug&&console.log("process-id | captureErrorDone"),this.showTimeout==!0&&(this.showTimeout=!1),this.showInvalid==!0&&(this.showInvalid=!1)}captureIdImage(v){return ce(this,null,function*(){if(Xe.debug&&console.log("process-id | captureIdImage",this.mode),this.mode=="tilt")return;let k=v.detail;if(k.size==0){Xe.debug&&console.log("process-id | captureIdImage | Empty id photo"),yield Qa.instance.AddLog({message:"Empty id photo",blobData:k},yield DD()),this.triggerErrorFlow();return}this.capture=new File([k],this.flow.fileName,{type:"image/png"}),this.triggerSnapshotTaken()})}uploadCapture(){return ce(this,null,function*(){try{this.uploading=!0;let k=yield MD(this.capture);this.flow.imageSize=Gst(k),Xe.debug&&console.log("process-id | captureIdImage | uploadResult: "+v);var v=yield Qa.instance.UploadFileForRequestB64(Xe.requestId,this.flow.photoType,k);v.isValid?Xe.flowStatus=aa[v.state]:(this.switchCamera(),this.triggerErrorFlow()),this.capture=null,this.shapshotTaken=!1,this.uploading=!1}catch(k){this.apiErrorEvent.emit(k)}})}capturedIdRecording(v){return ce(this,null,function*(){Xe.debug&&console.log("process-id | capturedIdRecording");let k=v.detail;if(k.size==0&&this.recordingResultCount==0){this.recordingResultCount++;return}if(k.size==0){Xe.debug&&console.log("process-id | capturedIdRecording | Empty ID recording"),yield Qa.instance.AddLog({message:"Empty ID recording",blobData:k},yield DD()),this.triggerErrorFlow();return}let N=k.type==Xf.mp4MimeType.type?Xf.mp4MimeType:Xf.webmMimeType,F=new File([k],this.flow.recName+N.extension,{type:N.type}),W=yield MD(F);this.flow.videoSize=Gst(W);var L=yield Qa.instance.UploadFileForRequestB64(Xe.requestId,this.flow.recType,W);Xe.debug&&console.log("process-id | capturedIdRecording | uploadResult: "+L),L.saved?Xe.flowStatus=aa[L.state]:this.triggerErrorFlow(),this.recordingResultCount=0})}verificationFinished(){return ce(this,null,function*(){for(Xe.debug&&console.log("process-id | verificationFinished"),this.verificationReceived=Date.now();Date.now()-this.verificationReceived<9e4;)if(yield tp(2e3),this.showInvalid||this.showTimeout)return;this.triggerUploadFailedFlow(),Xe.debug&&console.log("process-id | verificationFinished | waitingFinished ")})}idCaptureConfirmation(){this.uploadCapture()}idCaptureRetry(){this.capture=null,this.shapshotTaken=!1}triggerUploadFailedFlow(){this.errorReason="Upload Failed",this.showInvalid=!0}componentDidLoad(){return ce(this,null,function*(){Xe.debug&&console.log("process-id | componentDidLoad"),yield dl.initialize(this.currentStep)})}triggerErrorFlow(){this.errorReason="Invalid",this.showInvalid=!0}triggerSnapshotTaken(){this.shapshotTaken=!0}disconnectedCallback(){return ce(this,null,function*(){Xe.debug&&console.log("process-id | disconnectedCallback"),yield dl.finalize(this.currentStep)})}switchCamera(){Xe.debug&&console.log("process-id | switchCamera"),this.captureRetryCount==1?(A8.switchCamera(),this.captureRetryCount=0):this.captureRetryCount++}render(){let v=He("capture-error",{type:"ID",reason:this.errorReason,error:`image: ${this.flow.imageSize}mb video: ${this.flow.videoSize}mb`}),k=He("id-capture",null),N=He("id-capture-confirm",{capture:this.capture}),F=He("uploading-data",{type:"id"});return this.uploading?F:this.showInvalid||this.showTimeout?v:this.shapshotTaken?N:k}};return p.style=_he,p})(),Che=".grid{display:grid;gap:20px;grid-template-rows:repeat(3, calc((100vw - 4em - 40px) / 3));grid-template-columns:repeat(3, calc((100vw - 4em - 40px) / 3))}.grid>div{background-color:#f9f9f9;display:flex;align-items:center;justify-content:center;border-radius:50%;font-weight:600;font-size:1.4em;box-shadow:1px 1px 3px #00000029}.grid>div.error{background:#FF5353;color:white}.grid>div.success{background:#40c1ac;color:white}",ode=(()=>{let p=class{constructor(v){ll(this,v),this.rand=[]}componentWillLoad(){return ce(this,null,function*(){this.translations=yield vd.getValues(),this.randomize()})}randomInt(v,k){return Math.floor(Math.random()*(k-v+1)+v)}randomize(){this.rand=[];for(let k=0;k<9;k++){for(var v=this.randomInt(1,99);this.rand.includes(v);)v=this.randomInt(1,99);this.rand.push(v)}this.choice=this.randomInt(0,8)}click(v,k){return ce(this,null,function*(){let N=k.currentTarget;this.choice==v?(N.classList.add("success"),yield tp(500),Xe.flowStatus=yield Qa.instance.GetNextFlowState()):(N.classList.add("error"),yield tp(500),this.randomize()),N.classList=[]})}render(){return He("div",{key:"c085d69fa1949ef206a73821263be826171c98de",class:"container flex center"},He("div",{key:"786d077844c96d9cab9730c19f9da021345fbb37",class:"px-2 w-100"},He("h1",{key:"51111a394f28109f8dec04e2ec86654eb2e5c731",class:"text-center px-1 mb-2",innerHTML:this.translations.RandomActionValues.Title+` ${this.rand[this.choice]}`}),He("div",{key:"0e237a0759aaf639735463039c2f8ec12e8b17c9",class:"grid"},this.rand.map((v,k)=>He("div",{onClick:N=>this.click(k,N)},v))),He("div",{key:"44a99b30a345dff40570a703ce0ab7143546b71d",class:"footer text-center"},He("img",{key:"a17dfd618aa638dbda8e20d4c49634b79b8ae290",src:Cd}))))}};return p.style=Che,p})(),Ehe="",sde=(()=>{let p=class{constructor(v){ll(this,v),this.eventPhotoCapture=ps(this,"photoSelfieCapture"),this.apiErrorEvent=ps(this,"apiError"),this.eventTimeElapsed=ps(this,"timeElapsed"),this.captureTaken=!1,this.verified=!1,this.showDemo=!1}eventVideoStarted(v){this.videoStarted=!0,this.captureHeight=Math.round(window.screen.height/2),this.captureWidth=Math.round(this.captureHeight*9/16)}infoTimeElapsed(){this.titleMesage=this.translations.SelfieCaptureValues.TitleMore,this.titleStyle+=" pulsate"}componentWillLoad(){return ce(this,null,function*(){this.translations=yield vd.getValues(),navigator.mediaDevices||this.apiErrorEvent.emit({message:"This browser does not support webRTC"}),this.titleStyle="text-center px-1 mb-2"})}componentDidLoad(){return ce(this,null,function*(){Xe.flowStatus==aa.LIVENESS?(this.verificationMode=t2.Full,this.currentStep=Ns.SelfieCapture,this.mainStream=Xf.getNewInstance(this.verificationMode),this.titleMesage=this.translations.SelfieCaptureValues.Title):Xe.flowStatus==aa.LIVENESSGESTURE&&(this.verificationMode=t2.Tilt,this.currentStep=Ns.SelfieTilt,this.mainStream=Xf.getNewInstance(this.verificationMode),this.titleMesage=this.translations.SelfieCaptureValues.FacePoseMapping[this.mainStream.facePose]),this.openCamera()})}openCamera(){return ce(this,null,function*(){let v=A8.GetConstraints("",Xe.device,!0);setTimeout(()=>{Xe.device.isAppleDevice&&(navigator.audioSession.type="play-and-record"),navigator.mediaDevices.getUserMedia(v).then(k=>{this.mainStream.initStream(k)}).catch(k=>{this.closeCamera(),this.apiErrorEvent.emit(k)})},100)})}closeCamera(){this.mainStream&&this.mainStream.dropStream(),Xe.device.isAppleDevice&&(navigator.audioSession.type="playback")}disconnectedCallback(){this.closeCamera(),Xf.instance=null}takePhoto(){return ce(this,null,function*(){if(!this.captureTaken){if(this.captureTaken=!0,this.mainStream){let v=yield this.mainStream.takePhoto();this.eventPhotoCapture.emit(v)}else this.eventTimeElapsed.emit();yield dl.logStep(this.currentStep,hg.Finalized)}})}verificationFinished(){return ce(this,null,function*(){this.verified||(this.verified=!0,this.closeCamera())})}render(){let v;return Xe.device.isMobile&&this.videoStarted&&(Xe.debug&&console.log(this.captureWidth,this.captureHeight),v={width:this.captureWidth+"px",height:this.captureHeight+"px",overflow:"hidden",borderRadius:"10px","text-align":"center",margin:"auto"}),He("div",{key:"67ee3c33951e2cab368855dc82a9dc6a68e1f3a2",class:"container flex center"},He("div",{key:"b43cc71cd3c93a5f8575834d6f2bfaef1a8bc89b",class:"px-2 w-100"},He("h1",{key:"44e04379abe63623ffef354ff036e6a3fbb7ada3",class:this.titleStyle,innerHTML:this.titleMesage}),He("div",{key:"fe4956d5e2af44ea662fd5f1a959c6f7aeb497b3",hidden:this.showDemo||this.verified},He("div",{key:"51fe6e844b6707a8948d75ef7013bff95aff56c1",style:v},He("camera-comp",{key:"242a001e4e7946d15eeccff1c0a5396b337a37c9","capture-mode":"selfie"}))),He("div",{key:"5fb206a3444edf21209bf2c44135df71d5b4dcb7",class:"footer text-center"},He("img",{key:"8ccf547edc01a36cc900a0ba542d7ed085f7446e",src:Cd}))))}get component(){return HW(this)}};return p.style=Ehe,p})(),The="",ude=(()=>{let p=class{constructor(v){ll(this,v),this.apiErrorEvent=ps(this,"apiError"),this.canSend=!1,this.sending=!1,this.hasError=!1}doAction(){return ce(this,null,function*(){if(!this.sending){this.sending=!0,this.canSend=!1;try{var v=yield Qa.instance.CheckOTPCode(Xe.requestId,this.code);Xe.flowStatus=aa[v.state],Xe.flowStatus==aa.CODEERROR&&(this.hasError=!0),this.sending=!1,this.code=""}catch(k){this.apiErrorEvent.emit(k)}}})}disconnectedCallback(){return ce(this,null,function*(){yield dl.finalize(Ns.OtpCheck)})}componentWillLoad(){return ce(this,null,function*(){Xe.flowStatus==aa.CODEERROR&&(this.hasError=!0)})}componentWillRender(){return ce(this,null,function*(){this.translations=yield vd.getValues(),this.title=this.translations.CodeValidationValues.Title,this.details=this.translations.CodeValidationValues.Description,this.buttonText=this.translations.CodeValidationValues.Button})}componentDidLoad(){return ce(this,null,function*(){yield dl.initialize(Ns.OtpCheck)})}handleChangeCode(v){let k=v.target?v.target.value:"";this.code=k,this.code.length>4&&(this.code=this.code.substring(0,4)),this.canSend=this.code.length==4,v.target.value=this.code,this.hasError=!1}render(){return He("div",{key:"3420d730d3eef627139b616c6ba56fa14a1825a2",class:"container flex center"},He("div",{key:"50d826a54de58930f71141a985e06c84e3e97c1c",class:"px-1 w-100"},this.hasError?He("div",null,He("div",{class:"mb-1 ml-1 text-center"},He("img",{src:D$t,style:{width:"60px"}})),He("h1",{class:"text-center color-red px-1 mb-2"},this.translations.CodeValidationValues.Error)):He("div",null,He("div",{class:"mb-1 ml-1 text-center"},He("img",{src:ckt,style:{width:"60px"}})),He("h1",{class:"text-center px-1 mb-2"},this.title)),He("p",{key:"199bcae5126a67ec3454833a8545400149c6b2e7",class:"text-center mb-05"},this.details),He("div",{key:"9e0eb550ed78cd1abbceca440769815c98024a10",class:"mb-2"},He("input",{key:"a2bb38e1aec67476f3585f710caaa32fcccc4dcd",placeholder:"XXXX",type:"tel",id:"codeInput",class:"main-input",onInput:v=>this.handleChangeCode(v),value:this.code})),He("div",{key:"9c42ae84fa903915d94790bcb5c03473d60c8322",class:"button flex mb-1 mx-3"},this.sending?He("div",{class:"img-loader rounded img-loader-button"},He("img",{class:"loading-image loading-image-button",src:gw})):null,He("button",{key:"40c811aa6ba4c5aef07b16c6938c37340e1a1f52",id:"action",disabled:!this.canSend,class:"main-button",onClick:()=>this.doAction()},this.buttonText)),He("div",{key:"158b3675943f165f82d2fd7eb26e6d1ec5b185b8",class:"footer text-center"},He("img",{key:"1b81c9d312e805d26a27861fe82be11b86f6237e",src:Cd}))))}};return p.style=The,p})(),Ahe="",lde=(()=>{let p=class{constructor(v){ll(this,v),this.apiErrorEvent=ps(this,"apiError"),this.prefilledPhone=!1,this.canSend=!1,this.sending=!1}doAction(){return ce(this,null,function*(){if(!this.sending){this.sending=!0;try{this.canSend=!1;var v=yield Qa.instance.SendOTPCode(Xe.requestId,this.phoneNumber);v.sent===!0&&(yield this.setPhoneNumber(),Xe.flowStatus=aa[v.state])}catch(k){this.apiErrorEvent.emit(k)}}})}setPhoneNumber(){return ce(this,null,function*(){var v=yield qu.ectdata.get(Xe.requestId);v.phoneNumber=this.phoneNumber,yield qu.ectdata.put(v)})}disconnectedCallback(){return ce(this,null,function*(){yield dl.finalize(Ns.OtpSend)})}componentWillRender(){return ce(this,null,function*(){this.translations=yield vd.getValues(),this.buttonText=this.translations.PhoneValidationValues.Button,this.title=this.translations.PhoneValidationValues.Title,this.details=this.translations.PhoneValidationValues.Description,Xe.phoneNumber&&Xe.phoneNumber!=""&&(this.phoneNumber=Xe.phoneNumber,this.prefilledPhone=!0,this.canSend=!0)})}componentDidLoad(){return ce(this,null,function*(){yield dl.initialize(Ns.OtpSend)})}handleChangePhone(v){let k=v.target?v.target.value:"";this.phoneNumber=k.replace(/\D/g,""),this.phoneNumber.length>10&&(this.phoneNumber=this.phoneNumber.substring(0,10)),this.canSend=this.phoneNumber.length==10,v.target.value=this.phoneNumber}render(){return He("div",{key:"c50e32e0c53e149b64ee5c9644477ab007d30ea1",class:"container flex center"},He("div",{key:"abcb9880559ed1fdec28ad958dac292b8cf0712d",class:"px-1"},He("div",{key:"220013d32c00299c88dd25dfcbba09eb8a34ec5b",class:"mb-1 ml-1 text-center"},He("img",{key:"005cc0c52e031b51033e5248778c859fa87e35e7",src:ckt,style:{width:"60px"}})),He("h1",{key:"5478c4ee102f96e1f3d613d10efd9f1d5050fb30",class:"text-center px-1 mb-2"},this.title),He("p",{key:"2ceaac4cb9a7096a58069f1a0673c4d2756bf5ac",class:"text-center mb-05"},this.details),He("div",{key:"6e7110ca802510a8995ed6fea74bafca06a4c60c",class:"mb-2"},He("input",{key:"c39e0630822da808be7c294a3c43b7f688de4eaa",placeholder:this.translations.PhoneValidationValues.Label,type:"tel",id:"phoneInput",class:"main-input",disabled:this.prefilledPhone,onInput:v=>this.handleChangePhone(v),value:this.phoneNumber})),He("div",{key:"6717c343eebfcb3f4c6c7b69c036961cb3b92dd9",class:"button flex mb-1 mx-3"},this.sending?He("div",{class:"img-loader rounded img-loader-button"},He("img",{class:"loading-image loading-image-button",src:gw})):null,He("button",{key:"bc97cb25e3ac481d1bb2f9c82c65768c841dc62f",id:"action",disabled:!this.canSend,class:"main-button",onClick:()=>this.doAction()},this.buttonText)),He("div",{key:"e1667a59bf914c099bc89ca3d8489f765a44e751",class:"footer text-center"},He("img",{key:"279a9f1911a7a3d26cf5afcfe735066c2f958946",src:Cd}))))}};return p.style=Ahe,p})(),Ihe="",cde=(()=>{let p=class{constructor(v){ll(this,v)}componentWillLoad(){return ce(this,null,function*(){Xe.flowStatus=yield Qa.instance.GetNextFlowState()})}render(){return He("div",{key:"35ae88cb3c80bc22ffcb0faf4c4e0a8ab9d739f3",class:"container"},He("div",{key:"ea045647322eb316616a5ca6bc79655b30c640ea",class:"row"},He("div",{key:"099efb026179ac0802021ed45c4af730a264157d",class:"div-ci align-center"},He("img",{key:"24cbda86da8022099fe394f937907f84f22ba380",src:gw}))))}};return p.style=Ihe,p})(),hde=class{constructor(p){ll(this,p)}componentWillLoad(){return ce(this,null,function*(){this.translations=yield vd.getValues()})}render(){return He("div",{key:"c6f304f8acf69cf602d0d0324f53886cffb5e3b1",class:"container flex center"},He("div",{key:"add85de3b5a131eb3e3489c1ec2509d14ff7904d",class:"px-2 w-100"},He("h1",{key:"8bc47ccf20b035bc46bfdad4b703f9d7229ff883",class:"text-center px-1 mb-2",innerHTML:this.type=="id"?this.translations.IdCaptureValues.Loading:this.translations.SelfieCaptureValues.Loading}),He("img",{key:"8ba296ba08665c2ba03be62002eb33057661bc83",class:"w-100",src:"https://ekyc.blob.core.windows.net/$web/"+(this.type=="id"?"uploading_id.gif":"uploading_selfie.gif")}),He("div",{key:"4b95ad025487508bd118f4a4a8ee6795a32a280e",class:"footer text-center"},He("img",{key:"e2fc4393002f08260150eac36ea79826c761a08e",src:Cd}))))}},Nhe="",dde=(()=>{let p=class{constructor(v){ll(this,v),this.apiErrorEvent=ps(this,"apiError"),this.uploading=!1,this.recordingResultCount=0,this.recordingRetryCount=0,this.appInsights=T8.getInstance()}componentDidLoad(){return ce(this,null,function*(){})}componentWillLoad(){this.appInsights.trackEvent("UserLiveness | init",{requestId:Xe.requestId}),this.mode=="selfie"?(this.currentStep=Ns.Selfie,this.flow={fileName:"selfie.png",recName:"selfieVideo.",photoType:Z1.Selfie,recType:Z1.SelfieVideo,imageSize:0,videoSize:0}):this.mode=="selfieGesture"&&(this.currentStep=Ns.SelfieTilt,this.flow={fileName:"",recName:"selfieTiltVideo.",photoType:Z1.None,recType:Z1.SelfieGestureVideo,imageSize:0,videoSize:0})}timeElapsed(){this.errorReason="Timeout",this.showTimeout=!0}captureErrorDone(){this.showTimeout==!0&&(this.showTimeout=!1),this.showError==!0&&(this.showError=!1)}captureSelfieImage(v){return ce(this,null,function*(){if(Xe.flowStatus==aa.LIVENESSGESTURE)return;let k=v.detail;if(k.size==0){yield Qa.instance.AddLog({message:"Empty selfie",blobData:k},yield DD()),this.triggerErrorFlow();return}try{var N=new File([k],this.flow.fileName,{type:"image/png"});let F=yield MD(N);this.flow.imageSize=Gst(F),this.uploading=!0;let W=yield Qa.instance.UploadFileForRequestB64(Xe.requestId,this.flow.photoType,F);W.isValid?Xe.flowStatus=aa[W.state]:this.triggerErrorFlow(),this.uploading=!1}catch(F){this.apiErrorEvent.emit(F)}})}capturedSelfieRecording(v){return ce(this,null,function*(){let k=v.detail;if(k.size==0&&this.recordingResultCount==0){this.recordingResultCount++;return}if(this.recordingResultCount=0,k.size==0){yield Qa.instance.AddLog({message:"Empty recording",blobData:k},yield DD()),this.triggerErrorFlow();return}let N=k.type==Xf.mp4MimeType.type?Xf.mp4MimeType:Xf.webmMimeType;try{let F=new File([k],this.flow.recName+N.extension,{type:N.type}),W=yield MD(F);this.flow.videoSize=Gst(W);let L=yield Qa.instance.UploadFileForRequestB64(Xe.requestId,this.flow.recType,W);L.saved?Xe.flowStatus=aa[L.state]:this.triggerErrorFlow()}catch(F){this.recordingRetryCount<3?(this.recordingRetryCount++,this.triggerErrorFlow()):this.apiErrorEvent.emit(F)}})}verificationFinished(){return ce(this,null,function*(){for(Xe.debug&&console.log("user-liveness | verificationFinished"),this.verificationReceived=Date.now();Date.now()-this.verificationReceived<9e4;)if(yield tp(2e3),this.showError||this.showTimeout)return;this.triggerUploadFailedFlow(),Xe.debug&&console.log("user-liveness | verificationFinished | waitingFinished ")})}triggerUploadFailedFlow(){this.errorReason="Upload Failed",this.showError=!0}disconnectedCallback(){return ce(this,null,function*(){yield dl.finalize(this.currentStep)})}triggerErrorFlow(){this.errorReason="Invalid",this.showError=!0}render(){let v=He("selfie-capture",null),k=He("capture-error",{type:"LIVENESS",reason:this.errorReason,error:`image: ${this.flow.imageSize}mb video: ${this.flow.videoSize}mb`}),N=He("uploading-data",{type:"id"});return this.uploading?N:this.showError||this.showTimeout?k:v}};return p.style=Nhe,p})();export{Vhe as agreement_info,Ghe as agreement_view,Hhe as camera_comp,Yhe as camera_error,qhe as capture_error,Xhe as citizenship_selection,Khe as end_redirect,Zhe as error_end,Qhe as how_to_info,Jhe as id_capture,tde as id_capture_confirm,ede as id_selection,nde as identification_component,rde as landing_validation,ide as mobile_redirect,ade as process_id,ode as random_action,sde as selfie_capture,ude as sms_code_validation,lde as sms_send,cde as state_transition,hde as uploading_data,dde as user_liveness};
